注/v,：/w,在/p,上/f,一篇/mq,的/u,一般线性/nw,回归/v,中/f,，/w,使用/v,的/u,假设/v,函数/n,是/v,一元/b,一次方程/n,，/w,也/d,就/d,是/v,二维平/nr,面上/s,的/u,一条/mq,直线/n,。/w,但是/c,很多/m,时候/n,可能/v,会/v,遇到/v,直线/n,方程/n,无法/v,很/d,好/a,的/u,拟合/nz,数据/n,的/u,情况/n,，/w,这个/r,时候/n,可以/v,尝试/vn,使用/v,多项式/n,回归/v,。/w,多项式/n,回归/v,中/f,，/w,加入/v,了/u,特征/n,的/u,更/d,高次方/nw,（/w,例如/v,平方项/nw,或/c,立方项/nw,）/w,，/w,也/d,相当/d,于/p,增加/v,了/u,模型/n,的/u,自由度/n,，/w,用/p,来/v,捕获/v,数据/n,中非线性/nw,的/u,变化/vn,。/w,添加/vn,高/a,阶项/nw,的/u,时候/n,，/w,也/d,增加/v,了/u,模型/n,的/u,复杂度/nw,。/w,随着/p,模型/n,复杂度/nw,的/u,升高/v,，/w,模型/n,的/u,容量/n,以及/c,拟合/nz,数据/n,的/u,能力/n,增加/v,，/w,可以/v,进一步/d,降低/v,训练/vn,误差/n,，/w,但/c,导致/v,过/u,拟合/nz,的/u,风险/n,也/d,随之/d,增加/v,。/w,图/n,a/en,，/w,模型/n,复杂度/nw,与/p,训练/vn,误差/n,及/c,测试/vn,误差/n,之间/f,的/u,关系/n,0/m,./w, ,多项式/n,回归/v,的/u,一般/a,形式/n,在/p,多项式/n,回归/v,中/f,，/w,最/d,重要/a,的/u,参数/n,是/v,最/d,高次方/nw,的/u,次数/n,。/w,设/v,最/d,高次方/nw,的/u,次数/n,为/p,$/w,n/en,$/w,，/w,且/c,只/d,有/v,一个/m,特征/n,时/ng,，/w,其/r,多项式/n,回归/v,的/u,方程/n,为/p,：/w,$/w,$/w, ,\/w,hat/en,{/w,h/en,}/w, ,=/w, ,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,x/en,^,1/m, ,+/w, ,\/w, ,./w,./w,./w, ,\/w, , ,+/w, ,\/w,theta/en,_,{/w,n/en,-/w,1/m,}/w, ,x/en,^,{/w,n/en,-/w,1/m,}/w, ,+/w, , ,\/w,theta/en,_,n/en, ,x/en,^,n/en, ,$/w,$/w,如果/c,令/v,$/w,x/en,_,0/m, ,=/w, ,1/m,$/w,，/w,在/p,多样本/nw,的/u,情况/n,下/f,，/w,可以/v,写/v,成/v,向/p,量化/v,的/u,形式/n,：/w,$/w,$/w,\/w,hat/en,{/w,h/en,}/w, ,=/w, ,x/en, ,\/w,cdot/en, ,\/w,theta/en,$/w,$/w,其中/r,$/w,x/en,$/w,是/v,大小/n,为/p,$/w,m/en, ,\/w,cdot/en, ,(/w,n/en,+/w,1/m,)/w,$/w,的/u,矩阵/n,，/w,$/w,\/w,theta/en,$/w,是/v,大小/n,为/p,$/w,(/w,n/en,+/w,1/m,)/w, ,\/w,cdot/en, ,1/m,$/w,的/u,矩阵/n,。/w,在/p,这里/r,虽然/c,只/d,有/v,一个/m,特征/n,$/w,x/en,$/w,以及/c,$/w,x/en,$/w,的/u,不同/a,次方/n,，/w,但是/c,也/d,可以/v,将/d,$/w,x/en,$/w,的/u,高次方/nr,当做/v,一个/m,新/a,特征/n,。/w,与/p,多元/b,回归/v,分析/vn,唯一/b,不同/a,的/u,是/v,，/w,这些/r,特征/n,之间/f,是/v,高度/d,相关/v,的/u,，/w,而/c,不/d,是/v,通常/d,要求/v,的/u,那样/r,是/v,相互/d,对立/v,的/u,。/w,在/p,这里/r,有/v,个/q,问题/n,在/p,刚/d,开始/v,学习/v,线性/n,回归/v,的/u,时候/n,困扰/v,了/u,自己/r,很/d,久/a,：/w,如果/c,假设/v,中/f,出现/v,了/u,高阶/nz,项/q,，/w,那么/r,这个/r,模型/n,还是/c,线性/n,模型/n,吗/y,？/w,此时/r,看待/v,问题/n,的/u,角度/n,不同/a,，/w,得到/v,的/u,结果/n,也/d,不同/a,。/w,如果/c,把/p,上面/f,的/u,假设/v,看成/v,是/v,特征/n,$/w,x/en,$/w,的/u,方程/n,，/w,那么/r,该/r,方程/n,就/d,是/v,非/h,线性方程/l,；/w,如果/c,看成/v,是/v,参数/n,$/w,\/w,theta/en,$/w,的/u,方程/n,，/w,那么/r,$/w,x/en,$/w,的/u,高/a,阶项/nw,都/d,可以/v,看做/v,是/v,对应/v,$/w,\/w,theta/en,$/w,的/u,参数/n,，/w,那么/r,该/r,方程/n,就/d,是/v,线性/n,方程/n,。/w,很/d,明显/a,，/w,在线性/nw,回归/v,中/f,采用/v,了/u,后/f,一种/mq,解释/v,方式/n,。/w,因此/c,多项式/n,回归/v,仍然/d,是/v,参数/n,的/u,线性/n,模型/n,。/w,1/m,./w, ,多项式/n,回归/v,的/u,实现/v,下面/f,主要/b,使用/v,了/u,numpy/en,、/w,scipy/en,、/w,matplotlib/en,和/c,scikit/en,-/w,learn/en,，/w,所有/b,使用/v,到/v,的/u,函数/n,的/u,导入/v,如下/v,：/w,1/m, ,import/en, ,numpy/en, ,as/en, ,np/en, ,2/m, ,from/en, ,scipy/en, ,import/en, ,stats/en, ,3/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,4/m, ,from/en, ,sklearn/en,./w,preprocessing/en, ,import/en, ,polynomialfeatures/en, ,5/m, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,linearregression/en, ,6/m, ,from/en, ,sklearn/en,./w,metrics/en, ,import/en, ,mean/en,_,squared/en,_,error/en,下/f,是/v,使用/v,的/u,数据/n,是/v,使用/v,$/w,y/en, ,=/w, ,x/en,^,2/m, ,+/w, ,2/m,$/w,并/c,加入/v,一些/m,随机/d,误差/n,生成/vn,的/u,，/w,只/d,取/v,了/u,10个/m,数据点/nw,：/w,1/m, ,data/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w, ,-/w,2.95507616/m,,/w, ,10.94533252/m,]/w,,/w, ,2/m, ,[/w, ,-/w,0.44226119/m,,/w, ,2.96705822/m,]/w,,/w, ,3/m, ,[/w, ,-/w,2.13294087/m,,/w, ,6.57336839/m,]/w,,/w, ,4/m, ,[/w, ,1.84990823/m,,/w, ,5.44244467/m,]/w,,/w, ,5/m, ,[/w, ,0.35139795/m,,/w, ,2.83533936/m,]/w,,/w, ,6/m, ,[/w, ,-/w,1.77443098/m,,/w, ,5.6800407/m, ,]/w,,/w, ,7/m, ,[/w, ,-/w,1.8657203/m, ,,/w, ,6.34470814/m,]/w,,/w, ,8/m, ,[/w, ,1.61526823/m,,/w, ,4.77833358/m,]/w,,/w, ,9/m, ,[/w, ,-/w,2.38043687/m,,/w, ,8.51887713/m,]/w,,/w, ,10/m, ,[/w, ,-/w,1.40513866/m,,/w, ,4.18262786/m,]/w,]/w,)/w, ,11/m, ,m/en, ,=/w, ,data/en,./w,shape/en,[/w,0/m,]/w, ,#, ,样本/n,大小/n, ,12/m, ,x/en, ,=/w, ,data/en,[/w,:/w,,/w, ,0/m,]/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,#, ,将/d,array/en,转换/v,成/v,矩阵/n, ,13/m, ,y/en, ,=/w, ,data/en,[/w,:/w,,/w, ,1/m,]/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,14/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,"/w,b/en,./w,"/w,)/w, ,15/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,'/w,)/w, ,16/m, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,'/w,)/w, ,17/m, ,plt/en,./w,show/en,(/w,)/w,这些/r,数据点/nw,plot/en,出来/v,，/w,如/v,下/f,图/n,：/w,-/w,1/m,，/w,原始/a,数据/n,1.1/m, ,直线/n,方程/n,拟合/nz,下面/f,先/d,用/p,直线/n,方程/n,拟合/nz,上面/f,的/u,数据点/nw,：/w,1/m, ,lin/en,_,reg/en, ,=/w, ,linearregression/en,(/w,)/w, ,2/m, ,lin/en,_,reg/en,./w,fit/en,(/w,x/en,,/w, ,y/en,)/w, ,3/m, ,print/en,(/w,lin/en,_,reg/en,./w,intercept/en,_,,/w, ,lin/en,_,reg/en,./w,coef/en,_,)/w, ,#, ,[/w, ,4.97857827/m,]/w, ,[/w,[/w,-/w,0.92810463/m,]/w,]/w, ,4/m, ,5/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,3/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,6/m, ,y/en,_,plot/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,,/w, ,lin/en,_,reg/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,lin/en,_,reg/en,./w,intercept/en,_, ,7/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,y/en,_,plot/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,8/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,9/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,'/w,)/w, ,10/m, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,'/w,)/w, ,11/m, ,plt/en,./w,savefig/en,(/w,'/w,regu/en,-/w,2/m,./w,png/en,'/w,,/w, ,dpi/en,=/w,200/m,)/w,-/w,2/m,，/w,直线/n,拟合/nz,的/u,效果/n,可以/v,使用/v,函数/n,"/w,mean/en,_,squared/en,_,error/en,"/w,来/v,计算/v,误差/n,(/w,使用/v,前面/f,介绍/v,过/u,的/u,mean/en, ,squared/en, ,error/en,,/w, ,mse/en,)/w,：/w,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w,,/w, ,lin/en,_,reg/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,lin/en,_,reg/en,./w,intercept/en,_, ,print/en,(/w,mean/en,_,squared/en,_,error/en,(/w,h/en,,/w, ,y/en,)/w,)/w, ,#, ,3/m,./w,341/m,./w,2/m, ,使用/v,多项式/n,方程/n,为了/p,拟/v,合/v,2/m,次方/n,程/q,，/w,需要/v,有/v,特征/n,$/w,x/en,^,2/m,$/w,的/u,数据/n,，/w,这里/r,可以/v,使用/v,函数/n,"/w,polynomialfeatures/en,"/w,来/v,获得/v,：/w,1/m, ,poly/en,_,features/en, ,=/w, ,polynomialfeatures/en,(/w,degree/en,=/w,2/m,,/w, ,include/en,_,bias/en,=/w,false/en,)/w, ,2/m, ,x/en,_,poly/en, ,=/w, ,poly/en,_,features/en,./w,fit/en,_,transform/en,(/w,x/en,)/w, ,3/m, ,print/en,(/w,x/en,_,poly/en,)/w,结果/n,如下/v,：/w,[/w,[/w,-/w,2.95507616/m, ,8.73247511/m,]/w, ,[/w,-/w,0.44226119/m, ,0.19559496/m,]/w, ,[/w,-/w,2.13294087/m, ,4.54943675/m,]/w, ,[/w, ,1.84990823/m, ,3.42216046/m,]/w, ,[/w, ,0.35139795/m, ,0.12348052/m,]/w, ,[/w,-/w,1.77443098/m, ,3.1486053/m, ,]/w, ,[/w,-/w,1.8657203/m, ,3.48091224/m,]/w, ,[/w, ,1.61526823/m, ,2.60909145/m,]/w, ,[/w,-/w,2.38043687/m, ,5.66647969/m,]/w, ,[/w,-/w,1.40513866/m, ,1.97441465/m,]/w,]/w,利用/v,上面/f,的/u,数据/n,做/v,线性/n,回归/v,分析/vn,：/w,1/m, ,lin/en,_,reg/en, ,=/w, ,linearregression/en,(/w,)/w, ,2/m, ,lin/en,_,reg/en,./w,fit/en,(/w,x/en,_,poly/en,,/w, ,y/en,)/w, ,3/m, ,print/en,(/w,lin/en,_,reg/en,./w,intercept/en,_,,/w, ,lin/en,_,reg/en,./w,coef/en,_,)/w, ,#, ,[/w, ,2.60996757/m,]/w, ,[/w,[/w,-/w,0.12759678/m, ,0.9144504/m, ,]/w,]/w, ,4/m, ,5/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,3/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,6/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,7/m, ,y/en,_,plot/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,lin/en,_,reg/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,lin/en,_,reg/en,./w,intercept/en,_, ,8/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,y/en,_,plot/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,9/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,10/m, ,plt/en,./w,show/en,(/w,)/w,第/m,3行/mq,得到/v,了/u,训练/vn,后/f,的/u,参数/n,，/w,即/v,多项式/n,方程/n,为/p,$/w,h/en, ,=/w, ,-/w,0.13/m,x/en, ,+/w, ,0.91/m,x/en,^,2/m, ,+/w, ,2.61/m,$/w, ,（/w,结果/n,中/f,系数/n,的/u,顺序/n,与/p,$/w,x/en,$/w,中/f,特征/n,的/u,顺序/n,一致/a,）/w,，/w,如/v,下/f,图/n,所/u,示/vg,：/w,-/w,3/m,：/w,2次/mq,多项式/n,方程/n,与/p,原始/a,数据/n,的/u,比较/d,利用/v,多项式/n,回归/v,，/w,代价/n,函数/n,mse/en,的/u,值/n,下降/v,到/v,了/u,0.07/m,。/w,通过/p,观察/v,代码/n,，/w,可以/v,发现/v,训练/vn,多/a,项式/nr,方程/n,与/p,直线/n,方程/n,唯一/b,的/u,差别/n,是/v,输入/v,的/u,训练/vn,集/vg,$/w,x/en,$/w,的/u,差别/n,。/w,在/p,训练/vn,直线/n,方程/n,时/ng,直接/ad,输入/v,了/u,$/w,x/en,$/w,的/u,值/n,，/