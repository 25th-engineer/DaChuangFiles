本/r,系列/q,文章/n,目前/t,已经/d,更新/v,两期/mq,，/w,分别/d,是/v,：/w, ,机器/n,学习/v,原来/d,如此/r,有趣/a,！/w,全世界/n,最/d,简单/a,的/u,机器/n,学习/v,入门/v,指南/n,、/w, ,机器/n,学习/v,原来/d,如此/r,有趣/a,：/w,如何/r,故意/d,欺骗/v,神经/n,网络/n,你/r,是否/v,有/v,注意/v,到/v,facebook/en,最近/t,开发/v,了/u,一个/m,非同寻常/l,的/u,功能/n,：/w,将/d,你/r,照片/n,中/f,的/u,好友/n,识别/v,出来/v,。/w,过去/t,，/w,facebook/en, ,让/v,你/r,手动/b,点击/v,照片/n,上/f,的/u,好友/n,，/w,输入/v,他们/r,的/u,名字/n,，/w,然后/c,加上/v,标签/n,。/w,现在/t,只要/c,你/r,上/f,传/v,一张/mq,照片/n,，/w,facebook/en,就/d,会/v,像/v,变/v,魔术/n,一样/u,为/p,你/r,自动/d,标记/n,出/v,所有人/n,：/w,这项/r,技术/n,就/d,叫/v,做人/v,脸/n,识别/v,。/w,在/p,你/r,的/u,朋友/n,的/u,脸/n,被/p,标记/n,了/u,几/m,次/q,之后/f,，/w,facebook/en,的/u,算法/n,就/d,可以/v,识别/v,他/r,了/u,。/w,这/r,是/v,一个/m,让/v,人/n,惊艳/nz,的/u,技术/n,--/nrf,facebook/en,识别/v,人脸/n,的/u,正确率/n,高/a,达/v,98%/mq,！/w,这/r,与/p,人类/n,的/u,表现/v,差不多/l,了/u,。/w,下面/f,就/d,让/v,我们/r,来/v,学习/v,一下/m,人脸/n,识别/v,技术/n,是/v,如何/r,实现/v,的/u,！/w,但是/c,只是/d,识别/v,你/r,的/u,朋友/n,的/u,脸/n,就/d,太/d,简单/a,了/u,。/w, ,我们/r,可以/v,最大化/v,扩展/v,这项/r,技术/n,，/w,来/v,解决/v,一个/m,更/d,具/vg,挑战性/n,的/u,问题/n,——/w,区分/v,威尔·法瑞尔/nrf,（/w,will/en, ,ferrell/en,，/w,著名/a,演员/n,）/w,和/c,查德·史密斯/nrf,（/w,chad/en, ,smith/en,，/w,著名/a,摇滚/n,音乐家/n,）/w,！/w,如何/r,使用/v,机器/n,学习/v,来/v,解决/v,复杂/a,的/u,问题/n,人脸/n,识别/v,由/p,一个/m,系列/q,的/u,相关/v,问题/n,组成/v,：/w,1/m,./w,首先/d,：/w,查看/v,一张/mq,照片/n,并/c,找/v,出/v,上面/f,所有/b,的/u,脸/n,2/m,./w,将/d,注意力/n,放/v,在/p,每/r,一张/mq,脸/n,上面/f,，/w,即使/c,这/r,张/q,脸/n,被/p,转/v,到/v,奇怪/v,的/u,方向/n,或者/c,是/v,光线/n,不好/a,的/u,情况/n,下/f,也/d,依旧/z,是/v,同/p,一个/m,人/n,。/w,3/m,./w, ,从/p,这/r,张/q,脸上/s,挑/v,出/v,一些/m,特征/n,用于/v,和/c,其他/r,人/n,区分/v,来/v,，/w,比如/v,像/v,眼睛/n,有/v,多/a,大/a,，/w,脸/n,有/v,多/a,长/a,等/u,。/w,4/m,./w,最后/f,，/w,将/d,这/r,张/q,脸/n,的/u,特征/n,和/c,其他/r,其他/r,脸/n,作/v,比较/d,，/w,以/p,最后/f,确定/v,这个/r,人/n,的/u,名字/n,。/w,作为/v,一个/m,人类/n,，/w,你/r,的/u,大脑会/nw,自动/d,做/v,这些/r,事情/n,。/w,实际上/d,，/w,人类/n,太/d,擅长/v,于识/nw,别人/r,脸/n,了/u,，/w,以至于/c,他们/r,在/p,日常/b,物品/n,上面/f,也/d,会/v,试图/v,去/v,寻找/v,脸/n,（/w,好像/v,是/v,这样/r,哦/e,，/w,人们/n,总是/d,喜欢/v,去/v,物品/n,上/f,找/v,出/v,练/v,得/u,形状/n,，/w,并且/c,觉得/v,这样/r,很/d,萌/nr,）/w,。/w,计算机/n,目前/t,并不/d,具备/v,这种/r,高/a,水平/n,的/u,能力/n,。/w,。/w,。/w,所以/c,我们/r,需要/v,一步步/nw,的/u,教/v,他们/r,。/w,我们/r,需要/v,构建/v,一个/m,流水线/n,（/w,pipeline/en,）/w,：/w,我们/r,将/d,分别/d,解决/v,人/n,脸/n,识别/v,的/u,每/r,一步/mq,，/w,并/c,将/d,当前/t,步骤/n,的/u,结果/n,传入/v,下/f,一个/m,步骤/n,。/w,换句话说/c,，/w,我们/r,需要/v,将/d,几/m,个/q,机器/n,学习/v,算/v,法链/nw,（/w,chain/en,）/w,起来/v,。/w,人脸/n,识别/v,-/w,一步/mq,一步/mq,来/v,我们/r,一步/mq,一步/mq,地/u,解决/v,这个/r,问题/n,。/w,在/p,每/r,一个/m,步骤/n,中/f,，/w,我们/r,都/d,将/d,学习/v,到/v,不同/a,的/u,机器/n,学习/v,算法/n,。/w,我/r,不/d,会/v,对/p,算法/n,的/u,每/r,一步/mq,都/d,进行/v,解释/v,，/w,但是/c,你/r,可以/v,学习/v,到/v,每/r,一个/m,算法/n,的/u,主体/n,思想/n,，/w,以及/c,如何/r,在/p, ,python/en, ,中/f,使用/v, ,openface/en, ,和/c, ,dlib/en, ,来/v,构建/v,一个/m,你/r,自己/r,的/u,面部/n,识别/v,系统/n,。/w,第一/m,步/q,：/w,寻找/v,所有/b,的/u,脸/n,在/p,我们/r,的/u,流水线/n,中/f,的/u,第一/m,步/q,是/v,人脸/n,检测/vn,。/w,很/d,明显/a,在/p,我们/r,区分/v,人/n,脸/n,之前/f,需要/v,在/p,图片/n,中/f,将/d,脸/n,标记/n,出来/v,。/w,如果/c,你/r,有/v,在/p,最近/t,十年/t,里面/f,用/p,过/u,相机/n,的话/u,，/w,你/r,可能/v,已经/d,见/v,过/u,正在/d,运行/vn,中/f,的/u,人脸/n,检测/vn,了/u,：/w,面部/n,识别/v,是/v,相机/n,的/u,一个/m,伟大/a,的/u,功能/n,。/w,当/p,相机/n,可以/v,自动/d,挑/v,出/v,面部/n,的/u,时候/n,，/w,这/r,将/d,确保/v,在/p,拍/v,照片/n,的/u,瞬间/t,所有/b,的/u,脸/n,都/d,对准/v,焦点/n,了/u,。/w,不过/c,我们/r,使用/v,它/r,是/v,为了/p,别的/r,目的/n,--/nrf,寻找/v,我们/r,想/v,在/p,下/f,一步/mq,要/v,传递/v,的/u,照片/n,区域/n,。/w,2000年/t,年初/t,的/u,时候/n,，/w,当/p,paul/en, ,viola/en,和/c,michael/en, ,jones/en,发明/v,了/u,一种/mq,可以/v,在/p,廉价/a,相机/n,上面/f,快速/d,运行/vn,的/u,面部/n,检测/vn,技术/n,后/f,，/w,人脸/n,检测/vn,成为/v,了/u,主流/n,。/w,然而/c,现在/t,更/d,可靠/a,的/u,解决/v,方案/n,出现/v,了/u,。/w,我们/r,现在/t,用/p,的/u,是/v,2005年/t,发明/v,的/u,一个/m,叫做/v,方向/n,梯度/n,直方图/n,，/w,简称/v,为/p,hog/en,。/w,为了/p,识别/v,出/v,图片/n,中/f,的/u,脸/n,，/w,首先/d,我们/r,需要/v,将/d,图片/n,转换/v,为/p,黑白色/nw,，/w,因为/c,在/p,识别/v,面部/n,的/u,时候/n,我们/r,不/d,需要/v,颜色/n,数据/n,。/w,然后/c,我们/r,需要/v,依次/d,遍历/nw,图片/n,中/f,的/u,每个/r,像素/n,。/w,对于/p,单个/b,像素/n,，/w,我们/r,也/d,需要/v,看/v,直接/ad,包围/v,它/r,的/u,其他/r,元素/n,：/w,我们/r,的/u,目标/n,是/v,比较/d,这个/r,像素/n,与/p,周围/f,像素/n,的/u,深度/n,。/w,然后/c,我们/r,要/v,画/v,一个/m,箭头/n,来/v,代表/n,图像/n,变暗/nw,的/u,方向/n,：/w,如果/c,你/r,对/p,这个/r,图像/n,中/f,的/u,每个/r,像素/n,都/d,重复/v,这个/r,过程/n,，/w,最后/f,每个/r,像素/n,，/w,最终/d,每个/r,像素/n,会/v,被/p,一个/m,箭头/n,取代/v,。/w,这些/r,箭头/n,被/p,称为/v,梯度/n,（/w,gradients/en,）/w,，/w,它们/r,能/v,显示/v,出/v,图像/n,上/f,从/p,明亮/a,到/v,黑暗/a,的/u,流动/vn,过程/n,：/w,这/r,看/v,起来/v,没有/v,明确/ad,的/u,目的/n,，/w,但/c,其实/d,这/r,很/d,有/v,必要/a,。/w,如果/c,我们/r,直接/ad,分析/vn,像素/n,，/w,同/p,一个/m,人/n,明/ag,暗/ad,不同/a,的/u,两张/mq,照片/n,将/d,具有/v,完全/ad,不同/a,的/u,像素/n,值/n,。/w,但是/c,如果/c,只/d,考虑/v,亮度/n,变化/vn,方向/n,（/w,direction/en,）/w,的话/u,，/w,明/ag,暗/ad,图像/n,将/d,会/v,有/v,同样/d,的/u,结果/n,。/w,这/r,使得/v,问题/n,变/v,得/u,更/d,容易/a,解决/v,！/w,但是/c,保存/v,每个/r,像素/n,的/u,梯度/n,太/d,过/u,细节/n,化/v,了/u,，/w,我们/r,最终/d,很/d,有/v,可能/v,捡/v,了/u,芝麻/n,丢/v,了/u,西瓜/n,。/w,如果/c,能/v,从/p,更/d,高/a,的/u,角度/n,上/f,观察/v,基本/a,的/u,明/ag,暗/ad,流动/vn,，/w,我们/r,就/d,可以/v,看出/v,图像/n,的/u,基本/a,规律/n,，/w,这/r,会/v,比/p,之前/f,更/d,好/a,。/w,为了/p,做到/v,这/r,一点/m,，/w,我们/r,将/d,图像/n,分割/v,成/v,一些/m, ,16/m,×/w,16/m, ,像素/n,的/u,小方块/n,。/w,在/p,每个/r,小/a,方块/n,中/f,，/w,我们/r,将/d,计算/v,出/v,每个/r,主/n,方向/n,上/f,有/v,多少/r,个/q,梯度/n,（/w,有/v,多少/r,指向/vn,上/f,，/w,指向/vn,右上/f,，/w,指向/vn,右/f,等/u,）/w,。/w,然后/c,我们/r,将/d,用/p,指向性/nw,最强/ad,那个/r,方向/n,的/u,箭头/n,来/v,代替/v,原来/d,的/u,那个/r,小/a,方块/n,。/w,最终/d,的/u,结果/n,是/v,，/w,我们/r,把/p,原始/a,图像/n,转换/v,成/v,了/u,一个/m,非常/d,简单/a,的/u,表达/v,形式/n,，/w,这种/r,表达/v,形式/n,可以/v,用/p,一种/mq,简单/a,的/u,方式/n,来/v,捕获/v,面部/n,的/u,基本/a,结构/n,：/w,原始/a,图像/n,被/p,表示/v,成/v,了/u, ,hog/en, ,形式/n,，/w,以/p,捕获/v,图像/n,的/u,主要/b,特征/n,，/w,无论/c,图像/n,明/ag,暗度/nw,如何/r,。/w,为了/p,在/p,这个/r, ,hog/en, ,图像/n,中/f,找到/v,脸部/n,，/w,我们/r,要/v,所/u,需要/v,做/v,的/u,，/w,就是/d,找到/v,我们/r,的/u,图像/n,中/f,，/w,与/p,已知/nz,的/u,一些/m, ,hog/en, ,图案/n,中/f,，/w,看/v,起来/v,最/d,相似/a,的/u,部分/n,。/w,这些/r, ,hog/en, ,图案/n,都/d,是/v,从/p,其他/r,面部/n,训练/vn,数据/n,中/f,提取/v,出来/v,的/u,：/w,使用/v,这种/r,技术/n,，/w,我们/r,现在/t,可以/v,轻松/a,地/u,在/p,任何/r,图片/n,中/f,找到/v,脸部/n,：/w,如果/c,你/r,想/v,用/p, ,python/en, ,和/c, ,dlib/en, ,亲手/d,试试看/v,，/w,这些/r,代码/n,显示/v,了/u,如何/r,生成/vn,和/c,查看/v, ,hog/en, ,图像/n,。/w,第二/m,步/q,：/w,脸部/n,的/u,不同/a,姿势/n,和/c,方位/n,当当当/nrf,，/w,我们/r,把/p,图片/n,中/f,的/u,脸/n,部分/n,离/v,出来/v,了/u,。/w, ,但/c,现在/t,，/w,我们/r,要/v,处理/v,的/u,问题/n,就/d,是/v,，/w,对于/p,电脑/n,来说/u,，/w,面朝/nz,不同/a,方向/n,的/u,同一/b,张/q,脸/n,是/v,两个人/mq,：/w,人类/n,可以/v,很/d,轻松/a,地/u,识别/v,出/v,到/v,两个/m,图片/n,都/d,是/v,同/p,一个/m,人/n,，/w,但/c,电脑会/nw,认为/v,这/r,两张/mq,图片/n,是/v,两个/m,完全/ad,不同/a,的/u,人/n,。/w,为了/p,解决/v,这/r,一点/m,，/w,我们/r,将/d,试图/v,扭曲/v,每个/r,图片/n,，/w,使得/v,眼睛/n,和/c,嘴唇/n,总是/d,在/p,图像/n,中/f,的/u,样本/n,位置/n,（/w,sample/en, ,place/en,）/w,。/w, ,这/r,将/d,使/v,我们/r,在/p,接/v,下来/v,的/u,步骤/n,中/f,，/w,更/d,容易/a,比较/d,脸部/n,之间/f,的/u,不同/a,。/w,为此/l,，/w,我们/r,将/d,使用/v,一种/mq,称为/v,面部/n,特征点/nw,估计/v,（/w,face/en, ,landmark/en, ,estimation/en,）/w,的/u,算法/n,。/w, ,很/d,多/a,方法/n,都/d,可以/v,做到/v,这/r,一点/m,，/w,但/c,这次/r,我们/r,会/v,使用/v,由/p, ,瓦希德·卡奇米/nrf,（/w,vahid/en, ,kazemi/en,）/w,和/c,约瑟菲娜·沙利文/nw,（/w,josephine/en, ,sullivan/en,）/w,在/p, ,2014/m, ,年/q,发明/v,的/u,方法/n,。/w,基本/a,思路/n,是/v,找到/v, ,68/m, ,个人/n,脸上/s,普遍/ad,存在/v,的/u,特征点/nw,（/w, ,landmarks/en,）/w,——/w,包括/v,下巴/n,的/u,顶部/f,、/w,每/r,只/d,眼睛/n,的/u,外部/f,轮廓/n,、/w,每/r,条/q,眉毛/n,的/u,内部/f,轮廓/n,等/u,。/w,接下来/l,我们/r,训练/vn,一个/m,机器/n,学习/v,算法/n,，/w,让/v,它/r,能够/v,在/p,任何/r,脸部/n,找到/v,这/r, ,68/m, ,个/q,特定/b,的/u,点/q,：/w,我们/r,将/d,在/p,每/r,一张/mq,脸上/s,定位/vn,的/u, ,68/m, ,个/q,特征点/nw,。/w,这/r,张/q,图片/n,的/u,作者/n,是/v,在/p,openface/en,工作/vn,的/u,卡内基梅隆/nrf,大学/n, ,ph/en,./w,d/en,./w, ,布兰东·阿莫斯/nrf,（/w,brandon/en, ,amos/en,）/w,。/w,这/r,是/v,在/p,测试/vn,图片/n,上/f,定位/vn, ,68/m, ,个/q,特征点/nw,的/u,结果/n,：/w,你/r,也/d,可以/v,使用/v,这/r,一/m,技术/n,来/v,实现/v,自己/r,的/u, ,snapchat/en, ,实时/n, ,3/m,d/en, ,脸部/n,过滤器/n,！/w,现在/t,，/w,我们/r,知道/v,了/u,眼睛/n,和/c,嘴巴/n,在/p,哪儿/r,，/w,我们/r,将/d,图像/n,进行/v,旋转/v,、/w,缩放/v,和/c,错切/nw,，/w,使得/v,眼睛/n,和/c,嘴巴/n,尽可能/d,靠近/v,中心/n,。/w,我们/r,不/d,会/v,做/v,任何/r,花哨/a,的/u,三维/nz,扭曲/v,，/w,因为/c,这/r,会/v,让/v,图像/n,失真/vn,。/w,我们/r,只/d,会/v,使用/v,那些/r,能够/v,保持/v,图片/n,相对/d,平行/vn,的/u,基本/a,图像/n,变换/v,，/w,例如/v,旋转/v,和/c,缩放/v,（/w,称为/v,仿射/nw,变换/v,）/w,：/w,现在/t,无论/c,人/n,脸/n,朝向/v,哪/r,边/d,，/w,我们/r,都/d,能/v,将/d,眼睛/n,和/c,嘴巴/n,向/p,中间/f,挪动/v,到/v,大致/d,相同/a,的/u,位置/n,。/w,这/r,将/d,使/v,我们/r,的/u,下/f,一步/mq,更加/d,准确/a,。/w,如果/c,你/r,想/v,用/p, ,python/en, ,和/c, ,dlib/en, ,亲手/d,试试/v,看/v,这/r,一步/mq,的话/u,，/w,这里/r,有/v,一些/m,代码/n,帮/v,你/r,寻找/v,脸部/n,特征点/nw,并/c,用/p,这些/r,特征点/nw,完成/v,图像/n,变形/v,。/w,第三/nw,步/q,：/w,给/p,脸部/n,编码/n,现在/t,我们/r,要/v,面临/v,最/d,核心/n,的/u,问题/n,了/u,——/w,准确/a,识别/v,不同/a,的/u,人脸/n,。/w,这/r,才/d,是/v,这/r,件/q,事/n,的/u,有趣/a,之/u,处/n,！/w,最/d,简单/a,的/u,人脸/n,识别/v,方法/n,，/w,是/v,把/p,我们/r,在/p,第二/m,步/q,中/f,发现/v,的/u,未知/vn,人脸/n,，/w,与/p,我们/r,已经/d,标注/v,了/u,的/u,人/n,脸/n,图片/n,作/v,比较/d,。/w,当/p,我们/r,发现/v,未知/vn,的/u,面孔/n,与/p,一个/m,以前/f,标注/v,过/u,的/u,面孔/n,看/v,起来/v,及其/c,相似/a,的/u,时候/n,，/w,它/r,肯定/v,是/v,同/p,一个/m,人/n,。/w,这个/r,想/v,看/v,起来/v,很/d,完美/a,，/w,对/p,吧/y,？/w,实际上/d,这种/r,方法/n,有/v,一个/m,巨大/a,的/u,问题/n,。/w,像/v, ,facebook/en, ,这种/r,拥有/v,数十亿/nw,用户/n,和/c,数万亿/nw,张/q,照片/n,的/u,网站/n,，/w,是/v,不/d,可能/v,去/v,循环/vn,比较/d,每张/r,先前/t,标记/n,的/u,脸/n,的/u,，/w,这/r,太/d,浪费/v,时间/n,了/u,。/w,他们/r,需要/v,在/p,毫秒/q,内识/nw,别人/r,脸/n,，/w,而/c,不/d,是/v,几/m,个/q,小时/n,。/w,我们/r,需要/v,的/u,方法/n,是/v,从/p,每张/r,人/n,脸上/s,提取/v,一些/m,基本/a,的/u,测量/vn,数值/n,。/w,然后/c,，/w,我们/r,可以/v,用/p,同样/d,的/u,方式/n,测量/vn,未知/vn,的/u,面孔/n,，/w,并/c,找到/v,最/d,接近/v,测量/vn,数值/n,的/u,那/r,张/q,已知/nz,的/u,脸/n,。/w,例如/v,，/w,我们/r,可以/v,测量/vn,每个/r,耳朵/n,的/u,大小/n,、/w,眼距/nw,、/w,鼻子/n,的/u,长度/n,等/u,。/w,如果/c,你/r,曾经/d,看/v,过/u,像/v,《/w,犯罪/vn,现场/s,调查/vn,》/w,这样/r,的/u,电视剧/n,，/w,你/r,就/d,知道/v,我/r,在/p,说/v,什么/r,了/u,。/w,测量/vn,面部/n,的/u,最/d,可靠/a,方法/n,好/a,的/u,，/w,所以/c,为了/p,建立/v,我们/r,的/u,已知/nz,脸部/n,数据库/n,呢/y,，/w,我们/r,应该/v,测量/vn,面部/n,的/u,哪些/r,数值/n,？/w,耳朵/n,的/u,大小/n,？/w,鼻子/n,的/u,长度/n,？/w,眼睛/n,的/u,颜色/n,？/w,还有/v,什么/r,？/w,事实/n,证明/v,，/w,对于/p,我们/r,人类/n,来说/u,一些/m,显而易见/i,的/u,测量值/nw,（/w,比如/v,眼睛/n,颜色/n,）/w,，/w,对/p,计算机/n,来说/u,没什么/l,意义/n,。/w,研究/vn,人员/n,发现/v,，/w,最/d,准确/a,的/u,方法/n,是/v,让/v,计算机/n,自己/r,找/v,出/v,它/r,要/v,收集/v,的/u,测量值/nw,。/w,深度/n,学习/v,在/p,寻找/v,哪些/r,部分/n,的/u,测量值/nw,比较/d,重要/a,方面/n,表现/v,的/u,比/p,人类/n,更/d,好/a,。/w,所以/c,，/w,解决/v,方案/n,是/v,训练/vn,一个/m,深度/n,卷积/nw,神经/n,网络/n,。/w,但是/c,，/w,并/c,不/d,是/v,让/v,它/r,去/v,识别/v,图片/n,中/f,的/u,物体/n,，/w,这/r,一次/mq,我们/r,的/u,训练/vn,是/v,要/v,让/v,它/r,为/p,脸部/n,生成/vn, ,128/m, ,个/q,测量值/nw,。/w,每次/r,训练/vn,要/v,观察/v,三个/m,不同/a,的/u,脸部/n,图像/n,：/w,1/m,./w, ,加/v,载/v,一张/mq,已知/nz,的/u,人/n,的/u,面部/n,训练/vn,图像/n,2/m,./w, ,加载/v,同一/b,个人/n,的/u,另/r,一张/mq,照片/n,3/m,./w, ,加/v,载/v,另外/c,一个/m,人/n,的/u,照片/n,然后/c,，/w,算法/n,查看/v,它/r,自己/r,为/p,这/r,三个/m,图片/n,生成/vn,的/u,测量值/nw,。/w,再/d,然后/c,，/w,稍微/d,调整/vn,神经/n,网络/n,，/w,以/p,确保/v,第一/m,张/q,和/c,第二/m,张/q,生成/vn,的/u,测量值/nw,接近/v,，/w,而/c,第二/m,张/q,和/c,第三/nw,张/q,生成/vn,的/u,测量值/nw,略/d,有/v,不同/a,。/w,在/p,为/p,几千/nw,个人/n,的/u,数百万/nw,图像/n,重复/v,该/r,步骤/n,几百万/nw,次/q,之后/f,，/w,神经/n,网络/n,学习/v,了/u,如何/r,可靠/a,地/u,为/p,每个/r,人/n,生成/vn, ,128/m, ,个/q,测量值/nw,。/w,对于/p,同一/b,个人/n,的/u,任何/r,十张/mq,不同/a,的/u,照片/n,，/w,它/r,都/d,应该/v,给/p,出/v,大致/d,相同/a,的/u,测量值/nw,。/w,机器/n,学习/v,专业/n,人士/n,把/p,每张/r,脸/n,的/u, ,128/m, ,个/q,测量值/nw,称为/v,一个/m,嵌入/v,（/w,embedding/en,）/w,。/w,将/d,复杂/a,的/u,原始/a,数据/n,（/w,如/v,图片/n,）/w,缩减/v,为/p,可/v,由/p,计算机/n,生成/vn,的/u,一个/m,数/m,列/v,的/u,方法/n,，/w,在/p,机器/n,学习/v,（/w,特别/d,是/v,语言/n,翻译/v,）/w,中/f,出现/v,了/u,很多/m,次/q,。/w,我们/r,正在/d,使用/v,的/u,这种/r,脸部/n,提取/v,方法/n,是/v,由/p, ,google/en, ,的/u,研究/vn,人员/n,在/p, ,2015/m, ,年/q,发明/v,的/u,，/w,但/c,也/d,有/v,许多/m,类似/v,方法/n,存在/v,。/w,给/p,我们/r,的/u,脸部/n,图像/n,编码/n,这个/r,通过/p,训练/vn,卷积/nw,神经/n,网络/n,来/v,输出/v,脸部/n,嵌入/v,的/u,过程/n,，/w,需要/v,大量/m,的/u,数据/n,和/c,强大/a,的/u,计算/v,能力/n,。/w,即使/c,使用/v,昂贵/a,的/u, ,nvidia/en, ,telsa/en, ,显卡/n,，/w,你/r,也/d,需要/v,大约/d, ,24/m, ,小时/n,的/u,连续/a,训练/vn,，/w,才/d,能/v,获得/v,良好/a,的/u,准确性/n,。/w,但/c,一旦/d,网络/n,训练/vn,完成/v,，/w,它/r,就/d,可以/v,为/p,每/r,一张/mq,脸/n,生成/vn,测量值/nw,，/w,即使/c,之前/f,它/r,从未/d,见/v,过/u,这/r,张/q,脸/n,！/w,所以/c,这种/r,训练/vn,只/d,需/v,一次/mq,即可/v,。/w,幸运/a,的/u,是/v,，/w,openface/en, ,上面/f,的/u,大牛/nw,已经/d,做/v,完/v,了/u,这些/r,，/w,并且/c,他们/r,发布/v,了/u,几/m,个/q,训练/vn,过/u,可以/v,直接/ad,使用/v,的/u,网络/n,。/w,谢谢/v,brandon/en, ,amos/en,他/r,的/u,团队/n,！/w,所以/c,我们/r,需要/v,做/v,的/u,，/w,就是/d,通过/p,他们/r,预训练/nw,的/u,网络/n,来/v,处理/v,我们/r,的/u,脸部/n,图像/n,，/w,以/p,获得/v, ,128/m, ,个/q,测量值/nw,。/w,这/r,是/v,我们/r,测试/vn,图像/n,的/u,一些/m,测量值/nw,：/w,那么/r,，/w,这/r, ,128/m, ,个/q,数字/n,到底/d,测量/vn,了/u,脸部/n,的/u,哪些/r,部分/n,？/w,我们/r,当然/d,不/d,知道/v,，/w,但是/c,这/r,对/p,我们/r,并/c,不/d,重要/a,。/w,我们/r,关心/v,的/u,是/v,，/w,当/p,看到/v,同一/b,个人/n,两张/mq,不同/a,的/u,图片/n,时/ng,，/w,我们/r,的/u,网络/n,能/v,得到/v,几乎/d,相同/a,的/u,数值/n,。/w,如果/c,你/r,想/v,自己/r,尝试/vn,这个/r,步骤/n,，/w,openface/en, ,提供/v,了/u,一个/m, ,lua/en, ,脚本/n,，/w,它/r,可以/v,生成/vn,一个/m,文件夹/n,中/f,所有/b,图像/n,的/u,嵌入/v,，/w,并/c,将/d,它们/r,写入/v, ,csv/en, ,文件/n,。/w,点此/nw,查看/v,如何/r,运行/vn,。/w,第四/nw,步/q,：/w,从/p,编码/n,中/f,找/v,出/v,人/n,的/u,名字/n,最后/f,这/r,一步/mq,实际上/d,是/v,整个/b,过程/n,中/f,最/d,简单/a,的/u,一步/mq,。/w,我们/r,要/v,做/v,的/u,就是/d,找到/v,数据库/n,中/f,，/w,与/p,我们/r,的/u,测试/vn,图像/n,的/u,测量值/nw,最/d,接近/v,的/u,那个/r,人/n,。/w,你/r,可以/v,通过/p,任何/r,基本/a,的/u,机器/n,学习/v,分类/vn,算法/n,来/v,达成/v,这/r,一/m,目标/n,。/w,我们/r,并/c,不/d,需要/v,太/d,花哨/a,的/u,深度/n,学习/v,技巧/n,。/w,我们/r,将/d,使用/v,一个/m,简单/a,的/u,线性/n, ,svm/en, ,分类器/nw,，/w,但/c,实际上/d,还有/v,很多/m,其他/r,的/u,分类/vn,算法/n,可以/v,使用/v,。/w,我们/r,需要/v,做/v,的/u,是/v,训练/vn,一个/m,分类器/nw,，/w,它/r,可以/v,从/p,一个/m,新/a,的/u,测试/vn,图像/n,中/f,获取/v,测量/vn,结果/n,，/w,并/c,找/v,出/v,最/d,匹配/vn,的/u,那个/r,人/n,。/w,分类器/nw,运行/vn,一次/mq,只/d,需要/v,几/m,毫秒/q,，/w,分类器/nw,的/u,结果/n,就/d,是/v,人/n,的/u,名字/n,！/w,所以/c,让/v,我们/r,试/v,一下/m,我们/r,的/u,系统/n,。/w,首先/d,，/w,我/r,使用/v,will/en, ,ferrell/en,,/w, ,chad/en, ,smith/en, ,and/en, ,jimmy/en, ,falon/en,三人/mq,每人/r, ,20/m, ,张/q,照片/n,的/u,嵌入/v,来/v,训练/vn,分类器/nw,：/w,嗯/e,……/w,就/d,是/v,这些/r,训练/vn,数据/n,！/w,接下来/l,，/w,我/r,在/p,这个/r,分类器/nw,上/f,运行/vn,了/u,威尔·法瑞尔/nrf,和/c,查德·史密斯/nrf,在/p,吉米·法伦/nrf,的/u,节目/n,上/f,互相/d,模仿/v,的/u,那个/r,视频/n,的/u,每/r,一帧/mq,：/w,https/en,:/w,//w,//w,cdn/en,-/w,images/en,-/w,1/m,./w,medium/en,./w,com/en,//w,max/en,//w,800/m,//w,1/m,*/w,_,gnyjr/en,3/m,jlpos/en,9/m,grtivmkfq/en,./w,gif/en,结果/n,成功/a,了/u,！/w,不同/a,角度/n,的/u,脸部/n,，/w,甚至/d,是/v,侧脸/nw,，/w,它/r,都/d,能/v,捕捉/v,到/v,！/w,自己/r,动手/v,做/v,一遍/mq,让/v,我们/r,回顾/v,一下/m,我们/r,的/u,步骤/n,：/w,1/m,./w, ,使用/v, ,hog/en, ,算法/n,给/p,图片/n,编码/n,，/w,以/p,创建/v,图片/n,的/u,简化/v,版本/n,。/w,使用/v,这个/r,简化/v,的/u,图像/n,，/w,找到/v,其中/r,看/v,起来/v,最/d,像/v,通用/vn, ,hog/en, ,面部/n,编码/n,的/u,部分/n,。/w,2/m,./w, ,通过/p,找到/v,脸上/s,的/u,主要/b,特征点/nw,，/w,找/v,出/v,脸部/n,的/u,姿势/n,。/w,一旦/d,我们/r,找到/v,这些/r,特征点/nw,，/w,就/d,利用/v,它们/r,把/p,图像/n,扭曲/v,，/w,使/v,眼睛/n,和/c,嘴巴/n,居中/v,。/w,3/m,./w, ,把/p,上/f,一步/mq,得到/v,的/u,面部/n,图像/n,放/v,入/v,神经/n,网络/n,中/f,，/w,神经/n,网络/n,知道/v,如何/r,找到/v, ,128/m, ,个/q,特征/n,测量值/nw,。/w,保存/v,这/r, ,128/m, ,个/q,测量值/nw,。/w,4/m,./w, ,看看/v,我们/r,过去/t,已经/d,测量/vn,过/u,的/u,所有/b,脸部/n,，/w,找/v,出/v,哪个/r,人/n,的/u,测量值/nw,和/c,我们/r,要/v,测量/vn,的/u,面部/n,最/d,接近/v,。/w,这/r,就/d,是/v,你/r,要/v,找/v,的/u,人/n,！/w,现在/t,你/r,知道/v,这/r,一切/r,都/d,是/v,如何/r,运行/vn,的/u,了/u,，/w,这里/r,是/v,如何/r,使用/v, ,openface/en, ,在/p,你/r,自己/r,的/u,电脑/n,上/f,运行/vn,整个/b,人/n,脸/n,识别/v,系统/n,的/u,说明/v,：/w,开始/v,之前/f,确保/v,你/r,已经/d,安装/v,了/u, ,python/en,、/w,openface/en, ,和/c, ,dlib/en,。/w,你/r,也/d,可以/v,在/p,这里/r,手动/b,安装/v,，/w,或者/c,使用/v,一个/m,已经/d,设定/v,好/a,的/u, ,docker/en, ,image/en,：/w,docker/en, ,pullbamos/en,//w,openfacedocker/en, ,run/en, ,-/w,p/en, ,9000/m,:/w,9000/m,-/w,p/en, ,8000/m,:/w,8000/m, ,-/w,t/en, ,-/w,i/en, ,bamos/en,//w,openface/en, ,//w,bin/en,//w,bashcd/en, ,//w,root/en,//w,openface/en,友情/n,提示/vn,：/w,如果/c,你/r,正在/d, ,osx/en, ,上/f,使用/v, ,docker/en,，/w,你/r,可以/v,这样/r,使/v,你/r,的/u, ,osx/en, ,//w,users/en,//w,文件夹/n,在/p, ,docker/en, ,image/en, ,中/f,可见/v,：/w,docker/en, ,run/en, ,-/w,v/en, ,//w,users/en,:/w,//w,host/en,//w,users/en, ,-/w,p/en, ,9000/m,:/w,9000/m, ,-/w,p/en,8000/m,:/w,8000/m, ,-/w,t/en, ,-/w,i/en, ,bamos/en,//w,openface/en, ,//w,bin/en,//w,bashcd/en, ,//w,root/en,//w,openface/en,然后/c,你/r,就/d,能/v,访问/v,你/r,在/p, ,docker/en, ,image/en, ,中/f, ,//w,host/en,//w,users/en,//w,./w,./w,./w,的/u, ,osx/en, ,文件/n,ls/en, ,//w,host/en,//w,users/en,//w,第一/m,步/q,在/p, ,openface/en, ,文件/n,中/f,建立/v,一个/m,名/q,为/p, ,./w,//w,training/en,-/w,images/en,//w, ,的/u,文件夹/n,。/w,mkdir/en, ,training/en,-/w,images/en,第二/m,步/q,为/p,你/r,想/v,识别/v,的/u,每个/r,人/n,建立/v,一个子/nw,文件夹/n,。/w,例如/v,：/w,mkdir/en, ,./w,//w,training/en,-/w,images/en,//w,will/en,-/w,ferrell/en,//w,mkdir/en, ,./w,//w,training/en,-/w,images/en,//w,chad/en,-/w,smith/en,//w,mkdir/en, ,./w,//w,training/en,-/w,images/en,//w,jimmy/en,-/w,fallon/en,//w,第三/nw,步/q,将/d,每个/r,人/n,的/u,所有/b,图像/n,复制/v,进/v,对应/v,的/u,子文件夹/nw,。/w,确保/v,每张/r,图像/n,上/f,只/d,出现/v,一张/mq,脸/n,。/w,不/d,需要/v,裁剪/v,脸部/n,周围/f,的/u,区域/n,。/w,openface/en, ,会/v,自己/r,裁剪/v,。/w,第四/nw,步/q,从/p, ,openface/en, ,的/u,根/q,目录/n,中/f,运行/vn,这个/r,openface/en, ,脚本/n,。/w,首先/d,，/w,进行/v,姿势/n,检测/vn,和/c,校准/v,：/w,./w,//w,util/en,//w,align/en,-/w,dlib/en,./w,py/en,./w,//w,training/en,-/w,images/en,//w, ,align/en, ,outereyesandnose/en, ,./w,//w,aligned/en,-/w,images/en,//w, ,--/nrf,size/en, ,96/m,这/r,将/d,创建/v,一个/m,名/q,为/p,./w,//w,aligned/en,-/w,images/en,//w,的/u,子文件夹/nw,，/w,里面/f,是/v,每/r,一个/m,测试/vn,图像/n,裁剪/v,过/u,、/w,并且/c,对/p,齐/d,的/u,版本/n,。/w,其次/c,，/w,从/p,对/p,齐/d,的/u,图像/n,中/f,生成/vn,特征/n,文件/n,：/w,./w,//w,batch/en,-/w,represent/en,//w,main/en,./w,lua/en,-/w,outdir/en, ,./w,//w,generated/en,-/w,embeddings/en,//w, ,-/w,data/en, ,./w,//w,aligned/en,-/w,im