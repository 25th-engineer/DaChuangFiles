adaboost/en,提升/v,算法/n,是/v,机器/n,学习/v,中/f,很/d,好/a,用/p,的/u,两个/m,算法/n,之一/r,，/w,另/r,一个/m,是/v,svm/en,支持/v,向/p,量机/nw,；/w,机器/n,学习/v,面试/v,中/f,也/d,会/v,经常/d,提问/vn,到/v,adaboost/en,的/u,一些/m,原理/n,；/w,另外/c,本文/r,还/d,介绍/v,了/u,一下/m,非/h,平衡/a,分类/vn,问题/n,的/u,解决/v,方案/n,，/w,这个/r,问题/n,在/p,面试/v,中/f,也/d,经常/d,被/p,提到/v,，/w,比如/v,信用卡/n,数据/n,集中/v,，/w,失信/v,的/u,是/v,少数/m,，/w,5/m,：/w,10000/m,的/u,情况/n,下/f,怎么/r,准确/a,分类/vn,？/w,一/m, ,引言/n,1/m, ,元/q,算法/n,（/w,集成/vn,算法/n,）/w,：/w,多/a,个/q,弱分类器/nw,的/u,组合/v,；/w,弱/a,分类器/nw,的/u,准确率/n,很/d,低/a, ,50%/mq,接近/v,随机/d,了/u,这种/r,组合/v,可以/v,是/v, ,不同/a,算法/n, ,或/c, ,同一/b,算法/n,不同/a,配置/vn, ,或是/c, ,数据集/nw,的/u,不同/a,部分/n,分配/vn,给/p,不同/a,分类器/nw,;/w,2/m, ,bagging/en,：/w,把/p,原始/a,数据集/nw,随机/d,抽样/vn,成/v,s/en,个/q,与/p,原始/a,数据集/nw,一样/u,大/a,新/a,数据集/nw,(/w,允许/v,有/v,重复/v,值/n,)/w,，/w,然后/c,训练/vn,s/en,个/q,分类器/nw,，/w,最后/f,投票/v,结果/n,集成/vn,；/w,代表/n,：/w,随机/d,森林/n,3/m, ,boosting/en,：/w,关注/v,以后/f,分类器/nw,错/n,分/q,的/u,数据/n,，/w,而/c,得到/v,新/a,的/u,分类器/nw,；/w,代表/n,：/w,adaboostbagging/en,和/c,boosting/en,类似/v,，/w,都/d,是/v,抽样/vn,的/u,方式/n,构造/v,多/a,个/q,数据集/nw,(/w,特别/d,适用/v,于/p,数据集有限/nt,的/u,时候/n,)/w,，/w,并且/c,多/a,个/q,组合/v,分类器/nw,的/u,类型/n,都/d,相同/a,，/w,但/c,bagging/en,是/v,串/v,行/v,的/u,，/w,下/f,一个/m,分类器/nw,在/p,上/f,一个/m,分类器/nw,的/u,基础/n,上/f,继续/v,训练/vn,得到/v,的/u,，/w,权重/nz,均等/vn,；/w,而/c,boosting/en,关注/v,的/u,是/v,错/n,分/q,的/u,数据/n,，/w,错/n,分/q,的/u,数据权/nw,重大/a,；/w,二/m, ,adaboost/en,(/w,adaptive/en, ,boost/en,)/w,自/p,适应/v,提升/v,算法/n,原理/n,：/w,为/p,每/r,一个/m,样本/n,赋/v,均等/vn,的/u,权重/nz,(/w,d/en, ,=/w, ,1/m,//w,n/en,)/w,，/w,先/d,用/p,这个/r,数据集/nw,训练/vn,第一/m,个/q,弱分类器/nw,，/w,计算/v,错误/n,率/v,，/w,错误/n,率/v,是/v,为了/p,计算/v,这个/r,分类器/nw,最后/f,投票/v,的/u,权重/nz,alpha/en,，/w,见/v,公式/n,：/w,；/w,错/n,分/q,的/u,样本/n,权重/nz,提升/v,，/w,对/p,分/q,的/u,样本/n,权/n,重/a,降低/v,;/w,　,然后/c,用/p,这个/r,数据集/nw,训练/vn,第二/m,个/q,若分类器/nw,，/w,迭代/vn,到/v,弱/a,分类器/nw,错误/n,率/v,为/p,0/m,或/c,迭代/vn,指定/v,个/q,数/m,的/u,弱/a,分类器/nw,停止/v,；/w,直观/a,如/v,图/n,，/w,第一/m,个/q,分类器/nw,每个/r,样本/n,权重/nz,均等/vn,，/w,最后/f,根据/p,错误/n,率/v,计算/v,alpha/en,=/w,0.69/m,;/w,然后/c,调整/vn,样本/n,权重/nz,，/w,错/n,分/q,的/u,权重/nz,增加/v,，/w,得/u,第二/m,个/q,分类器/nw,的/u,alpha/en,0.97/m,；/w,同理/v,第三/nw,个/q,分类器/nw,的/u,alpha/en,=/w,0.90/m,；/w,最后/f,投票/v,，/w,总/b,的/u,结果/n,是/v,=/w, ,0.69/m,*/w,d/en,1/m, ,+/w, ,0.97/m,*/w,d/en,2/m, ,+/w, ,0.90/m,*/w,d/en,3/m,（/w,1/m,）/w,弱/a,分类器/nw,：/w,本文/r,采用/v,是/v,时/ng,单层/nw,分类器/nw,，/w,又/d,叫/v,树桩/n,分类器/nw,，/w,是/v,决策/n,树/v,最/d,简单/a,的/u,一种/mq,；/w,def/en, ,stumpclassify/en,(/w,datamatrix/en,,/w,dimen/en,,/w,threshval/en,,/w,threshineq/en,)/w,:/w,#,just/en, ,classify/en, ,the/en, ,data/en, ,retarray/en, ,=/w, ,ones/en,(/w,(/w,shape/en,(/w,datamatrix/en,)/w,[/w,0/m,]/w,,/w,1/m,)/w,)/w, ,if/en, ,threshineq/en, ,=/w,=/w, ,'/w,lt/en,'/w,:/w, ,retarray/en,[/w,datamatrix/en,[/w,:/w,,/w,dimen/en,]/w, ,</w,=/w, ,threshval/en,]/w, ,=/w, ,-/w,1.0/m, ,else/en,:/w, ,retarray/en,[/w,datamatrix/en,[/w,:/w,,/w,dimen/en,]/w, ,>, ,threshval/en,]/w, ,=/w, ,-/w,1.0/m, ,return/en, ,retarray/en, ,def/en, ,buildstump/en,(/w,dataarr/en,,/w,classlabels/en,,/w,d/en,)/w,:/w, ,datamatrix/en, ,=/w, ,mat/en,(/w,dataarr/en,)/w,;/w, ,labelmat/en, ,=/w, ,mat/en,(/w,classlabels/en,)/w,./w,t/en, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,numsteps/en, ,=/w, ,10.0/m,;/w, ,beststump/en, ,=/w, ,{/w,}/w,;/w, ,bestclasest/en, ,=/w, ,mat/en,(/w,zeros/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,minerror/en, ,=/w, ,inf/en, ,#,init/en, ,error/en, ,sum/en,,/w, ,to/en, ,+/w,infinity/en, ,for/en, ,i/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w,#,loop/en, ,over/en, ,all/en, ,dimensions/en, ,rangemin/en, ,=/w, ,datamatrix/en,[/w,:/w,,/w,i/en,]/w,./w,min/en,(/w,)/w,;/w, ,rangemax/en, ,=/w, ,datamatrix/en,[/w,:/w,,/w,i/en,]/w,./w,max/en,(/w,)/w,;/w, ,stepsize/en, ,=/w, ,(/w,rangemax/en,-/w,rangemin/en,)/w,//w,numsteps/en, ,for/en, ,j/en, ,in/en, ,range/en,(/w,-/w,1/m,,/w,int/en,(/w,numsteps/en,)/w,+/w,1/m,)/w,:/w,#,loop/en, ,over/en, ,all/en, ,range/en, ,in/en, ,current/en, ,dimension/en, ,for/en, ,inequal/en, ,in/en, ,[/w,'/w,lt/en,'/w,,/w, ,'/w,gt/en,'/w,]/w,:/w, ,#,go/en, ,over/en, ,less/en, ,than/en, ,and/en, ,greater/en, ,than/en, ,threshval/en, ,=/w, ,(/w,rangemin/en, ,+/w, ,float/en,(/w,j/en,)/w, ,*/w, ,stepsize/en,)/w, ,predictedvals/en, ,=/w, ,stumpclassify/en,(/w,datamatrix/en,,/w,i/en,,/w,threshval/en,,/w,inequal/en,)/w,#,call/en, ,stump/en, ,classify/en, ,with/en, ,i/en,,/w, ,j/en,,/w, ,lessthan/en, ,errarr/en, ,=/w, ,mat/en,(/w,ones/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,errarr/en,[/w,predictedvals/en, ,=/w,=/w, ,labelmat/en,]/w, ,=/w, ,0/m, ,weightederror/en, ,=/w, ,d/en,./w,t/en,*/w,errarr/en, ,#,calc/en, ,total/en, ,error/en, ,multiplied/en, ,by/en, ,d/en, ,#, ,print/en, ,"/w,split/en,:/w, ,dim/en, ,%/w,d/en,,/w, ,thresh/en, ,%/w,./w,2/m,f/en,,/w, ,thresh/en, ,ineqal/en,:/w, ,%/w,s/en,,/w, ,the/en, ,weighted/en, ,error/en, ,is/en, ,%/w,./w,3/m,f/en,"/w, ,%/w, ,(/w,i/en,,/w, ,threshval/en,,/w, ,inequal/en,,/w, ,weightederror/en,)/w, ,if/en, ,weightederror/en, ,</w, ,minerror/en,:/w, ,minerror/en, ,=/w, ,weightederror/en, ,bestclasest/en, ,=/w, ,predictedvals/en,./w,copy/en,(/w,)/w, ,beststump/en,[/w,'/w,dim/en,'/w,]/w, ,=/w, ,i/en, ,beststump/en,[/w,'/w,thresh/en,'/w,]/w, ,=/w, ,threshval/en, ,beststump/en,[/w,'/w,ineq/en,'/w,]/w, ,=/w, ,inequal/en, ,return/en, ,beststump/en,,/w,minerror/en,,/w,bestclasest/en,原理/n,：/w,遍历/nw,每个/r,属性/n,，/w,以/p,一定/d,步长/nz,，/w,枚举/nr,大于/v,和/c,小于/v,：/w,找/v,一条/mq,错误/n,率/v,最/d,小/a,的/u,与/p,垂直/v,坐标轴/n,的/u,直线/n,分开/v,样本点/nw,；/w,例如/v, ,ins/en,=/w, ,(/w,a/en,,/w,b/en,,/w,c/en,)/w, ,，/w, ,找到/v,的/u,若/c,分类器/nw,是/v, ,a/en,=/w, ,1/m, ,or/en, ,b/en, ,=/w, ,2/m, ,or/en, ,c/en, ,=/w,3/m, ,这样/r,的/u,垂直/v,坐标轴/n,的/u,直线/n,；/w,（/w,2/m,）/w,adaboost/en,训练/vn,分类器/nw,的/u,代码/n,;/w,原理/n,如上/v,介绍/v,，/w,训练/vn,分类器/nw,就是/d,为了/p,得到/v,若/c,分类器/nw,的/u,参数/n,dim/en,,/w,thresh/en,,/w,ineq/en,和/c,alpha/en,,/w,前/f,三个/m,参数/n,dim/en,,/w,thresh/en,,/w,ineq/en,是/v,弱/a,分类器树桩/nw,分类器/nw,的/u,参数/n,，/w,最后/f,一个/m,alpha/en,是/v,集合/v,多/a,弱/a,分类器/nw,结果/n,的/u,权重/nz,；/w,def/en, ,adaboosttrainds/en,(/w,dataarr/en,,/w,classlabels/en,,/w,numit/en,=/w,40/m,)/w,:/w, ,weakclassarr/en, ,=/w, ,[/w,]/w, ,m/en, ,=/w, ,shape/en,(/w,dataarr/en,)/w,[/w,0/m,]/w, ,d/en, ,=/w, ,mat/en,(/w,ones/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,//w,m/en,)/w, ,#,init/en, ,d/en, ,to/en, ,all/en, ,equal/en, ,aggclassest/en, ,=/w, ,mat/en,(/w,zeros/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numit/en,)/w,:/w, ,beststump/en,,/w,error/en,,/w,classest/en, ,=/w, ,buildstump/en,(/w,dataarr/en,,/w,classlabels/en,,/w,d/en,)/w,#,build/en, ,stump/en, ,print/en, ,'/w,error/en,'/w,,/w,error/en, ,#,print/en, ,"/w,d/en,:/w,"/w,,/w,d/en,./w,t/en, ,alpha/en, ,=/w, ,float/en,(/w,0.5/m,*/w,log/en,(/w,(/w,1.0/m,-/w,error/en,)/w,//w,max/en,(/w,error/en,,/w,1/m,e/en,-/w,16/m,)/w,)/w,)/w,#,calc/en, ,alpha/en,,/w, ,throw/en, ,in/en, ,max/en,(/w,error/en,,/w,eps/en,)/w, ,to/en, ,account/en, ,for/en, ,error/en,=/w,0/m, ,beststump/en,[/w,'/w,alpha/en,'/w,]/w, ,=/w, ,alpha/en, ,weakclassarr/en,./w,append/en,(/w,beststump/en,)/w, ,#,store/en, ,stump/en, ,params/en, ,in/en, ,array/en, ,print/en, ,"/w,classest/en,:/w, ,"/w,,/w,classest/en,./w,t/en, ,expon/en, ,=/w, ,multiply/en,(/w,-/w,1/m,*/w,alpha/en,*/w,mat/en,(/w,classlabels/en,)/w,./w,t/en,,/w,classest/en,)/w, ,#,exponent/en, ,for/en, ,d/en, ,calc/en,,/w, ,getting/en, ,messy/en, ,d/en, ,=/w, ,multiply/en,(/w,d/en,,/w,exp/en,(/w,expon/en,)/w,)/w, ,#,calc/en, ,new/en, ,d/en, ,for/en, ,next/en, ,iteration/en, ,d/en, ,=/w, ,d/en,//w,d/en,./w,sum/en,(/w,)/w, ,print/en, ,'/w,d/en,'/w,,/w,d/en, ,#,calc/en, ,training/en, ,error/en, ,of/en, ,all/en, ,classifiers/en,,/w, ,if/en, ,this/en, ,is/en, ,0/m, ,quit/en, ,for/en, ,loop/en, ,early/en, ,(/w,use/en, ,break/en,)/w, ,aggclassest/en, ,+/w,=/w, ,alpha/en,*/w,classest/en, ,aggerrors/en, ,=/w, ,multiply/en,(/w,sign/en,(/w,aggclassest/en,)/w, ,!/w,=/w, ,mat/en,(/w,classlabels/en,)/w,./w,t/en,,/w,ones/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,errorrate/en, ,=/w, ,aggerrors/en,./w,sum/en,(/w,)/w,//w,m/en, ,print/en, ,"/w,total/en, ,error/en,:/w, ,"/w,,/w,errorrate/en, ,if/en, ,errorrate/en, ,=/w,=/w, ,0.0/m,:/w, ,break/en, ,return/en, ,weakclassarr/en,,/w,aggclassest/en,(/w,3/m,)/w,测试/vn,adaboost/en,代码/n,：/w,根据/p,弱/a,i/en,训练/vn,分类器/nw,得到/v,的/u,参数/n,，/w,使用/v,设置/v,参数/n,的/u,弱/a,分类器/nw,对/p,测试/vn,样本/n,进行/v,预测/v,，/w,最后/f,结果/n,通过/p,alph