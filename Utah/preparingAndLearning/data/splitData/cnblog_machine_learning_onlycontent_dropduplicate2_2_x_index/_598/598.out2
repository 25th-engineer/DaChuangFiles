本文/r,机器/n,学习/v,库/n,使用/v,的/u,部分/n,代码/n,来源于/v,spark/en,1/m,./w,0/m,./w,0/m,官方/n,文档/n,。/w,mllib/en,是/v,spark/en,对/p,机器/n,学习/v,算法/n,和/c,应用/vn,的/u,实现/v,库/n,，/w,包括/v,分类/vn,、/w,回归/v,、/w,聚类/nw,、/w,协同/v,过滤/v,、/w,降维/nw,等/u,，/w,本文/r,的/u,主要/b,内容/n,为/p,如何/r,使用/v,scala/en,语言/n,创建/v,sbt/en,工程/n,实现/v,机器/n,学习/v,算法/n,，/w,并/c,进行/v,本地/r,和/c,集群/nz,的/u,运行/vn,。/w,（/w,初/f,学者/n,建议/n,先/d,在/p,rdd/en,交互式/n,模式/n,下/f,按/p,行/v,输入/v,代码/n,，/w,以/p,熟悉/v,scala/en,架构/n,）/w,若/c,想/v,了解/v,sbt/en,等/u,相关/v,信息/n,，/w,可/v,参见/v,这里/r,。/w,1/m,./w,svm/en,（/w,linear/en, ,support/en, ,vector/en, ,machine/en,）/w,新建/v,simplesvm/en,目录/n,，/w,在/p,simplesvm/en,目录/n,下/f,，/w,创建/v,如下/v,的/u,目录/n,结构/n,：/w,simple/en,./w,sbt/en,文件/n,内容/n,如下/v,：/w,name/en, ,:/w,=/w, ,"/w,simplesvm/en, ,project/en,"/w, ,version/en, ,:/w,=/w, ,"/w,1.0/m,"/w, ,scalaversion/en, ,:/w,=/w, ,"/w,2/m,./w,10/m,./w,4/m,"/w, ,librarydependencies/en, ,+/w,=/w, ,"/w,org/en,./w,apache/en,./w,spark/en,"/w, ,%/w,%/w, ,"/w,spark/en,-/w,core/en,"/w, ,%/w, ,"/w,1/m,./w,0/m,./w,0/m,"/w, ,librarydependencies/en, ,+/w,=/w, ,"/w,org/en,./w,apache/en,./w,spark/en,"/w, ,%/w,%/w, ,"/w,spark/en,-/w,mllib/en,"/w, ,%/w, ,"/w,1/m,./w,0/m,./w,0/m,"/w, ,resolvers/en, ,+/w,=/w, ,"/w,akka/en, ,repository/en,"/w, ,at/en, ,"/w,http/en,:/w,//w,//w,repo/en,./w,akka/en,./w,io/en,//w,releases/en,//w,"/w,ps/en,：/w,由于/c,该/r,应用/vn,需要/v,调用/v,mllib/en,，/w,因此/c,要/v,特别/d,注意/v,在/p,librarydependencies/en,加入/v,spark/en,-/w,mllib/en,，/w,否则/c,会/v,编译/vn,不/d,通过/p,的/u,哦/e,。/w,simpleapp/en,./w,scala/en,文件/n,内容/n,如下/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,classification/en,./w,svmwithsgd/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,evaluation/en,./w,binaryclassificationmetrics/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,labeledpoint/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,util/en,./w,mlutils/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en,./w,_, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkconf/en, ,object/en, ,simpleapp/en,{/w, ,def/en, ,main/en,(/w,args/en,:/w, ,array/en,[/w,string/en,]/w,)/w, ,{/w, ,val/en, ,conf/en, ,=/w, ,new/en, ,sparkconf/en,(/w,)/w,./w,setappname/en,(/w,"/w,simplesvm/en, ,application/en,"/w,)/w, ,val/en, ,sc/en, ,=/w, ,new/en, ,sparkcontext/en,(/w,conf/en,)/w, ,val/en, ,data/en, ,=/w, ,mlutils/en,./w,loadlibsvmfile/en,(/w,sc/en,,/w, ,"/w,mllib/en,//w,test/en,50/m,./w,txt/en,"/w,)/w, ,val/en, ,splits/en, ,=/w, ,data/en,./w,randomsplit/en,(/w,array/en,(/w,0.6/m,,/w, ,0.4/m,)/w,,/w, ,seed/en, ,=/w, ,11/m,l/en,)/w, ,val/en, ,training/en, ,=/w, ,splits/en,(/w,0/m,)/w,./w,cache/en,(/w,)/w, ,val/en, ,test/en, ,=/w, ,splits/en,(/w,1/m,)/w, ,val/en, ,numiterations/en, ,=/w, ,100/m, ,val/en, ,model/en, ,=/w, ,svmwithsgd/en,./w,train/en,(/w,training/en,,/w, ,numiterations/en,)/w, ,model/en,./w,clearthreshold/en,(/w,)/w, ,val/en, ,scoreandlabels/en, ,=/w, ,test/en,./w,map/en, ,{/w, ,point/en, ,=/w,>, ,val/en, ,score/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,score/en,,/w, ,point/en,./w,label/en,)/w, ,}/w, ,val/en, ,metrics/en, ,=/w, ,new/en, ,binaryclassificationmetrics/en,(/w,scoreandlabels/en,)/w, ,val/en, ,auroc/en, ,=/w, ,metrics/en,./w,areaunderroc/en,(/w,)/w, ,println/en,(/w,"/w,area/en, ,under/en, ,roc/en, ,=/w, ,"/w, ,+/w, ,auroc/en,)/w, ,}/w, ,}/w,ps/en,：/w,由于/c,我们/r,之前/f,在/p,spark/en,配置/vn,过程/n,中/f,将/d,hadoop/en,路径/n,配置/vn,好/a,了/u,，/w,因此/c,这里/r,的/u,输入/v,路径/n,mllib/en,//w,test/en,50/m,./w,txt/en,实际上/d,为/p,hdfs/en,文件/n,系统/n,中/f,的/u,文件/n,，/w,存储/vn,位置/n,与/p,hadoop/en,配置/vn,文件/n,core/en,-/w,site/en,./w,xml/en,中/f,的/u,</w,name/en,>,相关/v,（/w,具体/a,可/v,参见/v,这里/r,，/w,这个/r,地方/n,很/d,容易/a,出错/v,）/w,。/w,因此/c,需要/v,先/d,将/d,test/en,50/m,./w,txt/en,文件/n,put/en,到/v,hdfs/en,上面/f,，/w,另外/c,test/en,50/m,./w,txt/en,文件/n,为/p,libsvm/en,文件/n,的/u,输入/v,格式/n,，/w,实例/n,如下/v,：/w,编译/vn,：/w,cd/en, ,~/w,//w,simplesvmsbt/en, ,package/en, , , , , ,#,打包/vn,过程/n,，/w,时间/n,可能/v,会/v,比较/d,长/a,，/w,最后/f,会/v,出现/v,[/w,success/en,]/w,xxxps/en,：/w,成功/a,后/f,会/v,生成/vn,许多/m,文件/n, ,target/en,//w,scala/en,-/w,2.10/m,//w,simplesvm/en,-/w,project/en,_,2.10/m,-/w,1/m,./w,0/m,./w,jar/en,等/u,本地/r,运行/vn,：/w,spark/en,-/w,submit/en, ,--/nrf,class/en, ,"/w,simpleapp/en,"/w, ,--/nrf,master/en, ,local/en, ,target/en,//w,scala/en,-/w,2.10/m,//w,simplesvm/en,-/w,project/en,_,2.10/m,-/w,1/m,./w,0/m,./w,jar/en,集群/nz,运行/vn,：/w,spark/en,-/w,submit/en, ,--/nrf,class/en, ,"/w,simpleapp/en,"/w, ,--/nrf,master/en, ,spark/en,:/w,//w,//w,master/en,:/w,7077/m, ,target/en,//w,scala/en,-/w,2.10/m,//w,simplesvm/en,-/w,project/en,_,2.10/m,-/w,1/m,./w,0/m,./w,jar/en,结果/n,：/w,ps/en,：/w,若/c,希望/v,在/p,算法/n,中/f,添加/vn,正/d,则/d,项/q,因子/n,，/w,可/v,将/d,simpleapp/en,./w,scala/en,文件/n,修改/v,如下/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,optimization/en,./w,l/en,1/m,updater/en, ,val/en, ,svmalg/en, ,=/w, ,new/en, ,svmwithsgd/en,(/w,)/w, ,svmalg/en,./w,optimizer/en,./w, ,setnumiterations/en,(/w,200/m,)/w,./w, ,setregparam/en,(/w,0.1/m,)/w,./w, ,setupdater/en,(/w,new/en, ,l/en,1/m,updater/en,)/w, ,val/en, ,modell/en,1/m, ,=/w, ,svmalg/en,./w,run/en,(/w,training/en,)/w,2/m,./w,逻辑/n,回归/v,（/w,logistic/en, ,regression/en,）/w,同理/v,，/w,若/c,要/v,实现/v,逻辑/n,回归/v,算法/n,则/d,只/d,需/v,将/d,simpleapp/en,./w,scala/en,文件/n,中/f,的/u,svmwithsgd/en,替换/v,为/p, ,logisticregressionwithsgd/en,。/w,3/m,./w, ,协同/v,过滤/v,（/w,collaborative/en, ,filtering/en,）/w,文件/n,系统/n,如上所示/nw,，/w,协同/v,过滤算法/nw,可以/v,将/d,只/d,需/v,将/d,simpleapp/en,./w,scala/en,文件/n,进行/v,如下/v,修改/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,als/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,rating/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en,./w,_, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkconf/en, ,object/en, ,simpleapp/en,{/w, ,def/en, ,main/en,(/w,args/en,:/w, ,array/en,[/w,string/en,]/w,)/w, ,{/w, ,val/en, ,conf/en, ,=/w, ,new/en, ,sparkconf/en,(/w,)/w,./w,setappname/en,(/w,"/w,simplecf/en, ,application/en,"/w,)/w, ,val/en, ,sc/en, ,=/w, ,new/en, ,sparkcontext/en,(/w,conf/en,)/w, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,mllib/en,//w,test/en,./w,data/en,"/w,)/w, ,val/en, ,ratings/en, ,=/w, ,data/en,./w,map/en,(/w,_,./w,split/en,(/w,'/w,,/w,'/w,)/w, ,match/en, ,{/w, ,case/en, ,array/en,(/w,user/en,,/w, ,item/en,,/w, ,rate/en,)/w, ,=/w,>, ,rating/en,(/w,user/en,./w,toint/en,,/w, ,item/en,./w,toint/en,,/w, ,rate/en,./w,todouble/en,)/w, ,}/w,)/w, ,val/en, ,rank/en, ,=/w, ,10/m, ,val/en, ,numiterations/en, ,=/w, ,5/m, ,val/en, ,model/en, ,=/w, ,als/en,./w,train/en,(/w,ratings/en,,/w, ,rank/en,,/w, ,numiterations/en,,/w, ,0.01/m,)/w, ,val/en, ,usersproducts/en, ,=/w, ,ratings/en,./w,map/en, ,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,user/en,,/w, ,product/en,)/w, ,}/w, ,val/en, ,predictions/en, ,=/w, ,model/en,./w,predict/en,(/w,usersproducts/en,)/w,./w,map/en, ,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,rate/en,)/w, ,}/w, ,val/en, ,ratesandpreds/en, ,=/w, ,ratings/en,./w,map/en, ,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,rate/en,)/w, ,}/w,./w,join/en,(/w,predictions/en,)/w, ,val/en, ,mse/en, ,=/w, ,ratesandpreds/en,./w,map/en, ,{/w, ,case/en, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,(/w,r/en,1/m,,/w, ,r/en,2/m,)/w,)/w, ,=/w,>, ,val/en, ,err/en, ,=/w, ,(/w,r/en,1/m, ,-/w, ,r/en,2/m,)/w, ,err/en, ,*/w, ,err/en, ,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,mse/en,)/w, ,}/w, ,}/w,ps/en,：/w,同理/v,，/w,mllib/en,//w,test/en,./w,data/en,存储/vn,于/p,hdfs/en,文件/n,系统/n,，/w,为/p,示例/n,数据/n,：/w,本地/r,运行/vn,：/w,spark/en,-/w,s