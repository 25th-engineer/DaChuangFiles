注/v,：/w,最近/t,开始/v,学习/v,《/w,人工智能/n,》/w,选修课/n,，/w,老师/n,提纲挈领/i,的/u,介绍/v,了/u,一番/m,，/w,听/v,完/v,课/n,只/d,了解/v,了/u,个/q,大概/d,，/w,剩下/v,的/u,细节/n,只能/v,自己/r,继续/v,摸索/v,。/w,从/p,本质/n,上/f,讲/v,：/w,机器/n,学习/v,就/d,是/v,一个/m,模型/n,对/p,外界/n,的/u,刺激/v,（/w,训练/vn,样本/n,）/w,做出/v,反应/vn,，/w,趋利避害/i,（/w,评价/v,标准/n,）/w,。/w,1/m,./w, ,什么/r,是/v,逻辑/n,回归/v,？/w,许多/m,人/n,对/p,线性/n,回归/v,都/d,比较/d,熟悉/v,，/w,但/c,知道/v,逻辑/n,回归/v,的/u,人/n,可能/v,就要/d,少/a,的/u,多/a,。/w,从/p,大/a,的/u,类别/n,上/f,来说/u,，/w,逻辑/n,回归/v,是/v,一种/mq,有/v,监督/vn,的/u,统计/v,学习/v,方法/n,，/w,主要/b,用于/v,对/p,样本/n,进行/v,分类/vn,。/w,在线性/nw,回归/v,模型/n,中/f,，/w,输出/v,一般/a,是/v,连续/a,的/u,，/w,例如/v,$/w,$/w,y/en, ,=/w, ,f/en,(/w,x/en,)/w, ,=/w, ,ax/en, ,+/w, ,b/en,$/w,$/w,，/w,对于/p,每/r,一个/m,输入/v,的/u,x/en,，/w,都/d,有/v,一个/m,对应/v,的/u,y/en,输出/v,。/w,模型/n,的/u,定义域/n,和/c,值域/n,都/d,可以/v,是/v,[/w,-/w,∞/w,,/w, ,+/w,∞/w,]/w,。/w,但是/c,对于/p,逻辑/n,回归/v,，/w,输入/v,可以/v,是/v,连续/a,的/u,[/w,-/w,∞/w,,/w, ,+/w,∞/w,]/w,，/w,但/c,输出/v,一般/a,是/v,离散/vn,的/u,，/w,即/v,只/d,有/v,有限/a,多/a,个/q,输出值/nw,。/w,例如/v,，/w,其/r,值域/n,可以/v,只/d,有/v,两个/m,值/n,{/w,0/m,,/w, ,1/m,}/w,，/w,这/r,两个/m,值/n,可以/v,表示/v,对/p,样本/n,的/u,某种/r,分类/vn,，/w,高/a,//w,低/a,、/w,患病/v,//w,健康/a,、/w,阴性/n,//w,阳性/n,等/u,，/w,这/r,就/d,是/v,最/d,常见/a,的/u,二/m,分类/vn,逻辑/n,回归/v,。/w,因此/c,，/w,从/p,整体/n,上/f,来说/u,，/w,通过/p,逻辑/n,回归/v,模型/n,，/w,我们/r,将/d,在/p,整个/b,实数/n,范围/n,上/f,的/u,x/en,映射/v,到/v,了/u,有限/a,个/q,点/q,上/f,，/w,这样/r,就/d,实现/v,了/u,对/p,x/en,的/u,分类/vn,。/w,因为/c,每次/r,拿/v,过来/v,一个/m,x/en,，/w,经过/p,逻辑/n,回归/v,分析/vn,，/w,就/d,可以/v,将/d,它/r,归入/v,某/r,一类/mq,y/en,中/f,。/w,逻辑/n,回归/v,与/p,线性/n,回归/v,的/u,关系/n,逻辑/n,回归/v,也/d,被/p,称为/v,广义线性/nw,回归/v,模型/n,，/w,它/r,与/p,线性/n,回归/v,模型/n,的/u,形式/n,基本上/d,相同/a,，/w,都/d,具有/v, ,ax/en,+/w,b/en,，/w,其中/r,a/en,和/c,b/en,是/v,待/v,求/v,参数/n,，/w,其/r,区别/n,在于/v,他们/r,的/u,因/p,变量/n,不同/a,，/w,多重线性/nw,回归/v,直接/ad,将/d,ax/en,+/w,b/en,作为/v,因/p,变量/n,，/w,即/v,y/en, ,=/w, ,ax/en,+/w,b/en,，/w,而/c,logistic/en,回归/v,则/d,通过/p,函数/n,s/en,将/d,ax/en,+/w,b/en,对应/v,到/v,一个/m,隐/vg,状态/n,p/en,，/w,p/en, ,=/w, ,s/en,(/w,ax/en,+/w,b/en,)/w,，/w,然后/c,根据/p,p/en,与/p,1/m,-/w,p/en,的/u,大小/n,决定/v,因/p,变量/n,的/u,值/n,。/w,这里/r,的/u,函数/n,s/en,就/d,是/v,sigmoid/en,函数/n,$/w,$/w,s/en,(/w,t/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,1/m, ,+/w, ,e/en,^,{/w,-/w,t/en,}/w,}/w,$/w,$/w,将/d,t/en,换/v,成/v,ax/en,+/w,b/en,，/w,可以/v,得到/v,逻辑/n,回归/v,模型/n,的/u,参数/n,形式/n,：/w,$/w,$/w,p/en,(/w,x/en,;/w, ,a/en,,/w,b/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,1/m, ,+/w, ,e/en,^,{/w,-/w,(/w,ax/en,+/w,b/en,)/w,}/w,}/w, , ,……/w,（/w,1/m,）/w,$/w,$/w,：/w,sigmoid/en,函数/n,的/u,图像/n,通过/p,函数/n,s/en,的/u,作用/n,，/w,我们/r,可以/v,将/d,输出/v,的/u,值/n,限制/v,在/p,区间/n,[/w,0/m,，/w, ,1/m,]/w,上/f,，/w,p/en,(/w,x/en,)/w,则/d,可以/v,用/p,来/v,表示/v,概率/n,p/en,(/w,y/en,=/w,1/m,|/w,x/en,)/w,，/w,即/v,当/p,一个/m,x/en,发生/v,时/ng,，/w,y/en,被/p,分/q,到/v,1/m,那/r,一组/mq,的/u,概率/n,。/w,可是/c,，/w,等等/u,，/w,我们/r,上面/f,说/v,y/en,只有/c,两种/mq,取值/v,，/w,但是/c,这里/r,却/d,出现/v,了/u,一个/m,区间/n,[/w,0/m,,/w, ,1/m,]/w,，/w,这/r,是/v,什么/r,鬼/a,？/w,？/w,其实/d,在/p,真实/a,情况/n,下/f,，/w,我们/r,最终/d,得到/v,的/u,y/en,的/u,值/n,是/v,在/p,[/w,0/m,,/w, ,1/m,]/w,这个/r,区间/n,上/f,的/u,一个/m,数/m,，/w,然后/c,我们/r,可以/v,选择/v,一个/m,阈值/n,，/w,通常/d,是/v,0.5/m,，/w,当/p,y/en,>,0.5时/t,，/w,就/d,将/d,这个/r,x/en,归/v,到/v,1/m,这/r,一类/mq,，/w,如果/c,y/en,</w,0.5/m,就/d,将/d,x/en,归/v,到/v,0/m,这/r,一类/mq,。/w,但是/c,阈值/n,是/v,可以/v,调整/vn,的/u,，/w,比如说/l,一个/m,比较/d,保守/a,的/u,人/n,，/w,可能/v,将/d,阈值/n,设/v,为/p,0.9/m,，/w,也就是说/l,有/v,超过/v,90%/mq,的/u,把握/v,，/w,才/d,相信/v,这个/r,x/en,属于/v,1/m,这/r,一类/mq,。/w,了解/v,一个/m,算法/n,，/w,最/d,好/a,的/u,办法/n,就/d,是/v,自己/r,从头/d,实现/v,一次/mq,。/w,下面/f,是/v,逻辑/n,回归/v,的/u,具体/a,实现/v,。/w,逻辑/n,回归/v,模型/n,的/u,代价/n,函数/n,逻辑/n,回归/v,一般/a,使用/v,交叉/vn,熵/g,作为/v,代价/n,函数/n,。/w,关于/p,代价/n,函数/n,的/u,具体/a,细节/n,，/w,请/v,参考/v,代价/n,函数/n,，/w,这里/r,只/d,给/p,出/v,交叉/vn,熵/g,公式/n,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,-/w,\/w,frac/en,{/w, ,1/m, ,}/w,{/w, ,m/en, ,}/w,[/w,\/w,sum/en,_,{/w, ,i/en,=/w,1/m, ,}/w,^,{/w, ,m/en, ,}/w, ,(/w,{/w,y/en,^,{/w,(/w,i/en,)/w,}/w, ,\/w,log/en, ,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,+/w, ,(/w,1/m,-/w,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,\/w,log/en, ,(/w,1/m,-/w,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w,}/w,)/w,]/w,$/w,$/w,m/en,：/w,训练/vn,样本/n,的/u,个数/n,；/w,h/en,θ,(/w,x/en,)/w,：/w,用/p,参数/n,θ,和/c,x/en,预测/v,出来/v,的/u,y/en,值/n,；/w,y/en,：/w,原/b,训练/vn,样本/n,中/f,的/u,y/en,值/n,，/w,也/d,就/d,是/v,标准/n,答案/n,上/f,角/q,标/v,(/w,i/en,)/w,：/w,第/m,i/en,个/q,样本/n,2/m,./w, ,数据/n,准备/v,下面/f,的/u,数据/n,来自/v,《/w,机器/n,学习/v,实战/n,》/w,中/f,的/u,示例/n,：/w,-/w,0.017612/m, ,14.053064/m, ,0/m, ,-/w,1.395634/m, ,4.662541/m, ,1/m, ,-/w,0.752157/m, ,6.538620/m, ,0/m, ,-/w,1.322371/m, ,7.152853/m, ,0/m, ,0.423363/m, ,11.054677/m, ,0/m, ,0.406704/m, ,7.067335/m, ,1/m, ,0.667394/m, ,12.741452/m, ,0/m, ,-/w,2.460150/m, ,6.866805/m, ,1/m, ,0.569411/m, ,9.548755/m, ,0/m, ,-/w,0.026632/m, ,10.427743/m, ,0/m,上面/f,的/u,数据/n,一共/d,是/v,3列/mq,10行/mq,，/w,其中/r,前/f,两/m,列为/v,x/en,1/m,和/c,x/en,2/m,的/u,值/n,，/w,第/m,3列/mq,表示/v,y/en,的/u,值/n,；/w,10行/mq,表示/v,取/v,了/u,10个/m,样本点/nw,。/w,我们/r,可以/v,将/d,这些/r,数据/n,当做/v,训练/vn,模型/n,参数/n,的/u,训练/vn,样本/n,。/w,见到/v,训练/vn,样本/n,就/d,可以/v,比较/d,直观/a,的/u,理解/v,算法/n,的/u,输入/v,，/w,以及/c,我们/r,如何/r,利用/v,这些/r,数据/n,来/v,训练/vn,逻辑/n,回归/v,分类器/nw,，/w,进而/c,用/p,训练/vn,好/a,的/u,模型/n,来/v,预测/v,新/a,的/u,样本/n,（/w,检测/vn,样本/n,）/w,。/w,从/p,逻辑/n,回归/v,的/u,参数/n,形式/n,，/w,式子/n,（/w,1/m,）/w,我们/r,可以/v,看到/v,逻辑/n,回归/v,模型/n,中/f,有/v,两个/m,待定/v,参数/n,a/en,（/w,x/en,的/u,系数/n,）/w,和/c,b/en,（/w,常数/n,项/q,）/w,，/w,我们/r,现在/t,给/p,出来/v,的/u,数据/n,有/v,两个/m,特征/n,x/en,1/m,,/w, ,x/en,2/m,，/w,因此/c,整个/b,模型/n,就/d,增加/v,了/u,一项/mq,：/w,ax/en,1/m, ,+/w, ,cx/en,2/m, ,+/w, ,b/en,。/w,为了/p,形式/n,上/f,的/u,统一/vn,，/w,我们/r,使用/v,带/v,下/f,标的/n,a/en,表示/v,不同/a,的/u,参数/n,（/w,a/en,0/m,表示/v,常数/n,项/q,b/en,并作/v,x/en,0/m,的/u,参数/n,</w,x/en,0/m,=/w,1/m,>,，/w,a/en,1/m,、/w,a/en,2/m,分别/d,表示/v,x/en,1/m,和/c,x/en,2/m,的/u,参数/n,）/w,，/w,就/d,可以/v,得到/v,：/w,$/w,$/w, ,a/en,_,0/m,x/en,_,0/m, ,+/w, ,a/en,_,1/m,x/en,_,1/m, ,+/w, ,a/en,_,2/m,x/en,_,2/m, ,$/w,$/w,这样/r,统一/vn,起来/v,后/f,，/w,就/d,可以/v,使用/v,矩阵/n,表示/v,了/u,（/w,比/p,起/v,前面/f,展开/v,的/u,线性/n,表示/v,方式/n,，/w,用/p,矩阵/n,表示/v,模型/n,和/c,参数/n,更加/d,简便/a,，/w,而且/c,矩阵/n,运算/vn,的/u,速度/n,也/d,更快/d,）/w,：/w,$/w,$/w, ,\/w,begin/en,{/w,bmatrix/en,}/w, ,a/en,_,0/m, ,&/w, ,a/en,_,1/m, ,&/w, ,a/en,_,2/m, ,\/w,end/en,{/w,bmatrix/en,}/w, , ,\/w,begin/en,{/w,bmatrix/en,}/w, ,x/en,_,0/m, ,\/w,\/w, ,x/en,_,1/m, ,\/w,\/w, ,x/en,_,2/m, ,\/w,end/en,{/w,bmatrix/en,}/w, ,=/w, ,a/en,^,{/w, ,\/w,mathrm/en,{/w, ,t/en, ,}/w, ,}/w,x/en,$/w,$/w,将/d,上面/f,的/u,式子/n,带入/v,到/v,（/w,1/m,）/w,式/k,，/w,我们/r,就/d,可以/v,得到/v,逻辑/n,回归/v,的/u,另/r,一种/mq,表示/v,形式/n,了/u,：/w,$/w,$/w,p/en,(/w,x/en,;/w, ,a/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,1/m, ,+/w, ,e/en,^,{/w,-/w,a/en,^,{/w, ,\/w,mathrm/en,{/w, ,t/en, ,}/w, ,}/w,x/en,}/w,}/w, , ,……/w,（/w,2/m,）/w,$/w,$/w,此时/r,，/w,可以/v,很/d,清楚/a,的/u,看到/v,，/w,我们/r,后面/f,的/u,行动/vn,都/d,是/v,为了/p,确定/v,一个/m,合适/a,的/u,a/en,（/w,一个/m,参数/n,向量/n,）/w,，/w,使得/v,对于/p,一个/m,新/a,来/v,的/u,x/en,（/w,也/d,是/v,一个/m,向量/n,）/w,，/w,我们/r,可以/v,尽可能/d,准确/a,的/u,给/p,出/v,一个/m,y/en,值/n,，/w,0/m,或者/c,1/m,./w,注/v,：/w,数据/n,是/v,二维/nr,的/u,，/w,也就是说/l,这/r,组/q,观察/v,样本/n,中/f,有/v,两个/m,自变量/n,，/w,即/v,两个/m,特征/n,（/w,feature/en,）/w,。/w,3/m,./w, ,训练/vn,分类器/nw,就/d,像/v,上面/f,说/v,的/u,，/w,训练/vn,分类器/nw,的/u,过程/n,，/w,就/d,是/v,根据/p,已经/d,知道/v,的/u,数据/n,（/w,训练/vn,样本/n,）/w,确定/v,一个/m,使得/v,代价/n,函数/n,的/u,值/n,最/d,小/a,的/u,a/en,（/w,参数/n,向量/n,//w,回归/v,系数/n,）/w,的/u,过程/n,。/w,逻辑/n,回归/v,模型/n,属于/v,有/v,监督/vn,的/u,学习/v,方法/n,，/w,上面/f,示例/n,数据/n,中/f,的/u,第/m,3列/mq,其实/d,是/v,训练/vn,样本/n,提供/v,的/u,"/w,标准/n,答案/n,"/w,。/w,也就是说/l,，/w,这些/r,数据/n,是/v,已经/d,分/q,好/a,类/q,的/u,（/w,两类/mq,，/w,0/m,或者/c,1/m,）/w,。/w,在/p,训练/vn,阶段/n,，/w,我们/r,要/v,做/v,的/u,就是/d,利用/v,训练/vn,样本/n,和/c,（/w,2/m,）/w,式/k,中/f,的/u,模型/n,，/w,估计/v,一个/m,比较/d,合适/a,的/u,参数/n,a/en,，/w,使得/v,仅/d,通过/p,前面/f,两列/mq,数据/n,（/w,观察值/nw,//w,测量值/nw,）/w,就/d,可以/v,估计/v,一个/m,值/n,h/en,(/w,a/en,)/w,，/w,这个/r,值越/nw,接近/v,标准/n,答案/n,y/en,，/w,说明/v,我们/r,的/u,模型/n,预测/v,的/u,越/d,准确/a,。/w,下面/f,是/v,估计/v,回归/v,系数/n,a/en,的/u,值/n,的/u,过程/n,，/w,还是/c,借鉴/v,了/u,《/w,机器/n,学习/v,实战/n,》/w,中/f,的/u,代码/n,，/w,做/v,了/u,少量/m,修改/v,：/w,其中/r,计算/v,参数/n,梯度/n,，/w,即/v,代价/n,函数/n,对/p,每个/r,参数/n,的/u,偏导/nw,数/m,（/w,下面/f,代码/n,中/f,的/u,第/m,36/m,-/w,38行/mq,）/w,，/w,的/u,详细/ad,推导/vn,过程/n,可以/v,参考/v,这里/r,1/m, ,'/w,'/w,'/w, ,2/m, ,created/en, ,on/en, ,oct/en, ,27/m,,/w, ,2010/m, ,3/m, ,logistic/en, ,regression/en, ,working/en, ,module/en, ,4/m, ,@/w,author/en,:/w, ,peter/en, ,5/m, ,'/w,'/w,'/w, ,6/m, ,from/en, ,numpy/en, ,import/en, ,*/w, ,7/m, ,import/en, ,os/en, ,8/m, ,9/m, ,path/en, ,=/w, ,'/w,d/en,:/w,\/w,mechinelearning/en,\/w,mlia/en,_,sourcecode/en,\/w,machinelearninginaction/en,\/w,ch/en,05/m,'/w, ,10/m, ,training/en,_,sample/en, ,=/w, ,'/w,trainingsample/en,./w,txt/en,'/w, ,11/m, ,testing/en,_,sample/en, ,=/w, ,'/w,testingsample/en,./w,txt/en,'/w, ,12/m, ,13/m, ,#, ,从/p,文件/n,中/f,读/v,入/v,训练/vn,样本/n,的/u,数据/n,，/w,同/p,上面/f,给/p,出/v,的/u,示例/n,数据/n, ,14/m, ,#, ,下面/f,第/m,20行/mq,代码/n,中/f,的/u,1.0/m,表示/v,x/en,0/m, ,=/w, ,1/m, ,15/m, ,def/en, ,loaddataset/en,(/w,p/en,,/w, ,file/en,_,n/en,)/w,:/w, ,16/m, ,datamat/en, ,=/w, ,[/w,]/w,;/w, ,labelmat/en, ,=/w, ,[/w,]/w, ,17/m, ,fr/en, ,=/w, ,open/en,(/w,os/en,./w,path/en,./w,join/en,(/w,p/en,,/w, ,file/en,_,n/en,)/w,)/w, ,18/m, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,19/m, ,linearr/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,20/m, ,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w, ,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w, ,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,#, ,三个/m,特征/n,x/en,0/m,,/w, ,x/en,1/m,,/w, ,x/en,2/m, ,21/m, ,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,#, ,标准/n,答案/n,y/en, ,22/m, ,return/en, ,datamat/en,,/w,labelmat/en, ,23/m, ,24/m, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,25/m, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w, ,26/m, ,27/m, ,#, ,梯度/n,下降/v,法求/nw,回归/v,系数/n,a/en,，/w,由于/c,样本量/n,少/a,，/w,我/r,将/d,迭代/vn,次数/n,改/v,成/v,了/u,1000次/mq, ,28/m, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w, ,classlabels/en,)/w,:/w, ,29/m, ,datamatrix/en, ,=/w, ,mat/en,(/w,datamatin/en,)/w, ,#,convert/en, ,to/en, ,numpy/en, ,matrix/en, ,30/m, ,labelmat/en, ,=/w, ,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w, ,#,convert/en, ,to/en, ,numpy/en, ,matrix/en, ,31/m, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,32/m, ,alpha/en, ,=/w, ,0.001/m, ,#, ,学习/v,率/v, ,33/m, ,maxcycles/en, ,=/w, ,1000/m, ,34/m, ,weights/en, ,=/w, ,ones/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,35/m, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxcycles/en,)/w,:/w, ,#, ,heavy/en, ,on/en, ,matrix/en, ,operations/en, ,36/m, ,h/en, ,=/w, ,sigmoid/en,(/w,datamatrix/en,*/w,weights/en,)/w, ,#, ,模型/n,预测值/n,,/w, ,90/m, ,x/en, ,1/m, ,37/m, ,error/en, ,=/w, ,h/en, ,-/w, ,labelmat/en, ,#, ,真实/a,值/n,与/p,预测值/n,之间/f,的/u,误差/n,,/w, ,90/m, ,x/en, ,1/m, ,38/m, ,temp/en, ,=/w, ,datamatrix/en,./w,transpose/en,(/w,)/w,*/w, ,error/en, ,#, ,交叉/vn,熵/g,代价/n,函数/n,对/p,所有/b,参数/n,的/u,偏导/nw,数/m,,/w, ,3/m, ,x/en, ,1/m, ,39/m, ,weights/en, ,=/w, ,weights/en, ,-/w, ,alpha/en, ,*/w, ,temp/en, ,#, ,更新/v,权重/nz, ,40/m, ,return/en, ,weights/en, ,41/m, ,42/m, ,#, ,下面/f,是/v,我/r,自己/r,写/v,的/u,测试/vn,函数/n, ,43/m, ,def/en, ,test/en,_,logistic/en,_,regression/en,(/w,)/w,:/w, ,44/m, ,dataarr/en,,/w, ,labelmat/en, ,=/w, ,loaddataset/en,(/w,path/en,,/w, ,training/en,_,sample/en,)/w, ,#, ,读/v,入/v,训练/vn,样本/n,中/f,的/u,原始/a,数据/n, ,45/m, ,a/en, ,=/w, ,gradascent/en,(/w,dataarr/en,,/w, ,labelmat/en,)/w, ,#, ,回归/v,系数/n,a/en,的/u,值/n, ,46/m, ,h/en, ,=/w, ,sigmoid/en,(/w,mat/en,(/w,dataarr/en,)/w,*/w,a/en,)/w, ,#,预测/v,结果/n,h/en,(/w,a/en,)/w,的/u,值/n, ,47/m, ,print/en,(/w,dataarr/en,,/w, ,labelmat/en,)/w, ,48/m, ,print/en,(/w,a/en,)/w, ,49/m, ,print/en,(/w,h/en,)/w, ,50/m, ,#, ,plotbestfit/en,(/w,a/en,)/w, ,51/m, ,52/m, ,test/en,_,logistic/en,_,regression/en,(/w,)/w,上面/f,代码/n,的/u,输出/v,如下/v,：/w,一个/m,元组/nw,，/w,包含/v,两个/m,数组/n,：/w,第一/m,个/q,数组/n,是/v,所有/b,的/u,训练/vn,样本/n,中/f,的/u,观察值/nw,，/w,也/d,就/d,是/v,x/en,，/w,包括/v,x/en,0/m,,/w, ,x/en,1/m,,/w, ,x/en,2/m,；/w,第二/m,个/q,数组/n,是/v,每组/r,观察值/nw,对应/v,的/u,标准/n,答案/n,y/en,。/w,(/w,[/w,[/w,1.0/m,,/w, ,-/w,0.017612/m,,/w, ,14.053064/m,]/w,,/w, ,[/w,1.0/m,,/w, ,-/w,1.395634/m,,/w, ,4.662541/m,]/w,,/w, ,[/w,1.0/m,,/w, ,-/w,0.752157/m,,/w, ,6.53862/m,]/w,,/w, ,[/w,1.0/m,,/w, ,-/w,1.322371/m,,/w, ,7.152853/m,]/w,,/w, ,[/w,1.0/m,,/w, ,0.423363/m,,/w, ,11.054677/m,]/w,,/w, ,[/w,1.0/m,,/w, ,0.406704/m,,/w, ,7.067335/m,]/w,,/w, ,[/w,1.0/m,,/w, ,0.667394/m,,/w, ,12.741452/m,]/w,,/w, ,[/w,1.0/m,,/w, ,-/w,2.46015/m,,/w, ,6.866805/m,]/w,,/w, ,[/w,1.0/m,,/w, ,0.569411/m,,/w, ,9.548755/m,]/w,,/w, ,[/w,1.0/m,,/w, ,-/w,0.026632/m,,/w, ,10.427743/m,]/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,]/w,)/w,本次/r,预测/v,出来/v,的/u,回归/v,系数/n,a/en,，/w,包括/v,a/en,0/m,,/w, ,a/en,1/m,,/w, ,a/en,2/m,[/w,[/w, ,1.39174871/m,]/w, ,[/w,-/w,0.5227482/m, ,]/w, ,[/w,-/w,0.33100373/m,]/w,]/w,根据/p,回归/v,系数/n,a/en,和/c,（/w,2/m,）/w,式/k,中/f,的/u,模型/n,预测/v,出来/v,的/u,h/en,(/w,a/en,)/w,。/w,这里/r,预测/v,得到/v,的/u,结果/n,都/d,是/v,区间/n,(/w,0/m,,/w, ,1/m,)/w,上/f,的/u,实数/n,。/w,[/w,[/w, ,0.03730313/m,]/w, ,[/w, ,0.64060602/m,]/w, ,[/w, ,0.40627881/m,]/w, ,[/w, ,0.4293251/m, ,]/w, ,[/w, ,0.07665396/m,]/w, ,[/w, ,0.23863652/m,]/w, ,[/w, ,0.0401329/m, ,]/w, ,[/w, ,0.59985228/m,]/w, ,[/w, ,0.11238742/m,]/w, ,[/w, ,0.11446212/m,]/w,]/w,标准/n,答案/n,是/v,{/w,0/m,,/w, ,1/m,}/w,，/w,如何/r,将/d,预测/v,到/v,的/u,结果/n,与/p,标准/n,答案/n,y/en,进行/v,比较/d,呢/y,？/w,取/v,0.5/m,作为/v,阈值/n,，/w,大于/v,该值/nw,的/u,样本/n,就/d,划分/v,到/v,1/m,这/r,一组/mq,，/w,小于/v,等于/v,该值/nw,的/u,样本/n,就/d,划分/v,到/v,0/m,这/r,一组/mq,，/w,这样/r,就/d,可以/v,将/d,数据/n,分为/v,两类/mq,。/w,检查/vn,一下/m,结果/n,可以/v,看到/v,，/w,我们/r,现在/t,分/q,出来/v,的/u,1/m,这/r,一类/mq,中/f,包括/v,原来/d,y/en,=/w,1/m,的/u,两个/m,样本/n,，/w,另/r,一类/mq,包括/v,原来/d,y/en,=/w,0/m,的/u,所有/b,样本/n,和/c,一个/m,y/en,=/w,1/m,的/u,样本/n,（/w,分/q,错/n,了/u,）/w,。/w,鉴于/p,我们/r,选择/v,取/v,的/u,样本/n,比较/d,少/a,（/w,只有/c,10个/m,）/w,，/w,这样/r,的/u,效果/n,其实/d,还/d,算/v,非常/d,不错/a,的/u,！/w,4/m,./w, ,结果/n,展示/v,上面/f,已经/d,求/v,出/v,了/u,一组/mq,回归/v,系数/n,，/w,它/r,确定/v,了/u,不同/a,类别/n,数据/n,之间/f,的/u,分割线/nw,。/w,可以/v,利用/v,x/en,内部/f,（/w,x/en,1/m,与/p,x/en,2/m,之间/f,的/u,关系/n,）/w,的/u,关系/n,画/v,出/v,该/r,分割线/nw,，/w,从而/c,更/d,直观/a,的/u,感受/v,到/v,分类/vn,的/u,效果/n,。/w,添加/vn,下面/f,一段/mq,代码/n,：/w,1/m, ,#, ,分类/vn,效果/n,展示/v,，/w,参数/n,weights/en,就/d,是/v,回归/v,系数/n, ,2/m, ,def/en, ,plotbestfit/en,(/w,weights/en,)/w,:/w, ,3/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,4/m, ,datamat/en,,/w,labelmat/en,=/w,loaddataset/en,(/w,path/en,,/w, ,training/en,_,sample/en,)/w, ,5/m, ,dataarr/en, ,=/w, ,array/en,(/w,datamat/en,)/w, ,6/m, ,n/en, ,=/w, ,shape/en,(/w,dataarr/en,)/w,[/w,0/m,]/w, ,7/m, ,xcord/en,1/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,1/m, ,=/w, ,[/w,]/w, ,8/m, ,xcord/en,2/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,2/m, ,=/w, ,[/w,]/w, ,9/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,10/m, ,if/en, ,int/en,(/w,labelmat/en,[/w,i/en,]/w,)/w,=/w,=/w, ,1/m,:/w, ,11/m, ,xcord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,12/m, ,else/en,:/w, ,13/m, ,xcord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,14/m, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,)/w, ,15/m, ,ax/en, ,=/w, ,fig/en,./w,add/en,_,subplot/en,(/w,111/m,)/w, ,16/m, ,ax/en,./w,scatter/en,(/w,xcord/en,1/m,,/w, ,ycord/en,1/m,,/w, ,s/en,=/w,30/m,,/w, ,c/en,=/w,'/w,red/en,'/w,,/w, ,marker/en,=/w,'/w,s/en,'/w,)/w, ,17/m, ,ax/en,./w,scatter/en,(/w,xcord/en,2/m,,/w, ,ycord/en,2/m,,/w, ,s/en,=/w,30/m,,/w, ,c/en,=/w,'/w,green/en,'/w,)/w, ,18/m, ,x/en, ,=/w, ,arange/en,(/w,-/w,3.0/m,,/w, ,3.0/m,,/w, ,0.1/m,)/w, ,19/m, ,y/en, ,=/w, ,(/w,-/w,weights/en,[/w,0/m,]/w,-/w,weights/en,[/w,1/m,]/w,*/w,x/en,)/w,//w,weights/en,[/w,2/m,]/w, ,#, ,x/en,2/m, ,=/w, ,f/en,(/w,x/en,1/m,)/w, ,20/m, ,ax/en,./w,plot/en,(/w,x/en,./w,reshape/en,(/w,1/m,,/w, ,-/w,1/m,)/w,,/w, ,y/en,./w,reshape/en,(/w,1/m,,/w, ,-/w,1/m,)/w,)/w, ,21/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,1/m,'/w,)/w,;/w, ,plt/en,./w,ylabel/en,(/w,'/w,x/en,2/m,'/w,)/w,;/w, ,22/m, ,plt/en,./w,show/en,(/w,)/w,将/d,上面/f,的/u,test/en,_,logistic/en,_,regression/en,(/w,)/w,函数/n,中/f,的/u,最后/f,一句/mq,注释/vn,去掉/v,，/w,调用/v,plotbestfit/en,函数/n,就/d,可以/v,看到/v,分类/vn,的/u,效果/n,了/u,。/w,这里/r,说明/v,一下/m,上面/f,代码/n,中/f,的/u,第/m,19行/mq,，/w,这里/r,设置/v,了/u,sigmoid/en,函数/n,的/u,取值/v,为/p,1/m,//w,2/m,，/w,也就是说/l,取/v,阈值/n,为/p,0.5/m,来/v,划分/v,最后/f,预测/v,的/u,结果/n,。/w,这样/r,可以/v,得到/v,$/w,$/w,e/en,^,{/w,-/w,a/en,^,{/w, ,\/w,mathrm/en,{/w, ,t/en, ,}/w, ,}/w,x/en,}/w, ,=/w, ,1/m,$/w,$/w,，/w,即/v,$/w,-/w,a/en,^,tx/en,=/w,0/m,$/w,，/w,可以/v,推出/v,$/w,x/en,_,2/m, ,=/w, ,(/w,-/w,a/en,_,0/m,x/en,_,0/m, ,-/w, ,a/en,_,1/m,x/en,_,1/m,)/w,//w,a/en,_,2/m,$/w,，/w,同/p,