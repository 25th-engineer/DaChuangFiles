1/m,./w, ,the/en, ,problem/en, ,of/en, ,overfitting/en,1/m,还是/c,来看/v,预测/v,房价/n,的/u,这个/r,例子/n,，/w,我们/r,先/d,对/p,该/r,数据/n,做/v,线性/n,回归/v,，/w,也/d,就/d,是/v,左边/f,第一/m,张/q,图/n,。/w,如果/c,这么/r,做/v,，/w,我们/r,可以/v,获得/v,拟合/nz,数据/n,的/u,这样/r,一条/mq,直线/n,，/w,但是/c,，/w,实际上/d,这/r,并/c,不/d,是/v,一个/m,很/d,好/a,的/u,模型/n,。/w,我们/r,看看/v,这些/r,数据/n,，/w,很/d,明显/a,，/w,随着/p,房子/n,面积/n,增大/v,，/w,住房/n,价格/n,的/u,变化/vn,趋于/v,稳定/a,或者说/nw,越/d,往/p,右/f,越/d,平缓/a,。/w,因此/c,线性/n,回归/v,并/c,没有/v,很/d,好/a,拟合/nz,训练/vn,数据/n,。/w,我们/r,把/p,此类/r,情况/n,称为/v,欠/v,拟合/nz,(/w,underfitting/en,)/w,，/w,或者/c,叫作/v,叫做/v,高偏差/nw,(/w,bias/en,)/w,。/w,这/r,两种/mq,说法/n,大致/d,相似/a,，/w,都/d,表示/v,没有/v,很/d,好/a,地/u,拟合/nz,训练/vn,数据/n,。/w,高偏差/nw,这个/r,词/n,是/v, ,machine/en, ,learning/en, ,的/u,研究/vn,初期/f,传/v,下来/v,的/u,一个/m,专业/n,名词/n,，/w,具体/a,到/v,这个/r,问题/n,，/w,意思/n,就是说/c,如果/c,用/p,线性/n,回归/v,这个/r,算法/n,去/v,拟合/nz,训练/vn,数据/n,，/w,那么/r,该/r,算法/n,实际上/d,会/v,产生/v,一个/m,非常/d,大/a,的/u,偏差/n,或者说/nw,存在/v,一个/m,很/d,强/a,的/u,偏见/n,。/w,第二/m,幅/q,图/n,，/w,我们/r,在/p,中间/f,加入/v,一个/m,二次/mq,项/q,，/w,也就是说/l,对于/p,这/r,幅/q,数据/n,我们/r,用/p,二次/mq,函数/n,去/v,拟合/nz,。/w,自然/d,，/w,可以/v,拟合/nz,出/v,一条/mq,曲线/n,，/w,事实/n,也/d,证明/v,这个/r,拟合/nz,效果/n,很/d,好/a,。/w,另/r,一个/m,极端/n,情况/n,是/v,，/w,如果/c,在/p,第三/nw,幅/q,图/n,中/f,对于/p,该/r,数据集/nw,用/p,一个/m,四次/mq,多项式/n,来/v,拟合/nz,。/w,因此/c,在/p,这里/r,我们/r,有/v,五个/m,参数/n,θ,0/m,到/v,θ,4/m,，/w,这样/r,我们/r,同样/d,可以/v,拟合/nz,一条/mq,曲线/n,，/w,通过/p,我们/r,的/u,五个/m,训练/vn,样本/n,，/w,我们/r,可以/v,得到/v,如/v,右图/n,的/u,一条/mq,曲线/n,。/w,一方面/c,，/w,我们/r,似乎/d,对/p,训练/vn,数据/n,做/v,了/u,一个/m,很/d,好/a,的/u,拟合/nz,，/w,因为/c,这/r,条/q,曲线/n,通过/p,了/u,所有/b,的/u,训练/vn,实例/n,。/w,但是/c,，/w,这/r,实际上/d,是/v,一条/mq,很/d,扭曲/v,的/u,曲线/n,，/w,它/r,不停/v,上下/f,波动/vn,。/w,因此/c,，/w,事实上/l,我们/r,并/c,不/d,认为/v,它/r,是/v,一个/m,预测/v,房价/n,的/u,好/a,模型/n,。/w,所以/c,，/w,我们/r,把/p,这/r,类/q,情况/n,叫做/v,过/u,拟合/nz,(/w,overfitting/en,)/w,，/w,也/d,叫/v,高方/nr,差/a,(/w,variance/en,)/w,。/w,与/p,高偏差/nw,一样/u,，/w,高方/nr,差/a,同样/d,也/d,是/v,一个/m,历史/n,上/f,的/u,叫法/n,。/w,从/p,第一/m,印象/n,上/f,来说/u,，/w,如果/c,我们/r,拟合/nz,一个/m,高阶/nz,多/a,项式/nr,，/w,那么/r,这个/r,函数/n,能/v,很/d,好/a,的/u,拟合/nz,训练集/nw,（/w,能/v,拟合/nz,几乎/d,所有/b,的/u,训练/vn,数据/n,）/w,，/w,但/c,这/r,也/d,就/d,面临/v,函数/n,可能/v,太/d,过/u,庞大/a,的/u,问题/n,，/w,变量/n,太/d,多/a,。/w,同时/c,如果/c,我们/r,没有/v,足够/v,的/u,数据集/nw,（/w,训练集/nw,）/w,去/v,约束/vn,这个/r,变量/n,过多/d,的/u,模型/n,，/w,那么/r,就/d,会/v,发生/v,过/u,拟合/nz,。/w,2/m,过度/d,拟合/nz,的/u,问题/n,通常/d,发生/v,在/p,变量/n,（/w,特征/n,）/w,过多/d,的/u,时候/n,。/w,这种/r,情况/n,下/f,训练/vn,出/v,的/u,方程/n,总是/d,能/v,很/d,好/a,的/u,拟合/nz,训练/vn,数据/n,，/w,也就是说/l,，/w,我们/r,的/u,代价/n,函数/n,可能/v,非常/d,接近/v,于/p, ,0/m, ,或者/c,就/d,为/p, ,0/m,。/w,但是/c,，/w,这样/r,的/u,曲线/n,千方百计/i,的/u,去/v,拟合/nz,训练/vn,数据/n,，/w,这样/r,会/v,导致/v,它/r,无法/v,泛化/nw,到/v,新/a,的/u,数据/n,样本/n,中/f,，/w,以至于/c,无法/v,预测/v,新/a,样本/n,价格/n,。/w,在/p,这里/r,，/w,术语/n,"/w,泛化/nw,"/w,指/v,的/u,是/v,一个/m,假设/v,模型/n,能够/v,应用/vn,到/v,新/a,样本/n,的/u,能力/n,。/w,新/a,样本/n,数据/n,是/v,指/v,没有/v,出现/v,在/p,训练/vn,集中/v,的/u,数据/n,。/w,之前/f,，/w,我们/r,看到/v,了/u,线性/n,回归/v,情况/n,下/f,的/u,过/u,拟合/nz,。/w,类似/v,的/u,情况/n,也/d,适用/v,于/p,逻辑/n,回归/v,。/w,3/m,那么/r,，/w,如果/c,发生/v,了/u,过/u,拟合/nz,问题/n,，/w,我们/r,应该/v,如何/r,处理/v,？/w,过多/d,的/u,变量/n,（/w,特征/n,）/w,，/w,同时/c,只有/c,非常/d,少/a,的/u,训练/vn,数据/n,，/w,会/v,导致/v,出现/v,过度/d,拟合/nz,的/u,问题/n,。/w,因此/c,为了/p,解决/v,过度/d,拟合/nz,，/w,有/v,以下/f,两个/m,办法/n,。/w,方法/n,一/m,：/w,尽量/d,减少/v,选取/v,变量/n,的/u,数量/n,具体而言/nw,，/w,我们/r,可以/v,人工/n,检查/vn,每/r,一项/mq,变量/n,，/w,并/c,以此/d,来/v,确定/v,哪些/r,变量/n,更为/d,重要/a,，/w,然后/c,，/w,保留/v,那些/r,更为/d,重要/a,的/u,特征/n,变量/n,。/w,至于/p,，/w,哪些/r,变量/n,应该/v,舍弃/v,，/w,我们/r,以后/f,在/p,讨论/v,，/w,这/r,会/v,涉及/v,到/v,模型/n,选择/v,算法/n,，/w,这种/r,算法/n,是/v,可以/v,自动/d,选择/v,采用/v,哪些/r,特征/n,变量/n,，/w,自动/d,舍弃/v,不/d,需要/v,的/u,变量/n,。/w,这/r,类/q,做法/n,非常/d,有效/a,，/w,但是/c,其/r,缺点/n,是/v,当/p,你/r,舍弃/v,一部分/m,特征/n,变量/n,时/ng,，/w,你/r,也/d,舍弃/v,了/u,问题/n,中/f,的/u,一些/m,信息/n,。/w,例如/v,，/w,也许/d,所有/b,的/u,特征/n,变量/n,对于/p,预测/v,房价/n,都/d,是/v,有用/a,的/u,，/w,我们/r,实际上/d,并不/d,想/v,舍弃/v,一些/m,信息/n,或者说/nw,舍弃/v,这些/r,特征/n,变量/n,。/w,方法/n,二/m,：/w,正则化/nw,正则化/nw,中/f,我们/r,将/d,保留/v,所有/b,的/u,特征/n,变量/n,，/w,但是/c,会/v,减/v,小/a,特征/n,变量/n,的/u,数量级/n,（/w,参数/n,数值/n,的/u,大小/n,θ,(/w,j/en,)/w,）/w,。/w,这个/r,方法/n,非常/d,有效/a,，/w,当/p,我们/r,有/v,很多/m,特征/n,变量/n,时/ng,，/w,其中/r,每/r,一个/m,变量/n,都/d,能/v,对/p,预测/v,产生/v,一点/m,影响/vn,。/w,正如/v,我们/r,在/p,房价/n,预测/v,的/u,例子/n,中/f,看到/v,的/u,那样/r,，/w,我们/r,可以/v,有/v,很多/m,特征/n,变量/n,，/w,其中/r,每/r,一个/m,变量/n,都/d,是/v,有用/a,的/u,，/w,因此/c,我们/r,不/d,希望/v,把/p,它们/r,删掉/v,，/w,这/r,就/d,导致/v,了/u,正则化/nw,概念/n,的/u,发生/v,。/w,接下来/l,我们/r,会/v,讨论/v,怎样/r,应用/vn,正则化/nw,和/c,什么/r,叫做/v,正则化/nw,均值/n,，/w,然后/c,将/d,开始/v,讨论/v,怎样/r,使用/v,正则化/nw,来/v,使/v,学习/v,算法/n,正常/a,工作/vn,，/w,并/c,避免/v,过/u,拟合/nz,。/w,2/m,./w, ,cost/en, ,function/en,1/m,在/p,前面/f,的/u,介绍/v,中/f,，/w,我们/r,看到/v,了/u,如果/c,用/p,一个/m,二次/mq,函数/n,来/v,拟合/nz,这些/r,数据/n,，/w,那么/r,它/r,给/p,了/u,我们/r,一个/m,对/p,数据/n,很/d,好/a,的/u,拟合/nz,。/w,然而/c,，/w,如果/c,我们/r,用/p,一个/m,更/d,高/a,次/q,的/u,多/a,项式/nr,去/v,拟合/nz,，/w,最终/d,我们/r,可能/v,会/v,得到/v,一个/m,曲线/n,，/w,它/r,能/v,很/d,好/a,地/u,拟合/nz,训练集/nw,，/w,但/c,却/d,并/c,不/d,是/v,一个/m,好/a,的/u,结果/n,，/w,因为/c,它/r,过度/d,拟合/nz,了/u,数据/n,，/w,因此/c,，/w,一般性/n,并/c,不/d,是/v,很/d,好/a,。/w,让/v,我们/r,考虑/v,下面/f,的/u,假设/v,，/w,我们/r,想/v,要/v,加上/v,惩罚/vn,项/q,，/w,从而/c,使/v,参数/n, ,θ,3/m, ,和/c, ,θ,4/m, ,足够/v,的/u,小/a,。/w,这里/r,我/r,的/u,意思/n,就/d,是/v,，/w,上图/n,的/u,式子/n,是/v,我们/r,的/u,优化/v,目标/n,，/w,也就是说/l,我们/r,需要/v,尽量/d,减少/v,代价/n,函数/n,的/u,均方/nw,误差/n,。/w,对于/p,这个/r,函数/n,我们/r,对/p,它/r,添加/vn,一些/m,项/q,，/w,加上/v, ,1000/m, ,乘/v,以/p, ,θ,3/m, ,的/u,平方/q,，/w,再/d,加上/v, ,1000/m, ,乘/v,以/p, ,θ,4/m, ,的/u,平方/q,，/w,1000/m, ,只是/d,我/r,随便/ad,写/v,的/u,某个/r,较/d,大/a,的/u,数字/n,而已/y,。/w,现在/t,，/w,如果/c,我们/r,要/v,最小化/nw,这个/r,函数/n,，/w,那么/r,为了/p,最小化/nw,这个/r,新/a,的/u,代价/n,函数/n,，/w,我们/r,要/v,让/v, ,θ,3/m, ,和/c, ,θ,4/m, ,尽可能/d,小/a,。/w,因为/c,，/w,如果/c,你/r,在/p,原有/v,代价/n,函数/n,的/u,基础/n,上/f,加上/v, ,1000/m, ,乘/v,以/p, ,θ,3/m, ,这/r,一项/mq, ,，/w,那么/r,这个/r,新/a,的/u,代价/n,函数/n,将/d,变/v,得/u,很/d,大/a,，/w,所以/c,，/w,当/p,我们/r,最小化/nw,这个/r,新/a,的/u,代价/n,函数/n,时/ng,，/w, ,我们/r,将/d,使/v, ,θ,3/m, ,的/u,值/n,接近/v,于/p, ,0/m,，/w,同样/d, ,θ,4/m, ,的/u,值/n,也/d,接近/v,于/p, ,0/m,，/w,就/d,像/v,我们/r,忽略/v,了/u,这/r,两个/m,值/n,一样/u,。/w,如果/c,我们/r,做到/v,这/r,一点/m,（/w, ,θ,3/m, ,和/c, ,θ,4/m, ,接近/v, ,0/m, ,）/w,，/w,那么/r,我们/r,将/d,得到/v,一个/m,近似/a,的/u,二次/mq,函数/n,。/w,因此/c,，/w,我们/r,最终/d,恰当/a,地/u,拟合/nz,了/u,数据/n,，/w,我们/r,所/u,使用/v,的/u,正是/v,二次/mq,函数/n,加上/v,一些/m,非常/d,小/a,，/w,贡献/n,很/d,小项/n,（/w,因为/c,这些/r,项/q,的/u, ,θ,3/m,、/w, ,θ,4/m, ,非常/d,接近/v,于/p,0/m,）/w,。/w,显然/ad,，/w,这/r,是/v,一个/m,更/d,好/a,的/u,假设/v,。/w,2更/mq,一般/a,地/u,，/w,这里/r,给/p,出/v,了/u,正规化/vn,背后/f,的/u,思路/n,。/w,这种/r,思路/n,就是/d,，/w,如果/c,我们/r,的/u,参数/n,值/n,对应/v,一个/m,较/d,小值/nw,的话/u,（/w,参数/n,值/n,比较/d,小/a,）/w,，/w,那么/r,往往/d,我们/r,会/v,得到/v,一个/m,形式/n,更/d,简单/a,的/u,假设/v,。/w,在/p,我们/r,上面/f,的/u,例子/n,中/f,，/w,我们/r,惩罚/vn,的/u,只是/d, ,θ,3/m, ,和/c, ,θ,4/m, ,，/w,使/v,这/r,两个/m,值均/nw,接近/v,于/p,零/m,，/w,从而/c,我们/r,得到/v,了/u,一个/m,更/d,简单/a,的/u,假设/v,，/w,实际上/d,这个/r,假设/v,大抵/d,上/f,是/v,一个/m,二次/mq,函数/n,。/w,但/c,更/d,一般地说/l,，/w,如果/c,我们/r,像/v,惩罚/vn, ,θ,3/m, ,和/c, ,θ,4/m, ,这样/r,惩罚/vn,其它/r,参数/n,，/w,那么/r,我们/r,往往/d,可以/v,得到/v,一个/m,相对/d,较为/d,简单/a,的/u,假设/v,。/w,实际上/d,，/w,这些/r,参数/n,的/u,值/n,越/d,小/a,，/w,通常/d,对应/v,于/p,越/d,光滑/a,的/u,函数/n,，/w,也/d,就/d,是/v,更加/d,简单/a,的/u,函数/n,。/w,因此/c, ,就/d,不易/a,发生/v,过/u,拟合/nz,的/u,问题/n,。/w,我/r,知道/v,，/w,为什么/r,越/d,小/a,的/u,参数/n,对应/v,于/p,一个/m,相对/d,较为/d,简单/a,的/u,假设/v,，/w,对/p,你/r,来说/u,现在/t,不/d,一定/d,完全/ad,理解/v,，/w,但是/c,在/p,上面/f,的/u,例子/n,中/f,使/v, ,θ,3/m, ,和/c, ,θ,4/m, ,很小/a,，/w,并且/c,这样/r,做/v,能/v,给/p,我们/r,一个/m,更加/d,简单/a,的/u,假设/v,，/w,这个/r,例子/n,至少/d,给/p,了/u,我们/r,一些/m,直观/a,感受/v,。/w,来/v,让/v,我们/r,看看/v,具体/a,的/u,例子/n,，/w,对于/p,房屋/n,价格/n,预测/v,我们/r,可能/v,有/v,上百/j,种/q,特征/n,，/w,与/p,刚刚/d,所/u,讲/v,的/u,多/a,项式/nr,例子/n,不同/a,，/w,我们/r,并/c,不/d,知道/v, ,θ,3/m, ,和/c, ,θ,4/m, ,是/v,高阶/nz,多/a,项式/nr,的/u,项/q,。/w,所以/c,，/w,如果/c,我们/r,有/v,一百个/m,特征/n,，/w,我们/r,并/c,不/d,知道/v,如何/r,选择/v,关联度/n,更/d,好/a,的/u,参数/n,，/w,如何/r,缩小/v,参数/n,的/u,数目/n,等等/u,。/w,因此/c,在/p,正则化/nw,里/f,，/w,我们/r,要/v,做/v,的/u,事情/n,，/w,就是/d,把/p,减/v,小/a,我们/r,的/u,代价/n,函数/n,（/w,例子/n,中/f,是/v,线性/n,回归/v,的/u,代价/n,函数/n,）/w,所有/b,的/u,参数/n,值/n,，/w,因为/c,我们/r,并/c,不/d,知道/v,是/v,哪/r,一个/m,或/c,哪/r,几/m,个/q,要/v,去/v,缩小/v,。/w,因此/c,，/w,我们/r,需要/v,修改/v,代价/n,函数/n,，/w,在/p,这/r,后面/f,添加/vn,一项/mq,，/w,就/d,像/v,我们/r,在/p,方括号/n,里/f,的/u,这项/r,。/w,当/p,我们/r,添加/vn,一个/m,额外/b,的/u,正则化/nw,项/q,的/u,时候/n,，/w,我们/r,收缩/v,了/u,每个/r,参数/n,。/w,顺便/d,说/v,一下/m,，/w,按照/p,惯例/n,，/w,我们/r,没有/v,去/v,惩罚/vn, ,θ,0/m,，/w,因此/c, ,θ,0/m, ,的/u,值/n,是/v,大/a,的/u,。/w,这/r,就/d,是/v,一个/m,约定/vn,从/p, ,1/m, ,到/v, ,n/en, ,的/u,求和/vn,，/w,而/c,不/d,是/v,从/p, ,0/m, ,到/v, ,n/en, ,的/u,求和/vn,。/w,但/c,其实/d,在/p,实践/v,中/f,这/r,只/d,会/v,有/v,非常/d,小/a,的/u,差异/n,，/w,无论/c,你/r,是否/v,包括/v,这/r, ,θ,0/m, ,这项/r,。/w,但是/c,按照/p,惯例/n,，/w,通常/d,情况/n,下/f,我们/r,还是/c,只/d,从/p, ,