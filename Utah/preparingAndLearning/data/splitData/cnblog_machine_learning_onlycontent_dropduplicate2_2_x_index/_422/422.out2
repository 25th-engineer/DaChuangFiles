在/p,做/v,数据/n,处理/v,时/ng,，/w,需要/v,用/p,到/v,不同/a,的/u,手法/n,，/w,如/v,特征/n,标准化/vn,，/w,主/n,成分/n,分析/vn,，/w,等等/u,会/v,重复/v,用/p,到/v,某些/r,参数/n,，/w,sklearn/en,中/f,提供/v,了/u,管道/n,，/w,可以/v,一次性/d,的/u,解决/v,该/r,问题/n,先/d,展示/v,先/d,通常/d,的/u,做法/n,import/en, ,pandas/en, ,as/en, ,pd/en, ,from/en, ,sklearn/en,./w,preprocessing/en, ,import/en, ,standardscaler/en, ,from/en, ,sklearn/en,./w,decomposition/en, ,import/en, ,pca/en, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,logisticregression/en, ,df/en, ,=/w, ,pd/en,./w,read/en,_,csv/en,(/w,'/w,wdbc/en,./w,csv/en,'/w,)/w, ,x/en, ,=/w, ,df/en,./w,iloc/en,[/w,:/w,,/w, ,2/m,:/w,]/w,./w,values/en, ,y/en, ,=/w, ,df/en,./w,iloc/en,[/w,:/w,,/w, ,1/m,]/w,./w,values/en, ,#, ,标准化/vn, ,sc/en, ,=/w, ,standardscaler/en,(/w,)/w, ,x/en,_,train/en,_,std/en, ,=/w, ,sc/en,./w,fit/en,_,transform/en,(/w,x/en,_,train/en,)/w, ,x/en,_,test/en,_,std/en, ,=/w, ,sc/en,./w,transform/en,(/w,x/en,_,test/en,)/w, ,#, ,主/n,成分/n,分析/vn,pca/en, ,pca/en, ,=/w, ,pca/en,(/w,n/en,_,components/en,=/w,2/m,)/w, ,x/en,_,train/en,_,pca/en, ,=/w, ,pca/en,./w,fit/en,_,transform/en,(/w,x/en,_,train/en,_,std/en,)/w, ,x/en,_,test/en,_,pca/en, ,=/w, ,pca/en,./w,transform/en,(/w,x/en,_,test/en,_,std/en,)/w, ,#, ,逻辑/n,斯蒂/nr,回归/v,预测/v, ,lr/en, ,=/w, ,logisticregression/en,(/w,random/en,_,state/en,=/w,1/m,)/w, ,lr/en,./w,fit/en,(/w,x/en,_,train/en,_,pca/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,lr/en,./w,predict/en,(/w,x/en,_,test/en,_,pca/en,)/w,先/d,对/p,数据/n,标准化/vn,，/w,然后/c,做主/v,成分/n,分析/vn,降维/nw,，/w,最后/f,做/v,回归/v,预测/v,现在/t,使用/v,管道/n,from/en, ,sklearn/en,./w,pipeline/en, ,import/en, ,pipeline/en, ,pipe/en,_,lr/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,sc/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,pca/en,'/w,,/w, ,pca/en,(/w,n/en,_,components/en,=/w,2/m,)/w,)/w,,/w, ,(/w,'/w,lr/en,'/w,,/w, ,logisticregression/en,(/w,random/en,_,state/en,=/w,1/m,)/w,)/w,]/w,)/w, ,pipe/en,_,lr/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,pipe/en,_,lr/en,./w,score/en,(/w,x/en,_,test/en,,/w, ,y/en,_,test/en,)/w,pipeline/en,对象/n,接收/v,元组/nw,构成/v,的/u,列表/v,作为/v,输入/v,，/w,每个/r,元组/nw,第一/m,个/q,值/n,作为/v,变量/n,名/q,，/w,元组/nw,第二/m,个/q,元素/n,是/v,sklearn/en,中/f,的/u,transformer/en,或/c,estimator/en,。/w,管道/n,中间/f,每/r,一步/mq,由/p,sklearn/en,中/f,的/u,transformer/en,构成/v,，/w,最后/f,一步/mq,是/v,一个/m,estimator/en,。/w,我们/r,的/u,例子/n,中/f,，/w,管道/n,包含/v,两个/m,中间/f,步骤/n,，/w,一个/m,standardscaler/en,和/c,一个/m,pca/en,，/w,这/r,俩/m,都/d,是/v,transformer/en,，/w,逻辑/n,斯蒂/nr,回归/v,分类器/nw,是/v,estimator/en,。/w,当/p,管道/n,pipe/en,_,lr/en,执行/v,fit/en,方法/n,时/ng,，/w,首先/d,standardscaler/en,执行/v,fit/en,和/c,transform/en,方法/n,，/w,然后/c,将/d,转换/v,后/f,的/u,数据/n,输入/v,给/p,pca/en,，/w,pca/en,同样/d,执行/v,fit/en,和/c,transform/en,方法/n,，/w,最后/f,将/d,数据/n,输入/v,给/p,logisticregression/en,，/w,训练/vn,一个/m,lr/en,模型/n,。/w,对于/p,管道/n,来说/u,，/w,中间/f,有/v,多少/r,个/q,transformer/en,都/d,可以/v,。/w,工作/vn,方式/n,如下/v,使用/v,管道/n,减少/v,了/u,很多/m,代码量/nw,现在/t,回归/v,模型/n,的/u,评估/vn,和/c,调参/nw,训练/vn,机器/n,学习/v,模型/n,的/u,关键/n,一步/mq,是/v,要/v,评估/vn,模型/n,的/u,泛化/nw,能力/n,。/w,如果/c,我们/r,训练/vn,好/a,模型/n,后/f,，/w,还是/c,用/p,训练集/nw,取/v,评估/vn,模型/n,的/u,性能/n,，/w,这/r,显然/ad,是/v,不/d,符合/v,逻辑/n,的/u,。/w,一个/m,模型/n,如果/c,性能/n,不好/a,，/w,要么/c,是/v,因为/c,模型/n,过于/d,复杂/a,导致/v,过/u,拟合/nz,(/w,高方/nr,差/a,)/w,，/w,要么/c,是/v,模型/n,过于/d,简单/a,导致/v,导致/v,欠/v,拟合/nz,(/w,高/a,偏差/n,)/w,。/w,可是/c,用/p,什么/r,方法/n,评价/v,模型/n,的/u,性能/n,呢/y,？/w,这/r,就是/d,这/r,一节/mq,要/v,解决/v,的/u,问题/n,，/w,你/r,会/v,学习/v,到/v,两种/mq,交叉/vn,验证/vn,计数/v,，/w,holdout/en,交叉/vn,验证/vn,和/c,k/en,折/v,交叉/vn,验证/vn,，/w, ,来/v,评估/vn,模型/n,的/u,泛化/nw,能力/n,一/m,、/w,holdout/en,交叉/vn,验证/vn,(/w,评估/vn,模型/n,性能/n,)/w,holdout/en,方法/n,很/d,简单/a,就/d,是/v,将/d,数据集/nw,分为/v,训练集/nw,和/c,测试/vn,集/vg,，/w,前者/r,用于/v,训练/vn,，/w,后者/r,用于/v,评估/vn,如果/c,在/p,模型/n,选择/v,的/u,过程/n,中/f,，/w,我们/r,始终/d,用/p,测试/vn,集/vg,来/v,评价/v,模型/n,性能/n,，/w,这/r,实际上/d,也/d,将/d,测试/vn,集/vg,变相/v,地/u,转为/v,了/u,训练集/nw,，/w,这时候/r,选择/v,的/u,最/d,优/ag,模型/n,很/d,可能/v,是/v,过/u,拟合/nz,的/u,。/w,更/d,好/a,的/u,holdout/en,方法/n,是/v,将/d,原始/a,训练集/nw,分为/v,三/m,部分/n,：/w,训练集/nw,、/w,验证/vn,集/vg,和/c,测试/vn,集/vg,。/w,训练机/nw,用于/v,训练/vn,不同/a,的/u,模型/n,，/w,验证/vn,集/vg,用于/v,模型/n,选择/v,。/w,而/c,测试/vn,集/vg,由于/c,在/p,训练/vn,模型/n,和/c,模型/n,选择/v,这/r,两步/mq,都/d,没有/v,用/p,到/v,，/w,对于/p,模型/n,来说/u,是/v,未知/vn,数据/n,，/w,因此/c,可以/v,用于/v,评估/vn,模型/n,的/u,泛化/nw,能力/n,。/w,下/f,图/n,展示/v,了/u,holdout/en,方法/n,的/u,步骤/n,：/w,缺点/n,：/w,它/r,对/p,数据/n,分割/v,的/u,方式/n,很/d,敏感/a,，/w,如果/c,原始/a,数据集/nw,分割/v,不当/a,，/w,这/r,包括/v,训练集/nw,、/w,验证/vn,集/vg,和/c,测试/vn,集/vg,的/u,样本/n,数/m,比例/n,，/w,以及/c,分割/v,后/f,数据/n,的/u,分布/v,情况/n,是否/v,和/c,原始/a,数据集/nw,分布/v,情况/n,相同/a,等等/u,。/w,所以/c,，/w,不同/a,的/u,分割/v,方式/n,可能/v,得到/v,不同/a,的/u,最/d,优/ag,模型/n,参数/n,二/m,、/w,k/en,折/v,交叉/vn,验证/vn,(/w,评估/vn,模型/n,性能/n,)/w,k/en,折/v,交叉/vn,验证/vn,的/u,过程/n,，/w,第一/m,步/q,我们/r,使用/v,不/d,重复/v,抽样/vn,将/d,原始/a,数据/n,随机/d,分为/v,k/en,份/q,，/w,第二/m,步/q, ,k/en,-/w,1份/mq,数据/n,用于/v,模型/n,训练/vn,，/w,剩下/v,那/r,一份/mq,数据/n,用于/v,测试/vn,模型/n,。/w,然后/c,重复/v,第二/m,步/q,k/en,次/q,，/w,我们/r,就/d,得到/v,了/u,k/en,个/q,模型/n,和/c,他/r,的/u,评估/vn,结果/n,(/w,译者/n,注/v,：/w,为了/p,减小/v,由于/c,数据/n,分割/v,引入/v,的/u,误差/n,，/w,通常/d,k/en,折/v,交叉/vn,验证/vn,要/v,随机/d,使用/v,不同/a,的/u,划分/v,方法/n,重复/v,p/en,次/q,，/w,常见/a,的/u,有/v,10次/mq,10折/mq,交叉/vn,验证/vn,)/w,然后/c,我们/r,计算/v,k/en,折/v,交叉/vn,验证/vn,结果/n,的/u,平均值/n,作为/v,参数/n,//w,模型/n,的/u,性能/n,评估/vn,。/w,使用/v,k/en,折/v,交叉/vn,验证/vn,来/v,寻找/v,最/d,优/ag,参数/n,要/v,比/p,holdout/en,方法/n,更/d,稳定/a,。/w,一旦/d,我们/r,找到/v,最/d,优/ag,参数/n,，/w,要/v,使用/v,这/r,组/q,参数/n,在/p,原始/a,数据集/nw,上/f,训练/vn,模型/n,作为/v,最终/d,的/u,模型/n,。/w,k/en,折/v,交叉/vn,验证/vn,使用/v,不/d,重复/v,采样/v,，/w,优点/n,是/v,每个/r,样本/n,只/d,会/v,在/p,训练集/nw,或/c,测试/vn,中/f,出现/v,一次/mq,，/w,这样/r,得到/v,的/u,模型/n,评估/vn,结果/n,有/v,更/d,低/a,的/u,方法/n,。/w,下/f,图/n,演示/vn,了/u,10折/mq,交叉/vn,验证/vn,：/w,10次/mq,10折/mq,交叉/vn,验证/vn,我/r,的/u,理解/v,是/v,将/d,按/p,十种/mq,划分/v,方法/n,，/w,每次/r,将/d,数据/n,随机/d,分成/v,k/en,分/q,，/w,k/en,-/w,1份/mq,训练/vn,，/w,k/en,份/q,测试/vn,。/w,获取/v,十个/m,模型/n,和/c,评估/vn,结果/n,，/w,然后/c,取/v,10次/mq,的/u,平均值/n,作为/v,性能/n,评估/vn,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,stratifiedkfoldpipe/en,_,lr/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,sc/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,pca/en,'/w,,/w, ,pca/en,(/w,n/en,_,components/en,=/w,2/m,)/w,)/w,,/w, ,(/w,'/w,lr/en,'/w,,/w, ,logisticregression/en,(/w,random/en,_,state/en,=/w,1/m,)/w,)/w,]/w,)/w, ,pipe/en,_,lr/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,kfold/en, ,=/w, ,stratifiedkfold/en,(/w,y/en,=/w,y/en,_,train/en,,/w, ,n/en,_,folds/en,=/w,10/m,,/w, ,random/en,_,state/en,=/w,1/m,)/w, ,scores/en,=/w, ,[/w,]/w, ,for/en, ,k/en,,/w, ,(/w,train/en,,/w, ,test/en,)/w, ,in/en, ,enumerate/en,(/w,kfold/en,)/w,:/w, ,pipe/en,_,lr/en,./w,fit/en,(/w,x/en,_,train/en,[/w,train/en,]/w,,/w, ,y/en,_,train/en,[/w,train/en,]/w,)/w, ,score/en, ,=/w, ,pipe/en,_,lr/en,./w,score/en,(/w,x/en,_,train/en,[/w,test/en,]/w,,/w, ,y/en,_,train/en,[/w,test/en,]/w,)/w, ,scores/en,./w,append/en,(/w,scores/en,)/w, ,print/en,(/w,'/w,fold/en,:/w, ,%/w,s/en,,/w, ,class/en, ,dist/en,./w,:/w, ,%/w,s/en,,/w, ,acc/en,:/w, ,%/w,./w,3/m,f/en,'/w, ,%/w,(/w,k/en,+/w,1/m,,/w, ,np/en,./w,bincount/en,(/w,y/en,_,train/en,[/w,train/en,]/w,)/w,,/w, ,score/en,)/w,)/w,print/en,(/w,'/w,cv/en, ,accuracy/en,:/w, ,%/w,./w,3/m,f/en, ,+/w,//w,-/w, ,%/w,./w,3/m,f/en,'/w, ,%/w,(/w,np/en,./w,mean/en,(/w,scores/en,)/w,,/w, ,np/en,./w,std/en,(/w,scores/en,)/w,)/w,)/w,更/d,简单/a,的/u,方法/n,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,stratifiedkfold/en, ,pipe/en,_,lr/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,sc/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,pca/en,'/w,,/w, ,pca/en,(/w,n/en,_,components/en,=/w,2/m,)/w,)/w,,/w, ,(/w,'/w,lr/en,'/w,,/w, ,logisticregression/en,(/w,random/en,_,state/en,=/w,1/m,)/w,)/w,]/w,)/w, ,pipe/en,_,lr/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,scores/en, ,=/w, ,cross/en,_,val/en,_,score/en,(/w,estimator/en,=/w,pipe/en,_,lr/en,,/w, ,x/en,=/w,x/en,_,train/en,,/w, ,y/en,=/w,y/en,_,train/en,,/w, ,cv/en,=/w,10/m,,/w, ,n/en,_,jobs/en,=/w,1/m,)/w, ,print/en,(/w,'/w,cv/en, ,accuracy/en, ,scores/en,:/w, ,%/w,s/en,'/w, ,%/w,scores/en,)/w, ,print/en,(/w,'/w,cv/en, ,accuracy/en,:/w, ,%/w,./w,3/m,f/en, ,+/w,//w,-/w, ,%/w,./w,3/m,f/en,'/w, ,%/w,(/w,np/en,./w,mean/en,(/w,scores/en,)/w,,/w, ,np/en,./w,std/en,(/w,scores/en,)/w,)/w,)/w,cv/en,即/v,k/en,三/m,、/w,学习/v,曲线/n,(/w,调试/v,算法/n,)/w,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,learning/en,_,curve/en, ,pipe/en,_,lr/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,scl/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,clf/en,'/w,,/w, ,logisticregression/en,(/w,penalty/en,=/w,'/w,l/en,2/m,'/w,,/w, ,random/en,_,state/en,=/w,0/m,)/w,)/w,]/w,)/w, ,train/en,_,sizes/en,,/w, ,train/en,_,scores/en,,/w, ,test/en,_,scores/en, ,=/w, ,learning/en,_,curve/en,(/w,estimator/en,=/w,pipe/en,_,lr/en,,/w, ,x/en,=/w,x/en,_,train/en,,/w, ,y/en,=/w,y/en,_,train/en,,/w, ,train/en,_,sizes/en,=/w,np/en,./w,linspace/en,(/w,0.1/m,,/w, ,1.0/m,,/w, ,10/m,)/w,,/w, ,cv/en,=/w,10/m,,/w, ,n/en,_,jobs/en,=/w,1/m,)/w, ,train/en,_,mean/en, ,=/w, ,np/en,./w,mean/en,(/w,train/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,train/en,_,std/en, ,=/w, ,np/en,./w,std/en,(/w,train/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,test/en,_,mean/en, ,=/w, ,np/en,./w,mean/en,(/w,test/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,test/en,_,std/en, ,=/w, ,np/en,./w,std/en,(/w,test/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,train/en,_,sizes/en,,/w, ,train/en,_,mean/en,,/w, ,color/en,=/w,'/w,blue/en,'/w,,/w, ,marker/en,=/w,'/w,0/m,'/w,,/w, ,markersize/en,=/w,5/m,,/w, ,label/en,=/w,'/w,training/en, ,accuracy/en,'/w,)/w, ,plt/en,./w,fill/en,_,between/en,(/w,train/en,_,sizes/en,,/w, ,train/en,_,mean/en, ,+/w, ,train/en,_,std/en,,/w, ,train/en,_,mean/en, ,-/w, ,train/en,_,std/en,,/w, ,alpha/en,=/w,0.15/m,,/w, ,color/en,=/w,'/w,blue/en,'/w,)/w, ,plt/en,./w,plot/en,(/w,train/en,_,sizes/en,,/w, ,test/en,_,mean/en,,/w, ,color/en,=/w,'/w,green/en,'/w,,/w, ,linestyle/en,=/w,'/w,--/nrf,'/w,,/w, ,marker/en,=/w,'/w,s/en,'/w,,/w, ,markersize/en,=/w,5/m,,/w, ,label/en,=/w,'/w,validation/en, ,accuracy/en,'/w,)/w, ,plt/en,./w,fill/en,_,between/en,(/w,train/en,_,sizes/en,,/w, ,test/en,_,mean/en, ,+/w, ,test/en,_,std/en,,/w, ,test/en,_,mean/en, ,-/w, ,test/en,_,std/en,,/w, ,alpha/en,=/w,0.15/m,,/w, ,color/en,=/w,'/w,green/en,'/w,)/w, ,plt/en,./w,grid/en,(/w,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,number/en, ,of/en, ,training/en, ,samples/en,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,accuracy/en,'/w,)/w, ,plt/en,./w,legend/en,(/w,loc/en,=/w,'/w,lower/en, ,right/en,'/w,)/w, ,plt/en,./w,ylim/en,(/w,[/w,0.8/m,,/w, ,1.0/m,]/w,)/w, ,plt/en,./w,show/en,(/w,)/w,learning/en,_,curve/en,中/f,的/u,train/en,_,sizes/en,参数/n,控制/v,产生/v,学习/v,曲线/n,的/u,训练/vn,样本/n,的/u,绝对/d,//w,相对/d,数量/n,，/w,此处/s,，/w,我们/r,设置/v,的/u,train/en,_,sizes/en,=/w,np/en,./w,linspace/en,(/w,0.1/m,,/w, ,1.0/m,,/w, ,10/m,)/w,，/w,将/d,训练集/nw,大小/n,划分/v,为/p,10个/m,相等/v,的/u,区间/n,。/w,learning/en,_,curve/en,默认/v,使用/v,分层/v,k/en,折/v,交叉/vn,验证/vn,计算/v,交叉/vn,验证/vn,的/u,准确率/n,，/w,我们/r,通过/p,cv/en,设置/v,k/en,。/w,上图/n,中/f,可以/v,看到/v,，/w,模型/n,在/p,测试/vn,集/vg,表现/v,很/d,好/a,，/w,不过/c,训练集/nw,和/c,测试/vn,集/vg,的/u,准确率/n,还是/c,有/v,一段/mq,小/a,间隔/n,，/w,可能/v,是/v,模型/n,有点/d,过/u,拟合/nz,四/m,、/w,验证/vn,曲线/n,解决/v,过/u,拟合/nz,和/c,欠/v,拟合/nz,(/w,调试/v,算法/n,)/w,验证/vn,曲线/n,和/c,学习/v,曲线/n,很/d,相近/a,，/w,不同/a,的/u,是/v,这里/r,画/v,出/v,的/u,是/v,不同/a,参数/n,下/f,模型/n,的/u,准确率/n,而/c,不/d,是/v,不同/a,训练集/nw,大小/n,下/f,的/u,准确率/n,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,validation/en,_,curve/en, ,param/en,_,range/en, ,=/w, ,[/w,0.001/m,,/w, ,0.01/m,,/w, ,0.1/m,,/w, ,1.0/m,,/w, ,10.0/m,,/w, ,100.0/m,]/w, ,pipe/en,_,lr/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,scl/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,clf/en,'/w,,/w, ,logisticregression/en,(/w,penalty/en,=/w,'/w,l/en,2/m,'/w,,/w, ,random/en,_,state/en,=/w,0/m,)/w,)/w,]/w,)/w, ,train/en,_,scores/en,,/w, ,test/en,_,scores/en, ,=/w, ,validation/en,_,curve/en,(/w,estimator/en,=/w,pipe/en,_,lr/en,,/w, ,x/en,=/w,x/en,_,train/en,,/w, ,y/en,=/w,y/en,_,train/en,,/w, ,param/en,_,name/en,=/w,'/w,clf/en,_,_,c/en,'/w,,/w, ,param/en,_,range/en,=/w,param/en,_,range/en,,/w, ,cv/en,=/w,10/m,)/w, ,train/en,_,mean/en, ,=/w, ,np/en,./w,mean/en,(/w,train/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,train/en,_,std/en, ,=/w, ,np/en,./w,std/en,(/w,train/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,test/en,_,mean/en, ,=/w, ,np/en,./w,mean/en,(/w,test/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,test/en,_,std/en, ,=/w, ,np/en,./w,std/en,(/w,test/en,_,scores/en,,/w, ,axis/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,param/en,_,range/en,,/w, ,train/en,_,mean/en,,/w, ,color/en,=/w,'/w,blue/en,'/w,,/w, ,marker/en,=/w,'/w,o/en,'/w,,/w, ,markersize/en,=/w,5/m,,/w, ,label/en,=/w,'/w,training/en, ,accuracy/en,'/w,)/w, ,plt/en,./w,fill/en,_,between/en,(/w,param/en,_,range/en,,/w, ,train/en,_,mean/en, ,+/w, ,train/en,_,std/en,,/w, ,train/en,_,mean/en, ,-/w, ,train/en,_,std/en,,/w, ,alpha/en,=/w,0.15/m,,/w, ,color/en,=/w,'/w,blue/en,'/w,)/w, ,plt/en,./w,plot/en,(/w,param/en,_,range/en,,/w, ,test/en,_,mean/en,,/w, ,color/en,=/w,'/w,green/en,'/w,,/w, ,linestyle/en,=/w,'/w,--/nrf,'/w,,/w, ,marker/en,=/w,'/w,s/en,'/w,,/w, ,markersize/en,=/w,5/m,,/w, ,label/en,=/w,'/w,validation/en, ,accuracy/en,'/w,)/w, ,plt/en,./w,fill/en,_,between/en,(/w,param/en,_,range/en,,/w, ,test/en,_,mean/en, ,+/w, ,test/en,_,std/en,,/w, ,test/en,_,mean/en, ,-/w, ,test/en,_,std/en,,/w, ,alpha/en,=/w,0.15/m,,/w, ,color/en,=/w,'/w,green/en,'/w,)/w, ,plt/en,./w,grid/en,(/w,)/w, ,plt/en,./w,xscale/en,(/w,'/w,log/en,'/w,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,parameter/en, ,c/en,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,accuracy/en,'/w,)/w, ,plt/en,./w,legend/en,(/w,loc/en,=/w,'/w,lower/en, ,right/en,'/w,)/w, ,plt/en,./w,ylim/en,(/w,[/w,0.8/m,,/w, ,1.0/m,]/w,)/w, ,plt/en,./w,show/en,(/w,)/w,我们/r,得到/v,了/u,参数/n,c/en,的/u,验证/vn,曲线/n,。/w,和/c,learning/en,_,curve/en,方法/n,很/d,像/v,，/w,validation/en,_,curve/en,方法/n,使用/v,采样/v,k/en,折/v,交叉/vn,验证/vn,来/v,评估/vn,模型/n,的/u,性能/n,。/w,在/p,validation/en,_,curve/en,内部/f,，/w,我们/r,设定/v,了/u,用/p,来/v,评估/vn,的/u,参数/n,，/w,这里/r,是/v,c/en,,/w,也/d,就/d,是/v,lr/en,的/u,正/d,则/d,系数/n,的/u,倒数/v,。/w,观察/v,上图/n,，/w,最/d,好/a,的/u,c/en,值/n,是/v,0.1/m,。/w,总之/c,，/w,我们/r,可以/v,使用/v,学习/v,曲线/n,判断/v,算法/n,是否/v,拟合/nz,程度/n,(/w,欠/v,拟合/nz,或者/c,过/u,拟合/nz,)/w,，/w,然后/c,使用/v,验证/vn,曲线/n,评估/vn,参数/n,获取/v,最/d,好/a,的/u,参数/n,机器/n,学习/v,算法/n,中/f,有/v,两类/mq,参数/n,：/w,从/p,训练/vn,集中/v,学习/v,到/v,的/u,参数/n,，/w,比如/v,逻辑/n,斯蒂/nr,回归/v,中/f,的/u,权重/nz,参数/n,，/w,另/r,一类/mq,是/v,模型/n,的/u,超/v,参数/n,，/w,也/d,就/d,是/v,需要/v,人工/n,设定/v,的/u,参数/n,，/w,比如/v,正/d,则/d,项/q,系数/n,或者/c,决策/n,树/v,的/u,深度/n,。/w,权重/nz,参数/n,可以/v,通过/p,验证/vn,曲线/n,来/v,获取/v,最/d,好/a,的/u,参数/n,，/w,而/c,超/v,参数/n,则/d,可以/v,使用/v,网格/n,搜索/vn,调参/nw,五/m,、/w,网格/n,搜索/vn,调参/nw,(/w,调试/v,算法/n,)/w,网格/n,搜索/vn,其实/d,就/d,是/v,暴力/n,搜索/vn,，/w,事先/d,为/p,每个/r,参数/n,设定/v,一组/mq,值/n,，/w,然后/c,穷举/v,各种/r,参数/n,组合/v,，/w,找到/v,最/d,好/a,的/u,那/r,组/q,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,gridsearchcv/en, ,from/en, ,sklearn/en,./w,svm/en, ,import/en, ,svc/en, ,pipe/en,_,svc/en, ,=/w, ,pipeline/en,(/w,[/w,(/w,'/w,scl/en,'/w,,/w, ,standardscaler/en,(/w,)/w,)/w,,/w, ,(/w,'/w,clf/en,'/w,,/w, ,svc/en,(/w,random/en,_,state/en,=/w,1/m,)/w,)/w,]/w,)/w, ,param/en,_,range/en, ,=/w, ,[/w,0.0001/m,,/w, ,0.001/m,,/w, ,0.01/m,,/w, ,0.1/m,,/w, ,1.0/m,,/w, ,10.0/m,,/w, ,100.0/m,,/w, ,1000.0/m,]/w, ,param/en,_,grid/en, ,=/w, ,[/w,{/w,'/w,clf/en,_,_,c/en,'/w,:/w, ,param/en,_,range/en,,/w, ,'/w,clf/en,_,_,kernel/en,'/w,:/w, ,[/w,'/w,linear/en,'/w,]/w,}/w,,/w, ,{/w,'/w,clf/en,_,_,c/en,'/w,:/w, ,param/en,_,range/en,,/w, ,'/w,clf/en,_,_,gamma/en,'/w,:/w, ,param/en,_,range/en,,/w, ,'/w,clf/en,_,_,kernel/en,'/w,:/w, ,[/w,'/w,rbf/en,'/w,]/w,}/w,]/w, ,gs/en, ,=/w, ,gridsearchcv/en,(/w,estimator/en,=/w,pipe/en,_,svc/en,,/w, ,param/en,_,grid/en,=/w,param/en,_,grid/en,,/w, ,scoring/en,=/w,'/w,accuracy/en,'/w,,/w, ,cv/en,=/w,10/m,,/w, ,n/en,_,jobs/en,=/w,-/w,1/m,)/w, ,gs/en, ,=/w, ,gs/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,print/en,(/w,gs/en,./w,best/en,_,score/en,_,)/w, ,print/en,(/w,gs/en,./w,best/en,_,params/en,_,)/w,gridsearchcv/en,中/f,param/en,_,grid/en,参数/n,是/v,字典/n,构成/v,的/u,列表/v,。/w,对于/p,线性/n,svm/en,，/w,我们/r,只/d,评估/vn,参数/n,c/en,；/w,对于/p,rbf/en,核/n,svm/en,，/w,我们/r,评估/vn,c/en,和/c,gamma/en,。/w,最后/f,，/w, ,我们/r,通过/p,best/en,_,parmas/en,_,得到/v,最/d,优/ag,参数/n,组合/v,。/w,sklearn/en,人性化/vn,的/u,一点/m,是/v,，/w,我们/r,可以/v,直接/ad,利用/v,最/d,优/ag,参数/n,建/v,模/ng,(/w,best/en,_,estimator/en,_,)/w,clf/en, ,=/w, ,gs/en,./w,best/en,_,estimator/en,_, ,clf/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,print/en,(/