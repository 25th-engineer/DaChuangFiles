注/v,：/w,代价/n,函数/n,（/w,有的/r,地方/n,也/d,叫/v,损失/n,函数/n,，/w,loss/en, ,function/en,）/w,在/p,机器/n,学习/v,中/f,的/u,每/r,一种/mq,算法/n,中/f,都/d,很/d,重要/a,，/w,因为/c,训练/vn,模型/n,的/u,过程/n,就/d,是/v,优化/v,代价/n,函数/n,的/u,过程/n,，/w,代价/n,函数/n,对/p,每个/r,参数/n,的/u,偏/d,导数/n,就/d,是/v,梯度/n,下降/v,中/f,提到/v,的/u,梯度/n,，/w,防止/v,过/u,拟合/nz,时/ng,添加/vn,的/u,正/d,则/d,化项/nw,也/d,是/v,加/v,在/p,代价/n,函数/n,后面/f,的/u,。/w,在/p,学习/v,相关/v,算法/n,的/u,过程/n,中/f,，/w,对/p,代价/n,函数/n,的/u,理解/v,也/d,在/p,不断/d,的/u,加深/v,，/w,在/p,此/r,做/v,一个/m,小结/n,。/w,1/m,./w, ,什么/r,是/v,代价/n,函数/n,？/w,假设/v,有/v,训练/vn,样本/n,(/w,x/en,,/w, ,y/en,)/w,，/w,模型/n,为/p,h/en,，/w,参数/n,为/p,θ,。/w,h/en,(/w,θ,)/w, ,=/w, ,θ,tx/en,（/w,θ,t/en,表示/v,θ,的/u,转置/nw,）/w,。/w,（/w,1/m,）/w,概况/n,来讲/u,，/w,任何/r,能够/v,衡量/v,模型/n,预测/v,出来/v,的/u,值/n,h/en,(/w,θ,)/w,与/p,真实/a,值/n,y/en,之间/f,的/u,差异/n,的/u,函数/n,都/d,可以/v,叫做/v,代价/n,函数/n,c/en,(/w,θ,)/w,，/w,如果/c,有/v,多/a,个/q,样本/n,，/w,则/d,可以/v,将/d,所有/b,代价/n,函数/n,的/u,取值/v,求均值/nw,，/w,记/v,做/v,j/en,(/w,θ,)/w,。/w,因此/c,很/d,容易/a,就/d,可以/v,得出/v,以下/f,关于/p,代价/n,函数/n,的/u,性质/n,：/w,对于/p,每/r,种/q,算法/n,来说/u,，/w,代价/n,函数/n,不/d,是/v,唯一/b,的/u,；/w,代价/n,函数/n,是/v,参数/n,θ,的/u,函数/n,；/w,总/b,的/u,代价/n,函数/n,j/en,(/w,θ,)/w,可以/v,用/p,来/v,评价/v,模型/n,的/u,好坏/n,，/w,代价/n,函数/n,越小/nw,说明/v,模型/n,和/c,参数/n,越/d,符合/v,训练/vn,样本/n,(/w,x/en,,/w, ,y/en,)/w,；/w,j/en,(/w,θ,)/w,是/v,一个/m,标量/n,；/w,（/w,2/m,）/w,当/p,我们/r,确定/v,了/u,模型/n,h/en,，/w,后面/f,做/v,的/u,所有/b,事情/n,就/d,是/v,训练/vn,模型/n,的/u,参数/n,θ,。/w,那么/r,什么/r,时候/n,模型/n,的/u,训练/vn,才/d,能/v,结束/v,呢/y,？/w,这时候/r,也/d,涉及/v,到/v,代价/n,函数/n,，/w,由于/c,代价/n,函数/n,是/v,用/p,来/v,衡量/v,模型/n,好坏/n,的/u,，/w,我们/r,的/u,目标/n,当然/d,是/v,得到/v,最/d,好/a,的/u,模型/n,（/w,也/d,就/d,是/v,最/d,符合/v,训练/vn,样本/n,(/w,x/en,,/w, ,y/en,)/w,的/u,模型/n,）/w,。/w,因此/c,训练/vn,参数/n,的/u,过程/n,就/d,是/v,不断/d,改变/v,θ,，/w,从而/c,得到/v,更/d,小/a,的/u,j/en,(/w,θ,)/w,的/u,过程/n,。/w,理想/n,情况/n,下/f,，/w,当/p,我们/r,取/v,到/v,代价/n,函数/n,j/en,的/u,最小值/nz,时/ng,，/w,就/d,得到/v,了/u,最/d,优/ag,的/u,参数/n,θ,，/w,记/v,为/p,：/w,$/w,$/w,\/w,displaystyle/en, ,\/w,min/en,_,{/w, ,\/w,theta/en, ,}/w, ,j/en,(/w,\/w,theta/en,)/w,$/w,$/w,例如/v,，/w,j/en,(/w,θ,)/w, ,=/w, ,0/m,，/w,表示/v,我们/r,的/u,模型/n,完美/a,的/u,拟合/nz,了/u,观察/v,的/u,数据/n,，/w,没有/v,任何/r,误差/n,。/w,（/w,3/m,）/w,在/p,优化/v,参数/n,θ,的/u,过程/n,中/f,，/w,最/d,常用/a,的/u,方法/n,是/v,梯度/n,下降/v,，/w,这里/r,的/u,梯度/n,就/d,是/v,代价/n,函数/n,j/en,(/w,θ,)/w,对/p,θ,1/m,,/w, ,θ,2/m,,/w, ,./w,./w,./w,,/w, ,θ,n/en,的/u,偏/d,导数/n,。/w,由于/c,需/v,要求/v,偏导/nw,，/w,我们/r,可以/v,得到/v,另/r,一个/m,关于/p,代价/n,函数/n,的/u,性质/n,：/w,选择/v,代价/n,函数/n,时/ng,，/w,最/d,好/a,挑选/v,对/p,参数/n,θ,可/v,微/ag,的/u,函数/n,（/w,全微/nw,分/q,存在/v,，/w,偏/d,导数/n,一定/d,存在/v,）/w,2/m,./w, ,代价/n,函数/n,的/u,常见/a,形式/n,经过/p,上面/f,的/u,描述/v,，/w,一个/m,好/a,的/u,代价/n,函数/n,需要/v,满足/v,两个/m,最/d,基本/a,的/u,要求/v,：/w,能够/v,评价/v,模型/n,的/u,准确性/n,，/w,对/p,参数/n,θ,可/v,微/ag,。/w,2.1/m, ,均/d,方误差在线性/nw,回归/v,中/f,，/w,最/d,常用/a,的/u,是/v,均方/nw,误差/n,(/w,mean/en, ,squared/en, ,error/en,)/w,，/w,具体/a,形式/n,为/p,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,_,0/m,,/w, ,\/w,theta/en,_,1/m,)/w, ,=/w, ,\/w,frac/en,{/w, ,1/m, ,}/w,{/w, ,2/m,m/en, ,}/w, ,\/w,displaystyle/en, ,\/w,sum/en,_,{/w, ,i/en, ,=/w, ,1/m, ,}/w,^,{/w, ,m/en, ,}/w, ,(/w,\/w,hat/en,{/w, ,y/en, ,}/w,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w,^,2/m, ,=/w, ,\/w,frac/en,{/w, ,1/m, ,}/w,{/w, ,2/m,m/en, ,}/w, ,\/w,displaystyle/en, ,\/w,sum/en,_,{/w, ,i/en, ,=/w, ,1/m, ,}/w,^,{/w, ,m/en, ,}/w, ,(/w,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,-/w, ,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w,^,2/m, ,$/w,$/w,m/en,：/w,训练/vn,样本/n,的/u,个数/n,；/w,h/en,θ,(/w,x/en,)/w,：/w,用/p,参数/n,θ,和/c,x/en,预测/v,出来/v,的/u,y/en,值/n,；/w,y/en,：/w,原/b,训练/vn,样本/n,中/f,的/u,y/en,值/n,，/w,也/d,就/d,是/v,标准/n,答案/n,上/f,角/q,标/v,(/w,i/en,)/w,：/w,第/m,i/en,个/q,样本/n,2.2/m, ,交叉/vn,熵/g,在/p,逻辑/n,回归/v,中/f,，/w,最/d,常用/a,的/u,是/v,代价/n,函数/n,是/v,交叉/vn,熵/g,(/w,cross/en, ,entropy/en,)/w,，/w,交叉/vn,熵/g,是/v,一个/m,常见/a,的/u,代价/n,函数/n,，/w,在/p,神经/n,网络/n,中/f,也/d,会/v,用/p,到/v,。/w,下面/f,是/v,《/w,神经/n,网络/n,与/p,深度/n,学习/v,》/w,一/m,书/n,对/p,交叉/vn,熵/g,的/u,解释/v,：/w,交叉/vn,熵/g,是/v,对/p,「/w,出乎意料」/nw,（/w,译者/n,注/v,：/w,原文/n,使用/v,suprise/en,）/w,的/u,度量/v,。/w,神经元/n,的/u,目标/n,是/v,去/v,计算/v,函数/n,y/en,,/w, ,且/c,y/en,=/w,y/en,(/w,x/en,)/w,。/w,但是/c,我们/r,让/v,它/r,取而代之/i,计算/v,函数/n,a/en,,/w, ,且/c,a/en,=/w,a/en,(/w,x/en,)/w,。/w,假设/v,我们/r,把/p,a/en,当作/v,y/en,等于/v,1/m,的/u,概率/n,，/w,1/m,−,a/en,是/v,y/en,等于/v,0/m,的/u,概率/n,。/w,那么/r,，/w,交叉/vn,熵/g,衡量/v,的/u,是/v,我们/r,在/p,知道/v,y/en,的/u,真实/a,值/n,时/ng,的/u,平均/a,「/w,出乎意料」/nw,程度/n,。/w,当/p,输出/v,是/v,我们/r,期望/v,的/u,值/n,，/w,我们/r,的/u,「/w,出乎意料」/nw,程度/n,比较/d,低/a,；/w,当/p,输出/v,不/d,是/v,我们/r,期望/v,的/u,，/w,我们/r,的/u,「/w,出乎意料」/nw,程度/n,就/d,比较/d,高/a,。/w,在/p,1948年/t,，/w,克劳德·艾尔伍德·香农/nw,将/d,热力学/n,的/u,熵/g,，/w,引入/v,到/v,信息论/n,，/w,因此/c,它/r,又/d,被/p,称为/v,香农/nr,熵/g,(/w,shannon/en, ,entropy/en,)/w,，/w,它/r,是/v,香农信息量/nw,(/w,shannon/en, ,information/en, ,content/en,,/w, ,sic/en,)/w,的/u,期望/v,。/w,香农信息量/nw,用/p,来/v,度量/v,不确定性/nw,的/u,大小/n,：/w,一个/m,事件/n,的/u,香农信息量/nw,等于/v,0/m,，/w,表示/v,该/r,事件/n,的/u,发生/v,不/d,会/v,给/p,我们/r,提供/v,任何/r,新/a,的/u,信息/n,，/w,例如/v,确定性/n,的/u,事件/n,，/w,发生/v,的/u,概率/n,是/v,1/m,，/w,发生/v,了/u,也/d,不/d,会/v,引起/v,任何/r,惊讶/a,；/w,当/p,不/d,可能/v,事件/n,发生/v,时/ng,，/w,香农信息量/nw,为/p,无穷/z,大/a,，/w,这/r,表示/v,给/p,我们/r,提供/v,了/u,无穷/z,多/a,的/u,新/a,信息/n,，/w,并且/c,使/v,我们/r,无限/vd,的/u,惊讶/a,。/w,更多/ad,解释/v,可以/v,看/v,这里/r,。/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,-/w,\/w,frac/en,{/w, ,1/m, ,}/w,{/w, ,m/en, ,}/w,[/w,\/w,sum/en,_,{/w, ,i/en,=/w,1/m, ,}/w,^,{/w, ,m/en, ,}/w, ,(/w,{/w,y/en,^,{/w,(/w,i/en,)/w,}/w, ,\/w,log/en, ,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,+/w, ,(/w,1/m,-/w,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,\/w,log/en, ,(/w,1/m,-/w,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w,}/w,)/w,]/w,$/w,$/w,符号/n,说明/v,同/p,上/f,2.3/m, ,神经/n,网络/n,中/f,的/u,代价/n,函数/n,学习/v,过/u,神经/n,网络/n,后/f,，/w,发现/v,逻辑/n,回归/v,其实/d,是/v,神经/n,网络/n,的/u,一种/mq,特例/n,（/w,没有/v,隐藏层/nw,的/u,神经/n,网络/n,）/w,。/w,因此/c,神经/n,网络/n,中/f,的/u,代价/n,函数/n,与/p,逻辑/n,回归/v,中/f,的/u,代价/n,函数/n,非常/d,相似/a,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,-/w,\/w,frac/en,{/w, ,1/m, ,}/w,{/w, ,m/en, ,}/w,[/w,\/w,sum/en,_,{/w, ,i/en,=/w,1/m, ,}/w,^,{/w, ,m/en, ,}/w, ,\/w,sum/en,_,{/w, ,k/en,=/w,1/m, ,}/w,^,{/w, ,k/en, ,}/w, ,(/w,{/w,y/en,_,k/en,^,{/w,(/w,i/en,)/w,}/w, ,\/w,log/en, ,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,+/w, ,(/w,1/m, ,-/w, ,y/en,_,k/en,^,{/w,(/w,i/en,)/w,}/w,)/w, ,\/w,log/en, ,(/w,1/m, ,-/w, ,(/w,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,(/w,i/en,)/w,}/w,)/w,)/w,_,k/en,}/w,)/w,]/w,$/w,$/w,这里/r,之所以/c,多/a,了/u,一层/mq,求/v,和/c,项/q,，/w,是/v,因为/c,神经/n,网络/n,的/u,输出/v,一般/a,都/d,不/d,是/v,单一/a,的/u,值/n,，/w,k/en,表示/v,在/p,多/a,分类/vn,中/f,的/u,类型/n,数/m,。/w,例如/v,在/p,数字/n,识别/v,中/f,，/w,k/en,=/w,10/m,，/w,表示/v,分/q,了/u,10类/mq,。/w,此时/r,对于/p,某/r,一个/m,样本/n,来说/u,，/w,输出/v,的/u,结果/n,如下/v,：/w,1.1266/m,e/en,-/w,004/m, ,1.7413/m,e/en,-/w,003/m, ,2.5270/m,e/en,-/w,003/m, ,1.8403/m,e/en,-/w,005/m, ,9.3626/m,e/en,-/w,003/m, ,3.9927/m,e/en,-/w,003/m, ,5.5152/m,e/en,-/w,003/m, ,4.0147/m,e/en,-/w,004/m, ,6.4807/m,e/en,-/w,003/m, ,9.9573/m,e/en,-/w,001/m,一个/m,10维/mq,的/u,列向量/nw,，/w,预测/v,的/u,结果/n,表示/v,输入/v,的/u,数字/n,是/v,0/m,~/w,9/m,中/f,的/u,某/r,一个/m,的/u,概率/n,，/w,概率/n,最/d,大/a,的/u,就/d,被/p,当做/v,是/v,预测/v,结果/n,。/w,例如/v,上面/f,的/u,预测/v,结果/n,是/v,9/m,。/w,理想/n,情况/n,下/f,的/u,预测/v,结果/n,应该/v,如下/v,（/w,9/m,的/u,概率/n,是/v,1/m,，/w,其他/r,都/d,是/v,0/m,）/w,：/w,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,1/m,比较/d,预测/v,结果/n,和/c,理想/n,情况/n,下/f,的/u,结果/n,，/w,可以/v,看到/v,这/r,两个/m,向量/n,的/u,对应/v,元素/n,之间/f,都/d,存在/v,差异/n,，/w,共有/v,10组/mq,，/w,这里/r,的/u,10/m,就/d,表示/v,代价/n,函数/n,里/f,的/u,k/en,，/w,相当/d,于/p,把/p,每/r,一种/mq,类型/n,的/u,差异/n,都/d,累/a,加/v,起来/v,了/u,。/w,3/m,./w, ,代价/n,函数/n,与/p,参数/n,代价/n,函数/n,衡量/v,的/u,是/v,模型/n,预测/v,值/n,h/en,(/w,θ,)/w, ,与/p,标准/n,答案/n,y/en,之间/f,的/u,差异/n,，/w,所以/c,总/b,的/u,代价/n,函数/n,j/en,是/v,h/en,(/w,θ,)/w,和/c,y/en,的/u,函数/n,，/w,即/v,j/en,=/w,f/en,(/w,h/en,(/w,θ,)/w,,/w, ,y/en,)/w,。/w,又/d,因为/c,y/en,都/d,是/v,训练/vn,样本/n,中/f,给/p,定/v,的/u,，/w,h/en,(/w,θ,)/w,由/p,θ,决定/v,，/w,所以/c,，/w,最终/d,还是/c,模型/n,参数/n,θ,的/u,改变/v,导致/v,了/u,j/en,的/u,改变/v,。/w,对于/p,不同/a,的/u,θ,，/w,对应/v,不同/a,的/u,预测值/n,h/en,(/w,θ,)/w,，/w,也/d,就/d,对应/v,着/u,不同/a,的/u,代价/n,函数/n,j/en,的/u,取值/v,。/w,变化/vn,过程/n,为/p,：/w,$/w,$/w,\/w,theta/en, ,--/nrf,>, ,h/en,(/w,\/w,theta/en,)/w, ,--/nrf,>, ,j/en,(/w,\/w,theta/en,)/w,$/w,$/w,θ,引起/v,了/u,h/en,(/w,θ,)/w,的/u,改变/v,，/w,进而/c,改变/v,了/u,j/en,(/w,θ,)/w,的/u,取值/v,。/w,为了/p,更/d,直观/a,的/u,看到/v,参数/n,对/p,代价/n,函数/n,的/u,影响/vn,，/w,举/v,个/q,简单/a,的/u,例子/n,：/w,有/v,训练/vn,样本/n,{/w,(/w,0/m,,/w, ,0/m,)/w,,/w, ,(/w,1/m,,/w, ,1/m,)/w,,/w, ,(/w,2/m,,/w, ,2/m,)/w,,/w, ,(/w,4/m,,/w, ,4/m,)/w,}/w,，/w,即/v,4对/mq,训练/vn,样本/n,，/w,每个/r,样本/n,对/p,中/f,第/m,1个/m,数/m,表示/v,x/en,的/u,值/n,，/w,第/m,2个/m,数/m,表示/v,y/en,的/u,值/n,。/w,这/r,几/m,个/q,点/q,很/d,明显/a,都/d,是/v,y/en,=/w,x/en,这/r,条/q,直线/n,上/f,的/u,点/q,。/w,如/v,下/f,图/n,：/w,：/w,不同/a,参数/n,可以/v,拟合/nz,出/v,不同/a,的/u,直线/n,"/w,"/w,"/w, ,spyder/en, ,editor/en, ,python/en, ,3.6/m,,/w, ,belter/en,,/w, ,20170401/m, ,"/w,"/w,"/w, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,x/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,4/m,]/w,]/w,)/w,./w,t/en, ,#, ,都/d,转换/v,成/v,列向量/nw, ,y/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,4/m,]/w,]/w,)/w,./w,t/en, ,theta/en,1/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,0/m,]/w,]/w,)/w,./w,t/en, ,#, ,三个/m,不同/a,的/u,theta/en,_,1/m,值/n, ,theta/en,2/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,0.5/m,]/w,]/w,)/w,./w,t/en, ,theta/en,3/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,1/m,]/w,]/w,)/w,./w,t/en, ,x/en,_,size/en, ,=/w, ,x/en,./w,shape/en, ,x/en,_,0/m, ,=/w, ,np/en,./w,ones/en,(/w,(/w,x/en,_,size/en,[/w,0/m,]/w,,/w,1/m,)/w,)/w, ,#, ,添加/vn,x/en,_,0/m, ,x/en,_,with/en,_,x/en,0/m, ,=/w, ,np/en,./w,concatenate/en,(/w,(/w,x/en,_,0/m,,/w, ,x/en,)/w,,/w, ,axis/en,=/w,1/m,)/w, ,h/en,1/m, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,with/en,_,x/en,0/m,,/w, ,theta/en,1/m,)/w, ,h/en,2/m, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,with/en,_,x/en,0/m,,/w, ,theta/en,2/m,)/w, ,h/en,3/m, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,with/en,_,x/en,0/m,,/w, ,theta/en,3/m,)/w, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,rx/en,'/w,,/w, ,label/en,=/w,'/w,y/en,'/w,)/w, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,h/en,1/m,,/w, ,'/w,b/en,'/w,,/w, ,label/en,=/w,'/w,h/en,1/m,,/w, ,theta/en,_,1/m,=/w,0/m,'/w,)/w, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,h/en,2/m,,/w, ,'/w,m/en,'/w,,/w, ,label/en,=/w,'/w,h/en,2/m,,/w, ,theta/en,_,1/m,=/w,0.5/m,'/w,)/w, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,h/en,3/m,,/w, ,'/w,g/en,'/w,,/w, ,label/en,=/w,'/w,h/en,3/m,,/w, ,theta/en,_,1/m,=/w,1/m,'/w,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,//w,h/en,'/w,)/w, ,plt/en,./w,axis/en,(/w,[/w,-/w,0.1/m,,/w, ,4.5/m,,/w, ,-/w,0.1/m,,/w, ,4.5/m,]/w,)/w, ,plt/en,./w,legend/en,(/w,loc/en,=/w,'/w,upper/en, ,left/en,'/w,)/w, ,plt/en,./w,savefig/en,(/w,'/w,liner/en,_,gression/en,_,error/en,./w,png/en,'/w,,/w, ,dpi/en,=/w,200/m,)/w,view/en, ,code/en,常数/n,项/q,为/p,0/m,，/w,所以/c,可以/v,取θ/nw,0/m,=/w,0/m,，/w,然后/c,取/v,不同/a,的/u,θ,1/m,，/w,可以/v,得到/v,不同/a,的/u,拟合/nz,直线/n,。/w,当/p,θ,1/m,=/w,0时/t,，/w,拟合/nz,的/u,直线/n,是/v,y/en,=/w,0/m,，/w,即/v,蓝色/n,线/n,段/q,，/w,此时/r,距离/n,样本点/nw,最远/a,，/w,代价/n,函数/n,的/u,值/n,（/w,误差/n,）/w,也/d,最/d,大/a,；/w,当θ/nw,1/m,=/w,1时/t,，/w,拟合/nz,的/u,直线/n,是/v,y/en,=/w,x/en,，/w,即/v,绿色/n,线/n,段/q,，/w,此时/r,拟合/nz,的/u,直线/n,经过/p,每/r,一个/m,样本点/nw,，/w,代价/n,函数/n,的/u,值/n,为/p,0/m,。/w,通过/p,下/f,图/n,可以/v,查看/v,随着/p,θ,1/m,的/u,变化/vn,，/w,j/en,(/w,θ,)/w,的/u,变化/vn,情况/n,：/w,：/w,代价/n,函数/n,j/en,(/w,θ,)/w,随/v,参数/n,的/u,变化/vn,而/c,变化/vn,"/w,"/w,"/w, ,spyder/en, ,editor/en, ,python/en, ,3.6/m,,/w, ,belter/en,,/w, ,20170401/m, ,"/w,"/w,"/w, ,#, ,计算/v,代价/n,函数/n,的/u,值/n, ,def/en, ,calcu/en,_,cost/en,(/w,theta/en,,/w, ,x/en,,/w, ,y/en,)/w,:/w, ,m/en, ,=/w, ,x/en,./w,shape/en,[/w,0/m,]/w, ,#, ,sample/en, ,size/en, ,x/en,_,0/m, ,=/w, ,np/en,./w,ones/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w, ,x/en,_,with/en,_,x/en,0/m, ,=/w, ,np/en,./w,concatenate/en,(/w,(/w,x/en,_,0/m,,/w, ,x/en,)/w,,/w, ,axis/en,=/w,1/m,)/w, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,with/en,_,x/en,0/m,,/w, ,theta/en,)/w, ,return/en,(/w,np/en,./w,dot/en,(/w,(/w,h/en,-/w,y/en,)/w,./w,t/en,,/w, ,(/w,h/en,-/w,y/en,)/w,)/w,//w,(/w,2/m,*/w,m/en,)/w,)/w, ,x/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,4/m,]/w,]/w,)/w,./w,t/en, ,y/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,4/m,]/w,]/w,)/w,./w,t/en, ,theta/en,_,0/m, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,101/m,,/w, ,1/m,)/w,)/w, ,theta/en,_,1/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,np/en,./w,linspace/en,(/w,-/w,2/m,,/w, ,4/m,,/w, ,101/m,)/w,]/w,)/w,./w,t/en, ,theta/en, ,=/w, ,np/en,./w,concatenate/en,(/w,(/w,theta/en,_,0/m,,/w, ,theta/en,_,1/m,)/w,,/w, ,axis/en,=/w,1/m,)/w, ,#, ,101组/mq,不同/a,的/u,参数/n, ,j/en,_,list/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,101/m,)/w,:/w, ,current/en,_,theta/en, ,=/w, ,theta/en,[/w,i/en,:/w,i/en,+/w,1/m,]/w,./w,t/en, ,cost/en, ,=/w, ,calcu/en,_,cost/en,(/w,current/en,_,theta/en,,/w, ,x/en,,/w, ,y/en,)/w, ,j/en,_,list/en,./w,append/en,(/w,cost/en,[/w,0/m,,/w,0/m,]/w,)/w, ,plt/en,./w,plot/en,(/w,theta/en,_,1/m,,/w, ,j/en,_,list/en,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,theta/en,_,1/m,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,j/en,(/w,theta/en,)/w,'/w,)/w, ,plt/en,./w,savefig/en,(/w,'/w,cost/en,_,theta/en,./w,png/en,'/w,,/w, ,dpi/en,=/w,200/m,)/w,view/en, ,code/en,从/p,图/n,中/f,可以/v,很/d,直观/a,的/u,看到/v,θ,对/p,代价/n,函数/n,的/u,影响/vn,，/w,当/p,θ,1/m,=/w,1时/t,，/w,代价/n,函数/n,j/en,(/w,θ,)/w,取/v,到/v,最小值/nz,。/w,因为/c,线性/n,回归/v,模型/n,的/u,代价/n,函数/n,（/w,均方/nw,误差/n,）/w,的/u,性质/n,非常/d,好/a,，/w,因此/c,也/d,可以/v,直接/ad,使用/v,代数/n,的/u,方法/n,，/w,求/v,j/en,(/w,θ,)/w,的/u,一/m,阶导/nw,数/m,为/p,0/m,的/u,点/q,，/w,就/d,可以/v,直接/ad,求/v,出/v,最/d,优/ag,的/u,θ值/nw,（/w,正规/a,方程法/nw,）/w,。/w,4/m,./w, ,代价/n,函数/n,与/p,梯度/n,梯度/n,下降/v,中/f,的/u,梯度/n,指/v,的/u,是/v,代价/n,函数/n,对/p,各个/r,参数/n,的/u,偏/d,导数/n,，/w,偏/d,导数/n,的/u,方向/n,决定/v,了/u,在/p,学习/v,过程/n,中/f,参数/n,下降/v,的/u,方向/n,，/w,学习率/nw,（/w,通常/d,用/p,α,表示/v,）/w,决定/v,了/u,每/r,步/q,变化/vn,的/u,步长/nz,，/w,有/v,了/u,导数/n,和/c,学习率/nw,就/d,可以/v,使用/v,梯度/n,下降/v,算法/n,（/w,gradient/en, ,descent/en, ,algorithm/en,）/w,更新/v,参数/n,了/u,。/w,下/f,图/n,中/f,展示/v,了/u,只有/c,两个/m,参数/n,的/u,模型/n,运用/v,梯度/n,下降/v,算法/n,的/u,过程/n,。/w,下/f,图/n,可以/v,看做/v,是/v,代价/n,函数/n,j/en,(/w,θ,)/w,与/p,参数/n,θ,做出/v,的/u,图/n,，/w,曲面/n,上/f,的/u,一个/m,点/q,(/w,θ,0/m,,/w, ,θ,1/m,,/w, ,j/en,(/w,θ,)/w,)/w,，/w,有/v,无数/m,条/q,切线/n,，/w,在/p,这些/r,切线/n,中/f,与/p,x/en,-/w,y/en,平面/n,(/w,底面/nw,，/w,相当/d,于/p,θ,0/m,,/w, ,θ,1/m,)/w,夹角/n,最/d,大/a,的/u,那/r,条/q,切线/n,就/d,是/v,该/r,点/q,梯度/n,的/u,方向/n,，/w,沿/p,该/r,方向/n,移动/vn,，/w,会/v,产生/v,最/d,大/a,的/u,高度/d,变化/vn,(/w,相对于/nw,z/en,轴/q,，/w,这里/r,的/u,z/en,轴/q,相当/d,于/p,代价/n,函数/n,j/en,(/w,θ,)/w,)/w,。/w,4.1/m, ,线性/n,回归/v,模型/n,的/u,代价/n,函数/n,对/p,参数/n,的/u,偏/d,导数/n,还是/c,以/p,两个/m,参数/n,为/p,例/n,，/w,每个/r,参数/n,都/d,有/v,一个/m,偏/d,导数/n,，/w,且/c,综合/vn,了/u,所有/b,样本/n,的/u,信息/n,。/w,4.2/m, ,逻辑/n,回归/v,模型/n,的/u,代价/n,函数/n,对/p,参数/n,的/u,偏/d,导数/n,根据/p,逻辑/n,回归/v,模型/n,的/u,代价/n,函数/n,以及/c,sigmoid/en,函数/n,$/w,$/w,h/en,_,{/w,\/w,theta/en,}/w,(/w,x/en,)/w,=/w,g/en,(/w,\/w,theta/en,^,{/w,t/en,}/w,x/en,)/w,$/w,$/w,$/w,$/w,g/en,(/w,z/en,)/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,-/w,z/en,}/w,}/w,$/w,$/w,得到/v,对/p,每个/r,参数/n,的/u,偏导/nw,数/m,为/p,$/w,$/w,\/w,frac/en,{/w,\/w,partial/en,}/w,{/w,\/w,partial/en,\/w,theta/en,_,{/w,j/en,}/w,}/w,j/en,(/w,\/w,theta/en,)/w, ,=/w,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,(/w,h/en,_,\/w,theta/en,(/w,x/en,^,{/w,i/en,}/w,)/w,-/w,y/en,^,i/en,)/w,x/en,_,j/en,^,i/en,$/w,$/w,详细/ad,推导/vn,过程/n,可以/v,看/v,这里/r,-/w,逻辑/n,回归/v,代价/n,函数/n,的/u,导数/n,4.3/m, ,神经/n,网络/n,中/f,的/u,代价/n,函数/n,对/p,参数/n,的/u,偏/d,导数/n,这里/r,的/u,计算/v,过程/n,与/p,前面/f,都/d,不/d,一样/u,，/w,后面/f,再/d,补充/v,。/w,重大/a,修订/v,：/w,2017/m,./w,8/m,./w,14/m, ,修改/v,排版/v,，/w,补充/v,对/p,交叉/vn,熵/g,的/u,解释/v,referenceshttps/en,:/w,//w,//w,www/en,./w,quora/en,./w,com/en,//w,how/en,-/w,are/en,-/w,the/en,-/w,cost/en,-/w,functions/en,-/w,for/en,-/w,neural/en,-/w,networks/en,-/w,derived/en,//w,answer/en,//w,daniel/en,-/w,watson/en,-/w,22/m,?/w,srid/en,=/w,uiogqhttps/en,:/w,//w,//w,www/en,./w,zhihu/en,./w,com/en,//w,question/en,//w,23468713/m,https/en,:/w,//w,//w,zh/en,./w,wikipedia/en,./w,org/en,//w,wiki/en,//w,%/w,e/en,7%/mq,86%/mq,b/en,5/m,_,(/w,%/w,e/en,4%/mq,bf/en,%/w,a/en,1%/mq,e/en,6%/mq,81%/mq,af/en,%/w,e/en,8%/mq,ae/en,%/w,ba/en,)/w,https/en,:/w,//w,//w,hit/en,-/w,scir/en,./w,gitbooks/en,./w,io/en,//w,neural/en,-/w,networks/en,-/w,and/en,-/w,deep/en,-/w,learning/en,-/w,zh/en,_,cn/en,//w,content/en,//w,chap/en,3/m,//w,c/en,3/m,s/en,3/m,./w,htmlcoursera/en,,/w, ,andrew/en, ,ng/en, ,公开课/n,第一/m,周/nr,，/w,第三/nw,周/nr,，/w,第五/nw,周/nr,http/en,:/w,//w,//w,math/en,./w,stackexchange/en,./w,com/en,//w,questions/en,//w,477207/m,//w,derivative/en,-/w,of/en,-/w,cost/en,-/w,function/en,-/w,for/en,-/w,logistic/e