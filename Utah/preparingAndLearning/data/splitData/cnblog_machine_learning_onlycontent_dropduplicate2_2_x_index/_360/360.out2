准备/v,环境/n,anacondanano/en, ,~/w,//w,./w,zshrc/en, ,export/en, ,path/en,=/w,$/w,path/en,:/w,//w,anaconda/en,//w,bin/en, ,source/en, ,~/w,//w,./w,zshrc/en, ,echo/en, ,$/w,home/en, ,echo/en, ,$/w,pathipythonconda/en, ,update/en, ,conda/en, ,&/w,&/w, ,conda/en, ,update/en, ,ipython/en, ,ipython/en,-/w,notebook/en, ,ipython/en,-/w,qtconsole/en, ,conda/en, ,install/en, ,scipypythonpathexport/en, ,spark/en,_,home/en,=/w,//w,users/en,//w,erichan/en,//w,garden/en,//w,spark/en,-/w,1/m,./w,5/m,./w,1/m,-/w,bin/en,-/w,hadoop/en,2.6/m, ,export/en, ,pythonpath/en,=/w,$/w,{/w,spark/en,_,home/en,}/w,//w,python/en,//w,:/w,$/w,{/w,spark/en,_,home/en,}/w,//w,python/en,//w,lib/en,//w,py/en,4/m,j/en,-/w,0/m,./w,8/m,./w,2/m,./w,1/m,-/w,src/en,./w,zip/en,运行/vn,环境/n,cd/en, ,$/w,spark/en,_,home/en, ,ipython/en,=/w,1/m, ,ipython/en,_,opts/en,=/w,"/w,--/nrf,pylab/en,"/w, ,./w,//w,bin/en,//w,pyspark/en,数据/n,1/m,./w, ,获取/v,原始/a,数据/n,path/en, ,=/w, ,"/w,//w,users/en,//w,erichan/en,//w,sourcecode/en,//w,book/en,//w,spark/en,机器/n,学习/v,"/w, ,user/en,_,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,%/w,s/en,//w,ml/en,-/w,100/m,k/en,//w,u/en,./w,user/en,"/w, ,%/w, ,path/en,)/w, ,user/en,_,fields/en, ,=/w, ,user/en,_,data/en,./w,map/en,(/w,lambda/en, ,line/en,:/w, ,line/en,./w,split/en,(/w,"/w,|/w,"/w,)/w,)/w, ,movie/en,_,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,%/w,s/en,//w,ml/en,-/w,100/m,k/en,//w,u/en,./w,item/en,"/w, ,%/w, ,path/en,)/w, ,movie/en,_,fields/en, ,=/w, ,movie/en,_,data/en,./w,map/en,(/w,lambda/en, ,lines/en,:/w, ,lines/en,./w,split/en,(/w,"/w,|/w,"/w,)/w,)/w, ,rating/en,_,data/en,_,raw/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,%/w,s/en,//w,ml/en,-/w,100/m,k/en,//w,u/en,./w,data/en,"/w, ,%/w, ,path/en,)/w, ,rating/en,_,data/en, ,=/w, ,rating/en,_,data/en,_,raw/en,./w,map/en,(/w,lambda/en, ,line/en,:/w, ,line/en,./w,split/en,(/w,"/w,\/w,t/en,"/w,)/w,)/w,num/en,_,movies/en, ,=/w, ,movie/en,_,data/en,./w,count/en,(/w,)/w, ,print/en, ,num/en,_,movies/en,1682/m,user/en,_,data/en,./w,first/en,(/w,)/w,u/en,'/w,1/m,|/w,24/m,|/w,m/en,|/w,technician/en,|/w,85711/m,'/w,movie/en,_,data/en,./w,first/en,(/w,)/w,u/en,'/w,1/m,|/w,toy/en, ,story/en, ,(/w,1995/m,)/w,|/w,01/m,-/w,jan/en,-/w,1995/m,|/w,|/w,http/en,:/w,//w,//w,us/en,./w,imdb/en,./w,com/en,//w,m/en,//w,title/en,-/w,exact/en,?/w,toy/en,%/w,20/m,story/en,%/w,20/m,(/w,1995/m,)/w,|/w,0/m,|/w,0/m,|/w,0/m,|/w,1/m,|/w,1/m,|/w,1/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,|/w,0/m,'/w,rating/en,_,data/en,_,raw/en,./w,first/en,(/w,)/w,u/en,'/w,196/m,\/w,t/en,242/m,\/w,t/en,3/m,\/w,t/en,881250949/m,'/w,2/m,./w, ,探索/v,数据/n,2/m,./w,1/m,./w, ,按/p,列/v,统计/v,num/en,_,users/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,0/m,]/w,)/w,./w,count/en,(/w,)/w, ,num/en,_,genders/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,2/m,]/w,)/w,./w,distinct/en,(/w,)/w,./w,count/en,(/w,)/w, ,num/en,_,occupations/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,3/m,]/w,)/w,./w,distinct/en,(/w,)/w,./w,count/en,(/w,)/w, ,num/en,_,zipcodes/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,4/m,]/w,)/w,./w,distinct/en,(/w,)/w,./w,count/en,(/w,)/w, ,ratings/en, ,=/w, ,rating/en,_,data/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,int/en,(/w,fields/en,[/w,2/m,]/w,)/w,)/w, ,num/en,_,ratings/en, ,=/w, ,ratings/en,./w,count/en,(/w,)/w, ,max/en,_,rating/en, ,=/w, ,ratings/en,./w,reduce/en,(/w,lambda/en, ,x/en,,/w, ,y/en,:/w, ,max/en,(/w,x/en,,/w, ,y/en,)/w,)/w, ,min/en,_,rating/en, ,=/w, ,ratings/en,./w,reduce/en,(/w,lambda/en, ,x/en,,/w, ,y/en,:/w, ,min/en,(/w,x/en,,/w, ,y/en,)/w,)/w, ,mean/en,_,rating/en, ,=/w, ,ratings/en,./w,reduce/en,(/w,lambda/en, ,x/en,,/w, ,y/en,:/w, ,x/en, ,+/w, ,y/en,)/w, ,//w, ,float/en,(/w,num/en,_,ratings/en,)/w, ,median/en,_,rating/en, ,=/w, ,np/en,./w,median/en,(/w,ratings/en,./w,collect/en,(/w,)/w,)/w, ,ratings/en,_,per/en,_,user/en, ,=/w, ,num/en,_,ratings/en, ,//w, ,num/en,_,users/en, ,ratings/en,_,per/en,_,movie/en, ,=/w, ,num/en,_,ratings/en, ,//w, ,num/en,_,movies/en, ,print/en, ,"/w,users/en,:/w, ,%/w,d/en,,/w, ,genders/en,:/w, ,%/w,d/en,,/w, ,occupations/en,:/w, ,%/w,d/en,,/w, ,zip/en, ,codes/en,:/w, ,%/w,d/en,"/w, ,%/w, ,(/w,num/en,_,users/en,,/w, ,num/en,_,genders/en,,/w, ,num/en,_,occupations/en,,/w, ,num/en,_,zipcodes/en,)/w,users/en,:/w, ,943/m,,/w, ,genders/en,:/w, ,2/m,,/w, ,occupations/en,:/w, ,21/m,,/w, ,zip/en, ,codes/en,:/w, ,795/m,print/en, ,"/w,min/en, ,rating/en,:/w, ,%/w,d/en,"/w, ,%/w, ,min/en,_,ratingmin/en, ,rating/en,:/w, ,1/m,print/en, ,"/w,max/en, ,rating/en,:/w, ,%/w,d/en,"/w, ,%/w, ,max/en,_,ratingmax/en, ,rating/en,:/w, ,5/m,print/en, ,"/w,average/en, ,rating/en,:/w, ,%/w,2.2/m,f/en,"/w, ,%/w, ,mean/en,_,ratingaverage/en, ,rating/en,:/w, ,3.53/m,print/en, ,"/w,median/en, ,rating/en,:/w, ,%/w,d/en,"/w, ,%/w, ,median/en,_,ratingmedian/en, ,rating/en,:/w, ,4/m,print/en, ,"/w,average/en, ,#, ,of/en, ,ratings/en, ,per/en, ,user/en,:/w, ,%/w,2.2/m,f/en,"/w, ,%/w, ,ratings/en,_,per/en,_,useraverage/en, ,#, ,of/en, ,ratings/en, ,per/en, ,user/en,:/w, ,106.00/m,print/en, ,"/w,average/en, ,#, ,of/en, ,ratings/en, ,per/en, ,movie/en,:/w, ,%/w,2.2/m,f/en,"/w, ,%/w, ,ratings/en,_,per/en,_,movieaverage/en, ,#, ,of/en, ,ratings/en, ,per/en, ,movie/en,:/w, ,59.00/m,ratings/en,./w,stats/en,(/w,)/w,(/w,count/en,:/w, ,100000/m,,/w, ,mean/en,:/w, ,3.52986/m,,/w, ,stdev/en,:/w, ,1.12566797076/m,,/w, ,max/en,:/w, ,5/m,,/w, ,min/en,:/w, ,1/m,)/w,2/m,./w,2/m,./w, ,使用/v,matplotlib/en,的/u,hist/en,函数/n,绘制/v,直方图/n,ages/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,x/en,:/w, ,int/en,(/w,x/en,[/w,1/m,]/w,)/w,)/w,./w,collect/en,(/w,)/w, ,hist/en,(/w,ages/en,,/w, ,bins/en,=/w,20/m,,/w, ,color/en,=/w,'/w,lightblue/en,'/w,,/w, ,normed/en,=/w,true/en,)/w, ,fig/en, ,=/w, ,matplotlib/en,./w,pyplot/en,./w,gcf/en,(/w,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,16/m,,/w, ,10/m,)/w,count/en,_,by/en,_,rating/en, ,=/w, ,ratings/en,./w,countbyvalue/en,(/w,)/w, ,x/en,_,axis/en, ,=/w, ,np/en,./w,array/en,(/w,count/en,_,by/en,_,rating/en,./w,keys/en,(/w,)/w,)/w, ,y/en,_,axis/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,float/en,(/w,c/en,)/w, ,for/en, ,c/en, ,in/en, ,count/en,_,by/en,_,rating/en,./w,values/en,(/w,)/w,]/w,)/w, ,#, ,we/en, ,normalize/en, ,the/en, ,y/en,-/w,axis/en, ,here/en, ,to/en, ,percentages/en, ,y/en,_,axis/en,_,normed/en, ,=/w, ,y/en,_,axis/en, ,//w, ,y/en,_,axis/en,./w,sum/en,(/w,)/w, ,pos/en, ,=/w, ,np/en,./w,arange/en,(/w,len/en,(/w,x/en,_,axis/en,)/w,)/w, ,width/en, ,=/w, ,1.0/m, ,ax/en, ,=/w, ,plt/en,./w,axes/en,(/w,)/w, ,ax/en,./w,set/en,_,xticks/en,(/w,pos/en, ,+/w, ,(/w,width/en, ,//w, ,2/m,)/w,)/w, ,ax/en,./w,set/en,_,xticklabels/en,(/w,x/en,_,axis/en,)/w, ,plt/en,./w,bar/en,(/w,pos/en,,/w, ,y/en,_,axis/en,_,normed/en,,/w, ,width/en,,/w, ,color/en,=/w,'/w,lightblue/en,'/w,)/w, ,plt/en,./w,xticks/en,(/w,rotation/en,=/w,30/m,)/w, ,fig/en, ,=/w, ,matplotlib/en,./w,pyplot/en,./w,gcf/en,(/w,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,16/m,,/w, ,10/m,)/w,count/en,_,by/en,_,occupation/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,(/w,fields/en,[/w,3/m,]/w,,/w, ,1/m,)/w,)/w,./w,reducebykey/en,(/w,lambda/en, ,x/en,,/w, ,y/en,:/w, ,x/en, ,+/w, ,y/en,)/w,./w,collect/en,(/w,)/w, ,x/en,_,axis/en,1/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,c/en,[/w,0/m,]/w, ,for/en, ,c/en, ,in/en, ,count/en,_,by/en,_,occupation/en,]/w,)/w, ,y/en,_,axis/en,1/m, ,=/w, ,np/en,./w,array/en,(/w,[/w,c/en,[/w,1/m,]/w, ,for/en, ,c/en, ,in/en, ,count/en,_,by/en,_,occupation/en,]/w,)/w, ,x/en,_,axis/en, ,=/w, ,x/en,_,axis/en,1/m,[/w,np/en,./w,argsort/en,(/w,y/en,_,axis/en,1/m,)/w,]/w, ,y/en,_,axis/en, ,=/w, ,y/en,_,axis/en,1/m,[/w,np/en,./w,argsort/en,(/w,y/en,_,axis/en,1/m,)/w,]/w, ,pos/en, ,=/w, ,np/en,./w,arange/en,(/w,len/en,(/w,x/en,_,axis/en,)/w,)/w, ,width/en, ,=/w, ,1.0/m, ,ax/en, ,=/w, ,plt/en,./w,axes/en,(/w,)/w, ,ax/en,./w,set/en,_,xticks/en,(/w,pos/en, ,+/w, ,(/w,width/en, ,//w, ,2/m,)/w,)/w, ,ax/en,./w,set/en,_,xticklabels/en,(/w,x/en,_,axis/en,)/w, ,plt/en,./w,bar/en,(/w,pos/en,,/w, ,y/en,_,axis/en,,/w, ,width/en,,/w, ,color/en,=/w,'/w,lightblue/en,'/w,)/w, ,plt/en,./w,xticks/en,(/w,rotation/en,=/w,30/m,)/w, ,fig/en, ,=/w, ,matplotlib/en,./w,pyplot/en,./w,gcf/en,(/w,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,16/m,,/w, ,10/m,)/w,2/m,./w,3/m,./w, ,使用/v,countbyvalue/en,函数/n,统计/v,count/en,_,by/en,_,occupation/en,2/m, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,3/m,]/w,)/w,./w,countbyvalue/en,(/w,)/w, ,print/en, ,"/w,map/en,-/w,reduce/en, ,approach/en,:/w,"/w, ,print/en, ,dict/en,(/w,count/en,_,by/en,_,occupation/en,2/m,)/w,{/w,u/en,'/w,administrator/en,'/w,:/w, ,79/m,,/w, ,u/en,'/w,retired/en,'/w,:/w, ,14/m,,/w, ,u/en,'/w,lawyer/en,'/w,:/w, ,12/m,,/w, ,u/en,'/w,healthcare/en,'/w,:/w, ,16/m,,/w, ,u/en,'/w,marketing/en,'/w,:/w, ,26/m,,/w, ,u/en,'/w,executive/en,'/w,:/w, ,32/m,,/w, ,u/en,'/w,scientist/en,'/w,:/w, ,31/m,,/w, ,u/en,'/w,student/en,'/w,:/w, ,196/m,,/w, ,u/en,'/w,technician/en,'/w,:/w, ,27/m,,/w, ,u/en,'/w,librarian/en,'/w,:/w, ,51/m,,/w, ,u/en,'/w,programmer/en,'/w,:/w, ,66/m,,/w, ,u/en,'/w,salesman/en,'/w,:/w, ,12/m,,/w, ,u/en,'/w,homemaker/en,'/w,:/w, ,7/m,,/w, ,u/en,'/w,engineer/en,'/w,:/w, ,67/m,,/w, ,u/en,'/w,none/en,'/w,:/w, ,9/m,,/w, ,u/en,'/w,doctor/en,'/w,:/w, ,7/m,,/w, ,u/en,'/w,writer/en,'/w,:/w, ,45/m,,/w, ,u/en,'/w,entertainment/en,'/w,:/w, ,18/m,,/w, ,u/en,'/w,other/en,'/w,:/w, ,105/m,,/w, ,u/en,'/w,educator/en,'/w,:/w, ,95/m,,/w, ,u/en,'/w,artist/en,'/w,:/w, ,28/m,}/w,print/en, ,"/w,"/w, ,print/en, ,"/w,countbyvalue/en, ,approach/en,:/w,"/w, ,print/en, ,dict/en,(/w,count/en,_,by/en,_,occupation/en,)/w,{/w,u/en,'/w,administrator/en,'/w,:/w, ,79/m,,/w, ,u/en,'/w,writer/en,'/w,:/w, ,45/m,,/w, ,u/en,'/w,retired/en,'/w,:/w, ,14/m,,/w, ,u/en,'/w,lawyer/en,'/w,:/w, ,12/m,,/w, ,u/en,'/w,doctor/en,'/w,:/w, ,7/m,,/w, ,u/en,'/w,marketing/en,'/w,:/w, ,26/m,,/w, ,u/en,'/w,executive/en,'/w,:/w, ,32/m,,/w, ,u/en,'/w,none/en,'/w,:/w, ,9/m,,/w, ,u/en,'/w,entertainment/en,'/w,:/w, ,18/m,,/w, ,u/en,'/w,healthcare/en,'/w,:/w, ,16/m,,/w, ,u/en,'/w,scientist/en,'/w,:/w, ,31/m,,/w, ,u/en,'/w,student/en,'/w,:/w, ,196/m,,/w, ,u/en,'/w,educator/en,'/w,:/w, ,95/m,,/w, ,u/en,'/w,technician/en,'/w,:/w, ,27/m,,/w, ,u/en,'/w,librarian/en,'/w,:/w, ,51/m,,/w, ,u/en,'/w,programmer/en,'/w,:/w, ,66/m,,/w, ,u/en,'/w,artist/en,'/w,:/w, ,28/m,,/w, ,u/en,'/w,salesman/en,'/w,:/w, ,12/m,,/w, ,u/en,'/w,other/en,'/w,:/w, ,105/m,,/w, ,u/en,'/w,homemaker/en,'/w,:/w, ,7/m,,/w, ,u/en,'/w,engineer/en,'/w,:/w, ,67/m,}/w,2/m,./w,4/m,./w, ,使用/v,filter/en,转换/v,def/en, ,convert/en,_,year/en,(/w,x/en,)/w,:/w, ,try/en,:/w, ,return/en, ,int/en,(/w,x/en,[/w,-/w,4/m,:/w,]/w,)/w, ,except/en,:/w, ,return/en, ,1900/m, ,years/en, ,=/w, ,movie/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,2/m,]/w,)/w,./w,map/en,(/w,lambda/en, ,x/en,:/w, ,convert/en,_,year/en,(/w,x/en,)/w,)/w, ,years/en,_,filtered/en, ,=/w, ,years/en,./w,filter/en,(/w,lambda/en, ,x/en,:/w, ,x/en, ,!/w,=/w, ,1900/m,)/w, ,movie/en,_,ages/en, ,=/w, ,years/en,_,filtered/en,./w,map/en,(/w,lambda/en, ,yr/en,:/w, ,1998/m,-/w,yr/en,)/w,./w,countbyvalue/en,(/w,)/w, ,values/en, ,=/w, ,movie/en,_,ages/en,./w,values/en,(/w,)/w, ,bins/en, ,=/w, ,movie/en,_,ages/en,./w,keys/en,(/w,)/w, ,hist/en,(/w,values/en,,/w, ,bins/en,=/w,bins/en,,/w, ,color/en,=/w,'/w,lightblue/en,'/w,,/w, ,normed/en,=/w,true/en,)/w,(/w,array/en,(/w,[/w, ,0/m,./w, ,,/w, ,0.07575758/m,,/w, ,0.09090909/m,,/w, ,0.09090909/m,,/w, ,0.18181818/m,,/w,0.18181818/m,,/w, ,0.04545455/m,,/w, ,0.07575758/m,,/w, ,0.07575758/m,,/w, ,0.03030303/m,,/w,0/m,./w, ,,/w, ,0.01515152/m,,/w, ,0.01515152/m,,/w, ,0.03030303/m,,/w, ,0/m,./w, ,,/w,0.03030303/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.01515152/m,,/w, ,0/m,./w, ,,/w, ,0.01515152/m,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.01515152/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w,0.01515152/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,]/w,)/w,,/w,array/en,(/w,[/w, ,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,3/m,,/w, ,4/m,,/w, ,5/m,,/w, ,6/m,,/w, ,7/m,,/w, ,8/m,,/w, ,9/m,,/w, ,10/m,,/w, ,11/m,,/w, ,12/m,,/w, ,13/m,,/w, ,14/m,,/w, ,15/m,,/w, ,16/m,,/w,17/m,,/w, ,18/m,,/w, ,19/m,,/w, ,20/m,,/w, ,21/m,,/w, ,22/m,,/w, ,23/m,,/w, ,24/m,,/w, ,25/m,,/w, ,26/m,,/w, ,27/m,,/w, ,28/m,,/w, ,29/m,,/w, ,30/m,,/w, ,31/m,,/w, ,32/m,,/w, ,33/m,,/w,34/m,,/w, ,35/m,,/w, ,36/m,,/w, ,37/m,,/w, ,38/m,,/w, ,39/m,,/w, ,40/m,,/w, ,41/m,,/w, ,42/m,,/w, ,43/m,,/w, ,44/m,,/w, ,45/m,,/w, ,46/m,,/w, ,47/m,,/w, ,48/m,,/w, ,49/m,,/w, ,50/m,,/w,51/m,,/w, ,52/m,,/w, ,53/m,,/w, ,54/m,,/w, ,55/m,,/w, ,56/m,,/w, ,57/m,,/w, ,58/m,,/w, ,59/m,,/w, ,60/m,,/w, ,61/m,,/w, ,62/m,,/w, ,63/m,,/w, ,64/m,,/w, ,65/m,,/w, ,66/m,,/w, ,67/m,,/w,68/m,,/w, ,72/m,,/w, ,76/m,]/w,)/w,,/w,)/w,fig/en, ,=/w, ,matplotlib/en,./w,pyplot/en,./w,gcf/en,(/w,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,16/m,,/w,10/m,)/w,2/m,./w,5/m,./w, ,使用/v,groupbykey/en,分组/vn,#, ,to/en, ,compute/en, ,the/en, ,distribution/en, ,of/en, ,ratings/en, ,per/en, ,user/en,,/w, ,we/en, ,first/en, ,group/en, ,the/en, ,ratings/en, ,by/en, ,user/en, ,id/en, ,user/en,_,ratings/en,_,grouped/en, ,=/w, ,rating/en,_,data/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,(/w,int/en,(/w,fields/en,[/w,0/m,]/w,)/w,,/w, ,int/en,(/w,fields/en,[/w,2/m,]/w,)/w,)/w,)/w,./w,groupbykey/en,(/w,)/w, ,#, ,then/en,,/w, ,for/en, ,each/en, ,key/en, ,(/w,user/en, ,id/en,)/w,,/w, ,we/en, ,find/en, ,the/en, ,size/en, ,of/en, ,the/en, ,set/en, ,of/en, ,ratings/en,,/w, ,which/en, ,gives/en, ,us/en, ,the/en, ,#, ,ratings/en, ,for/en, ,that/en, ,user/en, ,user/en,_,ratings/en,_,byuser/en, ,=/w, ,user/en,_,ratings/en,_,grouped/en,./w,map/en,(/w,lambda/en, ,(/w,k/en,,/w, ,v/en,)/w,:/w, ,(/w,k/en,,/w, ,len/en,(/w,v/en,)/w,)/w,)/w, ,user/en,_,ratings/en,_,byuser/en,./w,take/en,(/w,5/m,)/w,[/w,(/w,2/m,,/w, ,62/m,)/w,,/w, ,(/w,4/m,,/w, ,24/m,)/w,,/w, ,(/w,6/m,,/w, ,211/m,)/w,,/w, ,(/w,8/m,,/w, ,59/m,)/w,,/w, ,(/w,10/m,,/w, ,184/m,)/w,]/w,user/en,_,ratings/en,_,byuser/en,_,local/en, ,=/w, ,user/en,_,ratings/en,_,byuser/en,./w,map/en,(/w,lambda/en, ,(/w,k/en,,/w, ,v/en,)/w,:/w, ,v/en,)/w,./w,collect/en,(/w,)/w, ,hist/en,(/w,user/en,_,ratings/en,_,byuser/en,_,local/en,,/w, ,bins/en,=/w,200/m,,/w, ,color/en,=/w,'/w,lightblue/en,'/w,,/w, ,normed/en,=/w,true/en,)/w,fig/en, ,=/w, ,matplotlib/en,./w,pyplot/en,./w,gcf/en,(/w,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,16/m,,/w,10/m,)/w,3/m,./w, ,处理/v,转换/v,3/m,./w,1/m,./w, ,填充/v,缺/v,失/v,years/en,_,pre/en,_,processed/en, ,=/w, ,movie/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,2/m,]/w,)/w,./w,map/en,(/w,lambda/en, ,x/en,:/w, ,convert/en,_,year/en,(/w,x/en,)/w,)/w,./w,filter/en,(/w,lambda/en, ,yr/en,:/w, ,yr/en, ,!/w,=/w, ,1900/m,)/w,./w,collect/en,(/w,)/w, ,years/en,_,pre/en,_,processed/en,_,array/en, ,=/w, ,np/en,./w,array/en,(/w,years/en,_,pre/en,_,processed/en,)/w, ,#, ,first/en, ,we/en, ,compute/en, ,the/en, ,mean/en, ,and/en, ,median/en, ,year/en, ,of/en, ,release/en,,/w, ,without/en, ,the/en, ,'/w,bad/en,'/w, ,data/en, ,point/en, ,mean/en,_,year/en, ,=/w, ,np/en,./w,mean/en,(/w,years/en,_,pre/en,_,processed/en,_,array/en,[/w,years/en,_,pre/en,_,processed/en,_,array/en,!/w,=/w,1900/m,]/w,)/w, ,median/en,_,year/en, ,=/w, ,np/en,./w,median/en,(/w,years/en,_,pre/en,_,processed/en,_,array/en,[/w,years/en,_,pre/en,_,processed/en,_,array/en,!/w,=/w,1900/m,]/w,)/w, ,idx/en,_,bad/en,_,data/en, ,=/w, ,np/en,./w,where/en,(/w,years/en,_,pre/en,_,processed/en,_,array/en,=/w,=/w,1900/m,)/w,[/w,0/m,]/w, ,years/en,_,pre/en,_,processed/en,_,array/en,[/w,idx/en,_,bad/en,_,data/en,]/w, ,=/w, ,median/en,_,year/en, ,print/en, ,"/w,mean/en, ,year/en, ,of/en, ,release/en,:/w, ,%/w,d/en,"/w, ,%/w, ,mean/en,_,yearmean/en, ,year/en, ,of/en, ,release/en,:/w, ,1989/m,print/en, ,"/w,median/en, ,year/en, ,of/en, ,release/en,:/w, ,%/w,d/en,"/w, ,%/w, ,median/en,_,yearmedian/en, ,year/en, ,of/en, ,release/en,:/w, ,1995/m,print/en, ,"/w,index/en, ,of/en, ,'/w,1900/m,'/w, ,after/en, ,assigning/en, ,median/en,:/w, ,%/w,s/en,"/w, ,%/w, ,np/en,./w,where/en,(/w,years/en,_,pre/en,_,processed/en,_,array/en, ,=/w,=/w, ,1900/m,)/w,[/w,0/m,]/w,index/en, ,of/en, ,'/w,1900/m,'/w, ,after/en, ,assigning/en, ,median/en,:/w, ,[/w,]/w,4/m,./w, ,提取/v,特征/n,4/m,./w,1/m,./w, ,类别/n,特征/n,（/w,norminal/en,变量/n,//w,ordinal/en,变量/n,）/w,all/en,_,occupations/en, ,=/w, ,user/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,3/m,]/w,)/w,./w,distinct/en,(/w,)/w,./w,collect/en,(/w,)/w, ,all/en,_,occupations/en,./w,sort/en,(/w,)/w, ,#, ,create/en, ,a/en, ,new/en, ,dictionary/en, ,to/en, ,hold/en, ,the/en, ,occupations/en,,/w, ,and/en, ,assign/en, ,the/en, ,"/w,1/m,-/w,of/en,-/w,k/en,"/w, ,indexes/en, ,idx/en, ,=/w, ,0/m, ,all/en,_,occupations/en,_,dict/en, ,=/w, ,{/w,}/w, ,for/en, ,o/en, ,in/en, ,all/en,_,occupations/en,:/w, ,all/en,_,occupations/en,_,dict/en,[/w,o/en,]/w, ,=/w, ,idx/en, ,idx/en, ,+/w,=/w,1/m, ,#, ,try/en, ,a/en, ,few/en, ,examples/en, ,to/en, ,see/en, ,what/en, ,"/w,1/m,-/w,of/en,-/w,k/en,"/w, ,encoding/en, ,is/en, ,assigned/en, ,print/en, ,"/w,encoding/en, ,of/en, ,'/w,doctor/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,occupations/en,_,dict/en,[/w,'/w,doctor/en,'/w,]/w, ,print/en, ,"/w,encoding/en, ,of/en, ,'/w,programmer/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,occupations/en,_,dict/en,[/w,'/w,programmer/en,'/w,]/w,encoding/en, ,of/en, ,'/w,doctor/en,'/w,:/w, ,2/m,encoding/en, ,of/en, ,'/w,programmer/en,'/w,:/w, ,14/m,numpy/en,的/u,zeros/en,函数/n,k/en, ,=/w, ,len/en,(/w,all/en,_,occupations/en,_,dict/en,)/w, ,binary/en,_,x/en, ,=/w, ,np/en,./w,zeros/en,(/w,k/en,)/w, ,k/en,_,programmer/en, ,=/w, ,all/en,_,occupations/en,_,dict/en,[/w,'/w,programmer/en,'/w,]/w, ,binary/en,_,x/en,[/w,k/en,_,programmer/en,]/w, ,=/w, ,1/m, ,print/en, ,"/w,binary/en, ,feature/en, ,vector/en,:/w, ,%/w,s/en,"/w, ,%/w, ,binary/en,_,x/en, ,print/en, ,"/w,length/en, ,of/en, ,binary/en, ,vector/en,:/w, ,%/w,d/en,"/w, ,%/w, ,kbinary/en, ,feature/en, ,vector/en,:/w, ,[/w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w, ,1/m,./w, ,0/m,./w, ,0/m,./w, ,0/m,./w,0/m,./w, ,0/m,./w,]/w, ,length/en, ,of/en, ,binary/en, ,vector/en,:/w, ,214/m,./w,2/m,./w, ,派生/v,特征/n,时间/n,戳/v,转换/v,为/p,类别/n,特征/n,def/en, ,extract/en,_,datetime/en,(/w,ts/en,)/w,:/w, ,import/en, ,datetime/en, ,return/en, ,datetime/en,./w,datetime/en,./w,fromtimestamp/en,(/w,ts/en,)/w, ,def/en, ,assign/en,_,tod/en,(/w,hr/en,)/w,:/w, ,times/en,_,of/en,_,day/en, ,=/w, ,{/w, ,'/w,morning/en,'/w, ,:/w, ,range/en,(/w,7/m,,/w, ,12/m,)/w,,/w, ,'/w,lunch/en,'/w, ,:/w, ,range/en,(/w,12/m,,/w, ,15/m,)/w,,/w, ,'/w,afternoon/en,'/w, ,:/w, ,range/en,(/w,15/m,,/w, ,18/m,)/w,,/w, ,'/w,evening/en,'/w, ,:/w, ,range/en,(/w,18/m,,/w, ,23/m,)/w,,/w, ,'/w,night/en,'/w, ,:/w, ,{/w,23/m,,/w,24/m,,/w,0/m,,/w,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,,/w,7/m,}/w, ,}/w, ,for/en, ,k/en,,/w, ,v/en, ,in/en, ,times/en,_,of/en,_,day/en,./w,iteritems/en,(/w,)/w,:/w, ,if/en, ,hr/en, ,in/en, ,v/en,:/w, ,return/en, ,k/en, ,timestamps/en, ,=/w, ,rating/en,_,data/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,int/en,(/w,fields/en,[/w,3/m,]/w,)/w,)/w, ,hour/en,_,of/en,_,day/en, ,=/w, ,timestamps/en,./w,map/en,(/w,lambda/en, ,ts/en,:/w, ,extract/en,_,datetime/en,(/w,ts/en,)/w,./w,hour/en,)/w, ,#, ,now/en, ,apply/en, ,the/en, ,"/w,time/en, ,of/en, ,day/en,"/w, ,function/en, ,to/en, ,the/en, ,"/w,hour/en, ,of/en, ,day/en,"/w, ,rdd/en, ,time/en,_,of/en,_,day/en, ,=/w, ,hour/en,_,of/en,_,day/en,./w,map/en,(/w,lambda/en, ,hr/en,:/w, ,assign/en,_,tod/en,(/w,hr/en,)/w,)/w, ,timestamps/en,./w,take/en,(/w,5/m,)/w,[/w,881250949/m,,/w, ,891717742/m,,/w, ,878887116/m,,/w, ,880606923/m,,/w, ,886397596/m,]/w,hour/en,_,of/en,_,day/en,./w,take/en,(/w,5/m,)/w,[/w,23/m,,/w, ,3/m,,/w, ,15/m,,/w, ,13/m,,/w, ,13/m,]/w,time/en,_,of/en,_,day/en,./w,take/en,(/w,5/m,)/w,[/w,'/w,night/en,'/w,,/w, ,'/w,night/en,'/w,,/w, ,'/w,afternoon/en,'/w,,/w, ,'/w,lunch/en,'/w,,/w, ,'/w,lunch/en,'/w,]/w,4/m,./w,3/m,./w, ,文本/n,特征/n,def/en, ,extract/en,_,title/en,(/w,raw/en,)/w,:/w, ,import/en, ,re/en, ,grps/en, ,=/w, ,re/en,./w,search/en,(/w,"/w,\/w,(/w,(/w,\/w,w/en,+/w,)/w,\/w,)/w,"/w,,/w, ,raw/en,)/w, ,if/en, ,grps/en,:/w, ,return/en, ,raw/en,[/w,:/w,grps/en,./w,start/en,(/w,)/w,]/w,./w,strip/en,(/w,)/w, ,else/en,:/w, ,return/en, ,raw/en, ,raw/en,_,titles/en, ,=/w, ,movie/en,_,fields/en,./w,map/en,(/w,lambda/en, ,fields/en,:/w, ,fields/en,[/w,1/m,]/w,)/w, ,for/en, ,raw/en,_,title/en, ,in/en, ,raw/en,_,titles/en,./w,take/en,(/w,5/m,)/w,:/w, ,print/en, ,extract/en,_,title/en,(/w,raw/en,_,title/en,)/w,toy/en, ,storygoldeneyefour/en, ,roomsget/en, ,shortycopycatmovie/en,_,titles/en, ,=/w, ,raw/en,_,titles/en,./w,map/en,(/w,lambda/en, ,m/en,:/w, ,extract/en,_,title/en,(/w,m/en,)/w,)/w, ,#, ,next/en, ,we/en, ,tokenize/en, ,the/en, ,titles/en, ,into/en, ,terms/en,./w, ,we/en,'/w,ll/en, ,use/en, ,simple/en, ,whitespace/en, ,tokenization/en, ,title/en,_,terms/en, ,=/w, ,movie/en,_,titles/en,./w,map/en,(/w,lambda/en, ,t/en,:/w, ,t/en,./w,split/en,(/w,"/w, ,"/w,)/w,)/w, ,print/en, ,title/en,_,terms/en,./w,take/en,(/w,5/m,)/w,[/w,[/w,u/en,'/w,toy/en,'/w,,/w, ,u/en,'/w,story/en,'/w,]/w,,/w, ,[/w,u/en,'/w,goldeneye/en,'/w,]/w,,/w, ,[/w,u/en,'/w,four/en,'/w,,/w, ,u/en,'/w,rooms/en,'/w,]/w,,/w, ,[/w,u/en,'/w,get/en,'/w,,/w, ,u/en,'/w,shorty/en,'/w,]/w,,/w, ,[/w,u/en,'/w,copycat/en,'/w,]/w,]/w,flatmapall/en,_,terms/en, ,=/w, ,title/en,_,terms/en,./w,flatmap/en,(/w,lambda/en, ,x/en,:/w, ,x/en,)/w,./w,distinct/en,(/w,)/w,./w,collect/en,(/w,)/w, ,#, ,create/en, ,a/en, ,new/en, ,dictionary/en, ,to/en, ,hold/en, ,the/en, ,terms/en,,/w, ,and/en, ,assign/en, ,the/en, ,"/w,1/m,-/w,of/en,-/w,k/en,"/w, ,indexes/en, ,idx/en, ,=/w, ,0/m, ,all/en,_,terms/en,_,dict/en, ,=/w, ,{/w,}/w, ,for/en, ,term/en, ,in/en, ,all/en,_,terms/en,:/w, ,all/en,_,terms/en,_,dict/en,[/w,term/en,]/w, ,=/w, ,idx/en, ,idx/en, ,+/w,=/w,1/m, ,num/en,_,terms/en, ,=/w, ,len/en,(/w,all/en,_,terms/en,_,dict/en,)/w, ,print/en, ,"/w,total/en, ,number/en, ,of/en, ,terms/en,:/w, ,%/w,d/en,"/w, ,%/w, ,num/en,_,termstotal/en, ,number/en, ,of/en, ,terms/en,:/w, ,2645/m,print/en, ,"/w,index/en, ,of/en, ,term/en, ,'/w,dead/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,terms/en,_,dict/en,[/w,'/w,dead/en,'/w,]/w,index/en, ,of/en, ,term/en, ,'/w,dead/en,'/w,:/w, ,147/m,print/en, ,"/w,index/en, ,of/en, ,term/en, ,'/w,rooms/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,terms/en,_,dict/en,[/w,'/w,rooms/en,'/w,]/w,index/en, ,of/en, ,term/en, ,'/w,rooms/en,'/w,:/w, ,1963/m,zipwithindexall/en,_,terms/en,_,dict/en,2/m, ,=/w, ,title/en,_,terms/en,./w,flatmap/en,(/w,lambda/en, ,x/en,:/w, ,x/en,)/w,./w,distinct/en,(/w,)/w,./w,zipwithindex/en,(/w,)/w,./w,collectasmap/en,(/w,)/w, ,print/en, ,"/w,index/en, ,of/en, ,term/en, ,'/w,dead/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,terms/en,_,dict/en,2/m,[/w,'/w,dead/en,'/w,]/w, ,print/en, ,"/w,index/en, ,of/en, ,term/en, ,'/w,rooms/en,'/w,:/w, ,%/w,d/en,"/w, ,%/w, ,all/en,_,terms/en,_,dict/en,2/m,[/w,'/w,rooms/en,'/w,]/w,index/en, ,of/en, ,term/en, ,'/w,dead/en,'/w,:/w, ,147/m,index/en, ,of/en, ,term/en, ,'/w,rooms/en,'/w,:/w, ,1963/m,创建/v,稀疏/a,向/p,量/n,//w,广播/vn,变量/n,scipy/en, ,depends/en, ,$/w,pythonpathdef/en, ,create/en,_,vector/en,(/w,terms/en,,/w, ,term/en,_,dict/en,)/w,:/w, ,from/en, ,scipy/en, ,import/en, ,sparse/en, ,as/en, ,sp/en, ,x/en, ,=/w, ,sp/en,./w,csc/en,_,matrix/en,(/w,(/w,1/m,,/w, ,num/en,_,terms/en,)/w,)/w, ,for/en, ,t/en, ,in/en, ,terms/en,:/w, ,if/en, ,t/en, ,in/en, ,term/en,_,dict/en,:/w, ,idx/en, ,=/w, ,term/en,_,dict/en,[/w,t/en,]/w, ,x/en,[/w,0/m,,/w, ,idx/en,]/w, ,=/w, ,1/m, ,return/en, ,x/en, ,all/en,_,terms/en,_,bcast/en, ,=/w, ,sc/en,./w,broadcast/en,(/w,all/en,_,terms/en,_,dict/en,)/w, ,term/en,_,vectors/en, ,=/w, ,title/en