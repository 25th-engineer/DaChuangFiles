注/v,：/w,该/r,文/ng,是/v,上/f,了/u,开智/nw,学堂/n,数据/n,科学/n,入门/v,班/n,的/u,课后/t,做/v,的/u,笔记/n,，/w,主讲人/n,是/v,肖凯/nr,老师/n,。/w,机器/n,学习/v,初步/d,机器/n,学习/v,基本/a,概念/n,机器/n,学习/v,、/w,统计/v,模型/n,和/c,数据/n,挖掘/v,有/v,什么/r,异同/n,？/w,机器/n,学习/v,和/c,统计/v,模型/n,区别/n,不/d,是/v,很大/d,，/w,机器/n,学习/v,和/c,统计/v,模型/n,中/f,的/u,回归/v,都/d,一样/u,，/w,底层/n,算法/n,都/d,是/v,差不多/l,的/u,，/w,只是/d,侧重点/n,不/d,一样/u,，/w,在/p,统计学/n,的/u,角度/n,，/w,回归/v,主要/b,解决/v,的/u,问题/n,侧重点/n,在于/v,模型/n,的/u,解释/v,能力/n,，/w,关注/v,的/u,是/v, ,x/en, ,和/c, ,y/en, ,之间/f,的/u,关系/n,，/w,关注/v,的/u,更/d,多/a,是/v,系数/n,，/w,从/p,机器/n,学习/v,的/u,角度/n,看/v,，/w,关注/v,的/u,重点/n,是/v,预测/v,的/u,准确性/n,。/w,机器/n,学习/v,和/c,数据/n,挖掘/v,也/d,没/d,什么/r,不/d,一样/u,，/w,两者/r,的/u,算法/n,基本上/d,是/v,一样/u,的/u,，/w,只是/d,在/p,一些/m,流程/n,步骤/n,上/f,，/w,数据/n,挖掘/v,会/v,有/v,一些/m,特征/n,工程/n,的/u,工作/vn,，/w,以及/c,对/p,具体/a,应用/vn,问题/n,的/u,解释/v,。/w,有/v,监督/vn,学习/v,和/c,无/v,监督/vn,学习/v,有/v,什么/r,区别/n,？/w,有/v,监督/vn,学习/v,就/d,是/v,指/v,有/v, ,y/en, ,作为/v,数据/n,的/u,一部分/m,，/w,被/p,称为/v,目标/n,变量/n,，/w,或/c,被/p,解释/v,变量/n,。/w,无/v,监督/vn,学习/v,是/v,指/v,一堆/mq,数据/n,，/w,没有/v,特定/b,的/u, ,y/en,，/w,要/v,从/p,一堆/mq, ,x/en, ,里/f,找到/v,模式/n,或者/c,规律/n,出来/v,。/w,有/v,监督/vn,学习/v,可以/v,分为/v,两个子/nw,类/q,：/w,分类/vn,和/c,回归/v,。/w,分类/vn,问题/n,中/f,要/v,预测/v,的/u, ,y/en, ,偏离/v,散/v,，/w,比如/v,性别/n,、/w,血型/n,；/w,回归/v,问题/n, ,y/en, ,都/d,是/v,连续/a,的/u,，/w,实/a,数域/nw,中/f,的/u,，/w,比如/v,收入/n,、/w,天气/n,。/w,分类/vn,问题/n,和/c,聚类/nw,问题/n,有/v,什么/r,区别/n,？/w,分类/vn,问题/n,是/v,预测/v,一个/m,未知/vn,类别/n,的/u,对象/n,属于/v,哪个/r,类别/n,，/w,而/c,聚类/nw,是/v,根据/p,选定/v,的/u,指标/n,，/w,对/p,一群/mq,对象/n,进行/v,划分/v,，/w,它/r,不/d,属于/v,预测/v,问题/n,。/w,交叉/vn,验证/vn,是/v,什么/r,？/w,交叉/vn,验证/vn,是/v,指/v,用/p,来/v,建立/v,模型/n,的/u,数据/n,，/w,和/c,最后/f,用/p,来/v,模型/n,验证/vn,的/u,数据/n,，/w,是/v,不/d,一样/u,的/u,。/w,实践/v,中/f,拿/v,到/v,数据/n,后/f,，/w,应该/v,分为/v,几/m,个/q,部分/n,，/w,最/d,简单/a,的/u,分为/v,两/m,部分/n,，/w,一部分/m,用于/v,训练/vn,模型/n,，/w,另外/c,一部分/m,用于/v,检验/v,模型/n,，/w,这/r,就/d,是/v,交叉/vn,验证/vn,。/w,何时/r,用/p,到/v,特征/n,工程/n,？/w,特征/n,工程/n,是/v,指/v,要/v,把/p,原始/a,数据/n,做/v,些/q,整理/v,，/w,做/v,些/q,转换/v,，/w,主要/b,目的/n,是/v,暴露/v,出/v,预测/v, ,y/en, ,的/u,信息/n,。/w,如何/r,加/v,载/v, ,sklearn/en, ,的/u,内置/vn,数据集/nw,？/w,from/en, ,sklearn/en, ,import/en, ,datasets/en, ,from/en, ,sklearn/en, ,import/en, ,cross/en,_,validation/en, ,from/en, ,sklearn/en, ,import/en, ,linear/en,_,model/en, ,from/en, ,sklearn/en, ,import/en, ,metrics/en, ,from/en, ,sklearn/en, ,import/en, ,tree/en, ,from/en, ,sklearn/en, ,import/en, ,neighbors/en, ,from/en, ,sklearn/en, ,import/en, ,svm/en, ,from/en, ,sklearn/en, ,import/en, ,ensemble/en, ,from/en, ,sklearn/en, ,import/en, ,cluster/en,%/w,matplotlib/en, ,inline/en, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,pltimport/en, ,numpy/en, ,as/en, ,np/en, ,import/en, ,seaborn/en, ,as/en, ,snsskearn/en, ,有/v,很多/m,内置/vn,的/u,数据集/nw,，/w,上面/f,已经/d,加载/v,了/u, ,sklearn/en, ,的/u, ,datasets/en,，/w,datasets/en, ,有/v,一些/m,可以/v,用/p,的/u,数据/n,，/w,比如说/l,加载/v, ,boston/en, ,数据集/nw,，/w,加载/v,后/f,返回/v,的/u,就/d,是/v,个/q,数据/n,字典/n,。/w,boston/en, ,=/w, ,datasets/en,./w,load/en,_,boston/en,(/w,)/w, ,print/en, ,boston/en,./w,keys/en,(/w,)/w,[/w,'/w,data/en,'/w,,/w, ,'/w,feature/en,_,names/en,'/w,,/w, ,'/w,descr/en,'/w,,/w, ,'/w,target/en,'/w,]/w,数据集/nw,的/u,大小/n,//w,格式/n,//w,类型/n,等/u,信息/n,如何/r,得知/v,？/w,print/en, ,boston/en,./w,descrboston/en, ,house/en, ,prices/en, ,dataset/en, ,notes/en, ,------/nrf, ,data/en, ,set/en, ,characteristics/en,:/w, ,:/w,number/en, ,of/en, ,instances/en,:/w, ,506/m, ,:/w,number/en, ,of/en, ,attributes/en,:/w, ,13/m, ,numeric/en,//w,categorical/en, ,predictive/en, ,:/w,median/en, ,value/en, ,(/w,attribute/en, ,14/m,)/w, ,is/en, ,usually/en, ,the/en, ,target/en, ,:/w,attribute/en, ,information/en, ,(/w,in/en, ,order/en,)/w,:/w, ,-/w, ,crim/en, ,per/en, ,capita/en, ,crime/en, ,rate/en, ,by/en, ,town/en, ,-/w, ,zn/en, ,proportion/en, ,of/en, ,residential/en, ,land/en, ,zoned/en, ,for/en, ,lots/en, ,over/en, ,25/m,,/w,000/m, ,sq/en,./w,ft/en,./w, ,-/w, ,indus/en, ,proportion/en, ,of/en, ,non/en,-/w,retail/en, ,business/en, ,acres/en, ,per/en, ,town/en, ,-/w, ,chas/en, ,charles/en, ,river/en, ,dummy/en, ,variable/en, ,(/w,=/w, ,1/m, ,if/en, ,tract/en, ,bounds/en, ,river/en,;/w, ,0/m, ,otherwise/en,)/w, ,-/w, ,nox/en, ,nitric/en, ,oxides/en, ,concentration/en, ,(/w,parts/en, ,per/en, ,10/m, ,million/en,)/w, ,-/w, ,rm/en, ,average/en, ,number/en, ,of/en, ,rooms/en, ,per/en, ,dwelling/en, ,-/w, ,age/en, ,proportion/en, ,of/en, ,owner/en,-/w,occupied/en, ,units/en, ,built/en, ,prior/en, ,to/en, ,1940/m, ,-/w, ,dis/en, ,weighted/en, ,distances/en, ,to/en, ,five/en, ,boston/en, ,employment/en, ,centres/en, ,-/w, ,rad/en, ,index/en, ,of/en, ,accessibility/en, ,to/en, ,radial/en, ,highways/en, ,-/w, ,tax/en, ,full/en,-/w,value/en, ,property/en,-/w,tax/en, ,rate/en, ,per/en, ,$/w,10/m,,/w,000/m, ,-/w, ,ptratio/en, ,pupil/en,-/w,teacher/en, ,ratio/en, ,by/en, ,town/en, ,-/w, ,b/en, ,1000/m,(/w,bk/en, ,-/w, ,0.63/m,)/w,^,2/m, ,where/en, ,bk/en, ,is/en, ,the/en, ,proportion/en, ,of/en, ,blacks/en, ,by/en, ,town/en, ,-/w, ,lstat/en, ,%/w, ,lower/en, ,status/en, ,of/en, ,the/en, ,population/en, ,-/w, ,medv/en, ,median/en, ,value/en, ,of/en, ,owner/en,-/w,occupied/en, ,homes/en, ,in/en, ,$/w,1000/m,'/w,s/en, ,:/w,missing/en, ,attribute/en, ,values/en,:/w, ,none/en, ,:/w,creator/en,:/w, ,harrison/en,,/w, ,d/en,./w, ,and/en, ,rubinfeld/en,,/w, ,d/en,./w,l/en,./w, ,this/en, ,is/en, ,a/en, ,copy/en, ,of/en, ,uci/en, ,ml/en, ,housing/en, ,dataset/en,./w, ,http/en,:/w,//w,//w,archive/en,./w,ics/en,./w,uci/en,./w,edu/en,//w,ml/en,//w,datasets/en,//w,housing/en, ,this/en, ,dataset/en, ,was/en, ,taken/en, ,from/en, ,the/en, ,statlib/en, ,library/en, ,which/en, ,is/en, ,maintained/en, ,at/en, ,carnegie/en, ,mellon/en, ,university/en,./w, ,the/en, ,boston/en, ,house/en,-/w,price/en, ,data/en, ,of/en, ,harrison/en,,/w, ,d/en,./w, ,and/en, ,rubinfeld/en,,/w, ,d/en,./w,l/en,./w, ,'/w,hedonic/en, ,prices/en, ,and/en, ,the/en, ,demand/en, ,for/en, ,clean/en, ,air/en,'/w,,/w, ,j/en,./w, ,environ/en,./w, ,economics/en, ,&/w, ,management/en,,/w, ,vol/en,./w,5/m,,/w, ,81/m,-/w,102/m,,/w, ,1978/m,./w, ,used/en, ,in/en, ,belsley/en,,/w, ,kuh/en, ,&/w, ,welsch/en,,/w, ,'/w,regression/en, ,diagnostics/en, ,./w,./w,./w,'/w,,/w, ,wiley/en,,/w, ,1980/m,./w, ,n/en,./w,b/en,./w, ,various/en, ,transformations/en, ,are/en, ,used/en, ,in/en, ,the/en, ,table/en, ,on/en, ,pages/en, ,244/m,-/w,261/m, ,of/en, ,the/en, ,latter/en,./w, ,the/en, ,boston/en, ,house/en,-/w,price/en, ,data/en, ,has/en, ,been/en, ,used/en, ,in/en, ,many/en, ,machine/en, ,learning/en, ,papers/en, ,that/en, ,address/en, ,regression/en, ,problems/en,./w, ,*/w,*/w,references/en,*/w,*/w, ,-/w, ,belsley/en,,/w, ,kuh/en, ,&/w, ,welsch/en,,/w, ,'/w,regression/en, ,diagnostics/en,:/w, ,identifying/en, ,influential/en, ,data/en, ,and/en, ,sources/en, ,of/en, ,collinearity/en,'/w,,/w, ,wiley/en,,/w, ,1980/m,./w, ,244/m,-/w,261/m,./w, ,-/w, ,quinlan/en,,/w,r/en,./w, ,(/w,1993/m,)/w,./w, ,combining/en, ,instance/en,-/w,based/en, ,and/en, ,model/en,-/w,based/en, ,learning/en,./w, ,in/en, ,proceedings/en, ,on/en, ,the/en, ,tenth/en, ,international/en, ,conference/en, ,of/en, ,machine/en, ,learning/en,,/w, ,236/m,-/w,243/m,,/w, ,university/en, ,of/en, ,massachusetts/en,,/w, ,amherst/en,./w, ,morgan/en, ,kaufmann/en,./w, ,-/w, ,many/en, ,more/en,!/w, ,(/w,see/en, ,http/en,:/w,//w,//w,archive/en,./w,ics/en,./w,uci/en,./w,edu/en,//w,ml/en,//w,datasets/en,//w,housing/en,)/w,boston/en,./w,data/en, ,#, ,自变量/n,矩阵/n,，/w,面积/n,、/w,家具/n,等/u,特征/n,array/en,(/w,[/w,[/w, ,6.32000000/m,e/en,-/w,03/m,,/w, ,1.80000000/m,e/en,+/w,01/m,,/w, ,2.31000000/m,e/en,+/w,00/m,,/w, ,./w,./w,./w,,/w, ,1.53000000/m,e/en,+/w,01/m,,/w, ,3.96900000/m,e/en,+/w,02/m,,/w, ,4.98000000/m,e/en,+/w,00/m,]/w,,/w, ,[/w, ,2.73100000/m,e/en,-/w,02/m,,/w, ,0.00000000/m,e/en,+/w,00/m,,/w, ,7.07000000/m,e/en,+/w,00/m,,/w, ,./w,./w,./w,,/w, ,1.78000000/m,e/en,+/w,01/m,,/w, ,3.96900000/m,e/en,+/w,02/m,,/w, ,9.14000000/m,e/en,+/w,00/m,]/w,,/w, ,[/w, ,2.72900000/m,e/en,-/w,02/m,,/w, ,0.00000000/m,e/en,+/w,00/m,,/w, ,7.07000000/m,e/en,+/w,00/m,,/w, ,./w,./w,./w,,/w, ,1.78000000/m,e/en,+/w,01/m,,/w, ,3.92830000/m,e/en,+/w,02/m,,/w, ,4.03000000/m,e/en,+/w,00/m,]/w,,/w, ,./w,./w,./w,,/w, ,[/w, ,6.07600000/m,e/en,-/w,02/m,,/w, ,0.00000000/m,e/en,+/w,00/m,,/w, ,1.19300000/m,e/en,+/w,01/m,,/w, ,./w,./w,./w,,/w, ,2.10000000/m,e/en,+/w,01/m,,/w, ,3.96900000/m,e/en,+/w,02/m,,/w, ,5.64000000/m,e/en,+/w,00/m,]/w,,/w, ,[/w, ,1.09590000/m,e/en,-/w,01/m,,/w, ,0.00000000/m,e/en,+/w,00/m,,/w, ,1.19300000/m,e/en,+/w,01/m,,/w, ,./w,./w,./w,,/w, ,2.10000000/m,e/en,+/w,01/m,,/w, ,3.93450000/m,e/en,+/w,02/m,,/w, ,6.48000000/m,e/en,+/w,00/m,]/w,,/w, ,[/w, ,4.74100000/m,e/en,-/w,02/m,,/w, ,0.00000000/m,e/en,+/w,00/m,,/w, ,1.19300000/m,e/en,+/w,01/m,,/w, ,./w,./w,./w,,/w, ,2.10000000/m,e/en,+/w,01/m,,/w, ,3.96900000/m,e/en,+/w,02/m,,/w, ,7.88000000/m,e/en,+/w,00/m,]/w,]/w,)/w,boston/en,./w,data/en,./w,shape/en,(/w,506/m,,/w, ,13/m,)/w,boston/en,./w,target/en,./w,shape/en, ,#, ,目标/n,变量/n,，/w,房价/n,(/w,506/m,,/w,)/w,datasets/en, ,除了/p,现有/v,的/u,数据/n,，/w,还/d,可以/v,造/v,一些/m,数据/n,，/w,通过/p,人造/b,数据/n,，/w,来/v,研究/vn,不同/a,算法/n,的/u,特点/n,。/w,datasets/en,./w,make/en,_,regression/en,</w,function/en, ,sklearn/en,./w,datasets/en,./w,samples/en,_,generator/en,./w,make/en,_,regression/en,>,回归/v,问题/n,回归/v,问题/n,中/f,，/w,y/en, ,是/v,个/q,连续/a,的/u,数值/n,，/w,不仅/c,可以/v,采取/v,线性/n,回归/v,，/w,还/d,可以/v,使用/v,决策/n,树/v,等/u,做/v,回归/v,，/w,只要/c,输出/v,是/v,连续/a,值/n,，/w,都/d,可以/v,用/p,回归/v,模型/n,。/w,sklearn/en, ,的/u,回归/v,和/c, ,statsmodel/en, ,中/f,的/u,回归/v,有/v,什么/r,异同/n,？/w,如果/c,使用/v,同样/d,的/u,模型/n,，/w,两者/r,的/u,回归/v,的/u,解/v,都/d,是/v,一样/u,的/u,，/w,只是/d, ,statsmodel/en, ,输出/v,更/d,多/a,些/q,，/w,比较/d,偏向/v,对/p,参数/n,做/v,更/d,多/a,的/u,解释/v,，/w,而/c, ,sklearn/en, ,更/d,注重/v,预测/v,准确性/n,。/w,如何/r,使用/v,交叉/vn,验证/vn,？/w,它/r,和/c,过/u,拟合/nz,有/v,什么/r,关系/n,？/w,来/v,个/q,完整/a,的/u,例子/n,。/w,np/en,./w,random/en,./w,seed/en,(/w,123/m,)/w, ,x/en,_,all/en,,/w, ,y/en,_,all/en, ,=/w, ,datasets/en,./w,make/en,_,regression/en,(/w,n/en,_,samples/en,=/w,50/m,,/w, ,n/en,_,features/en,=/w,50/m,,/w, ,n/en,_,informative/en,=/w,10/m,)/w, ,#, ,真正/d,有用/a,的/u,变量/n,只/d,有/v, ,10/m, ,个/q,，/w,另外/c, ,40/m, ,个/q,都/d,是/v,噪音/n, ,print/en, ,x/en,_,all/en,./w,shape/en,,/w, ,y/en,_,all/en,./w,shape/en,(/w,50/m,,/w, ,50/m,)/w, ,(/w,50/m,,/w,)/w,这个/r,数据集/nw,比较/d,棘手/a,，/w,样本/n,数/m,比较/d,少/a,，/w,变量/n,多/a,，/w,容易/a,过/u,拟合/nz,，/w,而且/c,有用/a,的/u,变量/n,不/d,多/a,，/w,有/v,很多/m,噪音/n,在/p,里面/f,，/w,在/p,做/v,回归/v,时/ng,，/w,很/d,容易/a,把/p,噪音/n,放/v,到/v,方程/n,里/f,，/w,用/p,传统/n,的/u,方法/n,比较/d,难于/v,处理/v,，/w,这里/r,用/p,机器/n,学习/v,处理/v,。/w,为了/p,防止/v,过/u,拟合/nz,，/w,要/v,用/p,交叉/vn,验证/vn,，/w,把/p,数据/n,分为/v,两/m,部分/n,，/w,一部分/m,用于/v,训练/vn,，/w,一部分/m,用于/v,验证/vn,。/w,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,cross/en,_,validation/en,./w,train/en,_,test/en,_,split/en,(/w,x/en,_,all/en,,/w, ,y/en,_,all/en,,/w, ,train/en,_,size/en,=/w,0.5/m,)/w, ,print/en, ,x/en,_,train/en,./w,shape/en,,/w, ,y/en,_,train/en,./w,shape/en, ,print/en, ,x/en,_,test/en,./w,shape/en,,/w, ,y/en,_,test/en,./w,shape/en, ,print/en, ,type/en,(/w,x/en,_,train/en,)/w,(/w,25/m,,/w, ,50/m,)/w, ,(/w,25/m,,/w,)/w, ,(/w,25/m,,/w, ,50/m,)/w, ,(/w,25/m,,/w,)/w, ,</w,type/en, ,'/w,numpy/en,./w,ndarray/en,'/w,>,如何/r,以/p,线性/n,模型/n,拟合/nz,数据集/nw,？/w,model/en, ,=/w, ,linear/en,_,model/en,./w,linearregression/en,(/w,)/w, ,#, ,实例/n,化/v, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,#, ,做/v,线性/n,回归/v,拟合/nz,数据/n,linearregression/en,(/w,copy/en,_,x/en,=/w,true/en,,/w, ,fit/en,_,intercept/en,=/w,true/en,,/w, ,n/en,_,jobs/en,=/w,1/m,,/w, ,normalize/en,=/w,false/en,)/w,残差/nw,（/w,residual/en,）/w,是/v,什么/r,？/w,如何/r,评估/vn,模型/n,是/v,个/q,好/a,模型/n,？/w,残差/nw,是/v,真实/a,的/u, ,y/en, ,和/c,预测/v,的/u, ,y/en, ,的/u,差/a,，/w,残差/nw,越/d,小/a,，/w,拟合/nz,越/d,好/a,。/w,def/en, ,sse/en,(/w,resid/en,)/w,:/w, ,return/en, ,sum/en,(/w,resid/en,*/w,*/w,2/m,)/w, ,#, ,残差/nw,平方和/n,，/w,是/v,回归/v,效果/n,的/u,一个/m,指标/n,残差/nw,平方/q,和/c,是/v,回归/v,效果/n,的/u,一个/m,指标/n,，/w,值/n,越/d,小/a,，/w,说明/v,模型/n,越/d,好/a,。/w,resid/en,_,train/en, ,=/w, ,y/en,_,train/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,sse/en,_,train/en, ,=/w, ,sse/en,(/w,resid/en,_,train/en,)/w, ,print/en, ,sse/en,_,train/en,5.87164948974/m,e/en,-/w,25/m,resid/en,_,test/en, ,=/w, ,y/en,_,test/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,sse/en,_,test/en, ,=/w, ,sse/en,(/w,resid/en,_,test/en,)/w, ,sse/en,_,test/en,194948.84691187815/m,model/en,./w,score/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,#, ,计算/v,判定/v,系数/n, ,r/en,-/w,squared/en,1.0/m,model/en,./w,score/en,(/w,x/en,_,test/en,,/w, ,y/en,_,test/en,)/w,0.26275088549060643/m,模型/n,在/p,测试/vn,集/vg,上/f,的/u,分数/n,只/d,有/v, ,0.26/m,，/w,效果/n,并/c,不/d,好/a,。/w,画/v,出/v,各个/r,样本/n,对应/v,的/u,残差/nw,，/w,和/c,各个/r,变量/n,的/u,系数/n,。/w,def/en, ,plot/en,_,residuals/en,_,and/en,_,coeff/en,(/w,resid/en,_,train/en,,/w, ,resid/en,_,test/en,,/w, ,coeff/en,)/w,:/w, ,fig/en,,/w, ,axes/en, ,=/w, ,plt/en,./w,subplots/en,(/w,1/m,,/w, ,3/m,,/w, ,figsize/en,=/w,(/w,12/m,,/w, ,3/m,)/w,)/w, ,axes/en,[/w,0/m,]/w,./w,bar/en,(/w,np/en,./w,arange/en,(/w,len/en,(/w,resid/en,_,train/en,)/w,)/w,,/w, ,resid/en,_,train/en,)/w, ,#, ,各个/r,样本/n,对应/v,的/u,残差/nw, ,axes/en,[/w,0/m,]/w,./w,set/en,_,xlabel/en,(/w,"/w,sample/en, ,number/en,"/w,)/w, ,axes/en,[/w,0/m,]/w,./w,set/en,_,ylabel/en,(/w,"/w,residual/en,"/w,)/w, ,axes/en,[/w,0/m,]/w,./w,set/en,_,title/en,(/w,"/w,training/en, ,data/en,"/w,)/w, ,axes/en,[/w,1/m,]/w,./w,bar/en,(/w,np/en,./w,arange/en,(/w,len/en,(/w,resid/en,_,test/en,)/w,)/w,,/w, ,resid/en,_,test/en,)/w, ,#, ,各个/r,样本/n,对应/v,的/u,残差/nw, ,axes/en,[/w,1/m,]/w,./w,set/en,_,xlabel/en,(/w,"/w,sample/en, ,number/en,"/w,)/w, ,axes/en,[/w,1/m,]/w,./w,set/en,_,ylabel/en,(/w,"/w,residual/en,"/w,)/w, ,axes/en,[/w,1/m,]/w,./w,set/en,_,title/en,(/w,"/w,testing/en, ,data/en,"/w,)/w, ,axes/en,[/w,2/m,]/w,./w,bar/en,(/w,np/en,./w,arange/en,(/w,len/en,(/w,coeff/en,)/w,)/w,,/w, ,coeff/en,)/w, ,#, ,各个/r,变量/n,的/u,系数/n, ,axes/en,[/w,2/m,]/w,./w,set/en,_,xlabel/en,(/w,"/w,coefficient/en, ,number/en,"/w,)/w, ,axes/en,[/w,2/m,]/w,./w,set/en,_,ylabel/en,(/w,"/w,coefficient/en,"/w,)/w, ,fig/en,./w,tight/en,_,layout/en,(/w,)/w, ,return/en, ,fig/en,,/w, ,axesfig/en,,/w, ,ax/en, ,=/w, ,plot/en,_,residuals/en,_,and/en,_,coeff/en,(/w,resid/en,_,train/en,,/w, ,resid/en,_,test/en,,/w, ,model/en,./w,coef/en,_,)/w,;/w, ,#, ,训练/vn,集/vg,的/u,残差/nw,，/w,测试/vn,集/vg,的/u,残差/nw,，/w,各个/r,系数/n,的/u,大小/n,可以/v,看到/v,第一/m,幅/q,图/n,训练/vn,集中/v,的/u,残差/nw,不/d,算/v,大/a,，/w,范围/n,在/p, ,-/w,3/m, ,到/v, ,5/m, ,之间/f,，/w,测试/vn,集/vg,的/u,残差/nw,就/d,过/u,大/a,，/w,范围/n,在/p, ,-/w,150/m, ,到/v, ,250/m, ,之间/f,，/w,可见/v,模型/n,过/u,拟合/nz,了/u,，/w,在/p,训练/vn,集/vg,上/f,还行/v,，/w,测试/vn,集/vg,上/f,就/d,很/d,糟糕/a,。/w,真实/a,变量/n,里/f,只/d,有/v, ,10/m, ,个/q,是/v,有用/a,的/u,，/w,而/c,上面/f,的/u,变量/n,系数/n,图/n,有/v,很多/m,都/d,不/d,是/v, ,0/m,，/w,有/v,很多/m,冗余/n,。/w,变量/n,多/a,，/w,样本/n,少/a,，/w,怎么/r,解决/v,呢/y,？/w,变量/n,比/p,样本/n,多/a,时/ng,，/w,如何/r,处理/v,？/w,一种/mq,方法/n,是/v,做/v,个/q,主/n,成分/n,分析/vn,，/w,降维/nw,，/w,对/p,变量/n,做/v,个/q,筛选/v,，/w,再/d,放/v,到/v,模型/n,里/f,来/v,，/w,但/c,这种/r,方法/n,比较/d,麻烦/an,。/w,还有/v,种/q,是/v,正则化/nw,的/u,方法/n,。/w,正则化/nw,是/v,什么/r,？/w,有/v,哪/r,两种/mq,方法/n,？/w,正则化/nw,在/p,统计学/n,里/f,有/v,两种/mq,思路/n,，/w,一种/mq,叫岭/ns,回归/v,，/w,把/p,系数/n,放/v,到/v, ,loss/en, ,function/en, ,中/f,，/w,经典/n,的/u, ,loss/en, ,function/en, ,是/v,残差/nw,平方和/n,，/w,这里/r,把/p, ,50/m, ,个/q,系数/n,平方/q,求和/vn,，/w,放/v,到/v, ,loss/en, ,function/en, ,中/f,，/w,所以/c,最终/d,既/c,要/v,使/v,残差/nw,平方/q,和/c,小/a,，/w,又/d,要/v,使/v,权/n,重/a,小/a,，/w,可以/v,压制/v,一些/m,过于/d,冗余/n,的/u,权重/nz,。/w,model/en, ,=/w, ,linear/en,_,model/en,./w,ridge/en,(/w,alpha/en,=/w,5/m,)/w, ,#, ,参数/n, ,alpha/en, ,表示/v,对于/p,权重/nz,系数/n,的/u,决定/v,因子/n, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w,ridge/en,(/w,alpha/en,=/w,5/m,,/w, ,copy/en,_,x/en,=/w,true/en,,/w, ,fit/en,_,intercept/en,=/w,true/en,,/w, ,max/en,_,iter/en,=/w,none/en,,/w, ,normalize/en,=/w,false/en,,/w, ,random/en,_,state/en,=/w,none/en,,/w, ,solver/en,=/w,'/w,auto/en,'/w,,/w, ,tol/en,=/w,0.001/m,)/w,resid/en,_,train/en, ,=/w, ,y/en,_,train/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,sse/en,_,train/en, ,=/w, ,sum/en,(/w,resid/en,_,train/en,*/w,*/w,2/m,)/w, ,print/en, ,sse/en,_,train/en,2963.35374445/m,resid/en,_,test/en, ,=/w, ,y/en,_,test/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,sse/en,_,test/en, ,=/w, ,sum/en,(/w,resid/en,_,test/en,*/w,*/w,2/m,)/w, ,print/en, ,sse/en,_,test/en,187177.590437/m,残差/nw,平方/q,和/c,还/d,比较/d,高/a,。/w,model/en,./w,score/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w,,/w, ,model/en,./w,score/en,(/w,x/en,_,test/en,,/w, ,y/en,_,test/en,)/w,(/w,0.99197132152011414/m,,/w, ,0.29213988699168503/m,)/w,之前/f,测试/vn,集/vg,的/u, ,r/en, ,方/q,是/v, ,0.26/m,，/w,这里/r,是/v, ,0.29/m,，/w,略/d,有/v,改善/v,。/w,fig/en,,/w, ,ax/en, ,=/w, ,plot/en,_,residuals/en,_,and/en,_,coeff/en,(/w,resid/en,_,train/en,,/w, ,resid/en,_,test/en,,/w, ,model/en,./w,coef/en,_,)/w,从/p,图/n,上/f,看/v,，/w,training/en, ,的/u,残差/nw,增加/v,了/u,，/w,testing/en, ,的/u,有所/v,减少/v,，/w,系数/n,大小/n,没有/v,太/d,多/a,改善/v,，/w,所以/c,在/p,这里/r,使用岭/ns,回归/v,有/v,一点点/nw,效果/n,，/w,并/c,不/d,明显/a,。/w,下面/f,使用/v,正则化/nw,的/u,另/r,一种/mq,方法/n,，/w,称为/v, ,lasso/en,，/w,思路/n,跟岭/ns,回归/v,是/v,一样/u,的/u,，/w,都/d,是/v,把/p,残差/nw,平方/q,和/c,以及/c,系数/n,放/v,到/v, ,loss/en, ,function/en, ,中/f,，/w,既/c,要/v,使/v,残差/nw,平方/q,和/c,小/a,，/w,又/d,要/v,使/v,系数/n,小/a,，/w,但/c, ,losso/en, ,公式/n,有点/d,不/d,一样/u,，/w,losso/en, ,是/v,把/p,权重/nz,的/u,绝对值/n,加/v,起来/v,，/w,而/c,岭/ng,回归/v,是/v,把/p,权重/nz,的/u,方法/n,加/v,起来/v,，/w,有/v,这么/r,一点/m,不/d,一样/u,，/w,就/d,可以/v,使得/v,很多/m,权/n,重/a,回/v,为/p, ,0/m,。/w,看/v,小/a,效果/n,。/w,model/en, ,=/w, ,linear/en,_,model/en,./w,lasso/en,(/w,alpha/en,=/w,1.0/m,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w,lasso/en,(/w,alpha/en,=/w,1.0/m,,/w, ,copy/en,_,x/en,=/w,true/en,,/w, ,fit/en,_,intercept/en,=/w,true/en,,/w, ,max/en,_,iter/en,=/w,1000/m,,/w, ,normalize/en,=/w,false/en,,/w, ,positive/en,=/w,false/en,,/w, ,precompute/en,=/w,false/en,,/w, ,random/en,_,state/en,=/w,none/en,,/w, ,selection/en,=/w,'/w,cyclic/en,'/w,,/w, ,tol/en,=/w,0.0001/m,,/w, ,warm/en,_,start/en,=/w,false/en,)/w,resid/en,_,train/en, ,=/w, ,y/en,_,train/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,sse/en,_,train/en, ,=/w, ,sse/en,(/w,resid/en,_,train/en,)/w, ,print/en, ,sse/en,_,train/en,256.539066413/m,resid/en,_,test/en, ,=/w, ,y/en,_,test/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,sse/en,_,test/en, ,=/w, ,sse/en,(/w,resid/en,_,test/en,)/w, ,print/en, ,sse/en,_,test/en,691.523154567/m,fig/en,,/w, ,ax/en, ,=/w, ,plot/en,_,residuals/en,_,and/en,_,coeff/en,(/w,resid/en,_,train/en,,/w, ,resid/en,_,test/en,,/w, ,model/en,./w,coef/en,_,)/w,testing/en, ,的/u,残差/nw,有/v,明显/a,的/u,减小/v,，/w,范围/n,减小/v,到/v, ,-/w,10/m, ,到/v, ,15/m, ,之间/f,。/w,很多/m,系数/n,也/d,变为/v, ,0/m,，/w,真正/d,的/u,起/v,作用/n,的/u,只/d,有/v,少数/m,几/m,个/q,。/w,这/r,是/v, ,lasso/en, ,的/u,优点/n,，/w,它/r,可以/v,应付/v,有/v,很多/m,噪音/n,的/u,情况/n,，/w,对于/p,维度/n,比较/d,高/a,噪音/n,比较/d,多/a,的/u,情况/n,，/w,lasso/en, ,可以/v,在/p,建模/vn,的/u,同时/c,做/v,降维/nw,。/w,alphas/en, ,=/w, ,np/en,./w,logspace/en,(/w,-/w,4/m,,/w, ,2/m,,/w, ,100/m,)/w, ,#, ,尝试/vn, ,100/m, ,个/q,不同/a,的/u, ,alphacoeffs/en, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,len/en,(/w,alphas/en,)/w,,/w, ,x/en,_,train/en,./w,shape/en,[/w,1/m,]/w,)/w,)/w, ,sse/en,_,train/en, ,=/w, ,np/en,./w,zeros/en,_,like/en,(/w,alphas/en,)/w, ,sse/en,_,test/en, ,=/w, ,np/en,./w,zeros/en,_,like/en,(/w,alphas/en,)/w, ,for/en, ,n/en,,/w, ,alpha/en, ,in/en, ,enumerate/en,(/w,alphas/en,)/w,:/w, ,model/en, ,=/w, ,linear/en,_,model/en,./w,lasso/en,(/w,alpha/en,=/w,alpha/en,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,coeffs/en,[/w,n/en,,/w, ,:/w,]/w, ,=/w, ,model/en,./w,coef/en,_, ,resid/en, ,=/w, ,y/en,_,train/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,sse/en,_,train/en,[/w,n/en,]/w, ,=/w, ,sum/en,(/w,resid/en,*/w,*/w,2/m,)/w, ,resid/en, ,=/w, ,y/en,_,test/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,sse/en,_,test/en,[/w,n/en,]/w, ,=/w, ,sum/en,(/w,resid/en,*/w,*/w,2/m,)/w,fig/en,,/w, ,axes/en, ,=/w, ,plt/en,./w,subplots/en,(/w,1/m,,/w, ,2/m,,/w, ,figsize/en,=/w,(/w,12/m,,/w, ,4/m,)/w,,/w, ,sharex/en,=/w,true/en,)/w, ,for/en, ,n/en, ,in/en, ,range/en,(/w,coeffs/en,./w,shape/en,[/w,1/m,]/w,)/w,:/w, ,axes/en,[/w,0/m,]/w,./w,plot/en,(/w,np/en,./w,log/en,10/m,(/w,alphas/en,)/w,,/w, ,coeffs/en,[/w,:/w,,/w, ,n/en,]/w,,/w, ,color/en,=/w,'/w,k/en,'/w,,/w, ,lw/en,=/w,0.5/m,)/w, ,axes/en,[/w,1/m,]/w,./w,semilogy/en,(/w,np/en,./w,log/en,10/m,(/w,alphas/en,)/w,,/w, ,sse/en,_,train/en,,/w, ,label/en,=/w,"/w,train/en,"/w,)/w, ,axes/en,[/w,1/m,]/w,./w,semilogy/en,(/w,np/en,./w,log/en,10/m,(/w,alphas/en,)/w,,/w, ,sse/en,_,test/en,,/w, ,label/en,=/w,"/w,test/en,"/w,)/w, ,axes/en,[/w,1/m,]/w,./w,legend/en,(/w,loc/en,=/w,0/m,)/w, ,axes/en,[/w,0/m,]/w,./w,set/en,_,xlabel/en,(/w,r/en,"/w,$/w,{/w,\/w,log/en,_,{/w,10/m,}/w,}/w,\/w,alpha/en,$/w,"/w,,/w, ,fontsize/en,=/w,18/m,)/w, ,axes/en,[/w,0/m,]/w,./w,set/en,_,ylabel/en,(/w,r/en,"/w,coefficients/en,"/w,,/w, ,fontsize/en,=/w,18/m,)/w, ,axes/en,[/w,1/m,]/w,./w,set/en,_,xlabel/en,(/w,r/en,"/w,$/w,{/w,\/w,log/en,_,{/w,10/m,}/w,}/w,\/w,alpha/en,$/w,"/w,,/w, ,fontsize/en,=/w,18/m,)/w, ,axes/en,[/w,1/m,]/w,./w,set/en,_,ylabel/en,(/w,r/en,"/w,sse/en,"/w,,/w, ,fontsize/en,=/w,18/m,)/w, ,fig/en,./w,tight/en,_,layout/en,(/w,)/w,alpha/en, ,为/p, ,0/m, ,时/ng,，/w,表示/v,没有/v,在/p, ,loss/en, ,function/en, ,中放/b,权重/nz,项/q,，/w,即/v,没有/v,惩罚/vn,，/w,这时/r,做/v,回归/v,，/w,跟/p,前面/f,结果/n,是/v,一样/u,的/u,。/w,alpha/en, ,增大/v,，/w,很多/m,噪音/n,的/u,因子/n,就/d,会/v,降/v,为/p, ,0/m,，/w,即/v,对/p,变量/n,做/v,筛选/v,。/w,我们/r,的/u,目标/n,是/v,要/v,使/v,模型/n,的/u,预测/v,效果/n,最佳/z,，/w,自然/d,要/v,选择/v,测试/vn,集/vg,上/f,残差/nw,平方/q,和/c,最/d,小/a,的/u,地方/n,所/u,对应/v,的/u, ,alpha/en,。/w,怎么/r,求/v,这个/r,点/q,，/w,实际/n,用时/n,用/p, ,lassocv/en, ,自动/d,找/v,出/v,最/d,好/a,的/u, ,alpha/en,。/w,model/en, ,=/w, ,linear/en,_,model/en,./w,lassocv/en,(/w,)/w, ,#, ,可以/v,去/v,尝试/vn,不同/a,的/u,参数/n,值/n,model/en,./w,fit/en,(/w,x/en,_,all/en,,/w, ,y/en,_,all/en,)/w,lassocv/en,(/w,alphas/en,=/w,none/en,,/w, ,copy/en,_,x/en,=/w,true/en,,/w, ,cv/en,=/w,none/en,,/w, ,eps/en,=/w,0.001/m,,/w, ,fit/en,_,intercept/en,=/w,true/en,,/w, ,max/en,_,iter/en,=/w,1000/m,,/w, ,n/en,_,alphas/en,=/w,100/m,,/w, ,n/en,_,jobs/en,=/w,1/m,,/w, ,normalize/en,=/w,false/en,,/w, ,positive/en,=/w,false/en,,/w, ,precompute/en,=/w,'/w,auto/en,'/w,,/w, ,random/en,_,state/en,=/w,none/en,,/w, ,selection/en,=/w,'/w,cyclic/en,'/w,,/w, ,tol/en,=/w,0.0001/m,,/w, ,verbose/en,=/w,false/en,)/w,model/en,./w,alpha/en,_, ,#, ,自动/d,找/v,出/v,最/d,好/a,的/u, ,alpha/en,0.06559238747534718/m,resid/en,_,train/en, ,=/w, ,y/en,_,train/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,sse/en,_,train/en, ,=/w, ,sse/en,(/w,resid/en,_,train/en,)/w, ,print/en, ,sse/en,_,train/en,1.76481994041/m,resid/en,_,test/en, ,=/w, ,y/en,_,test/en, ,-/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,sse/en,_,test/en, ,=/w, ,sse/en,(/w,resid/en,_,test/en,)/w, ,print/en, ,sse/en,_,test/en,1.31238073253/m,效果/n,非常/d,不错/a,。/w,model/en,./w,score/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w,,/w, ,model/en,./w,score/en,(/w,x/en,_,test/en,,/w, ,y/en,_,test/en,)/w,(/w,0.9999952185351132/m,,/w, ,0.99999503689532787/m,)/w,fig/en,,/w, ,ax/en, ,=/w, ,plot/en,_,residuals/en,_,and/en,_,coeff/en,(/w,resid/en,_,train/en,,/w, ,resid/en,_,test/en,,/w, ,model/en,./w,coef/en,_,)/w,training/en, ,和/c, ,testing/en, ,的/u,残差/nw,都/d,比较/d,小/a,，/w,无关变量/nw,的/u,系数/n,都/d,被/p,压/v,到/v, ,0/m,。/w,效果/n,非常/d,好/a,。/w,分类/vn,问题/n,分类/vn,问题/n,和/c,回归/v,问题/n,有/v,什么/r,区别/n,？/w,分类/vn,的/u,目标/n,和/c,回归/v,不/d,一样/u,，/w,虽然/c,都/d,是/v,做/v,预测/v,，/w,回归/v,的/u, ,y/en, ,是/v,连续/a,的/u,数值/n,，/w,分类/vn,预测/v,的/u, ,y/en, ,是/v,离散/vn,的/u,数值/n,，/w,比如/v,预测/v,明天/t,会/v,不/d,会/v,下雨/v,，/w,就/d,有/v,会/v,下雨/v,和/c,不/d,会/v,下雨/v,两种/mq,情况/n,，/w,这/r,是/v,二元/b,分类/vn,问题/n,，/w,编码/n,时/ng,可/v,编/v,为/p, ,0/m, ,和/c, ,1/m, ,两种/mq,情况/n,，/w,还有/v,是/v,判断/v,一个/m,图形/n,是/v,什么/r,阿拉伯/ns,数字/n,，/w,可能/v,是/v, ,0/m,,/w,1/m,,/w,./w,./w,./w,,/w,9/m,，/w,有/v, ,10/m, ,个/q,可能/v,的/u,分类/vn,，/w,是/v,多元/b,分类/vn,问题/n,。/w,之前/f,用/p,的/u, ,statsmodels/en, ,的/u, ,logistic/en, ,回归/v,就是/d,分类/vn,模型/n,，/w,这里/r,用/p, ,sklearn/en, ,中/f,更/d,多/a,的/u,分类/vn,模型/n,。/w,sklearn/en, ,内/f,有/v,哪些/r,分类/vn,模型/n,？/w,广义线性/nw,模型岭/ns,回归/v,logistic/en, ,回归/v,贝叶斯/nr,回归/v,支持/v,向/p,量机/nw,最/d,近邻/n,朴素/a,贝叶斯/nr,决策树/nz,iris/en, ,=/w, ,datasets/en,./w,load/en,_,iris/en,(/w,)/w, ,#, ,载入/v,鸢/ng,尾花/n,数据集/nw,print/en, ,iris/en,./w,target/en,_,names/en, ,print/en, ,iris/en,./w,feature/en,_,names/en,[/w,'/w,setosa/en,'/w, ,'/w,versicolor/en,'/w, ,'/w,virginica/en,'/w,]/w, ,[/w,'/w,sepal/en, ,length/en, ,(/w,cm/en,)/w,'/w,,/w, ,'/w,sepal/en, ,width/en, ,(/w,cm/en,)/w,'/w,,/w, ,'/w,petal/en, ,length/en, ,(/w,cm/en,)/w,'/w,,/w, ,'/w,petal/en, ,width/en, ,(/w,cm/en,)/w,'/w,]/w,print/en, ,iris/en,./w,data/en,./w,shape/en, ,print/en, ,iris/en,./w,target/en,./w,shape/en,(/w,150/m,,/w, ,4/m,)/w, ,(/w,150/m,,/w,)/w,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,cross/en,_,validation/en,./w,train/en,_,test/en,_,split/en,(/w,iris/en,./w,data/en,,/w, ,iris/en,./w,target/en,,/w, ,train/en,_,size/en,=/w,0.7/m,)/w, ,#, ,70%/mq, ,用于/v,训练/vn,，/w,30%/mq, ,用于/v,检验/v,classifier/en, ,=/w, ,linear/en,_,model/en,./w,logisticregression/en,(/w,)/w, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w,logisticregression/en,(/w,c/en,=/w,1.0/m,,/w, ,class/en,_,weight/en,=/w,none/en,,/w, ,dual/en,=/w,false/en,,/w, ,fit/en,_,intercept/en,=/w,true/en,,/w, ,intercept/en,_,scaling/en,=/w,1/m,,/w, ,max/en,_,iter/en,=/w,100/m,,/w, ,multi/en,_,class/en,=/w,'/w,ovr/en,'/w,,/w, ,n/en,_,jobs/en,=/w,1/m,,/w, ,penalty/en,=/w,'/w,l/en,2/m,'/w,,/w, ,random/en,_,state/en,=/w,none/en,,/w, ,solver/en,=/w,'/w,liblinear/en,'/w,,/w, ,tol/en,=/w,0.0001/m,,/w, ,verbose/en,=/w,0/m,,/w, ,warm/en,_,start/en,=/w,false/en,)/w,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w,如何/r,评估/vn,分类/vn,效果/n,？/w,confusion/en, ,matrix/en, ,是/v,什么/r,？/w,用/p, ,metrics/en, ,模块/n,来/v,检查/vn,模型/n,效果/n,，/w,其中/r,的/u, ,classification/en,_,report/en, ,是/v,分类/vn,报告/n,，/w,显示/v,各种/r,指标/n,，/w,来/v,衡量/v,模型/n,的/u,效果/n,。/w,print/en,(/w,metrics/en,./w,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,)/w, ,#, ,真实/a,的/u, ,y/en, ,和/c,预测/v,的/u, ,yprecision/en, ,recall/en, ,f/en,1/m,-/w,score/en, ,support/en, ,0/m, ,1.00/m, ,1.00/m, ,1.00/m, ,15/m, ,1/m, ,1.00/m, ,0.75/m, ,0.86/m, ,16/m, ,2/m, ,0.78/m, ,1.00/m, ,0.88/m, ,14/m, ,avg/en, ,//w, ,total/en, ,0.93/m, ,0.91/m, ,0.91/m, ,45/m,precision/en, ,是/v,精准度/n,，/w,recall/en, ,是/v,召回/v,率/v,，/w,fs/en,-/w,score/en, ,是/v, ,f/en,1/m, ,值/n,。/w,从/p,这/r,几/m,个/q,值/n,可以/v,看到/v,模型/n,很/d,完美/a,。/w,还/d,可以/v,用/p,混淆矩阵/nw, ,confusion/en, ,matrix/en, ,来/v,评估/vn,分类器/nw,。/w,混淆矩阵/nw,的/u,每/r,一列/mq,代表/n,了/u,预测/v,类别/n,，/w,每/r,一列/mq,的/u,总数/n,表示/v,预测/v,为/p,该/r,类别/n,的/u,数据/n,的/u,数目/n,；/w,每/r,一行/n,代表/n,了/u,数据/n,的/u,真实/a,归属/vn,类别/n,，/w,每/r,一行/n,的/u,数据/n,总数/n,表示/v,该/r,类别/n,的/u,数据/n,实例/n,的/u,数目/n,。/w,每/r,一列/mq,中/f,的/u,数值/n,表示/v,真实/a,数据/n,被/p,预测/v,为/p,该/r,类/q,的/u,数/m,。/w,如果/c,混淆矩阵/nw,的/u,所有/b,数据/n,都/d,在/p,对角线/n,上/f,，/w,就/d,说明/v,预测/v,是/v,完全/ad,正确/a,的/u,。/w,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,array/en,(/w,[/w,[/w,15/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,12/m,,/w, ,4/m,]/w,,/w, ,[/w, ,0/m,,/w, ,0/m,,/w, ,14/m,]/w,]/w,)/w,y/en,_,test/en,./w,shape/en,(/w,45/m,,/w,)/w,classifier/en, ,=/w, ,tree/en,./w,decisiontreeclassifier/en,(/w,)/w, ,#, ,决策树/nz, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,array/en,(/w,[/w,[/w,12/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,13/m,,/w, ,2/m,]/w,,/w, ,[/w, ,0/m,,/w, ,2/m,,/w, ,16/m,]/w,]/w,)/w,classifier/en, ,=/w, ,neighbors/en,./w,kneighborsclassifier/en,(/w,)/w, ,#, ,k/en, ,近邻/n, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,array/en,(/w,[/w,[/w,12/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,14/m,,/w, ,1/m,]/w,,/w, ,[/w, ,0/m,,/w, ,2/m,,/w, ,16/m,]/w,]/w,)/w,classifier/en, ,=/w, ,svm/en,./w,svc/en,(/w,)/w, ,#, ,支持/v,向量/n,机/ng, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,array/en,(/w,[/w,[/w,12/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,15/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,3/m,,/w, ,15/m,]/w,]/w,)/w,classifier/en, ,=/w, ,ensemble/en,./w,randomforestclassifier/en,(/w,)/w, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,array/en,(/w,[/w,[/w,12/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w, ,0/m,,/w, ,14/m,,/w, ,1/m,]/w,,/w, ,[/w, ,0/m,,/w, ,2/m,,/w, ,16/m,]/w,]/w,)/w,train/en,_,size/en,_,vec/en, ,=/w, ,np/en,./w,linspace/en,(/w,0.1/m,,/w, ,0.9/m,,/w, ,30/m,)/w, ,#, ,尝试/vn,不同/a,的/u,样本/n,大小/n,classifiers/en, ,=/w, ,[/w,tree/en,./w,decisiontreeclassifier/en,,/w, ,neighbors/en,./w,kneighborsclassifier/en,,/w, ,svm/en,./w,svc/en,,/w, ,ensemble/en,./w,randomforestclassifier/en, ,]/w,cm/en,_,diags/en, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,3/m,,/w, ,len/en,(/w,train/en,_,size/en,_,vec/en,)/w,,/w, ,len/en,(/w,classifiers/en,)/w,)/w,,/w, ,dtype/en,=/w,float/en,)/w, ,#, ,用/p,来/v,放/v,结果/n,for/en, ,n/en,,/w, ,train/en,_,size/en, ,in/en, ,enumerate/en,(/w,train/en,_,size/en,_,vec/en,)/w,:/w, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,\/w, ,cross/en,_,validation/en,./w,train/en,_,test/en,_,split/en,(/w,iris/en,./w,data/en,,/w, ,iris/en,./w,target/en,,/w, ,train/en,_,size/en,=/w,train/en,_,size/en,)/w, ,for/en, ,m/en,,/w, ,classifier/en, ,in/en, ,enumerate/en,(/w,classifiers/en,)/w,:/w, ,classifier/en, ,=/w, ,classifier/en,(/w,)/w, ,classifier/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,test/en,_,pred/en, ,=/w, ,classifier/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,cm/en,_,diags/en,[/w,:/w,,/w, ,n/en,,/w, ,m/en,]/w, ,=/w, ,metrics/en,./w,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,test/en,_,pred/en,)/w,./w,diagonal/en,(/w,)/w, ,cm/en,_,diags/en,[/w,:/w,,/w, ,n/en,,/w, ,m/en,]/w, ,//w,=/w, ,np/en,./w,bincount/en,(/w,y/en,_,test/en,)/w,fig/en,,/w, ,axes/en, ,=/w, ,plt/en,./w,subplots/en,(/w,1/m,,/w, ,len/en,(/w,classifiers/en,)/w,,/w, ,figsize/en,=/w,(/w,12/m,,/w, ,3/m,)/w,)/w, ,for/en, ,m/en,,/w, ,classifier/en, ,in/en, ,enumerate/en,(/w,classifiers/en,)/w,:/w, ,axes/en,[/w,m/en,]/w,./w,plot/en,(/w,train/en,_,size/en,_,vec/en,,/w, ,cm/en,_,diags/en,[/w,2/m,,/w, ,:/w,,/w, ,m/en,]/w,,/w, ,label/en,=/w,iris/en,./w,target/en,_,names/en,[/w,2/m,]/w,)/w, ,axes/en,[/w,m/en,]/w,./w,plot/en,(/w,train/en,_,size/en,_,vec/en,,/w, ,cm/en,_,diags/en,[/w,1/m,,/w, ,:/w,,/w, ,m/en,]/w,,/w, ,label/en,=/w,iris/en,./w,target/en,_,names/en,[/w,1/m,]/w,)/w, ,axes/en,[/w,m/en,]/w,./w,plot/en,(/w,train/en,_,size/en,_,vec/en,,/w, ,cm/en,_,diags/en,[/w,0/m,,/w, ,:/w,,/w, ,m/en,]/w,,/w, ,label/en,=/w,iris/en,./w,target/en,_,names/en,[/w,0/m,]/w,)/w, ,axes/en,[/w,m/en,]/w,./w,set/en,_,title/en,(/w,type/en,(/w,classifier/en,(/w,)/w,)/w,./w,_,_,name/en,_,_,)/w, ,axes/en,[/w,m/en,]/w,./w,set/en,_,ylim/en,(/w,0/m,,/w, ,1.1/m,)/w, ,axes/en,[/w,m/en,]/w,./w,set/en,_,xlim/en,(/w,0.1/m,,/w, ,0.9/m,)/w, ,axes/en,[/w,m/en,]/w,./w,set/en,_,ylabel/en,(/w,"/w,classification/en, ,accuracy/en,"/w,)/w, ,axes/en,[/w,m/en,]/w,./w,set/en,_,xlabel/en,(/w,"/w,training/en, ,size/en, ,ratio/en,"/w,)/w, ,axes/en,[/w,m/en,]/w,./w,legend/en,(/w,loc/en,=/w,4/m,)/w, ,fig/en,./w,tight/en,_,layout/en,(/w,)/w,样本/n,大小/n,对/p,预测/v,分类/vn,结果/n,有/v,影响/vn,吗/y,？/w,从/p,上图/n,可/v,看出/v,，/w,当/p,样本/n,太/d,小时/n,，/w,有些/r,模型/n,会/v,表现/v,很/d,差/a,，/w,比如/v,决策/n,树/v,、/w,k/en, ,最/d,近邻/n, ,和/c,svc/en,，/w,knn/en, ,和/c, ,svm/en, ,是/v,比较/d,依赖/v,数据/n,规模/n,的/u,。/w,当/p, ,train/en, ,size/en, ,变/v,大/a,后/f,，/w,分类/vn,准确率/n,就/d,比较/d,高/a,了/u,。/w,聚类/nw,问题/n,聚类/nw,是/v,一种/mq,无/v,监督/vn,学习/v,方法/n,。/w,聚类/nw,问题/n,的/u,应用/vn,场景/n,是/v,什么/r,？/w,主要/b,解决/v,把/p,一群/mq,对象/n,划分/v,为/p,若干/m,个/q,组/q,的/u,问题/n,。/w,例如/v,用户/n,细分/vn,：/w,选择/v,若干/m,指标/n,把/p,用户/n,群聚/nw,为/p,若干/m,个/q,组/q,，/w,组内/nw,特征/n,类似/v,，/w,组件/n,特征/n,差异/n,明显/a,。/w,应用/vn,最/d,广泛/a,的/u,聚类/nw,方法/n,是/v,什么/r,？/w,k/en,-/w,means/en, ,聚类/nw,。/w,x/en,,/w, ,y/en, ,=/w, ,iris/en,./w,data/en,,/w, ,iris/en,./w,target/en, ,np/en,./w,random/en,./w,seed/en,(/w,123/m,)/w, ,n/en,_,clusters/en, ,=/w, ,3/m, ,#, ,可以/v,尝试/vn,其它/r,值/n, ,c/en, ,=/w, ,cluster/en,./w,kmeans/en,(/w,n/en,_,clusters/en,=/w,n/en,_,clusters/en,)/w, ,#, ,实例/n,化/v, ,c/en,.