机器/n,学习/v,之类/r,别/d,不/d,平衡/a,问题/n, ,(/w,1/m,)/w, ,——/w, ,各种/r,评估/vn,指标/n,机器/n,学习/v,之类/r,别/d,不/d,平衡/a,问题/n, ,(/w,2/m,)/w, ,——/w, ,roc/en,和/c,pr/en,曲线/n,机器/n,学习/v,之类/r,别/d,不/d,平衡/a,问题/n, ,(/w,3/m,)/w, ,——/w, ,采样/v,方法/n,前/f,两篇/mq,主要/b,谈/v,类别/n,不/d,平衡/a,问题/n,的/u,评估/vn,方法/n,，/w,重心/n,放/v,在/p,各类/r,评估/vn,指标/n,以及/c,roc/en,和/c,pr/en,曲线/n,上/f,，/w,只有/c,在/p,明确/ad,了/u,这些/r,后/f,，/w,我们/r,才/d,能/v,据此/d,选择/v,具体/a,的/u,处理/v,类别/n,不/d,平衡/a,问题/n,的/u,方法/n,。/w,本篇/r,介绍/v,的/u,采样/v,方法/n,是/v,其中/r,比较/d,常用/a,的/u,方法/n,，/w,其/r,主要/b,目的/n,是/v,通过/p,改变/v,原有/v,的/u,不/d,平衡/a,样本/n,集/vg,，/w,以期/v,获得/v,一个/m,平衡/a,的/u,样本/n,分布/v,，/w,进而/c,学习/v,出/v,合适/a,的/u,模型/n,。/w,采样/v,方法/n,大致/d,可/v,分为/v,过/u,采样/v, ,(/w,oversampling/en,)/w, ,和/c,欠/v,采样/v, ,(/w,undersampling/en,)/w, ,，/w,虽然/c,过/u,采样/v,和/c,降/v,采样/v,主题/n,思想/n,简单/a,，/w,但/c,这些/r,年/q,来/v,研究/vn,出/v,了/u,很多/m,变种/n,，/w,本篇/r,挑/v,一些/m,来/v,具体/a,阐述/v,。/w,见/v,下/f,思维/n,导图/nw,：/w,\/w,(/w,\/w,scriptsize/en,{/w,\/w,spadesuit/en,}/w,\/w,)/w, ,过/u,采样/v,1/m,./w, ,随机/d,过/u,采样/v,随机/d,过/u,采样/v,顾名思义/i,就/d,是/v,从/p,样本/n,少/a,的/u,类别/n,中/f,随机/d,抽样/vn,，/w,再/d,将/d,抽样/vn,得/u,来/v,的/u,样本/n,添加/vn,到/v,数据/n,集中/v,。/w,然而/c,这种/r,方法/n,如今/t,已经/d,不/d,大/a,使用/v,了/u,，/w,因为/c,重复/v,采样/v,往往/d,会/v,导致/v,严重/a,的/u,过/u,拟合/nz,，/w,因而/c,现在/t,的/u,主流/n,过/u,采样/v,方法/n,是/v,通过/p,某种/r,方式/n,人工/n,合成/v,一些/m,少数/m,类/q,样本/n,，/w,从而/c,达到/v,类别/n,平衡/a,的/u,目的/n,，/w,而/c,这/r,其中/r,的/u,鼻祖/n,就/d,是/v,smote/en,。/w,2/m,./w, ,smotesmote/en, ,(/w,synthetic/en, ,minority/en, ,oversampling/en, ,technique/en,)/w, ,的/u,思想/n,概括/v,起来/v,就是/d,在/p,少数/m,类/q,样本/n,之间/f,进行/v,插值/nw,来/v,产生/v,额外/b,的/u,样本/n,。/w,具体/a,地/u,，/w,对于/p,一个/m,少数/m,类/q,样本/n,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,i/en,\/w,)/w,使用/v,k/en,近邻/n,法/j,(/w,k/en,值/n,需要/v,提前/v,指定/v,)/w,，/w,求/v,出/v,离/v,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,i/en,\/w,)/w,距离/n,最近/t,的/u,k/en,个/q,少数/m,类/q,样本/n,，/w,其中/r,距离/n,定义/n,为/p,样本/n,之间/f,n/en,维/q,特征/n,空间/n,的/u,欧氏/nr,距离/n,。/w,然后/c,从/p,k/en,个/q,近/a,邻点/nw,中/f,随机/d,选取/v,一个/m,，/w,使用/v,下列/b,公式/n,生成/vn,新/a,样本/n,：/w,\/w,[/w, ,\/w,mathbf/en,{/w,x/en,}/w,_,{/w,new/en,}/w,=/w,\/w,mathbf/en,{/w,x/en,}/w,_,{/w,i/en,}/w,+/w,(/w,\/w,mathbf/en,{/w,\/w,hat/en,{/w,x/en,}/w,}/w,_,{/w,i/en,}/w,-/w,\/w,mathbf/en,{/w,x/en,}/w,_,{/w,i/en,}/w,)/w, ,\/w,times/en, ,\/w,delta/en, ,\/w,tag/en,{/w,1.1/m,}/w, ,\/w,]/w,其中/r,\/w,(/w,\/w,mathbf/en,{/w,\/w,hat/en,{/w,x/en,}/w,}/w,\/w,)/w,为/p,选出/v,的/u,k/en,近邻/n,点/q,，/w,\/w,(/w,\/w,delta/en,\/w,in/en,[/w,0/m,,/w,1/m,]/w,\/w,)/w,是/v,一个/m,随机/d,数/m,。/w,下/f,图/n,就/d,是/v,一个/m,smote/en,生成/vn,样本/n,的/u,例子/n,，/w,使用/v,的/u,是/v,3/m,-/w,近邻/n,，/w,可以/v,看出/v,smote/en,生成/vn,的/u,样本/n,一般/a,就/d,在/p,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,{/w,i/en,}/w,\/w,)/w,和/c,\/w,(/w,\/w,mathbf/en,{/w,\/w,hat/en,{/w,x/en,}/w,}/w,_,{/w,i/en,}/w,\/w,)/w,相连/v,的/u,直线/n,上/f,：/w,smote/en,会/v,随机/d,选取/v,少数/m,类/q,样本/n,用以/d,合成/v,新/a,样本/n,，/w,而/c,不/d,考虑/v,周边/n,样本/n,的/u,情况/n,，/w,这样/r,容易/a,带来/v,两个/m,问题/n,：/w,如果/c,选取/v,的/u,少数/m,类/q,样本/n,周围/f,也/d,都/d,是/v,少数/m,类/q,样本/n,，/w,则/d,新/a,合成/v,的/u,样本/n,不/d,会/v,提供/v,太/d,多/a,有用/a,信息/n,。/w,这/r,就/d,像/v,支持/v,向/p,量机/nw,中/f,远离/v,margin/en,的/u,点/q,对/p,决策/n,边界/n,影响/vn,不/d,大/a,。/w,如果/c,选取/v,的/u,少数/m,类/q,样本/n,周围/f,都/d,是/v,多数/m,类/q,样本/n,，/w,这/r,类/q,的/u,样本/n,可能/v,是/v,噪音/n,，/w,则/d,新/a,合成/v,的/u,样本/n,会/v,与/p,周围/f,的/u,多数/m,类/q,样本/n,产生/v,大部分/m,重叠/v,，/w,致使/v,分类/vn,困难/an,。/w,总的来说/c,我们/r,希望/v,新/a,合成/v,的/u,少数/m,类/q,样本/n,能/v,处于/v,两个/m,类别/n,的/u,边界/n,附近/f,，/w,这样/r,往往/d,能/v,提供/v,足够/v,的/u,信息/n,用以/d,分类/vn,。/w,而/c,这/r,就/d,是/v,下面/f,的/u, ,border/en,-/w,line/en, ,smote/en, ,算法/n,要/v,做/v,的/u,事情/n,。/w,3/m,./w, ,border/en,-/w,line/en, ,smote/en,这个/r,算/v,法会/n,先/d,将/d,所有/b,的/u,少数/m,类/q,样本/n,分成/v,三类/b,，/w,如/v,下/f,图/n,所/u,示/vg,：/w,"/w,noise/en,"/w, ,：/w, ,所有/b,的/u,k/en,近/a,邻/vg,个/q,样本/n,都/d,属于/v,多数/m,类/q,"/w,danger/en,"/w, ,：/w, ,超过/v,一半/m,的/u,k/en,近邻/n,样本/n,属于/v,多数/m,类/q,"/w,safe/en,"/w,：/w, ,超过/v,一半/m,的/u,k/en,近邻/n,样本/n,属于/v,少数/m,类/q,border/en,-/w,line/en, ,smote/en,算法/n,只/d,会/v,从/p,处于/v,”/w,danger/en,“/w,状态/n,的/u,样本/n,中/f,随机/d,选择/v,，/w,然后/c,用/p,smote/en,算法/n,产生/v,新/a,的/u,样本/n,。/w,处于/v,”/w,danger/en,“/w,状态/n,的/u,样本/n,代表/n,靠近/v,”/w,边界/n,“/w,附近/f,的/u,少数/m,类/q,样本/n,，/w,而/c,处于/v,边界/n,附近/f,的/u,样本/n,往往/d,更/d,容易/a,被/p,误/v,分类/vn,。/w,因而/c, ,border/en,-/w,line/en, ,smote/en, ,只/d,对/p,那些/r,靠近/v,”/w,边界/n,“/w,的/u,少数/m,类/q,样本/n,进行/v,人工/n,合成/v,样本/n,，/w,而/c, ,smote/en, ,则/d,对/p,所有/b,少数/m,类/q,样本/n,一视同仁/i,。/w,border/en,-/w,line/en, ,smote/en, ,分为/v,两种/mq,:/w, ,borderline/en,-/w,1/m, ,smote/en, ,和/c, ,borderline/en,-/w,2/m, ,smote/en,。/w, ,borderline/en,-/w,1/m, ,smote/en, ,在/p,合成/v,样本/n,时/ng,\/w,(/w,(/w,1.1/m,)/w,\/w,)/w,式/k,中/f,的/u,\/w,(/w,\/w,mathbf/en,{/w,\/w,hat/en,{/w,x/en,}/w,}/w,\/w,)/w,是/v,一个/m,少数/m,类/q,样本/n,，/w,而/c, ,borderline/en,-/w,2/m, ,smote/en, ,中/f,的/u,\/w,(/w,\/w,mathbf/en,{/w,\/w,hat/en,{/w,x/en,}/w,}/w,\/w,)/w,则/d,是/v,k/en,近邻/n,中/f,的/u,任意/d,一个/m,样本/n,。/w,4/m,./w, ,adasynadasyn/en,名/q,为/p,自/p,适应/v,合成/v,抽样/vn,(/w,adaptive/en, ,synthetic/en, ,sampling/en,)/w,，/w,其/r,最/d,大/a,的/u,特点/n,是/v,采用/v,某种/r,机制/n,自动/d,决定/v,每个/r,少数/m,类/q,样本/n,需要/v,产生/v,多少/r,合成/v,样本/n,，/w,而/c,不/d,是/v,像/v,smote/en,那样/r,对/p,每个/r,少数/m,类/q,样本/n,合成/v,同/p,数量/n,的/u,样本/n,。/w,具体/a,流程/n,如下/v,：/w,首先/d,计算/v,需要/v,合成/v,的/u,样本/n,总量/n,：/w,\/w,[/w, ,g/en, ,=/w, ,(/w,s/en,_,{/w,maj/en,}/w, ,-/w, ,s/en,_,{/w,min/en,}/w,)/w, ,\/w,times/en, ,\/w,beta/en, ,\/w,]/w,其中/r,\/w,(/w,s/en,_,{/w,maj/en,}/w,\/w,)/w,为/p,多数/m,类/q,样本数/n,量/n,，/w,\/w,(/w,s/en,_,{/w,min/en,}/w,\/w,)/w,为/p,少数/m,类/q,样本数/n,量/n,，/w,\/w,(/w,\/w,beta/en, ,\/w,in/en, ,[/w,0/m,,/w,1/m,]/w,\/w,)/w,为/p,系数/n,。/w,g/en,即/v,为/p,总共/d,想/v,要/v,合成/v,的/u,少数/m,类/q,样本数/n,量/n,，/w,如果/c,\/w,(/w,\/w,beta/en,=/w,1/m,\/w,)/w,则/d,是/v,合成/v,后/f,各/r,类别/n,数目/n,相等/v,。/w,对于/p,每个/r,少/a,类别/n,样本/n,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,i/en,\/w,)/w,，/w,找/v,出/v,其/r,k/en,近/a,邻/vg,个/q,点/q,，/w,并/c,计算/v,：/w,\/w,[/w, ,\/w,gamma/en,_,i/en, ,=/w, ,\/w,frac/en,{/w,\/w,delta/en,_,i/en,\/w,,/w,//w,\/w,,/w,k/en,}/w,{/w,z/en,}/w, ,\/w,]/w,其中/r,\/w,(/w,\/w,delta/en,_,i/en,\/w,)/w,为/p,k/en,近/a,邻/vg,个/q,点/q,中/f,多数/m,类/q,样本/n,的/u,数量/n,，/w,z/en,为/p,规范化/vn,因子/n,以/p,确保/v, ,\/w,(/w,\/w,gamma/en,\/w,)/w, ,构成/v,一个/m,分布/v,。/w,这样/r,若/c,一个/m,少数/m,类/q,样本/n,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,i/en,\/w,)/w,的/u,周围/f,多数/m,类/q,样本/n,越/d,多/a,，/w,则/d,其/r, ,\/w,(/w,\/w,gamma/en,_,i/en,\/w,)/w, ,也/d,就/d,越/d,高/a,。/w,最后/f,对/p,每个/r,少/a,类别/n,样本/n,\/w,(/w,\/w,mathbf/en,{/w,x/en,}/w,_,i/en,\/w,)/w,计算/v,需要/v,合成/v,的/u,样本/n,数量/n,\/w,(/w,g/en,_,i/en,\/w,)/w,，/w,再/d,用/p,smote/en,算法/n,合成/v,新/a,样本/n,：/w,\/w,[/w, ,g/en,_,i/en, ,=/w, ,\/w,gamma/en,_,i/en, ,\/w,times/en, ,g/en, ,\/w,]/w,可以/v,看到/v,adasyn/en,利用/v,分布/v,\/w,(/w,\/w,gamma/en,\/w,)/w,来/v,自动/d,决定/v,每个/r,少数/m,类/q,样本/n,所/u,需要/v,合成/v,的/u,样本/n,数量/n,，/w,这/r,等于/v,是/v,给/p,每个/r,少数/m,类/q,样本/n,施加/v,了/u,一个/m,权重/nz,，/w,周围/f,的/u,多数/m,类/q,样本/n,越/d,多/a,则/d,权/n,重/a,越/d,高/a,。/w,adasyn/en,的/u,缺点/n,是/v,易/a,受/v,离/v,群点/nw,的/u,影响/vn,，/w,如果/c,一个/m,少数/m,类/q,样本/n,的/u,k/en,近邻/n,都/d,是/v,多数/m,类/q,样本/n,，/w,则/d,其/r,权/n,重/a,会/v,变/v,得/u,相当/d,大/a,，/w,进而/c,会/v,在/p,其/r,周围/f,生成/vn,较/d,多/a,的/u,样本/n,。/w,下面/f,利用/v,sklearn/en,中/f,的/u, ,make/en,_,classification/en, ,构造/v,了/u,一个/m,不/d,平衡/a,数据集/nw,，/w,各/r,类别/n,比例/n,为/p,{/w,0/m,:/w,54/m,,/w, ,1/m,:/w,946/m,}/w,。/w,原始/a,数据/n,，/w,smote/en,，/w,borderline/en,-/w,1/m, ,smote/en,，/w,borderline/en,-/w,2/m, ,smote/en,和/c,adasyn/en,的/u,比较/d,见/v,下/f,图/n,，/w,左侧/f,为/p,过/u,采样/v,后/f,的/u,决策/n,边界/n,，/w,右侧/f,为/p,过/u,采样/v,后/f,的/u,样本/n,分布/v,情况/n,，/w,可以/v,看到/v,过/u,采样/v,后/f,原来/d,少数/m,类/q,的/u,决策/n,边界/n,都/d,扩大/v,了/u,，/w,导致/v,更/d,多/a,的/u,多数/m,类/q,样本/n,被/p,划/v,为/p,少数/m,类/q,了/u,：/w,从/p,上图/n,我们/r,也/d,可以/v,比较/d,几/m,种/q,过/u,采样/v,方法/n,各自/r,的/u,特点/n,。/w,用/p, ,smote/en, ,合成/v,的/u,样本/n,分布/v,比较/d,平均/a,，/w,而/c,border/en,-/w,line/en, ,smote/en,合成/v,的/u,样本/n,则/d,集中/v,在/p,类别/n,边界处/nw,。/w,adasyn/en,的/u,特性/n,是/v,一个/m,少数/m,类/q,样本/n,周围/f,多数/m,类/q,样本/n,越/d,多/a,，/w,则/d,算/v,法会/n,为/p,其/r,生成/vn,越/d,多/a,的/u,样本/n,，/w,从/p,图/n,中/f,也/d,可以/v,看到/v,生成/vn,的/u,样本/n,大都/d,来自/v,于/p,原来/d,与/p,多数/m,类/q,比较/d,靠近/v,的/u,那些/r,少数/m,类/q,样本/n,。/w,\/w,(/w,\/w,scriptsize/en,{/w,\/w,blacklozenge/en,}/w,\/w,)/w, ,欠/v,采样/v,1/m,./w, ,随机/d,欠/v,采样/v,随机/d,欠/v,采样/v,的/u,思想/n,同样/d,比较/d,简单/a,，/w,就是/d,从/p,多数/m,类/q,样本/n,中/f,随机/d,选取/v,一些/m,剔除/v,掉/v,。/w,这种/r,方法/n,的/u,缺点/n,是/v,被/p,剔除/v,的/u,样本/n,可能/v,包含/v,着/u,一些/m,重要/a,信息/n,，/w,致使/v,学习/v,出来/v,的/u,模型/n,效果/n,不好/a,。/w,2/m,./w, ,easyensemble/en, ,和/c, ,balancecascadeeasyensemble/en,和/c,balancecascade/en,采用/v,集成/vn,学习/v,机制/n,来/v,处理/v,传统/n,随机/d,欠/v,采样/v,中/f,的/u,信息/n,丢失/v,问题/n,。/w,easyensemble/en,将/d,多数/m,类/q,样本/n,随机/d,划分/v,成/v,n/en,个子/n,集/vg,，/w,每个/r,子集/n,的/u,数量/n,等于/v,少数/m,类/q,样本/n,的/u,数量/n,，/w,这/r,相当/d,于/p,欠/v,采样/v,。/w,接着/c,将/d,每个/r,子集/n,与/p,少数/m,类/q,样本/n,结合/v,起来/v,分别/d,训练/vn,一个/m,模型/n,，/w,最后/f,将/d,n/en,个/q,模型/n,集成/vn,，/w,这样/r,虽然/c,每个/r,子集/n,的/u,样本/n,少于/v,总体/n,样本/n,，/w,但/c,集成/vn,后/f,总/b,信息量/n,并/c,不/d,减少/v,。/w,如果/c,说/v,easyensemble/en,是/v,基于/p,无/v,监督/vn,的/u,方式/n,从/p,多数/m,类/q,样本/n,中/f,生成子集/nw,进行/v,欠/v,采样/v,，/w,那么/r,balancecascade/en,则/d,是/v,采用/v,了/u,有/v,监督/vn,结合/v,boosting/en,的/u,方式/n,。/w,在/p,第/m,n/en,轮/q,训练/vn,中/f,，/w,将/d,从/p,多数/m,类/q,样本/n,中/f,抽样/vn,得/u,来/v,的/u,子集/n,与/p,少数/m,类/q,样本/n,结合/v,起来/v,训练/vn,一个/m,基学习器/nw,h/en,，/w,训练/vn,完/v,后/f,多数/m,类/q,中/f,能/v,被/p,h/en,正确/a,分类/vn,的/u,样本/n,会/v,被/p,剔除/v,。/w,在/p,接/v,下来/v,的/u,第/m,n/en,+/w,1轮/mq,中/f,，/w,从/p,被/p,剔除/v,后/f,的/u,多数/m,类/q,样本/n,中/f,产生/v,子集/n,用于/v,与/p,少数/m,类/q,样本/n,结合/v,起来/v,训练/vn,，/w,最后/f,将/d,不同/a,的/u,基学习器/nw,集成/vn,起来/v,。/w,balancecascade/en,的/u,有/v,监督/vn,表现/v,在/p,每/r,一轮/mq,的/u,基学习器/nw,起/v,到/v,了/u,在/p,多数/m,类/q,中/f,选择/v,样本/n,的/u,作用/n,，/w,而其/c,boosting/en,特点/n,则/d,体现/v,在/p,每/r,一轮/mq,丢弃/v,被/p,正确/a,分类/vn,的/u,样本/n,，/w,进而/c,后续基/nw,学习器/nw,会/v,更/d,注重/v,那些/r,之前/f,分类/vn,错误/n,的/u,样本/n,。/w,3/m,./w, ,nearmissnearmiss/en,本质/n,上/f,是/v,一种/mq,原型/n,选择/v,(/w,prototype/en, ,selection/en,)/w,方法/n,，/w,即/v,从/p,多数/m,类/q,样本/n,中/f,选取/v,最/d,具/vg,代表性/n,的/u,样本/n,用于/v,训练/vn,，/w,主要/b,是/v,为了/p,缓解/v,随机/d,欠/v,采样/v,中/f,的/u,信息/n,丢失/v,问题/n,。/w,nearmiss/en,采用/v,一些/m,启发式/nw,的/u,规则/n,来/v,选择/v,样本/n,，/w,根据/p,规则/n,的/u,不同/a,可/v,分为/v,3类/mq,：/w,nearmiss/en,-/w,1/m,：/w,选择/v,到/v,最近/t,的/u,k/en,个/q,少数/m,类/q,样本/n,平均/a,距离/n,最近/t,的/u,多数/m,类/q,样本/n,nearmiss/en,-/w,2/m,：/w,选择/v,到/v,最/d,远/a,的/u,k/en,个/q,少数/m,类/q,样本/n,平均/a,距离/n,最近/t,的/u,多数/m,类/q,样本/n,nearmiss/en,-/w,3/m,：/w,对于/p,每个/r,少数/m,类/q,样本/n,选择/v,k/en,个/q,最近/t,的/u,多数/m,类/q,样本/n,，/w,目的/n,是/v,保证/v,每个/r,少数/m,类/q,样本/n,都/d,被/p,多数/m,类/q,样本/n,包围/v,nearmiss/en,-/w,1/m,和/c,nearmiss/en,-/w,2/m,的/u,计算/v,开销/v,很/d,大/a,，/w,因为/c,需要/v,计算/v,每个/r,多/a,类别/n,样本/n,的/u,k/en,近邻/n,点/q,。/w,另外/c,，/w,nearmiss/en,-/w,1/m,易/a,受/v,离/v,群点/nw,的/u,影响/vn,，/w,如/v,下面/f,第二/m,幅/q,图/n,中/f,合理/a,的/u,情况/n,是/v,处于/v,边界/n,附近/f,的/u,多数/m,类/q,样本/n,会/v,被/p,选中/v,，/w,然而/c,由于/c,右下方/nw,一些/m,少数/m,类/q,离/v,群点/nw,的/u,存在/v,，/w,其/r,附近/f,的/u,多数/m,类/q,样本/n,就/d,被/p,选择/v,了/u,。/w,相比之下/l,nearmiss/en,-/w,2/m,和/c,nearmiss/en,-/w,3/m,不易/a,产生/v,这/r,方面/n,的/u,问题/n,。/w,4/m,./w, ,数据/n,清洗/vn,方法/n, ,(/w,data/en, ,cleaning/en, ,tichniques/en,)/w,这/r,类/q,方法/n,主要/b,通过/p,某种/r,规则/n,来/v,清洗/vn,重叠/v,的/u,数据/n,，/w,从而/c,达到/v,欠/v,采样/v,的/u,目的/n,，/w,而/c,这些/r,规则/n,往往/d,也/d,是/v,启发性/n,的/u,，/w,下面/f,进行/v,简要/ad,阐述/v,：/w,tomek/en, ,link/en,：/w,tomek/en, ,link/en,表示/v,不同/a,类别/n,之间/f,距离/n,最近/t,的/u,一对/mq,样本/n,，/w,即/v,这/r,两个/m,样本/n,互为/d,最近/t,邻且/nw,分属/v,不同/a,类别/n,。/w,这样/r,如果/c,两个/m,样本/n,形成/v,了/u,一个/m,tomek/en, ,link/en,，/w,则/d,要么/c,其中/r,一个/m,是/v,噪音/n,，/w,要么/c,两个/m,样本/n,都/d,在/p,边界/n,附近/f,。/w,这样/r,通过/p,移/v,除/p,tomek/en, ,link/en,就/d,能/v,“/w,清洗/vn,掉/v,”/w,类/q,间/f,重叠/v,样本/n,，/w,使得/v,互为/d,最/d,近邻/n,的/u,样本/n,皆/d,属于/v,同一/b,类别/n,，/w,从而/c,能/v,更/d,好/a,地/u,进行/v,分类/vn,。/w,下/f,图/n,左/f,上/f,为/p,原始/a,数据/n,，/w,右上/f,为/p,smote/en,后/f,的/u,数据/n,，/w,左下/nz,虚线/n,标识/n,出/v,tomek/en, ,link/en,，/w,右下/f,为/p,移/v,除/p,tomek/en, ,link/en,后/f,的/u,数据集/nw,，/w,可以/v,看到/v,不同/a,类别/n,之间/f,样本/n,重叠/v,减少/v,了/u,很多/m,。/w,edited/en, ,nearest/en, ,neighbours/en,(/w,enn/en,)/w,：/w,对于/p,属于/v,多数/m,类/q,的/u,一个/m,样本/n,，/w,如果/c,其/r,k/en,个/q,近邻/n,点/q,有/v,超过/v,一半/m,都/d,不/d,属于/v,多数/m,类/q,，/w,则/d,这个/r,样本/n,会/v,被/p,剔除/v,。/w,这个/r,方法/n,的/u,另/r,一个/m,变种/n,是/v,所有/b,的/u,k/en,个/q,近/a,邻点/nw,都/d,不/d,属于/v,多数/m,类/q,，/w,则/d,这个/r,样本/n,会/v,被/p,剔除/v,。/w,最后/f,，/w,数据/n,清洗/vn,技术/n,最/d,大/a,的/u,缺点/n,是/v,无法/v,控制/v,欠/v,采样/v,的/u,数量/n,。/w,由于/c,都/d,在/p,某种/r,程度/n,上/f,采用/v,了/u,k/en,近邻/n,法/j,，/w,而/c,事实上/l,大部分/m,多数/m,类/q,样本/n,周围/f,也/d,都/d,是/v,多数/m,类/q,，/w,因而/c,能/v,剔除/v,的/u,多数/m,类/q,样本/n,比较/d,有限/a,。/w,\/w,(/w,\/w,scriptsize/en,{/w,\/w,clubsuit/en,}/w,\/w,)/w, ,过/u,采样/v,和/c,欠/v,采样/v,结合/v,上/f,文/ng,中/f,提到/v,smote/en,算法/n,的/u,缺点/n,是/v,生成/vn,的/u,少数/m,类/q,样本/n,容易/a,与/p,周围/f,的/u,多数/m,类/q,样本/n,产生/v,重叠/v,难以/d,分类/vn,，/w,而/c,数据/n,清洗/vn,技术/n,恰好/d,可以/v,处理/v,掉/v,重叠/v,样本/n,，/w,所以/c,可以/v,将/d,二者/r,结合/v,起来/v,形成/v,一个/m,pipeline/en,，/w,先/d,过/u,采样/v,再/d,进行/v,数据/n,清洗/vn,。/w,主要/b,的/u,方法/n,是/v, ,smote/en, ,+/w, ,enn/en, ,和/c, ,smote/en, ,+/w, ,tomek/en, ,，/w,其中/r, ,smote/en, ,+/w, ,enn/en, ,通常/d,能/v,清除/v,更/d,多/a,的/u,重叠/v,样本/n,，/w,如/v,下/f,图/n,：/w,综上/nz,，/w,本文/r,简要/ad,介绍/v,了/u,几/m,种/q,过/u,采样/v,和/c,欠/v,采样/v,的/u,方法/n,，/w,其实/d,还有/v,更/d,多/a,的/u,变种/n,，/w,可/v,参阅/v,imbalanced/en,-/w,learn/en,最后/f,列出/v,的/u,的/u,references/en,。/w,\/w,(/w,\/w,scriptsize/en,{/w,\/w,bigstar/en,}/w,\/w,)/w, ,采样/v,方法/n,的/u,效果/n,最后/f,当然/d,还有/v,一个/m,最/d,重要/a,的/u,问题/n,，/w,本文/r,列举/v,了/u,多种/m,不同/a,的/u,采样/v,方法/n,，/w,那么/r,哪/r,种/q,方法/n,效果/n,好/a,呢/y,？/w, ,下面/f,用/p,两个/m,数据集/nw,对/p,各类/r,方法/n,进行/v,比较/d,，/w,同样/d,结论/n,也/d,是/v,基于/p,这/r,两个/m,数据集/nw,。/w,本文/r,代码/n,主要/b,使用/v,了/u,imbalanced/en,-/w,learn/en,这个/r,库/n,，/w,算是/v,scikit/en,-/w,learn/en,的/u,姐妹/n,项目/n,。/w,第一/m,个/q,数据集/nw,为/p, ,us/en,_,crime/en,，/w,多数/m,类/q,样本/n,和/c,少数/m,类/q,样本/n,的/u,比例/n,为/p,12/m,:/w,1/m,。/w,us/en,_,crime/en, ,=/w, ,fetch/en,_,datasets/en,(/w,)/w,[/w,'/w,us/en,_,crime/en,'/w,]/w, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,us/en,_,crime/en,./w,data/en,,/w, ,us/en,_,crime/en,./w,target/en,,/w, ,test/en,_,size/en,=/w,0.5/m,,/w, ,random/en,_,state/en,=/w,42/m,,/w, ,stratify/en,=/w,us/en,_,crime/en,./w,target/en,)/w, ,#, ,分为/v,训练集/nw,和/c,测试/vn,集/vg,总共/d,用/p,9个/m,模型/n,，/w,1个/m, ,base/en,_,model/en, ,(/w,即/v,不/d,进行/v,采样/v,的/u,模型/n,)/w, ,加上/v,8个/m,过/u,采样/v,和/c,欠/v,采样/v,方法/n,。/w,imbalanced/en,-/w,learn/en, ,中/f,大部分/m,采样/v,方法/n,都/d,可以/v,使用/v, ,make/en,_,pipeline/en, ,将/d,采样/v,方法/n,和/c,分类/vn,模型/n,连接/v,起来/v,，/w,但/c,两种/mq,集成/vn,方法/n,，/w,easyensemble/en,和/c, ,balancecascade/en, ,无法/v,使用/v, ,make/en,_,pipeline/en, ,(/w,因为/c,本质/n,上/f,是/v,集成/vn,了/u,好几/m,个/q,分类/vn,模型/n,)/w,，/w,所以/c,需要/v,自/p,定义/n,方法/n,。/w,sampling/en,_,methods/en, ,=/w, ,[/w,original/en,(/w,)/w,,/w, ,smote/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,smote/en,(/w,random/en,_,state/en,=/w,42/m,,/w, ,kind/en,=/w,'/w,borderline/en,1/m,'/w,)/w,,/w, ,adasyn/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,easyensemble/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,balancecascade/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,nearmiss/en,(/w,version/en,=/w,3/m,,/w, ,random/en,_,state/en,=/w,42/m,)/w,,/w, ,smoteenn/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,smotetomek/en,(/w,random/en,_,state/en,=/w,42/m,)/w,]/w, ,names/en, ,=/w, ,[/w,'/w,base/en, ,model/en,'/w,,/w, ,'/w,smote/en,'/w,,/w, ,'/w,borderline/en, ,smote/en,'/w,,/w, ,'/w,adasyn/en,'/w,,/w, ,'/w,easyensemble/en,'/w,,/w, ,'/w,balancecascade/en,'/w,,/w, ,'/w,nearmiss/en,'/w,,/w, ,'/w,smote/en,+/w,enn/en,'/w,,/w, ,'/w,smote/en,+/w,tomek/en,'/w,]/w, ,def/en, ,ensemble/en,_,method/en,(/w,method/en,)/w,:/w, ,#, ,easyensemble/en,和/c,balancecascade/en,的/u,方法/n, ,count/en, ,=/w, ,0/m, ,xx/en,,/w, ,yy/en, ,=/w, ,method/en,./w,fit/en,_,sample/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w,,/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w, ,for/en, ,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en, ,in/en, ,zip/en,(/w,xx/en,,/w, ,yy/en,)/w,:/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en,)/w, ,y/en,_,pred/en, ,+/w,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,y/en,_,prob/en, ,+/w,=/w, ,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,count/en, ,+/w,=/w, ,1/m, ,return/en, ,np/en,./w,where/en,(/w,y/en,_,pred/en, ,>,=/w, ,0/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w,,/w, ,y/en,_,prob/en,//w,count/en, ,#, ,画/v,roc/en,曲线/n, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,15/m,,/w,8/m,)/w,)/w, ,for/en, ,(/w,name/en,,/w, ,method/en,)/w, ,in/en, ,zip/en,(/w,names/en,,/w, ,sampling/en,_,methods/en,)/w,:/w, ,t/en,0/m, ,=/w, ,time/en,./w,time/en,(/w,)/w, ,if/en, ,name/en, ,=/w,=/w, ,'/w,easyensemble/en,'/w, ,or/en, ,name/en, ,=/w,=/w, ,'/w,balancecascade/en,'/w,:/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,ensemble/en,_,method/en,(/w,method/en,)/w, ,else/en,:/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,method/en,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,y/en,_,prob/en, ,=/w, ,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,fpr/en,,/w, ,tpr/en,,/w, ,thresholds/en, ,=/w, ,roc/en,_,curve/en,(/w,y/en,_,test/en,,/w, ,y/en,_,prob/en,,/w, ,pos/en,_,label/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,fpr/en,,/w, ,tpr/en,,/w, ,lw/en,=/w,3/m,,/w, ,label/en,=/w,'/w,{/w,}/w, ,(/w,auc/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,,/w, ,time/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,s/en,)/w,'/w,./w, ,format/en,(/w,name/en,,/w, ,auc/en,(/w,fpr/en,,/w, ,tpr/en,)/w,,/w, ,time/en,./w,time/en,(/w,)/w, ,-/w, ,t/en,0/m,)/w,)/w, ,plt/en,./w,xlabel/en,(/w,"/w,fpr/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,ylabel/en,(/w,"/w,tpr/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,legend/en,(/w,fontsize/en,=/w,14/m,)/w,#, ,画/v,pr/en,曲线/n, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,15/m,,/w,8/m,)/w,)/w, ,for/en, ,(/w,name/en,,/w, ,method/en,)/w, ,in/en, ,zip/en,(/w,names/en,,/w, ,sampling/en,_,methods/en,)/w,:/w, ,t/en,0/m, ,=/w, ,time/en,./w,time/en,(/w,)/w, ,if/en, ,name/en, ,=/w,=/w, ,'/w,easyensemble/en,'/w, ,or/en, ,name/en, ,=/w,=/w, ,'/w,balancecascade/en,'/w,:/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,ensemble/en,_,method/en,(/w,method/en,)/w, ,else/en,:/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,method/en,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,y/en,_,prob/en, ,=/w, ,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,precision/en,,/w, ,recall/en,,/w, ,thresholds/en, ,=/w, ,precision/en,_,recall/en,_,curve/en,(/w,y/en,_,test/en,,/w, ,y/en,_,prob/en,,/w, ,pos/en,_,label/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,recall/en,,/w, ,precision/en,,/w, ,lw/en,=/w,3/m,,/w, ,label/en,=/w,'/w,{/w,}/w, ,(/w,auc/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,,/w, ,time/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,s/en,)/w,'/w,./w, ,format/en,(/w,name/en,,/w, ,auc/en,(/w,recall/en,,/w, ,precision/en,)/w,,/w, ,time/en,./w,time/en,(/w,)/w, ,-/w, ,t/en,0/m,)/w,)/w, ,plt/en,./w,xlabel/en,(/w,"/w,recall/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,ylabel/en,(/w,"/w,precision/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,legend/en,(/w,fontsize/en,=/w,14/m,,/w, ,loc/en,=/w,"/w,upper/en, ,right/en,"/w,)/w,第二/m,个/q,数据集/nw,是/v, ,abalone/en,，/w,多数/m,类/q,样本/n,和/c,少数/m,类/q,样本/n,的/u,比例/n,为/p,130/m,:/w,1/m,，/w,非常/d,悬殊/a,。/w,abalone/en,_,19/m, ,=/w, ,fetch/en,_,datasets/en,(/w,)/w,[/w,'/w,abalone/en,_,19/m,'/w,]/w, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,abalone/en,_,19/m,./w,data/en,,/w, ,abalone/en,_,19/m,./w,target/en,,/w, ,test/en,_,size/en,=/w,0.5/m,,/w, ,random/en,_,state/en,=/w,42/m,,/w, ,stratify/en,=/w,abalone/en,_,19/m,./w,target/en,)/w, ,#, ,画/v,roc/en,曲线/n,和/c,pr/en,曲线/n, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,15/m,,/w,8/m,)/w,)/w, ,for/en, ,(/w,name/en,,/w, ,method/en,)/w, ,in/en, ,zip/en,(/w,names/en,,/w, ,sampling/en,_,methods/en,)/w,:/w, ,t/en,0/m, ,=/w, ,time/en,./w,time/en,(/w,)/w, ,if/en, ,name/en, ,=/w,=/w, ,'/w,easyensemble/en,'/w, ,or/en, ,name/en, ,=/w,=/w, ,'/w,balancecascade/en,'/w,:/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,ensemble/en,_,method/en,(/w,method/en,)/w, ,else/en,:/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,method/en,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,y/en,_,prob/en, ,=/w, ,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,fpr/en,,/w, ,tpr/en,,/w, ,thresholds/en, ,=/w, ,roc/en,_,curve/en,(/w,y/en,_,test/en,,/w, ,y/en,_,prob/en,,/w, ,pos/en,_,label/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,fpr/en,,/w, ,tpr/en,,/w, ,lw/en,=/w,3/m,,/w, ,label/en,=/w,'/w,{/w,}/w, ,(/w,auc/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,,/w, ,time/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,s/en,)/w,'/w,./w, ,format/en,(/w,name/en,,/w, ,auc/en,(/w,fpr/en,,/w, ,tpr/en,)/w,,/w, ,time/en,./w,time/en,(/w,)/w, ,-/w, ,t/en,0/m,)/w,)/w, ,plt/en,./w,xlabel/en,(/w,"/w,fpr/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,ylabel/en,(/w,"/w,tpr/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,legend/en,(/w,fontsize/en,=/w,14/m,)/w, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,15/m,,/w,8/m,)/w,)/w, ,for/en, ,(/w,name/en,,/w, ,method/en,)/w, ,in/en, ,zip/en,(/w,names/en,,/w, ,sampling/en,_,methods/en,)/w,:/w, ,t/en,0/m, ,=/w, ,time/en,./w,time/en,(/w,)/w, ,if/en, ,name/en, ,=/w,=/w, ,'/w,easyensemble/en,'/w, ,or/en, ,name/en, ,=/w,=/w, ,'/w,balancecascade/en,'/w,:/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,ensemble/en,_,method/en,(/w,method/en,)/w, ,else/en,:/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,method/en,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,y/en,_,prob/en, ,=/w, ,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,precision/en,,/w, ,recall/en,,/w, ,thresholds/en, ,=/w, ,precision/en,_,recall/en,_,curve/en,(/w,y/en,_,test/en,,/w, ,y/en,_,prob/en,,/w, ,pos/en,_,label/en,=/w,1/m,)/w, ,plt/en,./w,plot/en,(/w,recall/en,,/w, ,precision/en,,/w, ,lw/en,=/w,3/m,,/w, ,label/en,=/w,'/w,{/w,}/w, ,(/w,auc/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,,/w, ,time/en,=/w,{/w,:/w,./w,2/m,f/en,}/w,s/en,)/w,'/w,./w, ,format/en,(/w,name/en,,/w, ,auc/en,(/w,recall/en,,/w, ,precision/en,)/w,,/w, ,time/en,./w,time/en,(/w,)/w, ,-/w, ,t/en,0/m,)/w,)/w, ,plt/en,./w,xlabel/en,(/w,"/w,recall/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,ylabel/en,(/w,"/w,precision/en,"/w,,/w, ,fontsize/en,=/w,17/m,)/w, ,plt/en,./w,legend/en,(/w,fontsize/en,=/w,14/m,,/w, ,loc/en,=/w,"/w,best/en,"/w,)/w,从/p,以上/f,几/m,张/q,图/n,中/f,我们/r,可以/v,得出/v,一些/m,推论/vn,：/w,就/d,时间/n,开销/v,而言/u,，/w,balancecascade/en,以及/c,两种/mq,过/u,采样/v,欠/v,采样/v,结合/v,的/u,方法/n,(/w, ,smote/en, ,+/w, ,enn/en, ,和/c,smote/en, ,+/w, ,tomek/en, ,)/w,耗时/v,最/d,高/a,，/w,如果/c,追求/v,速度/n,的/u,话/n,这/r,几/m,个/q,可能/v,并非/v,很/d,好/a,的/u,选择/v,。/w,第一/m,个/q,数据集/nw, ,us/en,_,crime/en, ,的/u,多数/m,类/q,和/c,少数/m,类/q,样本/n,比例/n,为/p, ,12/m,:/w,1/m,，/w,相差/v,不/d,是/v,很/d,悬殊/a,，/w,综合/vn,roc/en,曲线/n,和/c,pr/en,曲线/n,的/u,auc/en,来看/v,，/w,两种/mq,集成/vn,方法/n,easyensemble/en,和/c,balancecascade/en,表现/v,较/d,好/a,。/w,对于/p,第二/m,个/q,数据集/nw, ,abalone/en,_,19/m, ,来说/u,，/w,多数/m,类/q,和/c,少数/m,类/q,样本/n,比例/n,为/p, ,130/m,:/w,1/m,，/w,而且/c,少数/m,类/q,样本/n,非常/d,少/a,，/w,因而/c,从/p,结果/n,来/v,看/v,几/m,种/q,过/u,采样/v,方法/n,如/v,borderline/en, ,smote/en,，/w, ,smote/en,+/w,tomek/en,等/u,效果/n,较/d,好/a,。/w,可见/v,在/p,类别/n,差异/n,很/d,大/a,的/u,情况/n,下/f,，/w,过/u,采样/v,能/v,一定/d,程度/n,上/f,弥补/v,少数/m,类/q,样本/n,的/u,极端/n,不足/a,。/w,然而/c,从/p,pr/en,曲线/n,上/f,来看/v,，/w,其实/d,结果/n,都/d,不/d,尽如人意/i,，/w,对于/p,这种/r,极端/n,不/d,平衡/a,的/u,数据/n,可能/v,比较/d,适合/v,异常/a,检测/vn,的/u,方法/n,，/w,以后/f,有/v,机会/n,详述/v,。/w,上/f,篇/q,文章/n,中/f,提到/v, ,“/w,roc/en,曲线/n,通常/d,会/v,呈现/v,一个/m,过分/ad,乐观/a,的/u,效果/n,估计/v,”/w,，/w,这里/r,再/d,一次/mq,得到/v,体现/v,。/w,第一/m,个/q,数据/n,集中/v,大部分/m,roc/en,曲线/n,的/u,auc/en,都/d,在/p,0.9/m,左右/m,，/w,而/c,pr/en,曲线/n,都/d,在/p,0.5/m,左右/m,。/w,第二/m,个/q,数据集/nw,则/d,更/d,夸张/v,，/w,从/p,pr/en,曲线/n,来/v,看/v,其实/d,模型/n,对于/p,少数/m,类/q,的/u,预测/v,准确率/n,是/v,无限/vd,接近/v,于/p,0/m,了/u,，/w,但/c,在/p,roc/en,曲线/n,上/f,却/d,很/d,难/a,看/v,出/v,这/r,一点/m,。/w,如果/c,单纯/a,从/p,roc/en,曲线/n,和/c,pr/en,曲线/n,上/f,来看/v,，/w,表面/n,上/f,各种/r,采样/v,方法/n,和/c,base/en, ,model/en,差别/n,不/d,大/a,，/w,但/c,实际上/d,这/r,其中/r,却/d,是/v,暗流/n,涌动/v,。/w,下面/f,来看/v,一下/m, ,us/en,_,crime/en, ,数据/n,集中/v,各/r,方法/n,的/u, ,classification/en, ,report/en,。/w,def/en, ,ensemble/en,_,method/en,_,2/m,(/w,method/en,)/w,:/w, ,#, ,定义/n,一个/m,简化/v,版/n,集成/vn,方法/n, ,xx/en,,/w, ,yy/en, ,=/w, ,method/en,./w,fit/en,_,sample/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w,,/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w, ,for/en, ,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en, ,in/en, ,zip/en,(/w,xx/en,,/w, ,yy/en,)/w,:/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en,)/w, ,y/en,_,pred/en, ,+/w,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,return/en, ,np/en,./w,where/en,(/w,y/en,_,pred/en, ,>,=/w, ,0/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,us/en,_,crime/en, ,=/w, ,fetch/en,_,datasets/en,(/w,)/w,[/w,'/w,us/en,_,crime/en,'/w,]/w, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,us/en,_,crime/en,./w,data/en,,/w, ,us/en,_,crime/en,./w,target/en,,/w, ,test/en,_,size/en,=/w,0.5/m,,/w, ,random/en,_,state/en,=/w,42/m,,/w, ,stratify/en,=/w,us/en,_,crime/en,./w,target/en,)/w, ,class/en,_,names/en, ,=/w, ,[/w,'/w,majority/en, ,class/en,'/w,,/w, ,'/w,minority/en, ,class/en,'/w,]/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,print/en,(/w,"/w,------------------------/nrf,base/en, ,model/en,----------------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,smote/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,print/en,(/w,"/w,--------------------------/nrf,smote/en,------------------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,nearmiss/en,(/w,version/en,=/w,2/m,,/w, ,random/en,_,state/en,=/w,42/m,)/w,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,model/en,./w,predict/en,(/w,x/en,_,test/en,)/w, ,print/en,(/w,"/w,------------------------/nrf,nearmiss/en,------------------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,y/en,_,pred/en, ,=/w, ,ensemble/en,_,method/en,_,2/m,(/w,easyensemble/en,(/w,random/en,_,state/en,=/w,42/m,)/w,)/w, ,class/en,_,names/en, ,=/w, ,[/w,'/w,majority/en, ,class/en,'/w,,/w, ,'/w,minority/en, ,class/en,'/w,]/w, ,print/en,(/w,"/w,-----------------------/nrf,easyensemble/en,---------------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w,输出/v,：/w,------------------------/nrf,base/en, ,model/en,----------------------/nrf, ,precision/en, ,recall/en, ,f/en,1/m,-/w,score/en, ,support/en, ,majority/en, ,class/en, ,0.95/m, ,0.98/m, ,0.97/m, ,922/m, ,minority/en, ,class/en, ,0.62/m, ,0.35/m, ,0.44/m, ,75/m, ,avg/en, ,//w, ,total/en, ,0.92/m, ,0.93/m, ,0.93/m, ,997/m, ,--------------------------/nrf,smote/en,------------------------/nrf, ,precision/en, ,recall/en, ,f/en,1/m,-/w,score/en, ,support/en, ,majority/en, ,class/en, ,0.98/m, ,0.90/m, ,0.94/m, ,922/m, ,minority/en, ,class/en, ,0.38/m, ,0.75/m, ,0.51/m, ,75/m, ,avg/en, ,//w, ,total/en, ,0.93/m, ,0.89/m, ,0.91/m, ,997/m, ,------------------------/nrf,nearmiss/en,------------------------/nrf, ,precision/en, ,recall/en, ,f/en,1/m,-/w,score/en, ,support/en, ,majority/en, ,class/en, ,0.97/m, ,0.81/m, ,0.88/m, ,922/m, ,minority/en, ,class/en, ,0.24/m, ,0.73/m, ,0.36/m, ,75/m, ,avg/en, ,//w, ,total/en, ,0.92/m, ,0.80/m, ,0.84/m, ,997/m, ,-----------------------/nrf,easyensemble/en,---------------------/nrf, ,precision/en, ,recall/en, ,f/en,1/m,-/w,score/en, ,support/en, ,majority/en, ,class/en, ,0.98/m, ,0.85/m, ,0.91/m, ,922/m, ,minority/en, ,class/en, ,0.31/m, ,0.84/m, ,0.45/m, ,75/m, ,avg/en, ,//w, ,total/en, ,0.93/m, ,0.85/m, ,0.88/m, ,997/m,这里/r,我们/r,主要/b,关注/v,少数/m,类/q,样本/n,，/w,可以/v,看到/v, ,base/en, ,model/en, ,的/u,特点/n,是/v,precision/en,高/a,，/w,recall/en,低/a,，/w,而/c,几/m,种/q,采样/v,方法/n,则/d,相反/v,，/w,precision/en,低/a,，/w,recall/en,高/a,。/w,采样/v,方法/n,普遍/ad,扩大/v,了/u,少数/m,类/q,样本/n,的/u,决策/n,边界/n,（/w,从/p,上文/n,中/f,的/u,决策/n,边界/n,图/n,就/d,能/v,看/v,出来/v,）/w,，/w,所以/c,把/p,很多/m,多数/m,类/q,样本/n,也/d,划为/v,少数/m,类/q,了/u,，/w,导致/v,precision/en,下降/v,而/c,recall/en,提升/v,。/w,当然/d,这些/r,都/d,是/v,分类/vn,阈值/n,为/p,0.5/m,的/u,前提/n,下/f,得出/v,的/u,结论/n,，/w,如果/c,进一步/d,调整/vn,阈值/n,的/u,话/n,能/v,得到/v,更/d,好/a,的/u,模型/n,。/w,策略/n,是/v,base/en, ,model/en,的/u,阈值/n,往/p,下调/v,，/w,采样/v,方法/n,的/u,阈值/n,往/p,上调/v,。/w,def/en, ,ensemble/en,_,method/en,_,3/m,(/w,method/en,)/w,:/w, ,xx/en,,/w, ,yy/en, ,=/w, ,method/en,./w,fit/en,_,sample/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en,,/w, ,y/en,_,prob/en, ,=/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w,,/w, ,np/en,./w,zeros/en,(/w,len/en,(/w,x/en,_,test/en,)/w,)/w, ,for/en, ,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en, ,in/en, ,zip/en,(/w,xx/en,,/w, ,yy/en,)/w,:/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,ensemble/en,,/w, ,y/en,_,ensemble/en,)/w, ,y/en,_,pred/en, ,+/w,=/w, ,np/en,./w,where/en,(/w,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,>,=/w, ,0.7/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,#, ,阈值/n, ,>, ,0.7/m, ,return/en, ,np/en,./w,where/en,(/w,y/en,_,pred/en, ,>,=/w, ,0/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,us/en,_,crime/en, ,=/w, ,fetch/en,_,datasets/en,(/w,)/w,[/w,'/w,us/en,_,crime/en,'/w,]/w, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,us/en,_,crime/en,./w,data/en,,/w, ,us/en,_,crime/en,./w,target/en,,/w, ,test/en,_,size/en,=/w,0.5/m,,/w, ,random/en,_,state/en,=/w,42/m,,/w, ,stratify/en,=/w,us/en,_,crime/en,./w,target/en,)/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,np/en,./w,where/en,(/w,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,>,=/w, ,0.3/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,print/en,(/w,"/w,-----------------/nrf,base/en, ,model/en,,/w, ,threshold/en, ,>,=/w, ,0.3/m,---------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,smote/en,(/w,random/en,_,state/en,=/w,42/m,)/w,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,np/en,./w,where/en,(/w,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,>,=/w, ,0.9/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,print/en,(/w,"/w,-----------------/nrf,smote/en,,/w, ,threshold/en, ,>,=/w, ,0.9/m,---------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,model/en, ,=/w, ,make/en,_,pipeline/en,(/w,nearmiss/en,(/w,version/en,=/w,2/m,,/w, ,random/en,_,state/en,=/w,42/m,)/w,,/w, ,logisticregression/en,(/w,)/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,y/en,_,pred/en, ,=/w, ,np/en,./w,where/en,(/w,model/en,./w,predict/en,_,proba/en,(/w,x/en,_,test/en,)/w,[/w,:/w,,/w, ,1/m,]/w, ,>,=/w, ,0.7/m,,/w, ,1/m,,/w, ,-/w,1/m,)/w, ,print/en,(/w,"/w,-------------------/nrf,nearmiss/en,,/w, ,threshold/en, ,>,=/w, ,0.7/m,-------------------/nrf, ,\/w,n/en,"/w,,/w, ,classification/en,_,report/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,,/w, ,target/en,_,names/en,=/w,class/en,_,names/en,)/w,,/w, ,'/w,\/w,n/en,'/w,)/w, ,model/en, ,=/w, ,easyensemble/en,(/w,random/en,_,state/en,=/w,42/m,)/w, ,y/en,_,pred/en, ,=/w, ,ensemble/en,_,method/en,_,3/