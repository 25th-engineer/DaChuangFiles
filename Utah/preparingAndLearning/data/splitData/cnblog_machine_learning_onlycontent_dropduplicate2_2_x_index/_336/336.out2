作者/n,：/w,无影/nw,随想/n,时间/n,：/w,2016年/t,1月/t,。/w,出处/n,：/w,https/en,:/w,//w,//w,zhaokv/en,./w,com/en,//w,machine/en,_,learning/en,//w,2016/m,//w,01/m,//w,learning/en,-/w,from/en,-/w,imbalanced/en,-/w,data/en,./w,html/en,声明/n,：/w,版权/n,所有/b,，/w,转载/v,请/v,注明/v,出处/n,这/r,几/m,年/q,来/v,，/w,机器/n,学习/v,和/c,数据/n,挖掘/v,非常/d,火热/z,，/w,它们/r,逐渐/d,为/p,世界/n,带来/v,实际/n,价值/n,。/w,与此同时/c,，/w,越来越/d,多/a,的/u,机器/n,学习/v,算法/n,从/p,学术界/n,走向/v,工业界/n,，/w,而/c,在/p,这个/r,过程/n,中/f,会/v,有/v,很多/m,困难/an,。/w,数据/n,不/d,平衡/a,问题/n,虽然/c,不/d,是/v,最/d,难/a,的/u,，/w,但/c,绝对/d,是/v,最/d,重要/a,的/u,问题/n,之一/r,。/w,一/m,、/w,数据/n,不/d,平衡/a,在/p,学术/n,研究/vn,与/p,教学/n,中/f,，/w,很多/m,算法/n,都/d,有/v,一个/m,基本/a,假设/v,，/w,那/r,就/d,是/v,数据/n,分布/v,是/v,均匀/ad,的/u,。/w,当/p,我们/r,把/p,这些/r,算法/n,直接/ad,应用/vn,于/p,实际/n,数据/n,时/ng,，/w,大多数/m,情况/n,下/f,都/d,无法/v,取得/v,理想/n,的/u,结果/n,。/w,因为/c,实际/n,数据/n,往往/d,分布/v,得/u,很/d,不/d,均匀/ad,，/w,都/d,会/v,存在/v,“/w,长尾/nw,现象/n,”/w,，/w,也/d,就/d,是/v,所谓/v,的/u,“/w,二八/nw,原理/n,”/w,。/w,下/f,图/n,是/v,新浪/nt,微博/n,交互/v,分布/v,情况/n,：/w,可以/v,看到/v,大部分/m,微博/n,的/u,总/b,互动/v,数/m,（/w,被/p,转发/v,、/w,评论/n,与/p,点赞/nw,数量/n,）/w,在/p,0/m,-/w,5/m,之间/f,，/w,交互/v,数/m,多/a,的/u,微博/n,（/w,多于/v,100/m,）/w,非常/d,之/u,少/a,。/w,如果/c,我们/r,去/v,预测/v,一条/mq,微博/n,交互/v,数/m,所/u,在/p,档位/n,，/w,预测器/nw,只/d,需要/v,把/p,所有/b,微博/n,预测/v,为/p,第一/m,档/q,（/w,0/m,-/w,5/m,）/w,就/d,能/v,获得/v,非常/d,高/a,的/u,准确率/n,，/w,而/c,这样/r,的/u,预测器/nw,没有/v,任何/r,价值/n,。/w,那/r,如何/r,来/v,解决/v,机器/n,学习/v,中/f,数据/n,不/d,平衡/a,问题/n,呢/y,？/w,这/r,便/d,是/v,这/r,篇/q,文章/n,要/v,讨论/v,的/u,主要/b,内容/n,。/w,严格/ad,地/u,讲/v,，/w,任何/r,数据集/nw,上/f,都/d,有数/a,据/p,不/d,平衡/a,现象/n,，/w,这/r,往往/d,由/p,问题/n,本身/r,决定/v,的/u,，/w,但/c,我们/r,只/d,关注/v,那些/r,分布/v,差别/n,比较/d,悬殊/a,的/u,；/w,另外/c,，/w,虽然/c,很多/m,数据集/nw,都/d,包含/v,多/a,个/q,类别/n,，/w,但/c,这里/r,着重/v,考虑/v,二/m,分类/vn,，/w,因为/c,解决/v,了/u,二/m,分类/vn,中/f,的/u,数据/n,不/d,平衡/a,问题/n,后/f,，/w,推而广之/l,就/d,能/v,得到/v,多/a,分类/vn,情况/n,下/f,的/u,解决/v,方案/n,。/w,综上/nz,，/w,这/r,篇/q,文章/n,主要/b,讨论/v,如何/r,解决/v,二/m,分类/vn,中/f,正负/n,样本/n,差/a,两个/m,及/c,以上/f,数量级/n,情况/n,下/f,的/u,数据/n,不/d,平衡/a,问题/n,。/w,不/d,平衡/a,程度/n,相同/a,（/w,即/v,正负/n,样本/n,比例/n,类似/v,）/w,的/u,两个/m,问题/n,，/w,解决/v,的/u,难/a,易/a,程度/n,也/d,可能/v,不同/a,，/w,因为/c,问题/n,难/a,易/a,程度/n,还/d,取决于/v,我们/r,所/u,拥有/v,数据/n,有/v,多/a,大/a,。/w,比如/v,在/p,预测/v,微博/n,互动/v,数/m,的/u,问题/n,中/f,，/w,虽然/c,数据/n,不/d,平衡/a,，/w,但/c,每个/r,档位/n,的/u,数据量/n,都/d,很/d,大/a,——/w,最/d,少/a,的/u,类别/n,也/d,有/v,几/m,万个/m,样本/n,，/w,这样/r,的/u,问题/n,通常/d,比较/d,容易/a,解决/v,；/w,而/c,在/p,癌症/n,诊断/v,的/u,场景/n,中/f,，/w,因为/c,患/v,癌症/n,的/u,人/n,本来/d,就/d,很少/ad,，/w,所以/c,数据/n,不但/c,不/d,平衡/a,，/w,样本/n,数/m,还/d,非常/d,少/a,，/w,这样/r,的/u,问题/n,就/d,非常/d,棘手/a,。/w,综上/nz,，/w,可以/v,把/p,问题/n,根据/p,难度/n,从小到大/l,排/v,个/q,序/n,：/w,大/a,数据/n,+/w,分布/v,均衡/a,</w,大/a,数据/n,+/w,分布/v,不/d,均衡/a,</w,小/a,数据/n,+/w,数据/n,均衡/a,</w,小/a,数据/n,+/w,数据/n,不/d,均衡/a,。/w,对于/p,需要/v,解决/v,的/u,问题/n,，/w,拿/v,到/v,数据/n,后/f,，/w,首先/d,统计/v,可/v,用/p,训练/vn,数据/n,有/v,多/a,大/a,，/w,然后/c,再/d,观察/v,数据/n,分布/v,情况/n,。/w,经验/n,表明/v,，/w,训练/vn,数据/n,中/f,每个/r,类别/n,有/v,5000个/m,以上/f,样本/n,，/w,数据量/n,是/v,足够/v,的/u,，/w,正负/n,样本/n,差/a,一个/m,数量级/n,以内/f,是/v,可以/v,接受/v,的/u,，/w,不/d,太/d,需要/v,考虑/v,数据/n,不/d,平衡/a,问题/n,（/w,完全/ad,是/v,经验/n,，/w,没有/v,理论/n,依据/n,，/w,仅供参考/l,）/w,。/w,二/m,、/w,如何/r,解决/v,解决/v,这/r,一/m,问题/n,的/u,基本/a,思路/n,是/v,让/v,正负/n,样本/n,在/p,训练/vn,过程/n,中/f,拥有/v,相同/a,的/u,话语/n,权/n,，/w,比如/v,利用/v,采样/v,与/p,加权/v,等/u,方法/n,。/w,为了/p,方便/a,起见/u,，/w,我们/r,把/p,数据/n,集中/v,样本/n,较/d,多/a,的/u,那/r,一类/b,称为/v,“/w,大众类/nw,”/w,，/w,样本/n,较/d,少/a,的/u,那/r,一类/b,称为/v,“/w,小众/nz,类/q,”/w,。/w,1/m,./w, ,采样/v,采样/v,方法/n,是/v,通过/p,对/p,训练/vn,集/vg,进行/v,处理/v,使/v,其/r,从不/d,平衡/a,的/u,数据集/nw,变成/v,平衡/a,的/u,数据集/nw,，/w,在/p,大部分/m,情况/n,下/f,会/v,对/p,最终/d,的/u,结果/n,带来/v,提升/v,。/w,采样/v,分为/v,上/f,采样/v,（/w,oversampling/en,）/w,和/c,下/f,采样/v,（/w,undersampling/en,）/w,，/w,上/f,采样/v,是/v,把/p,小/a,种类/n,复制/v,多/a,份/q,，/w,下/f,采样/v,是/v,从/p,大众类/nw,中/f,剔除/v,一些/m,样本/n,，/w,或者/c,说/v,只/d,从/p,大众类/nw,中/f,选取/v,部分/n,样本/n,。/w,随机/d,采样/v,最/d,大/a,的/u,优点/n,是/v,简单/a,，/w,但/c,缺点/n,也/d,很/d,明显/a,。/w,上/f,采样/v,后/f,的/u,数据/n,集中/v,会/v,反复/d,出现/v,一些/m,样本/n,，/w,训练/vn,出来/v,的/u,模型/n,会/v,有/v,一定/d,的/u,过/u,拟合/nz,；/w,而/c,下/f,采样/v,的/u,缺点/n,显而易见/i,，/w,那/r,就/d,是/v,最终/d,的/u,训练/vn,集/vg,丢失/v,了/u,数据/n,，/w,模型/n,只/d,学/v,到/v,了/u,总体/n,模式/n,的/u,一部分/m,。/w,上/f,采样/v,会/v,把/p,小众/nz,样本/n,复制/v,多/a,份/q,，/w,一个/m,点/q,会/v,在/p,高维/nr,空间/n,中/f,反复/d,出现/v,，/w,这/r,会/v,导致/v,一个/m,问题/n,，/w,那/r,就/d,是/v,运气/n,好/a,就/d,能/v,分/q,对/p,很多/m,点/q,，/w,否则/c,分错/nw,很多/m,点/q,。/w,为了/p,解决/v,这/r,一/m,问题/n,，/w,可以/v,在/p,每次/r,生成/vn,新/a,数据点/nw,时/ng,加入/v,轻微/a,的/u,随机/d,扰动/vn,，/w,经验/n,表明/v,这种/r,做法/n,非常/d,有效/a,。/w,因为/c,下/f,采样/v,会/v,丢失/v,信息/n,，/w,如何/r,减少/v,信息/n,的/u,损失/n,呢/y,？/w,第一/m,种/q,方法/n,叫做/v,easyensemble/en,，/w,利用/v,模型/n,融合/v,的/u,方法/n,（/w,ensemble/en,）/w,：/w,多次/m,下/f,采样/v,（/w,放/v,回/v,采样/v,，/w,这样/r,产生/v,的/u,训练/vn,集/vg,才/d,相互/d,独立/v,）/w,产生/v,多/a,个/q,不同/a,的/u,训练/vn,集/vg,，/w,进而/c,训练/vn,多/a,个/q,不同/a,的/u,分类器/nw,，/w,通过/p,组合/v,多/a,个/q,分类器/nw,的/u,结果/n,得到/v,最终/d,的/u,结果/n,。/w,第二/m,种/q,方法/n,叫做/v,balancecascade/en,，/w,利用/v,增量/n,训练/vn,的/u,思想/n,（/w,boosting/en,）/w,：/w,先/d,通过/p,一次/mq,下/f,采样/v,产生/v,训练/vn,集/vg,，/w,训练/vn,一个/m,分类器/nw,，/w,对于/p,那些/r,分类/vn,正确/a,的/u,大众/n,样本/n,不/d,放/v,回/v,，/w,然后/c,对/p,这个/r,更/d,小/a,的/u,大众/n,样本/n,下/f,采样/v,产生/v,训练/vn,集/vg,，/w,训练/vn,第二/m,个/q,分类器/nw,，/w,以此类推/l,，/w,最终/d,组合/v,所有/b,分类器/nw,的/u,结果/n,得到/v,最终/d,结果/n,。/w,第三/nw,种/q,方法/n,是/v,利用/v,knn/en,试图/v,挑选/v,那些/r,最/d,具/vg,代表性/n,的/u,大众/n,样本/n,，/w,叫做/v,nearmiss/en,，/w,这/r,类/q,方法/n,计算量/nw,很大/d,，/w,感/vg,兴趣/n,的/u,可以/v,参考/v,“/w,learning/en, ,from/en, ,imbalanced/en, ,data/en,”/w,这/r,篇/q,综述/v,的/u,3/m,./w,2/m,./w,1节/mq,。/w,2/m,./w, ,数据/n,合成/v,数据/n,合成/v,方法/n,是/v,利用/v,已/d,有/v,样本/n,生成/vn,更/d,多/a,样本/n,，/w,这/r,类/q,方法/n,在/p,小/a,数据/n,场景/n,下/f,有/v,很多/m,成功/a,案例/n,，/w,比如/v,医学/n,图像/n,分析/vn,等/u,。/w,其中/r,最/d,常见/a,的/u,一种/mq,方法/n,叫做/v,smote/en,，/w,它/r,利用/v,小众/nz,样本/n,在/p,特征/n,空间/n,的/u,相似性/n,来/v,生成/vn,新/a,样本/n,。/w,对于/p,小众/nz,样本/n,$/w,x/en,_,i/en,\/w,in/en, ,s/en,_,{/w,\/w,min/en,}/w,$/w,，/w,从/p,它/r,属于/v,小众/nz,类/q,的/u,k/en,近邻/n,中/f,随机/d,选取/v,一个/m,样本点/nw,$/w,\/w,hat/en,{/w,x/en,}/w,_,i/en,$/w,，/w,生成/vn,一个/m,新/a,的/u,小众/nz,样本/n,$/w,x/en,_,{/w,new/en,}/w,$/w,：/w,$/w,x/en,_,{/w,new/en,}/w,=/w,x/en,_,i/en,+/w,(/w,\/w,hat/en,{/w,x/en,}/w,-/w,x/en,_,i/en,)/w,\/w,times/en,\/w,delta/en,$/w,，/w,其中/r,$/w,\/w,delta/en,\/w,in/en,[/w,0/m,,/w,1/m,]/w,$/w,是/v,随机数/n,。/w,上图/n,是/v,smote/en,方法/n,在/p,$/w,k/en,=/w,6/m,$/w,近邻/n,下/f,的/u,示意图/n,，/w,黑色/n,方格/n,是/v,生成/vn,的/u,新/a,样本/n,。/w,smote/en,为/p,每个/r,小众/nz,样本/n,合成/v,相同/a,数量/n,的/u,新/a,样本/n,，/w,这/r,带来/v,一些/m,潜在/b,的/u,问题/n,：/w,一方面/c,是/v,增加/v,了/u,类/q,之间/f,重叠/v,的/u,可能性/n,，/w,另一方面/c,是/v,生成/vn,一些/m,没有/v,提供/v,有益/a,信息/n,的/u,样本/n,。/w,为了/p,解决/v,这个/r,问题/n,，/w,出现/v,两种/mq,方法/n,：/w,borderline/en,-/w,smote/en,与/p,adasyn/en,。/w,borderline/en,-/w,smote/en,的/u,解决/v,思路/n,是/v,寻找/v,那些/r,应该/v,为/p,之/u,合成/v,新/a,样本/n,的/u,小众/nz,样本/n,。/w,即/v,为/p,每个/r,小众/nz,样本/n,计算/v,k/en,近邻/n,，/w,只/d,为/p,那些/r,k/en,近邻/n,中/f,有/v,一半/m,以上/f,大众/n,样本/n,的/u,小众/nz,样本/n,生成/vn,新/a,样本/n,。/w,直观/a,地/u,讲/v,，/w,只/d,为/p,那些/r,周围/f,大部分/m,是/v,大众/n,样本/n,的/u,小众/nz,样本/n,生成/vn,新/a,样本/n,，/w,因为/c,这些/r,样本/n,往往/d,是/v,边界/n,样本/n,。/w,确定/v,了/u,为/p,哪些/r,小众/nz,样本/n,生成/vn,新/a,样本/n,后/f,再/d,利用/v,smote/en,生成/vn,新/a,样本/n,。/w,adasyn/en,的/u,解决/v,思路/n,是/v,根据/p,数据/n,分布/v,情况/n,为/p,不同/a,小众/nz,样本/n,生成/vn,不同/a,数量/n,的/u,新/a,样本/n,。/w,首先/d,根据/p,最终/d,的/u,平衡/a,程度/n,设定/v,总共/d,需要/v,生成/vn,的/u,新/a,小众/nz,样本/n,数量/n,$/w,g/en,$/w,，/w,然后/c,为/p,每个/r,小众/nz,样本/n,$/w,x/en,_,i/en,$/w,计算/v,分布/v,比例/n,$/w,\/w,gamma/en,_,i/en,$/w,：/w,$/w,\/w,gamma/en,_,i/en,=/w,\/w,frac/en,{/w,\/w,delta/en,_,i/en,//w,k/en,}/w,{/w,z/en,}/w,$/w,，/w,其中/r,$/w,\/w,gamma/en,_,i/en,$/w,是/v,$/w,x/en,_,i/en,$/w,k/en,近邻/n,中/f,大众/n,样本/n,的/u,数量/n,，/w,$/w,z/en,$/w,用/p,来/v,归/v,一化/nw,使得/v,$/w,\/w,sum/en,\/w,gamma/en,_,i/en,=/w,1/m,$/w,，/w,最后/f,为/p,小众/nz,样本/n,$/w,x/en,_,i/en,$/w,生成/vn,新/a,样本/n,的/u,个数/n,为/p,$/w,g/en,_,i/en,=/w,\/w,gamma/en,_,i/en,\/w,times/en, ,g/en,$/w,，/w,确定/v,个/q,数/m,后/f,再/d,利用/v,smote/en,生成/vn,新/a,样本/n,。/w,3/m,./w, ,加权/v,除了/p,采样/v,和/c,生成/vn,新/a,数据/n,等/u,方法/n,，/w,我们/r,还/d,可以/v,通过/p,加权/v,的/u,方式/n,来/v,解决/v,数据/n,不/d,平衡/a,问题/n,，/w,即/v,对/p,不同/a,类别/n,分错/nw,的/u,代价/n,不同/a,，/w,如/v,下/f,图/n,：/w,kc/en,(/w,k/en,,/w,1/m,)/w,c/en,(/w,k/en,,/w,2/m,)/w,./w,./w,./w,012/m,./w,./w,./w,k/en,10/m,c/en,(/w,1/m,,/w,2/m,)/w,./w,./w,./w,c/en,(/w,1/m,,/w,k/en,)/w,2/m,c/en,(/w,2/m,,/w,1/m,)/w,0/m,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,横向/n,是/v,真实/a,分类/vn,情况/n,，/w,纵向/n,是/v,预测/v,分类/vn,情况/n,，/w,c/en,(/w,i/en,,/w,j/en,)/w,是/v,把/p,真实/a,类别/n,为/p,j/en,的/u,样本/n,预测/v,为/p,i/en,时/ng,的/u,损失/n,，/w,我们/r,需要/v,根据/p,实际/n,情况/n,来/v