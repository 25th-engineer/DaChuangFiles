本文 转 自 https / / mp . weixin . 
qq . com / s _ _ biz = MzIwMTgwNjgyOQ 
= = & mid = 2247484846 & idx = 1 
& sn = c 2 3 3 3 a 9 
9 8 6 c 1 9 e 7 1 0 
6 a e 9 4 d 1 4 a 0 
5 5 5 b 9 能 根据 文字 生成 图片 
的 GAN 深度 学习 领域 的 又一 新星 2017 01 
12   DataCastle 数据 城堡 2014 年 6 月 Ian 
Goodfellow   等 学者 发表 了 论文 Generative Adversarial Nets 
题目 即 生成 对抗 网络 标志着 GAN 的 诞生 2015 
年还/nr 名不见经传 的   GAN 在 2016 年开挂/nr 般地 掀起 
了 一 波 深度 学习 的 高潮 除了 OpenAI 火力 
全开 之外 Facebook 的 人工智能 实验室 也在 这一 领域 马不停蹄 
地 深耕 而 苹果 不久前 的 首篇 AI 论文 就是 
基于 GAN 的 变种 SimGAN 2016年 GAN 热潮 席卷 AI 
领域 各 大 顶级 会议 从 ICLR 到 NIPS 大量/n 
高/a 质量/n 论文/nz 被/p 发表/v 和/c 探讨/v Yann LeCun 曾 
评价 GAN 是   20 年来 机器学习 领域 最酷 的 
想法 并在 2016 巴塞罗那 的   NIPS 上 提到 将 
预测 学习 Predictive Learning 落脚 到   GAN   在 
大 数据 的 圈子 通常 有人 说 谁 掌握 了 
数据 谁 就 占据 了 未来 高地 于是 基于 数据 
而 习得 特征 的 深度 学习 技术 受到 热捧 而 
  GAN 的 训练 方法 更加 激进 它 生成 数据 
本身 从 学术界 到 工业界 GAN 热潮 席卷 整个 AI 
领域 成为 深度 学习 领域 一颗 冉冉 升起 的 新星 
未来 的 发展 潜力 更是 被 无数 人 看好 GAN 
基于 概率 的 生成 模型 什么 是 GAN 用 Ian 
Goodfellow 自己 的话 来说 生成 对抗 网络 是 一种 生成 
模型 Generative Model 其 背后 基本 思想 是 从 训练 
库里 获取 很多 训练样本 从而 学习 这些 训练 案例 生成 
的 概率分布 而 实现 的 方法 是 让 两个 网络 
相互竞争 玩 一个 游戏 其中 一个 叫做 生成器 网络 Generator 
Network 它 不断 捕捉 训练 库里 真实 图片 的 概率分布 
将 输入 的 随机噪声 Random Noise 转变 成 新的 样本 
也 就是 假 数据 另 一个 叫做 判别 器 网络 
Discriminator Network 它 可以 同时 观察 真实 和 假造 的 
数据 判断 这个 数据 到底 是不是 真的 用 Adit Deshpande 
的话 解释 更加 清晰 GAN 的 基本 原理 是 它 
有 两个 模型 一个 生成器 一个 判别 器 判别 器 
的 任务 是 判断 给定 图像 是否 看起来 自然 换句话说 
是否 像 是 人为 机器 生成 的 而 生成器 的 
任务 是 顾名思义 生成 看起来 自然 的 图像 要求 与 
原始 数据分布 尽可能 一致 GAN 的 运作 方式 可 被 
看作 是 两名 玩家 之间 的 零和 游戏 原 论文 
的 类比 是 生成器 就像 一支 造 假币 的 团伙 
试图用 假币 蒙混过关 而 判别 器 就像 是 警察 目标 
是 检查 出 假币 生成器 想要 骗过 判别 器 判别 
器 想要 不 上当 当 两组 模型 不断 训练 生成器 
不断 生成 新的 结果 进行 尝试 它们 的 能力 互相 
提高 直到 生成器 生成 的 人造 样本 看起来 与 原始 
样本 没有 区别 GAN 首先 是 一种 概率 生成 模型 
概率 生成 模型 可以 用于 自然 图像 的 生成 假设 
给定 1000万 张 图片 之后 生成 模型 可以 自动 学习 
到 其 内部 分布 能够 解释 给定 的 训练 图片 
并 同时 生成 新的 图片 与 庞大 的 真实 数据 
相比 概率 生成 模型 的 参数 个数 要 远远 小于 
数据 的 数量 因此 在 训练 过程 中 生成 模型 
会被 强迫 去 发现 数据 背后 更为 简单 的 统计 
规律 从而 能够 生成 这些 数据 除了   GAN 现在 
比较 常用 的 变分 自动编码 模型 VAE 自 回归模型 Auto 
regressive 也 属于 概率 生成 模型 GAN 是 更好 的 
生成 模型 在 某种 意义 上 避免 了 马尔科夫 链式 
的 学习 机制 这 使得 它 能够 区别于 传统 的 
概率 生成 模型 传统/n 概率/n 生成/v 模型/n 一般/a 都/d 需要/v 
进行/v 马/n 可夫/n 链式/n 的/uj 采样/v 和/c 推断/v 而 GAN 
避免 了 这个 计算 复杂度 特别高 的 过程 直接 进行 
采样 和 推断 从而 提高 了 GAN 的 应用 效率 
所以 其 实际 应用 场景 也 就 更为 广泛 GAN 
的 基本 原理 GAN 模型 包括 了 一个 生成 模型 
G 和 一个 判别 模型 D GAN 的 目标 函数 
是 关于 D 与 G 的 一个 零和 游戏 也 
是 一个 最小 最大化 问题 这里 判别 模型 D 实际上 
是 对 数据 的 来源 进行 一个 判别 究竟 这个 
数据 是 来自 真实 的 数据 分布 Pdata 还是 来自 
于 一个 生成 模型 G 所 产生 的 一个 数据分布 
Pg 判别 模型 D 的 训练 目的 就是 要 尽量 
最大化 自己 的 判别 准确率 当 这个 数据 被 判别 
为 来自 于 真实 数据 时 标注 1 自 于 
生成 数据 时 标注 0 而与 这个 目的 相反 的 
是 生成 模型 G 的 训练 目标 就是 要 最小化 
判别 模型 D 的 判别 准确率 在 训练 过程 中 
GAN 采用 了 一种 非常 直接 的 交替 优化 方式 
它 可以 分为 两个 阶段 第一 个 阶段 是 固定 
判别 模型 D 然后 优 化生成 模型 G 使得 判别 
模型 的 准确率 尽量 降低 而 另一个 阶段 是 固定 
生成 模型 G 来 提高 判别 模型 的 准确率 下面 
这张 图 可视 化了 GAN 学习 的 过程 从左到右 是 
随着 训练 过程 的 进展 依次 得到 的 训练 结果 
图 a 中 黑色 大点 虚线 P x 是 真实 
的 数据分布 绿线 G z 是 通过 生成 模型 产生 
的 数据 分布 输入 是 均匀分布 变量 z 输出 是 
绿色 的 曲线 蓝色 的 小点 虚线 D x 代表 
判别函数 在 图 a 中 我们 可以 看到 绿线 G 
z 分布 和 黑色 P x 真实 分布 还有 比 
较大 的 差异 这点 也 反映 在 蓝色 的 判别函数 
上 判别函数 能够 准确 的 对 左面 的 真实 数据 
输入 输出 比 较大 的 值 对 右面 虚假 数据 
产生 比 较小 的 值 但是 随着 训练 次数 的 
增加 图 b 和图/nr c 反映 出 绿色 的 分布 
在 逐渐 靠近 黑色 的 分布 到 图 d 产生 
的 绿色 分布 和 真实 数据分布 已经 完全 重合 这时 
  判别函数 对 所有 的 数据 无论 真实 的 还是 
生成 的 数据 输出 都是 一样 的 值 已经 不能 
正确 进行 分类 G 成功 学习 到了 数据分布 这样 就 
达到 了 GAN 的 训练 和 学习 目的 GAN 通过 
对抗式 训练 生成 图片 准确 来讲 对抗式 训练 为 指导 
人工智能 完成 复杂 任务 提供 了 一个 全新 的 思路 
某种 意义 上 他们 人工智能 将 学习 如何 成为 一个 
专家 举个 对抗式 训练 的 例子 当 你 试图 通过 
模仿 别人 完成 某项 工作 时 如果 专家 都 无法 
分辨 这项 工作 是 你 完成 的 还是 你 的 
模仿 对象 完成 的 说明 你 已经 完全 掌握 了 
该 工作 的 所需 的 技巧 对于 像 写 论文 
这样 复杂 的 工作 这个 例子 可能 不 适用 毕竟 
每个人 的 最终 成果 多少 有些 不同 但 对于 中等 
难度 的 任务 比如 造句 或 写 一段 话 对抗式 
训练 大有用武之地 事实上 它 现在 已经 是 计算机 生成 真实 
图像 的 关键 所在 了 我们 知道 OpenAI 对 生成 
模型 格外 偏爱 他们 的 动力 可 总结 为 理查德 
费曼 的 一句 名言 不是 我 创造 的 我 就 
不能 理解 费曼 这里 其实 是 指 首要 原则 的 
思考 方法 通过 构建 验证 过 的 概念 来 理解 
事物 在 AI 领域 或许 就是 指 如果 一个 机器 
能够 生成 具有 高度 真实感 的 模型 那么 它 就 
发展 出了 对 预测模型 的 理解 而这 恰好 是 GAN 
所 采取 的 方法 GAN 解决 问题 的 方式 是 
用 不同 的 目标 分别 训练 两种 不同 的 网络 
•     一种 网络 创造 答案 生 成方 • 
  另一种 网络 分辨 前者 创造 的 答案 与 真实 
答案 的 区别 对抗 方 GAN 的 诀窍 是 这样 
的 训练 两种 网络 进行 竞争 一段 时间 后 两种 
网络 都 无法 在 对抗 中 取得 进步 或者/c 生/vn 
成方/n 变得/v 非常/d 厉害/a 以至于/c 即使/c 给定/v 足够/v 的/uj 线索/n 
和/c 时间/n 其 对抗 网络 也 无法 分辨 它 给 
的 答案 是 真实 的 还是 合成 的 这 其中 
有 很多 有趣 的 细节 但 我们 暂时 先 忽略 
这些 细节 GANs 可以 在 给定 绘制 图像 类别 和 
随机 种子 random seed 的 条件 下 自主 完成 图像 
的 绘制 论文 Generative Adversarial Text to Image Synthesis 介绍 
了 如何 通过 GAN 进行 从 文字 到 图像 的 
转化 比方说 若 神经 网络 的 输入 是 粉色 花瓣 
的 花 输出 就会 是 一个 包含 了 这些 要素 
的 图像 该 任务 包含 两个 部分 1 . 利用 
自然 语言 处理 来 理解 输入 中的 描述 2 . 
生成 网络 输出 一个 准确 自然 的 图像 对 文字 
进行 表达 为 实现 这些 目标 生成器/l 和/c 判别/v 器/n 
都/d 使用/v 了/ul 文字/n 编码/n 技术/n 通过 循环 文字 编码器 
recurrent text encoder 生成 的 文字 属性 来 作为 条件 
对 GAN 进行 训练 这 使得 GAN 能够 在 输入 
的 文字 描述 和 输出 图像 之间 建立 相关性 联系 
比如 我们 给定 红脚鹬 蚂蚁 修道院 和 火山 利用 GAN 
就 可以 生成 以下 的 图片 是不是 让 人有 眼前一亮 
的 感觉 呢 很多 人 都画/nr 不出 这么 好 的 
图 吧 当然 这 是 比较 理想 的 情况 还有 
一些 经常 被 搞砸 的 情况 如 下图 不过 这 
已经 让 研究者 们 非常 欣喜 了 目前 的 共识 
是 这些 生成 模型 并 不能 准确 捕捉到 给定 任务 
的 语义 也 就是说 它们 其实 并 不能 很好 地 
理解 蚂蚁 红脚鹬 火山 等 词 的 意义 但却 能够 
很好 地 模仿 和 预测 这些 图片 并 不是 机器 
基于 原有 训练 图片库 的 再创造 而是 根据 通用 模型 
所 推断出 的 非常 接近 现实 的 结果 这种 使用 
对抗性 网络 的 方法 异于 经典 的 机器 学习 方法 
我们 有 两个 相互 竞争 的 神经 网络 但又 好像 
在 共同 协作 达成 一种 泛化 能力 在 经典 机器学习 
领域 研究 人员 先 定义 一个 目标函数 然后 使用 他 
最喜欢 的 优化 算法 但 这 其中 有 一个 问题 
那 就是 我们 无法 准确 得知 所定 的 目标 函数 
是否 是 正确 的 而 GAN 令人 惊喜 的 地方 
在于 它 甚至 能够 习得 自己 的 目标 函数 GAN 
的 超 分辨率 应用 这是 推特 Cortex 研究 团队 进行 
的 一项 研究 在 2016 年 9 月 发表 它 
的 主要 贡献 是 开发 出 全新 的 损失 函数 
loss function 使得 GANs 能对 大幅 降 采样 后的/nr 图像 
恢复 它 的 生动 纹理 和小/nr 颗粒 细节 在 机器 
学习 中 实现 超 分辨率 需要用 成对 样本 对 系统 
进行 训练 一个 是 原始 高清 图像 一个 是 降 
采样 后的/nr 低分辨率 图像 本 研究 中 低分 图像 被 
作为 输入 喂给 生成器 它 重 建出 高分辨率 图像 然后 
重建 图片 和 原始 图片 被 一起 交给 判别 器 
来 判断 哪 一幅 是 原始 图像 生成 模型 要将 
模糊 的 低分辨率 图像 作为 输入 并 输出 一个 高 
分辨率 的 清晰 图像 而 判别 模型 就要 判断 所 
输入 的 图像 究竟 是 真实 高分辨率 图像 还是 由 
低分辨率 图像 转化 来 的 高分辨率 图像 而 这就 大大 
简化 了 图像 超 分辨率 模型 的 学习 过程 因为 
传统 上 做 一个 图像 超 分辨率 都 要去 对 
一些 高频 细节 进行 建模 而 这里 生成 模型 训练 
目的 就 简化 为 迷惑 判别 模型 在 Twitter 的 
论文 中 他们 用 一个 16个 残差 块 的 网络 
来 参数 化生成 模型 而 判别 模型 使用 的 是 
一个 VGG 网络 这个 实验 结果 也 说明 了 使用 
GAN 模型 能够 得到 更好 的 结果 与 以往 基于 
深度 学习 模型 做 图像 超 分辨率 的 结果 相比 
的话 比如 SRResNet 等 我们 可以 看到 GAN 的 结果 
图 能够 提供 更 丰富 的 细节 这 也 就是 
GAN 做 图像 生成 时的/nr 一个 显著 优点 即 能够 
提供 更 锐利 的 数据 细节 对抗式 学习 和 人类 
的 反馈 式 学习 相比 强化 学习 RL 而言 对抗式 
学习 似乎 更 接近 人类 的 学习 方式 RL 通过 
最大化 平均 最终 奖励 来 达到 训练 目的 当前 的 
状态 也许 与 奖励 无关 但 最终 的 结局 一定 
会由 奖励 函数 给出 但是 除非 你 是 在 玩游戏 
否则 很难 写出 一个 奖励 函 数来 精确 衡量 来自 
周边 环境 的 反馈 那么 我们 是 如何 学习 写字 
的 除非 你 念 的 是 要求 很 严格 的 
小学 否则 学习 写字 的 过程 很难 说是 最大化 某个 
与 书写 字母 有关 的 函数 最 可能 的 情况 
是 你 模仿 老师 在 黑板 上 的 书写 笔顺 
然后 内化 这一 过程 你 的 生成 网络 书写 字母 
而 你 的 识别 网络 对抗 方 观察 你 的 
字体 和 教科书 中 理想 字体 的 区别 针对 三 
年级 学生 的 对抗 式 训练 我们 并不 知道 我们 
的 大脑 是 如何 使用 行为人 － 批评家 的 模式 
来 学习 的 但是 可以 确定 的 是 在 有 
一个 专家 即时 反馈 的 条件 下 我们 可以 更 
有效率 地 学习 新 东西 当 学习 编程 或 攀岩 
时 如果 你 一直 接收 某个 专家 的 beta 反馈 
建议 则 可以 进步 得 更快 在 你 获得 足够 
的 经验 能够 自我 反馈 批评 之前 有 一个 外部 
的 批评家 来 纠正 你 每一 小步 的 错误 可以 
更容易 训练 你 大脑 的 生成 网络 即使 有 一个 
内部 批评家 在 监督 你 学习 一个 有效 的 生成 
网络 仍然 需要 认真 的 练习 一个 问题 自然而然 地 
出现 了 到底 哪种 网络 能够 真正 理解 所 面临 
问题 是 生成器 还是 识别器 或者说 究竟 谁 更会 写字 
是 写字 的 学生 还是 教 写字 的 老师 现实 
世界 通常 是 老师 更会 写字 但在 之前 的 例子 
中 应该 是 学生 更会 写字 因为 一个 用于 识别 
产品 评论 的 识别 器 只需 知道 一些 常见 的 
语法错误 就能 投入 使用 正如 一个 人像 米开朗基罗 一样 画画 
一个 人 仅仅 是 抬头 看看 西斯廷 大 教堂 的 
天花板 上面 有 米开朗基罗 的 画 谁 需要 更多 的 
技巧 呢 比如 手机 图像 软件 Prisma 在有 对抗 方的/nr 
框架 下 训练 生成 网络 进行 不同 风格 的 创作 
大多数 风格 正是 通过 这种 方式 生成 了 那些 曲折 
的 线条 我 希望 他们 能 增加 训练 GAN 的 
时间 这样 GAN 不仅 能 认出 照片 中 的 阴影 
并给 其 涂上 不同 的 颜色 还 可能 以 一个 
印象派 艺术家 的 风格 完成 这些 任务 当 它 偶尔 
可以 正确地 区分 光线 和 阴影 的 时候 那么 它 
就是 令人 惊叹 的 顺着 这条 思路 想下去 可以 得出 
一个 很 自然 的 结论 生成式 对抗 方法 可以/c 让/v 
人工智能/n 有/v 能力/n 做/v 实验/vn 和A//nr B/w 测试/vn 一个 人工智能 
模型 给出 了 一个 很好 的 解决方案 然后 它 搜集 
反馈 来 了解 这个 生成 方案 和 标准 答案 是否 
相符 或 与 其他 它 正在 学习 或 已经 内化 
的 人工智能 模型 比较 观察 得出 的 结果 是否 相符 
在 这一 过程 中 你 没 必要 去 设计 一个 
损失 函数 因为 虽然 可能 会 花上 一点 时间 但 
这个 人工智能 模型 终将 找到 自己 的 评判 标准 在 
不 完美 中 继续 前行 作为 一个 生成 模型 GAN 
模型 避免 了 一些 传统 生成 模型 在 实际 应用 
中 的 一些 困难 巧妙 地 通过 对抗 学习 来 
近似 一些 不可解的 损失 函数 自然 GAN 也 并不 完美 
一个 是 优化 过程 中 存在 不稳定性 很容易 坍缩 到 
一个 鞍 点上 其次是   GAN 的 可解释 性比 较差 
再次 需要 提高 训练 过程 中 的 稳定性 和 GAN 
模型 的 延展性 尤其 在 处理 大规模 数据 的 时候 
当然 也 有 很多 人 对 GAN 的 收敛性 和可/nr 
推广性 持 悲观 态度 他们 认为 由于 这种 跷跷 板式 
的 训练 方法 一会儿 训练 生 成方 一会儿 训练 识别 
方 如此 反复 并 不能 保证 收敛 于 一个 稳定 
解 更 别提 一个 最优 解了 自然 目前 还有 很多 
不 尽如人意 的 地方 但 我们 看到 GAN 应用在 无 
监督 学习 或 自 监督 学习上 并 提供 有效 的 
解决方案 的 可能性 同时 GAN 还 可以 建立 与 强化 
学习 之间 的 联系 应用 在 强化 学习 上 GAN 
的 诞生 给 我们 带来 的 一个 迷人 的 发现 
是 深度 学习 系统 的 可塑性 极强 经典/n 的/uj 机器学习/i 
认为/v 目标函数/i 和/c 约束/vn 条件/n 都是/nr 固定/a 的/uj 观念/n 或者 
认为 最优 算法 是 固定 的 观念 此时 并 不适 
用于 机器学习 领域 了 正如 Yan Lecun 所说 GAN 为 
创建 无 监督 学习 模型 提供 了 强有力 的 算法 
框架 有望 帮助 我们 为 AI 加入 常识 我们 认为 
沿着 这条路 走下去 有/v 不小/a 的/uj 成功/a 机会/n 能/v 开发/v 
出/v 更/d 智慧/nr 的/uj AI 深度 学习 新星 GAN DataCastle 
