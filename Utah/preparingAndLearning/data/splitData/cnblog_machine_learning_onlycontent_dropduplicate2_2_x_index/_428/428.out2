在/p,本章/r,中/f,，/w,我们/r,将/d,展示/v,两个/m,独立/v,的/u,例子/n,，/w,一个/m,用于/v,人脸/n,检测/vn,，/w,另/r,一个/m,用于/v,动态/n,检测/vn,，/w,以及/c,如何/r,快速/d,地/u,将/d,这些/r,功能/n,添加/vn,到/v,应用/vn,程序/n,中/f,。/w,在/p,这/r,一章/mq,中/f,，/w,我们/r,将/d,讨论/v,:/w,面部/n,检测/vn,动态/n,检测/vn,将/d,检测/vn,添加/vn,到/v,应用/vn,程序/n,中面部/nw,检测/vn,人脸/n,检测/vn,，/w,是/v,人脸/n,识别/v,的/u,第一/m,部分/n,。/w,如果/c,你/r,不能/v,从/p,屏幕/n,上/f,的/u,所有/b,东西/n,中/f,识别/v,出/v,一个/m,或/c,多/a,个/q,人/n,脸/n,，/w,那么/r,你/r,将/d,永远/d,无法/v,识别/v,那/r,是/v,谁/r,的/u,脸/n,。/w,首先/d,让/v,我们/r,看/v,一张/mq,我们/r,的/u,应用/vn,程序/n,截/v,图/n,:/w,上/f,图/n,中/f,，/w,通过/p,摄像头/n,我们/r,已经/d,捕获/v,到/v,一张/mq,图像/n,，/w,接下来/l,启用/v,面部/n,跟踪/v,，/w,看看/v,会/v,发生/v,什么/r,:/w,物体/n,面部/n,特征/n,正在/d,被/p,追踪/v,。/w,我们/r,在/p,物体/n,周围/f,看到/v,的/u,是/v,面部/n,追踪器/nw,(/w,白色/n,线/n,框/q,)/w,，/w,它/r,告诉/v,我们/r,我们/r,这里/r,有/v,一张/mq,脸/n,；/w,以及/c,我们/r,的/u,角度/n,探测器/n,(/w,红线/n,)/w,，/w,它/r,提供/v,了/u,一些/m,关于/p,我们/r,脸/n,所/u,处/n,水平/n,方向/n,的/u,参考/v,。/w,当/p,我们/r,移动/vn,物体/n,时/ng,，/w,面部/n,追踪器/nw,和/c,角度/n,探测器/n,会/v,追踪/v,他/r,。/w,这/r,一切/r,都/d,很/d,好/a,，/w,但是/c,如果/c,我们/r,在/p,真实/a,的/u,人/n,脸上/s,启用/v,面部/n,跟踪/v,会/v,发生/v,什么/r,呢/y,?/w,如下/v,图/n,，/w,面部/n,追踪器/nw,和/c,角度/n,探测器/n,正在/d,追踪/v,人/n,的/u,面部/n,。/w,当/p,我们/r,把/p,头/n,从/p,一边/d,移/v,到/v,另/r,一边/d,时/ng,，/w,面部/n,追踪器/nw,会/v,跟踪/v,这个/r,动作/n,，/w,可以/v,看到/v,角度/n,探测器/n,会/v,根据/p,它/r,所/u,识别/v,的/u,面部/n,水平/n,角度/n,进行/v,调整/vn,。/w,可以/v,看到/v,，/w,在/p,这里/r,我们/r,的/u,颜色/n,是/v,黑白/b,的/u,，/w,而/c,不/d,是/v,彩色/b,的/u,。/w,因为/c,这/r,是/v,一个/m,直方图/n,的/u,反向/f,投影/vn,，/w,而且/c,它/r,是/v,一个/m,可以/v,更改/v,的/u,选项/v,。/w,即使/c,我们/r,远离/v,摄像机/n,，/w,让/v,其他/r,物体/n,也/d,进入/v,视野/n,中/f,，/w,面部/n,追踪器/nw,也/d,能/v,在/p,诸多/m,噪音/n,中/f,跟踪/v,我们/r,的/u,脸/n,，/w,如/v,下/f,图/n,所/u,示/vg,。/w,这/r,正是/v,我们/r,在/p,电影/n,中/f,看到/v,的/u,面部/n,识别/v,系统/n,的/u,工作/vn,原理/n,，/w,尽管/c,它/r,更为/d,先进/a,。/w,现在/t,让/v,我们/r,深入/v,程序/n,内部/f,，/w,看看/v,它/r,到底/d,是/v,如何/r,工作/vn,的/u,。/w,首先/d,，/w,我们/r,需要/v,问/v,自己/r,一个/m,问题/n,，/w,我们/r,想/v,要/v,解决/v,的/u,问题/n,到底/d,是/v,什么/r,。/w,到底/d,是/v,人脸/n,识别/v,还是/c,人脸/n,检测/vn,。/w,这里/r,不得不/d,提到/v,viola/en,-/w,jones/en,算法/n,，/w,因为/c,，/w,首先/d,它/r,有/v,很/d,高/a,的/u,检出率/nw,和/c,很/d,低/a,的/u,误报率/n,，/w,然后/c,它/r,非常/d,擅长/v,对/p,数据/n,的/u,实时/n,处理/v,，/w,最终/d,要/v,的/u,一点/m,是/v,，/w,它/r,非常/d,善于/v,从/p,非人/b,脸/n,中/f,分别/d,出/v,人脸/n,。/w,要/v,永远/d,记住/v,，/w,人脸/n,检测/vn,只是/d,人脸/n,识别/v,的/u,第一/m,步/q,!/w,这个/r,算法/n,要求/v,输入/v,一个/m,完整/a,的/u,正面/d,，/w,垂直/v,的/u,脸/n,。/w,脸部/n,需要/v,直接/ad,指向/vn,采集/v,设备/n,，/w,头部/n,尽量/d,不要/d,歪/v,，/w,不要/d,昂头/nr,或/c,低头/v,。/w,这里/r,有/v,必要/a,在/p,强调/v,一次/mq,，/w,我们/r,要/v,做/v,的/u,只是/d,在/p,图像/n,中/f,检测/vn,出/v,人脸/n,即可/v,。/w,我们/r,的/u,算法/n,需要/v,经过/p,四个/m,步骤/n,来/v,完成/v,这/r,件/q,事/n,：/w,haar/en, ,特征/n,选择/v,创建/v,一个/m,完整/a,的/u,图像/n,adaboost/en,算法/n,(/w,通过/p,迭代/vn,弱/a,分类器/nw,而/c,产生/v,最终/d,的/u,强/a,分类器/nw,的/u,算法/n,)/w, ,训练/vn,分类/vn,器级/nw,联/vg,分类器/nw,在/p,正式/ad,开始/v,之前/f,，/w,让/v,我们/r,先/d,捋/v,一/m,捋/v,面部/n,检测/vn,到底/d,是/v,如果/c,工作/vn,的/u,。/w,所有/b,的/u,脸/n,，/w,无论/c,是/v,人/n,的/u,，/w,动物/n,的/u,还是/c,其他/r,的/u,，/w,都/d,有/v,一些/m,相似/a,的/u,特征/n,。/w,例如/v,，/w,都/d,有/v,一个/m,鼻子/n,，/w,两个/m,鼻孔/n,，/w,一张/mq,嘴巴/n,，/w,两个/m,眼睛/n,，/w,两个/m,耳朵/n,等等/u,。/w,我们/r,的/u,算法/n,通过/p,haar/en,特征/n,来/v,匹配/vn,这些/r,内容/n,，/w,我们/r,可以/v,通过/p,其中/r,任/v,一项/mq,找到/v,其他/r,的/u,特征/n,。/w,但是/c,，/w,我们/r,这里/r,会/v,遇到/v,一个/m,问题/n,。/w,在/p,一个/m,24/m,x/en,24/m,像素/n,的/u,窗口/s,中/f,，/w,一共/d,有/v,162336个/m,可能/v,的/u,特征/n,。/w,如果/c,这个/r,计算/v,结果/n,是/v,正确/a,的/u,，/w,那么/r,计算/v,他们/r,的/u,时间/n,和/c,成本/n,将/d,非常/d,之/u,高/a,。/w,因此/c,，/w,我们/r,将/d,会/v,使用/v,一种/mq,被/p,称为/v,adaptive/en, ,boosting/en,（/w,自/p,适应/v,提升/v,法/j,）/w,的/u,算法/n,，/w,或者/c,更为/d,常见/a,的/u,adaboost/en,算法/n,。/w,如果/c,你/r,研究/vn,过/u,机器/n,学习/v,，/w,我/r,相信/v,你/r,听说/v,过/u,一种/mq,叫做/v,boosting/en,（/w,提升/v,）/w,的/u,技术/n,。/w,我们/r,的/u,学习/v,算法/n,将/d,使用/v,adaboost/en,来/v,选择/v,最/d,好/a,的/u,特征/n,并/c,训练/vn,分类器/nw,来/v,使用/v,它们/r,。/w,adaboost/en,可以/v,与/p,许多/m,类型/n,的/u,学习/v,算法/n,一起/s,使用/v,，/w,并且/c,被/p,业界/n,认为/v,是/v,许多/m,需要/v,增强/v,的/u,任务/n,的/u,最佳/z,开箱/v,即/v,用/p,算法/n,。/w,通常/d,在/p,切换/vn,到/v,另/r,一种/mq,算法/n,并/c,对/p,其/r,进行/v,基准/n,测试/vn,之前/f,，/w,您/r,不/d,会/v,注意/v,到/v,它/r,有/v,多/a,好/a,和/c,多/a,快/a,。/w,实际上/d,这种/r,区别/n,是/v,非常/d,明显/a,的/u,。/w,在/p,继续/v,之前/f,，/w,我们/r,先/d,来/v,了解/v,一下/m,什么/r,是/v,boosting/en,（/w,提升/v,）/w,技术/n,。/w,boosting/en,从/p,其他/r,弱/a,学习/v,算法/n,中/f,获取/v,输出/v,，/w,并/c,将/d,其/r,与/p,weighted/en, ,sum/en,（/w,加权/v,和/c,）/w,结合/v,，/w,加权/v,和/c,是/v,boost/en,分类器/nw,的/u,最终/d,输出/v,。/w,adaboost/en,的/u,自/p,适应/v,部分/n,来自/v,于/p,这样/r,一个/m,事实/n,，/w,即/v,后续/vn,的/u,学习者/n,被/p,调整/vn,，/w,以/p,支持/v,那些/r,被/p,以前/f,的/u,分类器/nw,错误/n,分类/vn,的/u,实例/n,。/w,与/p,其他/r,算法/n,相比/v,，/w,该/r,算法/n,更/d,倾向/n,于/p,对/p,数据/n,进行/v,过/u,拟合/nz,，/w,所以/c,adaboost/en,对/p,噪声/n,数据/n,和/c,异常/a,值/n,很/d,敏感/a,。/w,因此/c,我们/r,在/p,准备/v,数据/n,的/u,时候/n,，/w,需要/v,格外/d,注意/v,这/r,一点/m,。/w,现在/t,，/w,让/v,我们/r,来/v,看看/v,示例/n,中/f,的/u,程序/n,到底/d,是/v,如何/r,工作/vn,的/u,。/w,对于/p,这个/r,示例/n,，/w,我们/r,将/d,再次/d,使用/v,accord/en,框架/n,。/w,首先/d,创建/v,一个/m,facehaarcascade/en,对象/n,。/w,该/r,对象/n,包含/v,一系列/mq, ,haarlike/en, ,的/u,特征/n,的/u,弱/a,分类/vn,阶段/n,的/u,集合/v,。/w,每个/r,阶段/n,都/d,包含/v,一组/mq,分类/vn,器树/nw,,/w, ,这些/r,分类/vn,器树/nw,将/d,在/p,决策/n,过程/n,中/f,使用/v,。/w,facehaarcascade/en,自动/d,为/p,我们/r,创建/v,了/u,所有/b,这些/r,阶段/n,和/c,树/v,，/w,而/c,不/d,需要/v,我们/r,去/v,关心/v,具体/a,实现/v,的/u,细节/n,。/w,首先/d,，/w,需要/v,在/p,底层/n,构建/v,一个/m,决策/n,树/v,，/w,它/r,将/d,为/p,每个/r,阶段/n,提供/v,节点/n,，/w,并/c,为/p,每个/r,特性/n,提供/v,数值/n,。/w,以下/f,是/v,accord/en,的/u,部分/n,源码/nw,。/w,list/en,</w,haarcascadestage/en,>, ,stages/en, ,=/w, ,new/en, ,list/en,</w,haarcascadestage/en,>,(/w,)/w,;/w, ,list/en,</w,haarfeaturenode/en,[/w,]/w,>, ,nodes/en,;/w, ,haarcascadestage/en, ,stage/en,;/w, ,stage/en, ,=/w, ,new/en, ,haarcascadestage/en,(/w,0.822689414024353/m,)/w,;/w, ,nodes/en, ,=/w, ,new/en, ,list/en,</w,haarfeaturenode/en,[/w,]/w,>,(/w,)/w,;/w, ,nodes/en,./w,add/en,(/w, ,new/en,[/w,]/w, ,{/w, ,new/en, ,haarfeaturenode/en,(/w, ,0.004014195874333382/m,,/w,0.0337941907346249/m,,/w, ,0.8378106951713562/m,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,3/m,,/w, ,7/m,,/w, ,14/m,,/w, ,4/m,,/w, ,-/w,1/m, ,}/w,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,3/m,,/w, ,9/m,,/w, ,14/m,,/w, ,2/m,,/w, ,2/m, ,}/w, ,)/w, ,}/w, ,)/w,;/w, ,nodes/en,./w,add/en,(/w, ,new/en,[/w,]/w, ,{/w, ,new/en, ,haarfeaturenode/en,(/w, ,0.0151513395830989/m,,/w, ,0.1514132022857666/m,,/w, ,0.7488812208175659/m,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,1/m,,/w, ,2/m,,/w, ,18/m,,/w, ,4/m,,/w, ,-/w,1/m, ,}/w,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,7/m,,/w, ,2/m,,/w, ,6/m,,/w, ,4/m,,/w, ,3/m, ,}/w, ,)/w, ,}/w, ,)/w,;/w, ,nodes/en,./w,add/en,(/w, ,new/en,[/w,]/w, ,{/w, ,new/en, ,haarfeaturenode/en,(/w, ,0.004210993181914091/m,,/w, ,0.0900492817163467/m,,/w, ,0.6374819874763489/m,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,1/m,,/w, ,7/m,,/w, ,15/m,,/w, ,9/m,,/w, ,-/w,1/m, ,}/w,,/w, ,new/en, ,int/en,[/w,]/w, ,{/w, ,1/m,,/w, ,10/m,,/w, ,15/m,,/w, ,3/m,,/w, ,3/m, ,}/w, ,)/w, ,}/w, ,)/w,;/w,一旦/d,构建/v,完成/v,，/w,我们/r,就/d,可以/v,使用/v,cascade/en,对象/n,来/v,创建/v,haarobjectdetector/en,，/w,这/r,就是/d,我们/r,将/d,用于/v,检测/vn,的/u,对象/n,。/w,接下来/l,我们/r,需要/v,提供/v,:/w,我们/r,的/u,面/q,部级/b,联/vg,对象/n,搜索/vn,对象/n,时/ng,使用/v,的/u,最/d,小/a,窗口/s,大小/n,我们/r,的/u,搜索/vn,模式/n,，/w,假设/v,我们/r,只/d,搜索/vn,一个/m,对象/n,在/p,搜索/vn,期间/f,重新/d,缩放/v,搜索/vn,窗口/s,时/ng,要/v,使用/v,的/u,重新/d,缩放/v,因子/n,haarcascade/en, ,cascade/en, ,=/w, ,new/en, ,facehaarcascade/en,(/w,)/w,;/w, ,detector/en, ,=/w, ,new/en, ,haarobjectdetector/en,(/w,cascade/en,,/w,25/m,,/w, ,　,　,objectdetectorsearchmode/en,./w,single/en,,/w,1.2/m,f/en,,/w, ,　,　,objectdetectorscalingmode/en,./w,greatertosmaller/en,)/w,;/w,现在/t,，/w,我们/r,需要/v,准备/v,数据/n,，/w,在/p,本/r,示例/n,中/f,，/w,我们/r,将/d,使用/v,笔记本/n,电脑/n,上/f,的/u,摄像头/n,捕获/v,所有/b,图像/n,。/w,然而/c,，/w,accord/en,./w,net/en, ,framework/en, ,使得/v,使用/v,其他/r,源/ng,进行/v,数据/n,采集/v,变/v,得/u,很/d,容易/a,。/w,例如/v, ,avi/en,文件/n,，/w,jpg/en,文件/n,等等/u,。/w,接下来/l,，/w,连接/v,摄像头/n,，/w,选择/v,分辨率/n,：/w,//w,//w, ,创建/v,视频/n,源/ng, ,videocapturedevice/en, ,videosource/en, ,=/w, ,new/en, ,videocapturedevice/en,(/w,form/en,./w,videodevice/en,)/w,;/w, ,//w,//w, ,设置/v,帧/q,的/u,大小/n, ,videosource/en,./w,videoresolution/en, ,=/w, ,selectresolution/en,(/w,videosource/en,)/w,;/w, ,//w,//w,//w, ,</w,summary/en,>, ,//w,//w,//w, ,获取/v,帧/q,的/u,大小/n, ,//w,//w,//w, ,</w,//w,summary/en,>, ,//w,//w,//w, ,</w,param/en, ,name/en,=/w,"/w,videosource/en,"/w,>,视频/n,源/ng,</w,//w,param/en,>, ,//w,//w,//w, ,</w,returns/en,>,帧/q,的/u,大小/n,</w,//w,returns/en,>, ,private/en, ,videocapabilities/en, ,selectresolution/en,(/w,videocapturedevice/en, ,videosource/en,)/w, ,{/w, ,foreach/en, ,(/w,var/en, ,cap/en, ,in/en, ,videosource/en,?/w