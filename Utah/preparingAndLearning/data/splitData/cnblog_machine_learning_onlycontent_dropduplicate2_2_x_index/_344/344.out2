先/d,从/p,一本/mq,书/n,说/v,起/v,吧/y,----/nrf,《/w,机器/n,学习/v,实战/n,》/w,作者/n,在/p,书/n,中/f,讲/v,到/v,逻辑/n,回归/v,的/u,时候/n,，/w,用/p,简短/a,的/u,语言/n,介绍/v,了/u,一下/m,理论/n,之后/f,，/w,就/d,给/p,出/v,了/u,一段/mq,代码/n,。/w,然而/c,就/d,是/v,这/r,段/q,代码/n,把/p,我/r,带/v,进/v,了/u,误区/n,，/w,也许/d,不/d,能/v,叫/v,误区/n,，/w,而是/c,因为/c,我/r,自己/r,的/u,水平/n,不够/a,。/w,后来/t,在/p,查阅/v,资料/n,的/u,时候/n,，/w,发现/v,有/v,人/n,也/d,因为/c,这个/r,问题/n,纠结/v,了/u,好久/m,。/w,也许/d,这/r,本书/r,是/v,写/v,给/p,一些/m,有/v,经验/n,的/u,人员/n,看/v,的/u,，/w,不/d,是/v,特别/d,适合/v,作为/v,入门/v,的/u,书/n,。/w,在/p,查找/v,关于/p,逻辑/n,回归/v,相关/v,资料/n,的/u,时候/n,，/w,发现/v,大多数/m,都/d,是/v,介绍/v,了/u,好多/m,数学/n,公式/n,，/w,所以/c,我/r,一直/d,都/d,在/p,理解/v,数学/n,公式/n,的/u,基础/n,上/f,同时/c,试图/v,在/p,脑海/n,中/f,演练/vn,该/r,如何/r,编程/vn,实现/v,它/r,，/w,然后/c,再/d,对照/v,上面/f,提到/v,的/u,书/n,中/f,的/u,代码/n,，/w,然后/c,悲哀/an,的/u,发现/v,了解/v,不/d,了/u,。/w,并且/c,，/w,查/v,到/v,的/u,大多数/m,资料/n,上/f,并/c,没有/v,详细/ad,的/u,代码/n,实现/v,，/w,如果/c,有/v,，/w,也/d,是/v,跟/p,书/n,上/f,的/u,代码/n,是/v,一样/u,的/u,。/w,最后/f,，/w,从/p,网上/s,找到/v,书/n,中/f,使用/v,的/u,测试/vn,数据/n,，/w,跟踪/v,打印/v,代码/n,中/f,的/u,每个/r,变量/n,，/w,才/d,理解/v,了/u,书/n,中/f,第一/m,段/q,代码/n,的/u,求解/v,原理/n,，/w,进而/c,理解/v,了/u,后面/f,一些/m,代码/n,的/u,原理/n,。/w,现在/t,回过/v,头/n,想想/v,确实/ad,比较/d,简单/a,，/w,但是/c,这个/r,简单/a,是/v,有/v,一个/m,前提/n,的/u,：/w,书/n,上/f,的/u,代码/n,或者/c,资料/n,中/f,推导/vn,出/v,的/u,的/u,公式/n,或者/c,我/r,自己/r,的/u,理解/v,，/w,这/r,三者/r,之间/f,必须/d,是/v,有/v,一个/m,错误/n,的/u,。/w,并且/c,在/p,这个/r,过程/n,中/f,，/w,我/r,一直/d,试图/v,绕过/v,那么/r,多/a,数学/n,公式/n,和/c,一堆/mq,概念/n,，/w,但是/c,发现/v,很/d,难/a,，/w,所以/c,我/r,按照/p,自己/r,的/u,理解/v,剔除/v,掉/v,一些/m,无用/v,的/u,数学/n,公式/n,和/c,概念/n,，/w,力求/v,用/p,最/d,少/a,的/u,理论/n,解释/v,清楚/a,什么/r,是/v,逻辑/n,回归/v,。/w,1/m,./w,逻辑/n,回归/v,的/u,定义/n,1/m,）/w,有/v,一种/mq,定义/n,是/v,这样/r,的/u,：/w,逻辑/n,回归/v,其实/d,是/v,一个/m,线性/n,分类器/nw,，/w,只是/d,在/p,外面/f,嵌/v,套/q,了/u,一个/m,逻辑/n,函数/n,，/w,主要/b,用于/v,二/m,分类/vn,问题/n,。/w,这个/r,定义/n,明确/ad,的/u,指明/v,了/u,逻辑/n,回归/v,的/u,特点/n,：/w,a/en,）/w, ,一个/m,线性/n,分类器/nw,b/en,）/w,外层/n,有/v,一个/m,逻辑/n,函数/n,2/m,）/w,假设/v,有/v,一个/m,线性/n,函数/n,z/en,，/w,其/r,一般/a,公式/n,为/p,：/w,(/w,公式/n,一/m,)/w,转换/v,成/v,求/v,和/c,公式/n,：/w,（/w,公式/n,二/m,）/w,转化/v,成/v,向/p,量/n,的/u,形式/n,：/w,（/w,公式/n,三/m,）/w,3/m,）/w,逻辑/n,函数/n,(/w,也/d,叫/v,sigmoid/en,函数/n,)/w,基本上/d,采用/v,的/u,都/d,是/v,下面/f,这个/r,函数/n,：/w,(/w,公式/n,四/m,)/w,这个/r,函数/n,的/u,作用/n,就/d,是/v,把/p,无限/vd,大/a,或者/c,无限/vd,小/a,的/u,数据/n,压缩/v,到/v,[/w,0/m,,/w,1/m,]/w,之间/f,，/w,用/p,来/v,估计/v,概率/n,。/w,图像/n,大致/d,为/p,：/w,基本上/d,是/v,以/p,0.5/m,分界/v,，/w,0.5/m,以上/f,为/p,1/m,，/w,0.5/m,以下/f,为/p,0/m,。/w,但是/c,这个/r,分界/v,值/n,可以/v,自己/r,设定/v,。/w,4/m,）/w,逻辑/n,回归/v,函数/n,综合/vn,公式/n,四/m,和/c,公式/n,一/m,或者/c,公式/n,四/m,和/c,公式/n,三/m,，/w,即可/v,得到/v,逻辑/n,回归/v,函数/n,：/w,（/w,公式/n,五/m,）/w,或者/c,（/w,公式/n,六/m,）/w,其实/d,，/w,如果/c,编程/vn,求解/v,的话/u,，/w,到/v,这里/r,基本/a,就/d,可以/v,了/u,。/w,但是/c,既然/c,都/d,提到/v,了/u,最大/a,似然/nw,估计/v,，/w,那/r,我们/r,也/d,说/v,下/f,。/w,2/m,./w,最大/a,似然/nw,估计/v,最/d,大/a,似然/nw,估计/v,是/v,建立/v,在/p,这样/r,的/u,思想/n,上/f,：/w,已知/nz,某个/r,参数/n,能/v,使/v,这个/r,样本/n,出现/v,的/u,概率/n,最/d,大/a,，/w,我们/r,当然/d,不/d,会/v,再/d,去/v,选择/v,其他/r,小/a,概率/n,的/u,样本/n,，/w,所以/c,干脆/d,就/d,把/p,这个/r,参数/n,作为/v,估计/v,的/u,真实值/nw,。/w,换句话说/c,就/d,是/v,：/w,既然/c,我们/r,无法/v,知道/v,真实值/nw,，/w,那么/r,就/d,把/p,这个/r,当作/v,真实值/nw,吧/y,！/w,其/r,唯一/b,的/u,作用/n,就/d,是/v,给/p,这个/r,算法/n,找/v,一个/m,说/v,的/u,过去/t,的/u,理论/n,基础/n,，/w,然后/c,在/p,这个/r,基础/n,上/f,推导/vn,出/v,最/d,大/a,似然/nw,函数/n,，/w,接着/c,构建/v,损失/n,函数/n,。/w,这/r,对于/p,非/h,数学/n,专业/n,的/u,人/n,来说/u,，/w,用途/n,并/c,不/d,大/a,，/w,有时候/d,甚至/d,会/v,造成/v,理解/v,上/f,的/u,困难/an,，/w,进而/c,变成/v,学习/v,的/u,阻碍/v,。/w,其实/d,，/w,我们/r,完全/ad,可以/v,绕过/v,这个/r,阻碍/v,，/w,只/d,去/v,关注/v,最后/f,的/u,结果/n,。/w,补充/v,说明/v,：/w,如果/c,想/v,要/v,理解/v,推导/vn,过程/n,，/w,可以/v,先/d,看看/v,最/d,大/a,似然/nw,估计/v,思想/n,，/w,然后/c,也/d,要/v,理解/v,联合/v,概率/n,。/w,因为/c,有些/r,讲/v,逻辑/n,回归/v,的/u,文章/n,会/v,直接/ad,跳出/v,最/d,大/a,似然/nw,估计/v,的/u,函数/n,，/w,如果/c,不/d,了解/v,这/r,两点/mq,内容/n,容易/a,抓/v,瞎/v,。/w,3/m,./w,求解/v,方式/n,1/m,）/w,使用/v,梯度/n,下降/v,法/j,求/v,解/v,经过/p,一系列/mq,推导/vn,之后/f,，/w,得出/v,梯度/n,下降/v,法/j,求/v,解/v,的/u,核心/n,公式/n,，/w,即/v,权重/nz,的/u,更新/v,方式/n,：/w,（/w,公式/n,七/m,）/w,需要/v,说明/v,的/u,是/v,：/w,α,表示/v,下降/v,的/u,步长/nz,，/w,可以/v,自己/r,指定/v,。/w,h/en,θ, ,表示/v,损失/n,函数/n,或者/c,惩罚/vn,系数/n,。/w,如果/c,h/en,θ, ,表示/v,惩罚/vn,系数/n,，/w,那么/r,如何/r,求/v,的/u,这/r,组/q,系数/n,才/d,是/v,整个/b,逻辑/n,回归/v,算法/n,的/u,重点/n,。/w,在/p,开始/v,写/v,代码/n,前/f,，/w,再/d,介绍/v,另外/c,一个/m,求解/v,方式/n,：/w,向/p,量化/v,2/m,）/w,向/p,量化/v,向/p,量化/v,是/v,使用/v,矩阵/n,计算/v,来/v,代替/v,for/en,循环/vn,，/w,以/p,简化/v,计算/v,过程/n,，/w,提高/v,效率/n,。/w,(/w,下面/f,引用/v,下/f,其他/r,文章/n,的/u,讲解/v,：/w,出现/v,的/u,地方/n,太/d,多/a,不/d,知道/v,哪个/r,是/v,原作者/nw,，/w,见谅/v,)/w,向/p,量化/v,过程/n,：/w,约定/vn,训练/vn,数据/n,的/u,矩阵/n,形式/n,如下/v,，/w,x/en,的/u,每/r,一行/n,为/p,一条/mq,训练/vn,样本/n,，/w,而/c,每/r,一/m,列为/v,不同/a,的/u,特称/nw,取值/v,：/w,g/en,(/w,a/en,)/w,的/u,参数/n,a/en,为/p,一列/mq,向/p,量/n,，/w,所以/c,实现/v,g/en,函数/n,时/ng,要/v,支持/v,列向量/nw,作为/v,参数/n,，/w,并/c,返回/v,列向量/nw,。/w,θ,更新/v,过程/n,可以/v,改/v,为/p,：/w,综上所述/c,，/w,向/p,量化/v,后/f,θ,更新/v,的/u,步骤/n,如下/v,：/w,a/en,)/w,求/v, ,a/en,=/w,x/en,*/w,θ,b/en,)/w,求/v, ,e/en,=/w,g/en,(/w,a/en,)/w,-/w,yc/en,)/w,求/v,4/m,./w,实现/v,过程/n,(/w,下面/f,的/u,代码/n,实现/v,的/u,是/v,梯度/n,上升/v,法/j,，/w,其/r,跟/p,梯度/n,下降/v,法/j,的/u,唯一/b,区别/n,就/d,是/v,和/c,之间/f,的/u,减号/n,变成/v,了/u,加号/n,，/w,前者/r,求/v,最大值/nz,，/w,后者/r,求/v,最小值/nz,)/w,代码/n,基本/a,脱胎/vn,于/p,《/w,机器/n,学习/v,实战/n,》/w,这/r,本/r,书/n,，/w,但是/c,有/v,改动/v,。/w,1/m,）/w,普通/a,的/u,梯度/n,上升/v,法/j,下面/f,这/r,段/q,代码/n,，/w,也/d,就/d,是/v,开头/n,提到/v,的/u,那个/r,造成/v,误解/v,的/u,代码/n,，/w,其/r,实现/v,依据/n,是/v,向/p,量化/v,求解/v,，/w,并/c,不/d,是/v,根据/p,公式/n,七/m,来/v,的/u,，/w,所以/c,如果/c,对照/v,公式/n,七/m,理解/v,这/r,段代码会/nt,完全/ad,摸/v,不/d,着/u,头脑/n,。/w,如果/c,对照/v,向/p,量化/v,后/f,θ,(/w,也/d,就/d,是/v,权重/nz,)/w,的/u,更新/v,步骤/n,会/v,很/d,容易/a,理解/v,。/w,'/w,'/w,'/w, ,普通/a,的/u,梯度/n,上升/v,法/j, ,'/w,'/w,'/w, ,import/en, ,numpy/en, ,as/en, ,np/en, ,import/en, ,os/en, ,import/en, ,pandas/en, ,as/en, ,pd/en, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,#,#,运行/vn,脚本/n,所/u,在/p,目录/n, ,base/en,_,dir/en,=/w,os/en,./w,getcwd/en,(/w,)/w, ,#,#,记得/v,添加/vn,header/en,=/w,none/en,，/w,否则/c,会/v,把/p,第一/m,行/v,当作/v,头/n, ,data/en,=/w,pd/en,./w,read/en,_,table/en,(/w,base/en,_,dir/en,+/w,r/en,"/w,\/w,lr/en,./w,txt/en,"/w,,/w,header/en,=/w,none/en,)/w, ,#,#,datalen/en,行/v,datawid/en,列/v, ,：/w,返回/v,值/n,是/v,datalen/en,=/w,100/m, ,datawid/en,=/w,3/m, ,datalen/en,,/w,datawid/en, ,=/w, ,data/en,./w,shape/en, ,#,#,训练/vn,数据/n,集/vg, ,xlist/en, ,=/w, ,[/w,]/w, ,#,#,标签/n,数据/n,集/vg, ,lables/en, ,=/w, ,[/w,]/w, ,#,#,读/v,取/v,数据/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,datalen/en,)/w,:/w, ,row/en, ,=/w, ,data/en,./w,values/en,[/w,i/en,]/w, ,xlist/en,./w,append/en,(/w,row/en,[/w,0/m,:/w,datawid/en,-/w,1/m,]/w,)/w, ,lables/en,./w,append/en,(/w,row/en,[/w,-/w,1/m,]/w,)/w, ,return/en, ,xlist/en,,/w,lables/en, ,#,#,逻辑/n,函数/n, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,np/en,./w,exp/en,(/w,-/w,inx/en,)/w,)/w, ,#,#,梯度/n,上升/v,函数/n, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w,classlables/en,)/w,:/w, ,#,#,把/p,datamatin/en,从/p,列表/v,转换/v,成/v,矩阵/n, ,datamatrix/en, ,=/w, ,np/en,./w,mat/en,(/w,datamatin/en,)/w, ,#,#,把/p,列表/v,转换/v,成/v,100行/mq,1列/mq,的/u,矩阵/n,，/w,而/c,np/en,./w,mat/en,(/w,classlables/en,)/w,是/v,转换/v,成/v,1行/mq,100列/mq,的/u,矩阵/n, ,labelmat/en, ,=/w, ,np/en,./w,mat/en,(/w,classlables/en,)/w,./w,transpose/en,(/w,)/w, ,#,#,求/v,矩阵/n,的/u,长宽/v, ,m/en,,/w,n/en, ,=/w, ,np/en,./w,shape/en,(/w,datamatrix/en,)/w, ,#,#,步长/nz,，/w,可以/v,自己/r,设置/v, ,alpha/en, ,=/w, ,0.001/m, ,#,#,最/d,大/a,循环/vn,次数/n, ,maxtry/en, ,=/w, ,500/m, ,#,#,初始化/v,向量/n,：/w,2行/mq,1列/mq,的/u,矩阵/n, ,weights/en, ,=/w,np/en,./w,ones/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,#,#,循环/vn,一定/d,次数/n,，/w,求/v,权重/nz, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxtry/en,)/w,:/w, ,#,#,datamatrix/en, ,100行/mq,2列/mq, ,weights/en,是/v,2行/mq,1列/mq, ,#,#,h/en,是/v,100行/mq,1列/mq, ,h/en, ,=/w, ,sigmoid/en,(/w,datamatrix/en,*/w,weights/en,)/w, ,#,#,向量/n,的/u,偏差/n, ,error/en, ,=/w, ,(/w,labelmat/en, ,-/w, ,h/en,)/w, ,#,#,datamatrix/en,./w,transpose/en,(/w,)/w, ,转换/v,成/v,2行/mq,100列/mq,的/u,矩阵/n, ,#,#,error/en, ,是/v,100行/mq,1列/mq, ,#,#,weights/en,是/v,2行/mq,1列/mq,的/u,值/n, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en,*/w,datamatrix/en,./w,transpose/en,(/w,)/w,*/w,error/en, ,return/en, ,weights/en, ,'/w,'/w,'/w, ,结果/n,大于/nrf,0.3/m,的/u,设置/v,为/p,1/m,，/w,正确率/n,基本/a,100%/mq, ,'/w,'/w,'/w, ,def/en, ,getresult/en,(/w,)/w,:/w, ,datamat/en,,/w,labelmat/en,=/w,loaddataset/en,(/w,)/w, ,weights/en,=/w,gradascent/en,(/w,datamat/en,,/w,labelmat/en,)/w, ,datamatrix/en, ,=/w, ,np/en,./w,mat/en,(/w,datamat/en,)/w, ,#,#,求/v,的/u,最后/f,的/u,结果/n, ,h/en, ,=/w, ,sigmoid/en,(/w,datamatrix/en,*/w,weights/en,)/w, ,#,#,打印/v,结果/n,，/w,观察/v,数据/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,h/en,)/w,)/w,:/w, ,print/en,(/w,str/en,(/w,h/en,[/w,i/en,]/w,)/w,+/w,"/w,:/w,"/w,+/w,str/en,(/w,labelmat/en,[/w,i/en,]/w,)/w,)/w, ,#,print/en,(/w,h/en,)/w, ,#,print/en,(/w,weights/en,)/w, ,#,#,0.08108752/m, ,-/w,0.1233496/m, ,if/en, ,_,_,name/en,_,_,=/w,=/w,'/w,_,_,main/en,_,_,'/w,:/w, ,getresult/en,(/w,)/w,2/m,）/w,随机/d,梯度/n,上升/v,发/v,这个/r,算法/n,，/w,才/d,是/v,符合/v,公式/n,七/m,的/u,算法/n,，/w,但是/c,代码/n,中/f,并/c,没有/v,求和/vn,这/r,步/q,，/w,只有/c,括号/n,中/f,的/u,那/r,部分/n,，/w,这/r,也/d,是/v,我/r,开头/n,说/v,的/u,三者/r,之间/f,必/d,有/v,一个/m,错误/n,的/u,地方/n,。/w,只/d,包括/v,核心/n,部分/n,，/w,其他/r,部分/n,见/v,上/f,段/q,代码/n,'/w,'/w,'/w, ,结果/n,大于/nrf,0.29/m,或者/c,0.26/m,都/d,可以/v,，/w,也/d,只有/c,1/m,-/w,2个/m,分类/vn,错误/n, ,weights/en,:/w,[/w, ,0.0868611/m, ,-/w,0.13086297/m,]/w, ,'/w,'/w,'/w, ,#,#,随机/d,梯度/n,上升/v,算法/n, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w,classlables/en,)/w,:/w, ,m/en,,/w,n/en, ,=/w, ,np/en,./w,shape/en,(/w,datamatin/en,)/w, ,#,#,步长/nz,，/w,可以/v,自己/r,指定/v,，/w,决定/v,收敛/vn,速度/n, ,alpha/en, ,=/w, ,0.001/m, ,#,#,最/d,大/a,循环/vn,次数/n, ,maxtry/en, ,=/w, ,200/m, ,#,#,初始化权/nw,重/a,：/w,列表/v,而/c,不/d,是/v,矩阵/n, ,weights/en, ,=/w,np/en,./w,ones/en,(/w,n/en,)/w, ,#,#,循环/vn,求解/v,：/w,在/p,整个/b,数据/n,集/vg,上/f,循环/vn, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxtry/en,)/w,:/w, ,#,#,对/p,每行/nw,进行/v,处理/v, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,#,每行/nw,向/p,量化/v, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamatin/en,[/w,i/en,]/w,*/w,weights/en,)/w,)/w, ,#,#,每行/nw,向/p,量/n,偏差/n, ,error/en, ,=/w, ,(/w,classlables/en,[/w,i/en,]/w, ,-/w, ,h/en,)/w, ,#,#,更新/v,权重/nz, ,weights/en, ,=/w, ,weights/en, ,+/w,alpha/en,*/w,error/en,*/w,datamatin/en,[/w,i/en,]/w, ,return/en, ,weights/en, ,#,#,打印/v,结果/n, ,def/en, ,getresult/en,(/w,)/w,:/w, ,datamat/en,,/w,labelmat/en,=/w,loaddataset/en,(/w,)/w, ,weights/en,=/w,gradascent/en,(/w,datamat/en,,/w,labelmat/en,)/w, ,m/en,,/w,n/en, ,=/w, ,np/en,./w,shape/en,(/w,datamat/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamat/en,[/w,i/en,]/w,*/w,weights/en,)/w,)/w, ,print/en,(/w,str/en,(/w,h/en,)/w,+/w,"/w, ,:/w, ,"/w,+/w,str/en,(/w,labelmat/en,[/w,i/en,]/w,)/w,)/w, ,#,print/en,(/w,weights/en,)/w,3/m,）/w,改进/v,的/u,随机/d,梯度/n,上升/v,算/v,法书/n,中/f,还/d,讲/v,到/v,了/u,一个/m,改进/v,的/u,随机/d,梯度/n,上升/v,算法/n,。/w,#,#,随机/d,梯度/n,上升/v,函数/n, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w,classlables/en,)/w,:/w, ,m/en,,/w,n/en, ,=/w, ,np/en,./w,shape/en,(/w,datamatin/en,)/w, ,#,#,循环/vn,次数/n, ,maxtry/en, ,=/w, ,150/m, ,#,#,初始化权/nw,重/a,：/w,列表/v, ,weights/en, ,=/w,np/en,./w,ones/en,(/w,n/en,)/w, ,#,#,循环/vn,求解/v, ,for/en, ,j/en, ,in/en, ,range/en,(/w,maxtry/en,)/w,:/w, ,#,#,在/p,整个/b,数据/n,集/vg,上/f,循环/vn, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,#,跟/p,新/a,alpha/en,，/w,即/v,跟/p,新/a,步长/nz,值/n, ,alpha/en, ,=/w, ,4/m,//w,(/w,1.0/m,+/w,j/en,+/w,i/en,)/w,+/w,0.01/m, ,#,#,随机/d,抽取/vn,一个/m,下标/n, ,randindex/en, ,=/w, ,int/en,(/w,np/en,./w,random/en,./w,uniform/en,(/w,0/m,,/w,m/en,)/w,)/w, ,#,#,对/p,抽/v,到/v,下标/n,的/u,数据行/nw,进行/v,求/v,值/n, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamatin/en,[/w,randindex/en,]/w,*/w,weights/en,)/w,)/w, ,#,#,求得/v,误差/n,值/n, ,error/en, ,=/w, ,classlables/en,[/w,randindex/en,]/w, ,-/w, ,h/en, ,#,#,更新/v,权重/nz, ,weights/en, ,=/w, ,weights/en, ,+/w,alpha/en,*/w,error/en,*/w,datamatin/en,[/w,randindex/en,]/w, ,return/en, ,weights/en,该/r,算法/n,每次/r,都/d,会/v,调整/vn,步长/nz,值/n,，/w,即/v,缓解/v,了/u,随着/p,循环/vn,次数/n,的/u,增加/v,造成/v,的/u,特征/n,值/n,的/u,波动/vn,，/w,也/d,保证/v,了/u,当/p,j/en,</w,</w,max/en,(/w,i/en,)/w,时/ng,，/w,步长/nz,值/n,的/u,下降/v,不/d,是/v,严格/ad,下降/v,的/u,。/w,而/c,避免/v,参数/n,的/u,严格/ad,下降/v,在/p,优化/v,退火算法/nw,中/f,常常/d,用/p,到/v,。/w,5/m,./w,使用/v,sklearn/en,包/v,中/f,的/u,逻辑/n,回归/v,算法/n,(/w,非/h,完整/a,代码/n,，/w,缺少/v,部分/n,在/p,第一/m,个/q,代码/n,段/q,)/w,sklearn/en,包/v,中/f,的/u,logisticregression/en,函数/n,，/w,默认/v,使用/v,l/en,2/m,正则化/nw,防止/v,过度/d,拟合/nz,。/w,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,logisticregression/en, ,def/en, ,sk/en,_,lr/en,(/w,x/en,_,train/en,,/w,y/en,_,train/en,)/w,:/w, ,model/en, ,=/w, ,logisticregression/en,(/w,)/w, ,model/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,model/en,./w,score/en,(/w,x/en,_,train/en,,/w,y/en,_,train/en,)/w, ,#,print/en,(/w,'/w,权重/nz,'/w,,/w,model/en,./w,coef/en,_,)/w, ,return/en, ,model/en,./w,predict/en,(/w,x/en,_,train/en,)/w, ,#,#,分类/vn,错/n,了/u,2个/m, ,def/en, ,getresult/en,(/w,)/w,:/w, ,datamat/en,,/w,labelmat/en,=/w,loaddataset/en,(/w,)/w, ,pred/en, ,=/w, ,sk/en,_,lr/en,(/w,datamat/en,,/w,labelmat/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,pred/en,)/w,)/w,:/w, ,print/en,(/w,str/en,(/w,pred/en,[/w,i/en,]/w,)/w,+/w,"/w, ,:/w, ,"/w,+/w,str/en,(/w,labelmat/en,[/w,i/en,]/w,)/w,)/w, ,if/en, ,_,_,name/en,_,_,=/w,=/w,'/w,_,_,main/en,_,_,'/w,:/w, ,getresult/en,(/w,)/w,最后/f,得出/v,的/u,预测/v,结果/n,就/d,是/v,0/m,，/w,1/m,值/n,，/w,跟/p,标签/n,对比/v,，/w,有/v,两个/m,分类/vn,错/n,了/u,。/w,6/m,./w,逻辑/n,回归/v,优缺点/n,优点/n,：/w,计算/v,代价/n,不/d,高/a,，/w,易于/v,理解/v,和/c,实现/v,缺点/n,：/w,容易/a,欠/v,拟合/nz,，/w,分类/vn,精度/n,可能/v,不/d,高/a,适用/v,数据/n,类型/n,：/w,数值/n,型/k,和/c,标称型/nw,数据/n,附录/n,：/w,测试/vn,数据/n,-/w,0.017612/m, ,14.053064/m, ,0/m, ,-/w,1.395634/m, ,4.662541/m, ,1/m, ,-/w,0.752157/m, ,6.538620/m, ,0/m, ,-/w,1.322371/m, ,7.152853/m, ,0/m, ,0.423363/m, ,11.054677/m, ,0/m, ,0.406704/m, ,7.067335/m, ,1/m, ,0.667394/m, ,12.741452/m, ,0/m, ,-/w,2.460150/m, ,6.866805/m, ,1/m, ,0.569411/m, ,9.548755/m, ,0/m, ,-/w,0.026632/m, ,10.427743/m, ,0/m, ,0.850433/m, ,6.920334/m, ,1/m, ,1.347183/m, ,13.175500/m, ,0/m, ,1.176813/m, ,3.167020/m, ,1/m, ,-/w,1.781871/m, ,9.097953/m, ,0/m, ,-/w,0.566606/m, ,5.749003/m, ,1/m, ,0.931635/m, ,1.589505/m, ,1/m, ,-/w,0.024205/m, ,6.151823/m, ,1/m, ,-/w,0.036453/m, ,2.690988/m, ,1/m, ,-/w,0.196949/m, ,0.444165/m, ,1/m, ,1.014459/m, ,5.754399/m, ,1/m, ,1.985298/m, ,3.230619/m, ,1/m, ,-/w,1.693453/m, ,-/w,0.557540/m, ,1/m, ,-/w,0.576525/m, ,11.778922/m, ,0/m, ,-/w,0.346811/m, ,-/w,1.678730/m, ,1/m, ,-/w,2.124484/m, ,2.672471/m, ,1/m, ,1.217916/m, ,9.597015/m, ,0/m, ,-/w,0.733928/m, ,9.098687/m, ,0/m, ,-/w,3.642001/m, ,-/w,1.618087/m, ,1/m, ,0.315985/m, ,3.523953/m, ,1/m, ,1.416614/m, ,9.619232/m, ,0/m, ,-/w,0.386323/m, ,3.989286/m, ,1/m, ,0.556921/m, ,8.294984/m, ,1/m, ,1.224863/m, ,11.587360/m, ,0/m, ,-/w,1.347803/m, ,-/w,2.406051/m, ,1/m, ,1.196604/m, ,4.951851/m, ,1/m, ,0.275221/m, ,9.543647/m, ,0/m, ,0.470575/m, ,9.332488/m, ,0/m, ,-/w,1.889567/m, ,9.542662/m, ,0/m, ,-/w,1.527893/m, ,12.150579/m, ,0/m, ,-/w,1.185247/m, ,11.309318/m, ,0/m, ,-/w,0.445678/m, ,3.297303/m, ,1/m, ,1.042222/m, ,6.105155/m, ,1/m, ,-/w,0.618787/m, ,10.320986/m, ,0/m, ,1.152083/m, ,0.548467/m, ,1/m, ,0.828534/m, ,2.676045/m, ,1/m, ,-/w,1.237728/m, ,10.549033/m, ,0/m, ,-/w,0.683565/m, ,-/w,2.166125/m, ,1/m, ,0.229456/m, ,5.921938/m, ,1/m, ,-/w,0.959885/m, ,11.555336/m, ,0/m, ,0.492911/m, ,10.993324/m, ,0/m, ,0.184992/m, ,8.721488/m, ,0/m, ,-/w,0.355715/m, ,10.325976/m, ,0/m, ,-/w,0.397822/m, ,8.058397/m, ,0/m, ,0.824839/m, ,13.730343/m, ,0/m, ,1.507278/m, ,5.027866/m, ,1/m, ,0.099671/m, ,6.835839/m, ,1/m, ,-/w,0.344008/m, ,10.717485/m, ,0/m, ,1.785928/m, ,7.718645/m, ,1/m, ,-/w,0.918801/m, ,11.560217/m, ,0/m, ,-/w,0.364009/m, ,4.747300/m, ,1/m, ,-/w,0.841722/m, ,4.119083/m, ,1/m, ,0.490426/m, ,1.960539/m, ,1/m, ,-/w,0.007194/m, ,9.075792/m, ,0/m, ,0.356107/m, ,12.447863/m, ,0/m, ,0.342578/m, ,12.281162/m, ,0/m, ,-/w,0.810823/m, ,-/w,1.466018/m, ,1/m, ,2.530777/m, ,6.476801/m, ,1/m, ,1.296683/m, ,11.607559/m, ,0/m, ,0.475487/m, ,12.040035/m, ,0/m, ,-/w,0.783277/m, ,11.009725/m, ,0/m, ,0.074798/m, ,11.023650/m, ,0/m, ,-/w,1.337472/m, ,0.468339/m, ,1/m, ,-/w,0.102781/m, ,13.763651/m, ,0/m, ,-/w,0.147324/m, ,2.874846/m, ,1/m, ,0.518389/m, ,9.887035/m, ,0/m, ,1.015399/m, ,7.571882/m, ,0/m, ,-/w,1.658086/m, ,-/w,0.027255/m, ,1/m, ,1.319944/m, ,2.171228/m, ,1/m, ,2.056216/m, ,5.019981/m, ,1/m, ,-/w,0.851633/m, ,4.375691/m, ,1/m, ,-/w,1.510047/m, ,6.061992/m, ,0/m, ,-/w,1.076637/m, ,-/w,3.181888/m, ,1/m, ,1.821096/m, ,10.283990/m, ,0/m, ,3.010150/m, ,8.401766/m, ,1/m, ,-/w,1.099458/m, ,1.688274/m, ,1/m, ,-/w,0.834872/m, ,-/w,1.733869/m, ,1/m, ,-/w,0.846637/m, ,3.849075/m, ,1/m, ,1.400102/m, ,12.628781/m, ,0/m, ,1.752842/m, ,5.468166/m, ,1/m, ,0.078557/m, ,0