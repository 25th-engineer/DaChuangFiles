作者/n,：/w,datartisan/en,链接/n,：/w,https/en,:/w,//w,//w,zhuanlan/en,./w,zhihu/en,./w,com/en,//w,p/en,//w,22833471/m,来源/n,：/w,知乎/nw,著作权/n,归/v,作者/n,所有/b,。/w,商业/n,转载/v,请/v,联系/v,作者/n,获得/v,授权/v,，/w,非/h,商业/n,转载/v,请/v,注明/v,出处/n,。/w,每个/r,数据科学家/nw,每天/r,都/d,要/v,处理/v,成/v,吨/q,的/u,数据/n,，/w,而/c,他们/r,60%/mq,~/w,70%/mq,的/u,时间/n,都/d,在/p,进行/v,数据/n,清洗/vn,和/c,数据/n,格式/n,调整/vn,，/w,将/d,原始/a,数据/n,转变/v,为/p,可以/v,用/p,机器/n,学习/v,所/u,识别/v,的/u,形式/n,。/w,本文/r,主要/b,集中/v,在/p,数据/n,清洗/vn,后/f,的/u,过程/n,，/w,也/d,就/d,是/v,机器/n,学习/v,的/u,通用/vn,框架/n,。/w,这个/r,框架/n,是/v,我/r,在/p,参加/v,了/u,百/m,余/m,场/q,机器/n,学习/v,竞赛/vn,后/f,的/u,一个/m,总结/v,。/w,尽管/c,这个/r,框架/n,是/v,非常/d,笼统/a,和/c,概括/v,的/u,，/w,但是/c,绝对/d,能/v,发挥/v,强大/a,的/u,作用/n,，/w,仍然/d,可以/v,在/p,专业/n,人员/n,的/u,运用/v,下/f,变成/v,复杂/a,、/w,高效/b,的/u,方法/n,。/w,整个/b,过程/n,使用/v,python/en,来/v,实现/v,。/w,数据/n,在/p,用/p,机器/n,学习/v,的/u,方法/n,之前/f,，/w,我们/r,应该/v,先/d,把/p,数据/n,转变/v,为/p,表格/n,的/u,形式/n,，/w,这个/r,过程/n,是/v,最/d,耗时/v,、/w,最/d,复杂/a,的/u,。/w,我们/r,用/p,下/f,图/n,来/v,表示/v,这/r,一/m,过程/n,。/w,这/r,一/m,过程/n,也/d,就是/d,将/d,原始/a,数据/n,的/u,所有/b,的/u,变量/n,量化/v,，/w,进一步/d,转变/v,为/p,含/v,数据/n,（/w,data/en,）/w,和/c,标签/n,（/w,labels/en,）/w,的/u,数据框/nw,形式/n,。/w,这样/r,处理/v,过/u,的/u,数据/n,就/d,可以/v,用/p,来/v,机器/n,学习/v,建模/vn,了/u,。/w,数据框/nw,形式/n,的/u,数据/n,是/v,机器/n,学习/v,和/c,数据/n,挖掘/v,中/f,最为/d,通用/vn,的/u,数据/n,表现/v,形式/n,，/w,它/r,的/u,行/v,是/v,数据/n,抽样/vn,得到/v,的/u,样本/n,，/w,列/v,代表/n,数据/n,的/u,标签/n,y/en,和/c,特征/n,x/en,，/w,其中/r,标签/n,根据/p,我们/r,要/v,研究/vn,的/u,问题/n,不同/a,，/w,有/v,可能/v,是/v,一列/mq,或/c,多/a,列/v,。/w,标签/n,的/u,类型/n,根据/p,我们/r,要/v,研究/vn,的/u,问题/n,，/w,标签/n,的/u,类型/n,也/d,不一/v,：/w,单列/v,0/m,-/w,1/m,值/n,(/w,二分/v,类/q,问题/n,，/w,一个/m,样本/n,只/d,属于/v,一类/b,并且/c,一共/d,只/d,有/v,两类/mq,）/w,单列/v,连续值/nw,（/w,单回归/nw,问题/n,，/w,要/v,预测/v,的/u,值/n,只/d,有/v,一个/m,）/w,多列/nrf,0/m,-/w,1/m,值/n,（/w,多/a,分类/vn,问题/n,，/w,同样/d,是/v,一个/m,样本/n,只/d,属于/v,一类/b,但是/c,一共/d,有/v,多类/nw,）/w,多/a,列/v,连续值/nw,(/w,多/a,回归/v,问题/n,，/w,能够/v,预测/v,多/a,个/q,值/n,）/w,多/a,标签/n,（/w,多/a,标签/n,分类/vn,问题/n,，/w,但是/c,一个/m,样本/n,可以/v,属于/v,多类/nw,）/w,评价/v,指标/n,对于/p,多/a,个/q,机器/n,学习/v,方法/n,，/w,我们/r,必须/d,找到/v,一个/m,评价/v,指标/n,来/v,衡量/v,它们/r,的/u,好坏/n,。/w,比如/v,一个/m,二元/b,分类/vn,的/u,问题/n,我们/r,一般/a,选用/v,auc/en, ,roc/en,或者/c,仅仅/d,用/p,auc/en,曲线/n,下面/f,的/u,面积/n,来/v,衡量/v,。/w,在/p,多/a,标签/n,和/c,多/a,分类/vn,问题/n,上/f,，/w,我们/r,选择/v,交叉/vn,熵/g,或/c,对数/n,损失/n,函数/n,。/w,在/p,回归/v,问题/n,上/f,我们/r,选择/v,常用/a,的/u,均方/nw,误差/n,(/w,mse/en,)/w,。/w,python/en,库/n,在/p,安装/v,机器/n,学习/v,的/u,几/m,个/q,库/n,之前/f,，/w,应该/v,安装/v,两个/m,基础库/nw,：/w,numpy/en,和/c,scipy/en,。/w,pandas/en, ,处理/v,数据/n,最/d,强大/a,的/u,库/n,scikit/en,-/w,learn/en, ,涵盖/v,机器/n,学习/v,几乎/d,所有/b,方法/n,的/u,库/n,xgboost/en, ,优化/v,了/u,传统/n,的/u,梯度/n,提升/v,算法/n,keras/en, ,神经/n,网络/n,matplotlib/en,用/p,来/v,作/v,图/n,的/u,库/n,tpdm/en, ,显示/v,过程/n,机器/n,学习/v,框架/n,2015年/t,我/r,想/v,出/v,了/u,一个/m,自动式/nw,机器/n,学习/v,的/u,框架/n,，/w,直到/v,今天/t,还/d,在/p,开发/v,阶段/n,但是/c,不久/m,就/d,会/v,发布/v,，/w,本文/r,就/d,是/v,以/p,这个/r,框架/n,作为/v,基础/n,的/u,。/w,下/f,图/n,展示/v,了/u,这个/r,框架/n,：/w,上面/f,展示/v,的/u,这个/r,框架/n,里面/f,，/w,粉红色/n,的/u,线/n,就/d,是/v,一些/m,通用/vn,的/u,步骤/n,。/w,在/p,处理/v,完/v,数据/n,并/c,把/p,数据/n,转为/v,数据/n,框格式/nw,后/f,，/w,我们/r,就/d,可以/v,进行/v,机器/n,学习/v,过程/n,了/u,。/w,确定/v,问题/n,确定/v,要/v,研究/vn,的/u,问题/n,，/w,也/d,就是/d,通过/p,观察/v,标签/n,的/u,类别/n,确定/v,究竟/d,是/v,分类/vn,还是/c,回归/v,问题/n,。/w,划分/v,样本/n,第二/m,步/q,是/v,将/d,所有/b,的/u,样本/n,划分/v,为/p,训练/vn,集/vg,(/w,training/en, ,data/en,)/w,和/c,验证/vn,集/vg,(/w,validation/en, ,data/en,)/w,。/w,过程/n,如下/v,：/w,划分/v,样本/n,的/u,这/r,一/m,过程/n,必须/d,要/v,根据/p,标签/n,来/v,做/v,。/w,比如/v,对于/p,一个/m,类别/n,不/d,平衡/a,的/u,分类/vn,问题/n,，/w,必须/d,要/v,用/p,分层/v,抽样/vn,的/u,方法/n,，/w,比如/v,每/r,种/q,标签/n,抽/v,多少/r,，/w,这样/r,才能/v,保证/v,抽/v,出来/v,的/u,两个/m,样本子集/nw,分布/v,类似/v,。/w,在/p,python/en,中/f,，/w,我们/r,可以/v,用/p,scikit/en,-/w,learn/en,轻松/a,实现/v,。/w,对于/p,回归/v,问题/n,，/w,那么/r,一个/m,简单/a,的/u,k/en,折/v,划分/v,就/d,足够/v,了/u,。/w,但是/c,仍然/d,有/v,一些/m,复杂/a,的/u,方法/n,可以/v,使得/v,验证/vn,集/vg,和/c,训练/vn,集/vg,标签/n,的/u,分布/v,接近/v,，/w,这个/r,问题/n,留给/v,读者/n,作为/v,练习/v,。/w,上面/f,我/r,用/p,了/u,样本/n,全集/n,中/f,的/u,10%/mq,作为/v,验证/vn,集/vg,的/u,规模/n,，/w,当然/d,你/r,可以/v,根据/p,你/r,的/u,样本量/n,做/v,相应/v,的/u,调整/vn,。/w,划分/v,完/v,样本/n,以后/f,，/w,我们/r,就/d,把/p,这些/r,数据/n,放在/v,一边/d,。/w,接下来/l,我们/r,使用/v,的/u,任何/r,一种/mq,机器/n,学习/v,的/u,方法/n,都/d,要/v,先/d,在/p,训练/vn,集/vg,上/f,使用/v,然后/c,再/d,用/p,验证/vn,集/vg,检验/v,效果/n,。/w,验证/vn,集/vg,和/c,训练/vn,集/vg,永远/d,都/d,不能/v,掺/v,和/c,在/p,一起/s,。/w,这样/r,才/d,能/v,得到/v,有效/a,的/u,评价/v,得分/n,，/w,否则/c,将/d,会/v,导致/v,过/u,拟合/nz,的/u,问题/n,。/w,识别/v,特征/n,一个/m,数据集/nw,总是/d,带有/v,很多/m,的/u,变量/n,(/w,variables/en,)/w,，/w,或者/c,称之为/v,特征/n,（/w,features/en,)/w,，/w,他们/r,对应/v,着/u,数据框/nw,的/u,维度/n,。/w,一般/a,特征/n,的/u,值/n,有/v,三种/mq,类型/n,：/w,数值/n,变量/n,、/w,属性/n,变量/n,和/c,文字/n,变量/n,。/w,我们/r,用/p,经典/n,的/u,泰坦尼克号/nz,数据集/nw,来/v,示例/n,。/w,在/p,这里/r,生还/vn,（/w,survival/en,）/w,就/d,是/v,标签/n,，/w,船舱/n,等级/n,（/w,pclass/en,）/w,、/w,性别/n,（/w,sex/en,）/w,和/c,登船/nz,港口/n,（/w,embarked/en,）/w,是/v,属性/n,变量/n,。/w,而/c,像/v,年龄/n,（/w,age/en,）/w,、/w,船上/s,兄弟/n,姐妹/n,数量/n,（/w,sibsp/en,）/w,、/w,船上/s,父母/n,孩子/n,数量/n,（/w,parch/en,）/w,是/v,数值/n,变量/n,。/w,而/c,姓名/n,（/w,name/en,）/w,这种/r,文字/n,变量/n,我们/r,认为/v,这/r,和/c,生还/vn,与否/u,没/d,什么/r,关系/n,，/w,所以/c,我们/r,决定/v,不/d,考虑/v,。/w,首先/d,处理/v,数值型/nw,变量/n,，/w,这些/r,变量/n,几乎/d,不/d,需要/v,任何/r,的/u,处理/v,，/w,常见/a,的/u,方式/n,是/v,正规化/vn,（/w,normalization/en,)/w,。/w,处理/v,属性/n,变量/n,通常/d,有/v,两步/mq,：/w,把/p,属性/n,变量/n,转变/v,为/p,标签/n,把/p,标签/n,转变/v,为/p,二元/mq,数值/n,由于/c,泰坦尼克号/nz,数据集/nw,没有/v,很/d,好/a,的/u,文字/n,变量/n,来/v,示范/vn,，/w,那么/r,我们/r,就/d,制定/v,一个/m,通用/vn,的/u,规则/n,来/v,处理/v,文字/n,变量/n,。/w,把/p,所有/b,的/u,文字/n,变量/n,组合/v,到/v,一起/s,，/w,然后/c,用/p,某种/r,算法/n,来/v,处理/v,并/c,转变/v,为/p,数字/n,我们/r,可以/v,用/p,countvectorizer/en,或者/c,tfidfvectorizer/en,来/v,实现/v,一般来说/l,第二/m,种/q,方法/n,往往/d,比较/d,优越/a,，/w,下面/f,代码/n,框/q,中/f,所/u,展示/v,的/u,参数/n,长期以来/l,都/d,取得/v,了/u,良好/a,的/u,效果/n,。/w,如果/c,你/r,对/p,训练/vn,集/vg,数据/n,采用/v,了/u,上述/b,处理/v,方式/n,，/w,那么/r,也/d,要/v,保证/v,对/p,验证/vn,及/c,数据/n,做/v,相同/a,处理/v,。/w,特征/n,融合/v,特征/n,融合/v,是/v,指/v,将/d,不同/a,的/u,特征/n,融合/v,，/w,要/v,区别/n,对待/v,密集型/b,变量/n,和/c,稀疏型/nw,变量/n,。/w,当/p,我们/r,把/p,特征/n,融合/v,好/a,以后/f,，/w,可以/v,开始/v,机器/n,学习/v,的/u,建模/vn,过程/n,了/u,，/w,在/p,这里/r,我们/r,都/d,是/v,选择/v,以/p,决策/n,树/v,为/p,基/ng,学习器/nw,的/u,集成/vn,算法/n,，/w,主要/b,有/v,：/w,randomforestclassifierrandomforestregressorextratreesclassifierextratreesregressorxgbclassifierxgbregressor/en,但是/c,不/d,能/v,直接/ad,把/p,没有/v,经过/p,规范化/vn,的/u,数值/n,变量/n,直接/ad,用/p,线性/n,模型/n,拟合/nz,，/w,可以/v,用/p,scikitlearn/en,里面/f,的/u,规范化/vn,（/w,normalized/en,）/w,和/c,标准化/vn,（/w,standardscaler/en,）/w,命令/n,分别/d,对/p,密集/a,和/c,稀疏/a,的/u,数据/n,进行/v,相应/v,的/u,处理/v,。/w,特征/n,降/v,维和/j,特征/n,选择/v,如果/c,以上/f,方式/n,处理/v,后/f,的/u,数据/n,可以/v,产生/v,一个/m,优秀/a,的/u,模型/n,，/w,那/r,就/d,可以/v,直接/ad,进行/v,参数/n,调整/vn,了/u,。/w,如果/c,不行/a,则/d,还要/v,继续/v,进行/v,特征/n,降/v,维和/j,特征/n,选择/v,。/w,降维/nw,的/u,方法/n,有/v,以下/f,几/m,种/q,：/w,简单/a,起见/u,，/w,这里/r,不/d,考虑/v,lda/en,和/c,qda/en,。/w,对于/p,高维/nr,数据/n,来说/u,，/w,pca/en,是/v,常用/a,的/u,降维/nw,方式/n,，/w,对于/p,图像/n,数据/n,一般/a,我们/r,选用/v,10/m,~/w,15组/mq,主/n,成分/n,，/w,当然/d,如果/c,模型/n,效果/n,会/v,提升/v,的/u,话/n,也/d,可以/v,选择/v,更/d,多/a,的/u,主/n,成分/n,。/w,对于/p,其他/r,类型/n,的/u,数据/n,我们/r,一般/a,选择/v,50/m,~/w,60个/m,主/n,成分/n,。/w,文字/n,变量/n,转变/v,为/p,稀疏/a,矩阵/n,后/f,进行/v,奇异值/nw,分解/v,，/w,奇异值/nw,分解/v,对应/v,scikit/en, ,learn/en,库/n,中/f,的/u,truncatedsvd/en,语句/n,。/w,一般/a,在/p,tf/en,-/w,idf/en,中/f,svd/en,主/n,成分/n,的/u,数目/n,大约/d,在/p,120/m,~/w,200/m,之间/f,，/w,但是/c,也/d,可以/v,采用/v,更/d,多/a,的/u,成分/n,，/w,但是/c,相应/v,的/u,计算/v,成本/n,也/d,会/v,增加/v,。/w,在/p,特征/n,降维/nw,之后/f,我们/r,可以/v,进行/v,建模/vn,的/u,训练/vn,过程/n,了/u,，/w,但是/c,有的/r,时候/n,如果/c,这样/r,降维/nw,后/f,的/u,结果/n,仍/d,不/d,理想/n,，/w,可以/v,进行/v,特征/n,选择/v,：/w,特征/n,选择/v,也/d,有/v,很多/m,实用/vn,的/u,方法/n,，/w,比如说/l,常用/a,的/u,向前/v,或/c,向/p,后/f,搜索/vn,。/w,那/r,就/d,是/v,一个/m,接/v,一个/m,地/u,把/p,特征/n,加入/v,模型/n,训练/vn,，/w,如果/c,加入/v,一个/m,新/a,的/u,特征/n,后/f,模型/n,效果/n,不好/a,，/w,那/r,就/d,不/d,加入/v,这/r,一/m,特征/n,。/w,直到/v,选出/v,最/d,好/a,的/u,特征子集/nw,。/w,对于/p,这种/r,方法/n,有/v,一个/m,提升/v,的/u,方式/n,是/v,用/p,auc/en,作为/v,评价/v,指标/n,，/w,当然/d,这个/r,提升/v,也/d,不/d,是/v,尽善尽美/i,的/u,，/w,还是/c,需要/v,实际/n,应用/vn,进行/v,改善/v,和/c,调整/vn,的/u,。/w,还有/v,一种/mq,特征/n,选择/v,的/u,方式/n,是/v,在/p,建模/vn,的/u,过程/n,中/f,就/d,得到/v,了/u,最佳/z,特征子集/nw,。/w,比如/v,我们/r,可以/v,观察/v,logit/en,模型/n,的/u,系数/n,或者/c,拟合/nz,一个/m,随机/d,森林/n,模型/n,从而/c,直接/ad,把/p,这些/r,甄选/v,后/f,的/u,特征/n,用/p,在/p,其它/r,模型/n,中/f,。/w,在/p,上面/f,的/u,处理/v,中/f,应该/v,选择/v,一个/m,小/a,的/u,estimator/en,数目/n,这样/r,不/d,会/v,导致/v,过/u,拟合/nz,。/w,还/d,可以/v,用/p,梯度/n,提升/v,算法/n,来/v,进行/v,特征/n,选择/v,，/w,在/p,这里/r,我们/r,建议/n,用/p,xgboost/en,的/u,库/n,而/c,不/d,是/v,sklearn/en,库/n,里面/f,的/u,梯度/n,提升/v,算法/n,，/w,因为/c,前者/r,速度/n,快/a,且/c,有/v,着/u,更/d,好/a,的/u,延展性/n,。/w,对于/p,稀疏/a,的/u,数据集/nw,我们/r,可以/v,用/p,随机/d,森林/n,