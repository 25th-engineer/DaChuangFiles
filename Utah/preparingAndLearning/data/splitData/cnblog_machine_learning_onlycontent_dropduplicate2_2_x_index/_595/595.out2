本文/r,先/d,从/p,几何/n,意义/n,上/f,对/p,奇异值/nw,分解/v,svd/en,进行/v,简单/a,介绍/v,，/w,然后/c,分析/vn,了/u,特征/n,值/n,分解/v,与/p,奇异值/nw,分解/v,的/u,区别/n,与/p,联系/v,，/w,最后/f,用/p,python/en,实现/v,将/d,svd/en,应用/vn,于/p,推荐/v,系统/n,。/w,1/m,./w,svd/en,详解/v,svd/en,(/w,singular/en, ,value/en, ,decomposition/en,)/w,，/w,翻译/v,成/v,中文/nz,就/d,是/v,奇异值/nw,分解/v,。/w,svd/en,的/u,用处/n,有/v,很多/m,，/w,比如/v,：/w,lsa/en,（/w,隐性/b,语义/n,分析/vn,）/w,、/w,推荐/v,系统/n,、/w,特征/n,压缩/v,（/w,或/c,称/v,数据/n,降维/nw,）/w,。/w,svd/en,可以/v,理解/v,为/p,：/w,将/d,一个/m,比较/d,复杂/a,的/u,矩阵/n,用/p,更/d,小/a,更/d,简单/a,的/u,3个子/mq,矩阵/n,的/u,相乘/v,来/v,表示/v,，/w,这/r,3个/m,小/a,矩阵/n,描述/v,了/u,大/a,矩阵/n,重要/a,的/u,特性/n,。/w,1.1/m,奇异值/nw,分解/v,的/u,几何/n,意义/n,(/w,因/p,公式/n,输入/v,比较/d,麻烦/an,所以/c,采取/v,截/v,图/n,的/u,方式/n,)/w,2/m,./w,svd/en,应用/vn,于/p,推荐/v,系统/n,数据/n,集中/v,行/v,代表/n,用户/n,user/en,，/w,列/v,代表/n,物品/n,item/en,，/w,其中/r,的/u,值/n,代表/n,用户/n,对/p,物品/n,的/u,打分/v,。/w,基于/p,svd/en,的/u,优势/n,在于/v,：/w,用户/n,的/u,评分/vn,数据/n,是/v,稀疏/a,矩阵/n,，/w,可以/v,用/p,svd/en,将/d,原始/a,数据/n,映射/v,到/v,低维/nw,空间/n,中/f,，/w,然后/c,计算/v,物品/n,item/en,之间/f,的/u,相似/a,度/q,，/w,可以/v,节省/v,计算/v,资源/n,。/w,整体/n,思路/n,：/w,先/d,找到/v,用户/n,没有/v,评分/vn,的/u,物品/n,，/w,然后/c,再/d,经过/p,svd/en,“/w,压缩/v,”/w,后/f,的/u,低维/nw,空间/n,中/f,，/w,计算/v,未/d,评分/vn,物品/n,与/p,其他/r,物品/n,的/u,相似性/n,，/w,得到/v,一个/m,预测/v,打分/v,，/w,再/d,对/p,这些/r,物品/n,的/u,评分/vn,从/p,高/a,到/v,低/a,进行/v,排序/vn,，/w,返回/v,前/f,n/en,个/q,物品/n,推荐/v,给/p,用户/n,。/w,具体/a,代码/n,如下/v,，/w,主要/b,分为/v,5/m,部分/n,：/w,第/m,1/m,部分/n,：/w,加载/v,测试/vn,数据集/nw,；/w,第/m,2/m,部分/n,：/w,定义/n,三种/mq,计算/v,相似/a,度/q,的/u,方法/n,；/w,第/m,3/m,部分/n,：/w,通过/p,计算/v,奇异值/nw,平方和/n,的/u,百分比/n,来/v,确定/v,将/d,数据/n,降/v,到/v,多少/r,维才/nrf,合适/a,，/w,返回/v,需要/v,降/v,到/v,的/u,维度/n,；/w,第/m,4/m,部分/n,：/w,在/p,已经/d,降维/nw,的/u,数据/n,中/f,，/w,基于/p,svd/en,对/p,用户/n,未/d,打分/v,的/u,物品/n,进行/v,评分/vn,预测/v,，/w,返回/v,未/d,打分/v,物品/n,的/u,预测/v,评/v,分值/n,；/w,第/m,5/m,部分/n,：/w,产生/v,前/f,n/en,个/q,评分/vn,值/n,高/a,的/u,物品/n,，/w,返回/v,物品/n,编号/v,以及/c,预测/v,评分/vn,值/n,。/w,优势/n,在于/v,：/w,用户/n,的/u,评分/vn,数据/n,是/v,稀疏/a,矩阵/n,，/w,可以/v,用/p,svd/en,将/d,数据/n,映射/v,到/v,低维/nw,空间/n,，/w,然后/c,计算/v,低维/nw,空间/n,中/f,的/u,item/en,之间/f,的/u,相似/a,度/q,，/w,对/p,用户/n,未/d,评分/vn,的/u,item/en,进行/v,评分/vn,预测/v,，/w,最后/f,将/d,预测/v,评分/vn,高/a,的/u,item/en,推荐/v,给/p,用户/n,。/w,#,coding/en,=/w,utf/en,-/w,8/m, ,from/en, ,numpy/en, ,import/en, ,*/w, ,from/en, ,numpy/en, ,import/en, ,linalg/en, ,as/en, ,la/en, ,'/w,'/w,'/w,加载/v,测试/vn,数据集/nw,'/w,'/w,'/w, ,def/en, ,loadexdata/en,(/w,)/w,:/w, ,return/en, ,mat/en,(/w,[/w,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,3/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,3/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,]/w,,/w, ,[/w,3/m,,/w, ,3/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,2/m,,/w, ,2/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w,5/m,,/w, ,4/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,]/w,,/w, ,[/w,4/m,,/w, ,3/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,5/m,,/w, ,0/m,,/w, ,1/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,2/m,,/w, ,0/m,,/w, ,2/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,2/m,]/w,,/w, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,]/w,,/w, ,[/w,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,0/m,,/w, ,0/m,]/w,]/w,)/w, ,'/w,'/w,'/w,以下/f,是/v,三种/mq,计算/v,相似/a,度/q,的/u,算法/n,，/w,分别/d,是/v,欧式/b,距离/n,、/w,皮尔逊/nr,相关/v,系数/n,和/c,余弦/n,相似/a,度/q,,/w, ,注意/v,三种/mq,计算/v,方式/n,的/u,参数/n,ina/en,和/c,inb/en,都/d,是/v,列/v,向量/n,'/w,'/w,'/w, ,def/en, ,ecludsim/en,(/w,ina/en,,/w,inb/en,)/w,:/w, ,return/en, ,1.0/m,//w,(/w,1.0/m,+/w,la/en,./w,norm/en,(/w,ina/en,-/w,inb/en,)/w,)/w, ,#,范数/nr,的/u,计算/v,方法/n,linalg/en,./w,norm/en,(/w,)/w,，/w,这里/r,的/u,1/m,//w,(/w,1/m,+/w,距离/n,)/w,表示/v,将/d,相似/a,度/q,的/u,范围/n,放/v,在/p,0/m,与/p,1/m,之间/f, ,def/en, ,pearssim/en,(/w,ina/en,,/w,inb/en,)/w,:/w, ,if/en, ,len/en,(/w,ina/en,)/w,</w,3/m,:/w, ,return/en, ,1.0/m, ,return/en, ,0.5/m,+/w,0.5/m,*/w,corrcoef/en,(/w,ina/en,,/w,inb/en,,/w,rowvar/en,=/w,0/m,)/w,[/w,0/m,]/w,[/w,1/m,]/w, ,#,皮尔逊相/nrf,关系/n,数/m,的/u,计算/v,方法/n,corrcoef/en,(/w,)/w,，/w,参数/n,rowvar/en,=/w,0/m,表示/v,对/p,列求/nr,相似/a,度/q,，/w,这里/r,的/u,0.5/m,+/w,0.5/m,*/w,corrcoef/en,(/w,)/w,是/v,为了/p,将/d,范围/n,归/v,一/m,化放/nw,到/v,0/m,和/c,1/m,之间/f, ,def/en, ,cossim/en,(/w,ina/en,,/w,inb/en,)/w,:/w, ,num/en,=/w,float/en,(/w,ina/en,./w,t/en,*/w,inb/en,)/w, ,denom/en,=/w,la/en,./w,norm/en,(/w,ina/en,)/w,*/w,la/en,./w,norm/en,(/w,inb/en,)/w, ,return/en, ,0.5/m,+/w,0.5/m,*/w,(/w,num/en,//w,denom/en,)/w, ,#,将/d,相似/a,度/q,归/v,一/m,到/v,0/m,与/p,1/m,之间/f, ,'/w,'/w,'/w,按照/p,前/f,k/en,个/q,奇异值/nw,的/u,平方/q,和/c,占/v,总/b,奇异值/nw,的/u,平方和/n,的/u,百分比/n,percentage/en,来/v,确定/v,k/en,的/u,值/n,,/w, ,后续/vn,计算/v,svd/en,时/ng,需要/v,将/d,原始/a,矩阵/n,转换/v,到/v,k/en,维/q,空间/n,'/w,'/w,'/w, ,def/en, ,sigmapct/en,(/w,sigma/en,,/w,percentage/en,)/w,:/w, ,sigma/en,2/m,=/w,sigma/en,*/w,*/w,2/m, ,#,对/p,sigma/en,求/v,平方/q, ,sumsgm/en,2/m,=/w,sum/en,(/w,sigma/en,2/m,)/w, ,#,求/v,所有/b,奇异值/nw,sigma/en,的/u,平方/q,和/c, ,sumsgm/en,3/m,=/w,0/m, ,#,sumsgm/en,3/m,是/v,前/f,k/en,个/q,奇异值/nw,的/u,平方和/n, ,k/en,=/w,0/m, ,for/en, ,i/en, ,in/en, ,sigma/en,:/w, ,sumsgm/en,3/m,+/w,=/w,i/en,*/w,*/w,2/m, ,k/en,+/w,=/w,1/m, ,if/en, ,sumsgm/en,3/m,>,=/w,sumsgm/en,2/m,*/w,percentage/en,:/w, ,return/en, ,k/en, ,'/w,'/w,'/w,函数/n,svdest/en,(/w,)/w,的/u,参数/n,包含/v,：/w,数据/n,矩阵/n,、/w,用户/n,编号/v,、/w,物品/n,编号/v,和/c,奇异值/nw,占/v,比/p,的/u,阈值/n,，/w, ,数据/n,矩阵/n,的/u,行/v,对应/v,用户/n,，/w,列/v,对应/v,物品/n,，/w,函数/n,的/u,作用/n,是/v,基于/p,item/en,的/u,相似性/n,对/p,用户/n,未/d,评/v,过分/ad,的/u,物品/n,进行/v,预测/v,评分/vn,'/w,'/w,'/w, ,def/en, ,svdest/en,(/w,datamat/en,,/w,user/en,,/w,simmeas/en,,/w,item/en,,/w,percentage/en,)/w,:/w, ,n/en,=/w,shape/en,(/w,datamat/en,)/w,[/w,1/m,]/w, ,simtotal/en,=/w,0.0/m,;/w,ratsimtotal/en,=/w,0.0/m, ,u/en,,/w,sigma/en,,/w,vt/en,=/w,la/en,./w,svd/en,(/w,datamat/en,)/w, ,k/en,=/w,sigmapct/en,(/w,sigma/en,,/w,percentage/en,)/w, ,#,确定/v,了/u,k/en,的/u,值/n, ,sigmak/en,=/w,mat/en,(/w,eye/en,(/w,k/en,)/w,*/w,sigma/en,[/w,:/w,k/en,]/w,)/w, ,#,构建/v,对/p,角矩/nw,阵/ng, ,xformeditems/en,=/w,datamat/en,./w,t/en,*/w,u/en,[/w,:/w,,/w,:/w,k/en,]/w,*/w,sigmak/en,./w,i/en, ,#,根据/p,k/en,的/u,值/n,将/d,原始/a,数据/n,转换/v,到/v,k/en,维/q,空间/n,(/w,低维/nw,)/w,,/w,xformeditems/en,表示/v,物品/n,(/w,item/en,)/w,在/p,k/en,维/q,空间/n,转换/v,后/f,的/u,值/n, ,for/en, ,j/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,userrating/en,=/w,datamat/en,[/w,user/en,,/w,j/en,]/w, ,if/en, ,userrating/en,=/w,=/w,0/m, ,or/en, ,j/en,=/w,=/w,item/en,:/w,continue/en, ,similarity/en,=/w,simmeas/en,(/w,xformeditems/en,[/w,item/en,,/w,:/w,]/w,./w,t/en,,/w,xformeditems/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,)/w, ,#,计算/v,物品/n,item/en,与/p,物品/n,j/en,之间/f,的/u,相似/a,度/q, ,simtotal/en,+/w,=/w,similarity/en, ,#,对/p,所有/b,相似/a,度/q,求/v,和/c, ,ratsimtotal/en,+/w,=/w,similarity/en,*/w,userrating/en, ,#,用/p,"/w,物品/n,item/en,和/c,物品/n,j/en,的/u,相似/a,度/q,"/w,乘/v,以/p,"/w,用户/n,对/p,物品/n,j/en,的/u,评分/vn,"/w,，/w,并/c,求/v,和/c, ,if/en, ,simtotal/en,=/w,=/w,0/m,:/w,return/en, ,0/m, ,else/en,:/w,return/en, ,ratsimtotal/en,//w,simtotal/en, ,#,得到/v,对/p,物品/n,item/en,的/u,预测/v,评分/vn, ,'/w,'/w,'/w,函数/n,recommend/en,(/w,)/w,产生/v,预测/v,评分/vn,最/d,高/a,的/u,n/en,个/q,推荐/v,结果/n,，/w,默认/v,返回/v,5个/m,；/w, ,参数/n,包括/v,：/w,数据/n,矩阵/n,、/w,用户/n,编号/v,、/w,相似/a,度/q,衡量/v,的/u,方法/n,、/w,预测/v,评分/vn,的/u,方法/n,、/w,以及/c,奇异值/nw,占/v,比/p,的/u,阈值/n,；/w, ,数据/n,矩阵/n,的/u,行/v,对应/v,用户/n,，/w,列/v,对应/v,物品/n,，/w,函数/n,的/u,作用/n,是/v,基于/p,item/en,的/u,相似性/n,对/p,用户/n,未/d,评/v,过分/ad,的/u,物品/n,进行/v,预测/v,评分/vn,；/w, ,相似/a,度/q,衡量/v,的/u,方法/n,默认/v,用/p,余弦/n,相似/a,度/q,'/w,'/w,'/w, ,def/en, ,recommend/en,(/w,datamat/en,,/w,user/en,,/w,n/en,=/w,5/m,,/w,simmeas/en,=/w,cossim/en,,/w,estmethod/en,=/w,svdest/en,,/w,percentage/en,=/w,0.9/m,)/w,:/w, ,unrateditems/en,=/w,nonzero/en,(/w,datamat/en,[/w,user/en,,/w,:/w,]/w,./w,a/en,=/w,=/w,0/m,)/w,[/w,1/m,]/w, ,#,建立/v,一个/m,用户/n,未/d,评分/vn,item/en,的/u,列表/v, ,if/en, ,len/en,(/w,unrateditems/en,)/w,=/w,=/w,0/m,:/w,return/en, ,'/w,you/en, ,rat