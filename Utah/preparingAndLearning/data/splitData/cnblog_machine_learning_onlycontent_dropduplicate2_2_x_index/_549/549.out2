摘要/n,：/w,本文/r,分别/d,介绍/v,了/u,线性/n,回归/v,、/w,局部/n,加权/v,回归/v,和/c,岭/ng,回归/v,，/w,并/c,使用/v,python/en,进行/v,了/u,简单/a,实现/v,。/w,在/p,这/r,之前/f,，/w,已经/d,学习/v,过/u,了/u,logistic/en,回归/v,，/w,今天/t,继续/v,看/v,回归/v,。/w,首先/d,说/v,一下/m,回归/v,的/u,由来/n,：/w,回归/v,是/v,由/p,达尔文/nr,的/u,表兄弟/n,francis/en, ,galton/en,发明/v,的/u,。/w,galton/en,于/p,1877年/t,完成/v,了/u,第一/m,次/q,回归/v,预测/v,，/w,目的/n,是/v,根据/p,上/f,一代/mq,豌豆/n,的/u,种子/n,（/w,双亲/n,）/w,的/u,尺寸/n,来/v,预测/v,下/f,一代/mq,豌豆/n,种子/n,（/w,孩子/n,）/w,的/u,尺寸/n,（/w,身高/n,）/w,。/w,galton/en,在/p,大量/m,对象/n,上/f,应用/vn,了/u,回归/v,分析/vn,，/w,甚至/d,包括/v,人/n,的/u,身高/n,。/w,他/r,得到/v,的/u,结论/n,是/v,：/w,如果/c,双亲/n,的/u,高度/d,比/p,平均/a,高度/d,高/a,，/w,他们/r,的/u,子女/n,也/d,倾向/n,于/p,平均/a,身高/n,但/c,尚/d,不/d,及/c,双亲/n,，/w,这里/r,就/d,可以/v,表述/vn,为/p,：/w,孩子/n,的/u,身高/n,向着/p,平均/a,身高/n,回归/v,。/w,galton/en,在/p,多/a,项/q,研究/vn,上/f,都/d,注意/v,到/v,了/u,这/r,一点/m,，/w,并/c,将/d,此/r,研究/vn,方法/n,称为/v,回归/v,，/w,接下来/l,就/d,上文/n,提到/v,的/u,三种/mq,回归/v,一一/d,介绍/v,：/w,一/m, ,线性/n,回归/v,（/w,linear/en, ,regression/en,）/w,1/m,./w, ,线性/n,回归/v,概述/v,回归/v,的/u,目的/n,是/v,预测/v,数/m,值型/nw,数据/n,的/u,目标值/n,，/w,最/d,直接/ad,的/u,方法/n,就/d,是/v,根据/p,输入/v,写/v,出/v,一个/m,求/v,出/v,目标值/n,的/u,计算/v,公式/n,，/w,也/d,就/d,是/v,所谓/v,的/u,回归/v,方程/n,，/w,例如/v,y/en, ,=/w, ,ax/en,1/m,+/w,bx/en,2/m,，/w,其中/r,求/v,回归/v,系数/n,的/u,过程/n,就/d,是/v,回归/v,。/w,那么/r,回归/v,是/v,如何/r,预测/v,的/u,呢/y,？/w,当/p,有/v,了/u,这些/r,回归/v,系数/n,，/w,给/p,定/v,输入/v,，/w,具体/a,的/u,做法/n,就/d,是/v,将/d,回归/v,系数/n,与/p,输入/v,相乘/v,，/w,再/d,将/d,结果/n,加/v,起来/v,就/d,是/v,最终/d,的/u,预测值/n,。/w,说/v,到/v,回归/v,，/w,一般/a,指/v,的/u,都/d,是/v,线性/n,回归/v,，/w,当然/d,也/d,存在/v,非线性/b,回归/v,，/w,在/p,此/r,不/d,做/v,讨论/v,。/w,假定/v,输入/v,数据/n,存在/v,矩阵/n,x/en,中/f,，/w,而/c,回归/v,系数/n,存放/v,在/p,向量/n,w/en,中/f,。/w,那么/r,对于/p,给/p,定/v,的/u,数据/n,x/en,1/m,,/w,预测/v,结果/n,可以/v,通过/p,y/en,1/m, ,=/w, ,x/en,1/m,tw/en,给出/v,，/w,那么/r,问题/n,就/d,是/v,来/v,寻找/v,回归/v,系数/n,。/w,一个/m,最/d,常用/a,的/u,方法/n,就/d,是/v,寻找/v,误差/n,最/d,小/a,的/u,w/en,，/w,误差/n,可以/v,用/p,预测/v,的/u,y/en,值/n,和/c,真实/a,的/u,y/en,值/n,的/u,差值/n,表示/v,，/w,由于/c,正负/n,差值/n,的/u,差异/n,，/w,可以/v,选用/v,平方/q,误差/n,，/w,也/d,就是/d,对/p,预测/v,的/u,y/en,值/n,和/c,真实/a,的/u,y/en,值/n,的/u,平方/q,求和/vn,，/w,用/p,矩阵/n,可/v,表示/v,为/p,：/w,(/w,y/en, ,-/w, ,xw/en,)/w,t/en,(/w,y/en, ,-/w, ,xw/en,)/w,，/w,现在/t,问题/n,就/d,转换/v,为/p,寻找/v,使得/v,上述/b,矩/ng,阵值/nw,最/d,小/a,的/u,w/en,，/w,对/p,w/en,求导/nw,为/p,：/w,xt/en,(/w,y/en, ,-/w, ,xw/en,)/w,，/w,令/v,其/r,为/p,0/m,，/w,解/v,得/u,：/w,w/en, ,=/w, ,(/w,xtx/en,)/w,-/w,1/m,xty/en,，/w,这/r,就/d,是/v,采用/v,此/r,方法/n,估计/v,出来/v,的/u,2/m,./w,python/en,实现/v,结合/v,上述/b,的/u,分析/vn,，/w,采用/v,python/en,实现/v,，/w,首先/d,，/w,导入/v,数据/n,：/w,#,导入/v,数据/n, ,def/en, ,loaddata/en,(/w,filename/en,)/w,:/w, ,numfeat/en, ,=/w, ,len/en,(/w,open/en,(/w,filename/en,)/w,./w,readline/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w,)/w, ,-/w, ,1/m, ,datamat/en, ,=/w, ,[/w,]/w, ,labelmat/en, ,=/w, ,[/w,]/w, ,fr/en, ,=/w, ,open/en,(/w,filename/en,)/w, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,linarr/en, ,=/w, ,[/w,]/w, ,curline/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w,#,得到/v,每行/nw,，/w,并以/c,tab/en,作为/v,间隔/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numfeat/en,)/w,:/w, ,linarr/en,./w,append/en,(/w,float/en,(/w,curline/en,[/w,i/en,]/w,)/w,)/w, ,datamat/en,./w,append/en,(/w,linarr/en,)/w, ,labelmat/en,./w,append/en,(/w,float/en,(/w,curline/en,[/w,-/w,1/m,]/w,)/w,)/w, ,return/en, ,datamat/en,,/w,labelmat/en,之后/f,，/w,求解/v,回归/v,系数/n,：/w,#,计算/v,回归/v,系数/n,from/en, ,numpy/en, ,import/en, ,*/w, ,def/en, ,standregres/en,(/w,x/en,,/w,y/en,)/w,:/w, ,xmat/en, ,=/w, ,mat/en,(/w,x/en,)/w, ,ymat/en, ,=/w, ,mat/en,(/w,y/en,)/w,./w,t/en, ,xtx/en, ,=/w, ,xmat/en,./w,t/en,*/w,xmat/en, ,#,采用/v,numpy/en,中/f,的/u,线性/n,代数/n,库/n,linalg/en,，/w,其中/r,linalg/en,./w,det/en,直接/ad,可以/v,计算/v,行列/n,式/k, ,if/en, ,linalg/en,./w,det/en,(/w,xtx/en,)/w, ,=/w,=/w, ,0.0/m,:/w, ,print/en, ,"/w,这个/r,行列式/n,是/v,错误/n,的/u,的/u,，/w,不/d,能/v,求/v,逆/vg,"/w, ,return/en, ,#,求/v,回归/v,系数/n, ,w/en, ,=/w, ,xtx/en,./w,i/en, ,*/w, ,(/w,xmat/en,./w,t/en, ,*/w, ,ymat/en,)/w, ,return/en, ,w/en,求得/v,了/u,回归/v,系数/n,，/w,结合/v,输入/v,就/d,可以/v,得到/v,回归/v,方程/n,，/w,为了/p,直观/a,的/u,表示/v,，/w,采用/v,matplotlib/en,绘图/vn,：/w,x/en,,/w,y/en, ,=/w, ,loaddata/en,(/w,"/w,ex/en,0/m,./w,txt/en,"/w,)/w, ,w/en, ,=/w, ,standregres/en,(/w,x/en,,/w,y/en,)/w, ,xmat/en, ,=/w, ,mat/en,(/w,x/en,)/w, ,ymat/en, ,=/w, ,mat/en,(/w,y/en,)/w, ,#,绘制/v,原/b,数据点/nw, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,)/w, ,ax/en, ,=/w, ,fig/en,./w,add/en,_,subplot/en,(/w,111/m,)/w, ,ax/en,./w,scatter/en,(/w,xmat/en,[/w,:/w,,/w,1/m,]/w,./w,flatten/en,(/w,)/w,./w,a/en,[/w,0/m,]/w,,/w,ymat/en,./w,t/en,[/w,:/w,,/w,0/m,]/w,./w,flatten/en,(/w,)/w,./w,a/en,[/w,0/m,]/w,)/w, ,#,</w,matplotlib/en,./w,collections/en,./w,circlecollectin/en, ,object/en, ,at/en, ,0/m,x/en,04/m,ed/en,9/m,d/en,30/m,>, ,#,plt/en,./w,show/en,(/w,)/w, ,#,在/p,之前/f,的/u,图像/n,上/f,绘制/v,出/v,拟合/nz,直线/n, ,xcopy/en, ,=/w, ,xmat/en,./w,copy/en,(/w,)/w, ,xcopy/en,./w,sort/en,(/w,0/m,)/w, ,yhat/en, ,=/w, ,xcopy/en,*/w,w/en, ,ax/en,./w,plot/en,(/w,xcopy/en,[/w,:/w,,/w,1/m,]/w,,/w,yhat/en,)/w, ,plt/en,./w,show/en,(/w,)/w,结果/n,如下/v,图/n,：/w,至此/d,拟合/nz,就/d,结束/v,了/u,，/w,那么/r,如何/r,评判/v,拟合/nz,的/u,好坏/n,？/w,numpy/en,库/n,提供/v,了/u,相关/v,系数/n,的/u,计算/v,方法/n,，/w,通过/p,命令/n,corrcoef/en,(/w,)/w,可以/v,来/v,计算/v,预测值/n,和/c,真实/a,值/n,的/u,相关性/n,。/w,yhat/en, ,=/w, ,xmat/en, ,*/w, ,w/en, ,print/en, ,corrcoef/en,(/w,yhat/en,./w,t/en,,/w,ymat/en,)/w,分析/vn,结果/n,我们/r,可以/v,看出/v,线性/n,回归/v,得到/v,的/u,相关性/n,还是/c,挺/d,理想/n,的/u,，/w,但是/c,从/p,图像/n,中/f,明显/a,可以/v,看出/v,线性/n,回归/v,未能/v,捕获/v,到/v,一些/m,数据点/nw,，/w,没/d,能/v,很/d,好/a,的/u,表示/v,数据/n,的/u,变化/vn,趋势/n,，/w,在/p,某种/r,情况/n,下/f,存在/v,欠/v,拟合/nz,的/u,情况/n,，/w,这/r,是/v,线性/n,回归/v,的/u,一个/m,缺点/n,。/w,在/p,此/r,想/v,要/v,说明/v,的/u,一点/m,是/v,，/w,要/v,只是/d,简单/a,的/u,实现/v,拟合/nz,的话/u,，/w,不妨/v,采用/v,matlab/en,中/f,的/u,cftool/en,的/u,工具/n,，/w,简单/a,高效/b,直观/a,。/w,二/m, ,局部/n,加权线性/nw,回归/v,（/w,locally/en, ,weighted/en, ,linear/en, ,regression/en,，/w,lwlr/en,）/w,1/m,./w,概述/v,针对/p,于线性/nw,回归/v,存在/v,的/u,欠/v,拟合/nz,现象/n,，/w,可以/v,引入/v,一些/m,偏差/n,得到/v,局部/n,加权线性/nw,回归/v,对/p,算法/n,进行/v,优化/v,。/w,在/p,该/r,算法/n,中/f,，/w,给/p,待/v,测点/nw,附近/f,的/u,每个/r,点/q,赋予/v,一定/d,的/u,权重/nz,，/w,进而/c,在/p,所/u,建立/v,的/u,子集/n,上/f,进行/v,给予/v,最小/a,均方/nw,差/a,来/v,进行/v,普通/a,的/u,回归/v,，/w,分析/vn,可/v,得/u,回归/v,系数/n,w/en,可/v,表示/v,为/p,：/w,w/en, ,=/w, ,(/w,xtwx/en,)/w,-/w,1/m,xtwy/en,，/w,其中/r,w/en,为/p,每个/r,数据点/nw,赋予/v,的/u,权重/nz,，/w,那么/r,怎样/r,求权/nw,重/a,呢/y,，/w,核/n,函数/n,可以/v,看成/v,是/v,求解/v,点/q,与/p,点/q,之间/f,的/u,相似/a,度/q,，/w,在/p,此/r,可以/v,采用/v,核/n,函数/n,，/w,相应/v,的/u,根据/p,预测点/nw,与/p,附近/f,点/q,之间/f,的/u,相似/a,程度/n,赋予/v,一定/d,的/u,权重/nz,，/w,在/p,此/r,选用/v,最/d,常用/a,的/u,高斯/nr,核/n,,/w,则/d,权/n,重/a,可以/v,表示/v,为/p,：/w,w/en,(/w,i/en,,/w,i/en,)/w, ,=/w, ,exp/en,(/w,|/w,x/en,(/w,i/en,)/w, ,-/w, ,x/en,|/w, ,//w, ,-/w,2/m,k/en,2/m,)/w,,/w,其中/r,k/en,为/p,宽度/n,参数/n,，/w,至于/p,此/r,参数/n,的/u,取值/v,，/w,目前/t,仍/d,没有/v,一个/m,确切/a,的/u,标准/n,，/w,只/d,有/v,一个/m,范围/n,的/u,描述/v,，/w,所以/c,在/p,算法/n,的/u,应用/vn,中/f,，/w,可以/v,采用/v,不同/a,的/u,取值/v,分别/d,调试/v,，/w,进而/c,选取/v,最/d,好/a,的/u,结果/n,。/w,2/m,./w,python/en,实现/v,结合/v,上述/b,的/u,分析/vn,，/w,采用/v,python/en,编程/vn,实现/v,，/w,代码/n,如下/v,：/w,def/en, ,lwlr/en,(/w,testpoint/en,,/w,xarr/en,,/w,yarr/en,,/w,k/en,)/w,:/w, ,xmat/en, ,=/w, ,mat/en,(/w,xarr/en,)/w, ,ymat/en, ,=/w, ,mat/en,(/w,yarr/en,)/w,./w,t/en, ,m/en, ,=/w, ,shape/en,(/w,xmat/en,)/w,[/w,0/m,]/w, ,weights/en, ,=/w, ,mat/en,(/w,eye/en,(/w,(/w,m/en,)/w,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,weights/en,[/w,i/en,,/w,i/en,]/w, ,=/w, ,exp/en,(/w,(/w,testpoint/en, ,-/w, ,xmat/en,[/w,i/en,,/w,:/w,]/w,)/w,*/w,(/w,testpoint/en, ,-/w, ,xmat/en,[/w,i/en,,/w,:/w,]/w,)/w,./w,t/en, ,//w, ,(/w,-/w,2.0/m,*/w,k/en,*/w,*/w,2/m,)/w,)/w, ,xtx/en, ,=/w, ,xmat/en,./w,t/en, ,*/w, ,(/w,weights/en, ,*/w, ,xmat/en,)/w, ,if/en, ,linalg/en,./w,det/en,(/w,xtx/en,)/w, ,=/w,=/w, ,0/m,:/w, ,print/en, ,"/w,输入/v,有/v,误/v,"/w, ,return/en, ,ws/en, ,=/w, ,xtx/en,./w,i/en, ,*/w, ,xmat/en,./w,t/en, ,*/w, ,weights/en, ,*/w, ,ymat/en, ,return/en, ,testpoint/en, ,*/w, ,ws/en, ,#,为数据点/nt,中/f,的/u,每个/r,数据/n,调用/v,lwlr/en, ,def/en, ,lwlrtest/en,(/w,testarr/en,,/w,xarr/en,,/w,yarr/en,,/w,k/en,)/w,:/w, ,m/en, ,=/w, ,shape/en,(/w,testarr/en,)/w,[/w,0/m,]/w, ,yhat/en, ,=/w, ,zeros/en,(/w,m/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,yhat/en,[/w,i/en,]/w, ,=/w, ,lwlr/en,(/w,testarr/en,[/w,i/en,]/w,,/w,xarr/en,,/w,yarr/en,,/w,k/en,)/w, ,return/en, ,yhat/en,结合/v,上述/b,分析/vn,，/w,我