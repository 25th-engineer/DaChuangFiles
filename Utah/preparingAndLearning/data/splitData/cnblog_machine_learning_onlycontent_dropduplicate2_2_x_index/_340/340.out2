使用/v,机器/n,学习/v,排序/vn,算法/n,lambdamart/en,有/v,一段/mq,时间/n,了/u,，/w,但/c,一直/d,没有/v,真正/d,弄/v,清楚/a,算法/n,中/f,的/u,所有/b,细节/n,。/w,学习/v,过程/n,中/f,细/a,读/v,了/u,两篇/mq,不错/a,的/u,博文/nz,，/w,推荐/v,给/p,大家/r,：/w,梯度/n,提升/v,树/v,(/w,gbdt/en,)/w,原理/n,小结/n,徐博/nr,from/en, ,ranknet/en, ,to/en, ,lambdarank/en, ,to/en, ,lambdamart/en,:/w, ,an/en, ,overview/en,但/c,经过/p,一番/m,搜寻/v,之后/f,发现/v,，/w,目前/t,网上/s,并/c,没有/v,一篇/mq,透彻/a,讲解/v,该/r,算法/n,的/u,文章/n,，/w,所以/c,希望/v,这/r,篇/q,文章/n,能够/v,达到/v,此/r,目的/n,。/w,本文/r,主要/b,参考/v,微软研究院/nt,2010年/t,发表/v,的/u,文章/n,from/en, ,ranknet/en, ,to/en, ,lambdarank/en, ,to/en, ,lambdamart/en,:/w, ,an/en, ,overview/en,$/w,^,1/m,$/w,，/w,并/c,结合/v,自己/r,的/u,理解/v,，/w,试图/v,将/d,ranknet/en,、/w,lambdarank/en,和/c,lambdamart/en,这/r,三种/mq,算法/n,的/u,所有/b,算法/n,细节/n,讲解/v,透彻/a,。/w,1/m,./w, ,概述/v,ranknet/en,、/w,lambdarank/en,和/c,lambdamart/en,是/v,三个/m,关系/n,非常/d,紧密/ad,的/u,机器/n,学习/v,排序/vn,算法/n,。/w,简而言之/l,，/w,ranknet/en,是/v,最/d,基础/n,，/w,基于/p,神经/n,网络/n,的/u,排序/vn,算法/n,；/w,而/c,lambdarank/en,在/p,ranknet/en,的/u,基础/n,上/f,修改/v,了/u,梯度/n,的/u,计算/v,方式/n,，/w,也/d,即/v,加入/v,了/u,lambda/en,梯度/n,；/w,lambdamart/en,结合/v,了/u,lambda/en,梯度/n,和/c,mart/en,（/w,另/r,称为/v,gbdt/en,，/w,梯度/n,提升/v,树/v,）/w,。/w,这/r,三种/mq,算法/n,在/p,工业界/n,中/f,应用/vn,广泛/a,，/w,在/p,bat/en,等/u,国内/s,大厂/ns,和/c,微软/nt,谷歌/nt,等/u,世界/n,互联网/n,巨头/n,内部/f,都/d,有/v,大量/m,应用/vn,，/w,还/d,曾经/d,赢得/v,“/w,yahoo/en,！/w,learning/en, ,to/en, ,rank/en, ,challenge/en,(/w,track/en, ,1/m,)/w,"/w,的/u,冠军/n,。/w,本人/r,认为/v,如果/c,评选/v,当今/t,工业界/n,中/f,三种/mq,最/d,重要/a,的/u,机器/n,学习/v,算法/n,，/w,以/p,lambdamart/en,为/p,代表/n,的/u,集成/vn,学习/v,算法/n,肯定/v,占有/v,一席之地/i,，/w,另外/c,两个/m,分别/d,是/v,支持/v,向/p,量机/nw,和/c,深度/n,学习/v,。/w,2/m,./w, ,ranknet/en,2.1/m, ,算法/n,基础/n,定义/n,ranknet/en,解决/v,如下/v,搜索/vn,排序/vn,问题/n,：/w,给定/vn,query/en,集合/v,，/w,每个/r,query/en,都/d,对应/v,着/u,一个/m,文档/n,集合/v,，/w,如何/r,对/p,每个/r,query/en,返回/v,排序/vn,后/f,的/u,文档/n,集合/v,。/w,可以/v,想象/v,这样/r,的/u,场景/n,：/w,某位/r,高考生/nw,在/p,得知/v,自己/r,的/u,成绩/n,后/f,，/w,准备/v,报考/v,志愿/n,。/w,听说/v,最近/t,西湖大学/nt,办/v,得/u,不错/a,，/w,所以/c,就/d,想到/v,网上/s,搜/v,搜/v,关于/p,西湖大学/nt,的/u,资料/n,。/w,他/r,打开/v,一个/m,搜索引擎/n,，/w,输入/v,“/w,西湖大学/nt,”/w,四个字/mq,，/w,然后/c,点击/v,“/w,搜索/vn,”/w,，/w,页面/n,从/p,上/f,到/v,下/f,显示/v,了/u,10条/mq,搜索/vn,结果/n,，/w,他/r,认为/v,排/v,在/p,上面/f,的/u,肯定/v,比/p,下面/f,的/u,相关/v,，/w,所以/c,就/d,开始/v,从/p,上/f,往/p,下/f,一个个/nw,地/u,浏览/vn,。/w,所以/c,ranknet/en,的/u,目标/n,就是/d,对/p,所有/b,query/en,，/w,都/d,能/v,将/d,其/r,返回/v,的/u,文档/n,按照/p,相关性/n,进行/v,排序/vn,。/w,ranknet/en,网络/n,将/d,输入/v,query/en,的/u,特征/n,向/p,量/n,$/w,x/en,\/w,in/en, ,\/w,mathbb/en,{/w,r/en,}/w,^,n/en,$/w,映射/v,为/p,一个/m,实数/n,$/w,f/en,(/w,x/en,)/w, ,\/w,in/en, ,\/w,mathbb/en,{/w,r/en,}/w,$/w,。/w,ranknet/en,采用/v,pairwise/en,的/u,方法/n,进行/v,模型/n,训练/vn,。/w,具体/a,地/u,，/w,给/p,定/v,特定/b,query/en,下/f,的/u,两个/m,文档/n,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,，/w,其/r,特征/n,向/p,量/n,分别/d,为/p,$/w,x/en,_,i/en,$/w,和/c,$/w,x/en,_,j/en,$/w,，/w,经过/p,ranknet/en,进行/v,前/f,向/p,计算/v,得到/v,对应/v,的/u,分数/n,为/p,$/w,s/en,_,i/en,=/w,f/en,(/w,x/en,_,i/en,)/w,$/w,和/c,$/w,s/en,_,j/en,=/w,f/en,(/w,x/en,_,j/en,)/w,$/w,。/w,用/p,$/w,u/en,_,i/en, ,\/w,rhd/en, ,u/en,_,j/en,$/w,表示/v,$/w,u/en,_,i/en,$/w,比/p,$/w,u/en,_,j/en,$/w,排序/vn,更/d,靠/v,前/f,（/w,如/v,对/p,某个/r,query/en,来说/u,，/w,$/w,u/en,_,i/en,$/w,被/p,标记/n,为/p,“/w,good/en,”/w,，/w,$/w,u/en,_,j/en,$/w,被/p,标记/n,为/p,“/w,bad/en,”/w,）/w,。/w,继而/c,可以/v,用/p,下面/f,的/u,公式/n,来/v,表示/v,$/w,u/en,_,i/en,$/w,应该/v,比/p,$/w,u/en,_,j/en,$/w,排序/vn,更/d,靠/v,前/f,的/u,概率/n,：/w,$/w,$/w,p/en,_,{/w,ij/en,}/w, ,\/w,equiv/en, ,p/en,(/w,u/en,_,i/en, ,\/w,rhd/en, ,u/en,_,j/en,)/w, ,\/w,equiv/en, ,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,$/w,$/w,这个/r,概率/n,实际上/d,就/d,是/v,深度/n,学习/v,中/f,经常/d,使用/v,的/u,sigmoid/en,函数/n,，/w,参数/n,$/w,\/w,sigma/en,$/w,决定/v,sigmoid/en,函数/n,的/u,形状/n,。/w,对于/p,特定/b,的/u,query/en,，/w,定义/n,$/w,s/en,_,{/w,ij/en,}/w, ,\/w,in/en, ,\/w,{/w,0/m,,/w,\/w,pm/en,1/m,\/w,}/w,$/w,为/p,文档/n,$/w,i/en,$/w,和/c,文档/n,$/w,j/en,$/w,被/p,标记/n,的/u,标签/n,之间/f,的/u,关联/vn,，/w,即/v,$/w,$/w, ,s/en,_,{/w,ij/en,}/w,=/w,\/w,left/en,\/w,{/w,\/w,begin/en,{/w,aligned/en,}/w,1/m,&/w,&/w, , , , , ,文档/n,i/en,比/p,文档/n,j/en,更/d,相关/v,\/w,\/w,0/m,&/w,&/w, , , , ,文档/n,i/en,和/c,文档/n,j/en,相关性/n,一致/a,\/w,\/w,-/w,1/m,&/w,&/w, , , ,文档/n,j/en,比/p,文档/n,i/en,更/d,相关/v,\/w,end/en,{/w,aligned/en,}/w,\/w,right/en,./w,$/w,$/w,定义/n,$/w,\/w,overline/en,{/w,p/en,}/w,_,{/w,ij/en,}/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,+/w,s/en,_,{/w,ij/en,}/w,)/w,$/w,表示/v,$/w,u/en,_,i/en,$/w,应该/v,比/p,$/w,u/en,_,j/en,$/w,排序/vn,更/d,靠/v,前/f,的/u,已知/nz,概率/n,，/w,则/d,可以/v,用/p,交叉/vn,熵/g,定义/n,优化/v,目标/n,的/u,损失/n,函数/n,：/w,$/w,$/w,c/en,=/w,-/w,\/w,overline/en,{/w,p/en,}/w,_,{/w,ij/en,}/w,log/en,{/w,p/en,_,{/w,ij/en,}/w,}/w,-/w,(/w,1/m,-/w,\/w,overline/en,{/w,p/en,}/w,_,{/w,ij/en,}/w,)/w,log/en,(/w,1/m,-/w,p/en,_,{/w,ij/en,}/w,)/w,$/w,$/w,如果/c,不/d,太/d,熟悉/v,什么/r,是/v,交叉/vn,熵/g,，/w,可以/v,参考/v,宗成庆/nr,老师/n,的/u,《/w,统计/v,自然/d,语言/n,处理/v,》/w,2.2节/mq,“/w,信息论/n,基本/a,概念/n,”/w,，/w,里面/f,将/d,熵/g,、/w,联合/v,熵/g,、/w,互/d,信息/n,、/w,相对/d,熵/g,、/w,交叉/vn,熵/g,和/c,困惑/a,度/q,等/u,概念/n,都/d,讲/v,得/u,相当/d,清楚/a,。/w,结合/v,以上/f,多/a,个/q,公式/n,，/w,可以/v,改写/v,损失/n,函数/n,$/w,c/en,$/w,为/p,：/w,$/w,$/w,c/en,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,-/w,s/en,_,{/w,ij/en,}/w,)/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,+/w,log/en,(/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,)/w,$/w,$/w,对于/p,$/w,s/en,_,{/w,ij/en,}/w,=/w,1/m,$/w,，/w,$/w,$/w,c/en,=/w,log/en,\/w,left/en,(/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,\/w,right/en,)/w,$/w,$/w,然而/c,对于/p,$/w,s/en,_,{/w,ij/en,}/w,=/w,-/w,1/m,$/w,，/w,$/w,$/w,c/en,=/w,log/en,\/w,left/en,(/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,j/en,-/w,s/en,_,i/en,)/w,}/w,\/w,right/en,)/w,$/w,$/w,可以/v,看出/v,损失/n,函数/n,$/w,c/en,$/w,具有/v,对称性/n,，/w,也/d,即/v,交换/v,$/w,i/en,$/w,和/c,$/w,j/en,$/w,的/u,位置/n,，/w,损失/n,函数/n,的/u,值/n,不/d,变/v,。/w,分析/vn,损失/n,函数/n,$/w,c/en,$/w,的/u,趋势/n,发现/v,，/w,如果/c,对/p,文档/n,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,的/u,打分/v,可以/v,正确/a,地/u,拟合/nz,标记/n,的/u,标签/n,，/w,则/d,$/w,c/en,$/w,趋向于/n,0/m,，/w,否则/c,$/w,c/en,$/w,趋向于/n,线性/n,函数/n,。/w,具体/a,地/u,，/w,假如/c,$/w,s/en,_,{/w,ij/en,}/w,=/w,1/m,$/w,，/w,也/d,即/v,$/w,u/en,_,i/en,$/w,应该/v,比/p,$/w,u/en,_,j/en,$/w,排序/vn,高/a,，/w,如果/c,$/w,s/en,_,i/en,>,s/en,_,j/en,$/w,，/w,则/d,拟合/nz,的/u,分数/n,可以/v,正确/a,排序/vn,文档/n,$/w,i/en,$/w,和/c,文档/n,$/w,j/en,$/w,，/w,$/w,$/w,\/w,lim/en, ,\/w,limits/en,_,{/w,s/en,_,i/en,-/w,s/en,_,j/en,\/w,rightarrow/en,\/w,infty/en,}/w,c/en,=/w,\/w,lim/en, ,\/w,limits/en,_,{/w,s/en,_,i/en,-/w,s/en,_,j/en,\/w,rightarrow/en,\/w,infty/en,}/w,log/en,\/w,left/en,(/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,\/w,right/en,)/w,=/w,log/en,1/m,=/w,0/m,$/w,$/w,如果/c,$/w,s/en,_,i/en,</w,s/en,_,j/en,$/w,，/w,则/d,拟合/nz,的/u,分数/n,不/d,能/v,正确/a,排序/vn,文档/n,$/w,i/en,$/w,和/c,文档/n,$/w,j/en,$/w,，/w,$/w,$/w,\/w,lim/en, ,\/w,limits/en,_,{/w,s/en,_,i/en,-/w,s/en,_,j/en,\/w,rightarrow/en,\/w,infty/en,}/w,c/en,=/w,\/w,lim/en, ,\/w,limits/en,_,{/w,s/en,_,i/en,-/w,s/en,_,j/en,\/w,rightarrow/en,\/w,infty/en,}/w,log/en,\/w,left/en,(/w,1/m,+/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,\/w,right/en,)/w,=/w,log/en,\/w,left/en,(/w,e/en,^,{/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,$/w,$/w,利用/v,神经/n,网络/n,对/p,模型/n,进行/v,训练/vn,，/w,目前/t,最/d,有效/a,的/u,方法/n,就/d,是/v,反向/f,传播/vn,算法/n,。/w,反向/f,传播/vn,算法/n,中/f,最/d,核心/n,部分/n,就/d,是/v,损失/n,函数/n,对/p,模型/n,参数/n,的/u,求导/nw,，/w,然后/c,可以/v,使用/v,下面/f,的/u,公式/n,对/p,模型/n,参数/n,进行/v,迭代/vn,更新/v,：/w,$/w,$/w,w/en,_,k/en,\/w,leftarrow/en,{/w,w/en,_,k/en,}/w,-/w,\/w,eta/en,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,=/w,{/w,w/en,_,k/en,}/w,-/w,\/w,eta/en,\/w,left/en,(/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,$/w,$/w,损失/n,函数/n,$/w,c/en,$/w,对/p,$/w,s/en,_,i/en,$/w,和/c,$/w,s/en,_,j/en,$/w,的/u,偏导/nw,数/m,为/p,：/w,$/w,$/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,=/w,\/w,sigma/en,\/w,left/en,(/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,-/w,s/en,_,{/w,ij/en,}/w,)/w,-/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,$/w,$/w,$/w,s/en,_,i/en,$/w,和/c,$/w,s/en,_,j/en,$/w,对/p,$/w,w/en,_,k/en,$/w,的/u,偏/d,导数/n,可/v,根据/p,神经/n,网络/n,求/v,偏/d,导数/n,的/u,方式/n,求得/v,。/w,求得/v,了/u,损失/n,函数/n,$/w,c/en,$/w,对/p,神经/n,网络/n,模型/n,参数/n,$/w,w/en,_,k/en,$/w,的/u,偏/d,导数/n,之后/f,，/w,就/d,可以/v,使用/v,梯度/n,下降/v,算法/n,对/p,其/r,更新/v,。/w,这里/r,的/u,学习率/nw,$/w,\/w,eta/en,$/w,也/d,是/v,一个/m,正数/v,，/w,因为/c,$/w,\/w,eta/en,$/w,需要/v,满足/v,下面/f,的/u,不等式/n,：/w,$/w,$/w,\/w,delta/en, ,c/en,=/w,\/w,sum/en,_,{/w,k/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,delta/en, ,w/en,_,k/en,=/w,\/w,sum/en,_,{/w,k/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,left/en,(/w,-/w,\/w,eta/en,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,eta/en,\/w,sum/en,_,{/w,k/en,}/w,\/w,left/en,(/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,^,2/m,</w,0/m,$/w,$/w,2.2/m, ,ranknet/en,分解/v,形式/n,：/w,加速/v,ranknet/en,训练/vn,过程/n,2.1节/mq,中/f,定义/n,的/u,ranknet/en,，/w,对于/p,每/r,一个/m,文档/n,对/p,$/w,(/w,u/en,_,i/en,$/w,,/w,$/w,u/en,_,j/en,)/w,$/w,都/d,将/d,计算/v,损失/n,函数/n,对/p,神经/n,网络/n,的/u,参数/n,$/w,w/en,_,k/en,$/w,的/u,偏/d,导数/n,，/w,然后/c,更新/v,模型/n,参数/n,$/w,w/en,_,k/en,$/w,。/w,这样/r,做/v,的/u,缺点/n,在于/v,，/w,对/p,模型/n,参数/n,更新/v,慢/a,，/w,耗时/v,长/a,。/w,所以/c,本节/t,讲解/v,如何/r,通过/p,分解/v,组合/v,的/u,方式/n,加快/v,这/r,一/m,训练/vn,过程/n,。/w,对于/p,给/p,定/v,的/u,文档/n,对/p,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,，/w,损失/n,函数/n,$/w,c/en,$/w,对/p,参数/n,$/w,w/en,_,k/en,$/w,的/u,偏导/nw,数/m,为/p,：/w,$/w,$/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,=/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,=/w,\/w,sigma/en,\/w,left/en,(/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,-/w,s/en,_,{/w,ij/en,}/w,)/w,-/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,\/w,right/en,)/w,\/w,left/en,(/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,=/w,\/w,lambda/en,_,{/w,ij/en,}/w,\/w,left/en,(/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,$/w,$/w,其中/r,：/w,$/w,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,=/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,=/w,\/w,sigma/en,\/w,left/en,(/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,-/w,s/en,_,{/w,ij/en,}/w,)/w,-/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,\/w,right/en,)/w,$/w,$/w,定义/n,$/w,i/en,$/w,为/p,索引/n,对/p,$/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,$/w,的/u,集合/v,，/w,在/p,不/d,损失/n,信息量/n,的/u,情况/n,下/f,，/w,可以/v,将/d,集合/v,$/w,i/en,$/w,中/f,的/u,索引/n,对/p,都/d,转换/v,成/v,满足/v,$/w,u/en,_,i/en, ,\/w,rhd/en, ,u/en,_,j/en,$/w,的/u,形式/n,。/w,另外/c,集合/v,$/w,i/en,$/w,中/f,的/u,索引/n,对/p,还/d,应该/v,满足/v,最/d,多/a,只/d,出现/v,一次/mq,的/u,条件/n,。/w,在/p,此/r,基础/n,上/f,，/w,累/a,加权/v,重/a,参数/n,$/w,w/en,_,k/en,$/w,的/u,更新量/nw,：/w,$/w,$/w,\/w,delta/en, ,w/en,_,k/en,=/w,-/w,\/w,eta/en,\/w,sum/en,_,{/w,(/w,i/en,,/w,j/en,)/w, ,\/w,in/en, ,i/en,}/w,\/w,left/en,(/w,\/w,lambda/en,_,{/w,ij/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,lambda/en,_,{/w,ij/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,eta/en,\/w,sum/en,_,{/w,i/en,}/w,\/w,lambda/en,_,i/en,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,$/w,$/w,其中/r,：/w,$/w,$/w,\/w,lambda/en,_,i/en,=/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,-/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,j/en,,/w,i/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,$/w,通俗/a,地/u,说/v,，/w,$/w,\/w,lambda/en,_,i/en,$/w,就/d,是/v,集合/v,$/w,i/en,$/w,中/f,所有/b,$/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,$/w,的/u,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,的/u,和/c,$/w,-/w,$/w,集合/v,$/w,i/en,$/w,中/f,所有/b,$/w,\/w,{/w,j/en,,/w,i/en,\/w,}/w,$/w,的/u,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,的/u,和/c,。/w,如果/c,还是/c,不/d,太/d,明白/v,，/w,那/r,看/v,下面/f,这个/r,例子/n,就/d,明白/v,了/u,。/w,集合/v,$/w,i/en,=/w,\/w,{/w,\/w,{/w,1/m,,/w,2/m,\/w,}/w,,/w,\/w,{/w,2/m,,/w,3/m,\/w,}/w,,/w,\/w,{/w,1/m,,/w,3/m,\/w,}/w,\/w,}/w,$/w,，/w,则/d,$/w,$/w,\/w,delta/en, ,w/en,_,k/en,=/w,-/w,\/w,eta/en,\/w,sum/en,_,{/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,\/w,in/en, ,i/en,}/w,\/w,left/en,(/w,\/w,lambda/en,_,{/w,ij/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,lambda/en,_,{/w,ij/en,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,j/en,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,eta/en,\/w,left/en,(/w,\/w,lambda/en,_,{/w,12/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,lambda/en,_,{/w,12/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,\/w,lambda/en,_,{/w,13/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,lambda/en,_,{/w,13/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,\/w,lambda/en,_,{/w,23/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,-/w,\/w,lambda/en,_,{/w,23/m,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,=/w,-/w,\/w,eta/en,\/w,left/en,(/w,(/w,\/w,lambda/en,_,{/w,12/m,}/w,+/w,\/w,lambda/en,_,{/w,13/m,}/w,)/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,(/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,12/m,}/w,)/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,+/w,(/w,-/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,13/m,}/w,)/w,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,k/en,}/w,}/w,\/w,right/en,)/w,$/w,$/w,于是/c,可以/v,得到/v,$/w,\/w,lambda/en,_,1/m,=/w,\/w,lambda/en,_,{/w,12/m,}/w,+/w,\/w,lambda/en,_,{/w,13/m,}/w,$/w,，/w,$/w,\/w,lambda/en,_,2/m,=/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,12/m,}/w,$/w,，/w,$/w,\/w,lambda/en,_,3/m,=/w,-/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,13/m,}/w,$/w,$/w,\/w,lambda/en,_,i/en,$/w,可以/v,看成/v,是/v,作用/n,在/p,排序/vn,文档/n,上/f,的/u,力/n,，/w,其/r,正负/n,代表/n,了/u,方向/n,，/w,长度/n,代表/n,了/u,力/n,的/u,大小/n,。/w,最初/d,的/u,实现/v,是/v,对/p,每个/r,文档/n,对/p,，/w,都/d,计算/v,一遍/mq,梯度/n,并且/c,更新/v,神经/n,网络/n,的/u,参数/n,值/n,，/w,而/c,这里/r,则/d,是/v,将/d,同一/b,个/q,query/en,下/f,的/u,所有/b,文档/n,对/p,进行/v,叠加/vn,，/w,然后/c,更新/v,一次/mq,网络/n,的/u,权重/nz,参数/n,。/w,这种/r,分解/v,组合/v,形式/n,实际上/d,就/d,是/v,一种/mq,小/a,批量/d,学习/v,方法/n,，/w,不仅/c,可以/v,加快/v,迭代/vn,速度/n,，/w,还/d,可以/v,为/p,后面/f,使用/v,非/h,连续/a,的/u,梯度/n,模型/n,打下/v,基础/n,。/w,2.3/m, ,模型/n,训练/vn,过程/n,示例/n,假设/v,某个/r,搜索/vn,系统/n,中/f,，/w,文档/n,用/p,2维/mq,的/u,特征/n,向/p,量/n,表示/v,。/w,给/p,定/v,一个/m,query/en,下/f,的/u,三个/m,文档/n,向/p,量/n,分别/d,为/p,$/w,x/en,_,1/m,=/w,(/w,5/m,,/w,4.5/m,)/w,^,t/en,$/w,，/w,$/w,x/en,_,2/m,=/w,(/w,4/m,,/w,3.7/m,)/w,^,t/en,$/w,和/c,$/w,x/en,_,3/m,=/w,(/w,2/m,,/w,1.8/m,)/w,^,t/en,$/w,，/w,标记/n,情况/n,为/p,$/w,u/en,_,1/m, ,\/w,rhd/en, ,u/en,_,2/m, ,\/w,rhd/en, ,u/en,_,3/m,$/w,。/w,为了/p,简化/v,训练/vn,过程/n,，/w,这里/r,采用/v,单层/nw,的/u,神经/n,网络/n,模型/n,，/w,即/v,输入/v,层/q,大小/n,2/m,，/w,输出/v,层/q,大小/n,为/p,1/m,，/w,输出/v,值/n,为/p,$/w,f/en,(/w,x/en,)/w,=/w,w/en,_,0/m,+/w,w/en,_,1/m,x/en,^,{/w,(/w,1/m,)/w,}/w,+/w,w/en,_,2/m,x/en,^,{/w,(/w,2/m,)/w,}/w,$/w,。/w,初始化/v,$/w,\/w,mathbf/en,{/w,w/en,}/w,=/w,[/w,0/m,,/w, ,-/w,1/m,,/w, ,1/m,]/w,$/w,，/w,控制/v,sigmoid/en,函数/n,形状/n,的/u,$/w,\/w,sigma/en,=/w,0.1/m,$/w,，/w,神经/n,网络/n,学习率/nw,$/w,\/w,eta/en,=/w,0.1/m,$/w,。/w,根据/p,以上/f,初始值/n,可以/v,计算/v,出/v,$/w,s/en,_,1/m,=/w,-/w,0.5/m,$/w,，/w,$/w,s/en,_,2/m,=/w,-/w,0.3/m,$/w,和/c,$/w,s/en,_,3/m,=/w,-/w,0.2/m,$/w,，/w,可见/v,此时/r,三个/m,文档/n,输出/v,的/u,分数/n,并/c,不/d,满足/v,标记/n,$/w,u/en,_,1/m, ,\/w,rhd/en, ,u/en,_,2/m, ,\/w,rhd/en, ,u/en,_,3/m,$/w,。/w,计算/v,$/w,\/w,lambda/en,_,1/m,=/w,\/w,lambda/en,_,{/w,12/m,}/w,+/w,\/w,lambda/en,_,{/w,13/m,}/w,=/w,-/w,0.1012/m,$/w,，/w,$/w,\/w,lambda/en,_,2/m,=/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,12/m,}/w,=/w,0.0002/m,$/w,，/w,$/w,\/w,lambda/en,_,3/m,=/w,-/w,\/w,lambda/en,_,{/w,23/m,}/w,-/w,\/w,lambda/en,_,{/w,13/m,}/w,=/w,-/w,0.1010/m,$/w,。/w,$/w,\/w,delta/en, ,w/en,_,0/m,=/w,-/w,\/w,eta/en,\/w,left/en,(/w,\/w,lambda/en,_,1/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,0/m,}/w,}/w,+/w,\/w,lambda/en,_,2/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,0/m,}/w,}/w,+/w,\/w,lambda/en,_,3/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,0/m,}/w,}/w,\/w,right/en,)/w,=/w,0/m,$/w,$/w,\/w,delta/en, ,w/en,_,1/m,=/w,-/w,\/w,eta/en,\/w,left/en,(/w,\/w,lambda/en,_,1/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,1/m,}/w,}/w,+/w,\/w,lambda/en,_,2/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,1/m,}/w,}/w,+/w,\/w,lambda/en,_,3/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,1/m,}/w,}/w,\/w,right/en,)/w,=/w,3.032/m,$/w,$/w,\/w,delta/en, ,w/en,_,2/m,=/w,-/w,\/w,eta/en,\/w,left/en,(/w,\/w,lambda/en,_,1/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,1/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,2/m,}/w,}/w,+/w,\/w,lambda/en,_,2/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,2/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,2/m,}/w,}/w,+/w,\/w,lambda/en,_,3/m,\/w,frac/en,{/w,\/w,partial/en,{/w,s/en,_,3/m,}/w,}/w,{/w,\/w,partial/en,{/w,w/en,_,2/m,}/w,}/w,\/w,right/en,)/w,=/w,2.7286/m,$/w,更新/v,网络/n,权重/nz,:/w,$/w,w/en,_,0/m,=/w,w/en,0/m,+/w,\/w,delta/en, ,w/en,_,0/m,=/w,0/m,+/w,0/m,=/w,0/m,$/w,$/w,w/en,_,1/m,=/w,w/en,1/m,+/w,\/w,delta/en, ,w/en,_,1/m,=/w,-/w,1/m,+/w,3.032/m,=/w,2.032/m,$/w,$/w,w/en,_,2/m,=/w,w/en,2/m,+/w,\/w,delta/en, ,w/en,_,2/m,=/w,1/m,+/w,2.7286/m,=/w,3.7286/m,$/w,使用/v,更新/v,后/f,的/u,权重/nz,重新/d,计算/v,三个/m,文档/n,的/u,分数/n,，/w,分别/d,为/p,$/w,s/en,_,1/m,=/w,26.9387/m,$/w,，/w,$/w,s/en,_,2/m,=/w,21.92382/m,$/w,，/w,$/w,s/en,_,3/m,=/w,10.77548/m,$/w,。/w,可见/v,，/w,经过/p,一轮/mq,训练/vn,，/w,单层/nw,神经/n,网络/n,的/u,输出/v,分数/n,已经/d,可以/v,很/d,好/a,地/u,拟合/nz,标记/n,的/u,标签/n,。/w,3/m,./w, ,信息/n,检索/v,评分/vn,信息/n,检索/v,研究者/n,经常/d,使用/v,的/u,排序/vn,质量/n,评分/vn,指标/n,有/v,以下/f,四种/mq,：/w,mrr/en,(/w,mean/en, ,reciprocal/en, ,rank/en,)/w,，/w,平均/a,倒数/v,排名/v,map/en,(/w,mean/en, ,average/en, ,precision/en,)/w,，/w,平均/a,正确率/n,均值/n,ndcg/en,(/w,normalized/en, ,discounted/en, ,cumulative/en, ,gain/en,)/w,，/w,归/v,一化/nw,折损/nz,累积/vn,增益/v,err/en,(/w,expected/en, ,reciprocal/en, ,rank/en,)/w,，/w,预期/vn,倒数/v,排名/v,其中/r,，/w,mrr/en,和/c,map/en,只能/v,对/p,二级/b,的/u,相关性/n,（/w,排序/vn,等级/n,：/w,相关/v,和/c,不/d,相关/v,）/w,进行/v,评分/vn,，/w,而/c,ndcg/en,和/c,err/en,则/d,可以/v,对/p,多级/b,的/u,相关性/n,（/w,排序/vn,等级/n,>,2/m,）/w,进行/v,评分/vn,。/w,ndcg/en,和/c,err/en,的/u,另/r,一个/m,优点/n,是/v,更/d,关注/v,排名/v,靠/v,前/f,的/u,文档/n,，/w,在/p,计算/v,分数/n,时/ng,会/v,给予/v,排名/v,靠/v,前/f,的/u,文档/n,更/d,高/a,的/u,权重/nz,。/w,但是/c,这/r,两种/mq,评分/vn,方式/n,的/u,缺点/n,是/v,函数/n,不/d,连续/a,，/w,不/d,能/v,进行/v,求导/nw,，/w,所以/c,也/d,就/d,不能/v,简单/a,地/u,将/d,这/r,两种/mq,评分/vn,方式/n,加入/v,到/v,模型/n,的/u,损失/n,函数/n,中/f,去/v,。/w,3.1/m, ,mrr/en,对于/p,一个/m,查询/v,$/w,i/en,$/w,来说/u,，/w,$/w,rank/en,_,i/en,$/w,表示/v,第一/m,个/q,相关/v,结果/n,的/u,排序/vn,位置/n,，/w,所以/c,：/w,$/w,$/w,mrr/en,(/w,q/en,)/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,|/w,q/en,|/w,}/w,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,|/w,q/en,|/w,}/w,\/w,frac/en,{/w,1/m,}/w,{/w,rank/en,_,i/en,}/w,$/w,$/w,$/w,|/w,q/en,|/w,$/w,表示/v,查询/v,的/u,数量/n,，/w,$/w,mrr/en,$/w,表示/v,搜索/vn,系统/n,在/p,查询/v,集/vg,$/w,q/en,$/w,下/f,的/u,平均/a,倒数/v,排名值/nw,。/w,$/w,mrr/en,$/w,只能/v,度量/v,检索/v,结果/n,只/d,有/v,一个/m,并且/c,相关性/n,等级/n,只有/c,相关/v,和/c,不/d,相关/v,两种/mq,的/u,情况/n,。/w,举/v,个/q,简单/a,例子/n,：/w,查询/v,语句/n,查询/v,结果/n,正确/a,结果/n,排序/vn,位置/n,排序/vn,倒数/v,机器/n,学习/v,快速/d,排序/vn,，/w,深度/n,学习/v,，/w,并行/v,计算/v,深度/n,学习/v,21/m,//w,2/m,苹果/n,手机/n,小米/n,手机/n,，/w,华为/nz,手机/n,，/w,iphone/en, ,7/m,iphone/en, ,731/m,//w,3/m,小米/n,移动/vn,电源/n,小米/n,移动/vn,电源/n,，/w,华为/nz,充电器/n,，/w,苹果/n,充电/v,插头/n,小米/n,移动/vn,电源/n,11/m,//w,1/m,所以/c,$/w,mrr/en,(/w,q/en,)/w,=/w,\/w,frac/en,{/w,1/m,//w,2/m,+/w,1/m,//w,3/m,+/w,1/m,}/w,{/w,3/m,}/w,=/w,\/w,frac/en,{/w,11/m,}/w,{/w,18/m,}/w,$/w,3.2/m, ,map/en,假定/v,信息/n,需求/n,$/w,q/en,_,j/en, ,\/w,in/en, ,q/en,$/w,对应/v,的/u,所有/b,相关/v,文档/n,集合/v,为/p,$/w,{/w,d/en,_,{/w,1/m,}/w,,/w,./w,./w,./w,,/w,d/en,_,{/w,mj/en,}/w,}/w,$/w,，/w,$/w,r/en,_,{/w,jk/en,}/w,$/w,是/v,返回/v,结果/n,中/f,直到/v,遇到/v,$/w,d/en,_,k/en,$/w,后/f,其/r,所在/n,位置/n,前/f,（/w,含/v,$/w,d/en,_,k/en,$/w,）/w,的/u,所有/b,文档/n,的/u,集合/v,，/w,则/d,定义/n,$/w,map/en,(/w,q/en,)/w,^,2/m,$/w,如下/v,：/w,$/w,$/w,map/en,(/w,q/en,)/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,|/w,q/en,|/w,}/w,\/w,sum/en,_,{/w,j/en,=/w,1/m,}/w,^,{/w,|/w,q/en,|/w,}/w,\/w,frac/en,{/w,1/m,}/w,{/w,m/en,_,j/en,}/w,\/w,sum/en,_,{/w,k/en,=/w,1/m,}/w,^,{/w,m/en,_,j/en,}/w,precision/en,(/w,r/en,_,{/w,jk/en,}/w,)/w,$/w,$/w,实际上/d,有/v,两种/mq,计算/v,$/w,map/en,$/w,的/u,方法/n,或者/c,说/v,有/v,两种/mq,$/w,map/en,(/w,q/en,)/w,$/w,的/u,定义/n,方法/n,。/w,第一/m,种/q,方法/n,是/v,在/p,每篇/r,相关/v,文档/n,所在/n,位置/n,上/f,求/v,正确率/n,然后/c,平均/a,（/w,参考/v,上面/f,的/u,公式/n,）/w,。/w,另/r,一种/mq,是/v,在/p,每个/r,召回/v,率/v,水平/n,上/f,计算/v,此时/r,的/u,插值/nw,正确率/n,，/w,然后/c,求/v,11点/mq,平均/a,正确率/n,，/w,最后/f,在/p,不同/a,查询/v,之间/f,计算/v,平均/a,。/w,前者/r,也/d,称为/v,非/h,插值/nw,$/w,map/en,(/w,q/en,)/w,$/w,。/w,一般/a,提/v,$/w,map/en,(/w,q/en,)/w,$/w,都/d,指/v,前者/r,，/w,所有/b,这里/r,也/d,只/d,讨论/v,前者/r,。/w,如果/c,对/p,定义/n,的/u,公式/n,不/d,太/d,理解/v,，/w,可以/v,结合/v,下面/f,的/u,例子/n,进行/v,理解/v,。/w,查询/v,1/m,：/w,机器/n,学习/v,查询/v,2/m,：/w,苹果/n,手机/n,排序/vn,位置/n,是否/v,相关/v,排序/vn,位置/n,是否/v,相关/v,1/m,是/v,1/m,否/vg,2/m,是/v,2/m,是/v,3/m,否/vg,3/m,是/v,4/m,否/vg,4/m,否/vg,5/m,是/v,5/m,否/vg,6/m,否/vg,6/m,是/v,7/m,否/vg,7/m,是/v,针对/p,上面/f,检索/v,的/u,结果/n,，/w,可/v,计算/v,出/v,$/w,ap/en,(/w,1/m,)/w,=/w,\/w,left/en,(/w,1/m,*/w,1/m,+/w,1/m,*/w,1/m,+/w,2/m,//w,3/m,*/w,0/m,+/w,2/m,//w,4/m,*/w,0/m,+/w,3/m,//w,5/m,*/w,1/m,+/w,3/m,//w,6/m,*/w,0/m,+/w,3/m,//w,7/m,*/w,0/m,\/w,right/en,)/w,//w,3/m,=/w,\/w,frac/en,{/w,13/m,}/w,{/w,15/m,}/w,$/w,$/w,ap/en,(/w,2/m,)/w,=/w,\/w,left/en,(/w,0/m,*/w,0/m,+/w,1/m,//w,2/m,*/w,1/m,+/w,2/m,//w,3/m,*/w,1/m,+/w,2/m,//w,4/m,*/w,0/m,+/w,2/m,//w,5/m,*/w,0/m,+/w,3/m,//w,6/m,*/w,1/m,+/w,4/m,//w,7/m,*/w,1/m,\/w,right/en,)/w,//w,4/m,=/w,\/w,frac/en,{/w,47/m,}/w,{/w,84/m,}/w,$/w,$/w,map/en,(/w,q/en,)/w,=/w,\/w,frac/en,{/w,ap/en,(/w,1/m,)/w,+/w,ap/en,(/w,2/m,)/w,}/w,{/w,2/m,}/w,=/w,\/w,frac/en,{/w,13/m,//w,15/m,+/w,47/m,//w,84/m,}/w,{/w,2/m,}/w,=/w,\/w,frac/en,{/w,599/m,}/w,{/w,420/m,}/w,$/w,3.3/m, ,ndcgndcg/en,是/v,基于/p,前/f,$/w,k/en,$/w,个/q,检索/v,结果/n,进行/v,计算/v,的/u,。/w,设/v,$/w,r/en,(/w,j/en,,/w,m/en,)/w,$/w,是/v,评价/v,人员/n,给/p,出/v,的/u,文档/n,$/w,d/en,$/w,对/p,查询/v,$/w,j/en,$/w,的/u,相关性/n,得分/n,，/w,那么/r,有/v,：/w,$/w,$/w,ndcg/en,(/w,q/en,,/w,k/en,)/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,|/w,q/en,|/w,}/w,\/w,sum/en,_,{/w,j/en,=/w,1/m,}/w,^,{/w,|/w,q/en,|/w,}/w,z/en,_,{/w,j/en,,/w,k/en,}/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,k/en,}/w,\/w,frac/en,{/w,2/m,^,{/w,r/en,(/w,j/en,,/w,m/en,)/w,}/w,-/w,1/m,}/w,{/w,log/en,(/w,1/m,+/w,m/en,)/w,}/w,$/w,$/w,其中/r,$/w,$/w,dcg/en,_,k/en,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,k/en,}/w,\/w,frac/en,{/w,2/m,^,{/w,r/en,(/w,j/en,,/w,m/en,)/w,}/w,-/w,1/m,}/w,{/w,log/en,(/w,1/m,+/w,m/en,)/w,}/w,$/w,$/w,$/w,z/en,_,{/w,j/en,,/w,k/en,}/w,$/w,为/p,第/m,$/w,j/en,$/w,个/q,查询/v,的/u,dcg/en,归/v,一化/nw,因子/n,，/w,用于/v,保证/v,对于/p,查询/v,$/w,j/en,$/w,最/d,完美/a,系统/n,的/u,$/w,dcg/en,_,k/en,$/w,得分/n,是/v,1/m,。/w,$/w,z/en,_,{/w,j/en,,/w,k/en,}/w,$/w,也/d,可以/v,用/p,$/w,\/w,frac/en,{/w,1/m,}/w,{/w,idcg/en,_,k/en,}/w,$/w,表示/v,。/w,$/w,m/en,$/w,是/v,返回/v,文档/n,的/u,位置/n,。/w,如果/c,某/r,查询/v,返回/v,的/u,文档/n,数/m,$/w,k/en,'/w,</w,k/en,$/w,，/w,那么/r,上述/b,公式/n,只/d,需要/v,计算/v,到/v,$/w,k/en,'/w,$/w,为止/u,。/w,修改/v,上面/f,简单/a,的/u,例子/n,进行/v,辅助/vn,理解/v,：/w,查询/v,1/m,：/w,机器/n,学习/v,查询/v,2/m,：/w,苹果/n,手机/n,排序/vn,位置/n,相关/v,程度/n,排序/vn,位置/n,相关/v,程度/n,1312222233334041515262637271/m,对于/p,查询/v,1/m,：/w,机器/n,学习/v,:/w,$/w,$/w,dcg/en,_,7/m,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,7/m,}/w,\/w,frac/en,{/w,2/m,^,{/w,r/en,(/w,j/en,,/w,m/en,)/w,}/w,-/w,1/m,}/w,{/w,log/en,(/w,1/m,+/w,m/en,)/w,}/w,=/w,21.421516/m,$/w,$/w,查询/v,1/m,返回/v,结果/n,的/u,最佳/z,相关/v,程度/n,排序/vn,为/p,：/w,3/m,,/w,3/m,,/w,2/m,,/w,2/m,,/w,2/m,,/w,1/m,,/w,0/m,，/w,所以/c,，/w,$/w,idcg/en,_,7/m,=/w,22.686817/m,$/w,，/w,$/w,ndcg/en,_,7/m,=/w,\/w,frac/en,{/w,dcg/en,_,7/m,}/w,{/w,idcg/en,_,7/m,}/w,=/w,0.944227/m,$/w,对于/p,查询/v,2/m,：/w,苹果/n,手机/n,:/w,$/w,$/w,dcg/en,_,7/m,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,7/m,}/w,\/w,frac/en,{/w,2/m,^,{/w,r/en,(/w,j/en,,/w,m/en,)/w,}/w,-/w,1/m,}/w,{/w,log/en,(/w,1/m,+/w,m/en,)/w,}/w,=/w,18.482089/m,$/w,$/w,查询/v,2/m,返回/v,结果/n,的/u,最佳/z,相关/v,程度/n,排序/vn,为/p,：/w,3/m,,/w,3/m,,/w,2/m,,/w,2/m,,/w,2/m,,/w,1/m,,/w,1/m,，/w,所以/c,，/w,$/w,idcg/en,_,7/m,=/w,23.167716/m,$/w,，/w,$/w,ndcg/en,_,7/m,=/w,\/w,frac/en,{/w,dcg/en,_,7/m,}/w,{/w,idcg/en,_,7/m,}/w,=/w,0.797752/m,$/w,最后/f,可/v,得/u,：/w,$/w,ndcg/en,(/w,q/en,,/w,7/m,)/w,=/w,(/w,0.944227/m,+/w,0.797752/m,)/w,//w,2/m,=/w,0.870990/m,$/w,3.4/m, ,err/en,$/w,err/en,^,3/m,$/w,旨在/v,改善/v,ndcg/en,计算/v,当前/t,结果/n,时/ng,未/d,考虑/v,排/v,在/p,前面/f,结果/n,的/u,影响/vn,的/u,缺点/n,，/w,提出/v,了/u,一种/mq,基于/p,级/q,联/vg,模型/n,的/u,评价/v,指标/n,。/w,首先/d,定义/n,：/w,$/w,$/w,r/en,(/w,g/en,)/w,=/w,\/w,frac/en,{/w,2/m,^,g/en,-/w,1/m,}/w,{/w,2/m,^,{/w,g/en,_,{/w,max/en,}/w,}/w,}/w,,/w, ,g/en, ,\/w,in/en, ,\/w,{/w,0/m,,/w,1/m,,/w,./w,./w,./w,,/w,g/en,_,{/w,max/en,}/w,\/w,}/w,$/w,$/w,$/w,g/en,$/w,代表/n,文档/n,的/u,得分/n,级别/n,，/w,$/w,g/en,_,{/w,max/en,}/w,$/w,代表/n,最/d,大/a,的/u,分数/n,级别/n,。/w,于是/c,定义/n,：/w,$/w,$/w,err/en,=/w,\/w,sum/en,_,{/w,r/en,=/w,1/m,}/w,^,{/w,n/en,}/w,\/w,frac/en,{/w,1/m,}/w,{/w,r/en,}/w,\/w,prod/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,r/en,-/w,1/m,}/w,(/w,1/m,-/w,r/en,_,i/en,)/w,r/en,_,r/en,$/w,$/w,展开/v,公式/n,如下/v,：/w,$/w,$/w,err/en,=/w,r/en,_,1/m,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,1/m,-/w,r/en,_,1/m,)/w,r/en,_,2/m,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,3/m,}/w,(/w,1/m,-/w,r/en,_,1/m,)/w,(/w,1/m,-/w,r/en,_,2/m,)/w,r/en,_,3/m,+/w,./w,./w,./w,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,n/en,}/w,(/w,1/m,-/w,r/en,_,1/m,)/w,(/w,1/m,-/w,r/en,_,2/m,)/w,./w,./w,./w,(/w,1/m,-/w,r/en,_,{/w,n/en,-/w,1/m,}/w,)/w,r/en,_,n/en,$/w,$/w,举例来说/l,(/w,$/w,g/en,_,{/w,max/en,}/w,=/w,3/m,$/w,)/w,:/w,查询/v,：/w,机器/n,学习/v,排序/vn,位置/n,相关/v,程度/n,13223341/m,$/w,r/en,_,1/m,=/w,0.875/m,,/w,r/en,2/m,=/w,0.375/m,,/w,r/en,_,3/m,=/w,0.875/m,,/w,r/en,_,4/m,=/w,0.125/m,$/w,$/w,err/en,=/w,0.875/m,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,*/w,0.125/m,*/w,0.375/m,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,3/m,}/w,*/w,0.125/m,*/w,0.625/m,*/w,0.875/m,+/w,\/w,frac/en,{/w,1/m,}/w,{/w,4/m,}/w,*/w,0.125/m,*/w,0.625/m,*/w,0.125/m,*/w,0.125/m,=/w,0.913391/m,$/w,4/m,./w, ,lambdarank/en,4.1/m, ,为什么/r,需要/v,lambdarank/en,先/d,看/v,一张/mq,论文/n,原文/n,中/f,的/u,图/n,，/w,如下/v,所/u,示/vg,。/w,这/r,是/v,一组/mq,用/p,二元/b,等级/n,相关性/n,进行/v,排序/vn,的/u,链接/n,地址/n,，/w,其中/r,浅/a,灰色/n,代表/n,链接/n,与/p,query/en,不/d,相关/v,，/w,深蓝色/n,代表/n,链接/n,与/p,query/en,相关/v,。/w, ,对于/p,左边/f,来说/u,，/w,总/b,的/u,pairwise/en,误差/n,为/p,13/m,，/w,而/c,右边/f,总/b,的/u,pairwise/en,误差/n,为/p,11/m,。/w,但是/c,大多数/m,情况/n,下/f,我们/r,更/d,期望/v,能/v,得到/v,左边/f,的/u,结果/n,。/w,这/r,说明/v,最/d,基本/a,的/u,pairwise/en,误差/n,计算/v,方式/n,并/c,不/d,能/v,很/d,好/a,地/u,模拟/b,用户/n,对/p,搜索引擎/n,的/u,期望/v,。/w,右边/f,黑色/n,箭头/n,代表/n,ranknet/en,计算/v,出/v,的/u,梯度/n,大小/n,，/w,红色/n,箭头/n,是/v,期望/v,的/u,梯度/n,大小/n,。/w,ndcg/en,和/c,err/en,在/p,计算/v,误差/n,时/ng,，/w,排名/v,越/d,靠/v,前/f,权/n,重/a,越/d,大/a,，/w,可以/v,很/d,好/a,地/u,解决/v,ranknet/en,计算/v,误差/n,时/ng,的/u,缺点/n,。/w,但是/c,ndcg/en,和/c,err/en,均/d,是/v,不可导/nw,的/u,函数/n,，/w,如何/r,加入/v,到/v,ranknet/en,的/u,梯度/n,计算/v,中/f,去/v,？/w,4.2/m, , ,lambdarank/en,定义/n,ranknet/en,中/f,的/u,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,可以/v,看成/v,是/v,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,中间/f,的/u,作用力/n,，/w,如果/c,$/w,u/en,_,i/en, ,\/w,rhd/en, ,u/en,_,j/en,$/w,，/w,则/d,$/w,u/en,_,j/en,$/w,会/v,给予/v,$/w,u/en,_,i/en,$/w,向上/v,的/u,大小/n,为/p,$/w,|/w,\/w,lambda/en,_,{/w,ij/en,}/w,|/w,$/w,的/u,推动力/n,，/w,而/c,对应/v,地/u,$/w,u/en,_,i/en,$/w,会/v,给予/v,$/w,u/en,_,j/en,$/w,向/p,下/f,的/u,大小/n,为/p,$/w,|/w,\/w,lambda/en,_,{/w,ij/en,}/w,|/w,$/w,的/u,推动力/n,。/w,如何/r,将/d,ndcg/en,等/u,类似/v,更/d,关注/v,排名/v,靠/v,前/f,的/u,搜索/vn,结果/n,的/u,评价/v,指标/n,加入/v,到/v,排序/vn,结果/n,之间/f,的/u,推动力/n,中/f,去/v,呢/y,？/w,实验/vn,表明/v,，/w,直接/ad,用/p,$/w,|/w,\/w,delta/en,_,{/w,ndcg/en,}/w,|/w,$/w,乘/v,以/p,原来/d,的/u,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,就/d,可以/v,得到/v,很/d,好/a,的/u,效果/n,，/w,也/d,即/v,：/w,$/w,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,=/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,=/w,\/w,frac/en,{/w,-/w,\/w,sigma/en,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,|/w,\/w,delta/en,_,{/w,ndcg/en,}/w,|/w,$/w,$/w,其中/r,$/w,|/w,\/w,delta/en,_,{/w,ndcg/en,}/w,|/w,$/w,是/v,交换/v,排序/vn,结果/n,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,得到/v,的/u,ndcg/en,差值/n,。/w,ndcg/en,倾向/n,于/p,将/d,排名/v,高/a,并且/c,相关性/n,高/a,的/u,文档/n,更/d,快/a,地/u,向上/v,推动/v,，/w,而/c,排名/v,地/u,而且/c,相关性/n,较/d,低/a,的/u,文档/n,较/d,慢/a,地/u,向上/v,推动/v,。/w,另外/c,还/d,可以/v,将/d,$/w,|/w,\/w,delta/en,_,{/w,ndcg/en,}/w,|/w,$/w,替换/v,成/v,其他/r,的/u,评价/v,指标/n,。/w,5/m,./w, ,lambdamart/en,5.1/m, ,martlambdamart/en,是/v,mart/en,和/c,lambdarank/en,的/u,结合/v,，/w,所以/c,要/v,学习/v,lambdamart/en,首先/d,得/u,了解/v,什么/r,是/v,mart/en,。/w,mart/en,是/v,multiple/en, ,additive/en, ,regression/en, ,tree/en,的/u,简称/v,，/w,很多/m,时候/n,又/d,称为/v,gbdt/en,（/w,gradient/en, ,boosting/en, ,decision/en, ,tree/en,）/w,。/w,mart/en,是/v,一种/mq,集成/vn,学习/v,算法/n,，/w,不/d,同于/c,经典/n,的/u,集成/vn,学习/v,算法/n,adaboost/en,利用/v,前/f,一轮/mq,学习器/nw,的/u,误差/n,来/v,更新/v,下/f,一轮/mq,学习/v,的/u,样本/n,权重/nz,，/w,mart/en,每次/r,都/d,拟/v,合/v,上/f,一轮/mq,分类器/nw,产生/v,的/u,残差/nw,。/w,举/v,个/q,例子/n,便于/v,理解/v,，/w,比如/v,一个/m,人/n,的/u,年龄/n,是/v,50岁/mq,，/w,第一/m,棵/q,树/v,拟合/nz,的/u,结果/n,是/v,35岁/mq,，/w,第一/m,轮/q,的/u,残差/nw,为/p,15岁/mq,；/w,然后/c,第二/m,棵/q,数/m,拟合/nz,的/u,结果/n,是/v,10岁/mq,，/w,两棵/mq,树/v,相加/v,总/b,的/u,拟合/nz,结果/n,是/v,45岁/mq,，/w,第二/m,轮/q,的/u,残差/nw,为/p,5岁/mq,；/w,第三/nw,棵/q,数/m,拟合/nz,的/u,结果/n,为/p,2岁/mq,，/w,三棵/mq,树/v,相加/v,拟合/nz,的/u,结果/n,是/v,47岁/mq,，/w,第/m,三轮/n,的/u,残差/nw,是/v,3岁/mq,./w,./w,./w,./w,./w,./w,只要/c,如此/r,不断/d,地/u,进行/v,下去/v,，/w,拟合/nz,结果/n,就/d,可以/v,达到/v,50岁/mq,，/w,拟合/nz,残差/nw,的/u,过程/n,就/d,是/v,训练/vn,数据/n,的/u,过程/n,。/w,对于/p,一个/m,给/p,定/v,的/u,数据/n,集/vg,$/w,\/w,{/w,x/en,_,i/en,,/w,y/en,_,i/en,\/w,}/w,,/w, ,i/en,=/w,1/m,,/w,2/m,,/w,./w,./w,./w,,/w,m/en,$/w,，/w,其中/r,特征/n,向/p,量/n,$/w,x/en,_,i/en, ,\/w,in/en, ,\/w,mathbb/en,{/w,r/en,}/w,^,n/en,$/w,，/w,标签/n,$/w,y/en,_,i/en, ,\/w,in/en, ,\/w,mathbb/en,{/w,r/en,}/w,$/w,，/w,可以/v,用/p,$/w,x/en,_,{/w,ij/en,}/w,,/w, ,j/en,=/w,1/m,,/w,2/m,,/w,./w,./w,./w,,/w,d/en,来/v,代表/n,x/en,_,i/en,的/u,第/m,j/en,个/q,特征值/n,$/w,。/w,对于/p,一个/m,典型/n,的/u,回归/v,决策/n,树/v,问题/n,，/w,需要/v,遍历/nw,所有/b,特征/n,$/w,j/en,$/w,的/u,全部/m,阈值/n,$/w,t/en,$/w,，/w,找到/v,最/d,优/ag,的/u,$/w,j/en,$/w,和/c,$/w,t/en,$/w,使/v,下面/f,的/u,等式/n,最小化/nw,：/w,$/w,$/w,s/en,_,j/en,=/w,\/w,sum/en,_,{/w,i/en, ,\/w,in/en, ,l/en,}/w,(/w,y/en,_,i/en,-/w,\/w,mu/en,_,l/en,)/w,^,2/m,+/w,\/w,sum/en,_,{/w,i/en, ,\/w,in/en, ,r/en,}/w,(/w,y/en,_,i/en,-/w,\/w,mu/en,_,r/en,)/w,^,2/m,$/w,$/w,其中/r,$/w,x/en,_,{/w,ij/en,}/w, ,\/w,leq/en, ,t/en,$/w,的/u,所有/b,样本/n,落入/v,左子/nr,树/v,$/w,l/en,$/w,中/f,，/w,其中/r,$/w,x/en,_,{/w,ij/en,}/w, ,>, ,t/en,$/w,的/u,所有/b,样本/n,落入/v,右子/nw,树/v,$/w,r/en,$/w,中/f,，/w,$/w,\/w,mu/en,_,l/en,(/w,\/w,mu/en,_,r/en,)/w,$/w,表示/v,左子树/nr,（/w,右子树/nw,）/w,所有/b,样例/nw,标签/n,值/n,的/u,均值/n,。/w,如果/c,这/r,就/d,是/v,一棵/mq,最/d,简单/a,的/u,拥有/v,一个/m,根/q,节点/n,、/w,两个/m,叶子/n,节点/n,的/u,二叉/nw,回归/v,树/v,，/w,那么/r,只/d,需要/v,根据/p,最/d,优/ag,阈值/n,切分/v,为/p,左右子树/nw,，/w,并且/c,分别/d,计算/v,左右子树/nw,的/u,值/n,$/w,\/w,gamma/en,_,l/en,,/w,l/en,=/w,1/m,,/w,2/m,$/w,即可/v,。/w,如果/c,将/d,划分/v,子树/nr,的/u,过程/n,继续/v,进行/v,$/w,l/en,-/w,1/m,$/w,次/q,即可/v,得到/v,一棵/mq,包含/v,$/w,l/en,$/w,个/q,叶子/n,节点/n,的/u,回归/v,树/v,。/w,上面/f,公式/n,使用/v,最小/a,二/m,乘/v,法/j,计算/v,拟合/nz,误差/n,，/w,所以/c,通过/p,上面/f,方法/n,得到/v,的/u,模型/n,又/d,称为/v,最小/a,二/m,乘/v,回归/v,树/v,。/w,其实/d,不管/c,误差/n,的/u,计算/v,方式/n,如何/r,，/w,我们/r,都/d,可以/v,拟合/nz,出/v,相应/v,的/u,回归/v,树/v,，/w,唯一/b,的/u,区别/n,是/v,梯度/n,的/u,计算/v,不同/a,而已/y,。/w,mart/en,使用/v,线性/n,组合/v,的/u,方式/n,将/d,拟合/nz,的/u,树/v,结合/v,起来/v,，/w,作为/v,最后/f,的/u,输出/v,：/w,$/w,$/w,f/en,_,n/en,(/w,x/en,)/w,=/w,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,n/en,}/w,\/w,alpha/en,_,if/en,_,i/en,(/w,x/en,)/w,$/w,$/w,$/w,f/en,_,i/en,(/w,x/en,)/w,$/w,是/v,单棵/nw,回归/v,树/v,函数/n,，/w,$/w,\/w,alpha/en,_,i/en,$/w,是/v,第/m,$/w,i/en,$/w,棵/q,回归/v,树/v,的/u,权重/nz,。/w,在/p,这里/r,我们/r,需要/v,弄/v,清楚/a,为什么/r,拟合/nz,残差/nw,就/d,能/v,不断/d,减少/v,拟合/nz,误差/n,。/w,假设/v,拟合/nz,误差/n,$/w,c/en,$/w,是/v,拟合/nz,函数/n,$/w,f/en,_,n/en,$/w,的/u,函数/n,$/w,c/en,(/w,f/en,_,n/en,)/w,$/w,。/w,那么/r,：/w,$/w,$/w,\/w,delta/en, ,c/en, ,\/w,approx/en, ,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,(/w,f/en,_,n/en,)/w,}/w,}/w,{/w,\/w,partial/en,{/w,f/en,_,n/en,}/w,}/w,\/w,delta/en, ,f/en,_,n/en,$/w,$/w,如果/c,取/v,$/w,\/w,delta/en, ,f/en,_,n/en,=/w,-/w,\/w,eta/en, ,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,f/en,_,n/en,}/w,}/w,$/w,，/w,就/d,可以/v,得到/v,$/w,\/w,delta/en, ,c/en,</w,0/m,$/w,。/w,其中/r,$/w,\/w,eta/en,$/w,是/v,学习率/nw,，/w,为/p,正/d,实数/n,。/w,所以/c,只要/c,函数/n,$/w,f/en,_,n/en,$/w,拟合/nz,误差/n,函数/n,的/u,负/v,梯度/n,就/d,可以/v,不断/d,降低/v,拟合/nz,误差/n,的/u,值/n,。/w,设/v,标签/n,向/p,量/n,$/w,y/en,=/w,[/w,y/en,_,1/m,,/w,y/en,_,2/m,,/w,./w,./w,./w,,/w,y/en,_,m/en,]/w,^,t/en,$/w,，/w,如果/c,用/p,最小/a,二/m,乘/v,的/u,方式/n,表示/v,拟合/nz,误差/n,，/w,则/d,：/w,$/w,$/w,c/en,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,(/w,f/en,_,n/en,-/w,y/en,)/w,^,2/m,$/w,$/w,那么/r,$/w,\/w,delta/en, ,f/en,_,n/en,=/w,-/w,\/w,eta/en, ,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,f/en,_,n/en,}/w,}/w,=/w,-/w,\/w,eta/en, ,(/w,f/en,_,n/en,-/w,y/en,)/w,$/w,。/w,这/r,其实/d,就/d,是/v,上面/f,提到/v,的/u,残差/nw,，/w,所以/c,拟合/nz,残差/nw,可以/v,不断/d,减少/v,拟合/nz,误差/n,。/w,5.2/m, ,逻辑/n,回归/v,+/w,mart/en,进行/v,二/m,分类/vn,了解/v,了/u,mart/en,之后/f,，/w,下面/f,举/v,一个/m,mart/en,实际/n,应用/vn,的/u,例子/n,：/w,使用/v,mart/en,和/c,逻辑/n,回归/v,进行/v,二/m,分类/vn,。/w,用于/v,分类/vn,的/u,样本/n,$/w,x/en,_,i/en, ,\/w,in/en, ,\/w,mathbb/en,{/w,r/en,}/w,^,n/en,$/w,，/w,标签/n,$/w,y/en,_,i/en, ,\/w,in/en, ,\/w,{/w,\/w,pm/en,1/m,\/w,}/w,$/w,，/w,拟合/nz,函数/n,$/w,f/en,(/w,x/en,)/w,$/w,。/w,为了/p,简化/v,表示/v,，/w,我们/r,表示/v,条件/n,概率/n,如下/v,：/w,$/w,$/w,p/en,_,+/w, ,\/w,equiv/en, ,p/en,(/w,y/en,=/w,1/m,|/w,x/en,)/w,$/w,$/w,$/w,$/w,p/en,_,-/w, ,\/w,equiv/en, ,p/en,(/w,y/en,=/w,-/w,1/m,|/w,x/en,)/w,$/w,$/w,用/p,交叉/vn,熵/g,表示/v,损失/n,函数/n,：/w,$/w,$/w,l/en,(/w,y/en,,/w,f/en,)/w,=/w,-/w,ylog/en,(/w,p/en,_,+/w,)/w,-/w,(/w,1/m,-/w,y/en,)/w,log/en,(/w,p/en,_,-/w,)/w,$/w,$/w,逻辑/n,回归/v,使用/v,对数/n,机率/nz,（/w,属于/v,正例/nw,概率/n,//w,属于/v,负例/nw,概率/n,）/w,进行/v,建模/vn,，/w,$/w,$/w,f/en,_,n/en,(/w,x/en,)/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,log/en,(/w,\/w,frac/en,{/w,p/en,_,+/w,}/w,{/w,p/en,_,-/w,}/w,)/w,$/w,$/w,$/w,$/w,p/en,_,+/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,-/w,2/m,\/w,sigma/en, ,f/en,_,n/en,(/w,x/en,)/w,}/w,}/w,$/w,$/w,$/w,$/w,p/en,_,-/w,=/w,1/m,-/w,p/en,_,+/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,2/m,\/w,sigma/en, ,f/en,_,n/en,(/w,x/en,)/w,}/w,}/w,$/w,$/w,将/d,$/w,p/en,_,+/w,$/w,和/c,$/w,p/en,_,-/w,$/w,带入/v,$/w,l/en,(/w,y/en,,/w,f/en,)/w,$/w,中/f,，/w,得到/v,：/w,$/w,$/w,l/en,(/w,y/en,,/w,f/en,_,n/en,)/w,=/w,log/en,(/w,1/m,+/w,e/en,^,{/w,-/w,2/m,y/en,\/w,sigma/en, ,f/en,_,n/en,}/w,)/w,$/w,$/w,$/w,r/en,_,{/w,jm/en,}/w,$/w,表示/v,落入/v,第/m,$/w,m/en,$/w,棵/q,树/v,的/u,第/m,$/w,j/en,$/w,个/q,叶子/n,节点/n,中/f,的/u,样例/nw,集合/v,，/w,可以/v,通过/p,下式/nw,对/p,该/r,叶子/n,节点/n,的/u,值/n,进行/v,优化/v,：/w,$/w,$/w,\/w,gamma/en,_,{/w,jm/en,}/w,=/w,arg/en,\/w,min/en,_,{/w,\/w,gamma/en,}/w,\/w,sum/en,_,{/w,x/en,_,i/en, ,\/w,in/en, ,r/en,_,{/w,jm/en,}/w,}/w,\/w,log/en,\/w,left/en,(/w,1/m,+/w,e/en,^,{/w,-/w,2/m,\/w,sigma/en, ,y/en,_,i/en,\/w,left/en,(/w,f/en,_,{/w,m/en,-/w,1/m,}/w,\/w,,/w,\/w,,/w,\/w,left/en,(/w,{/w,x/en,_,i/en,}/w,\/w,right/en,)/w,+/w,\/w,gamma/en,\/w,right/en,)/w,\/w,,/w,}/w,\/w,right/en,)/w,$/w,$/w,上/f,式/k,可以/v,使用/v,newton/en,-/w,raphson/en,方法/n,按照/p,下面/f,的/u,公式/n,进行/v,迭代/vn,求解/v,：/w,$/w,$/w,\/w,gamma/en,_,{/w,n/en,+/w,1/m,}/w,=/w,\/w,gamma/en,_,{/w,n/en,}/w,-/w,\/w,frac/en,{/w,g/en,'/w,(/w,\/w,gamma/en,_,n/en,)/w,}/w,{/w,g/en,'/w,'/w,(/w,\/w,gamma/en,_,n/en,)/w,}/w,$/w,$/w,5.3/m, ,lambdamart/en,基本/a,定义/n,lambdamart/en,基于/p,mart/en,，/w,优化/v,$/w,\/w,lambda/en,$/w,梯度/n,。/w,根据/p,上面/f,的/u,定义/n,，/w,对于/p,任意/d,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,，/w,有/v,：/w,$/w,$/w,\/w,lambda/en,_,{/w,ij/en,}/w,=/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,=/w,\/w,frac/en,{/w,-/w,\/w,sigma/en, ,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,$/w,$/w,$/w,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,$/w,表示/v,交换/v,$/w,u/en,_,i/en,$/w,和/c,$/w,u/en,_,j/en,$/w,的/u,位置/n,产生/v,的/u,评价/v,指标/n,差值/n,，/w,$/w,z/en,$/w,可以/v,是/v,$/w,ndcg/en,$/w,或者/c,$/w,err/en,$/w,等/u,。/w,对于/p,特定/b,$/w,u/en,_,i/en,$/w,，/w,累加/v,其他/r,所有/b,排序/vn,项/q,的/u,影响/vn,，/w,得到/v,：/w,$/w,$/w,\/w,lambda/en,_,i/en,=/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,-/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,j/en,,/w,i/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,$/w,为了/p,简化/v,表示/v,：/w,$/w,$/w,\/w,sum/en,_,{/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,\/w,rightleftharpoons/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,=/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,-/w,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,j/en,,/w,i/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w,\/w,lambda/en,_,{/w,ij/en,}/w,$/w,$/w,于是/c,我们/r,可以/v,更新/v,损失/n,函数/n,：/w,$/w,$/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w, ,=/w, ,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w, ,\/w,frac/en,{/w,-/w,\/w,sigma/en, ,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w, ,=/w, ,\/w,sum/en,_,{/w,j/en,:/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w, ,\/w,in/en, ,i/en,}/w, ,-/w,\/w,sigma/en, ,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w, ,\/w,rho/en,_,{/w,ij/en,}/w,$/w,$/w,其中/r,，/w,我们/r,定义/n,：/w,$/w,$/w,\/w,rho/en,_,{/w,ij/en,}/w,=/w,\/w,frac/en,{/w,1/m,}/w,{/w,1/m,+/w,e/en,^,{/w,\/w,sigma/en,(/w,s/en,_,i/en,-/w,s/en,_,j/en,)/w,}/w,}/w,=/w,\/w,frac/en,{/w,-/w,\/w,lambda/en,_,{/w,ij/en,}/w,}/w,{/w,\/w,sigma/en, ,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,}/w,$/w,$/w,然后/c,可以/v,得到/v,：/w,$/w,$/w,\/w,frac/en,{/w,\/w,partial/en,{/w,^,2/m,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,^,2/m,}/w,}/w,=/w,\/w,sum/en,_,{/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,\/w,rightleftharpoons/en, ,i/en,}/w,\/w,sigma/en,^,2/m,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,\/w,rho/en,{/w,ij/en,}/w,(/w,1/m,-/w,\/w,rho/en,_,{/w,ij/en,}/w,)/w,$/w,$/w,所以/c,我们/r,可以/v,用/p,下面/f,的/u,公式/n,计算/v,第/m,$/w,m/en,$/w,棵/q,树/v,的/u,第/m,$/w,k/en,$/w,个/q,叶子/n,节点/n,上/f,的/u,值/n,：/w,$/w,$/w,\/w,gamma/en,_,{/w,km/en,}/w,=/w,\/w,frac/en,{/w,\/w,sum/en,_,{/w,x/en,_,i/en, ,\/w,in/en, ,r/en,_,{/w,km/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,}/w,}/w,}/w,{/w,\/w,sum/en,_,{/w,x/en,_,i/en, ,\/w,in/en, ,r/en,_,{/w,km/en,}/w,}/w,\/w,frac/en,{/w,\/w,partial/en,{/w,^,2/m,c/en,}/w,}/w,{/w,\/w,partial/en,{/w,s/en,_,i/en,^,2/m,}/w,}/w,}/w,=/w,\/w,frac/en,{/w,-/w,\/w,sum/en,_,{/w,x/en,_,i/en, ,\/w,in/en, ,r/en,_,{/w,km/en,}/w,}/w,\/w,sum/en,_,{/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,\/w,rightleftharpoons/en, ,i/en,}/w,|/w,\/w,delta/en,_,{/w,z/en,_,{/w,ij/en,}/w,}/w,|/w,\/w,rho/en,_,{/w,ij/en,}/w,}/w,{/w,\/w,sum/en,_,{/w,x/en,_,i/en, ,\/w,in/en, ,r/en,_,{/w,km/en,}/w,}/w,\/w,sum/en,_,{/w,\/w,{/w,i/en,,/w,j/en,\/w,}/w,\/w,rightleftharpoons/en, ,i/en,}/w,|/w,\/w,delta/en,_,{/w,z/en