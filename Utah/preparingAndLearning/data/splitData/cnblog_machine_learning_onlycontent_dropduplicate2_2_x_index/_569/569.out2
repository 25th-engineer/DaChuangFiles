最近/t,一直/d,在/p,看/v,机器/n,学习/v,相关/v,的/u,算法/n,，/w,今天/t,我们/r,学习/v,一种/mq,基于/p,概率/n,论/v,的/u,分类/vn,算法/n,—/w,朴素/a,贝叶斯/nr,。/w,本文/r,在/p,对/p,朴素/a,贝叶斯/nr,进行/v,简单/a,介绍/v,之后/f,，/w,通过/p,python/en,编程/vn,加以/v,实现/v,。/w,一/m, , ,朴素/a,贝叶斯/nr,概述/v,1/m, ,前言/n,“/w,贝叶斯/nr,”/w,又/d,是/v,一个/m,响当当/z,的/u,名字/n,，/w,刚/d,开始/v,接触/v,的/u,是/v,贝叶斯/nr,定理/n,。/w,贝叶斯分类器/nw,是/v,一类/b,分类/vn,算法/n,的/u,总称/n,，/w,是/v,两种/mq,最为/d,广泛/a,的/u,分类/vn,模型/n,之一/r,，/w,另/r,一种/mq,就/d,是/v,上/f,篇/q,中/f,的/u,决策/n,树/v,了/u,。/w,贝叶斯/nr,分类/vn,均/d,以贝叶斯/nrf,定理/n,为/p,基础/n,，/w,朴素/a,贝叶斯/nr,是/v,贝叶斯/nr,分类/vn,中/f,最/d,简单/a,的/u,一种/mq,，/w,是/v,基于/p,贝叶斯/nr,定理/n,与/p,特征/n,条件/n,独立/v,假设/v,的/u,分类/vn,方法/n,。/w,之前/f,所/u,学习/v,的/u,基于/p,分类/vn,的/u,k/en,-/w,means/en,和/c,决策/n,树/v,都/d,是/v,给/p,出/v,了/u,分类/vn,的/u,明确/ad,答案/n,，/w,但是/c,分类/vn,势必/d,是/v,会/v,产生/v,错误/n,结果/n,，/w,结合/v,概率/n,论/v,的/u,相关/v,知识/n,，/w,我们/r,在/p,分类/vn,时/ng,，/w,可以/v,给/p,出/v,类别/n,估计/v,值/n,，/w,进而/c,将/d,赋予/v,数据/n,最/d,优/ag,类别/n,猜测/vn,。/w,就/d,分类/vn,而言/u,，/w,有时/d,使用/v,概率/n,要/v,比/p,那些/r,硬/a,规则/n,有效/a,的/u,多/a,，/w,贝叶斯/nr,准则/n,和/c,贝叶斯/nr,定理/n,就是/d,利用/v,已/d,知值/nw,来/v,估计/v,未知/vn,概率/n,的/u,方法/n,。/w,据此/d,，/w,我们/r,可以/v,使用/v,概率/n,论/v,进行/v,分类/vn,，/w,首先/d,从/p,一个/m,最/d,简单/a,的/u,概率/n,分类器/nw,开始/v,，/w,进而/c,给/p,出/v,一些/m,假设/v,来/v,学习/v,朴素/a,贝叶斯分类器/nw,。/w,之所以/c,称之为/v,“/w,朴素/a,”/w,，/w,是/v,因为/c,在/p,整个/b,过程/n,当中/f,我们/r,都/d,使用/v,的/u,是/v,最/d,原始/a,，/w,最/d,简单/a,的/u,假设/v,。/w,贝叶斯算法/nw,的/u,基础/n,是/v,概率/n,问题/n,，/w,分类/vn,的/u,原理/n,是/v,通过/p,某/r,对象/n,的/u,先验/n,概率/n,，/w,利用/v,贝叶斯公式/nw,计算/v,出/v,它/r,的/u,后验/nw,概率/n,（/w,对象/n,属于/v,某/r,一类/mq,的/u,概率/n,）/w,，/w,选取/v,具有/v,最/d,大/a,后验/nw,概率/n,的/u,类/q,作为/v,该/r,对象/n,所/u,属/v,的/u,类/q,。/w,就/d,像/v,那个/r,特别/d,有名/a,的/u,例子/n,：/w,在/p,大街/n,上/f,碰到/v,一个/m,黑人/n,，/w,要/v,让/v,你/r,猜测/vn,他/r,是/v,哪个/r,洲/ng,的/u,，/w,你/r,肯定/v,首先/d,会/v,说/v,非洲/ns,，/w,为什么/r,呢/y,，/w,因为/c,黑人/n,中非洲/ns,最多/ad,，/w,在/p,这里/r,我们/r,就/d,选取/v,了/u,出现/v,概率/n,最/d,大/a,的/u,类别/n,。/w,2/m,./w, ,贝叶斯/nr,定理/n,贝叶斯/nr,定理/n,对/p,大家/r,而言/u,，/w,应该/v,都/d,不/d,会/v,太/d,陌生/a,，/w,今天/t,再/d,温习/v,一下/m,。/w,首先/d,说/v,一下/m,与/p,贝叶斯/nr,定理/n,密不可分/l,的/u,条件/n,概率/n,：/w,p/en,(/w,a/en,|/w,b/en,)/w, ,=/w, ,p/en,(/w,ab/en,)/w, ,//w, ,p/en,(/w,b/en,)/w,,/w,其中/r,p/en,(/w,a/en,|/w,b/en,)/w,表示/v,的/u,b/en,发生/v,的/u,情况/n,下/f,a/en,发生/v,的/u,概率/n,，/w,这/r,就/d,是/v,条件/n,概率/n,。/w,为什么/r,要/v,提/v,出/v,贝叶斯/nr,定理/n,呢/y,？/w,因为/c,现实/n,生活/vn,中/f,的/u,很多/m,问题/n,，/w,都/d,是/v,很/d,容易/a,求/v,出/v,p/en,(/w,a/en,|/w,b/en,)/w,，/w,但/c,p/en,(/w,b/en,|/w,a/en,)/w,却/d,很/d,难/a,求/v,出/v,，/w,而/c,p/en,(/w,b/en,|/w,a/en,)/w,却/d,相对/d,更/d,有用/a,，/w,由此/d,贝叶斯/nr,定理/n,产生/v,。/w,定义/n,为/p,：/w,3/m,./w,朴素/a,贝叶斯分类器/nw,分类/vn,的/u,原理/n,是/v,通过/p,某/r,对象/n,的/u,先验/n,概率/n,，/w,利用/v,贝叶斯公式/nw,计算/v,出/v,它/r,的/u,后验/nw,概率/n,（/w,对象/n,属于/v,某/r,一类/mq,的/u,概率/n,）/w,，/w,选取/v,具有/v,最/d,大/a,后验/nw,概率/n,的/u,类/q,作为/v,该/r,对象/n,所/u,属/v,的/u,类/q,。/w,把/p,a/en,和/c,b/en,看作/v,是/v,随机/d,变量/n,，/w,那么/r,p/en,(/w,b/en,|/w,a/en,)/w,就是/d,b/en,的/u,后验/nw,概率/n,，/w,p/en,(/w,b/en,)/w,是/v,b/en,的/u,先验/n,概率/n,。/w,对于/p,朴素/a,贝叶斯分类器/nw,，/w,要/v,做出/v,两个/m,假设/v,：/w,（/w,1/m,）/w,特征/n,之间/f,相互/d,独立/v,，/w,即/v,一个/m,特征/n,的/u,出现/v,于/p,其它/r,相邻/v,的/u,特征/n,并/c,无/v,关系/n,；/w,（/w,2/m,）/w,每个/r,特征/n,同等/b,重要/a,。/w,二/m, ,使用/v,朴素/a,贝叶斯/nr,进行/v,文档/n,分类/vn,机器/n,学习/v,的/u,一个/m,重要/a,应用/vn,就/d,是/v,文档/n,的/u,分类/vn,，/w,整个/b,文档/n,看成/v,是/v,实例/n,，/w,而/c,文档/n,中/f,的/u,元素/n,相应/v,的/u,构成/v,特征/n,。/w,我们/r,可以/v,观察/v,文档/n,中/f,出现/v,的/u,词/n,，/w,并/c,把/p,每个/r,词/n,的/u,出现/v,与否/u,相应/v,的/u,作为/v,特征/n,，/w,进而/c,构造/v,分类器/nw,对/p,文档/n,进行/v,分类/vn,。/w,在/p,这里/r,我们/r,一个/m,留言/v,社区/n,为/p,例/n,，/w,为了/p,过滤/v,掉/v,那些/r,内容/n,不当/a,的/u,侮辱性/n,言论/n,，/w,对此/d,我们/r,可以/v,建立/v,两个/m,类别/n,：/w,侮辱性/n,和/c,非侮辱性/nw,，/w,分别/d,用/p,0/m,和/c,1/m,来/v,表示/v,。/w,下面/f,用/p,python/en,编程/vn,实现/v,：/w,1/m, , ,文本/n,中/f,获取/v,特征/n,#,coding/en,:/w,utf/en,-/w,8/m, ,from/en, ,numpy/en, ,import/en, ,*/w, ,import/en, ,sys/en, ,sys/en,./w,path/en,./w,append/en,(/w,"/w,e/en,:/w,\/w,./w,./w,./w,./w,"/w,)/w, ,#,#,从/p,文本/n,中/f,构建/v,向/p,量/n, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,postinglist/en,=/w,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,#,#,分别/d,表示/v,标签/n, ,return/en, ,postinglist/en,,/w,classvec/en, ,#,#,返回/v,输入/v,数据/n,和/c,标签/n,向/p,量/n, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,for/en, ,document/en, ,in/en, ,dataset/en,:/w, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,return/en, ,list/en,(/w,vocabset/en,)/w,#,#,输出/v,不/d,重复/v,的/u,元素/n, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w,#,#,#,判断/v,了/u,一个/m,词/n,是否/v,出现/v,在/p,一个/m,文档/n,当中/f,。/w, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,else/en,:/w, ,print/en, ,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,return/en, ,returnvec/en,#,#,#,输入/v,中/f,的/u,元素/n,在/p,词汇表/n,时/ng,，/w,词汇表/n,相应/v,位置/n,为/p,1/m,，/w,否则/c,为/p,0/m, ,'/w,'/w,'/w, ,#,测试/vn, ,dataset/en,,/w,classes/en, ,=/w, ,loaddataset/en,(/w,)/w, ,print/en,(/w,dataset/en,)/w, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,dataset/en,)/w, ,print/en,(/w,vocablist/en,)/w, ,setwordsvec/en, ,=/w, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w,dataset/en,[/w,0/m,]/w,)/w, ,print/en,(/w,setwordsvec/en,)/w, ,'/w,'/w,'/w,1.2/m, , ,得到/v,每个/r,特征/n,的/u,条件/n,概率/n,#,#,得到/v,每个/r,特征/n,的/u,条件/n,概率/n, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w,#,#,#,输入/v,的/u,文档/n,信息/n,和/c,标签/n, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,p/en,0/m,denom/en, ,=/w, ,2.0/m, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,else/en,:/w, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,p/en,1/m,vect/en, ,=/w, ,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w, ,p/en,0/m,vect/en, ,=/w, ,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en, ,'/w,'/w,'/w, ,#,测试/vn, ,dataset/en,,/w,classes/en, ,=/w, ,loaddataset/en,(/w,)/w, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,dataset/en,)/w, ,trainmat/en, ,=/w, ,[/w,]/w, ,for/en, ,item/en, ,in/en, ,dataset/en,:/w, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w,item/en,)/w,)/w, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en, ,=/w, ,trainnb/en,0/m,(/w,trainmat/en,,/w,classes/en,)/w, ,print/en,(/w,p/en,0/m,v/en,)/w, ,print/en,(/w,p/en,1/m,v/en,)/w, ,print/en,(/w,pab/en,)/w, ,'/w,'/w,'/w,3/m, , ,分类/vn,#,分类/vn, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w,p/en,0/m,vec/en,,/w,p/en,1/m,vec/en,,/w,pclass/en,1/m,)/w,:/w, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en,)/w, ,+/w, ,log/