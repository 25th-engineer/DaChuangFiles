学习/v,了/u,那么/r,多/a,机器/n,学习/v,模型/n,，/w,一切/r,都/d,是/v,为了/p,实践/v,，/w,动手/v,自己/r,写写/v,这些/r,模型/n,的/u,实现/v,对/p,自己/r,很/d,有/v,帮助/v,的/u,，/w,坚持/v,，/w,共勉/v,。/w,本文/r,主要/b,致力/v,于/p,总结/v,贝叶斯实战/nw,中/f,程序/n,代码/n,的/u,实现/v,（/w,python/en,）/w,及/c,朴素/a,贝叶斯模型/nw,原理/n,的/u,总结/v,。/w,python/en,的/u,numpy/en,包/v,简化/v,了/u,很多/m,计算/v,，/w,另外/c,本人/r,推荐/v,使用/v,pandas/en,做/v,数据/n,统计/v,。/w,一/m, ,引言/n,让/v,你/r,猜测/vn,一个/m,身高/n,2.16/m,的/u,人/n,的/u,职业/n,，/w,你/r,一般/a,会/v,猜测/vn,他/r,是/v,篮球/n,运动/n,员/q,。/w,这个/r,原理/n,就是/d,朴素/a,贝叶斯/nr,原理/n,，/w,因为/c,篮球/n,运动员/n,大多/d,身高/n,很/d,高/a,，/w,所以/c,这个/r,人/n,具有/v,篮球/n,运动员/n,的/u,条件/n,，/w,则/d,猜测/vn,他/r,是/v,篮球/n,运动/n,员/q,。/w,同理/v,，/w,另/r,一个/m,升高/v,1.58/m,的/u,人/n,，/w,你/r,应该/v,不/d,会/v,猜/v,他/r,是/v,篮球/n,运动/n,员/q,。/w,二/m, ,理论/n,条件/n,贝叶斯公式/nw,：/w,p/en,(/w,ci/en, ,|/w, ,x/en,,/w,y/en,)/w,=/w,p/en,(/w,x/en,,/w,y/en, ,|/w, ,ci/en,)/w,*/w,p/en,(/w,ci/en,)/w, ,//w, ,p/en,(/w,x/en,,/w,y/en,)/w,计算/v,每个/r,类别/n,的/u,概率/n,，/w,若/c,p/en,(/w,c/en,1/m, ,|/w, ,x/en,,/w,y/en,)/w, ,>, ,p/en,(/w,~/w,c/en,1/m, ,|/w, ,x/en,,/w,y/en,)/w,,/w, ,则/d,类别/n,属于/v,类/q,c/en,1/m,，/w,否则/c,不/d,属于/v,类/q,c/en,1/m,。/w,程序/n,中/f,在/p,模型/n,训练/vn,的/u,时候/n,，/w,只/d,需要/v,先/d,在/p,训练/vn,样本/n,中/f,计算/v,好/a,先验/n,概率/n, ,p/en,(/w,ci/en,)/w, ,和/c, ,条件/n,概率/n, ,p/en,(/w,x/en,,/w,y/en, ,|/w, ,ci/en,)/w, ,即可/v,，/w,因为/c,p/en,(/w,x/en,,/w,y/en,)/w,不/d,随/v,ci/en,变化/vn,，/w,不/d,影响/vn,p/en,(/w,ci/en, ,|/w, ,x/en,,/w,y/en,)/w,的/u,最/d,好/a,大小/n,。/w,注/v,：/w,条件/n,贝叶斯/nr,是/v,保证/v,条件/n,之间/f,独立/v,的/u,（/w,文档/n,分类/vn,中/f,是/v,假设/v,一个/m,词汇/n,出现/v,与/p,其他/r,词汇/n,是否/v,出现/v,无关/v,，/w,然而/c,同一/b,主题/n,的/u,词汇/n,一起/s,出现/v,的/u,概率/n,很/d,高/a,，/w,存在/v,关联/vn,）/w,，/w,所以/c,这个/r,假设/v,过于/d,简单/a,；/w,尽管如此/l,，/w,然而/c,事实/n,表明/v,，/w,朴素/a,贝叶斯/nr,的/u,效果/n,还/d,很/d,好/a,。/w,三/m, ,实战/n,1/m, ,-/w,文本/n,分类/vn,（/w,应用/vn,过滤/v,恶意/n,留言/v,等/u,）/w,下面/f,是/v,二/m,分类/vn,问题/n,，/w,文档/n,只能/v,属于/v,0/m,和/c,1两/mq,个/q,类别/n,，/w,1/m, ,载入/v,数据集/nw,：/w,6条/mq,文本/n,及/c,它们/r,各自/r,的/u,类别/n,，/w,这/r,6条/mq,文本/n,作为/v,训练/vn,集/vg,。/w,from/en, ,numpy/en, ,import/en, ,*/w, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,postinglist/en,=/w,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,#,1/m, ,is/en, ,abusive/en,,/w, ,0/m, ,not/en, ,return/en, ,postinglist/en,,/w,classvec/en,2/m, ,创建/v,词汇表/n,：/w,利用/v,集合/v,结构/n,内/f,元素/n,的/u,唯一性/n,，/w,创建/v,一个/m,包含/v,所有/b,词汇/n,的/u,词表/n,。/w,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,#,create/en, ,empty/en, ,set/en, ,for/en, ,document/en, ,in/en, ,dataset/en,:/w, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#,union/en, ,of/en, ,the/en, ,two/en, ,sets/en, ,return/en, ,list/en,(/w,vocabset/en,)/w,3/m, ,把/p,输入/v,文本/n,根据/p,词表/n,转化/v,为/p,计算机/n,可/v,处理/v,的/u,01/m,向/p,量/n,形式/n,：/w,eq/en,，/w,测试/vn,文本/n,1/m,：/w, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w,词汇表/n,：/w,[/w,'/w,cute/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,garbage/en,'/w,,/w, ,'/w,quit/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,maybe/en,'/w,,/w, ,'/w,please/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,mr/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,my/en,'/w,]/w,向/p,量化/v,结果/n,：/w,[/w,0/m, ,1/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,1/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,1/m,]/w,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,else/en,:/w, ,print/en, ,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,return/en, ,returnvec/en,4/m,训练/vn,模型/n,：/w,在/p,训练/vn,样本/n,中/f,计算/v,先验/n,概率/n, ,p/en,(/w,ci/en,)/w, ,和/c, ,条件/n,概率/n, ,p/en,(/w,x/en,,/w,y/en, ,|/w, ,ci/en,)/w,，/w,本/r,实例/n,有/v,0/m,和/c,1两/mq,个/q,类别/n,，/w,所以/c,返回/v,p/en,(/w,x/en,,/w,y/en, ,|/w, ,0/m,)/w,，/w,p/en,(/w,x/en,,/w,y/en, ,|/w, ,1/m,)/w,和/c,p/en,(/w,ci/en,)/w,。/w,此处/s,有/v,两个/m,改进/v,的/u,地方/n,：/w,（/w,1/m,）/w,若/c,有/v,的/u,类别/n,没有/v,出现/v,，/w,其/r,概率/n,就/d,是/v,0/m,，/w,会/v,十分/d,影响/vn,分类器/nw,的/u,性能/n,。/w,所以/c,采取/v,各/r,类别/n,默认/v,1次/mq,累加/v,，/w,总/b,类别/n,（/w,两类/mq,）/w,次数/n,2/m,，/w,这样/r,不/d,影响/vn,相对/d,大小/n,。/w,（/w,2/m,）/w,若/c,很/d,小/a,是/v,数字/n,相乘/v,，/w,则/d,结果/n,会/v,更/d,小/a,，/w,再/d,四舍/mq,五/m,入/v,存在/v,误差/n,，/w,而且/c,会/v,造成/v,下/f,溢/v,出/v,。/w,采取/v,取/v,log/en,，/w,乘法/n,变为/v,加法/n,，/w,并且/c,相对/d,大小/n,趋势/n,不/d,变/v,。/w,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,#,change/en, ,to/en, ,ones/en,(/w,)/w, ,p/en,0/m,denom/en, ,=/w, ,2.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,#,change/en, ,to/en, ,2.0/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,else/en,:/w, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,p/en,1/m,vect/en, ,=/w, ,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w, ,#,change/en, ,to/en, ,log/en,(/w,)/w, ,p/en,0/m,vect/en, ,=/w, ,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w, ,#,change/en, ,to/en, ,log/en,(/w,)/w, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en,5/m, ,分类/vn,：/w,根据/p,计算/v,后/f,，/w,哪个/r,类别/n,的/u,概率/n,大/a,，/w,则/d,属于/v,哪个/r,类别/n,。/w,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,#,element/en,-/w,wise/en, ,mult/en, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en,)/w, ,+/w, ,log/en,(/w,1.0/m, ,-/w, ,pclass/en,1/m,)/w, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,return/en, ,1/m, ,else/en,:/w, ,return/en, ,06/m, ,测试/vn,函数/n,：/w,加载/v,数据集/nw,+/w,提炼/v,词表/n,；/w,训练/vn,模型/n,：/w,根据/p,六条/mq,训练/vn,集/vg,计算/v,先验/n,概率/n,和/c,条件/n,概率/n,；/w,测试/vn,模型/n,：/w,对/p,训练/vn,两条/mq,测试/vn,文本/n,进行/v,分类/vn,。/w,def/en, ,testingnb/en,(/w,)/w,:/w, ,listoposts/en,,/w,listclasses/en, ,=/w, ,loaddataset/en,(/w,)/w, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en,)/w, ,trainmat/en,=/w,[/w,]/w, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w,