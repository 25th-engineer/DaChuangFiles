最近/t,一直/d,在/p,看/v,机器/n,学习/v,相关/v,的/u,算法/n,，/w,今天/t,学习/v,logistic/en,回归/v,，/w,在/p,对/p,算法/n,进行/v,了/u,简单/a,分析/vn,编程/vn,实现/v,之后/f,，/w,通过/p,实例/n,进行/v,验证/vn,。/w,一/m, ,logistic/en,概述/v,个人/n,理解/v,的/u,回归/v,就/d,是/v,发现/v,变量/n,之间/f,的/u,关系/n,，/w,也/d,就/d,是/v,求/v,回归/v,系数/n,，/w,经常/d,用/p,回归/v,来/v,预测/v,目标值/n,。/w,回归/v,和/c,分类/vn,同/p,属于/v,监督/vn,学习/v,，/w,所/u,不同/a,的/u,是/v,回归/v,的/u,目标/n,变量/n,必须/d,是/v,连续/a,数/m,值型/nw,。/w,今天/t,要/v,学习/v,的/u,logistic/en,回归/v,的/u,主要/b,思想/n,是/v,根据/p,现有/v,的/u,数据/n,对/p,分类/vn,边界线/n,建立/v,回归/v,公式/n,，/w,以此/d,进行/v,分类/vn,。/w,主要/b,在/p,流行病学/nw,中/f,应用/vn,较/d,多/a,，/w,比较/d,常用/a,的/u,情形/n,是/v,探索/v,某/r,疾病/n,的/u,危险/an,因素/n,，/w,根据/p,危险/an,因素/n,预测/v,某/r,疾病/n,发生/v,的/u,概率/n,等等/u,。/w,logistic/en,回归/v,的/u,因/p,变量/n,可以/v,是/v,二/m,分类/vn,的/u,，/w,也/d,可以/v,是/v,多/a,分类/vn,的/u,，/w,但是/c,二/m,分类/vn,的/u,更为/d,常用/a,，/w,也/d,更加/d,容易/a,解释/v,，/w,所以/c,实际/n,中/f,最为/d,常用/a,的/u,就/d,是/v,二/m,分类/vn,的/u,logistic/en,回归/v,。/w,今天/t,我们/r,就/d,二/m,分类/vn,进行/v,分析/vn,，/w,我们/r,在/p,回归/v,分析/vn,中/f,需要/v,一个/m,函数/n,可以/v,接受/v,所有/b,的/u,输入/v,然后/c,预测/v,出/v,类别/n,，/w,假定/v,用/p,0/m,和/c,1/m,分别/d,表示/v,两个/m,类别/n,，/w,logistic/en,函数/n,曲线/n,很/d,像/v,s/en,型/k,，/w,故此/c,我们/r,可以/v,联系/v,sigmoid/en,函数/n,：/w,σ, ,=/w, ,1/m,//w,(/w,1/m,//w,(/w,1/m,+/w,e/en,-/w,z/en,)/w,)/w,。/w,为了/p,实现/v,logistic/en,回归/v,分类器/nw,，/w,我们/r,可以/v,在/p,每个/r,特征/n,上乘/z,以/p,一个/m,回归/v,系数/n,，/w,将/d,所有/b,的/u,乘积/n,相加/v,，/w,将/d,和/c,值代/nw,入/v,sigmoid/en,函数/n,中/f,，/w,得到/v,一个/m,范围/n,为/p,0/m,-/w,1/m,之间/f,的/u,数/m,，/w,如果/c,该/r,数值/n,大于/v,0.5则/mq,被/p,归入/v,1类/mq,，/w,否则/c,被/p,归/v,为/p,0类/mq,。/w,基于/p,之前/f,的/u,分析/vn,，/w,需要/v,找到/v,回归/v,系数/n,，/w,首先/d,我们/r,可以/v,将/d,sigmoid/en,函数/n,的/u,输入/v,形式/n,记/v,为/p,：/w,z/en, ,=/w, ,w/en,0/m,x/en,0/m, ,+/w, ,w/en,1/m,x/en,1/m, ,+/w,./w,./w,./w,+/w,wnxn/en,,/w,其中/r,x/en,为/p,输入/v,数据/n,，/w,相应/v,的/u,w/en,就是/d,我们/r,要求/v,的/u,系数/n,，/w,为了/p,求得/v,最佳/z,系数/n,，/w,结合/v,最/d,优化/v,理论/n,，/w,我们/r,可以/v,选取/v,梯度/n,上升法/nw,优化/v,算法/n,。/w,梯度/n,上升法/nw,的/u,基本/a,思想/n,是/v,:/w,要/v,找到/v,函数/n,的/u,最大值/nz,，/w,最/d,好/a,的/u,方法/n,是/v,沿着/p,该/r,函数/n,的/u,梯度/n,方向/n,寻找/v,。/w,要/v,想/v,更进一步/l,的/u,了解/v,这个/r,方法/n,，/w,建议/n,去/v,看/v,andrew/en, ,ng/en,的/u,机器/n,学习/v,课程/n,，/w,记得/v,在/p,第二/m,节/n,主要/b,讲述/v,的/u,就/d,是/v,梯度/n,下降/v,法/j,，/w,与/p,梯度/n,上升/v,所/u,不同/a,的/u,是/v,它/r,求得/v,的/u,是/v,函数/n,的/u,最小值/nz,，/w,不过/c,思想/n,是/v,一致/a,的/u,。/w,二/m, ,python/en,实现/v,基于/p,之前/f,的/u,分析/vn,，/w,在/p,本节/t,我们/r,对/p,logistic/en,回归/v,一步/mq,一步/mq,采用/v,python/en,编程/vn,实现/v,，/w,今天/t,我/r,用/p,的/u,是/v,2.7/m,版本/n,的/u,，/w,代码/n,如下/v,：/w,#,coding/en,:/w,utf/en,-/w,8/m, ,from/en, ,numpy/en, ,import/en, ,*/w, ,import/en, ,math/en, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,#,导入/v,数据/n, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,datamat/en, ,=/w, ,[/w,]/w, ,labelmat/en, ,=/w, ,[/w,]/w, ,fr/en, ,=/w, ,open/en,(/w,'/w,testset/en,./w,txt/en,'/w,)/w, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,linearr/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w,#,将/d,文本/n,中/f,的/u,每/r,行/v,中/f,的/u,字符/n,一个个/nw,分开/v,，/w,变成/v,list/en, ,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,return/en, ,datamat/en,,/w,labelmat/en, ,#,定义/n,sigmoid/en,函数/n, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w, ,#,梯度/n,上升/v,方法/n,求/v,出/v,回归/v,系数/n, ,def/en, ,gradascent/en,(/w,data/en,,/w,label/en,)/w,:/w, ,datamat/en, ,=/w, ,mat/en,(/w,data/en,)/w, ,labelmat/en, ,=/w, ,mat/en,(/w,label/en,)/w,./w,transpose/en,(/w,)/w, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamat/en,)/w, ,alpha/en, ,=/w, ,0.001/m, ,maxcycles/en, ,=/w, ,500/m, ,weights/en, ,=/w, ,ones/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,for/en, ,item/en, ,in/en, ,range/en,(/w,maxcycles/en,)/w,:/w, ,h/en, ,=/w, ,sigmoid/en,(/w,datamat/en, ,*/w, ,weights/en,)/w, ,error/en, ,=/w, ,(/w,labelmat/en, ,-/w, ,h/en,)/w,#,注意/v,labelmat/en,中/f,的/u,元素/n,的/u,数据/n,类型/n,应/v,为/p,int/en, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,datamat/en,./w,transpose/en,(/w,)/w, ,*/w, ,error/en, ,return/en, ,weights/en, ,'/w,'/w,'/w, ,#,测试/vn, ,data/en,,/w,label/en, ,=/w, ,loaddataset/en,(/w,)/w, ,print/en, ,gradascent/en,(/w,data/en,,/w,label/en,)/w, ,'/w,'/w,'/w, ,#,#,求/v,出/v,回归/v,系数/n,之后/f,，/w,就/d,确定/v,了/u,不同/a,数据/n,类别/n,之间/f,的/u,分隔线/nw,，/w,为了/p,便于/v,理解/v,，/w,可以/v,画/v,出/v,那/r,条/q,线/n, ,def/en, ,plotbestfit/en,(/w,weights/en,)/w,:/w, ,datamat/en,,/w,labelmat/en, ,=/w, ,loaddataset/en,(/w,)/w, ,dataarr/en, ,=/w, ,array/en,(/w,datamat/en,)/w, ,n/en, ,=/w, ,shape/en,(/w,dataarr/en,)/w,[/w,0/m,]/w, ,xcode/en,1/m, ,=/w, ,[/w,]/w, ,ycode/en,1/m, ,=/w, ,[/w,]/w, ,xcode/en,2/m, ,=/w, ,[/w,]/w, ,ycode/en,2/m, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,if/en, ,int/en,(/w,labelmat/en,[/w,i/en,]/w,)/w, ,=/w,=/w, ,1/m,:/w, ,xcode/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w, ,ycode/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,else/en,:/w, ,xcode/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w, ,ycode/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,)/w, ,ax/en, ,=/w, ,fig/en,./w,add/en,_,subplot/en,(/w,111/m,)/w, ,ax/en,./w,scatter/en,(/w,xcode/en,1/m,,/w,ycode/en,1/m,,/w,s/en, ,=/w, ,30/m,,/w,c/en, ,=/w, ,'/w,red/en,'/w,,/w,marker/en, ,=/w, ,'/w,s/en,'/w,)/w, ,ax/en,./w,scatter/en,(/w,xcode/en,2/m,,/w,ycode/en,2/m,,/w,s/en, ,=/w, ,30/m,,/w,c/en, ,=/w, ,'/w,green/en,'/w,)/w, ,x/en, ,=/w, ,arange/en,(/w,-/w,3.0/m,,/w,3.0/m,,/w,0.1/m,)/w, ,y/en, ,=/w, ,(/w,-/w,weights/en,[/w,0/m,]/w, ,-/w, ,weights/en,[/w,1/m,]/w, ,*/w, ,x/en,)/w, ,//w, ,weights/en,[/w,2/m,]/w, ,ax/en,./w,plot/en,(/w,x/en,,/w,y/en,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,1/m,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,1/m,'/w,)/w, ,plt/en,./w,show/en,(/w,)/w, ,'/w,'/w,'/w, ,#,测试/vn, ,data/en,,/w,label/en, ,=/w, ,loaddataset/en,(/w,)/w, ,weights/en, ,=/w, ,gradascent/en,(/w,data/en,,/w,label/en,)/w, ,plotbestfit/en,(/w,weights/en,./w,geta/en,(/w,)/w,)/w, ,'/w,'/w,'/w, ,#,#,改进/v,的/u,梯度/n,上升法/nw, ,def/en, ,stocgradascent/en,1/m,(/w,datamatrix/en,,/w, ,classlabels/en,,/w, ,numiter/en,=/w,150/m,)/w,:/w, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,weights/en, ,=/w, ,ones/en,(/w,n/en,)/w, ,#,initialize/en, ,to/en, ,all/en, ,ones/en, ,for/en, ,j/en, ,in/en, ,range/en,(/w,numiter/en,)/w,:/w, ,dataindex/en, ,=/w, ,range/en,(/w,m/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,alpha/en, ,=/w, ,4/m,//w,(/w,1.0/m,+/w,j/en,+/w,i/en,)/w,+/w,0.0001/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,dataindex/en,)/w,)/w,)/w, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamatrix/en,[/w,randindex/en,]/w,*/w,weights/en,)/w,)/w, ,error/en, ,=/w, ,classlabels/en,[/w,randindex/en,]/w, ,-/w, ,h/en, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,error/en, ,*/w, ,datamatrix/en,[/w,randindex/en,]/w, ,del/en,(/w,dataindex/en,[/w,randindex/en,]/w,)/w, ,return/en, ,weights/en, ,'/w,'/w,'/w, ,#,测试/vn, ,data/en,,/w,label/en, ,=/w, ,loaddataset/en,(/w,)/w, ,weights/en, ,=/w, ,stocgradascent/en,1/m,(/w,array/en,(/w,data/en,)/w,,/w,label/en,)/w, ,plotbestfit/en,(/w,weights/en,)/w, ,'/w,'/w,'/w,三/m, ,实例/n,分析/vn,基于/p,之前/f,的/u,分析/vn,，/w,本节/t,采用/v,logistic/en,回归/v,来/v,预测/v,患有/v,疝病/nw,的/u,马/n,的/u,存活/vn,问题/n,，/w,代码/n,如下/v,：/w,def/en, ,classifyvector/en,(/w,inx/en,,/w,weights/en,)/w,:/w, ,prob/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,inx/en, ,*/w, ,weights/en,)/w,)/w, ,if/en, ,prob/en, ,>, ,0.5/m,:/w, ,return/en, ,1.0/m, ,else/en,:/w, ,return/en, ,0.0/m, ,def/en, ,colictest/en,(/w,)/w,:/w, ,frtrain/en, ,=/w, ,open/en,(/w,'/w,horsecolictraining/en,./w,txt/en,'/w,)/w,;/w, ,frtest/en, ,=/w, ,open/en,(/w,'/w,horsecolictest/en,./w,txt/en,'/w,)/w, ,trainingset/en, ,=/w, ,[/w,]/w,;/w, ,traininglabels/en, ,=/w, ,[/w,]/w, ,for/en, ,line/en, ,in/en, ,frtrain/en,./w,readlines/en,(/w,)/w,:/w, ,currline/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w, ,linearr/en, ,=/w,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,21/m,)/w,:/w, ,linearr/en,./w,append/en,(/w,float/en,(/w,currline/en,[/w,i/en,]/w,)/w,)/w, ,trainingset/en,./w,append/en,(/w,linearr/en,)/w, ,traininglab