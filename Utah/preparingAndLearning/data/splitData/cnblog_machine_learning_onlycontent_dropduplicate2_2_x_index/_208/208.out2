一/m,，/w,引言/n,假设/v,我们/r,现有/v,一些/m,数据点/nw,，/w,我们/r,用/p,一条/mq,直线/n,对/p,这些/r,点/q,进行/v,拟合/nz,，/w,这个/r,拟合/nz,的/u,过程/n,就/d,称作/v,回归/v,。/w,利用/v,logistic/en,回归/v,进行/v,分类/vn,的/u,主要/b,思想/n,是/v,：/w,根据/p,现有/v,数据/n,对/p,分类/vn,边界线/n,建立/v,回归/v,公式/n,，/w,以此/d,进行/v,分类/vn,。/w,我们/r,知道/v,，/w,logistic/en,回归/v,主要/b,是/v,进行/v,二/m,分类/vn,预测/v,，/w,也/d,即/v,是/v,对于/p,0/m,~/w,1/m,之间/f,的/u,概率/n,值/n,，/w,当/p,概率/n,大于/v,0.5/m,预测/v,为/p,1/m,，/w,小于/v,0.5/m,预测/v,为/p,0/m,./w,显然/ad,，/w,我们/r,不能不/d,提到/v,一个/m,函数/n,，/w,即/v,sigmoid/en,=/w,1/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w,,/w,该/r,函数/n,的/u,曲线/n,类似/v,于/p,一个/m,s/en,型/k,，/w,在/p,x/en,=/w,0处/mq,，/w,函数/n,值/n,为/p,0/m,./w,5/m,./w,于是/c,，/w,为了/p,实现/v,logistic/en,分类器/nw,，/w,我们/r,可以/v,在/p,每个/r,特征/n,上/f,都/d,乘/v,以/p,一个/m,回归/v,系数/n,，/w,然后/c,所有/b,的/u,相乘/v,结果/n,进行/v,累加/v,，/w,将/d,这个/r,总结/v,作为/v,输入/v,，/w,输入/v,到/v,sigmoid/en,函数/n,中/f,，/w,从而/c,得到/v,一个/m,大小/n,为/p,0/m,~/w,1/m,之间/f,的/u,值/n,，/w,当/p,该/r,值/n,大于/nrf,0.5/m,归类/vn,为/p,1/m,，/w,否则/c,归类/vn,为/p,0/m,，/w,这样/r,就/d,完成/v,了/u,二/m,分类/vn,的/u,任务/n,。/w,所以/c,logistic/en,回归/v,可以/v,看成/v,是/v,一种/mq,概率/n,估计/v,。/w,二/m,，/w,基于/p,最/d,优化/v,方法/n,的/u,最佳/z,回归/v,系数/n,确定/v,sigmoid/en,函数/n,的/u,输入/v,记/v,为/p,z/en,，/w,即/v,z/en,=/w,w/en,0/m,x/en,0/m,+/w,w/en,1/m,x/en,1/m,+/w,w/en,2/m,x/en,2/m,+/w,./w,./w,./w,+/w,wnxn/en,，/w,如果/c,用/p,向/p,量/n,表示/v,即/v,为/p,z/en,=/w,wtx/en,，/w,它/r,表示/v,将/d,这/r,两个/m,数值/n,向量/n,对应/v,元素/n,相/d,乘然/nw,后/f,累/a,加/v,起来/v,。/w,其中/r,，/w,向量/n,x/en,是/v,分类器/nw,的/u,输入/v,数据/n,，/w,w/en,即/v,为/p,我们/r,要/v,拟合/nz,的/u,最佳/z,参数/n,，/w,从而/c,使/v,分类器/nw,预测/v,更加/d,准确/a,。/w,也就是说/l,，/w,logistic/en,回归/v,最/d,重要/a,的/u,是/v,要/v,找到/v,最佳/z,的/u,拟合/nz,参数/n,。/w,1/m, ,梯度/n,上升法/nw,梯度/n,上升法/nw,(/w,等同/v,于/p,我们/r,熟知/v,的/u,梯度/n,下降/v,法/j,，/w,前者/r,是/v,寻找/v,最大值/nz,，/w,后者/r,寻找/v,最小值/nz,)/w,，/w,它/r,的/u,基本/a,思想/n,是/v,：/w,要/v,找到/v,某/r,函数/n,的/u,最大值/nz,，/w,最/d,好/a,的/u,方法/n,就/d,是/v,沿着/p,该/r,函数/n,的/u,梯度/n,方向/n,搜寻/v,。/w,如果/c,函数/n,为/p,f/en,，/w,梯度/n,记/v,为/p,d/en,，/w,a/en,为/p,步长/nz,，/w,那么/r,梯度/n,上升法/nw,的/u,迭代/vn,公式/n,为/p,：/w,w/en,：/w,w/en,+/w,a/en,*/w,dwf/en,(/w,w/en,)/w,。/w,该/r,公式/n,停止/v,的/u,条件/n,是/v,迭代/vn,次数/n,达到/v,某个/r,指定值/nw,或者/c,算法/n,达到/v,某个/r,允许/v,的/u,误差/n,范围/n,。/w,我们/r,熟知/v,的/u,梯度/n,下降/v,法/j,迭代/vn,公式/n,为/p,：/w,w/en,：/w,w/en,-/w,a/en,*/w,dwf/en,(/w,w/en,)/w,2/m, ,使用/v,梯度/n,上升法/nw,寻找/v,最佳/z,参数/n,假设/v,有/v,100个/m,样本点/nw,，/w,每个/r,样本/n,有/v,两个/m,特征/n,：/w,x/en,1/m,和/c,x/en,2/m,./w,此外/c,为/p,方便/a,考虑/v,，/w,我们/r,额外/b,添加/vn,一个/m,x/en,0/m,=/w,1/m,，/w,将/d,线性/n,函数/n,z/en,=/w,wtx/en,+/w,b/en,转为/v,z/en,=/w,wtx/en,(/w,此时/r,向/p,量/n,w/en,和/c,x/en,的/u,维度/n,均价/nz,1/m,)/w,./w,那么/r,梯度/n,上升法/nw,的/u,伪代码/nw,如下/v,：/w,初始化/v,每个/r,回归/v,系数/n,为/p,1/m,重复/v,r/en,次/q,：/w,计算/v,整个/b,数据集/nw,梯度/n,使用/v,alpha/en,*/w,gradient/en,更新/v,回归/v,系数/n,的/u,向量/n,返回/v,回归/v,系数/n,代码/n,如下/v,：/w,#,预/d,处理/v,数据/n, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,#,创建/v,两个/m,列表/v, ,datamat/en,=/w,[/w,]/w,;/w,labelmat/en,=/w,[/w,]/w, ,#,打开/v,文本/n,数据集/nw, ,fr/en,=/w,open/en,(/w,'/w,testset/en,./w,txt/en,'/w,)/w, ,#,遍历/nw,文本/n,的/u,每/r,一行/n, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,#,对/p,当前/t,行/v,去除/v,首尾/n,空格/n,，/w,并/c,按/p,空格/n,进行/v,分离/v, ,linearr/en,=/w,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,#,将/d,每/r,一行/n,的/u,两个/m,特征/n,x/en,1/m,，/w,x/en,2/m,，/w,加上/v,x/en,0/m,=/w,1/m,,/w,组成/v,列表/v,并/c,添加/vn,到/v,数据/n,集列表/nw,中/f, ,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,#,将/d,当前/t,行/v,标签/n,添加/vn,到/v,标签/n,列表/v, ,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,#,返回/v,数据/n,列表/v,，/w,标签/n,列表/v, ,return/en, ,datamat/en,,/w,labelmat/en, ,#,定义/n,sigmoid/en,函数/n, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w, ,#,梯度/n,上升法/nw,更新/v,最/d,优/ag,拟合/nz,参数/n, ,#,@/w,datamatin/en,：/w,数据集/nw, ,#,@/w,classlabels/en,：/w,数据/n,标签/n, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w,classlabels/en,)/w,:/w, ,#,将/d,数据集/nw,列表/v,转为/v,numpy/en,矩阵/n, ,datamatrix/en,=/w,mat/en,(/w,datamatin/en,)/w, ,将/d,数据集/nw,标签/n,列表/v,转为/v,numpy/en,矩阵/n,，/w,并转/v,置/v, ,labelmat/en,=/w,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w, ,#,获取/v,数据集/nw,矩阵/n,的/u,行数/n,和/c,列数/nw, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamat/en,)/w, ,#,学习/v,步长/nz, ,alpha/en,=/w,0.001/m, ,#,最/d,大/a,迭代/vn,次数/n, ,maxcycles/en,=/w,500/m, ,#,初始化/v,权值/nw,参数/n,向量/n,每个/r,维度/n,均/d,为/p,1.0/m, ,weights/en,=/w,one/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,#,循环/vn,迭代/vn,次数/n, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxcycles/en,)/w,:/w, ,#,求/v,当前/t,的/u,sigmoid/en,函数/n,预测/v,概率/n, ,h/en,=/w,sigmoid/en,(/w,datamatrix/en,*/w,weights/en,)/w, ,#,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w, ,#,此处/s,计算/v,真实/a,类别/n,和/c,预测/v,类别/n,的/u,差值/n, ,#,对/p,logistic/en,回归/v,函数/n,的/u,对数/n,释然/z,函数/n,的/u,参数/n,项求/nr,偏导/nw, ,error/en,=/w,(/w,labelmat/en,-/w,h/en,)/w, ,#,更新/v,权值/nw,参数/n, ,weights/en,=/w,weights/en,+/w,alpha/en,*/w,datamatrix/en,./w,transpose/en,(/w,)/w,*/w,error/en, ,#,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w, ,return/en, ,weights/en,这里/r,，/w,对/p,上述/b,代码/n,的/u,星号/n,以内/f,的/u,代码/n,进行/v,相应/v,的/u,说明/v,，/w,我们/r,知道/v,对/p,回归/v,系数/n,进行/v,更新/v,的/u,公式/n,为/p,：/w,w/en,：/w,w/en,+/w,alpha/en,*/w,gradient/en,,/w,其中/r,gradient/en,是/v,对/p,参数/n,w/en,求/v,偏/d,导数/n,。/w,则/d,我们/r,可以/v,通过/p,求导/nw,验证/vn,logistic/en,回归/v,函数/n,对/p,参数/n,w/en,的/u,梯度/n,为/p,(/w,yi/en,-/w,sigmoid/en,(/w,wtx/en,)/w,)/w,*/w,x/en,,/w,证明/v,过程/n,如下/v,所/u,示/vg,：/w,我们/r,还/d,可以/v,通过/p,matpotlib/en,画/v,出/v,决策/n,的/u,边界/n,，/w,集体/n,代码/n,为/p,：/w,def/en, ,plotbestfit/en,(/w,wei/en,)/w,:/w, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,weights/en, ,=/w, ,wei/en,./w,geta/en,(/w,)/w, ,datamat/en,,/w, ,labelmat/en, ,=/w, ,loaddataset/en,(/w,)/w, ,dataarr/en, ,=/w, ,array/en,(/w,datamat/en,)/w, ,n/en, ,=/w, ,shape/en,(/w,dataarr/en,)/w,[/w,0/m,]/w, ,xcord/en,1/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,1/m, ,=/w, ,[/w,]/w, ,xcord/en,2/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,2/m, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,if/en, ,int/en,(/w,labelmat/en,[/w,i/en,]/w,)/w, ,=/w,=/w, ,1/m,:/w, ,xcord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,else/en,:/w, ,xcord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,)/w, ,ax/en, ,=/w, ,fig/en,./w,add/en,_,subplot/en,(/w,111/m,)/w, ,ax/en,./w,scatter/en,(/w,xcord/en,1/m,,/w, ,ycord/en,1/m,,/w, ,s/en, ,=/w, ,30/m,,/w, ,c/en, ,=/w, ,'/w,red/en,'/w,,/w, ,marker/en,=/w,'/w,s/en,'/w,)/w, ,ax/en,./w,scatter/en,(/w,xcord/en,2/m,,/w, ,ycord/en,2/m,,/w, ,s/en, ,=/w, ,30/m,,/w, ,c/en, ,=/w, ,'/w,green/en,'/w,)/w, ,x/en, ,=/w, ,arange/en,(/w,-/w,3.0/m,,/w, ,3.0/m,,/w, ,0.1/m,)/w, ,y/en, ,=/w, ,(/w,-/w,weights/en,[/w,0/m,]/w,-/w, ,weights/en,[/w,1/m,]/w,*/w,x/en,)/w,//w,weights/en,[/w,2/m,]/w, ,ax/en,./w,plot/en,(/w,x/en,,/w, ,y/en,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,1/m,'/w,)/w,;/w, ,plt/en,./w,ylabel/en,(/w,'/w,x/en,2/m,'/w,)/w,;/w, ,plt/en,./w,show/en,(/w,)/w,3/m, ,随机/d,梯度/n,上升法/nw,我们/r,知道/v,梯度/n,上升法/nw,每次/r,更新/v,回归/v,系数/n,都/d,需要/v,遍历/nw,整个/b,数据集/nw,，/w,当/p,样本/n,数量/n,较/d,小时/n,，/w,该/r,方法/n,尚/d,可/v,，/w,但是/c,当/p,样本/n,数据集/nw,非常/d,大/a,且/c,特征/n,非常/d,多/a,时/ng,，/w,那么/r,随机/d,梯度/n,下降/v,法/j,的/u,计算/v,复杂/a,度/q,就/d,会/v,特别/d,高/a,。/w,一种/mq,改进/v,的/u,方法/n,是/v,一次/mq,仅/d,用/p,一个/m,样本点/nw,来/v,更新/v,回归/v,系数/n,，/w,即/v,岁/q,集梯度/nw,上升法/nw,。/w,由于/c,可以/v,在/p,新/a,样本/n,到来/vn,时/ng,对/p,分类器/nw,进行/v,增量/n,式/k,更新/v,，/w,因此/c,随机/d,梯度/n,上升法/nw,是/v,一个/m,在线/vn,学习/v,算法/n,。/w,随机/d,梯度/n,上升法/nw,可以/v,写/v,成/v,如下伪代码/nw,：/w,所有/b,回归/v,系数/n,初始/b,化为/v,1对/mq,数据集/nw,每个/r,样本/n,计算/v,该/r,样本/n,的/u,梯度/n,使用/v,alpha/en,*/w,gradient/en,更新/v,回顾/v,系数/n,值/n,返回/v,回归/v,系数/n,值/n,#,梯度/n,上升/v,算法/n, ,def/en, ,stocgradascent/en,(/w,datamatrix/en,,/w,classlabels/en,)/w,:/w, ,#,为/p,便于/v,计算/v,，/w,转为/v,numpy/en,数组/n, ,datamat/en,=/w,array/en,(/w,datamatrix/en,)/w, ,获取/v,数据集/nw,的/u,行数/n,和/c,列数/nw, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamatrix/en,)/w, ,#,初始化/v,权值/nw,向量/n,各个/r,参数/n,为/p,1.0/m, ,weights/en,=/w,ones/en,(/w,n/en,)/w, ,#,设置/v,步长/nz,为/p,0.01/m, ,alpha/en,=/w,0.01/m, ,#,循环/vn,m/en,次/q,，/w,每次/r,选取/v,数据集/nw,一个/m,样本/n,更新/v,参数/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,计算/v,当前/t,样本/n,的/u,sigmoid/en,函数/n,值/n, ,h/en,=/w,sigmoid/en,(/w,datamatrix/en,[/w,i/en,]/w,+/w,weights/en,)/w, ,#,计算/v,当前/t,样本/n,的/u,残差/nw,(/w,代替/v,梯度/n,)/w, ,error/en,=/w,(/w,classlabels/en,[/w,i/en,]/w,-/w,h/en,)/w, ,#,更新/v,权值/nw,参数/n, ,weights/en,=/w,weights/en,+/w,alpha/en,*/w,error/en,*/w,datamatrix/en,[/w,i/en,]/w, ,return/en, ,weights/en,我们/r,知道/v,，/w,评判/v,一个/m,优化/v,算法/n,的/u,优劣/n,的/u,可靠/a,方法/n,是/v,看/v,其/r,是否/v,收敛/vn,，/w,也就是说/l,参数/n,的/u,值/n,是否/v,达到/v,稳定值/nw,。/w,此外/c,，/w,当/p,参数/n,值/n,接近/v,稳定/a,时/ng,，/w,仍然/d,可能/v,会/v,出现/v,一些/m,小/a,的/u,周期性/n,的/u,波动/vn,。/w,这种/r,情况/n,发生/v,的/u,原因/n,是/v,样本/n,集中/v,存在/v,一些/m,不能/v,正确/a,分类/vn,的/u,样本点/nw,(/w,数据集/nw,并非线性/nw,可分/v,)/w,，/w,所以/c,这些/r,点/q,在/p,每次/r,迭代/vn,时/ng,会/v,引发/v,系数/n,的/u,剧烈/a,改变/v,，/w,造成/v,周期性/n,的/u,波动/vn,。/w,显然/ad,我们/r,希望/v,算法/n,能够/v,避免/v,来回/v,波动/vn,，/w,从而/c,收敛/vn,到/v,某个/r,值/n,，/w,并且/c,收敛/vn,速度/n,也/d,要/v,足够/v,快/a,。/w,为此/l,，/w,需要/v,对/p,上述/b,随机/d,梯度/n,上升法/nw,代码/n,进行/v,适当/a,修改/v,，/w,代码/n,如下/v,：/w,#,@/w,datamatrix/en,：/w,数据集/nw,列表/v, ,#,@/w,classlabels/en,：/w,标签/n,列表/v, ,#,@/w,numiter/en,：/w,迭代/vn,次数/n,，/w,默认/v,150/m, ,def/en, ,stocgradascent/en,1/m,(/w,datamatrix/en,,/w,classlabels/en,,/w,numiter/en,=/w,150/m,)/w,:/w, ,#,将/d,数据集/nw,列表/v,转为/v,numpy/en,数组/n, ,datamat/en,=/w,array/en,(/w,datamatrix/en,)/w, ,#,获取/v,数据集/nw,的/u,行数/n,和/c,列数/nw, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamat/en,)/w, ,#,初始化/v,权值/nw,参数/n,向量/n,每个/r,维度/n,均/d,为/p,1/m, ,weights/en,=/w,ones/en,(/w,n/en,)/w, ,#,循环/vn,每次/r,迭代/vn,次数/n, ,for/en, ,j/en, ,in/en, ,range/en,(/w,numiter/en,)/w,:/w, ,#,获取/v,数据/n,集行/nw,下标/n,列表/v, ,dataindex/en,=/w,range/en,(/w,m/en,)/w, ,#,遍历/nw,行列/n,表/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,每次/r,更新/v,参数/n,时/ng,设置/v,动态/n,的/u,步长/nz,，/w,且/c,为/p,保证/v,多次/m,迭代/vn,后/f,对/p,新/a,数据/n,仍然/d,具有/v,一定/d,影响/vn, ,#,添加/vn,了/u,固定/a,步长/nz,0.1/m, ,alpha/en,=/w,4/m,//w,(/w,1.0/m,+/w,j/en,+/w,i/en,)/w,+/w,0.1/m, ,#,随机/d,获取/v,样本/n, ,randomindex/en,=/w,int/en,(/w,random/en,./w,nuiform/en,(/w,0/m,,/w,len/en,(/w,dataindex/en,)/w,)/w,)/w, ,#,计算/v,当前/t,sigmoid/en,函数/n,值/n, ,h/en,=/w,sigmoid/en,(/w,datamat/en,[/w,randomindex/en,]/w,*/w,weights/en,)/w, ,#,计算/v,权值/nw,更新/v, ,#,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w, ,error/en,=/w,classlabels/en,-/w,h/en, ,weights/en,=/w,weights/en,+/w,alpha/en,*/w,error/en,*/w,datamat/en,[/w,randomindex/en,]/w, ,#,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w,*/w, ,#,选取/v,该/r,样本/n,后/f,，/w,将/d,该/r,样本/n,下标/n,删除/v,，/w,确保/v,每次/r,迭代/vn,时/ng,只/d,使用/v,一次/mq, ,del/en,(/w,dataindex/en,[/w,randomindex/en,]/w,)/w, ,return/en, ,weights/en,上述/b,代码/n,中/f,有/v,两处/mq,改进/v,的/u,地方/n,：/w,1/m, ,alpha/en,在/p,每次/r,迭代/vn,更新/v,是/v,都/d,会/v,调整/vn,，/w,这/r,会/v,缓解/v,数据/n,波动/vn,或者/c,高频/b,运动/n,。/w,此外/c,，/w,alpha/en,还有/v,一个/m,常数/n,项/q,，/w,目的/n,是/v,为了/p,保证/v,在/p,多次/m,迭代/vn,后/f,仍然/d,对/p,新/a,数据/n,具有/v,一定/d,的/u,影响/vn,，/w,如果/c,要/v,处理/v,的/u,问题/n,是/v,动态/n,变化/vn,的/u,，/w,可以/v,适当/a,加大/v,该/r,常/d,数/m,项/q,，/w,从而/c,确保/v,新/a,的/u,值/n,获得/v,更/d,大/a,的/u,回归/v,系数/n,。/w,2/m, ,第二/m,个/q,改进/v,的/u,地方/n,是/v,选择/v,随机/d,的/u,样本/n,对/p,参数/n,进行/v,更新/v,，/w,由于/c,增加/v,了/u,随机性/n,，/w,这/r,就/d,防止/v,参数/n,值/n,发生/v,周期性/n,的/u,波动/vn,。/w,3/m, ,并且/c,采用/v,上述/b,改进/v,算法/n,后/f,，/w,收敛/vn,速度/n,更/d,快/a,此时/r,在/p,利用/v,matplotlib/en,可视化/nz,回归/v,情况/n,：/w,可以/v,看出/v,，/w,经过/p,改进/v,的/u,随机/d,梯度/n,上升法/nw,取得/v,不错/a,的/u,分类/vn,效果/n,，/w,并且/c,计算量/nw,更/d,小/a,了/u,。/w,三/m,，/w,logistic/en,回归/v,实例/n,：/w,从/p,疝气/n,病症/n,预测/v,病马/nw,死亡率/n,现有/v,数据集/nw,有/v,100个/m,样本/n,和/c,20个/m,特征/n,，/w,但是/c,数据/n,存在/v,一定/d,的/u,问题/n,，/w,即/v,数据集/nw,有/v,30%/mq,的/u,缺失/n,，/w,因此/c,，/w,我们/r,在/p,对/p,病马/nw,进行/v,预测/v,死亡率/n,前/f,，/w,首先/d,要/v,解决/v,数据/n,的/u,缺失/n,问题/n,。/w,我们/r,可能/v,会/v,遇到/v,数据/n,缺失/n,的/u,情况/n,，/w,但/c,有时候/d,数据/n,相当/d,昂贵/a,，/w,扔掉/v,和/c,重新/d,获取/v,均/d,不/d,可取/a,，/w,这/r,显然/ad,是/v,会/v,带来/v,更/d,多/a,的/u,成本/n,负担/n,，/w,所以/c,我们/r,可以/v,选取/v,一些/m,有效/a,的/u,方法/n,来/v,解决/v,该类/r,问题/n,。/w,比如/v,：/w,1/m, ,使用/v,可/v,用/p,特征/n,的/u,均值/n,填补/v,缺/v,失值/nw,2/m, ,使用/v,特殊/a,值/n,来/v,填补/v,缺失/n,的/u,特征/n,，/w,如/v,-/w,13/m, ,忽略/v,有/v,缺/v,失值/nw,的/u,样本/n,4/m, ,使用/v,相似/a,样本/n,的/u,平均值/n,填补/v,缺/v,失值/nw,5/m, ,使用/v,另外/c,的/u,机器/n,学习/v,算法/n,预测/v,缺/v,失值/nw,这里/r,我们/r,根据/p,logstic/en,回归/v,的/u,函数/n,特征/n,，/w,选择/v,实数/n,0/m,来/v,替换/v,所有/b,缺失/n,值/n,，/w,而/c,这/r,恰好/d,能/v,适用/v,logistic/en,回归/v,。/w,因此/c,，/w,它/r,在/p,参数/n,更/d,新/a,时/ng,不/d,会/v,影响/vn,参数/n,的/u,值/n,。/w,即/v,如果/c,某/r,特征/n,对/p,应值/nw,为/p,0/m, ,，/w,那么/r,由/p,公式/n,w/en,：/w,w/en,+/w,alpha/en,*/w,gradient/en,，/w,可知/v,w/en,不/d,会/v,发生/v,改变/v,。/w,此外/c,，/w,由于/c,sigmoid/en,(/w,0/m,)/w,=/w,0.5/m,,/w,表面/n,该/r,特征/n,对/p,结果/n,的/u,预测/v,不/d,具有/v,任何/r,倾向性/n,，/w,因此/c,不/d,会/v,对/p,误差/n,造成/v,影响/vn,。/w,当然/d,，/w,如果/c,是/v,发生/v,有/v,样本/n,的/u,类/q,标签/n,缺/v,失/v,的/u,情况/n,，/w,此时/r,我们/r,最/d,好/a,的/u,办法/n,是/v,将/d,该/r,样本/n,舍弃/v,，/w,这/r,是/v,因为/c,标签/n,与/p,特征/n,不同/a,，/w,我们/r,很/d,难/a,确定/v,采用/v,某个/r,合适/a,的/u,值替/nw,换/v,掉/v,。/w,下面/f,来看/v,回归/v,分类器/nw,代码/n,：/w,#,------------------------------/nrf,实例/n,：/w,从/p,疝气/n,病/n,预测/v,病马/nw,的/u,死亡率/n,----------------------------/nrf, ,#,1/m, ,准备/v,数据/n,：/w,处理/v,数据/n,的/u,缺失/n,值/n, ,#,这里/r,将/d,特征/n,的/u,缺失/n,值/n,补/v,0/m,，/w,从而/c,在/p,更新/v,时/ng,不/d,影响/vn,系数/n,的/u,值/n, ,#,2/m, ,分类/vn,决策/n,函数/n, ,def/en, ,clasifyvector/en,(/w,inx/en,,/w,weights/en,)/w,:/w, ,#,计算/v,logistic/en,回归/v,预测/v,概率/n, ,prob/en,=/w,sigmoid/en,(/w,inx/en,*/w,weights/en,)/w, ,#,大于/v,0.5/m,预测/v,为/p,1/m, ,if/en, ,prob/en,>,0.5/m,:/w, ,return/en, ,1.0/m, ,#,否则/c,预测/v,为/p,0/m, ,else/en,:/w, ,return/en, ,0.0/m, ,#,logistic/en,回归/v,预测/v,算法/n, ,def/en, ,colictest/en,(/w,)/w,:/w, ,#,打开/v,训练/vn,数据集/nw, ,frtrain/en,=/w,open/en,(/w,'/w,horsecolictraining/en,./w,txt/en,'/w,)/w, ,#,打开/v,测试/vn,数据集/nw, ,frtest/en,=/w,open/en,(/w,'/w,horsecolictest/en,./w,txt/en,'/w,)/w, ,#,新建/v,两个/m,孔列表/nr,，/w,用于/v,保存/v,训练/vn,数据集/nw,和/c,标签/n, ,trainingset/en,=/w,[/w,]/w,;/w,traininglabels/en,=/w,[/w,]/w, ,#,读/v,取/v,训练/vn,集/vg,文档/n,的/u,每/r,一行/n, ,for/en, ,line/en, ,in/en, ,frtrain/en,./w,readlines/en,(/w,)/w,:/w, ,#,对/p,当前/t,行/v,进行/v,特征/n,分割/v, ,currline/en,=/w,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,#,新建/v,列表/v,存储/vn,每个/r,样本/n,的/u,特征/n,向量/n, ,linearr/en,=/w,[/w,]/w, ,#,遍历/nw,每个/r,样本/n,的/u,特征/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,21/m,)/w,:/w, ,将/d,该/r,样本/n,的/u,特征/n,存入/v,linearr/en,列表/v, ,linearr/en,./w,append/en,(/w,float/en,(/w,currline/en,[/w,i/en,]/w,)/w,)/w, ,#,将/d,该/r,样本/n,标签/n,存入/v,标签/n,列表/v, ,traininglabels/en,./w,append/en,(/w,currline/en,[/w,21/m,]/w,)/w, ,#,将/d,该/r,样本/n,的/u,特征/n,向量/n,添加/vn,到/v,数据集/nw,列表/v, ,trainingset/en,./w,append/en,(/w,linearr/en,)/w, ,#,调用/v,随机/d,梯度/n,上升法/nw,更新/v,logistic/en,回归/v,的/u,权值/nw,参数/n, ,trainweights/en,=/w,stocgradascent/en,1/m,(/w,trainingset/en,,/w,traininglabels/en,,/w,500/m,)/w, ,#,统计/v,测试/vn,数据集/nw,预测/v,错误/n,样本/n,数量/n,和/c,样本/n,总数/n, ,errorcount/en,=/w,0/m,;/w,numtestvec/en,=/w,0.0/m, ,#,遍历/nw,测试/vn,数据集/nw,的/u,每个/r,样本/n, ,for/en, ,line/en, ,in/en, ,frtest/en,./w,readlines/en,(/w,)/w,:/w, ,#,样本/n,总数/n,加/v,1/m, ,numtestvec/en,+/w,=/w,1.0/m, ,#,对/p,当前/t,行/v,进行/v,处理/v,，/w,分割/v,出/v,各个/r,特征/n,及/c,样本/n,标签/n, ,currline/en,=/w,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,#,新建/v,特征/n,向量/n, ,linearr/en,=/w,[/w,]/w, ,#,将/d,各个/r,特征/n,构成/v,特征/n,向量/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,21/m,)/w,:/w, ,linearr/en,./w,append/en,(/w,float/en,(/w,currline/en,[/w,i/en,]/w,)/w,)/w, ,#,利用/v,分类/vn,预测/v,函数/n,对/p,该/r,样本/n,进行/v,预测/v,，/w,并/c,与/p,样本/n,标签/n,进行/v,比较/d, ,if/en,(/w,clasifyvector/en,(/w,linearr/en,,/w,trainweights/en,)/w,!/w,=/w,currline/en,[/w,21/m,]/w,)/w,:/w, ,#,如果/c,预测/v,错误/n,，/w,错误/n,数/m,加/v,1/m, ,errorcount/en,+/w,=/w,1/m, ,#,计算/v,测试/vn,集/vg,总/b,的/u,预测/v,错误/n,率/v, ,errorrate/en,=/w,(/w,float/en,(/w,errorcount/en,)/w,//w,numtestvec/en,)/w, ,#,打印/v,错误/n,率/v,大小/n, ,print/en,(/w,'/w,the/en, ,error/en, ,rate/en, ,of/en, ,this/en, ,test/en, ,is/en,:/w, ,%/w,f/en,'/w,,/w, ,%/w,(/w,errorrate/en,)/