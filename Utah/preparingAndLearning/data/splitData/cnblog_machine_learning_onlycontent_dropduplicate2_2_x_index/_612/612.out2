本章/r,导读/v,机器/n,学习/v,(/w,machine/en, ,learning/en,,/w, ,ml/en,)/w,是/v,一门/mq,涉及/v,概率/n,论/v,、/w,统计学/n,、/w,逼近论/nw,、/w,凸/ag,分析/vn,、/w,算法/n,复杂/a,度/q,理论/n,等/u,多/a,领域/n,的/u,交叉/vn,学科/n,。/w,ml/en,专注/v,于/p,研究/vn,计算机/n,模拟/b,或/c,实现/v,人类/n,的/u,学习/v,行为/n,，/w,以/p,获取/v,新/a,知识/n,、/w,新/a,技能/n,，/w,并/c,重组/vn,已/d,学习/v,的/u,知识/n,结构/n,使/v,之/u,不断/d,改善/v,自身/r,。/w,mllib/en,是/v,spark/en,提供/v,的/u,可/v,扩展/v,的/u,机器/n,学习库/nw,。/w,mllib/en,已经/d,集成/vn,了/u,大量/m,机器/n,学习/v,的/u,算法/n,，/w,由于/c,mllib/en,涉及/v,的/u,算法/n,众多/m,，/w,笔者/n,只/d,对/p,部分/n,算法/n,进行/v,了/u,分析/vn,，/w,其余/r,算法/n,只是/d,简单/a,列出/v,公式/n,，/w,读者/n,如果/c,想/v,要/v,对/p,公式/n,进行/v,推理/vn,，/w,需要/v,自己/r,寻找/v,有关/vn,概率/n,论/v,、/w,数理/j,统计/v,、/w,数理/j,分析/vn,等/u,方面/n,的/u,专门/d,著作/n,。/w,本章/r,更/d,侧重/v,于/p,机器/n,学习/v,api/en,的/u,使用/v,，/w,基本/a,能够/v,满足/v,大多数/m,读者/n,的/u,需要/v,。/w,1/m,./w, ,机器/n,学习/v,概率/n,机器/n,学习/v,也/d,属于/v,人工智能/n,的/u,范畴/n,，/w,该/r,领域/n,主要/b,研究/vn,的/u,对象/n,是/v,人工智能/n,，/w,尤其/d,是/v,如何/r,在/p,经验/n,学习/v,中/f,改善/v,具体/a,算法/n,。/w,机器/n,学习/v,是/v,人工智能/n,研究/vn,较为/d,年轻/a,的/u,分支/n,，/w,它/r,的/u,发展/vn,过程/n,大致/d,可/v,分为/v,如下/v,4个/m,阶段/n,：/w,第一/m,阶段/n,：/w,20/m,世纪/n,50/m,年代/n,中叶/t,至/p,60/m,年代/n,中叶/t,，/w,属于/v,热烈/a,时期/n,。/w,第二/m,阶段/n,：/w,20/m,世纪/n,60/m,年代/n,中叶/t,至/p,70/m,年代/n,中叶/t,，/w,称为/v,冷静/a,时期/n,。/w,第三/nw,阶段/n,：/w,20/m,世纪/n,70/m,年代/n,中叶/t,至/p,80/m,年代/n,中叶/t,，/w,称为/v,复兴/vn,时期/n,。/w,第四/nw,阶段/n,：/w,从/p,1986年/t,开始/v,至/p,今/tg,。/w,(/w,1/m,)/w, ,机器/n,学习/v,的/u,组成/v,机器/n,学习/v,的/u,基本/a,结构/n,由/p,环境/n,、/w,知识库/n,和/c,执行/v,部分/n,三/m,部分/n,组成/v,。/w,环境/n,向/p,学习/v,部分/n,(/w,属于/v,知识库/n,的/u,一部分/m,)/w,提供/v,某些/r,信息/n,，/w,学习/v,部分/n,利用/v,这些/r,信息/n,修改/v,知识库/n,，/w,以/p,增进/v,执行/v,部分/n,完成/v,任务/n,的/u,效能/n,，/w,执行/v,部分/n,根据/p,知识库/n,完成/v,任务/n,，/w,同时/c,把/p,获得/v,的/u,信息/n,反馈/v,给/p,学习/v,部分/n,。/w,(/w,2/m,)/w, ,学习/v,策略/n,学习/v,策略/n,是/v,指/v,机器/n,学习/v,过程/n,中/f,所/u,采用/v,的/u,推理/vn,策略/n,。/w,学习/v,系统/n,一般/a,由/p,学习/v,和/c,环境/n,两/m,部分/n,组成/v,。/w,环境/n,(/w,如/v,书本/n,或/c,教师/n,)/w,提供/v,信息/n,，/w,学习/v,部分/n,则/d,实现/v,信息/n,转换/v,、/w,存储/vn,，/w,并/c,从中/d,获取/v,有用/a,的/u,信息/n,。/w,学习/v,过程/n,中/f,，/w,学生/n,(/w,学习/v,部分/n,)/w,使用/v,的/u,推理/vn,越/d,少/a,，/w,他/r,对/p,教师/n,(/w,环境/n,)/w,的/u,依赖/v,就/d,越/d,大/a,，/w,教师/n,的/u,负担/n,也/d,就/d,越/d,重/a,。/w,根据/p,学生/n,实现/v,信息/n,转换/v,所/u,需/v,推理/vn,的/u,多少/r,和/c,难/a,易/a,程度/n,，/w,以/p,从/p,简单/a,到/v,复杂/a,，/w,从/p,少/a,到/v,多/a,的/u,次序/n,可以/v,将/d,学习/v,策略/n,分为/v,以下/f,6种/mq,基本/a,类型/n,：/w,机械/n,学习/v,（/w,rote/en, ,learning/en,）/w,：/w,学习/v,者/k,不/d,需要/v,任何/r,推理/vn,或/c,转换/v,，/w,直接/ad,获取/v,环境/n,所/u,提供/v,的/u,信息/n,。/w,属于/v,此类/r,的/u,如/v,塞缪尔/nr,的/u,跳棋/n,程序/n,。/w,示教/nw,学习/v,（/w,learning/en, ,from/en, ,instruction/en,）/w,：/w,学习者/n,从/p,环境/n,获取/v,信息/n,，/w,把/p,知识/n,转换/v,成/v,内部/f,可/v,使用/v,的/u,表示/v,形式/n,，/w,并/c,将/d,新/a,知识/n,和/c,原有/v,知识/n,有机/b,地/u,合/v,为/p,一体/n,。/w,此/r,种/q,学习/v,策略/n,需要/v,学生/n,有/v,一定/d,程度/n,的/u,推理/vn,能力/n,，/w,但/c,环境/n,仍/d,要/v,做/v,大量/m,的/u,工作/vn,。/w,典型/n,应用/vn,是/v,foo/en,程序/n,。/w,演绎/v,学习/v,（/w,learning/en, ,by/en, ,deduction/en,）/w,：/w,学习者/n,通过/p,推理/vn,获取/v,有用/a,的/u,知识/n,。/w,典型/n,应用/vn,是/v,宏/nr,操作/v,(/w,macro/en,-/w,operation/en,)/w,学习/v,。/w,类比/v,学习/v,（/w,learning/en, ,by/en, ,analogy/en,）/w,：/w,学习者/n,根据/p,两个/m,不同/a,领域/n,（/w,源域/nw,、/w,目标/n,域/ng,）/w,中/f,的/u,知识/n,相似性/n,，/w,通过/p,类比/v,，/w,从/p,源域/nw,的/u,知识/n,推导/vn,出/v,目标/n,域/ng,的/u,相应/v,知识/n,。/w,此类/r,应用/vn,如/v,卢瑟福类比/nw,。/w,基于/p,解释/v,的/u,学习/v,（/w,explanation/en,-/w,based/en, ,learning/en,,/w, ,ebl/en,）/w,：/w,学习者/n,根据/p,教师/n,提供/v,的/u,目标/n,概念/n,和/c,此/r,概念/n,的/u,例子/n,、/w,领域/n,理论/n,及/c,可/v,操作/v,准则/n,，/w,首先/d,给/p,出/v,解释/v,说明/v,为什么/r,该/r,例子/n,满足/v,目标/n,概念/n,，/w,然后/c,将/d,解释/v,推广/v,未/d,目标/n,概念/n,的/u,一个/m,满足/v,可/v,操作/v,准则/n,的/u,充分/ad,条件/n,。/w,著名/a,的/u,ebl/en,系统/n,由/p,迪乔恩/nr,（/w,g/en,./w,dejong/en,）/w,的/u,genesis/en,等/u,。/w,归纳/v,学习/v,（/w,learning/en, ,from/en, ,induction/en,）/w,：/w,由/p,环境/n,提供/v,某/r,概念/n,的/u,一些/m,实例/n,或/c,反例/nw,，/w,让/v,学习者/n,通过/p,归纳/v,推理/vn,得出/v,该/r,概念/n,的/u,一般/a,描述/v,。/w,归纳/v,学习/v,是/v,最/d,基本/a,的/u,，/w,发展/vn,也/d,较为/d,成熟/a,的/u,学习/v,方法/n,，/w,在/p,人工智能/n,领域/n,中/f,已/d,得到/v,广泛/a,的/u,研究/vn,和/c,应用/vn,。/w,学习/v,策略/n,还/d,可以/v,从/p,所/u,获取/v,知识/n,的/u,表示/v,形式/n,、/w,应用/vn,领域/n,等/u,维度/n,分类/vn,。/w,(/w,3/m,)/w, ,应用/vn,领域/n,目前/t,，/w,机器/n,学习/v,广泛/a,应用/vn,于/p,数据/n,挖掘/v,、/w,计算机/n,视觉/n,、/w,自然/d,语言/n,处理/v,、/w,生物/n,特征/n,识别/v,、/w,搜索引擎/n,、/w,医学/n,诊断/v,、/w,检测/vn,信用卡/n,欺诈/vn,、/w,证券/n,市场/n,分析/vn,、/w,dna/en,序列/n,测/v,序/n,、/w,语音/n,和/c,手写/v,识别/v,、/w,战略/n,游戏/n,和/c,机器人/n,等/u,领域/n,。/w,2/m,./w, ,spark/en, ,mllib/en,总体/n,设计/vn,mllib/en,（/w,machine/en, ,learning/en, ,library/en,）/w,是/v,spark/en,提供/v,的/u,可/v,扩展/v,的/u,机器/n,学习库/nw,。/w,mllib/en,中/f,已经/d,包含/v,了/u,一些/m,通用/vn,的/u,学习/v,算法/n,和/c,工具/n,，/w,如/v,：/w,分类/vn,、/w,回归/v,、/w,聚类/nw,、/w,协同/v,过滤/v,、/w,降维/nw,以及/c,底层/n,的/u,优化/v,原语/n,等/u,算法/n,和/c,工具/n,。/w,mllib/en,提供/v,的/u,api/en,主要/b,分为/v,以下/f,两类/mq,：/w,spark/en,./w,mllib/en,包/v,中/f,提供/v,的/u,主要/b,api/en,。/w,spark/en,./w,ml/en,包/v,中/f,提供/v,的/u,构建/v,机器/n,学习/v,工作流/nz,的/u,高/a,层次/n,的/u,api/en,。/w,3/m,./w, ,数据/n,类型/n,mllib/en,支持/v,存储/vn,在/p,一台/mq,机器/n,上/f,的/u,局部/n,向量/n,和/c,矩阵/n,以及/c,由/p,一个/m,或/c,多/a,个/q,rdd/en,支持/v,的/u,分布式/b,矩阵/n,。/w,局部/n,向量/n,和/c,局部/n,矩阵/n,是/v,提供/v,公共/b,接口/n,的/u,简单/a,数据/n,模型/n,。/w,breeze/en,和/c,jblas/en,提供/v,了/u,底层/n,的/u,线性/n,代数/n,运算/vn,。/w,breeze/en,提供/v,了/u,一组/mq,线性/n,代数/n,和/c,数字/n,计算/v,的/u,库/n,，/w,具体/a,信息/n,访问/v,http/en,:/w,//w,//w,www/en,./w,scalanlp/en,./w,org/en,//w,。/w,jblas/en,提供/v,了/u,使用/v,java/en,开发/v,的/u,线性/n,代数/n,库/n,，/w,具体/a,信息/n,访问/v,http/en,:/w,//w,//w,jblas/en,./w,org/en,//w,。/w,3.1/m, ,局部/n,向/p,量/n,mllib/en,支持/v,两种/mq,局部/n,向量/n,类型/n,：/w,密集/a,向量/n,（/w,dense/en,）/w,和/c,稀疏/a,向量/n,（/w,sparse/en,）/w,。/w,密集/a,向量/n,由/p,double/en,类型/n,的/u,数/m,组/q,支持/v,，/w,而/c,稀疏/a,向/p,量/n,则/d,由/p,两个/m,平行数/nw,组/q,支持/v,。/w,例如/v,，/w,向量/n,(/w,1.0/m,，/w,0.0/m,，/w,3.0/m,)/w,由/p,密集/a,向量/n,表示/v,的/u,格式/n,为/p,[/w,1.0/m,，/w,0.0/m,，/w,3.0/m,]/w,，/w,由/p,稀疏/a,向量/n,表示/v,的/u,格式/n,为/p,(/w,3/m,，/w,[/w,0/m,，/w,2/m,]/w,，/w,[/w,1.0/m,，/w,3.0/m,]/w,)/w,。/w,注意/v,：/w,这里/r,对/p,稀疏/a,向/p,量/n,做/v,些/q,解释/v,。/w,3/m,是/v,向量/n,(/w,1.0/m,，/w,0.0/m,，/w,3.0/m,)/w,的/u,长度/n,，/w,除去/v,0/m,值/n,外/f,，/w,其他/r,两个/m,值/n,的/u,索引/n,和/c,值/n,分别/d,构成/v,了/u,数/m,组/q,[/w,0/m,，/w,2/m,]/w,和/c,数/m,组/q,[/w,1.0/m,，/w,3.0/m,]/w,。/w,有关/vn,向量/n,的/u,类/q,如/v,图/n,所/u,示/vg,。/w,vector/en,是/v,所有/b,局部/n,向量/n,的/u,基类/nr,，/w,dense/en,-/w,vector/en,和/c,sparsevector/en,都/d,是/v,vector/en,的/u,具体/a,实现/v,。/w,spark/en,官方/n,推荐/v,使用/v,vectors/en,中/f,实现/v,的/u,工厂/n,方法/n,创建/v,局部/n,向量/n,，/w,就/d,像/v,下面/f,这样/r,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,{/w,vector/en,,/w, ,vectors/en,}/w, ,//w,//w,创建/v,密集/a,向量/n,(/w,1.0/m,,/w, ,0.0/m,,/w, ,3.0/m,)/w, ,val/en, ,dv/en,:/w, ,vector/en, ,=/w, ,vectors/en,./w,dense/en,(/w,1.0/m,,/w, ,0.0/m,,/w, ,3.0/m,)/w, ,//w,//w,给/p,向/p,量/n,(/w,1.0/m,,/w, ,0.0/m,,/w, ,3.0/m,)/w,创建/v,疏向量/nw, ,val/en, ,svl/en,:/w, ,vector/en,=/w, ,vectors/en,./w,sparse/en,(/w,3/m,,/w, ,array/en,(/w,0/m,,/w, ,2/m,)/w,,/w, ,array/en,(/w,1.0/m,,/w, ,3.0/m,)/w,)/w, ,//w,//w,通过/p,指定/v,非/h,0/m,的/u,项目/n,，/w,创建/v,稀疏/a,向/p,量/n,(/w,1.0/m,,/w, ,0.0/m,,/w, ,3.0/m,)/w, ,val/en, ,sv/en,2/m,:/w, ,vector/en, ,=/w, ,vectors/en,./w,sparse/en,(/w,3/m,,/w, ,seq/en,(/w,(/w,0/m,,/w, ,1.0/m,)/w,,/w, ,(/w,2/m,,/w, ,3.0/m,)/w,)/w,)/w,注意/v,:/w, ,scala/en,默认/v,会/v,导入/v,scala/en,./w,collection/en,./w,immutable/en,./w,vector/en,，/w,所以/c,必须/d,显式/nw,导入/v,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vector/en,才/d,能/v,使用/v,mllib/en,才/d,能/v,使用/v,mllib/en,提供/v,的/u,vector/en,。/w,上面/f,例子/n,中/f,以/p,数/m,组/q,为/p,参数/n,，/w,调用/v,vectors/en,的/u,sparse/en,接口/n,，/w,见/v,如下/v,代码/n,。/w,使用/v,seq/en,创建/v,稀疏/a,向/p,量/n,，/w,其/r,本质/n,依然/d,是/v,使用/v,数/m,组/q,，/w,见/v,如下/v,代码/n,。/w,3.2/m, ,标记/n,点标/nw,记点/nw,是/v,将/d,密集/a,向量/n,或者/c,稀疏/a,向/p,量/n,与/p,应答/v,标签/n,相/d,关联/vn,。/w,在/p,mllib/en,中/f,，/w,标记点/nw,用于/v,监督/vn,学习/v,算法/n,。/w,mllib/en,使用/v,double/en,类型/n,存储/vn,标签/n,，/w,所以/c,我们/r,能/v,在/p,回归/v,和/c,分类/vn,中/f,使用/v,标记点/nw,。/w,如果/c,只/d,有/v,两种/mq,分类/vn,，/w,可以/v,使用/v,二分法/n,，/w,一个/m,标签/n,要么/c,是/v,1.0/m,，/w,要么/c,是/v,0.0/m,。/w,如果/c,有/v,很多/m,分类/vn,，/w,标签/n,应该/v,从/p,零/m,开始/v,：/w,0/m,、/w,1/m,、/w,2/m,./w,./w,./w,./w,标记点/nw,由/p,样例/nw,类/q,labeledpoint/en,来/v,表示/v,，/w,其/r,使用/v,方式/n,如下/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,regression/en,./w,labeledpoint/en, ,//w,//w,使用/v,标签/n,1.0/m,和/c,一个/m,密集/a,向量/n,创建/v,一个/m,标记点/nw, ,val/en, ,pos/en, ,=/w, ,labeledpoint/en,(/w,1.0/m,,/w, ,vectors/en,./w,dense/en,(/w,1.0/m,,/w, ,0.0/m,,/w, ,3.0/m,)/w,)/w, ,//w,//w,使用/v,标签/n,0.0/m,和/c,一个/m,疏向量/nw,创建/v,一个/m,标记点/nw, ,val/en, ,neg/en, ,=/w, ,labeledpoint/en,(/w,0.0/m,,/w, ,vectors/en,./w,sparse/en,(/w,3/m,,/w, ,array/en,(/w,0/m,,/w, ,2/m,)/w,,/w, ,array/en,(/w,1.0/m,,/w, ,3.0/m,)/w,)/w,)/w,用/p,稀疏/a,的/u,训练/vn,数据/n,做/v,练习/v,是/v,很/d,常见/a,的/u,，/w,好在/d,mllib/en,支持/v,读/v,取/v,存储/vn,在/p,libsvm/en,格式/n,中/f,的/u,训练/vn,例子/n,。/w,libsvm/en,格式/n,是/v,一种/mq,每/r,一行/n,表示/v,一个/m,标签/n,稀疏/a,特征/n,向量/n,的/u,文本/n,格式/n,，/w,其/r,格式/n,如下/v,：/w,label/en, ,index/en,1/m,:/w,value/en,1/m, ,index/en,2/m,:/w,value/en,2/m, ,./w,./w,./w,libsvm/en,是/v,林智仁/nr,教授/n,等/u,开发/v,设计/vn,的/u,一个/m,简单/a,、/w,易/a,用/p,和/c,快速/d,有效/a,的/u,svm/en,模式/n,识别/v,与/p,回归/v,的/u,软件包/n,。/w,mllib/en,已经/d,提供/v,了/u,mlutils/en,./w,loadlibsvmfile/en,方法/n,读取/v,存储/vn,在/p,libsvm/en,格式/n,文本/n,文件/n,中/f,的/u,训练/vn,数据/n,，/w,见/v,如下/v,代码/n,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,labeledpoint/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,util/en,./w,mlutils/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,rdd/en,./w,rdd/en, ,val/en, ,examples/en,:/w, ,rdd/en,[/w,labeledpoint/en,]/w, ,=/w, ,mlutils/en,./w,loadlibsvmfile/en,(/w,sc/en,,/w, ,"/w,data/en,//w,mllib/en,//w,sample/en,_,libsvm/en,_,data/en,./w,txt/en,"/w,)/w,3.3/m, ,局部/n,矩阵/n,mllib/en,支持/v,数据/n,存储/vn,在/p,单个/b,double/en,类型/n,数/m,组/q,的/u,密矩阵/nw,。/w,先/d,来/v,看/v,这样/r,一个/m,矩阵/n,：/w,这个/r,矩阵/n,是/v,如何/r,存储/vn,的/u,？/w,它/r,只是/d,存储/vn,到/v,一/m,维数/nr,组/q,[/w,1.0/m,,/w, ,3.0/m,,/w, ,5.0/m,,/w, ,2.0/m,,/w, ,4.0/m,,/w, ,6.0/m,]/w,，/w,这个/r,矩阵/n,的/u,尺寸/n,是/v,3/m,*/w,2/m,，/w,即/v,3行/mq,2列/mq,。/w,有关/vn,局部/n,矩阵/n,的/u,类/q,如下/v,图/n,所/u,示/vg,。/w,局部/n,矩阵/n,的/u,基类/nr,是/v,matrix/en,，/w,目前/t,有/v,一个/m,实现/v,类/q,densematrix/en,。/w,spark/en,官方/n,推荐/v,使用/v,matrices/en,中/f,实现/v,的/u,工厂/n,方法/n,创建/v,局部/n,矩阵/n,，/w,例如/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,{/w,matrix/en,,/w, ,matrices/en,}/w, ,//w,//w,创建/v,密矩阵/nw,（/w,（/w,1.0/m,，/w,2.0/m,）/w,，/w,（/w,3.0/m,,/w, ,4.0/m,）/w,，/w,（/w,5.0/m,,/w, ,6.0/m,）/w,）/w, ,val/en, ,dm/en,:/w, ,matrix/en, ,=/w, ,matrices/en,./w,dense/en,(/w,3/m,,/w, ,2/m,,/w, ,array/en,(/w,1.0/m,,/w, ,3.0/m,,/w, ,5.0/m,,/w, ,2.0/m,,/w, ,4.0/m,,/w, ,6.0/m,)/w,)/w,3.4/m, ,分布式/b,矩阵/n,分布式/b,矩阵/n,分布式/b,地/u,存储/vn,在/p,一个/m,或者/c,多/a,个/q,rdd/en,中/f,。/w,如何/r,存储/vn,数据量/n,很/d,大/a,的/u,分布式/b,矩阵/n,？/w,最/d,重要/a,的/u,在于/v,选择/v,一个/m,正确/a,的/u,格式/n,。/w,如果/c,将/d,分布式/b,矩阵/n,转换/v,为/p,不同/a,格式/n,，/w,可能/v,需要/v,全局/n,的/u,shuffle/en,，/w,成本/n,非常/d,昂贵/a,。/w,有关/vn,分布式/b,矩阵/n,的/u,类/q,如/v,图/n,所/u,示/vg,：/w,迄今为止/l,，/w,mllib/en,已经/d,实现/v,了/u,4种/mq,类型/n,的/u,分布式/b,矩阵/n,：/w,rowmatrix/en,：/w,最/d,基本/a,的/u,分布式/b,矩阵/n,类型/n,，/w,是/v,面向/v,行且/nw,行/v,索引/n,无/v,意义/n,的/u,分布式/b,矩阵/n,。/w,rowmatrix/en,的/u,行/v,实际/n,是/v,多/a,个/q,局部/n,向量/n,的/u,rdd/en,，/w,列/v,受限/v,于/p,integer/en,的/u,范围/n,大小/n,。/w,rowmatrix/en,适用/v,于/p,列数/nw,不大/d,以便/d,单个/b,局部/n,向量/n,可以/v,合理/a,地/u,传递/v,给/p,driver/en,，/w,也/d,能/v,在/p,单个/b,节点/n,上/f,存储/vn,和/c,操作/v,的/u,情况/n,。/w,下面/f,展示/v,了/u,可以/v,使用/v,rdd/en,[/w,vector/en,]/w,实例/n,来/v,构建/v,rowmatrix/en,的/u,例子/n,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vector/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,distributed/en,./w,rowmatrix/en, ,val/en, ,rows/en,:/w, ,rdd/en,[/w,vector/en,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,mat/en,:/w, ,rowmatrix/en, ,=/w, ,new/en, ,rowmatrix/en,(/w,rows/en,)/w, ,val/en, ,m/en, ,=/w, ,mat/en,./w,numrows/en,(/w,)/w, ,val/en, ,n/en, ,=/w, ,mat/en,./w,numcols/en,(/w,)/w,indexedrowmatrix/en,：/w,与/p,rowmatrix/en,类似/v,，/w,但/c,却/d,面向/v,索引/n,的/u,分布式/b,矩阵/n,。/w,indexedrowmatrix/en,常/d,用于/v,识别行/nw,或者/c,用于/v,执行/v,连接/v,操作/v,。/w,可以/v,使用/v,rdd/en,[/w,indexedrow/en,]/w,实例/n,创建/v,indexedrowmatrix/en,。/w,indexedrow/en,的/u,实现/v,如下/v,：/w,@/w,experimental/en, ,case/en, ,class/en, ,indexedrow/en,(/w,index/en,:/w, ,long/en,,/w, ,vector/en,:/w, ,vector/en,)/w,通过/p,删除/v,indexedrowmatrix/en,的/u,行/v,索引/n,，/w,可以/v,将/d,indexedrowmatrix/en,转换/v,为/p,rowmatrix/en,。/w,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,indexedrowmatrix/en,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,distributed/en,./w,{/w,indexedrow/en,,/w, ,indexedrowmatrix/en,,/w, ,rowentry/en,}/w, ,val/en, ,rows/en,:/w, ,rdd/en,[/w,indexedrow/en,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,mat/en,:/w, ,indexedrowmatrix/en, ,=/w, ,new/en, ,indexedrowmatrix/en,(/w,rows/en,)/w, ,val/en, ,m/en, ,=/w, ,mat/en,./w,numrows/en,(/w,)/w, ,val/en, ,n/en, ,=/w, ,mat/en,./w,numcols/en,(/w,)/w, ,val/en, ,rowmat/en,:/w, ,rowmatrix/en, ,=/w, ,mat/en,./w,torowmatrix/en,(/w,)/w,coordinatematrix/en,：/w,使用/v,坐标/n,列/v,表/n,(/w,coo/en,)/w,格式/n,存储/vn,的/u,分布式/b,矩阵/n,。/w,支持/v,coordinatematrix/en,的/u,rdd/en,实际/n,是/v,（/w,i/en,:/w, ,long/en,，/w,j/en,:/w, ,long/en,,/w, ,value/en,:/w, ,double/en,）/w,这样/r,的/u,三元组/nz,，/w,i/en,是/v,行/v,索引/n,，/w,j/en,是/v,列/v,索引/n,，/w,value/en,是/v,实际/n,存储/vn,的/u,值/n,。/w,coordinatematrix/en,适用/v,于/p,行/v,和/c,列/v,都/d,很/d,大/a,且/c,矩阵/n,很/d,稀疏/a,的/u,情况/n,。/w,可以/v,使用/v,rdd/en,[/w,matrixentry/en,]/w,实例/n,创建/v,coordinatematrix/en,。/w,matrixentry/en,的/u,实现/v,如下/v,。/w,@/w,experimental/en, ,case/en, ,class/en, ,matrixentry/en,(/w,i/en,:/w, ,long/en,,/w, ,j/en,:/w, ,long/en,,/w, ,value/en,:/w, ,double/en,)/w,通过/p,调用/v,coordinatematrix/en,的/u,toindexedrowmatrix/en,方法/n,，/w,可以/v,将/d,coordinatematrix/en,转换/v,为/p,indexedrowmatrix/en,。/w,下面/f,的/u,例子/n,演示/vn,了/u,coordinatematrix/en,的/u,使用/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,distributed/en,./w,{/w,coordinatematrix/en,,/w, ,matrixentry/en,}/w, ,val/en, ,entries/en,:/w, ,rdd/en,[/w,matrientry/en,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,mat/en,:/w, ,coordinatematrix/en, ,=/w, ,new/en, ,coordinatematrix/en,(/w,entries/en,)/w, ,val/en, ,m/en, ,=/w, ,mat/en,./w,numrows/en,(/w,)/w, ,val/en, ,n/en, ,=/w, ,mat/en,./w,numcols/en,(/w,)/w, ,val/en, ,indexedrowmatrix/en, ,=/w, ,mat/en,./w,toindexedrowmatrix/en,(/w,)/w,blockmatrix/en,：/w,由/p,rdd/en,[/w,matrixblock/en,]/w,支持/v,的/u,分布式/b,矩阵/n,。/w,matrixblock/en,实际/n,是/v,(/w,(/w,int/en,,/w, ,int/en,)/w,,/w, ,matrix/en,)/w,这样/r,的/u,二元组/nw,，/w,(/w,int/en,,/w, ,int/en,)/w,是/v,block/en,的/u,索引/n,，/w,matrix/en,是/v,记录/v,块/q,大小/n,的/u,子/ng,矩阵/n,。/w,blockmatrix/en,支持/v,与/p,其他/r,blockmatrix/en,的/u,add/en,和/c,multiply/en,，/w,还/d,提供/v,validate/en,方法/n,用于/v,校验/v,当前/t,blockmatrix/en,是否/v,恰当/a,构建/v,。/w,通过/p,调用/v,indexedrowrowmatrix/en,或者/c,coordinatematrix/en,的/u,toblockmatrix/en,方法/n,，/w,可以/v,方便/a,转换/v,为/p,blockmatrix/en,。/w,toblockmatrix/en,方法/n,创建/v,的/u,block/en,的/u,默认/v,大小/n,是/v,1024/m, ,x/en, ,1024/m,。/w,可以/v,使用/v,toblockmatrix/en,(/w,rowsperblock/en,，/w,colsperblock/en,)/w,方法/n,改变/v,block/en,的/u,大小/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,blockmatrix/en,的/u,使用/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,distributed/en,./w,{/w,blockmatrix/en,,/w, ,coordinatematrix/en,,/w, ,matrixentry/en,}/w, ,val/en, ,entries/en,:/w, ,rdd/en,[/w,matrixentry/en,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,coordmat/en,:/w, ,coordinatematrix/en, ,=/w, ,new/en, ,coordinatematrix/en,(/w,entries/en,)/w, ,val/en, ,mata/en,:/w, ,blockmatrix/en, ,=/w, ,coordmat/en,./w,toblockmatrix/en,(/w,)/w,./w,cache/en,(/w,)/w, ,mata/en,./w,validate/en,(/w,)/w, ,val/en, ,ata/en, ,=/w, ,mata/en,./w,transpose/en,./w,multiply/en,(/w,mata/en,)/w,注意/v,：/w,由于/c,mllib/en,会/v,缓/v,存/v,矩阵/n,的/u,大小/n,，/w,所以/c,支持/v,分布式/b,矩阵/n,的/u,rdd/en,必须/d,要/v,有/v,明确/ad,的/u,类型/n,，/w,否则/c,会/v,导致/v,出错/v,。/w,4/m,./w, ,基础/n,统计/v,mllib/en,提供/v,了/u,很多/m,统计/v,方法/n,，/w,包括/v,摘要/n,统计/v,、/w,相关/v,统计/v,、/w,分层/v,抽样/vn,、/w,假设/v,校验/v,、/w,随机/d,数/m,生成/vn,等/u,。/w,这些/r,都/d,涉及/v,统计学/n,、/w,概率/n,论/v,的/u,专业/n,知识/n,。/w,4.1/m, ,摘要/n,统计/v,调用/v,statistics/en,类/q,的/u,colstats/en,方法/n,，/w,可以/v,获得/v,rdd/en,[/w,vector/en,]/w,的/u,列/v,的/u,摘要/n,统计/v,。/w,colstats/en,方法/n,返回/v,了/u,multivariatestatisticalsummary/en,对象/n,，/w,multivariatestatisticalsummary/en,对象/n,包含/v,了/u,列/v,的/u,最大值/nz,、/w,最小值/nz,、/w,平均值/n,、/w,方差/nr,、/w,非零元素/nw,的/u,数量/n,以及/c,总数/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,colstats/en,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vector/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,stat/en,./w,{/w,multivariatestatisticalsummary/en,,/w, ,statistics/en,}/w, ,val/en, ,observations/en,:/w, ,rdd/en,[/w,vector/en,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,summary/en,:/w, ,multivariatestatisticalsummary/en, ,=/w, ,statistics/en,./w,colstats/en,(/w,observations/en,)/w, ,println/en,(/w,summary/en,./w,mean/en,)/w, ,//w,//w,每个/r,列值/nr,组成/v,的/u,密集/a,向量/n, ,println/en,(/w,summary/en,./w,variance/en,)/w, ,//w,//w,列/v,向/p,量方/nw,差/a, ,println/en,(/w,summary/en,./w,numnonzeros/en,)/w, ,//w,//w,每个/r,列/v,的/u,非/h,零值/nw,个数/n,colstats/en,实际/n,使用/v,了/u,rowmatrix/en,的/u,computecolumnsummarystatistics/en,方法/n,，/w,见/v,代码/n,如下/v,：/w,4.2/m, ,相关/v,统计/v,计算/v,两个/m,序列/n,之间/f,的/u,相关性/n,是/v,统计/v,中/f,通用/vn,的/u,操作/v,。/w,mllib/en,提供/v,了/u,计算/v,多/a,个/q,序列/n,之间/f,相关/v,统计/v,的/u,灵活性/n,。/w,目前/t,支持/v,的/u,关联/vn,方法/n,运用/v,了/u,皮尔森/nr,相关/v,系数/n,(/w,pearson/en, ,correlation/en, ,coefficient/en,)/w,和/c,斯皮尔森/nrf,相关/v,系统/n,(/w,spearman/en,'/w,s/en, ,rank/en, ,correlation/en, ,coefficient/en,)/w,。/w,1/m,./w, ,皮尔森/nr,相关/v,系数/n,皮尔森相/nrf,关系/n,数/m,也/d,称为/v,皮尔森/nr,积矩/nw,相关/v,系数/n,(/w,pearson/en, ,product/en,-/w,moment/en, ,correlation/en, ,coefficient/en,)/w,，/w,是/v,一种/mq,线性/n,相/d,关系/n,数/m,。/w,皮尔森/nr,相关/v,系数/n,是/v,用/p,来/v,反映/v,两个/m,变量线性/nw,相关/v,程度/n,的/u,统计量/nw,。/w,相关/v,系数/n,用/p,r/en,表示/v,，/w,其中/r,n/en,为/p,样本量/n,，/w,xi/en,，/w,yi/en,，/w,sx/en,，/w,sy/en, ,分别/d,为/p,两个/m,变量/n,的/u,观测值/nw,和/c,均值/n,。/w,r/en,描述/v,的/u,是/v,两个/m,变量/n,间/f,线性/n,相关/v,强弱/n,的/u,程度/n,。/w,r/en,的/u,取值/v,在/p,-/w,1/m,与/p,+/w,1/m,之间/f,，/w,若/c,r/en,>,0/m,，/w,表明/v,两个/m,变量/n,是/v,正/d,相关/v,，/w,即/v,一个/m,变量/n,的/u,值/n,越/d,大/a,，/w,另/r,一个/m,变量/n,的/u,值/n,也/d,会/v,越/d,大/a,；/w,若/c,r/en,</w,0/m,，/w,表明/v,两个/m,变量/n,是/v,负相关/nz,，/w,即/v,一个/m,变量/n,的/u,值/n,越/d,大/a,另/r,一个/m,变量/n,的/u,值/n,反而/d,会/v,越/d,小/a,。/w,r/en,的/u,绝对值/n,越/d,大/a,表明/v,相关性/n,越/d,强/a,，/w,要/v,注意/v,的/u,是/v,这里/r,并/c,不/d,存在/v,因果/n,关系/n,。/w,若/c,r/en,=/w,0/m,，/w,表明/v,两个/m,变量/n,间/f,不/d,是/v,线性/n,相关/v,，/w,但/c,有/v,可能/v,是/v,其他/r,方式/n,的/u,相关/v,(/w,比如/v,曲线/n,方式/n,)/w,。/w,2/m,./w, ,斯皮尔森/nrf,秩/ng,相关/v,系数/n,斯皮尔森秩/nw,相/d,关系/n,数/m,也/d,称为/v,spearman/en,的/u,p/en,，/w,是/v,由/p,charles/en, ,spearman/en,命名/v,的/u,，/w,一般/a,用/p,希腊/ns,字母/n,ps/en,(/w,rho/en,)/w,或/c,rs/en,表示/v,。/w,spearman/en,秩/ng,相关/v,系数/n,是/v,一种/mq,无/v,参数/n,(/w,与/p,分布/v,无关/v,)/w,的/u,校验/v,方法/n,，/w,用于/v,度量/v,变量/n,之间/f,联系/v,的/u,强弱/n,。/w,在/p,没有/v,重复/v,数据/n,的/u,情况/n,下/f,，/w,如果/c,一个/m,变量/n,是/v,另外/c,一个/m,变量/n,的/u,严格/ad,单调/a,函数/n,，/w,则/d,spearman/en,秩/ng,相关/v,系数/n,就/d,是/v,+/w,1/m,或/c,-/w,1/m,，/w,称/v,变量/n,完全/ad,spearman/en,秩/ng,相关/v,。/w,注意/v,和/c,pearson/en,完全/ad,相关/v,的/u,区别/n,，/w,只有/c,当/p,两/m,变/v,量/n,存在线性/nw,关系/n,时/ng,，/w,pearson/en,相关/v,系数/n,才/d,为/p,+/w,1/m,或/c,-/w,1/m,。/w,spearman/en,秩/ng,相关/v,系数/n,为/p,：/w,statistics/en,提供/v,了/u,计算/v,序列/n,之间/f,相关性/n,的/u,方法/n,，/w,默认/v,情况/n,下/f,使用/v,皮尔森相/nrf,关系/n,数/m,，/w,使用/v,方法/n,如下/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,_, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,stat/en,./w,statistics/en, ,val/en, ,sc/en,:/w, ,sparkcontext/en, ,=/w, ,./w,./w,./w, ,val/en, ,seriesx/en,:/w, ,rdd/en,[/w,double/en,]/w, ,=/w, ,./w,./w,./w, ,//w,//w,a/en, ,series/en, ,val/en, ,seriesy/en,:/w, ,rdd/en,[/w,double/en,]/w, ,=/w, ,./w,./w,./w, ,//w,//w,和/c,seriesx/en,必须/d,有/v,相同/a,的/u,分区/vn,和/c,基数/n, ,val/en, ,correlation/en,：/w,double/en, ,=/w, ,statistics/en,./w,corr/en,(/w,seriesx/en,,/w, ,seriesy/en,,/w, ,"/w,pearson/en,"/w,)/w, ,val/en, ,data/en,:/w, ,rdd/en,[/w,vector/en,]/w, ,=/w, ,./w,./w,./w, ,//w,//w,每个/r,向量/n,必须/d,是/v,行/v,，/w,不能/v,是/v,列/v, ,val/en, ,correlmatrix/en,:/w, ,matrix/en, ,=/w, ,statistics/en,./w,corr/en,(/w,data/en,,/w, ,"/w,pearson/en,"/w,)/w,statistics/en,中/f,相关性/n,的/u,实现/v,，/w,见/v,代码/n,如下/v,：/w,其/r,实质/n,是/v,代理/vn,了/u,correlations/en,，/w,correlations/en,中/f,相关性/n,的/u,实现/v,见/v,代码/n,如下/v,：/w,4.3/m, ,分层/v,抽样/vn,分层/v,抽样/vn,(/w,stratified/en, ,sampling/en,)/w,是/v,先/d,将/d,总体/n,按/p,某种/r,特征/n,分为/v,若干/m,次级/n,(/w,层/q,)/w,，/w,然后/c,再/d,从/p,每/r,一层/mq,内/f,进行/v,独立/v,取样/vn,，/w,组成/v,一个/m,样本/n,的/u,统计学/n,计算/v,方法/n,。/w,为了/p,对/p,分层/v,抽样/vn,有/v,更/d,直观/a,的/u,感受/v,，/w,请/v,看/v,下面/f,的/u,例子/n,：/w,某市/r,现有/v,机动车/n,共/d,1万辆/mq,，/w,其中/r,大巴车/n,500辆/mq,，/w,小轿车/n,6000辆/mq,，/w,中拔/nw,车/n,1000辆/mq,，/w,越野车/n,2000辆/mq,，/w,工程车/nw,500辆/mq,。/w,现在/t,要/v,了解/v,这些/r,车辆/n,的/u,使用/v,年限/n,，/w,决定/v,采用/v,分层/v,抽样/vn,方式/n,抽取/vn,100个/m,样本/n,。/w,按照/p,车辆/n,占/v,比/p,，/w,各类/r,车辆/n,的/u,抽样/vn,数量/n,分别/d,为/p,5/m,,/w,60/m,,/w,10/m,,/w,20/m,,/w,5/m,./w,摘要/n,统计/v,和/c,相关/v,统计/v,都/d,集成/vn,statistics/en,中/f,，/w,而/c,分层/v,抽样/vn,只/d,需要/v,调用/v,rdd/en,[/w,(/w,k/en,,/w,v/en,)/w,]/w,的/u,samplebykey/en,和/c,samplebykeyexact/en,即可/v,。/w,为了/p,分层/v,抽样/vn,，/w,其中/r,的/u,键/nr,可以/v,被/p,认为/v,是/v,标签/n,，/w,值/n,是/v,具体/a,的/u,属性/n,。/w,samplebykey/en,方法/n,采用/v,掷/v,硬币/n,的/u,方式/n,来/v,决定/v,是否/v,将/d,一个/m,观测值/nw,作为/v,采样/v,，/w,因此/c,需要/v,一个/m,预期/vn,大小/n,的/u,样本/n,数据/n,。/w,samplebykeyexact/en,则/d,需要/v,更/d,多/a,更/d,有效/a,的/u,资源/n,，/w,但是/c,样本/n,数据/n,的/u,大小/n,是/v,确定/v,的/u,。/w,samplebykeyexact/en,方法/n,允许/v,用户/n,采用/v,符合/v,[/w,fk/en, ,*/w, ,nk/en,]/w, ,v/en, ,k/en, ,∈, ,k/en,，/w,其中/r,fk/en,是/v,键/nr,k/en,的/u,函数/n,，/w,nk/en,是/v,rdd/en,[/w,(/w,k/en,,/w,v/en,)/w,]/w,中/f,键为/nr,k/en,的/u,(/w,k/en,,/w,v/en,)/w,对/p,，/w,k/en,是/v,键/nr,的/u,集合/v,。/w,下例/nw,演示/vn,了/u,如何/r,使用/v,分层/v,抽样/vn,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,rdd/en,./w,pairrddfunctions/en, ,val/en, ,sc/en,:/w, ,sparkcontext/en, ,=/w, ,./w,./w,./w, ,val/en, ,data/en, ,=/w, ,./w,./w,./w, ,//w,//w,an/en, ,rdd/en,[/w,(/w,k/en,,/w,v/en,)/w,]/w, ,of/en, ,any/en, ,key/en, ,value/en, ,pairs/en, ,val/en, ,fractions/en,:/w, ,map/en,[/w,k/en,./w, ,double/en,]/w, ,=/w, ,./w,./w,./w, ,//w,//w,specify/en, ,the/en, ,exact/en, ,fraction/en, ,desired/en, ,from/en, ,each/en, ,key/en, ,val/en, ,exactsample/en, ,=/w, ,data/en,./w,samplebykeyexact/en,(/w,withreplacement/en, ,=/w, ,false/en,,/w, ,fractions/en,)/w,4.4/m, ,假设/v,校验/v,假设/v,校验/v,(/w,hypothesis/en, ,testing/en,)/w, ,是/v,数理统计学/nw,中/f,根据/p,一定/d,假设/v,条件/n,由/p,样本/n,推断/vn,总体/n,的/u,一种/mq,方法/n,。/w,如果/c,对/p,总体/n,的/u,某种/r,假设/v,是/v,真实/a,的/u,，/w,那么/r,不/d,利于/v,或/c,不/d,能/v,支持/v,这/r,一/m,假设/v,的/u,事件/n,a/en,(/w,小/a,概率/n,事件/n,)/w,在/p,一次/mq,试验/vn,中/f,几乎/d,不/d,可能/v,发生/v,；/w,要是/c,在/p,一次/mq,试验/vn,中/f,a/en,竟然/d,发生/v,了/u,，/w,就/d,有/v,理由/n,怀疑/v,该/r,假设/v,的/u,真实性/n,，/w,拒绝/v,这/r,一/m,假设/v,。/w,小/a,概率/n,原理/n,可以/v,用/p,图/n,表示/v,。/w,h/en,0/m,表示/v,原/b,假设/v,，/w,h/en,1/m,表示/v,备选/nz,假设/v,。/w,常见/a,的/u,假设/v,校验/v,有/v,如下/v,几/m,种/q,：/w,双边/n,校验/v,：/w,h/en,0/m,:/w,u/en, ,=/w, ,u/en,0/m,，/w,h/en,1/m,:/w,u/en,=/w,//w,u/en,0/m,右侧/f,单边/d,校验/v,：/w,h/en,0/m,:/w,u/en,</w,=/w,u/en,0/m,，/w,h/en,1/m,:/w,u/en,>,u/en,0/m,左侧/f,单边/d,校验/v,：/w,h/en,0/m,:/w,u/en,>,=/w,u/en,0/m,,/w,h/en,1/m,:/w,u/en,</w,u/en,0/m,假设/v,校验/v,是/v,一个/m,强大/a,的/u,工具/n,，/w,无论/c,结果/n,是否/v,偶然/a,的/u,，/w,都/d,可以/v,决定/v,结果/n,是否/v,具有/v,统计/v,特征/n,。/w,mllib/en,目前/t,支持/v,皮尔森卡方/nw,测试/vn,。/w,输入/v,数据/n,的/u,类型/n,决定/v,了/u,是/v,做/v,卡方/nr,适合/v,度/q,检测/vn,还是/c,独立性/n,检测/vn,。/w,卡方/nr,适合/v,度/q,检测/vn,的/u,输入/v,数据/n,类型/n,应当/v,是/v,向量/n,，/w,而/c,卡方/nr,独立性/n,检测/vn,需要/v,的/u,数据/n,类型/n,是/v,矩阵/n,。/w,rdd/en,[/w,labeledpoint/en,]/w,可以/v,作为/v,卡方/nr,检测/vn,的/u,输入/v,类型/n,。/w,下列/b,演示/vn,了/u,如何/r,使用/v,假设/v,校验/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,_, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,labeledpoint/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,stat/en,./w,statistics/en,./w,_, ,val/en, ,sc/en,:/w, ,sparkcontext/en, ,=/w, ,./w,./w,./w, ,val/en, ,vec/en,:/w, ,vector/en, ,=/w, ,./w,./w,./w, ,//w,//w,事件/n,的/u,频率/n,组成/v,的/u,vector/en, ,val/en, ,goodnessoffittestresult/en, ,=/w, ,statistics/en,./w,chisqtest/en,(/w,vec/en,)/w, ,println/en,(/w,goodnessoffittestresult/en,)/w, ,val/en, ,mat/en,:/w, ,matrix/en, ,=/w, ,./w,./w,./w, ,//w,//w,偶然性/n,matrix/en, ,val/en, ,independencetestresult/en, ,=/w, ,statistics/en,./w,chisqtest/en,(/w,mat/en,)/w, ,println/en,(/w,independencetestresult/en,)/w, ,val/en, ,obs/en,:/w,rdd/en,[/w,labeledpoint/en,]/w, ,=/w, ,./w,./w,./w, ,//w,//w,(/w,feature/en,,/w, ,label/en,)/w, ,pairs/en, ,val/en, ,featuretestresults/en,:/w, ,arra/en,[/w,chisqtestresult/en,]/w, ,=/w, ,statistics/en,./w,chisqtest/en,(/w,obs/en,)/w, ,var/en, ,i/en, ,=/w, ,1/m, ,featuretestresults/en,./w,foreach/en,{/w, ,result/en, ,=/w,>, ,println/en,(/w,s/en,"/w,column/en, ,$/w,i/en,:/w,\/w,n/en, ,result/en,"/w,)/w, ,i/en, ,+/w,=/w, ,1/m, ,}/w, ,//w,//w,summary/en, ,of/en, ,the/en, ,test/en,4.5/m, ,随机/d,数/m,生成/vn,随机/d,数/m,可以/v,看做/v,随机/d,变量/n,，/w,什么/r,是/v,随机/d,变量/n,？/w,将/d,一枚/mq,质地/n,均匀/ad,的/u,硬币/n,抛/v,掷/v,3次/mq,，/w,记录/v,它/r,的/u,结果/n,，/w,有/v,：/w,其中/r,u/en,代表/n,正面/d,朝/p,上/f,，/w,d/en,代表/n,反面/n,朝/p,上/f,，/w,整个/b,集/vg,合Ω/nw,是/v,抛掷/v,3次/mq,硬币/n,的/u,样本/n,空间/n,。/w,正面/d,朝/p,上/f,的/u,次数/n,可能/v,是/v,0/m,，/w,1/m,，/w,2/m,，/w,3/m,。/w,由于/c,样本/n,空间/n,Ω,中/f,的/u,结果/n,都/d,是/v,随机/d,发生/v,的/u,，/w,所以/c,出现/v,正面/d,的/u,次数/n,x/en,是/v,随机/d,的/u,，/w,x/en,即/v,为/p,随机/d,变量/n,。/w,如果/c,抛/v,掷/v,硬币/n,，/w,直到/v,出现/v,正面/d,的/u,抛/v,掷/v,次数/n,为/p,y/en,，/w,那么/r,y/en,的/u,取值/v,可能/v,是/v,0/m,，/w,1/m,，/w,2/m,，/w,3/m,./w,./w,./w,。/w,如果/c,随机/d,变量/n,的/u,取值/v,是/v,有限/a,的/u,(/w,比如/v,x/en,)/w,或者/c,是/v,可列/nrf,的/u,(/w,比如/v,y/en,)/w,，/w,那么/r,就/d,称为/v,离散/vn,随机/d,变量/n,。/w,刚才/t,说/v,的/u,抛掷/v,3次/mq,硬币/n,的/u,情况/n,下/f,，/w,使用/v,p/en,(/w,x/en, ,=/w, ,取值/v,)/w,的/u,方式/n,表达/v,每/r,种/q,取值/v,的/u,概率/n,，/w,我们/r,不难/d,得出/v,：/w,如果/c,样本/n,空间/n,上/f,随机/d,变量/n,的/u,取值/v,用/p,x/en,1/m,，/w,x/en,2/m,，/w,x/en,3/m,，/w,./w,./w,./w,./w,表示/v,，/w,那么/r,存在/v,满足/v,p/en,(/w,x/en,1/m,)/w, ,=/w, ,p/en,(/w,x/en, ,=/w, ,xi/en,)/w,和/c,Σ,ip/en,(/w,xi/en,)/w, ,=/w, ,1/m, ,的/u,函数/n,p/en,。/w,这个/r,函数/n,p/en,称为/v,随机/d,变量/n,x/en,的/u,概率/n,质量/n,函数/n,或者/c,频率/n,函数/n,。/w,如果/c,x/en,取值/v,累积/vn,某个/r,范围/n,的/u,值/n,，/w,那么/r,其/r,累积/vn,分布/v,函数/n,定义/n,如下/v,：/w,累积/vn,分布/v,函数/n,满足/v,：/w,同一/b,样本/n,空间/n,上/f,两个/m,离散/vn,随机/d,变量/n,x/en,和/c,y/en,的/u,可能/v,取值/v,分别/d,为/p,x/en,1/m,，/w,x/en,2/m,，/w,x/en,3/m,，/w,./w,./w,./w,和/c,y/en,1/m,，/w,y/en,2/m,，/w,y/en,3/m,，/w,./w,./w,./w,，/w,如果/c,对/p,所有/b,i/en,和/c,j/en,，/w,满足/v,：/w,则/d,x/en,和/c,y/en,是/v,独立/v,的/u,。/w,将/d,此/r,定义/n,推广/v,到/v,两个/m,以上/f,离散/vn,随机/d,变量/n,的/u,情形/n,，/w,如果/c,对/p,所有/b,i/en,,/w, ,j/en, ,和/c, ,k/en,，/w,满足/v,：/w,则/d,x/en,、/w,y/en,和/c,z/en,是/v,相互/d,独立/v,的/u,。/w,刚才/t,所/u,说/v,的/u,x/en,、/w,y/en,的/u,取值/v,都/d,是/v,离散/vn,的/u,，/w,还有/v,一种/mq,情况/n,下/f,取值/v,是/v,连续/a,的/u,。/w,以/p,人/n,的/u,寿命/n,为/p,例/n,，/w,可以/v,是/v,任意/d,的/u,正/d,实数/n,值/n,。/w,与/p,频率/n,函数/n,相对/d,的/u,是/v,密度/n,函数/n,ƒ,(/w,x/en,)/w,。/w,ƒ,(/w,x/en,)/w,有/v,这些/r,性质/n,：/w,ƒ,(/w,x/en,)/w, ,≥/w, ,0/m,，/w,ƒ,分段/vn,连续/a,且/c,∫∞/nw,-/w,∞/w,ƒ,(/w,x/en,)/w,dx/en, ,=/w, ,1/m,。/w,如果/c,x/en,是/v,具有/v,密度/n,函数/n,ƒ,的/u,随机/d,变量/n,，/w,那么/r,对于/p,任意/d,的/u,a/en, ,</w, ,b/en,，/w,x/en,落/v,在/p,区间/n,(/w,a/en,,/w, ,b/en,)/w,上/f,的/u,概率/n,是/v,密度/n,函数/n,从/p,a/en,到/v,b/en,的/u,下方/f,面积/n,：/w,随机/d,数/m,生成/vn,对于/p,随机/d,算法/n,、/w,随机/d,协议/n,和/c,随机/d,性能/n,测试/vn,都/d,很/d,有用/a,。/w,mllib/en,支持/v,均匀/ad,分布/v,、/w,标准/n,正态分布/n,、/w,泊松/nr,分布/v,等/u,生成/vn,随机/d,rdd/en,。/w,mllib/en,有关/vn,随机数/n,的/u,类/q,如/v,图/n,所/u,示/vg,：/w,以/p,泊松/nr,分布/v,为/p,例/n,，/w,先/d,看看/v,它/r,的/u,数学/n,定义/n,。/w,参数/n,为/p,λ,(/w,λ,>,0/m,)/w,的/u,泊松/nr,频率/n,函数/n,是/v,当/p,λ, ,=/w, ,0.1/m,、/w,1/m,、/w,5/m,、/w,10时/t,的/u,泊松/nr,分布/v,如/v,图/n,所/u,示/vg,：/w,randomrdds/en,提供/v,了/u,工厂/n,方法/n,创建/v,randomrdd/en,和/c,randomvectorrdd/en,。/w,下面/f,的/u,例子/n,中/f,生成/vn,了/u,一个/m,包含/v,100万个/m,double/en,类型/n,随机/d,数/m,的/u,rdd/en,[/w,double/en,]/w,，/w,其值/nw,符合/v,标准/n,正太/nz,分布/v,n/en,(/w,0/m,，/w,1/m,)/w,，/w,分布/v,于/p,10个/m,分区/vn,，/w,然后/c,将/d,其/r,映射/v,到/v,n/en,(/w,1/m,,/w, ,4/m,)/w,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,random/en,./w,randomrdds/en,./w,_, ,val/en, ,sc/en,:/w, ,sparkcontext/en, ,=/w, ,./w,./w,./w, ,val/en, ,u/en, ,=/w, ,normalrdd/en,(/w,sc/en,,/w, ,1000000/m,l/en,,/w, ,10/m,)/w, ,val/en, ,v/en, ,=/w, ,u/en,./w,map/en,(/w,x/en, ,=/w,>, ,1.0/m, ,+/w, ,2.0/m, ,*/w, ,x/en,)/w,5/m,./w, ,分类/vn,和/c,回归/v,mllib/en,支持/v,多种多样/l,的/u,分析/vn,方法/n,，/w,例如/v,，/w,二元/b,分类/vn,、/w,多元/b,分类/vn,和/c,回归/v,。/w,表/n,11/m,-/w,1/m,列出/v,了/u,各类/r,问题/n,的/u,支持/v,算法/n,。/w,5.1/m, ,数学/n,公式/n,许多/m,标准/n,的/u,机器/n,学习/v,方法/n,都/d,可以/v,配制/v,成/v,凸/ag,优化/v,问题/n,，/w,即/v,找到/v,一个/m,极/d,小/a,的/u,凸函/nw,数/m,ƒ,依赖/v,于/p,一个/m,d/en,项/q,的/u,可变/vn,向/p,量/n,w/en,。/w,形式/n,上/f,，/w,我们/r,可以/v,写/v,为/p,优化/v,问题/n,minw/en,ε,r/en, ,d/en,ƒ,(/w,w/en,)/w,，/w,其中/r,所/u,述/vg,目标/n,函数/n,的/u,形式/n,为/p,：/w,这里/r,的/u,向量/n,xi/en, ,ε, ,rd/en, ,是/v,训练/vn,数据/n,，/w,1/m, ,≤/w, ,i/en, ,≤/w, ,n/en, ,并且/c,yi/en, ,ε, , ,rd/en, ,是/v,想/v,要/v,预测/v,数据/n,的/u,相应/v,的/u,标签/n,。/w,如果/c,l/en,(/w,w/en,;/w, ,xi/en,,/w, ,yi/en,)/w,能/v,表示/v,为/p, ,w/en,τ,x/en,和/c,y/en,的/u,函数/n,，/w,我们/r,就/d,说/v,这个/r,方法/n,是/v,线性/n,的/u,。/w,几/m,个/q,mllib/en,的/u,分类/vn,和/c,回归/v,算法/n,都/d,属于/v,这/r,一类/b,，/w,并/c,在/p,这里/r,讨论/v,。/w,目标/n,函数/n,ƒ,有/v,两个/m,部分/n,：/w,控制/v,该/r,模型/n,的/u,复杂/a,的/u,正则化/nw,部分/n,和/c,用于/v,在/p,训练/vn,数据/n,上/f,测量/vn,模型/n,的/u,误差/n,的/u,损失/n,部分/n,。/w,损失/n,函数/n,l/en,(/w,w/en,)/w,是/v,典型/n,的/u,基于/p,w/en,的/u,凸函/nw,数/m,。/w,固定/a,的/u,正则化/nw,参数/n,λ, ,≥/w, ,0/m,定义/n,了/u,最小/a,损失/n,(/w,即/v,训练/vn,误差/n,)/w,和/c,最小化/nw,模型/n,的/u,复杂性/n,(/w,即/v,避免/v,过度/d,拟/v,合/v,)/w,这/r,两个/m,目标/n,之间/f,的/u,权衡/v,。/w,(/w,1/m,)/w, ,损失/n,函数/n,在/p,统计学/n,，/w,统计/v,决策/n,理论/n,和/c,经济学/n,中/f,，/w,损失/n,函数/n,是/v,指/v,一种/mq,将/d,一个/m,事件/n,(/w,在/p,一个/m,样本/n,空间/n,中/f,的/u,一个/m,元素/n,)/w,映射/v,到/v,一个/m,表达/v,与/p,其/r,事件/n,相关/v,的/u,经济/n,成本/n,和/c,机会/n,成本/n,的/u,实数/n,上/f,的/u,一种/mq,函数/n,。/w,通常/d,而言/u,，/w,损失/n,函数/n,由/p,损失/n,项/q,和/c,正/d,则/d,项/q,组成/v,。/w,表/n,11/m,-/w,2/m,列出/v,了/u,常用/a,的/u,损失/n,函数/n,。/w,这里/r,对/p,表/n,11/m,-/w,2/m,中/f,的/u,一些/m,内容/n,做/v,些/q,说明/v,：/w,hinge/en, ,loss/en,：/w,常/d,用于/v,软间隔/nw,支持/v,向/p,量机/nw,的/u,损失/n,函数/n,；/w,logistic/en, ,loss/en,：/w,常/d,用于/v,逻辑/n,回归/v,的/u,损失/n,函数/n,；/w,squared/en, ,loss/en,：/w,常/d,用于/v,最小/a,二/m,乘/v,的/u,损失/n,函数/n,；/w,gradient/en, ,or/en, ,sub/en, ,gradient/en,：/w,梯度/n,与/p,次/q,梯度/n,(/w,2/m,)/w, ,正规化/vn,正规化/vn,的/u,目的/n,是/v,鼓励/v,简单/a,的/u,模型/n,，/w,并/c,避免/v,过度/d,拟合/nz,。/w,mllib/en,支持/v,以下/f,正规化/vn,，/w,如/v,表/n,11/m,-/w,3/m,所示/nz,：/w,这里/r,的/u,sign/en,(/w,w/en,)/w,是/v,由/p,向量/n,w/en,中/f,所有/b,项/q,的/u,符号/n,(/w,±/w,1/m,)/w,组成/v,的/u,向量/n,。/w,平滑度/nw,l/en,2/m,正规化/vn,问题/n,一般/a,比/p,l/en,1/m,正规化/vn,容易/a,解决/v,。/w,然而/c,l/en,1/m,正规化/vn,能/v,帮助/v,促进/v,稀疏权/nw,重/a,，/w,导致/v,更/d,小/a,、/w,更/d,可/v,解释/v,的/u,模型/n,，/w,其中/r,后者/r,于/p,特征/n,选择/v,是/v,有用/a,的/u,。/w,没有/v,任何/r,正规化/vn,，/w,特别/d,是/v,当/p,训练/vn,实例/n,的/u,数目/n,是/v,小/a,的/u,，/w,不/d,建议/n,训练/vn,模型/n,。/w,(/w,3/m,)/w, ,优化/v,线性/n,方法/n,使用/v,凸/ag,优化/v,来/v,优化/v,目标/n,函数/n,。/w,mllib/en,使用/v,两种/mq,方法/n,：/w,新元/nz,和/c,l/en,-/w,bfgs/en,来/v,描述/v,优化/v,部分/n,。/w,目前/t,，/w,大多数/m,算法/n,的/u,api/en,支持/v,随机/d,梯度/n,下降/v,(/w,sgd/en,)/w,，/w,并/c,有/v,一些/m,支持/v,l/en,-/w,bfgs/en,。/w,5.2/m, ,线性/n,回归线性/nw,回归/v,是/v,一类/mq,简单/a,的/u,指导/vn,学习/v,方法/n,。/w,线性/n,回归/v,是/v,预测/v,定量/v,响应/v,变/v,量/n,的/u,有用/a,工具/n,。/w,很多/m,统计/v,学习/v,方法/n,都/d,是/v,从/p,线性/n,回归/v,推广/v,和/c,扩展/v,得到/v,的/u,，/w,所以/c,我们/r,有/v,必要/a,重点/n,理解/v,它/r,。/w,1/m,./w,简单线性/nw,回归/v,简单线性/nw,回归/v,非常/d,简单/a,，/w,只/d,根据/p,单一/a,的/u,预测/v,变量/n,x/en,预测/v,定量/v,响应/v,变量/n,y/en,。/w,它/r,假定/v,x/en,与/p,y/en,之间/f,存在/v,线/n,性关系/n,。/w,其/r,数学/n,关系/n,如下/v,：/w,≈/w,表示/v,近似/a,。/w,这种/r,线性/n,关系/n,可以/v,描述/v,为/p,y/en,对/p,x/en,的/u,回归/v,。/w,β,0/m,和/c,β,1/m,是/v,两个/m,未知/vn,的/u,常量/n,，/w,被/p,称为/v,线性/n,模型/n,的/u,系数/n,，/w,它们/r,分别/d,表示/v,线性/n,模型/n,中/f,的/u,截距/nw,和/c,斜率/n,。/w,β,0/m,和/c,β,1/m,怎么/r,得到/v,呢/y,？/w,通过/p,大量/m,样本/n,数据/n,估算/v,出/v,估计值/nw,。/w,假如/c,样本/n,数据/n,如下/v,：/w,(/w,x/en,1/m,,/w, ,y/en,1/m,)/w,，/w,(/w,x/en,2/m,,/w, ,y/en,2/m,)/w,，/w,./w,./w,./w,./w,，/w,(/w,x/en,3/m,,/w, ,y/en,3/m,)/w,此时/r,问题/n,转换/v,为/p,在/p,坐标/n,中/f,寻找/v,一条/mq,与/p,所有/b,点/q,的/u,距离/n,最/d,大/a,程度/n,接近/v,的/u,直线/n,问题/n,，/w,如/v,-/w,7所/mq,示/vg,使用/v,最小/a,二/m,乘/v,方法/n,最终/d,求得/v,的/u,估计值/nw,(/w,β,’/w,0/m,，/w,β,’/w,1/m,)/w,。/w,实际/n,情况/n,，/w,所有/b,的/u,样本/n,或者/c,真实/a,数据/n,不/d,可能/v,真的/d,都/d,在/p,一条/mq,直线/n,上/f,，/w,每个/r,坐标/n,都/d,会/v,有/v,误差/n,，/w,所以/c,可以/v,表示/v,为/p,如下/v,关系/n,：/w,上式/nw,也/d,称为/v,总体/n,回归/v,直线/n,，/w,是/v,对/p,x/en,和/c,y/en,之间/f,真实/a,关系/n,的/u,最佳/z,线性/n,近似/a,。/w,2/m,./w,多元线性/nw,回归/v,相比/v,简单线性/nw,回归/v,，/w,实践/v,中/f,常常/d,不止/v,一个/m,预测/v,变量/n,，/w,这/r,就/d,要求/v,对/p,简单线性/nw,回归/v,进行/v,扩展/v,。/w,虽然/c,可以/v,给/p,每个/r,预测/v,变量/n,单独/d,建立/v,一个/m,简单线性/nw,回归/v,模型/n,，/w,但/c,无法/v,做出/v,单一/a,的/u,预测/v,。/w,更/d,好/a,的/u,方法/n,是/v,扩展/v,简单线性/nw,回归/v,模型/n,，/w,使/v,它/r,可以/v,直接/ad,包含/v,多/a,个/q,预测/v,变量/n,。/w,一般/a,情况/n,下/f,，/w,假设/v,有/v,p/en,个/q,不同/a,的/u,预测/v,变量/n,，/w,多元线性/nw,回归/v,模型/n,为/p,：/w,其中/r,xj/en,代表/n,第/m,j/en,个/q,预测/v,变量/n,，/w,β,j/en,代表/n,第/m,j/en,个/q,预测/v,变量/n,和/c,响应/v,变量/n,之间/f,的/u,关联/vn,。/w,5.3/m, ,分类/vn,5.2节/mq,的/u,线性/n,回归/v,模型/n,中/f,假设/v,响应/v,变量/n,y/en,是/v,定量/v,的/u,，/w,但/c,很多/m,时候/n,，/w,y/en,却/d,是/v,定性/v,的/u,。/w,比如/v,杯子/n,的/u,材质/n,是/v,定性/v,变量/n,，/w,可以/v,是/v,玻璃/n,、/w,塑料/n,或/c,不锈钢/n,等/u,。/w,定性/v,变量/n,也/d,叫/v,分类/vn,变量/n,。/w,预测/v,定性/v,响应值/nw,是/v,指/v,对/p,观测/vn,分类/vn,。/w,分类/vn,的/u,目标/n,是/v,划分/v,项目/n,分类/vn,。/w,最/d,常见/a,的/u,分类/vn,类型/n,是/v,二元/b,分类/vn,，/w,二元/b,分类/vn,有/v,两种/mq,分类/vn,，/w,通常/d,命名/v,为/p,正/d,和/c,负/v,。/w,如果/c,有/v,两个/m,以上/f,的/u,分类/vn,，/w,它/r,被/p,称为/v,多元/b,分类/vn,。/w,mllib/en,支持/v,两种/mq,线性/n,方法/n,分类/vn,：/w,线性/n,支持/v,向/p,量机/nw,和/c,逻辑/n,回归/v,。/w,线性/n,支持/v,向/p,量机/nw,仅/d,支持/v,二元/b,分类/vn,，/w,而/c,逻辑/n,回归/v,对/p,二元/b,分类/vn,和/c,多元/b,分类/vn,都/d,支持/v,。/w,对于/p,这/r,两种/mq,方法/n,，/w,mllib/en,支持/v,l/en,1/m,和/c,l/en,2/m,正规化/vn,变体/nw,。/w,mllib/en,中/f,使用/v,rdd/en,[/w,labeledpoint/en,]/w,代表/n,训练/vn,数据集/nw,，/w,其中/r,标签/n,引/v,从/p,0/m,开始/v,，/w,如/v,0/m,,/w,1/m,,/w,2/m,，/w,./w,./w,./w,。/w,对于/p,二元/mq,标签/n,γ,在/p,mllib/en,中/f,使用/v,0/m,表示/v,负/v,，/w,使用/v,+/w,1/m,表示/v,正/d,。/w,1/m,./w,线性/n,支持/v,向/p,量机线性/nw,支持/v,向量/n,机/ng,(/w,svm/en,)/w,是/v,用于/v,大规模/b,分类/vn,任务/n,的/u,标准/n,方法/n,。/w,正是/v,在/p,介绍/v,损失/n,函数/n,时/ng,提到/v,的/u,：/w,默认/v,情况/n,下/f,，/w,线性/n,支持/v,向/p,量机/nw,使用/v,l/en,2/m,正规化/vn,训练/vn,。/w,mllib/en,也/d,支持/v,选择/v,l/en,1/m,正规化/vn,，/w,在/p,这种/r,情况/n,下/f,，/w,问题/n,就/d,变成/v,了/u,线性/n,问题/n,。/w,线性/n,支持/v,向/p,量机/nw,算法/n,输出/v,svm/en,模型/n,。/w,给/p,定/v,一个/m,新/a,的/u,数据点/nw,，/w,记/v,为/p,x/en,，/w,该/r,模型/n,基于/p,w/en,τ,x/en,的/u,值/n,做/v,预测/v,。/w,默认/v,情况/n,下/f,，/w,如果/c,w/en,τ,x/en, ,≥/w, ,0则/mq,结果/n,是/v,正/d,的/u,，/w,否则/c,为/p,负/v,。/w,下例/nw,展示/v,了/u,如何/r,加载/v,样本/n,数据集/nw,，/w,执行/v,训练/vn,算法/n,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,classification/en,./w,{/w,svmmodel/en,，/w,svmwithsgd/en,}/w, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,evaluation/en,./w,binaryclassificationmetrics/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,util/en,./w,mlutils/en, ,//w,//w,加载/v,libsvm/en,格式/n,的/u,训练/vn,数据/n, ,val/en, ,data/en, ,=/w, ,mlutils/en,./w,loadlibsvmfile/en,(/w,sc/en,,/w, ,"/w,data/en,//w,mllib/en,//w,sample/en,_,libsbvm/en,_,data/en,./w,txt/en,"/w,)/w, ,//w,//w,将/d,数据/n,切分/v,为/p,训练/vn,数据/n,（/w,60%/mq,）/w,和/c,测试/vn,数据/n,（/w,40%/mq,）/w, ,val/en, ,splits/en, ,=/w, ,data/en,./w,randomsplit/en,(/w,array/en,(/w,0.6/m,,/w,0.4/m,)/w,,/w,seed/en, ,=/w, ,11/m,l/en,)/w, ,val/en, ,training/en, ,=/w, ,splits/en,(/w,0/m,)/w,./w,cache/en,(/w,)/w, ,val/en, ,test/en, ,=/w, ,splits/en,(/w,1/m,)/w, ,//w,//w,运行/vn,训练/vn,算法/n,构建/v,模型/n, ,val/en, ,numiterations/en, ,=/w, ,100/m, ,val/en, ,model/en, ,=/w, ,svmwithsgd/en,./w,train/en,(/w,training/en,,/w, ,numiterations/en,)/w, ,//w,//w,在/p,测试/vn,数据/n,上/f,计算/v,原始/a,分数/n, ,val/en, ,scoreandlabels/en, ,=/w, ,test/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,score/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,score/en,,/w, ,point/en,./w,label/en,)/w, ,}/w, ,//w,//w,获取/v,评估/vn,指标/n, ,val/en, ,metrics/en, ,=/w, ,new/en, ,binaryclassificationmetrics/en,(/w,scoreandlabels/en,)/w, ,val/en, ,auroc/en, ,=/w, ,metrics/en,./w,areaunderroc/en,(/w,)/w, ,println/en,(/w,"/w,area/en, ,under/en, ,roc/en, ,=/w, ,"/w, ,+/w, ,auroc/en,)/w, ,//w,//w,保存/v,和/c,加载/v,模型/n, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,svmmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,svmwithsgd/en,./w,train/en,默认/v,执行/v,l/en,2/m,正规化/vn,，/w,可以/v,设置/v,正则化/nw,参数/n,为/p,1.0/m,为/p,执行/v,l/en,1/m,正规化/vn,。/w,配置/vn,及/c,优化/v,svmwithsgd/en,的/u,代码/n,如下/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,optimization/en,./w,l/en,1/m,updater/en, ,val/en, ,svmalg/en, ,=/w, ,new/en, ,svmwithsgd/en,(/w,)/w, ,svmalg/en,./w,optimizer/en,./w, ,setnumiterations/en,(/w,200/m,)/w,./w, ,setregparam/en,(/w,0.1/m,)/w,./w, ,setupdater/en,(/w,new/en, ,l/en,1/m,updater/en,)/w, ,val/en, ,modell/en,1/m, ,=/w, ,svmalg/en,./w,run/en,(/w,training/en,)/w,2/m,./w,逻辑/n,回归/v,逻辑/n,回归/v,被/p,广泛/a,用于/v,预测/v,二元/b,响应/v,。/w,它/r,正是/v,在/p,介绍/v,损失/n,函数/n,时/ng,提到/v,的/u,：/w,对于/p,二元/mq,分类/vn,问题/n,，/w,该/r,算法/n,输出/v,二元/mq,逻辑/n,回归/v,模型/n,。/w,给/p,定/v,一个/m,新/a,的/u,数据点/nw,，/w,记/v,为/p,x/en,，/w,该/r,模型/n,基于/p,应用/vn,逻辑/n,函数/n,做/v,预测/v,，/w,其中/r,z/en, ,=/w, ,w/en,τ,x/en,。/w,默认/v,情况/n,下/f,，/w,如果/c,ƒ,(/w,w/en,τ,x/en,)/w, ,>, ,0.5/m,，/w,输出/v,为/p,正/d,，/w,否则/c,为/p,负/v,。/w,虽然/c,不/d,像/v,线性/n,支持/v,向量/n,机/ng,，/w,逻辑/n,回归/v,模型/n,中/f,，/w,ƒ,(/w,z/en,)/w,的/u,原始/a,输出/v,具有/v,一/m,概率/n,解释/v,(/w,即/v,x/en,是/v,正/d,概率/n,)/w,。/w,二元/b,逻辑/n,回归/v,可以/v,推广/v,到/v,多元/b,逻辑/n,回归/v,来/v,训练/vn,和/c,预测/v,多元/b,分类/vn,问题/n,。/w,对于/p,多元/b,分类/vn,问题/n,，/w,该/r,算法/n,将/d,输出/v,一个/m,多元/b,逻辑/n,回归/v,模型/n,，/w,其中/r,包含/v,k/en,-/w,1个/m,二元/b,逻辑/n,回归/v,模型/n,。/w,mllib/en,实现/v,了/u,两种/mq,算法/n,来/v,解决/v,逻辑/n,回归/v,分析/vn,：/w,小/a,批量/d,梯度/n,下降/v,和/c,l/en,-/w,bfgs/en,。/w,spark/en,官方/n,推荐/v,l/en,-/w,bfgs/en,，/w,因为/c,它/r,比/p,小/a,批/q,梯度/n,下降/v,的/u,收敛/vn,更/d,快/a,。/w,下例/nw,演示/vn,了/u,如何/r,使用/v,逻辑/n,回归/v,。/w,//w,//w,运行/vn,训练/vn,算法/n,构建/v,模型/n, ,val/en, ,model/en, ,=/w, ,new/en, ,logisticregressionwithlbfgs/en,(/w,)/w,./w,setnumclasses/en,(/w,10/m,)/w,./w,run/en,(/w,training/en,)/w, ,//w,//w,在/p,测试/vn,数据/n,上/f,计算/v,原始/a,分数/n, ,val/en, ,predictionandlabels/en, ,=/w, ,test/en,./w,map/en,{/w, ,case/en, ,labeledpoint/en,(/w,label/en,,/w, ,features/en,)/w, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,features/en,)/w, ,(/w,prediction/en,,/w, ,label/en,)/w, ,}/w, ,//w,//w,获取/v,评估/vn,指标/n, ,val/en, ,metrics/en, ,=/w, ,new/en, ,multiclassmetrics/en,(/w,predictionandlabels/en,)/w, ,val/en, ,precision/en, ,=/w,metrics/en,./w,precision/en, ,println/en,(/w,"/w,precision/en, ,=/w, ,"/w, ,+/w, ,precision/en,)/w, ,//w,//w,保存/v,和/c,加载/v,模型/n, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samlemodel/en, ,=/w, ,logisticregressionmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,5.4/m, ,回归/v,1/m,./w,线性/n,最小/a,二/m,乘/v,、/w,套索/n,和/c,岭/ng,回归线性/nw,最小/a,二/m,乘/v,公式/n,是/v,回归/v,问题/n,最/d,常见/a,的/u,公式/n,。/w,在/p,介绍/v,损失/n,函数/n,时/ng,也/d,提到/v,过/u,它/r,的/u,公式/n,：/w,多种多样/l,的/u,回归/v,方法/n,通过/p,使用/v,不同/a,的/u,正规化/vn,类型/n,，/w,都/d,派生自线性/nw,最小/a,二/m,乘/v,。/w,例如/v,，/w,普通/a,最小/a,二/m,乘/v,或/c,线性/n,最小/a,二/m,乘/v,使用/v,非正规化/nw,：/w,岭/ng,回归/v,使用/v,l/en,2/m,正规化/vn,；/w,套索/n,使用/v,l/en,1/m,正规化/vn,。/w,对于/p,所有/b,这些/r,模型/n,的/u,损失/n,和/c,训练/vn,误差/n,：/w,就是/d,均方/nw,误差/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,线性/n,回归/v,。/w,//w,//w,加载/v,解析/v,数据/n, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,data/en,//w,mllib/en,//w,ridge/en,-/w,data/en,//w,lpsa/en,./w,data/en,"/w,)/w, ,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en, ,{/w, ,line/en, ,=/w,>, ,val/en, ,parts/en, ,=/w, ,line/en,./w,split/en,(/w,'/w,,/w,'/w,)/w, ,labeledpoint/en,(/w,parts/en,(/w,0/m,)/w,./w,todouble/en,,/w, ,vectors/en,./w,dense/en,(/w,parts/en,(/w,1/m,)/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,./w,cache/en,(/w,)/w, ,//w,//w,构建/v,模型/n, ,val/en, ,numiterations/en, ,=/w, ,100/m, ,val/en, ,model/en, ,=/w, ,linearregressionwithsgd/en,./w,train/en,(/w,parseddata/en,,/w, ,numiterations/en,)/w, ,//w,//w,使用/v,训练/vn,样本/n,计算/v,模型/n,并且/c,计算/v,训练/vn,误差/n, ,val/en, ,valueandpreds/en, ,=/w, ,parseddata/en,./w,map/en, ,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,mse/en, ,=/w, ,valueandpreds/en,./w,map/en,{/w,case/en,(/w,v/en,,/w, ,p/en,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,v/en,-/w, ,p/en,)/w,,/w, ,2/m,)/w,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,training/en, ,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,mse/en,)/w, ,//w,//w,保存/v,与/p,加载/v,模型/n, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,linearregressionmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,}/w,2/m,./w,流线性/nw,回归/v,流式/nw,数据/n,可以/v,适用/v,于/p,线/n,上/f,的/u,回归/v,模型/n,，/w,每当/p,有/v,新/a,数据/n,到达/v,时/ng,，/w,更新/v,模型/n,的/u,参数/n,。/w,mllib/en,目前/t,使用/v,普通/a,最小/a,二/m,乘/v,法/j,支持/v,流线性/nw,回归/v,。/w,除了/p,每/r,批/q,数据/n,到达/v,时/ng,，/w,模型/n,更新/v,最/d,新/a,的/u,数据/n,外/f,，/w,实际/n,与/p,线/n,下/f,的/u,执行/v,是/v,类似/v,的/u,。/w,下面/f,的/u,例子/n,，/w,假设/v,已经/d,初始化/v,好/a,了/u,streamingcontext/en, ,ssc/en,来/v,演示/vn,流线性/nw,回归/v,。/w,val/en, ,numfeatures/en, ,=/w, ,3/m, ,val/en, ,model/en, ,=/w, ,new/en, ,streaminglinearregressionwithsgd/en,(/w,)/w, ,./w,setinitialweights/en,(/w,vectors/en,./w,zeros/en,(/w,numfeatures/en,)/w,)/w, ,model/en,./w,trainon/en,(/w,trainingdata/en,)/w, ,model/en,./w,predictonvalues/en,(/w,testdata/en,./w,map/en,(/w,lp/en, ,=/w,>, ,(/w,lp/en,./w,label/en,,/w, ,lp/en,./w,features/en,)/w,)/w,)/w,./w,print/en,(/w,)/w, ,ssc/en,./w,start/en,(/w,)/w, ,ssc/en,./w,awaittermination/en,(/w,)/w,6/m,./w, ,决策树/nz,决策树/nz,是/v,分类/vn,和/c,回归/v,的/u,机器/n,学习/v,任务/n,中/f,常用/a,的/u,方法/n,。/w,决策树/nz,广泛/a,使用/v,，/w,因为/c,它们/r,很/d,容易/a,解释/v,，/w,处理/v,分类/vn,的/u,功能/n,，/w,延伸/v,到/v,多/a,元/q,分类/vn,设置/v,，/w,不/d,需要/v,缩放/v,功能/n,，/w,并/c,能/v,捕捉/v,到/v,非线性/b,和/c,功能/n,的/u,交互/v,。/w,mllib/en,使用/v,连续/a,和/c,分类/vn,功能/n,支持/v,决策树/nz,的/u,二元/b,和/c,多元/b,的/u,分类/vn,和/c,回归/v,。/w,通过/p,行/v,实现/v,分区/vn,数据/n,，/w,允许/v,分布式/b,训练/vn,数以百万计/l,的/u,实例/n,。/w,6.1/m, ,基本/a,算法/n,决策树/nz,是/v,一个/m,贪心/v,算法/n,，/w,即/v,在/p,特性/n,空间/n,上/f,执行/v,递归/nw,的/u,二元/b,分割/v,。/w,决策树/nz,为/p,每个/r,最/d,底部/f,(/w,叶/j,)/w,分区/vn,预测/v,相同/a,的/u,标签/n,。/w,为了/p,在/p,每个/r,树/v,节点/n,上/f,获得/v,最/d,大/a,的/u,信息/n,，/w,每个/r,分区/vn,是/v,从/p,一组/mq,可能/v,的/u,划分/v,中/f,选择/v,的/u,最佳/z,分裂/v,。/w,1/m,./w,节点/n,不/d,纯度/n,和/c,信息/n,增益/v,节点/n,不/d,纯度/n,是/v,节点/n,上/f,标签/n,的/u,均匀性/nw,的/u,量度/n,。/w,当前/t,实现/v,提供/v,了/u,两种/mq,分类/vn,不/d,纯度/n,测量/vn,的/u,方法/n,(/w,基尼/nr,不/d,纯度/n,和/c,嫡,)/w,和/c,一种/mq,回归/v,不/d,纯度/n,测量/vn,的/u,方法/n,(/w,方差/nr,)/w,，/w,如/v,表/n,11/m,-/w,4/m,所示/nz,：/w,信息/n,增益/v,是/v,父/ng,节点/n,不/d,纯度/n,与/p,两个子/nw,节点/n,不/d,纯度/n,的/u,加权/v,总和/n,之间/f,的/u,差/a,。/w,假设/v,将/d,有/v,s/en,个/q,分区/vn,，/w,大小/n,为/p,n/en,的/u,数据集/nw,d/en,划分/v,为/p,两个/m,数据集/nw,dleft/en,和/c,dright/en,，/w,那么/r,信息/n,增益/v,为/p,：/w,2/m,./w,划分/v,候选人/n,(/w,1/m,)/w, ,连续/a,特征/n,对于/p,单机/n,上/f,实现/v,的/u,小/a,数据集/nw,，/w,给/p,每个/r,连续/a,特征/n,划分/v,的/u,候选人/n,在/p,此/r,特征/n,上/f,有/v,唯一/b,值/n,。/w,有些/r,实现/v,了/u,对/p,特征/n,值/n,排序/vn,，/w,为了/p,加速/v,计算/v,，/w,使用/v,这些/r,有序/a,的/u,唯一/b,值/n,划分/v,候选人/n,。/w,对于/p,大/a,的/u,分布式/b,数据集/nw,，/w,排序/vn,是/v,很/d,昂贵/a,的/u,。/w,通过/p,在/p,样本/n,数据/n,分数/n,上/f,执行/v,位/q,计算/v,，/w,实现/v,了/u,计算/v,近似/a,的/u,划分/v,候选人/n,集合/v,。/w,有序/a,划分/v,创建/v,了/u,“/w,箱/q,”/w,，/w,可/v,使用/v,maxbins/en,参数/n,指定/v,这样/r,的/u,容器/n,的/u,最/d,大/a,数量/n,。/w,(/w,2/m,)/w, ,分类/vn,特征/n,对于/p,有/v,m/en,种/q,可能/v,值/n,的/u,分类/vn,特征/n,，/w,将/d,会/v,有/v,2/m,m/en,-/w,1/m,-/w,1个/m,划分/v,候选人/n,。/w,对于/p,二元/mq,(/w,0/m,//w,1/m,)/w,分类/vn,和/c,回归/v,，/w,我们/r,可以/v,通过/p,平均/a,标签/n,排序/vn,的/u,分类/vn,特征值/n,，/w,减少/v,划分/v,候选人/n,至/p,m/en,-/w,1多/mq,得/u,数据量/n,。/w,例如/v,，/w,对于/p,一个/m,有/v,a/en,、/w,b/en,和/c,c/en,三个/m,分类/vn,的/u,分类/vn,特征/n,的/u,二元/b,分类/vn,问题/n,，/w,其/r,相应/v,的/u,标签/n,1/m,的/u,比例/n,是/v,0.2/m,，/w,0.6/m,和/c,0.4时/t,，/w,分类/vn,特征/n,是/v,有序/a,的/u,a/en,、/w,c/en,、/w,b/en,。/w,两个/m,划分/v,候选人/n,分别/d,是/v,a/en,|/w,c/en,，/w,b/en,和/c,a/en,，/w,c/en,|/w,b/en,，/w,其中/r,|/w,标记/n,划分/v,。/w,在/p,多元/b,分类/vn,中/f,共有/v,2/m,m/en,-/w,1/m,-/w,1种/mq,可能/v,的/u,划分/v,，/w,无论/c,何时/r,都/d,可能/v,被/p,使用/v,。/w,当/p,2/m,m/en,-/w,1/m,-/w,1/m,比/p,参数/n,maxbins/en,大/a,时/ng,，/w,我们/r,使用/v,与/p,二元/b,分类/vn,和/c,回归/v,相/d,类似/v,的/u,方法/n,。/w,m/en,种/q,分类/vn,特征/n,用/p,不/d,纯度/n,排序/vn,，/w,最终/d,得到/v,需要/v,考虑/v,的/u,m/en,-/w,1个/m,划分/v,候选人/n,。/w,3/m,./w,停止/v,规则/n,递归/nw,树/v,的/u,构建/v,当/p,满足/v,下面/f,三个/m,条件/n,之/u,一时/t,会/v,停/v,在/p,一个/m,节点/n,。/w,节点/n,的/u,深度/n,与/p,maxbins/en,相等/v,；/w,没有/v,划分/v,候选人/n,导致/v,信息/n,增益/v,大于/v,mininfogain/en,；/w,没有/v,划分/v,候选人/n,产生/v,的/u,子/ng,节点/n,都/d,至少/d,有/v,mininstancespernode/en,个/q,训练/vn,实例/n,。/w,6.2/m, ,使用/v,例子/n,下面/f,的/u,例子/n,演示/vn,了/u,使用/v,基尼/nr,不/d,纯度/n,作为/v,不/d,纯度/n,算法/n,且/c,树/v,深/a,为/p,5/m,的/u,决策树/nz,执行/v,分类/vn,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,tree/en,./w,decisiontree/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,tree/en,./w,model/en,./w,decisiontreemodel/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,util/en,./w,mlutils/en, ,val/en, ,data/en, ,=/w, ,mlutils/en,./w,loadlibsvmfile/en,(/w,sc/en,,/w, ,"/w,data/en,//w,mllib/en,//w,sample/en,_,libsvm/en,_,data/en,./w,txt/en,"/w,)/w, ,val/en, ,splits/en, ,=/w, ,data/en,./w,randomsplit/en,(/w,array/en,(/w,0.7/m,,/w, ,0.3/m,)/w,)/w, ,//w,//w,训练/vn,决策树/nz,模型/n, ,//w,//w,空/a,categoricalfeaturesinfo/en,说明/v,所有/b,的/u,特征/n,是/v,连续/a,的/u, ,val/en, ,numclasses/en, ,=/w, ,2/m, ,val/en, ,categoricalfeaturesinfo/en, ,=/w, ,map/en,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,impurity/en, ,=/w, ,"/w,gini/en,"/w, ,val/en, ,maxdepth/en, ,=/w, ,5/m, ,val/en, ,maxbins/en, ,=/w, ,32/m, ,//w,//w, ,trainingdata/en,是/v,训练/vn,数据/n, ,val/en, ,model/en, ,=/w, ,decisiontree/en,./w,trainclassifier/en,(/w,trainingdata/en,,/w, ,numclasses/en,,/w, ,categoricalfeaturesinfo/en,,/w, ,impurity/en,,/w, ,maxdepth/en,,/w, ,maxbins/en,)/w, ,//w,//w,在/p,测试/vn,实例/n,上/f,计算/v, ,val/en, ,labelandpreds/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testerr/en, ,=/w, ,labelandpreds/en,./w,filter/en,(/w,r/en, ,=/w,>, ,r/en,./w,_,1/m, ,!/w,=/w, ,r/en,./w,_,2/m,)/w,./w,count/en,./w,todouble/en, ,//w, ,testdata/en,./w,count/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,error/en, ,=/w, ,"/w, ,+/w, ,testerr/en,)/w, ,println/en,(/w,"/w,learned/en, ,classification/en, ,tree/en, ,model/en,:/w, ,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,decisiontreemodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,下面/f,的/u,例子/n,演示/vn,了/u,使用/v,方差/nr,作为/v,不/d,纯度/n,算法/n,且/c,树/v,深/a,为/p,5/m,的/u,决策树/nz,执行/v,分类/vn,val/en, ,categoricalfeaturesinfo/en, ,=/w, ,map/en,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,impurity/en, ,=/w, ,"/w,variance/en,"/w, ,val/en, ,maxdepth/en, ,=/w,5/m, ,val/en, ,maxbins/en, ,=/w, ,32/m, ,val/en, ,model/en, ,=/w, ,decisiontree/en,./w,trainregressor/en,(/w,trainingdata/en,,/w, ,categoricalfeaturesinfo/en,,/w, ,impurity/en,,/w, ,maxdepth/en,,/w, ,maxbins/en,)/w, ,val/en, ,labelsandpredictions/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testmse/en, ,=/w, ,labelsandpredictions/en,./w,map/en,{/w, ,case/en,(/w,v/en,,/w, ,p/en,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,v/en, ,-/w, ,p/en,)/w,,/w, ,2/m,)/w,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,mean/en, ,squared/en, ,error/en, ,=/w,"/w, ,+/w, ,testmse/en,)/w, ,println/en,(/w,"/w,learned/en, ,regression/en, ,tree/en, ,model/en,:/w,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,decisiontreemodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,7/m,./w, ,随机/d,森林/n,合奏/vn,是/v,一个/m,创建/v,由/p,其他/r,模型/n,的/u,集合/v,组合/v,而/c,成/v,的/u,模型/n,的/u,学习/v,算法/n,。/w,mllib/en,支持/v,两个/m,主要/b,的/u,合奏/vn,算法/n,：/w,梯度/n,提升/v,决策树/nz,和/c,随机/d,森林/n,，/w,它们/r,都/d,使用/v,决策树/nz,作为/v,其/r,基础/n,模型/n,。/w,梯度/n,提升/v,决策树/nz,和/c,随机/d,森林/n,虽然/c,都/d,是/v,决策树/nz,合奏/vn,的/u,学习/v,算法/n,，/w,但是/c,训练/vn,过程/n,是/v,不同/a,的/u,。/w,关于/p,合奏/vn,有/v,以下/f,几/m,个/q,权衡点/nw,：/w,gbt/en,每次/r,都/d,要/v,训练/vn,一颗/mq,树/v,，/w,所以/c,它们/r,比/p,随机/d,森林/n,需要/v,更/d,长/a,的/u,时间/n,来/v,训练/vn,。/w,随机/d,森林/n,可以/v,平行/vn,地/u,训练/vn,多/a,棵/q,树/v,。/w,另一方面/c,，/w,gbt/en,往往/d,比/p,随机/d,森林/n,更/d,合理/a,地/u,使用/v,更/d,小/a,（/w,浅/a,）/w,的/u,树/v,并且/c,训练/vn,小/a,树会/nw,花费/v,更/d,少/a,的/u,时间/n,。/w,随机/d,森林/n,更/d,不易/a,发生/v,过度/d,拟合/nz,。/w,随机/d,森林/n,训练/vn,更/d,多/a,的/u,树会/nw,减少/v,多半/d,的/u,过度/d,拟合/nz,，/w,而/c,gbt/en,训练/vn,更/d,多/a,的/u,树会/nw,增加/v,过度/d,拟合/nz,。/w,(/w,在/p,统计/v,语言/n,中/f,，/w,随机/d,森林/n,通过/p,使用/v,更/d,多/a,的/u,树木/n,减少/v,方差/nr,，/w,而/c,gbt/en,通过/p,使用/v,更/d,多/a,的/u,树木/n,减少/v,偏差/n,。/w,)/w,随机/d,森林/n,可以/v,更/d,容易/a,调整/vn,，/w,因为/c,性能/n,与/p,树木/n,的/u,数量/n,是/v,单调/a,增加/v,的/u,。/w,但/c,如果/c,gbt/en,树木/n,的/u,数量/n,增长/v,过/u,大/a,，/w,性能/n,可能/v,开始/v,下降/v,。/w,总之/c,，/w,两种/mq,算法/n,都/d,是/v,有效/a,的/u,，/w,具体/a,选择/v,应/v,取决于/v,特定/b,的/u,数据集/nw,。/w,随机/d,森林/n,是/v,分类/vn,与/p,回归/v,中/f,最/d,成功/a,的/u,机器/n,学习/v,模型/n,之一/r,。/w,为了/p,减少/v,过度/d,拟合/nz,的/u,风险/n,，/w,随机/d,森林/n,将/d,很多/m,决策树/nz,结合/v,起来/v,。/w,和/c,决策树/nz,相似/a,，/w,随机/d,森林/n,处理/v,分类/vn,的/u,功能/n,，/w,延伸/v,到/v,多/a,元/q,分类/vn,设置/v,，/w,不/d,需要/v,缩放/v,功能/n,，/w,并/c,能/v,捕捉/v,到/v,非线性/b,和/c,功能/n,的/u,交互/v,。/w,mllib/en,使用/v,连续/a,和/c,分类/vn,功能/n,支持/v,随机/d,森林/n,的/u,二元/b,和/c,多元/b,的/u,分类/vn,和/c,回归/v,。/w,7.1/m, ,基本/a,算法/n,随机/d,森林/n,训练/vn,一个/m,决策树/nz,的/u,集合/v,，/w,所以/c,训练/vn,可以/v,并行/v,。/w,该/r,算法/n,随机性/n,注入/v,训练/vn,过程/n,，/w,使/v,每个/r,决策树/nz,会/v,有/v,一点/m,不同/a,。/w,结合/v,每/r,棵/q,树/v,的/u,预测/v,降低/v,了/u,预测/v,的/u,方差/nr,，/w,改进/v,了/u,测试/vn,数据/n,的/u,性能/n,。/w,1/m,./w,随机/d,注入/v,算法/n,随机性/n,注入/v,训练/vn,的/u,过程/n,包括/v,：/w,1/m,)/w, ,每次/r,迭代/vn,对/p,原始/a,数据集/nw,进行/v,二次/mq,采样/v,获得/v,不同/a,的/u,训练/vn,集/vg,，/w,即/v,引导/v,。/w,2/m,)/w, ,考虑/v,在/p,树/v,的/u,每个/r,节点/n,上/f,将/d,特征/n,的/u,不同/a,随机子集/nw,分割/v,。/w,除了/p,这些/r,随机性/n,，/w,每个/r,决策树/nz,个体/n,都/d,以/p,同样/d,的/u,方法/n,训练/vn,。/w,2/m,./w,预测/v,对/p,随机/d,森林/n,做/v,预测/v,，/w,就/d,必须/d,聚合/v,它/r,的/u,决策树/nz,集合/v,的/u,预测/v,。/w,分类/vn,和/c,回归/v,的/u,聚合/v,是/v,不同/a,的/u,：/w,分类/vn,采用/v,多数/m,表决/vn,。/w,每/r,棵/q,树/v,的/u,预测/v,作为/v,对/p,分类/vn,的/u,一次/mq,投票/v,，/w,收到/v,最/d,多/a,投票/v,的/u,分类/vn,就/d,是/v,预测/v,结果/n,。/w,回归/v,采用/v,平均值/n,。/w,每/r,棵/q,树/v,都/d,有/v,一个/m,预测值/n,，/w,这些/r,树/v,的/u,预测值/n,的/u,平均值/n,就/d,是/v,预测/v,结果/n,。/w,7.2/m, ,使用/v,例子/n,下面/f,例子/n,演示/vn,了/u,使用/v,随机/d,森林/n,执行/v,分类/vn,。/w,//w,//w,训练/vn,随机/d,森林/n,模型/n, ,//w,//w,空/a,categoricalfeaturesinfo/en,说明/v,所有/b,特征/n,是/v,连续/a,的/u, ,val/en, ,numclasses/en, ,=/w, ,2/m, ,val/en, ,categoricalfeaturesinfo/en, ,=/w, ,map/en,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,numtrees/en, ,=/w, ,3/m, ,//w,//w,use/en, ,more/en, ,practice/en, ,val/en, ,featuresubsetstrategy/en, ,=/w, ,"/w,auto/en,"/w, ,//w,//w,let/en, ,the/en, ,algorithm/en, ,choose/en,./w, ,val/en, ,impurity/en, ,=/w, ,"/w,gini/en,"/w, ,val/en, ,maxdepth/en, ,=/w, ,4/m, ,val/en, ,maxbins/en, ,=/w, ,32/m, ,val/en, ,model/en, ,=/w, ,randomforest/en,./w,trainclassifier/en,(/w,trainingdata/en,,/w, ,numclasses/en,,/w, ,categoricalfeaturesinfo/en,,/w, ,numtrees/en,,/w, ,featuresubsetstrategy/en,,/w, ,impurity/en,,/w, ,maxdepth/en,,/w, ,maxbins/en,)/w, ,val/en, ,labelandpreds/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testerr/en, ,=/w, ,labelandpreds/en,./w,filter/en,(/w,r/en, ,=/w,>, ,r/en,./w,_,1/m, ,!/w,=/w, ,r/en,./w,_,2/m,)/w,./w,count/en,./w,todouble/en, ,//w, ,testdata/en,./w,count/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,error/en, ,=/w, ,"/w, ,+/w, ,testerr/en,)/w, ,println/en,(/w,"/w,learned/en, ,classification/en, ,forest/en, ,model/en,:/w,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,randomforestmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,下面/f,例子/n,演示/vn,了/u,使用/v,随机/d,森林/n,执行/v,回归/v,。/w,val/en, ,numclasses/en, ,=/w, ,2/m, ,val/en, ,categoricalfeaturesinfo/en, ,=/w, ,map/en,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,numtrees/en, ,=/w, ,3/m, ,//w,//w,use/en, ,more/en, ,in/en, ,practice/en,./w, ,val/en, ,featuresubsetstrategy/en, ,=/w, ,"/w,auto/en,"/w, ,//w,//w,let/en, ,the/en, ,algorithm/en, ,choose/en, ,val/en, ,impurity/en, ,=/w, ,"/w,variance/en,"/w, ,val/en, ,maxdepth/en, ,=/w, ,4/m, ,val/en, ,maxbins/en, ,=/w, ,32/m, ,val/en, ,model/en, ,=/w, ,randomforest/en,./w,trainregressor/en,(/w,trainingdata/en,,/w, ,categoricalfeaturesinfo/en,,/w, ,numtrees/en,,/w, ,featuresubsetstrategy/en,,/w, ,impurity/en,,/w, ,maxdepth/en,,/w, ,maxbins/en,)/w, ,val/en, ,labelandpredictions/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testmse/en, ,=/w, ,labelandpredictions/en,./w,map/en,{/w, ,case/en,(/w,v/en,,/w, ,p/en,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,v/en, ,-/w,p/en,)/w,,/w, ,2/m,)/w,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,testmse/en,)/w, ,println/en,(/w,"/w,learned/en, ,regression/en, ,forest/en, ,model/en,:/w,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,randomforestmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,8/m,./w, ,梯度/n,提升/v,决策树/nz,gbt/en,迭代/vn,训练/vn,决策树/nz,，/w,以便/d,最小化/nw,损失/n,函数/n,。/w,和/c,决策树/nz,相似/a,，/w,随机/d,森林/n,处理/v,分类/vn,的/u,功能/n,，/w,延伸/v,到/v,多/a,元/q,分类/vn,设置/v,，/w,不/d,需要/v,缩放/v,功能/n,，/w,并/c,能/v,捕捉/v,到/v,非线性/b,和/c,功能/n,的/u,交互/v,。/w,mllib/en,使用/v,连续/a,和/c,分类/vn,功能/n,支持/v,梯度/n,提升/v,决策树/nz,的/u,二元/b,和/c,多元/b,的/u,分类/vn,和/c,回归/v,。/w,8.1/m, ,基本/a,算法/n,gbt/en,迭代/vn,训练/vn,一个/m,决策树/nz,的/u,序列/n,。/w,在/p,每次/r,迭代/vn,中/f,，/w,算法/n,使用/v,当前/t,合奏/vn,来/v,预测/v,每个/r,训练/vn,实例/n,的/u,标签/n,，/w,然后/c,将/d,预测/v,与/p,真实/a,的/u,标签/n,进行/v,比较/d,。/w,数据集/nw,被/p,重新/d,贴/v,上/f,标签/n,，/w,将/d,重点/n,放在/v,预测/v,不/d,佳/a,的/u,训练/vn,实例/n,上/f,。/w,因此/c,，/w,在/p,下/f,一/m,迭代/vn,中/f,，/w,决策树/nz,将/d,帮助/v,纠正/v,先前/t,的/u,错误/n,。/w,重贴/nw,标签/n,的/u,具体/a,机制/n,是/v,由/p,损失/n,函数/n,定义/n,的/u,。/w,随着/p,每次/r,迭代/vn,，/w,gbt/en,进一步/d,减少/v,训练/vn,数据/n,上/f,的/u,损失/n,函数/n,。/w,表/n,11/m,-/w,5/m,列出/v,了/u,mllib/en,中/f,gbt/en,支持/v,的/u,损失/n,函数/n,。/w,请/v,注意/v,，/w,每个/r,损失/n,只/d,适用/v,于/p,分类/vn,或/c,回归/v,之一/r,。/w,其中/r,n/en,表示/v,实例/n,数量/n,，/w,y/en,1/m,表示/v,实例/n,i/en,的/u,标签/n,，/w,xi/en,表示/v,实例/n,i/en,的/u,特征/n,，/w,f/en,(/w,xi/en,)/w,表示/v,实例/n,i/en,的/u,模型/n,预测/v,标签/n,。/w,8.2/m, ,使用/v,例子/n,下例/nw,演示/vn,了/u,用/p,logloss/en,作为/v,损失/n,函数/n,，/w,使用/v,gbt/en,执行/v,分类/vn,的/u,例子/n,。/w,//w,//w,训练/vn,gradientboostedtree/en,模型/n, ,//w,//w,默认/v,使用/v,logloss/en, ,val/en, ,boostingstrategy/en, ,=/w, ,boostingstrategy/en,./w,defaultparams/en,(/w,"/w,classification/en,"/w,)/w, ,boostingstrategy/en,./w,numiterations/en, ,=/w, ,3/m, ,//w,//w,note/en,:/w,use/en, ,more/en, ,iterations/en, ,in/en, ,practice/en,./w, ,boostingstrategy/en,./w,treestrategy/en,./w,numclasses/en, ,=/w, ,2/m, ,boostingstrategy/en,./w,treestrategy/en,./w,maxdepth/en, ,=/w, ,5/m, ,//w,//w,空/a,categoricalfeaturesinfo/en,说明/v,所有/b,特征/n,是/v,连续/a,的/u, ,boostingstrategy/en,./w,treestrategy/en,./w,categoricalfeaturesinfo/en, ,=/w, ,map/en,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,model/en, ,=/w, ,gradientboostedtrees/en,./w,train/en,(/w,trainingdata/en,,/w, ,boostingstrategy/en,)/w, ,val/en, ,labelandpreds/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testerr/en, ,=/w, ,labelandpreds/en,./w,filter/en,(/w,r/en, ,=/w,>, ,r/en,./w,_,1/m, ,!/w,=/w, ,r/en,./w,_,2/m,)/w,./w,count/en,./w,todouble/en, ,//w, ,testdata/en,./w,count/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,error/en, ,=/w, ,"/w, ,+/w, ,testerr/en,)/w, ,println/en,(/w,"/w,learned/en, ,classification/en, ,gbt/en, ,model/en,:/w,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,gradientboostedtreesmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,下例/nw,演示/vn,了/u,用/p,squared/en, ,error/en, ,作为/v,损失/n,函数/n,，/w,使用/v,gbt/en,执行/v,回归/v,的/u,例子/n,。/w,//w,//w,训练/vn,gradientboostedtrees/en,模型/n, ,//w,//w, ,defaultparams/en,指定/v,了/u,regression/en,,/w, ,默认/v,使用/v,squarederror/en, ,val/en, ,boostingstrategy/en, ,=/w, ,boostingstrategy/en,./w,defaultparams/en,(/w,"/w,regression/en,"/w,)/w, ,boostingstrategy/en,./w,numiterations/en, ,=/w, ,3/m, ,//w,//w,note/en,:/w, ,use/en, ,more/en, ,iterations/en, ,in/en, ,practice/en,./w, ,boostingstrategy/en,./w,treestrategy/en,./w,maxdepth/en, ,=/w, ,5/m, ,//w,//w,空/a,categoricalfeaturesinfo/en,说明/v,所有/b,特征/n,是/v,连续/a,的/u, ,boostingstrategy/en,。/w,treestrategy/en,./w,categoricalfeaturesinfo/en, ,=/w, ,map/en, ,[/w,int/en,,/w, ,int/en,]/w,(/w,)/w, ,val/en, ,model/en, ,=/w, ,gradientboostedtrees/en,./w,train/en,(/w,trainingdata/en,,/w, ,boostingstrategy/en,)/w, ,val/en, ,labelsandpredictions/en, ,=/w, ,testdata/en,./w,map/en,{/w, ,point/en, ,=/w,>, ,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w, ,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w, ,}/w, ,val/en, ,testmse/en, ,=/w, ,labelsandpredictions/en,./w,map/en,{/w,case/en,(/w,v/en,,/w, ,p/en,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,v/en, ,-/w, ,p/en,)/w,,/w, ,2/m,)/w,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,test/en, ,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,testmse/en,)/w, ,println/en,(/w,"/w,learned/en, ,regression/en, ,gbt/en, ,model/en,:/w,\/w,n/en,"/w, ,+/w, ,model/en,./w,todebugstring/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,gradientboostedtreesmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,9/m,./w, ,朴素/a,贝叶斯/nr,9.1/m, ,算法/n,原理/n,j/en,我们/r,首先/d,来/v,介绍/v,一些/m,数学/n,中/f,的/u,理论/n,，/w,然后/c,来/v,看/v,朴素/a,贝叶斯/nr,。/w,条件/n,概率/n,：/w,a/en,和/c,b/en,表示/v,两个/m,事件/n,，/w,且/c,p/en,(/w,b/en,)/w, ,≠/w, ,0/m,（/w,b/en,事件/n,发生/v,的/u,概率/n,不/d,等于/v,0/m,）/w,，/w,则/d,给/p,定/v,事件/n,b/en,发生/v,的/u,条件/n,下/f,事件/n,a/en,发生/v,的/u,条件/n,概率/n,定义/n,为/p,：/w,使用/v,条件/n,概率/n,推导/vn,出/v,乘/v,法定律/nw,：/w,a/en,和/c,b/en,表示/v,两个/m,事件/n,，/w,且/c,p/en,(/w,b/en,)/w, ,≠/w, ,0/m,（/w,b/en,事件/n,发生/v,的/u,概率/n,不/d,等于/v,0/m,）/w,。/w,那么/r,：/w,将/d,乘/v,法定律/nw,扩展/v,为/p,全/a,概率/n,定律/n,：/w,事件/n,b/en,1/m,,/w,b/en,2/m,,/w,./w,./w,./w,,/w,bn/en,满足/v,uni/en,=/w,1/m, ,bi/en,=/w,Ω,，/w,bi/en,∩/w,bj/en,=/w,Ø,，/w,i/en, ,≠/w, ,j/en,，/w,且/c,对/p,所有/b,的/u,i/en,，/w,p/en,(/w,bi/en,)/w, ,>, ,0/m,。/w,那么/r,，/w,对于/p,任意/d,的/u,a/en,，/w,满足/v,：/w,贝叶斯公式/nw,：/w,事件/n,事件/n,a/en,,/w, ,b/en,1/m,,/w,b/en,2/m,,/w,./w,./w,./w,,/w,bn/en,,/w, ,其中/r,bi/en,不/d,相交/v,，/w,uni/en,=/w,1/m, ,bi/en,=/w,Ω,，/w,且/c,对/p,所有/b,的/u,i/en,，/w,p/en,(/w,bi/en,)/w, ,>, ,0/m,。/w,那么/r,：/w,朴素/a,贝叶斯/nr,分类/vn,算法/n,是/v,一种/mq,基于/p,每/r,对/p,特征/n,之间/f,独立性/n,的/u,假设/v,的/u,简单/a,的/u,多元/b,分类/vn,算法/n,。/w,朴素/a,贝叶斯/nr,的/u,思想/n,：/w,对于/p,给/p,出/v,的/u,待/v,分类/vn,项/q,，/w,求解/v,在/p,此项/r,出现/v,的/u,条件/n,下/f,各个/r,类别/n,出现/v,的/u,概率/n,，/w,哪个/r,最/d,大/a,，/w,就/d,认为/v,此/r,待/v,分类/vn,项/q,属于/v,哪个/r,类别/n,。/w,朴素/a,贝叶斯/nr,分类/vn,的/u,定义/n,如下/v,：/w,1/m,)/w, ,设/v,x/en, ,=/w, ,{/w,a/en,1/m,,/w,a/en,2/m,,/w,./w,./w,./w,,/w,am/en,}/w,为/p,待/v,分类/vn,项/q,，/w,每个/r,ai/en,为/p,x/en,的/u,一个/m,特征/n,属性/n,；/w,2/m,)/w,类别/n,集合/v,c/en, ,=/w, ,{/w,y/en,1/m,,/w,y/en,2/m,,/w,./w,./w,./w,,/w,yn/en,}/w,；/w,3/m,)/w, ,计算/v,p/en,(/w,y/en,1/m,|/w,x/en,)/w,，/w,p/en,(/w,y/en,2/m,|/w,x/en,)/w,，/w,./w,./w,./w,，/w,p/en,(/w,yn/en,|/w,x/en,)/w, ,；/w,4/m,)/w, ,如果/c,p/en,(/w,yk/en,|/w,x/en,)/w, ,=/w, ,max/en,{/w,(/w,y/en,1/m,|/w,x/en,)/w,，/w,p/en,(/w,y/en,2/m,|/w,x/en,)/w,，/w,./w,./w,./w,，/w,p/en,(/w,yn/en,|/w,x/en,)/w, ,}/w,，/w,则/d,x/en, ,ε, ,yk/en, ,。/w,关键/n,在/p,第三/nw,步/q,：/w,1/m,)/w, ,找到/v,一个/m,已知/nz,分类/vn,的/u,待/v,分类/vn,项/q,集合/v,，/w,这个/r,集合/v,叫做/v,训练/vn,样本/n,集/vg,。/w,2/m,)/w, ,统计/v,得到/v,在/p,各类/r,别/d,下/f,各个/r,特征/n,属性/n,的/u,条件/n,概率/n,估计/v,。/w,即/v,p/en,(/w,a/en,1/m,|/w,y/en,1/m,)/w,，/w,p/en,(/w,a/en,2/m,|/w,y/en,1/m,)/w,，/w,./w,./w,./w,，/w,p/en,(/w,am/en,|/w,y/en,1/m,)/w,；/w, ,p/en,(/w,a/en,1/m,|/w,y/en,2/m,)/w,，/w,p/en,(/w,a/en,2/m,|/w,y/en,2/m,)/w,，/w,./w,./w,./w, ,，/w,p/en,(/w,am/en,|/w,y/en,2/m,)/w,；/w,./w,./w,./w,；/w,p/en,(/w,a/en,1/m,|/w,yn/en,)/w,，/w,p/en,(/w,a/en,2/m,|/w,yn/en,)/w,，/w,./w,./w,./w,，/w,p/en,(/w,am/en,|/w,yn/en,)/w, ,。/w,3/m,)/w, ,如果/c,各个/r,特征/n,属性/n,都/d,是/v,独立/v,的/u,，/w,则/d,根据/p,贝叶斯公式/nw,可以/v,得到/v,以下/f,推导/vn,：/w,朴素/a,贝叶斯/nr,能够/v,被/p,非常/d,有效/a,的/u,训练/vn,。/w,它/r,被/p,单独/d,传/v,给/p,训练/vn,数据/n,，/w,计算/v,给/p,定/v,标签/n,特征/n,的/u,条件/n,概率/n,分布/v,并/c,给/p,出/v,观察/v,结果/n,用于/v,预测/v,。/w,mllib/en,支持/v,多/a,项/q,朴素/a,贝叶斯/nr,和/c,伯努利朴素贝叶斯/nw,。/w,这些/r,模型/n,典型/n,的/u,应用/vn,是/v,文档/n,分类/vn,。/w,在/p,这/r,方面/n,，/w,每个/r,观察/v,是/v,一个/m,文档/n,，/w,每个/r,特征/n,代表/n,一个/m,条件/n,，/w,其值/nw,是/v,条件/n,的/u,频率/n,(/w,在/p,多/a,项/q,朴素/a,贝叶斯中/nrf,)/w,或/c,一个/m,由/p,零个/nw,或/c,一个/m,指示/n,该/r,条件/n,是否/v,在/p,文档/n,中/f,找到/v,(/w,在/p,伯努利/nr,朴素/a,贝叶斯中/nrf,)/w,。/w,特征/n,值/n,必须/d,是/v,非负/nw,的/u,。/w,模型/n,类型/n,选择/v,使用/v,可/v,选/v,的/u,参数/n,"/w,多/a,项/q,"/w,或/c,“/w,伯努利/nr,”/w,。/w,“/w,多/a,项/q,”/w,作为/v,默认/v,模型/n,。/w,通过/p,设置/v,参数/n,λ,(/w,默认/v,为/p,1.0/m,)/w,添加剂/n,平滑/an,。/w,为/p,文档/n,分类/vn,，/w,输入/v,特征/n,向量/n,通常/d,是/v,稀疏/a,的/u,，/w,因为/c,稀疏/a,向/p,量/n,能/v,利用/v,稀疏性/nw,的/u,优势/n,。/w,因为/c,训练/vn,数据/n,只/d,使用/v,一次/mq,，/w,所以/c,没有/v,必要/a,缓存/n,它/r,。/w,9.2/m, ,使用/v,例子/n,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,多/a,项/q,朴素/a,贝叶斯/nr,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,classification/en,./w,{/w,naivebayes/en,,/w, ,naivebayesmodel/en,}/w, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,labeledpoint/en, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,data/en,//w,mllib/en,//w,sample/en,_,naive/en,_,bayes/en,_,data/en,./w,txt/en,"/w,)/w, ,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en,{/w, ,line/en, ,=/w,>, ,val/en, ,parts/en, ,=/w, ,line/en,./w,split/en,(/w,'/w,,/w,'/w,)/w, ,labeledpoint/en,(/w,parts/en,(/w,0/m,)/w,./w,todouble/en,,/w, ,vectors/en,./w,dense/en,(/w,parts/en,(/w,1/m,)/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w, ,}/w, ,val/en, ,splits/en, ,=/w, ,parseddata/en,./w,randomsplit/en,(/w,array/en,(/w,0.6/m,,/w, ,0.4/m,)/w,,/w, ,seed/en, ,=/w, ,11/m,l/en,)/w, ,val/en, ,training/en, ,=/w, ,splits/en,(/w,0/m,)/w, ,val/en, ,test/en, ,=/w, ,splits/en,(/w,1/m,)/w, ,val/en, ,model/en, ,=/w, ,naivebayes/en,./w,train/en,(/w,training/en,,/w, ,lambda/en, ,=/w, ,1.0/m,,/w, ,modeltype/en, ,=/w, ,"/w,multinomial/en,"/w,)/w, ,val/en, ,predictionandlabel/en, ,=/w, ,test/en,./w,map/en,(/w,p/en, ,=/w,>, ,(/w,model/en,./w,predict/en,(/w,p/en,./w,features/en,)/w,,/w, ,p/en,./w,label/en,)/w,)/w, ,val/en, ,accuracy/en, ,=/w, ,1.0/m, ,*/w, ,predictionandlabel/en,./w,filter/en,(/w,x/en, ,=/w,>, ,x/en,./w,_,1/m, ,=/w,=/w, ,x/en,./w,_,2/m,)/w,./w,count/en,(/w,)/w, ,//w, ,test/en,./w,count/en,(/w,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,gradientboostedtreesmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,10/m,./w, ,保序/nr,回归/v,10.1/m, ,算法/n,原理/n,保序/nr,回归/v,属于/v,回归/v,算法/n,，/w,其/r,定义/n,为/p,：/w,给/p,定/v,一个/m,有限/a,的/u,实数/n,集合/v,y/en, ,=/w, , ,{/w,y/en,1/m,,/w,y/en,2/m,,/w,./w,./w,./w,,/w,yn/en,}/w, ,表示/v,观测/vn,响应/v,，/w, ,x/en, ,=/w, , ,{/w,x/en,1/m,,/w,x/en,2/m,,/w,./w,./w,./w,,/w,xn/en,}/w, ,表示/v,未知/vn,的/u,响应值/nw,，/w,进行/v,拟合/nz,找到/v,一个/m,最小化/nw,函数/n,：/w,并/c,使用/v,x/en,1/m,≤/w,x/en,2/m,≤/w,./w,./w,./w,≤/w,xn/en, ,对/p,目标/n,排序/vn,，/w,其中/r,ω,i/en, ,是/v,大于/v,0/m,的/u,权重/nz,。/w,最终/d,的/u,函数/n,被/p,称为/v,保序/nr,回归/v,，/w,并且/c,它/r,是/v,唯一/b,的/u,。/w,它/r,可以/v,看做/v,是/v,排序/vn,限制/v,下/f,的/u,最/d,小/a,二/m,乘/v,问题/n,。/w,基本上/d,保序/nr,回归/v,是/v,拟合/nz,原始/a,数据点/nw,最佳/z,的/u,单调/a,函数/n,。/w,mllib/en,支持/v,pava/en,，/w,此/r,算法/n,使用/v,一种/mq,办法/n,来/v,平行化/nw,保序/nr,回归/v,。/w,保序/nr,回归/v,有/v,一个/m,可/v,选/v,参数/n,isotonic/en,，/w,默认值/nw,是/v,true/en,。/w,此/r,参数/n,指定/v,保序/nr,回归/v,是/v,保序/nr,的/u,（/w,单调/a,增加/v,）/w,还是/c,不/d,保序/nr,的/u,（/w,单调/a,减少/v,）/w,。/w,保序/nr,回归/v,的/u,结果/n,被/p,视为/v,分段线性/nw,函数/n,。/w,因此/c,，/w,预测/v,的/u,规则/n,是/v,：/w,1/m,)/w, ,如果/c,预测/v,输入/v,能/v,准备/v,匹配/vn,训练/vn,特征/n,，/w,那么/r,返回/v,相关/v,预测/v,。/w,如果/c,有/v,多/a,个/q,预测/v,匹配/vn,训练/vn,特征/n,，/w,那么/r,会/v,返回/v,其中/r,之一/r,。/w,2/m,)/w, ,如果/c,预测/v,输入/v,比/p,所有/b,的/u,训练/vn,特征/n,低/a,或者/c,高/a,，/w,那么/r,最/d,低/a,和/c,最高/a,的/u,训练/vn,特征/n,各自/r,返回/v,。/w,如果/c,有/v,多/a,个/q,预测/v,比/p,所有/b,的/u,训练/vn,特征/n,低/a,或者/c,高/a,，/w,那么/r,都/d,会/v,返回/v,。/w,3/m,)/w, ,如果/c,预测/v,输入/v,介于/v,两个/m,训练/vn,特征/n,，/w,那么/r,预测/v,会/v,被/p,视为/v,分段线性/nw,函数/n,和/c,从/p,最/d,接近/v,的/u,训练/vn,特征/n,中/f,计算/v,得到/v,的/u,插值/nw,。/w,10.2/m, ,使用/v,例子/n,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,保序/nr,回归/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,{/w,isotonicregression/en,,/w, ,isotonicregressionmodel/en,}/w, ,//w,//w,省略/v,数据/n,加载/v,及/c,样本/n,划分/v,的/u,代码/n, ,val/en, ,model/en, ,=/w, ,new/en, ,isotonicregression/en,(/w,)/w,./w,setisotonic/en,(/w,true/en,)/w,./w,run/en,(/w,training/en,)/w, ,val/en, ,predictionandlabel/en, ,=/w, ,test/en,./w,map/en, ,{/w, ,point/en, ,=/w,>, ,val/en, ,predictedlabel/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,_,2/m,)/w, ,(/w,predictedlabel/en,,/w, ,point/en,./w,_,1/m,)/w, ,}/w, ,val/en, ,meansquareerror/en, ,=/w, ,predictionandlabel/en,./w,map/en,{/w,case/en,(/w,p/en,,/w, ,1/m,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,p/en,-/w,1/m,)/w,,/w, ,2/m,)/w,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,meansquarederror/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,isotonicregressionmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,11/m,./w, ,协同/v,过滤/v,协同/v,过滤/v,通常/d,用于/v,推荐/v,系统/n,。/w,这些/r,技术/n,旨在/v,填补/v,用户/n,关联/vn,矩阵/n,的/u,缺失/n,项/q,。/w,mllib/en,支持/v,基于/p,模型/n,的/u,协同/v,过滤/v,，/w,用户/n,和/c,产品/n,可以/v,预测/v,缺/v,失项/nw,的/u,潜在/b,因素/n,的/u,小/a,集合/v,来/v,描述/v,。/w,mllib/en,采用/v,交替/v,最小/a,二/m,乘/v,算法/n,来/v,学习/v,这些/r,潜在/b,的/u,因素/n,。/w,矩阵/n,分解/v,的/u,标准/n,方法/n,基于/p,协同/v,过滤/v,处理/v,用户/n,项/q,矩阵/n,的/u,条目/n,是/v,明确/ad,的/u,。/w,现实/n,世界/n,的/u,用例/nw,只能/v,访问/v,隐式/nw,反馈/v,是/v,更/d,常见/a,的/u,(/w,例如/v,浏览/vn,、/w,点击/v,、/w,购买/v,、/w,喜欢/v,、/w,股份/n,等/u,)/w,。/w,下面/f,的/u,例子/n,演示/vn,了/u,如何/r,使用/v,协同/v,过滤/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,als/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,matrixfactorizationmodel/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,rating/en, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,data/en,//w,mllib/en,//w,als/en,//w,test/en,./w,data/en,"/w,)/w, ,val/en, ,ratings/en, ,=/w, ,data/en,./w,map/en,(/w,_,./w,split/en,(/w,'/w,,/w,'/w,)/w, ,match/en, ,{/w, ,case/en, ,array/en,(/w,user/en,,/w, ,item/en,,/w, ,rate/en,)/w, ,=/w,>, ,rating/en,(/w,user/en,./w,toint/en,,/w, ,item/en,./w,toint/en,,/w, ,rate/en,./w,todouble/en,)/w, ,}/w,)/w, ,//w,//w,使用/v,als/en,构建/v,推荐/v,模型/n, ,val/en, ,rank/en, ,=/w, ,10/m, ,val/en, ,numiterations/en, ,=/w, ,20/m, ,val/en, ,model/en, ,=/w, ,als/en,./w,train/en,(/w,ratings/en,,/w, ,rank/en,,/w, ,numiterations/en,,/w, ,0.01/m,)/w, ,//w,//w,模型/n,计算/v, ,val/en, ,usersproducts/en, ,=/w, ,ratings/en,./w,map/en,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,user/en,,/w, ,product/en,)/w, ,}/w, ,val/en, ,predictions/en, ,=/w, ,model/en,./w,predict/en,(/w,usersproducts/en,)/w,./w,map/en, ,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,rate/en,)/w, ,}/w, ,val/en, ,ratesandpreds/en, ,=/w, ,ratings/en,./w,map/en, ,{/w, ,case/en, ,rating/en,(/w,user/en,,/w, ,product/en,,/w, ,rate/en,)/w, ,=/w,>, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,rate/en,)/w, ,}/w,./w,join/en,(/w,predictions/en,)/w, ,val/en, ,mse/en, ,=/w, ,ratesandpres/en,./w,map/en, ,{/w, ,case/en, ,(/w,(/w,user/en,,/w, ,product/en,)/w,,/w, ,(/w,r/en,1/m,,/w, ,r/en,2/m,)/w,)/w, ,=/w,>, ,val/en, ,err/en, ,=/w, ,(/w,r/en,1/m, ,-/w, ,r/en,2/m,)/w, ,err/en, ,*/w, ,err/en, ,}/w,./w,mean/en,(/w,)/w, ,println/en,(/w,"/w,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,mse/en,)/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,matrixfactorizationmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,12/m,./w, ,聚类/nw,聚类/nw,分析/vn,又/d,称/v,群/q,分析/vn,，/w,它/r,是/v,研究/vn,（/w,样品/n,或/c,指标/n,）/w,分类/vn,问题/n,的/u,一种/mq,统计/v,分析/vn,方法/n,。/w,聚类/nw,分析/vn,以/p,相似性/n,为/p,基础/n,，/w,在/p,一个/m,聚类/nw,中/f,的/u,模式/n,之间/f,比/p,不/d,在/p,同一/b,聚类/nw,中/f,的/u,模式/n,之间/f,具有/v,更/d,多/a,的/u,相似性/n,。/w,mllib/en,支持/v,的/u,聚类/nw,算法/n,如下/v,：/w,k/en,-/w,means/en,；/w,高斯/nr,混合/vn,(/w,gaussian/en, ,mixture/en,)/w,；/w,power/en, ,iteration/en, ,clustering/en,(/w,pic/en,)/w,；/w,latent/en, ,dirichlet/en, ,allocation/en,(/w,lda/en,)/w,；/w,流式/nw,k/en,-/w,means/en,./w,12/m,./w,1/m, ,k/en,-/w,meansk/en,-/w,means/en,算法/n,是/v,硬/a,聚类/nw,算法/n,，/w,是/v,典型/n,的/u,基于/p,原型/n,的/u,目标/n,函数/n,聚类/nw,方法/n,的/u,代表/n,，/w,它/r,是/v,数据点/nw,到/v,原型/n,的/u,某种/r,距离/n,作为/v,优化/v,的/u,目标/n,函数/n,，/w,利用/v,函数/n,求/v,极/d,值/n,的/u,方法/n,得到/v,迭代/vn,运算/vn,的/u,调整/vn,规则/n,。/w,聚类/nw,属于/v,无/v,监督/vn,学习/v,，/w,以往/t,的/u,回归/v,、/w,朴素/a,贝叶斯/nr,、/w,svm/en,等/u,都/d,是/v,有/v,类别/n,标签/n,y/en,的/u,，/w,也就是说/l,，/w,样本/n,中/f,已经/d,给/p,出/v,了/u,样本/n,的/u,分类/vn,。/w,而/c,聚类/nw,的/u,样本/n,中/f,却/d,没有/v,给/p,定/v,y/en,，/w,只有/c,特征/n,x/en,，/w,比如/v,假设/v,宇宙/n,中/f,的/u,星星/n,可以/v,表示/v,成/v,三维/nz,空间/n,中点/n,集/vg,(/w,x/en,,/w, ,y/en,,/w, ,z/en,)/w,。/w,聚类/nw,的/u,目的/n,是/v,找到/v,每个/r,样本/n,x/en,潜在/b,的/u,类别/n,y/en,，/w,并/c,将/d,同/p,类别/n,y/en,的/u,样本/n,x/en,放/v,在/p,一起/s,。/w,在/p,聚类/nw,问题/n,中/f,，/w,训练/vn,样本/n,x/en, ,=/w, , ,{/w,x/en,1/m,,/w,x/en,2/m,,/w,./w,./w,./w,,/w,xm/en,}/w,，/w,每个/r,xi/en, ,ε, ,rn/en,，/w,k/en,-/w,means/en,算法/n,是/v,将/d,样本/n,聚类/nw,成/v,k/en,个/q,簇/ng,，/w,具体/a,算法/n,描述/v,如下/v,：/w,1/m,)/w, ,随机/d,选取/v,k/en,个/q,聚类/nw,质心点/nw,为/p,µ,1/m,,/w,µ,2/m,,/w,./w,./w,./w,,/w,µ,k/en, ,ε, ,rn/en,；/w,2/m,)/w, ,重复/v,下面/f,过程/n,直到/v,收敛/vn,。/w,对/p,每/r,一个/m,样本/n,i/en,计算/v,它/r,应该/v,属于/v,的/u,类/q,对于/p,每/r,一个/m,类/q,重新/d,计算/v,该类/r,的/u,质心/nw,k/en,是/v,我们/r,事先/d,给/p,定/v,的/u,聚类数/nw,，/w,ci/en,代表/n,样本/n,i/en,与/p,k/en,个/q,类/q,中/f,距离/n,最近/t,的/u,那个/r,类/q,，/w,ci/en,的/u,值/n,是/v,1/m,到/v,k/en,中/f,的/u,一个/m,。/w,质心/nw,uj/en,代表/n,我们/r,对/p,属于/v,同一/b,个/q,类/q,的/u,样本中心点/nt,的/u,猜测/vn,，/w,拿星团/nw,模型/n,来/v,解释/v,就/d,是/v,要/v,将/d,所有/b,的/u,星星/n,聚/v,成/v,k/en,个/q,星团/n,，/w,首先/d,随机/d,选取/v,k/en,个/q,宇宙/n,中/f,的/u,点/q,(/w,或者/c,k/en,个/q,星星/n,)/w,作为/v,k/en,个/q,星团/n,的/u,质心/nw,，/w,然后/c,第一/m,步/q,对于/p,每/r,一个/m,星星/n,计算/v,其/r,到/v,k/en,个/q,质/ng,心中/s,每/r,一个/m,的/u,距离/n,，/w,接着/c,选取/v,距离/n,最近/t,的/u,那个/r,星团/n,作为/v,ci/en,，/w,这样/r,经过/p,第一/m,步/q,每/r,一个/m,星星/n,都/d,有/v,了/u,所属/n,的/u,星团/n,；/w,第二/m,步/q,对于/p,每/r,一个/m,星团/n,，/w,重新/d,计算/v,它/r,的/u,质心/nw,uj/en,（/w,对/p,里面/f,所有/b,的/u,星星/n,坐标/n,求/v,平均/a,）/w,。/w,重复/v,迭代/vn,第一/m,步/q,和/c,第二/m,步/q,直到/v,质心/nw,不/d,变/v,或者/c,变化/vn,很/d,小/a,。/w,-/w,8/m,演示/vn,了/u,以上/f,过程/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,k/en,-/w,means/en,算法/n,的/u,使用/v,。/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,clustering/en,./w,{/w,kmeans/en,,/w, ,kmeansmodel/en,}/w, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,data/en,//w,mllib/en,//w,kmeans/en,_,data/en,./w,txt/en,"/w,)/w, ,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en,(/w,s/en, ,=/w,>, ,vectors/en,./w,dense/en,(/w,s/en,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,./w,cache/en,(/w,)/w, ,val/en, ,numclusters/en, ,=/w,2/m, ,val/en, ,numiterations/en, ,=/w, ,20/m, ,val/en, ,clusters/en, ,=/w, ,kmeans/en,./w,train/en,(/w,parseddata/en,,/w, ,numclusters/en,,/w, ,numiterations/en,)/w, ,val/en, ,wssse/en, ,=/w, ,clusters/en,./w,computecost/en,(/w,parseddata/en,)/w, ,println/en,(/w,"/w,within/en, ,set/en, ,sum/en, ,of/en, ,squared/en, ,errors/en, ,=/w, ,"/w, ,+/w, ,wssse/en,)/w, ,clusters/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,kmeansmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,12.2/m, ,高斯/nr,混合/vn,k/en,-/w,means/en,的/u,结果/n,是/v,每个/r,数据点/nw,被/p,分配/vn,到/v,其中/r,某/r,一个/m,cluster/en,了/u,，/w,而/c,高斯/nr,混合/vn,则/d,给/p,出/v,这些/r,数据点/nw,被/p,分配/vn,到/v,每个/r,cluster/en,的/u,概率/n,。/w,高斯/nr,混合/vn,的/u,算法/n,与/p,k/en,-/w,means/en,算法/n,类似/v,。/w,mllib/en,中/f,高斯/nr,混合/vn,的/u,使用/v,例子/n,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,clustering/en,./w,gaussianmixture/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,clustering/en,./w,gaussianmixturemodel/en, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,data/en,//w,mllib/en,//w,gmm/en,_,data/en,./w,txt/en,"/w,)/w, ,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en,(/w,s/en, ,=/w,>, ,vectors/en,./w,dense/en,(/w,s/en,./w,trim/en,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,./w,cache/en,(/w,)/w, ,val/en, ,gmm/en, ,=/w, ,new/en, ,gaussianmixture/en,(/w,)/w,./w,setk/en,(/w,2/m,)/w,./w,run/en,(/w,parseddata/en,)/w, ,gmm/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mygmmmodel/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,gaussianmixturemodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mygmmmodel/en,"/w,)/w, ,for/en,(/w,i/en, ,</w,-/w, ,0/m, ,until/en, ,gmm/en,./w,k/en,)/w,{/w, ,println/en,(/w,"/w,weight/en,=/w,%/w,f/en,\/w,nmu/en,=/w,%/w,s/en,\/w,nsigma/en,=/w,\/w,n/en,%/w,s/en,\/w,n/en,"/w, ,format/en, ,(/w,gmm/en,./w,weights/en,(/w,i/en,)/w,,/w, ,gmm/en,./w,gaussians/en,(/w,i/en,)/w,./w,mu/en,,/w, ,gmm/en,./w,gaussians/en,(/w,i/en,)/w,./w,sigma/en,)/w,)/w, ,}/w,12.3/m, ,快速/d,迭代/vn,聚类/nw,快速/d,迭代/vn,聚类/nw,是/v,一种/mq,简单/a,可/v,扩展/v,的/u,图聚/nw,类/q,方法/n,。/w,其/r,使用/v,例子/n,如下/v,：/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,clustering/en,./w,{/w,poweriterationclustering/en,,/w, ,poweriterationclusteringmodel/en,}/w, ,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectors/en, ,val/en, ,similarities/en,:/w, ,rdd/en,[/w,(/w,long/en,,/w, ,long/en,,/w, ,double/en,)/w,]/w, ,=/w, ,./w,./w,./w, ,val/en, ,pic/en, ,=/w, ,new/en, ,poweriterationclustering/en,(/w,)/w,./w,setk/en,(/w,3/m,)/w,./w,setmaxiterations/en,(/w,20/m,)/w, ,val/en, ,model/en, ,=/w, ,pic/en,./w,run/en,(/w,similarities/en,)/w, ,model/en,./w,assignments/en,./w,foreach/en,{/w, ,a/en, ,=/w,>, ,println/en,(/w,s/en,"/w,$/w,{/w,a/en,./w,id/en,}/w, ,-/w,>, ,$/w,{/w,a/en,./w,cluster/en,}/w,"/w,)/w, ,}/w, ,model/en,./w,save/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w, ,val/en, ,samemodel/en, ,=/w, ,poweriterationclusteringmodel/en,./w,load/en,(/w,sc/en,,/w, ,"/w,mymodelpath/en,"/w,)/w,12.4/m, ,latent/en, ,dirichlet/en, ,allocationlatent/en, ,dirichlet/en, ,allocation/en,（/w,lda/en,）/w,是/v,一个/m,三层/mq,贝叶斯概率/nw,模型/n,，/w,包含/v,词/n,、/w,主题/n,和/c,文档/n,三层/mq,结构/n,。/w,文档/n,到/v,主题/n,服从/v,dirichlet/en,分布/v,，/w,主题/n,到/v,词/n,服从/v,多/a,项式/nr,分布/v,。/w,lda/en,是/v,一种/mq,非/h,监督/vn,机器/n,学习/v,技术/n,，/w,可以/v,用/p,来/v,识别/v,大规模/b,文档/n,集/vg,或/c,语料库/n,中/f,潜藏/v,的/u,主题/n,信息/n,。/w,它/r,采用/v,了/u,词袋/nw,的/u,方法/n,，/w,这种/r,方法/n,将/d,每/r,一篇/mq,文档/n,视为/v,一个/m,词频/n,向量/n,，/w,从而/c,将/d,文本/n,信息/n,转化/v,为了/p,易于/v,建模/vn,的/u,数字/n,信息/n,。/w,但是/c,词袋/nw,方法/n,没有/v,考虑/v,词/n,与/p,词/n,之间/f,的/u,顺序/n,，/w,这/r,简化/v,了/u,问题/n,的/u,复杂性/n,，/w,同时/c,也/d,为/p,模型/n,的/u,改进/v,提供/v,了/u,契机/n,。/w,每/r,一篇/mq,文档/n,代表/n,了/u,一些/m,主题/n,所/u,构成/v,的/u,一个/m,概率/n,分布/v,，/w,而/c,每/r,一个/m,主题/n,又/d,代表/n,了/u,很多/m,单词/n,所/u,构成/v,的/u,一个/m,概率/n,分布/v,。/w,由于/c,dirichlet/en,分布/v,随机/d,向/p,量/n,各/r,分量/n,间/f,的/u,弱/a,相关性/n,(/w,之所以/c,还有/v,点/q,“/w,相关/v,”/w,，/w,是/v,因为/c,各/r,分量/n,之/u,和/c,必须/d,为/p,1/m,)/w,，/w,使得/v,我们/r,假/a,想/v,的/u,潜在/b,主题/n,之间/f,也/d,几乎/d,是/v,不/d,相关/v,的/u,，/w,这/r,与/p,很多/m,实际/n,问题/n,并/c,不/d,相符/v,，/w,从而/c,造成/v,了/u,lda/en,的/u,又/d,一个/m,遗留/vn,问题/n,。/w,对于/p,语料库/n,中/f,的/u,每篇/r,文档/n,，/w,lda/en,定义/n,了/u,如下/v,生成/vn,过程/n,：/w,1/m,)/w, ,对/p,每/r,一篇/mq,文档/n,，/w,从/p,主题/n,分布/v,中/f,抽取/vn,一个/m,主题/n,；/w,2/m,)/w, ,从/p,上述/b,被/p,抽/v,到/v,的/u,主题/n,所/u,对应/v,的/u,单词/n,分布/v,中/f,抽取/vn,一个/m,单词/n,；/w,3/m,)/w, ,重复/v,上述/b,过程/n,直至/v,遍历/nw,文档/n,中/f,的/u,每/r,一个/m,单词/n,。/w,下例/nw,演示/vn,了/u,lda/en,的/u,使用/v,。/w,12.5/m, ,流式/nw,k/en,-/w,means/en,当/p,数据/n,流/v,到达/v,，/w,我们/r,可能/v,想/v,要/v,动态/n,地/u,估算/v,cluster/en,，/w,并/c,更新/v,它们/r,。/w,该/r,算法/n,采用/v,了/u,小批量/n,的/u,k/en,-/w,means/en,更新/v,规则/n,。/w,对/p,每/r,一批/mq,数据/n,，/w,将/d,所有/b,的/u,点/q,分配/vn,到/v,最近/t,的/u,cluster/en,，/w,并/c,计算/v,最/d,新/a,的/u,cluster/en,中心/n,，/w,然后/c,更新/v,每个/r,cluster/en,的/u,公式/n,为/p,：/w,ci/en,是/v,前/f,一次/mq,计算/v,得到/v,的/u,cluster/en,中心/n,，/w,ni/en,是/v,已经/d,分配/vn,到/v,cluster/en,的/u,点数/n,，/w,xi/en,是/v,从/p,当前/t,批次/n,得到/v,的/u,cluster/en,的/u,新/a,中心/n,，/w,mi/en,是/v,当前/t,批次/n,加入/v,cluster/en,的/u,点数/n,。/w,衰减/vn,因子/n,a/en,可/v,被/p,用于/v,忽略/v,过去/t,的/u,数据/n,；/w,a/en,=/w,1时/t,所有/b,数据/n,都/d,从/p,一/m,开始/v,就/d,被/p,使用/v,；/w,a/en,=/w,0时/t,只有/c,最近/t,的/u,数据/n,将/d,被/p,使用/v,。/w,这/r,类似/v,于/p,一个/m,指数/n,加权/v,移动/vn,平均值/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,流失/vn,k/en,-/w,means/en,的/u,使用/v,。/w,13/m,./w, ,维数/nr,减缩/v,维数/nr,减缩/v,是/v,减少/v,所/u,考虑/v,变量/n,的/u,数量/n,的/u,过程/n,。/w,维数/nr,减缩/v,有/v,两种/mq,方式/n,：/w,奇异值/nw,分解/v,；/w,主/n,成分/n,分析/vn,。/w,13.1/m, ,奇异值/nw,分解/v,奇异值/nw,分解/v,将/d,一个/m,矩阵/n,因子/n,分解/v,为/p,三个/m,矩阵/n,u/en,、/w,Σ, ,和/c, ,v/en,：/w,其中/r,u/en,是/v,正交/nw,矩阵/n,，/w,其/r,列/v,被/p,称为/v,左/f,奇异/a,向量/n,；/w,Σ,是/v,对角/n,矩阵/n,，/w,其/r,对角线/n,是非/n,负/v,的/u,且/c,以/p,降/v,序/n,排列/v,，/w,因此/c,被/p,称为/v,奇异值/nw,；/w,v/en,也/d,是/v,正交/nw,矩阵/n,，/w,其/r,列/v,被/p,称为/v,右/f,奇异/a,向量/n,。/w,对于/p,大/a,的/u,矩阵/n,，/w,除了/p,顶部/f,奇异值/nw,和/c,它/r,的/u,关联/vn,奇异值/nw,，/w,我们/r,不/d,需要/v,完全/ad,分解/v,。/w,这样/r,可以/v,节省/v,存储/vn,、/w,去/v,噪声/n,和/c,恢复/v,矩阵/n,的/u,低秩/nw,结构/n,。/w,如果/c,我们/r,保持/v,前/f,7个/m,顶部/f,奇异值/nw,，/w,那么/r,最终/d,的/u,低秩/nw,矩阵/n,为/p,：/w,假设/v,n/en,小于/v,m/en,。/w,奇异值/nw,和/c,右奇/nw,异值/nw,向/p,量/n,来源于/v,特征/n,值/n,和/c,gramian/en,矩阵/n,a/en,τ,a/en,的/u,特征/n,向量/n,。/w,矩阵/n,存储/vn,左/f,奇异/a,向量/n,u/en,，/w,通过/p,矩阵/n,乘法/n,u/en, ,=/w, ,a/en,(/w,vs/en,-/w,1/m,)/w,计算/v,。/w,使用/v,的/u,实际/n,方法/n,基于/p,计算/v,成本/n,自动/d,被/p,定义/n,：/w,1/m,)/w, ,如果/c,(/w,n/en, ,</w, ,100/m,)/w, ,或者/c,(/w,k/en, ,>, ,n/en,//w,2/m,)/w,，/w,我们/r,首先/d,计算/v,gramian/en,矩阵/n,，/w,然后/c,再/d,计算/v,其/r,顶部/f,特征/n,向/p,量/n,并/c,将/d,特征/n,向/p,量/n,本地化/v,到/v,driver/en,。/w,这/r,需要/v,单次/nw,传递/v,，/w,在/p,每个/r,executor/en,和/c,driver/en,上/f,使用/v,o/en,(/w,n/en,2/m,)/w,的/u,存储/vn,，/w,并/c,花费/v,driver/en,上/f,o/en,(/w,n/en,2/m,k/en,)/w,的/u,时间/n,。/w,2/m,)/w, ,否则/c,，/w,将/d,使用/v,分布/v,式/k,的/u,方式/n,计算/v,a/en,τ,a/en,的/u,值/n,，/w,并且/c,发送/v,给/p,arpack/en,计算/v,顶部/f,特征/n,向量/n,。/w,这/r,需要/v,o/en,(/w,k/en,)/w,次/q,传递/v,，/w,每个/r,executor/en,上/f,使用/v,o/en,(/w,n/en,)/w,的/u,存储/vn,，/w,在/p,driver/en,上/f,使用/v,o/en,(/w,nk/en,)/w,的/u,存储/vn,。/w,下面/f,的/u,例子/n,演示/vn,了/u,svd/en,的/u,使用/v,。/w,13.2/m, ,主/n,成分/n,分析/vn,主/n,成分/n,分析/vn,是/v,一种/mq,统计/v,方法/n,，/w,此/r,方法/n,找到/v,一个/m,旋转/v,，/w,使得/v,第一/m,坐标/n,具有/v,可能/v,的/u,最/d,大/a,方差/nr,，/w,并且/c,每个/r,随后/d,的/u,坐标/n,都/d,具有/v,可能/v,的/u,最/d,大/a,方差/nr,。/w,旋转/v,矩阵/n,的/u,列/v,被/p,称为主/nw,成分/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,使用/v,rowmatrix/en,计算/v,主/n,成分/n,。/w,14/m,./w, ,特征/n,提取/v,与/p,转型/vn,14.1/m, ,术语/n,频率/n,反/v,转/v,术语/n,频率/n,反转/v,是/v,一个/m,反映/v,文集/n,的/u,文档/n,中/f,的/u,术语/n,的/u,重要性/n,，/w,广泛/a,应用/vn,于/p,文本/n,挖掘/v,的/u,特征/n,矢量化/nw,方法/n,。/w,术语/n,表示/v,为/p,t/en,，/w,文档/n,表示/v,为/p,d/en,，/w,文集/n,表示/v,为/p,d/en,。/w,术语/n,频率/n,tf/en,(/w,t/en,,/w,d/en,)/w,表示/v,术语/n,t/en,在/p,文档/n,d/en,中/f,出现/v,的/u,频率/n,，/w,文档/n,频率/n,df/en,(/w,t/en,,/w, ,d/en,)/w,表示/v,包含/v,术语/n,t/en,的/u,文档/n,数量/n,。/w,如果/c,我们/r,仅/d,使用/v,术语/n,频率/n,来/v,测量/vn,重要性/n,，/w,则/d,很/d,容易/a,过度/d,强调/v,术语/n,出现/v,的/u,很/d,频繁/a,，/w,而/c,携带/v,的/u,关于/p,文档/n,的/u,信息/n,很/d,少/a,，/w,例如/v,a/en,、/w,the/en, ,和/c,of/en,等/u,。/w,如果/c,术语/n,非常/d,频繁/a,地/u,跨/v,文集/n,出现/v,，/w,这/r,意味着/v,它/r,并/c,没有/v,携带/v,文档/n,的/u,特定/b,信息/n,。/w,反转/v,文档/n,频率/n,是/v,一个/m,术语/n,提供/v,了/u,多少/r,信息/n,的/u,数值/n,度量/v,：/w,|/w,d/en,|/w, ,表示/v,文集/n,中/f,的/u,文档/n,总数/n,。/w,因为/c,使用/v,了/u,对数/n,，/w,如果/c,一个/m,术语/n,出现/v,于/p,所有/b,的/u,文档/n,中/f,，/w,它/r,的/u,idf/en,值/n,变/v,0/m,。/w,需要/v,注意/v,的/u,是/v,，/w,应用/vn,一个/m,平滑/an,项/q,，/w,以/p,避免/v,被/p,零除/nw,。/w,tf/en,-/w,idf/en,方法/n,基于/p,tf/en,与/p,idf/en,，/w,它/r,的/u,公式/n,如下/v,：/w,这里/r,有/v,一些/m,术语/n,频率/n,和/c,文档/n,频率/n,定义/n,的/u,变种/n,。/w,在/p,mllib/en,中/f,，/w,为了/p,使/v,tf/en,和/c,idf/en,更/d,灵活/a,，/w,将/d,它们/r,分开/v,了/u,，/w,mllib/en,实现/v,术语/n,频率/n,时/ng,使用/v,了/u,哈希/nr,。/w,应用/vn,欧冠哈希函数/nw,将/d,原始/a,特征/n,映射/v,到/v,了/u,索引/n,(/w,术语/n,)/w,，/w,术语/n,频率/n,因此/c,依赖/v,于/p,map/en,的/u,索引/n,计算/v,。/w,这种/r,方法/n,避免/v,了/u,需要/v,计算/v,一个/m,全局/n,术语/n,到/v,索引图/nw,，/w,这/r,对于/p,大型/b,语料库/n,开销/v,会/v,很/d,大/a,。/w,但/c,由于/c,不同/a,的/u,原始/a,特征/n,在/p,哈希后/nr,可能/v,变为/v,同样/d,的/u,术语/n,，/w,所以/c,存在/v,潜在/b,的/u,哈希/nrf,冲突/vn,。/w,为了/p,降低/v,碰撞/vn,的/u,机会/n,，/w,我们/r,可以/v,增加/v,目标/n,特征/n,的/u,维度/n,(/w,即/v,哈希表/nr,中/f,的/u,桶/q,数/m,)/w,。/w,默认/v,的/u,特征/n,维度/n,是/v,220/m, ,=/w, ,1048576/m,./w,下面/f,的/u,例子/n,演示/vn,了/u,hashingtf/en,的/u,使用/v,。/w,14.2/m, ,单词/n,向/p,量/n,转换/v,word/en,2/m,vec/en,计算/v,由/p,单词/n,表示/v,的/u,分布式/b,向量/n,。/w,分布式/b,表征/v,的/u,主要/b,优点/n,是/v,，/w,类似/v,的/u,单词/n,在/p,矢量/n,空间/n,是/v,接近/v,的/u,，/w,这/r,使得/v,泛化/nw,小说/n,模式/n,更/d,容易/a,和/c,模型/n,估计/v,更/d,稳健/ad,。/w,分布式/b,向量/n,表示/v,被/p,证实/v,在/p,许多/m,自然/d,语言/n,处理/v,应用/vn,中/f,有用/a,，/w,例如/v,，/w,命名/v,实体/n,识别/v,、/w,消歧/nw,、/w,解析/v,、/w,标记/n,和/c,机器/n,翻译/v,。/w,mllib/en,的/u,word/en,2/m,vec/en,实现/v,采用/v,了/u,skip/en,-/w,gram/en,模型/n,。/w,skip/en,-/w,gram/en,的/u,训练/vn,目标/n,是/v,学习/v,单词/n,的/u,向量/n,表示/v,，/w,其/r,善于/v,在/p,同一个/r,句子/n,预测/v,其/r,上下文/n,。/w,给/p,定/v,了/u,单词/n,序列/n,w/en,1/m,，/w,w/en,2/m,，/w,./w,./w,./w,，/w,w/en,τ,，/w,skip/en,-/w,gram/en,模型/n,的/u,目标/n,是/v,最大化/v,平均/a,对数/n,似然/nw,，/w,公式/n,如下/v,：/w,其中/r,k/en,是/v,训练/vn,窗口/s,的/u,大小/n,。/w,每个/r,单词/n,w/en,与/p,两个/m,向/p,量/n,uw/en,和/c,vw/en,关联/vn,，/w,并且/c,由/p,单独/d,的/u,向量/n,来/v,表示/v,。/w,通过/p,给/p,定/v,的/u,单词/n,wj/en,正确/a,预测/v,wi/en,的/u,概率/n,是/v,由/p,softmax/en,模型/n,决定/v,的/u,。/w,softmax/en,模型/n,如下/v,：/w,w/en,表示/v,词汇量/n,。/w,由于/c,计算/v,logp/en,(/w,wi/en,|/w,wj/en,)/w,的/u,成本/n,与/p,v/en,成/v,正比/n,(/w,v/en,很/d,容易/a,就/d,达到/v,百万/nw,以上/f,)/w,，/w,所以/c,softmax/en,这种/r,skip/en,-/w,gram/en,模型/n,是/v,很/d,昂贵/a,的/u,。/w,为了/p,加速/v,word/en,2/m,vec/en,计算/v,，/w,mllib/en,使用/v,分级/v,softmax/en,，/w,它/r,可以/v,减少/v,计算/v,logp/en,(/w,wi/en,|/w,wj/en,)/w, ,复杂/a,度/q,到/v,o/en,(/w,log/en,(/w,v/en,)/w,)/w,。/w,下面/f,的/u,例子/n,演示/vn,了/u,word/en,2/m,vec/en,的/u,使用/v,，/w,14.3/m, ,标准/n,尺度/n,通过/p,缩放/v,到/v,单位/n,方差/nr,和/c,//w,或/c,通过/p,在/p,训练/vn,集/vg,的/u,样本/n,上/f,使用/v,列/v,摘要/n,统计/v,溢/v,出/v,均值/n,使/v,特征/n,标准化/vn,，/w,这/r,是/v,常见/a,的/u,预/d,处理/v,步骤/n,。/w,例如/v,，/w,当/p,所有/b,的/u,特征/n,都/d,有/v,单位/n,方差/nr,和/c,//w,或/c,零均值/nw,时/ng,，/w,支持/v,向/p,量机/nw,的/u,rbf/en,核/n,或者/c,l/en,1/m,和/c,l/en,2/m,正规化线性/nw,模型/n,通常/d,能/v,更/d,好/a,地/u,工作/vn,。/w,标准化/vn,可以/v,提高/v,在/p,优化/v,过程/n,中/f,的/u,收敛/vn,速度/n,，/w,并且/c,还/d,可以/v,防止/v,在/p,模型/n,训练/vn,期间/f,，/w,非常/d,大/a,的/u,差异/n,会/v,对/p,特征/n,发挥/v,过/u,大/a,的/u,影响/vn,。/w,standardscaler/en,的/u,构造器/nz,有/v,两个/m,参数/n,：/w,withmean/en,：/w,默认/v,false/en,。/w,用于/v,缩放/v,前求/nw,均值/n,，/w,这/r,将/d,建立/v,一个/m,密集/a,的/u,输出/v,，/w,所以/c,不/d,能/v,在/p,稀疏/a,输入/v,上/f,正常/a,工作/vn,，/w,并/c,将/d,引发/v,异常/a,。/w,withstd/en,：/w,默认/v,true/en,。/w,缩放/v,数据/n,到/v,标准/n,单位/n,误差/n,。/w,以下/f,例子/n,演示/vn,了/u,standardscaler/en,的/u,使用/v,。/w,14.4/m, ,正规化/vn,尺度/n,正规化/vn,尺度/n,把/p,样本/n,划分/v,为/p,单位/n,lp/en,范式/n,，/w,即/v,维度/n,。/w,这/r,是/v,一种/mq,常见/a,的/u,对/p,文本/n,分类/vn,或/c,集群化/nw,的/u,操作/v,。/w,例如/v,，/w,两个/m,l/en,2/m,正规化/vn,tf/en,-/w,idf/en,向量/n,的/u,点积/nw,是/v,这些/r,向量/n,的/u,余弦近似值/nw,。/w,设/v,二维/nr,空间/n,内/f,有/v,两个/m,向/p,量/n,a/en,和/c,b/en,，/w,它们/r,的/u,夹角/n,为/p,θ,(/w,0/m,≤/w,θ≤/nw,π/w,)/w,，/w,则/d,点积/nw,定义/n,为/p,以下/f,实数/n,：/w,mllib/en,提供/v,normalizer/en,支持/v,正规化/vn,，/w,normalizer/en,有/v,以下/f,构造/v,参数/n,：/w,p/en,:/w, ,正规化/vn,到/v,lp/en,空间/n,，/w,默/vd,认为/v,2/m,。/w,下面/f,的/u,例子/n,演示/vn,了/u,normalizer/en,的/u,使用/v,。/w,14.5/m, ,卡方/nr,特征/n,选择器/nw,chisqselector/en,用于/v,卡方/nr,特征/n,选择/v,。/w,它/r,运转/v,在/p,具有/v,分类/vn,特征/n,的/u,标签/n,数据/n,上/f,。/w,chisqselector/en,对/p,基于/p,分类/vn,进行/v,独立/v,卡方/nr,测试/vn,的/u,特征/n,排序/vn,，/w,并且/c,过滤/v,(/w,选择/v,)/w,最/d,接近/v,标签/n,的/u,顶部/f,特征/n,。/w,chisqselector/en,有/v,以下/f,构造器/nz,参数/n,：/w,numtopfeatures/en,：/w,选择器/nw,将要/d,过滤/v,(/w,选择/v,)/w,的/u,顶部/f,特征/n,数量/n,。/w,下边/f,的/u,例子/n,演示/vn,了/u,chisqselector/en,的/u,使用/v,。/w,14.6/m, ,hadamard/en,积/v,elementwiseproduct/en,采用/v,逐个/d,相乘/v,的/u,方式/n,，/w,使用/v,给/p,定/v,的/u,权重/nz,与/p,每个/r,输入/v,向量/n,相/d,乘/v,。/w,换言之/c,，/w,它/r,采用/v,一个/m,标量/n,乘/v,法器/n,扩展/v,数据集/nw,的/u,每/r,一列/mq,。/w,这/r,表示/v,hadamard/en,积/v,对/p,输入/v,向量/n,v/en,，/w,使用/v,转换/v,向量/n,w/en,，/w,最终/d,生成/vn,一个/m,结果/n,向量/n,。/w,hadamard/en,积/v,可/v,由/p,以下/f,公式/n,表示/v,：/w,elementwiseproduct/en,的/u,构造器/nz,参数/n,为/p,：/w,w/en,：/w,转换/v,向/p,量/n,。/w,下面/f,代码/n,演示/vn,了/u,elementwiseproduct/en,的/u,使用/v,。/w,15/m,./w, ,频繁/a,模式/n,挖掘/v,分析/vn,大规模/b,数据集/nw,的/u,第一/m,个/q,步骤/n,通常/d,是/v,挖掘/v,频繁/a,项目/n,、/w,项目/n,集/vg,、/w,亚/j,序列/n,或/c,其他/r,子结构/nw,，/w,这/r,在/p,数据/n,挖掘/v,中/f,作为/v,一个/m,活跃/v,的/u,研究/vn,主题/n,已/d,多年/m,了/u,。/w,其/r,数学/n,原理/n,读者/n,可以/v,取维基/nr,百科/n,了解/v,。/w,mllib/en,提供/v,了/u,频繁/a,模式/n,挖掘/v,的/u,并行/v,实现/v,——/w,fp/en,-/w,growth/en,算法/n,。/w,fp/en,-/w,growth/en,给/p,定/v,一个/m,交易/n,数据集/nw,，/w,fp/en,-/w,growth/en,的/u,第一/m,步骤/n,是/v,计算/v,项目/n,的/u,频率/n,，/w,并/c,确定/v,频繁/a,项目/n,。/w,fp/en,-/w,growth/en,虽然/c,与/p,apriori/en,类/q,算法/n,有/v,相同/a,的/u,设计/vn,目的/n,，/w,但是/c,fp/en,-/w,growth/en,的/u,第二/m,步/q,使用/v,后/f,缀/v,树/v,(/w,fp/en,树/v,)/w,结构/n,对/p,交易/n,数据/n,编码/n,且/c,不/d,会/v,显式/nw,生成/vn,候选集/nw,(/w,生成/vn,候选集/nw,通常/d,开销/v,很/d,大/a,)/w,。/w,第二/m,步/q,之后/f,，/w,就/d,可以/v,从/p,fp/en,树/v,中/f,抽取/vn,频繁/a,项目/n,集/vg,。/w,mllib/en,中/f,实现/v,了/u,fp/en,-/w,growth/en,的/u,平行/vn,版本/n,，/w,叫做/v,pfp/en,。/w,pfp/en,可以/v,将/d,fp/en,-/w,growth/en,的/u,工作/vn,分发/v,到/v,其他/r,机器/n,，/w,比/p,单机/n,运行/vn,有/v,更/d,好/a,的/u,扩展性/n,。/w,fpgrowth/en,有/v,以下/f,参数/n,：/w,minsupport/en,：/w,项目/n,集/vg,被/p,确定/v,为/p,频繁/a,的/u,最小/a,数量/n,。/w,numpartitions/en,：/w,分发/v,任务/n,的/u,数量/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,fpgrowth/en,的/u,使用/v,。/w,16/m,./w, ,预言/n,模型/n,标记/n,语言/n,预言/n,模型/n,标记/n,是/v,一种/mq,基于/p,xml/en,的/u,语言/n,，/w,它/r,能够/v,定义/n,和/c,共享/v,应用/vn,程序/n,之间/f,的/u,预测/v,模型/n,。/w,mllib/en,支持/v,将/d,模型/n,导出/v,为/p,预言/n,模型/n,标记/n,语言/n,。/w,表/n,11/m,-/w,6/m,列出/v,了/u,mllib/en,模型/n,导出/v,为/p,pmml/en,的/u,相应/v,模型/n,。/w,下面/f,的/u,例子/n,演示/vn,了/u,将/d,kmeamsmodel/en,导出/v,为/p,pmml/en,格式/n,。/w,17/m,./w, ,管道/n,spark/en,1.2/m,增加/v,了/u,一个/m,新包/nw,spark/en,./w,ml/en,，/w,目的/n,是/v,提供/v,一套/mq,高/a,层次/n,的/u,api/en,，/w,帮助/v,用户/n,创建/v,、/w,调试/v,机器/n,学习/v,的/u,管道/n,。/w,spark/en,./w,ml/en,的/u,标准化/vn,api/en,用于/v,将/d,多种/m,机器/n,学习/v,算法/n,组合/v,到/v,一个/m,管道/n,或/c,工作流/nz,中/f,。/w,下面/f,列出/v,了/u,spark/en, ,ml/en, ,api/en,的/u,主要/b,概念/n,：/w,ml/en, ,dataset/en,：/w,由/p,hive/en, ,table/en,或者/c,数据源/nz,的/u,数据/n,构成/v,的/u,可/v,容纳/v,各种/r,数据/n,类型/n,的/u,dataframe/en,作为/v,数据集/nw,。/w,例如/v,，/w,数据集/nw,可以/v,由/p,不同/a,的/u,列/v,分别/d,存储/vn,文本/n,、/w,特征/n,向量/n,、/w,标签/n,和/c,预测值/n,。/w,transformer/en,：/w,是/v,一种/mq,将/d,dataframe/en,转换/v,为/p,另/r,一个/m,dataframe/en,的/u,算法/n,。/w,例如/v,，/w,ml/en,模型/n,是/v,一个/m,将/d,特征/n,rdd/en,转换/v,为/p,预测值/n,rdd/en,的/u,transformer/en,。/w,estimator/en,：/w,适用/v,于/p,dataframe/en,，/w,并/c,生成/vn,一个/m,transformer/en,。/w,例如/v,，/w,学习/v,算法/n,是/v,一个/m,在/p,数据集/nw,上/f,训练/vn,并/c,生成/vn,一个/m,模型/n,的/u,estimator/en,。/w,pipeline/en,：/w,链接/n,多/a,个/q,transformer/en,和/c,estimator/en,，/w,一起/s,构成/v,ml/en,的/u,工作流/nz,。/w,param/en,：/w,所有/b,transformer/en,和/c,estimator/en,用于/v,指定/v,参数/n,的/u,通用/vn,api/en,。/w,17.1/m, ,管道/n,工作/vn,原理/n,机器/n,学习/v,中/f,，/w,运行/vn,一系列/mq,的/u,算法/n,取/v,处理/v,数据/n,或者/c,从/p,数据/n,学习/v,的/u,场景/n,是/v,很/d,常见/a,的/u,。/w,例如/v,，/w,一个/m,简单/a,的/u,文本/n,文档/n,处理/v,工作/vn,流/v,可能/v,包含/v,以下/f,阶段/n,：/w,1/m,)/w, ,将/d,文档/n,文本/n,切分/v,成/v,单词/n,；/w,2/m,)/w, ,将/d,文档/n,的/u,单词/n,转换/v,为数字化/nw,的/u,特征/n,向量/n,；/w,3/m,)/w, ,使用/v,特征/n,向量/n,和/c,标签/n,学习/v,一个/m,预测/v,模型/n,。/w,spark/en, ,ml/en,以/p,一系列/mq,按/p,序/n,运行/vn,的/u,pipelinestage/en,组成/v,的/u,管道/n,来/v,表示/v,这样/r,的/u,工作流/nz,。/w,这/r,一系列/mq,的/u,stage/en,要么/c,是/v,transformer/en,，/w,要么/c,是/v,estimator/en,。/w,数据集/nw,通过/p,管道/n,中/f,的/u,每个/r,stage/en,都/d,会/v,被/p,修改/v,。/w,比如/v,transformer/en,的/u,transform/en,(/w,)/w,方法/n,将/d,在/p,数据集/nw,上/f,被/p,调用/v,，/w,estimator/en,的/u,fit/en,(/w,)/w,方法/n,被/p,调用/v,生成/vn,一个/m,transformer/en,，/w,然后/c,此/r,transformer/en,的/u,transform/en,(/w,)/w,方法/n,也/d,将/d,在/p,数据集/nw,上/f,被/p,调用/v,。/w,-/w,9/m,展示/v,了/u,简单/a,文本/n,文档/n,工作/vn,流例子/nw,使用/v,管道/n,的/u,处理/v,流程/n,。/w,-/w,9/m,说明/v,整个/b,管道/n,由/p,3个/m,stage/en,组成/v,。/w,tokenizer/en,和/c,hashingtf/en,都/d,是/v,transformer/en,，/w,logisticregression/en,是/v,estimator/en,。/w,每个/r,圆柱/n,体都/nw,说明/v,它/r,本身/r,是/v,一个/m,dataframe/en,。/w,整个/b,处理/v,流程/n,如下/v,：/w,1/m,)/w, ,在/p,由/p,原生/b,文本/n,文档/n,构成/v,的/u,原始/a,数据集/nw,上/f,应用/vn,pipeline/en,./w,fit/en,(/w,)/w,方法/n,。/w,2/m,)/w, ,tokenizer/en,./w,transform/en,(/w,)/w,将/d,原生/b,文本/n,文档/n,切分/v,为/p,单词/n,，/w,并/c,向/p,数据集/nw,增加/v,单词/n,列/v,。/w,3/m,)/w, ,hashingtf/en,./w,transform/en,(/w,)/w,将/d,单词/n,列/v,转换/v,为/p,特征/n,向量/n,，/w,并/c,向/p,数据集/nw,增加/v,向量/n,列/v,。/w,4/m,)/w, ,因为/c,logisticregression/en,是/v,estimator/en,，/w,所以/c,管道/n,第一/m,次/q,调用/v,logisticregression/en,./w,fit/en,(/w,)/w,生成/vn,了/u,logisticregressionmodel/en,。/w,如果/c,管道/n,中/f,还有/v,更/d,多/a,的/u,stage/en,，/w,将/d,会/v,传递/v,数据集/nw,到/v,下/f,一个/m,stage/en,之前/f,在/p,数据集/nw,上/f,调用/v,logisticregressionmodel/en,的/u,transform/en,(/w,)/w,。/w,管道/n,本身/r,是/v,一个/m,estimator/en,。/w,因此/c,调用/v,pipeline/en,的/u,fit/en,(/w,)/w,方法/n,最后/f,生成/vn,了/u,pipelinemodel/en,，/w,pipelinemodel/en,也/d,是/v,一个/m,transformer/en,。/w,这个/r,pipelinemodel/en,会/v,在/p,测试/vn,时间/n,使用/v,，/w,测试/vn,过程/n,如/v,-/w,10/m,所示/nz,。/w,-/w,10/m,说明/v,pipelinemodel/en,的/u,测试/vn,过程/n,与/p,-/w,9/m,的/u,管道/n,有/v,相同/a,的/u,stage/en,数量/n,。/w,但是/c,-/w,9/m,的/u,管道/n,中/f,的/u,所有/b,estimator/en,在/p,此时/r,都/d,已经/d,变为/v,transformer/en,。/w,当/p,在/p,测试/vn,数据集/nw,上/f,调用/v,pipelinemodel/en,的/u,transform/en,(/w,)/w,方法/n,时/ng,，/w,数据/n,在/p,管道/n,中/f,按/p,序/n,通过/p,。/w,每个/r,stage/en,的/u,transform/en,(/w,)/w,方法/n,都/d,会/v,更新/v,数据集/nw,，/w,并/c,将/d,数据集/nw,传递/v,给/p,下/f,一个/m,stage/en,。/w,刚才/t,介绍/v,的/u,例子/n,中/f,，/w,管道/n,是/v,线性/n,的/u,，/w,即/v,每个/r,stage/en,都/d,使用/v,由/p,上/f,一个/m,stage/en,生产/vn,的/u,数据/n,。/w,只要/c,数据/n,流图/nw,构成/v,了/u,dag/en,，/w,它/r,就/d,有/v,可能/v,不/d,是/v,线性/n,的/u,。/w,如果/c,管道/n,构成/v,了/u,dag/en,，/w,那么/r,这些/r,stage/en,就/d,必须/d,指定/v,拓扑/n,顺序/n,。/w,17.2/m, ,管道/n,api/en,介绍/v,spark/en, ,ml/en,的/u,transformer/en,和/c,estimator/en,指定/v,参数/n,具有/v,统一/vn,的/u,api/en,。/w,有/v,两种/mq,方式/n,指定/v,参数/n,：/w,给/p,实例/n,设置/v,参数/n,。/w,例如/v,，/w,ir/en,是/v,logisticregression/en,的/u,实例/n,，/w,可以/v,调用/v,lr/en,./w,setmaxiter/en,(/w,10/m,)/w,使得/v,调用/v,lr/en,./w,fit/en,(/w,)/w,时/ng,最/d,多/a,迭代/vn,10次/mq,。/w,传递/v,parammap/en,给/p,fit/en,(/w,)/w,或者/c,transform/en,(/w,)/w,方法/n,。/w,通过/p,这种/r,方式/n,指定/v,的/u,参数/n,值/n,将/d,会/v,覆盖/v,