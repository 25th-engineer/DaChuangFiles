本来/d,这个/r,公众/n,号/q,的/u,交流/vn,消息/n,中间/f,件/q,相关/v,的/u,技术/n,的/u,。/w,这/r,周/nr,去/v,上海/ns,参加/v,了/u,qcon/en,，/w,第一/m,次/q,参加/v,这样/r,的/u,技术/n,会议/n,，/w,感受/v,挺/d,多/a,的/u,，/w,所以/c,整理/v,一下/m,自己/r,的/u,一些/m,想法/n,接/v,公众/n,号/q,和/c,大家/r,交流/vn,一下/m,。/w,下面/f,进入/v,正题/n,，/w,从/p,自己/r,参加/v,了/u,的/u,一些/m,分享/v,中/f,挑/v,一些/m,有趣/a,的/u,议题/n,来/v,和/c,大家/r,讨论/v,。/w,《/w,“/w,深蓝/b,”/w,20年/t,之后/f,的/u,人工智能/n,》/w,2017年/t,可以/v,说是/v,人工智能/n,的/u,元年/t,了/u,，/w,alphago/en,战胜/v,李世石/nr,然/r,人工智能/n,一下/m,进入/v,了/u,大众/n,的/u,视野/n,。/w,之后/f,以/p,master/en,的/u,身份/n,60/m,连胜/q,，/w,接着/c,战胜/v,长期/d,世界/n,排名/v,第一/m,的/u,柯洁/nr,，/w,qcon/en,期间/f,alphago/en, ,zero/en,通过/p,3天/mq,自学/v,的/u,方式/n,就/d,以/p,100/m,:/w,0/m,的/u,方式/n,战胜/v,了/u,alphago/en,，/w,可以/v,说/v,在/p,棋类/n,领域/n,人类/n,对/p,人工智能/n,已经/d,没有/v,任何/r,胜/v,算/v,了/u,。/w,这次/r,qcon/en,，/w,复旦大学/nt,的/u,危辉/nr,教授/n,从/p,人工智能/n,的/u,历史/n,说/v,起/v,，/w,之后/f,从/p,人工智能/n,的/u,问题/n,域/ng,、/w,解题/v,步骤/n,步步/q,深入/v,，/w,清晰/a,的/u,描述/v,了/u,目前/t,人工智能/n,领域/n,的/u,进展/vn,。/w,危辉/nr,教授/n,的/u,《/w,“/w,深蓝/b,”/w,20年/t,之后/f,的/u,人工智能/n,》/w,分享/v,可能/v,从/p,听众/n,的/u,感受/v,上/f,有/v,点/q,“/w,反/v,”/w,人工智能/n,热潮/n,，/w,但是/c,我/r,认为/v,这/r,场/q,分享/v,是/v,给/p,人工智能/n,的/u,门外/s,的/u,我们/r,一个/m,很/d,好/a,的/u,入门/v,介绍/v,，/w,让/v,我们/r,明白/v,目前/t,人工智能/n,领域/n,的/u,发展/vn,状况/n,，/w,让/v,我们/r,对/p,遍地/vd,的/u,人工智能/n,现象/n,有/v,一个/m,清晰/a,的/u,任务/n,。/w,另外/c,危辉/nr,教授/n,演讲/v,的/u,逻辑性/n,、/w,严谨性/nw,和/c,现场/s,把/p,控/v,能力/n,，/w,真的/d,是/v,单/d,从/p,一场/mq,分享/v,能/v,感受/v,到/v,功底/n,的/u,深厚/a,。/w,这/r,场/q,分享/v,的/u,ppt/en,没/d,能/v,从/p,qcon/en,网站/n,上/f,下载/v,到/v,，/w,并/c,不能/v,回忆/v,起/v,很多/m,具体/a,的/u,分享/v,内容/n,，/w,以上/f,是/v,个人/n,现场/s,感受/v,的/u,一些/m,体验/vn,。/w,《/w,免费/v,的/u,性能/n,午餐/v,——/w,alibaba/en, ,jdk/en,协程/nw,》/w,这/r,一场/mq,是/v,阿里巴巴技术/nt,专家/n,郁磊/nr,带来/v,关于/p,alibaba/en, ,jdk/en,协程/nw,的/u,介绍/v,。/w,在/p,参加/v,这次/r,分享/v,之前/f,，/w,我/r,对/p,协程/nw,并/c,没有/v,什么/r,概念/n,（/w,没/d,写/v,过/u,c/en,+/w,+/w,程序/n,）/w,。/w,这/r,场/q,分享/v,下来/v,只能/v,说/v,有/v,个/q,简单/a,的/u,认识/v,，/w,另外/c,就/d,是/v,感叹/v,于/p,阿里/nt,的/u,同学/n,在/p,这块/r,技术/n,领域/n,的/u,深入/v,。/w,不过/c,就/d,目前/t,的/u,状况/n,，/w,对/p,我们/r,这样/r,一些/m,小/a,公司/n,而言/u,，/w,可能/v,并/c,没有/v,技术/n,能力/n,去/v,修改/v,jvm/en,，/w,短期/b,内/f,的/u,编程/vn,方式/n,并/c,不/d,会/v,有/v,太/d,大/a,的/u,改变/v,。/w,可能/v,当/p,协程/nw,成为/v,一种/mq,标准/n,，/w,一种/mq,官方/n,提倡/v,的/u,编程/vn,方式/n,之后/f,才/d,会/v,慢慢/d,进入/v,大众/n,程序员/n,的/u,领域/n,（/w,那/r,为什么/r,不/d,提前/v,学习/v,一些/m,呢/y,？/w,）/w,。/w,《/w,基于/p,内存/n,的/u,分布式/b,计算/v,》/w,这/r,是/v,这次/r,qcon/en,去/v,听/v,的/u,第一/m,个/q,具体/a,问题/n,领域/n,的/u,解决/v,方案/n,。/w,包含/v,内容/n,如下/v,：/w,背景/n,介绍/v,及/c,问题/n,阐述/v,候选/b,解决/v,方案/n,分析/vn,分布式/b,内存/n,计算/v,框架/n,介绍/v,客户/n,实践/v,这里/r,我/r,简要/ad,的/u,说/v,一下/m,第/m,1点/mq,和/c,第/m,3点/mq,。/w,问题/n,背景/n,talking/en, ,data/en,技术/n,团队/n,使用/v,bitmap/en,索引/n,技术/n,移动/vn,运营/vn,各项/r,指标/n,（/w,如/v,日活/nw,、/w,留存/v,）/w,的/u,实时/n,计算/v,，/w,因为/c,bitmap/en,索引/n,高效/b,且/c,能/v,节省/v,存储/vn,空间/n,，/w,它/r,能/v,很/d,方便/a,地/u,做/v,指标/n,的/u,实时/n,排重/nw,。/w,上面/f,是/v,日活/nw,的/u,一个/m,例子/n,，/w,其实/d,就/d,是/v,用/p,一个/m,二进制/n,位/q,来/v,保存/v,用户/n,的/u,状态/n,。/w,比如/v,第一/m,位/q,表示/v,用户/n,设备/n,1/m,，/w,该/r,位/q,为/p,0/m,表示/v,用户/n,未/d,登录/vn,过/u,，/w,为/p,1/m,表示/v,用户/n,登录/vn,过/u,。/w,那么/r,用户/n,重复/v,的/u,登录/vn,自然/d,就/d,被/p,忽略/v,了/u,。/w,talking/en, ,data/en,使用/v,mysql/en,的/u,blob/en,类型/n,存储/vn,bitmap/en,数据/n,，/w,那么/r,每次/r,需要/v,更新/v,数据/n,时/ng,，/w,如/v,需要/v,更新/v,某/r,一个/m,用户/n,的/u,状态/n,，/w,那么/r,需要/v,将/d,bitmap/en,读/v,取/v,出来/v,，/w,修改/v,其中/r,一位/mq,，/w,之后/f,将/d,数据/n,写/v,回到/v,mysql/en,中/f,。/w,那么/r,就/d,带来/v,了/u,一个/m,问题/n,，/w,当/p,某个/r,app/en,的/u,日活/nw,数据量/n,特别/d,大/a,时/ng,，/w,bitmap/en,数据/n,特别/d,大/a,，/w,频繁/a,的/u,update/en,导致/v,了/u,产生/v,大量/m,的/u,mysql/en, ,binlog/en,。/w,解决/v,方案/n,大概/d,思路/n,就/d,是/v,在/p,mysql/en,之前/f,加上/v,一层/mq,缓/v,存/v,，/w,前端/f,的/u,更新/v,操作/v,都/d,在/p,blade/en,内存/n,中/f,操作/v,，/w,之后/f,定时/d,同步/vd,写/v,到/v,mysql/en,中/f,，/w,这样/r,就/d,解决/v,了/u,频繁/a,更新/v,bitmap/en,导致/v,的/u,大量/m,binlog/en,问题/n,。/w,几/m,个/q,组件/n,如/v,上图/n,：/w,app/en,中/f,使用/v,的/u,client/en,内存/n,计算/v,服务/vn,blade/en, ,server/en,（/w,分为/v,master/en,和/c,slave/en,）/w,blade/en, ,data/en, ,sync/en,负责/v,从/p,server/en,定时/d,同步/vd,数据/n,到/v,mysqlblade/en, ,admin/en,提供/v,管控/nz,功能/n,上图/n,中/f,blade/en, ,server/en,有/v,主备/nw,关系/n,，/w,且/c,主备/nw,间/f,有/v,交互/v,。/w,现场/s,提问/vn,环节/n,，/w,我/r,提/v,了/u,以下/f,几/m,个/q,问题/n,：/w,主/n,从/p,复制/v,是/v,怎么/r,做/v,的/u,、/w,支持/v,一/m,主/n,多/a,从/p,吗/y,？/w,blade/en, ,server/en,是/v,基于/p,内存/n,的/u,，/w,没有/v,做/v,持久化/nw,，/w,那么/r,可么/nw,保证/v,系统/n,的/u,可靠性/n,，/w,比如/v,如果/c,主/n,从/p,两个/m,节点/n,宕机/nz,了/u,，/w,未/d,同步/vd,到/v,mysql/en,的/u,数据/n,是否/v,就/d,丢失/v,了/u,？/w,得到/v,的/u,答复/vn,是/v,目前/t,他们/r,并/c,没有/v,做主/v,从/p,复制/v,，/w,当前/t,其实/d,是/v,双/m,写/v,的/u,模式/n,，/w,即/v,client/en,会/v,将/d,数据/n,写/v,到/v,master/en,和/c,slave/en,。/w,这样/r,也/d,就/d,没有/v,第二/m,个/q,问题/n,的/u,处理/v,了/u,。/w,对于/p,分布式/b,系统/n,，/w,认为/v,首先/d,要/v,考虑/v,的/u,就/d,是/v,系统/n,的/u,可靠性/n,和/c,可用性/n,。/w,我们/r,常常/d,说/v,的/u,一点/m,就是/d,为了/p,保证/v,数据/n,的/u,可靠性/n,，/w,我们/r,需要/v,一/m,式/k,三份/mq,，/w,而且/c,是/v,尽量/d,让/v,三分/mq,数据/n,分/q,不/d,到/v,不同/a,机器/n,中/f,，/w,比如/v,同机/n,柜/ng,的/u,机器/n,存/v,一份/mq,，/w,跨/v,机柜/n,的/u,存/v,一份/mq,，/w,像/v,hdfs/en,那样/r,存储/vn,数据/n,。/w,所以/c,我/r,觉得/v,上面/f,的/u,方案/n,并/c,不/d,是/v,一个/m,很/d,可靠/a,的/u,方案/n,。/w,比如/v,使用/v,消息/n,中间件/n,的/u,方式/n,是否/v,能/v,代替/v,上面/f,的/u,方案/n,呢/y,？/w,客户/n,端/v,将/d,消息/n,发送/v,到/v,消息/n,中间/f,件/q,中/f,，/w,类似/v,于/p,rocketmq/en,和/c,kafka/en,这样/r,的/u,组件/n,中/f,，/w,之后/f,通过/p,consumer/en,定时/d,从中/d,取消/v,费/v,数据/n,来/v,解决/v,频繁/a,更新/v,的/u,问题/n,（/w,数据/n,的/u,可靠性/n,通过/p,消息/n,中间/f,件/q,得到/v,了/u,保证/v,）/w,。/w,也/d,可/v,启动/v,实时/n,消费/vn,的/u,consumer/en,来/v,消费/vn,数据/n,更新/v,到/v,某个/r,内存/n,服务/vn,中/f,，/w,这样/r,可以/v,提供/v,实时/n,的/u,查询/v,服务/vn,。/w,以上/f,是/v,自己/r,的/u,一些/m,疑问/n,和/c,拍/v,脑袋/n,的/u,一个/m,替代/v,方案/n,，/w,欢迎/v,交流/vn,不同/a,的/u,想法/n,。/w,《/w,饿了么/nt,异地/n,多/a,活/n,的/u,基础/n,设施/n,建设/vn,》/w,之前/f,我们/r,团队/n,考虑/v,过/u,一些/m,异地/n,多/a,活/n,的/u,实现/v,方案/n,，/w,所以/c,特地/d,去/v,听/v,了/u,这/r,场/q,分享/v,。/w,之前/f,在/p,自己/r,考虑/v,异地/n,多/a,活/n,方案/n,时/ng,，/w,遇到/v,的/u,最/d,大/a,的/u,问题/n,是/v,数据/n,同步/vd,和/c,数据/n,一致性/n,。/w,下面/f,看/v,饿了么/nt,是/v,如何/r,实现/v,基地/n,多/a,活/n,的/u,。/w,首先/d,是/v,饿了么/nt,的/u,业务/n,特点/n,：/w,其中/r,最/d,重要/a,的/u,一点/mq,就/d,是/v,地域性/nw,。/w,饿了么/nt,的/u,业务/n,特点/n,，/w,可以/v,将/d,所有/b,数据/n,按照/p,商户/n,所/u,在/p,的/u,位置/n,信息/n,来/v,进行/v,划分/v,。/w,比如/v,所有/b,南方/f,商户/n,的/u,数据/n,走/v,上海机房/ns,，/w,所有/b,北方/f,商户/n,的/u,数据/n,走/v,北京机房/ns,。/w,对于/p,用户/n,和/c,订单/n,信息/n,，/w,都/d,可以/v,关联/vn,到/v,对应/v,的/u,商家/n,，/w,然后/c,访问/v,商家/n,对应/v,所/u,在/p,的/u,机房/n,的/u,服务/vn,。/w,上面/f,是/v,饿了么/nt,异地/n,多/a,活/n,的/u,数据/n,复制/v,实现/v,。/w,思路/n,就/d,是/v,在/p,两个/m,机房/n,之间/f,进行/v,双向/d,的/u,数据/n,复制/v,。/w,回想/v,一下/m,，/w,因为/c,饿了么/nt,的/u,业务/n,特点/n,，/w,双向/d,复制/v,的/u,数据/n,中/f,不/d,会/v,有/v,重叠/v,的/u,部分/n,。/w,从/p,北京机房/ns,往/p,上海机房/ns,复制/v,的/u,是/v,北方/f,商户/n,的/u,数据/n,从/p,上海机房/ns,到/v,北京机房/ns,复制/v,的/u,是/v,南方/f,商户/n,的/u,数据/n,在/p,复制/v,中/f,过滤/v,掉/v,不/d,必要/a,的/u,数据/n,，/w,比如/v,从/p,上海/ns,复制/v,到/v,北京/ns,的/u,数据/n,，/w,这/r,部分/n,数据/n,应用/vn,到/v,mysql/en,之后/f,也/d,会/v,产生/v,binlog/en,，/w,这/r,部分/n,binlog/en,需要/v,从/p,北京/ns,复制/v,到/v,上海/ns,的/u,数据/n,中/f,剔除/v,（/w,这个/r,通过/p,改造/vn,sql/en,或者/c,增加/v,标识/n,是/v,可以/v,做到/v,的/u,）/w,这样/r,就/d,避免/v,掉/v,了/u,一个/m,数据/n,在/p,两个/m,机房/n,同时/c,被/p,修改/v,的/u,问题/n,。/w,扩展/v,考虑/v,一个/m,问题/n,，/w,比如/v,在/p,电商/nz,场景/n,中/f,做/v,异地/n,多/a,活/n,。/w,对于/p,一个/m,商品/n,，/w,在/p,北京机房/ns,和/c,上海机房/ns,都/d,会/v,被/p,访问/v,，/w,这个/r,时候/n,就/d,产生/v,了/u,一个/m,问题/n,：/w,商品/n,的/u,库存/n,为/p,1/m,，/w,北京机房/ns,下/f,了/u,一/m,单/d,，/w,将/d,商品/n,库存/n,变更/v,为/p,0/m,；/w,同时/c,上海机房/ns,也/d,下/f,了/u,一/m,单/d,，/w,也/d,将/d,库存/n,变更/v,为/p,0/m,。/w,这样/r,就/d,产生/v,了/u,超卖/nw,的/u,问题/n,。/w,另外/c,，/w,如何/r,在/p,双向/d,数据/n,同步/vd,中将/n,上线/n,的/u,数据/n,修复/v,，/w,即使/c,其中/r,一个/m,订单/n,失效/v,，/w,将/d,库存/n,修复/v,也/d,会/v,一个/m,问题/n,。/w,otter/en,阿里巴巴/nt,b/en,2/m,b/en,公司/n,，/w,因为/c,业务/n,的/u,特性/n,，/w,卖/v,家/q,主要/b,集中/v,在/p,国内/s,，/w,买家/n,主要/b,集中/v,在/p,国外/s,，/w,所以/c,衍生/vn,出/v,了/u,杭州/ns,和/c,美国/ns,异地/n,机房/n,的/u,需求/n,，/w,同时/c,为了/p,提升/v,用户/n,体验/vn,，/w,整个/b,机房/n,的/u,架构/n,为/p,双/m,a/en,，/w,两边/f,均/d,可/v,写/v,，/w,由此/d,诞生/v,了/u,otter/en,这样/r,一个/m,产品/n,。/w,otter/en,在/p,解决/v,数据/n,一致性/n,问题/n,时/ng,（/w,同一/b,行/v,记录/v,多/a,地/u,修改/v,）/w,，/w,有/v,两种/mq,方案/n,：/w,事前/t,控制/v,：/w,比如/v,paoxs/en,协议/n,，/w,在/p,多/a,地/u,数据/n,写入/v,各自/r,数据/n,存储/vn,之前/f,，/w,就/d,已经/d,决定/v,好/a,最后/f,保留/v,哪/r,条/q,记录/v,事后/t,补救/vn,：/w,指/v,a/en,//w,b/en,两地/n,修改/v,的/u,数据/n,，/w,已经/d,保存/v,到/v,数据库/n,之后/f,，/w,通过/p,数据/n,同步/vd,后/f,保证/v,两/m,数据/n,的/u,一致性/n,两种/mq,方式/n,都/d,是/v,数据/n,最终/d,一致性/n,的/u,保证/v,，/w,具体/a,内容/n,可以/v,参考/v,：/w,otter/en,数据/n,一致性/n,解决/v,方案/n,未/d,完/v,待续/v,./w,./w,./w,qcon/en,3天/mq,，/w,还有/v,挺/d,多/a,想/v,和/c,大家/r,分享/v,的/u,，/w,所以/c,还有/v,下篇/n,，/w,包含/v,《/w,phxqueue/en,——/w,微信/nz,开源/v,高/a,可/v,用/p,强/a,一致/a,分布式/b,队列/n,的/u,设计/vn,与/p,实现/v,》/w