mnist/en,是/v,一个/m,入门/v,级/q,的/u,计算机/n,视觉/n,数据集/nw,，/w,它/r,包含/v,各种/r,手写/v,数字/n,图片/n,：/w,1/m,./w, ,mnist/en,数据集/nw,mnist/en,，/w,是不是/v,听/v,起来/v,特/d,高/a,端/v,大气/n,，/w,不/d,知道/v,这个/r,是/v,什么/r,东西/n,？/w,=/w,=/w, ,手写/v,数字/n,分类/vn,问题/n,所/u,要/v,用/p,到/v,的/u,（/w,经典/n,）/w,mnist/en,数据集/nw, ,=/w,=/w,mnist/en,数据集/nw,的/u,官/n,网/n,是/v,yann/en, ,lecun/en,'/w,s/en, ,website/en,自动/d,下载/v,和/c,安装/v,这个/r,数据集/nw,的/u,python/en,代码/n,该段/r,代码/n,在/p,tensorflow/en,//w,examples/en,//w,tutorials/en,//w,mnist/en,//w,input/en,_,data/en,./w,py/en,"/w,"/w,"/w,functions/en, ,for/en, ,downloading/en, ,and/en, ,reading/en, ,mnist/en, ,data/en,./w,"/w,"/w,"/w, ,from/en, ,_,_,future/en,_,_, ,import/en, ,absolute/en,_,import/en, ,from/en, ,_,_,future/en,_,_, ,import/en, ,division/en, ,from/en, ,_,_,future/en,_,_, ,import/en, ,print/en,_,function/en, ,import/en, ,gzip/en, ,import/en, ,os/en, ,import/en, ,tempfile/en, ,import/en, ,numpy/en, ,from/en, ,six/en,./w,moves/en, ,import/en, ,urllib/en, ,from/en, ,six/en,./w,moves/en, ,import/en, ,xrange/en, ,#, ,pylint/en,:/w, ,disable/en,=/w,redefined/en,-/w,builtin/en, ,import/en, ,tensorflow/en, ,as/en, ,tf/en, ,from/en, ,tensorflow/en,./w,contrib/en,./w,learn/en,./w,python/en,./w,learn/en,./w,datasets/en,./w,mnist/en, ,import/en, ,read/en,_,data/en,_,sets/en,导入/v,项目/n,import/en, ,tensorflow/en,./w,examples/en,./w,tutorials/en,./w,mnist/en,./w,input/en,_,data/en, ,import/en, ,input/en,_,data/en, ,mnist/en, ,=/w, ,input/en,_,data/en,./w,read/en,_,data/en,_,sets/en,(/w,"/w,mnist/en,_,data/en,//w,"/w,,/w, ,one/en,_,hot/en,=/w,true/en,)/w,2/m,./w, ,运行/vn,tensorflow/en,的/u,interactivesession/en,使用/v,tensorflow/en,之前/f,，/w,首先/d,导入/v,它/r,：/w,import/en, ,tensorflow/en, ,as/en, ,tf/en, ,sess/en, ,=/w, ,tf/en,./w,interactivesession/en,(/w,)/w,3/m,./w, ,计算图/nw,为了/p,在/p,python/en,中/f,进行/v,高效/b,的/u,数值/n,计算/v,，/w,我们/r,通常/d,会/v,使用/v,像/v,numpy/en,一类/mq,的/u,库/n,，/w,将/d,一些/m,诸如/v,矩阵/n,乘法/n,的/u,耗时/v,操作/v,在/p,python/en,环境/n,的/u,外部/f,来/v,计算/v,，/w,这些/r,计算/v,通常/d,会/v,通过/p,其它/r,语言/n,并用/v,更为/d,高效/b,的/u,代码/n,来/v,实现/v,。/w,但/c,遗憾/a,的/u,是/v,，/w,每/r,一个/m,操作/v,切换/vn,回/v,python/en,环境/n,时/ng,仍/d,需要/v,不/d,小/a,的/u,开销/v,。/w,如果/c,你/r,想/v,在/p,gpu/en,或者/c,分布式/b,环境/n,中/f,计算/v,时/ng,，/w,这/r,一/m,开销/v,更加/d,可怖/nw,，/w,这/r,一/m,开销/v,主要/b,可能/v,是/v,用/p,来/v,进行/v,数据/n,迁移/vn,。/w,tensorflow/en,也/d,是/v,在/p,python/en,外部/f,完成/v,其/r,主要/b,工作/vn,，/w,但是/c,进行/v,了/u,改进/v,以/p,避免/v,这种/r,开销/v,。/w,其/r,并/c,没有/v,采用/v,在/p,python/en,外部/f,独立/v,运行/vn,某个/r,耗时/v,操作/v,的/u,方式/n,，/w,而是/c,先/d,让/v,我们/r,描述/v,一个/m,交互/v,操作图/nw,，/w,然后/c,完全/ad,将/d,其/r,运行/vn,在/p,python/en,外部/f,。/w,这/r,与/p,theano/en,或/c,torch/en,的/u,做法/n,类似/v,。/w,因此/c,python/en,代码/n,的/u,目的/n,是/v,用/p,来/v,构建/v,这个/r,可以/v,在/p,外部/f,运行/vn,的/u,计算图/nw,，/w,以及/c,安排/v,计算图/nw,的/u,哪/r,一/m,部分/n,应该/v,被/p,运行/vn,。/w,详情/n,请/v,查看/v,基本/a,用法/n,中/f,的/u,计算/v,图表/n,一节/mq,。/w,4/m,./w, ,实现/v,softmax/en,回归/v,模型/n,4.1/m, ,占/v,位符/nw,我们/r,通过/p,为/p,输入/v,图像/n, ,x/en, ,和/c,目标/n,输出/v,类别/n, ,y/en,_, ,创建/v,节点/n,，/w,来/v,开始/v,构建/v,计算图/nw,我们/r,通过/p,操作/v,符号/n,变量/n,来/v,描述/v,这些/r,可/v,交互/v,的/u,操作/v,单元/n,，/w,可以/v,用/p,下面/f,的/u,方式/n,创建/v,一个/m,：/w,x/en, ,=/w, ,tf/en,./w,placeholder/en,(/w,"/w,float/en,"/w,,/w, ,shape/en,=/w,[/w,none/en,,/w, ,784/m,]/w,)/w, ,y/en,_, ,=/w, ,tf/en,./w,placeholder/en,(/w,"/w,float/en,"/w,,/w, ,shape/en,=/w,[/w,none/en,,/w, ,10/m,]/w,)/w,x/en,不/d,是/v,一个/m,特定/b,的/u,值/n,，/w,而是/c,一个/m,占位/v,符/vg,placeholder/en,，/w,我们/r,在/p,tensorflow/en,运行/vn,计算/v,时/ng,输入/v,这个/r,值/n,。/w,我们/r,希望/v,能够/v,输入/v,任意/d,数量/n,的/u,mnist/en,图像/n,，/w,每/r,一张/mq,图/n,展平/nr,成/v,784维/mq,的/u,向量/n,。/w,我们/r,用/p,2维/mq,的/u,浮点数/nz,张量/nr,来/v,表示/v,这些/r,图/n,，/w,这个/r,张量/nr,的/u,形状/n,是/v,[/w,none/en,，/w,784/m, ,]/w,。/w,（/w,这里/r,的/u,none/en,表示/v,此/r,张量/nr,的/u,第一/m,个/q,维度/n,可以/v,是/v,任何/r,长度/n,的/u,。/w,）/w,输出/v,类别/n,值/n,y/en,_,也/d,是/v,一个/m,2维/mq,张量/nr,，/w,其中/r,每/r,一/m,行为/n,一个/m,10维/mq,的/u,one/en,-/w,hot/en,向量/n,,/w,用于/v,代表/n,对应/v,某/r,一/m,mnist/en,图片/n,的/u,类别/n,。/w,虽然/c,placeholder/en,的/u,shape/en,参数/n,是/v,可/v,选/v,的/u,，/w,但/c,有/v,了/u,它/r,，/w,tensorflow/en,能够/v,自动/d,捕捉/v,因/p,数据/n,维度/n,不/d,一致/a,导致/v,的/u,错误/n,。/w,4.2/m, ,变量/n,我们/r,的/u,模型/n,也/d,需要/v,权/n,重值/nw,和/c,偏置量/nw,，/w,当然/d,我们/r,可以/v,把/p,它们/r,当做/v,是/v,另外/c,的/u,输入/v,（/w,使用/v,占/v,位符/nw,）/w,，/w,但/c,tensorflow/en,有/v,一个/m,更/d,好/a,的/u,方法/n,来/v,表示/v,它们/r,：/w,variable/en, ,。/w, ,一个/m,variable/en,代表/n,一个/m,可/v,修改/v,的/u,张量/nr,，/w,存在/v,在/p,tensorflow/en,的/u,用于/v,描述/v,交互性/nw,操作/v,的/u,图/n,中/f,。/w,它们/r,可以/v,用于/v,计算/v,输入值/nw,，/w,也/d,可以/v,在/p,计算/v,中/f,被/p,修改/v,。/w,对于/p,各种/r,机器/n,学习/v,应用/vn,，/w,一般/a,都/d,会/v,有/v,模型/n,参数/n,，/w,可以/v,用/p,variable/en,表示/v,。/w,w/en, ,=/w, ,tf/en,./w,variable/en,(/w,tf/en,./w,zeros/en,(/w,[/w,784/m,,/w,10/m,]/w,)/w,)/w, ,b/en, ,=/w, ,tf/en,./w,variable/en,(/w,tf/en,./w,zeros/en,(/w,[/w,10/m,]/w,)/w,)/w,我们/r,在/p,调用/v,tf/en,./w,variable/en,的/u,时候/n,传入/v,初始值/n,。/w,在/p,这个/r,例子/n,里/f,，/w,我们/r,把/p,w/en,和/c,b/en,都/d,初始化/v,为/p,零向量/nw,。/w,w/en,是/v,一个/m,784/m,x/en,10/m,的/u,矩阵/n,（/w,因为/c,我们/r,有/v,784个/m,特征/n,和/c,10个/m,输出值/nw,）/w,。/w,b/en,是/v,一个/m,10维/mq,的/u,向量/n,（/w,因为/c,我们/r,有/v,10个/m,分类/vn,）/w,变量/n,需要/v,通过/p,seesion/en,初始化/v,后/f,，/w,才/d,能/v,在/p,session/en,中/f,使用/v,。/w,这/r,一/m,初始化/v,步骤/n,为/p,，/w,为/p,初始值/n,指定/v,具体值/nw,（/w,本例/nw,当中/f,是/v,全/a,为/p,零/m,）/w,，/w,并/c,将/d,其/r,分配/vn,给/p,每个/r,变量/n,,/w,可以/v,一次性/d,为/p,所有/b,变量/n,完成/v,此/r,操作/v,。/w,sess/en,./w,run/en,(/w,tf/en,./w,initialize/en,_,all/en,_,variables/en,(/w,)/w,)/w,5/m,./w, ,类别/n,预测/v,现在/t,，/w,我们/r,可以/v,实现/v,我们/r,的/u,模型/n,啦/y,。/w,只/d,需要/v,一行/n,代码/n,！/w,计算/v,每个/r,分类/vn,的/u,softmax/en,概率/n,值/n,y/en, ,=/w, ,tf/en,./w,nn/en,./w,softmax/en,(/w,tf/en,./w,matmul/en,(/w,x/en,,/w,w/en,)/w, ,+/w, ,b/en,)/w,tf/en,./w,matmul/en,(/w, ,x/en,，/w,w/en,)/w,表示/v,x/en,乘/v,以/p,w/en,，/w,对应/v,之前/f,等/u,式/k,里面/f,的/u,wx/en,,/w,这里/r,x/en,是/v,一个/m,2维/mq,张量/nr,拥有/v,多/a,个/q,输入/v,。/w,然后/c,再/d,加上/v,b/en,，/w,把/p,和/c,输入/v,到/v,tf/en,./w,nn/en,./w,softmax/en,函数/n,里面/f,。/w,为了/p,训练/vn,我们/r,的/u,模型/n,，/w,我们/r,首先/d,需要/v,定义/n,一个/m,指标/n,来/v,评估/vn,这个/r,模型/n,是/v,好/a,的/u,。/w,其实/d,，/w,在/p,机器/n,学习/v,，/w,我们/r,通常/d,定义/n,指标/n,来/v,表示/v,一个/m,模型/n,是/v,坏/a,的/u,，/w,这个/r,指标/n,称为/v,成本/n,（/w,cost/en,）/w,或/c,损失/n,（/w,loss/en,）/w,，/w,然后/c,尽量/d,最小化/nw,这个/r,指标/n,。/w,但是/c,，/w,这/r,两种/mq,方式/n,是/v,相同/a,的/u,。/w,一个/m,非常/d,常见/a,的/u,，/w,非常/d,漂亮/a,的/u,成本/n,函数/n,是/v,“/w,交叉/vn,熵/g,”/w,（/w,cross/en,-/w,entropy/en,）/w,。/w,交叉/vn,熵/g,产生/v,于/p,信息论/n,里面/f,的/u,信息/n,压缩/v,编码/n,技术/n,，/w,但是/c,它/r,后来/t,演变/v,成为/v,从/p,博弈论/n,到/v,机器/n,学习/v,等/u,其他/r,领域/n,里/f,的/u,重要/a,技术/n,手段/n,。/w,它/r,的/u,定义/n,如下/v,：/w,交叉/vn,熵/g,是/v,用/p,来/v,衡量/v,我们/r,的/u,预测/v,用于/v,描述/v,真相/n,的/u,低效性/nw,。/w,交叉/vn,熵/g,根据/p,公式/n,计算/v,交叉/vn,熵/g,，/w,可以/v,很/d,容易/a,的/u,为/p,训练/vn,过程/n,指定/v,最小化/nw,误差/n,用/p,的/u,损失/n,函数/n,，/w,我们/r,的/u,损失/n,函数/n,是/v,目标/n,类别/n,和/c,预测/v,类别/n,之间/f,的/u,交叉/vn,熵/g,cross/en,_,entropy/en, ,=/w, ,-/w,tf/en,./w,reduce/en,_,sum/en,(/w,y/en,_,*/w,tf/en,./w,log/en,(/w,y/en,)/w,)/w,首先/d,，/w,用/p, ,tf/en,./w,log/en, ,计算/v, ,y/en, ,的/u,每个/r,元素/n,的/u,对数/n,。/w,接下来/l,，/w,我们/r,把/p, ,y/en,_, ,的/u,每/r,一个/m,元素/n,和/c, ,tf/en,./w,log/en,(/w,y/en,)/w, ,的/u,对应/v,元素/n,相/d,乘/v,。/w,最后/f,，/w,用/p, ,tf/en,./w,reduce/en,_,sum/en, ,计算/v,张量/nr,的/u,所有/b,元素/n,的/u,总和/n,。/w,（/w,注意/v,，/w,这里/r,的/u,交叉/vn,熵/g,不仅仅/d,用/p,来/v,衡量/v,单一/a,的/u,一对/m,预测/v,和/c,真实值/nw,，/w,而是/c,所有/b,100幅/mq,图片/n,的/u,交叉/vn,熵/g,的/u,总和/n,。/w,对于/p,100/m,个数/n,据点/n,的/u,预测/v,表现/v,比/p,单一/a,数据点/nw,的/u,表现/v,能/v,更/d,好/a,地/u,描述/v,我们/r,的/u,模型/n,的/u,性能/n,6/m,./w, ,训练/vn,模型/n,现在/t,我们/r,知道/v,我们/r,需要/v,我们/r,的/u,模型/n,做/v,什么/r,啦/y,，/w,用/p,tensorflow/en,来/v,训练/vn,它/r,是/v,非常/d,容易/a,的/u,。/w,因为/c,tensorflow/en,拥有/v,一张/mq,描述/v,你/r,各个/r,计算/v,单元/n,的/u,图/n,，/w,它/r,可以/v,自动/d,地/u,使用/v,反向/f,传播/vn,算法/n,(/w,backpropagation/en, ,algorithm/en,)/w,来/v,有效/a,地/u,确定/v,你/r,的/u,变量/n,是/v,如何/r,影响/vn,你/r,想/v,要/v,最小化/nw,的/u,那个/r,成本/n,值/n,的/u,。/w,然后/c,，/w,tensorflow/en,会/v,用/p,你/r,选择/v,的/u,优化/v,算法/n,来/v,不断/d,地/u,修改/v,变量/n,以/p,降低/v,成本/n,。/w,train/en,_,step/en, ,=/w, ,tf/en,./w,train/en,./w,gradientdescentoptimizer/en,(/w,0.01/m,)/w,./w,minimize/en,(/w,cross/en,_,entropy/en,)/w,在/p,这里/r,，/w,我们/r,要求/v,tensorflow/en,用/p,梯度/n,下降/v,算法/n,（/w,gradient/en, ,descent/en, ,algorithm/en,）/w,以/p,0.01/m,的/u,学习/v,速率/n,最小化/nw,交叉/vn,熵/g,。/w,梯度/n,下降/v,算法/n,（/w,gradient/en, ,descent/en, ,algorithm/en,）/w,是/v,一个/m,简单/a,的/u,学习/v,过程/n,，/w,tensorflow/en,只/d,需/v,将/d,每个/r,变量/n,一点点/nw,地/u,往/p,使/v,成本/n,不断/d,降低/v,的/u,方向/n,移动/vn,。/w,当然/d,tensorflow/en,也/d,提供/v,了/u,其他/r,许多/m,优化