介绍/v,目前/t,，/w,对于/p,全球科学家/nw,而言/u,，/w,“/w,如何/r,去/v,学习/v,一种/mq,新/a,技能/n,”/w,成为/v,了/u,一个/m,最/d,基本/a,的/u,研究/vn,问题/n,。/w,为什么/r,要/v,解决/v,这个/r,问题/n,的/u,初衷/n,是/v,显而易见/i,的/u,，/w,如果/c,我们/r,理解/v,了/u,这个/r,问题/n,，/w,那么/r,我们/r,可以/v,使/v,人类/n,做/v,一些/m,我们/r,以前/f,可能/v,没有/v,想到/v,的/u,事/n,。/w,或者/c,，/w,我们/r,可以/v,训练/vn,去/v,做/v,更/d,多/a,的/u,“/w,人类/n,”/w,工作/vn,，/w,常/d,遭/v,一个/m,真正/d,的/u,人工智能/n,时代/n,。/w,虽然/c,，/w,对于/p,上述/b,问题/n,，/w,我们/r,目前/t,还/d,没有/v,一个/m,完整/a,的/u,答案/n,去/v,解释/v,，/w,但是/c,有/v,一些/m,事情/n,是/v,可以/v,理解/v,的/u,。/w,先/d,不/d,考虑/v,技能/n,的/u,学习/v,，/w,我们/r,首先/d,需要/v,与/p,环境/n,进行/v,交互/v,。/w,无论/c,我们/r,是/v,学习/v,驾驶/v,汽车/n,还是/c,婴儿/n,学习/v,走路/v,，/w,学习/v,都/d,是/v,基于/p,和/c,环境/n,的/u,相互/d,交互/v,。/w,从/p,互动/v,中/f,学习/v,是/v,所有/b,智力/n,发展/vn,和/c,学习/v,理论/n,的/u,基础/n,概念/n,。/w,强化/v,学习/v,今天/t,，/w,我们/r,将/d,探讨/v,强化/v,学习/v,，/w,这/r,是/v,一种/mq,基于/p,环境/n,相互/d,交互/v,的/u,学习/v,算法/n,。/w,有些/r,人/n,认为/v,，/w,强化/v,学习/v,是/v,实现/v,强/a,人工智能/n,的/u,真正/d,希望/v,。/w,这种/r,说法/n,也/d,是/v,正确/a,的/u,，/w,因为/c,强化/v,学习/v,所/u,拥有/v,的/u,潜力/n,确实/ad,是/v,巨大/a,的/u,。/w,目前/t,，/w,有关/vn,强化/v,学习/v,的/u,研究/vn,正在/d,快速/d,增长/v,，/w,人们/n,为/p,不同/a,的/u,应用/vn,程序/n,生成/vn,各种各样/l,的/u,学习/v,算法/n,。/w,因此/c,，/w,熟悉/v,强化/v,学习/v,的/u,技术/n,就/d,变/v,得/u,尤其/d,重要/a,了/u,。/w,如果/c,你/r,还/d,不/d,是/v,很/d,熟悉/v,强化/v,学习/v,，/w,那么/r,我/r,建议/n,你/r,可以/v,去/v,看看/v,我/r,以前/f,有关/vn,强化/v,学习/v,文章/n,和/c,一些/m,开源/v,的/u,强化/v,学习/v,平台/n,。/w,一旦/d,你/r,已经/d,掌握/v,和/c,理解/v,了/u,强化/v,学习/v,的/u,基础/n,知识/n,，/w,那么/r,请/v,继续/v,阅读/v,这/r,篇文章/n,。/w,读/v,完/v,本文/r,之后/f,，/w,你/r,会/v,对/p,强化/v,学习/v,有/v,一个/m,透彻/a,的/u,了解/v,，/w,并且/c,会/v,进行/v,实际/n,代码/n,实现/v,。/w,注/v,：/w,在/p,代码/n,实现/v,部分/n,，/w,我们/r,假设/v,你/r,已经/d,有/v,了/u,python/en,的/u,基本/a,知识/n,。/w,如果/c,你/r,还/d,不/d,知道/v,python/en,，/w,那么/r,你/r,应该/v,先/d,看看/v,这/r,篇/q,教程/n,。/w,1/m,./w, ,确定/v,一个/m,强化/v,学习/v,问题/n,强化/v,学习/v,是/v,学习/v,如何/r,去/v,做/v,，/w,如何/r,根据/p,与/p,环境/n,的/u,交互/v,采取/v,相应/v,的/u,行动/vn,。/w,最终/d,的/u,结果/n,就/d,是/v,使得/v,系统/n,的/u,回报/vn,信号/n,数值/n,最大化/v,。/w,学习/v,者/k,不/d,会/v,被/p,告知/v,去/v,执行/v,哪个/r,行动/vn,，/w,而是/c,要/v,他/r,自己/r,去/v,发现/v,哪/r,种/q,行动/vn,将/d,产生/v,最/d,大/a,的/u,回报/vn,。/w,让/v,我们/r,通过/p,一个/m,简单/a,的/u,例子/n,来/v,解释/v,一下/m,：/w,我们/r,将/d,一个/m,正在/d,学习/v,走路/v,的/u,孩子/n,作为/v,一个/m,例子/n,。/w,以下/f,是/v,孩子/n,在/p,学习/v,走路/v,时/ng,所/u,要/v,采取/v,的/u,步骤/n,：/w,1/m,./w,孩子/n,会/v,观察/v,的/u,第一/m,件/q,事/n,，/w,就/d,是/v,注意/v,你/r,是/v,如何/r,走路/v,的/u,。/w,你/r,使用/v,两条腿/n,，/w,一次/mq,走/v,一步/mq,，/w,一步/mq,一步/mq,往/p,前/f,走/v,。/w,孩子/n,会/v,抓住/v,这个/r,概念/n,，/w,然后/c,试图/v,去/v,模仿/v,你/r,。/w,2/m,./w,但/c,很快/d,他/r,//w,她/r,又/d,会/v,明白/v,，/w,在/p,走路/v,之前/f,，/w,孩子/n,必须/d,先/d,站/v,起来/v,！/w,在/p,学习/v,走路/v,的/u,时候/n,，/w,这/r,对于/p,孩子/n,来说/u,是/v,一个/m,挑战/vn,。/w,因此/c,，/w,孩子/n,试图/v,自己/r,站/v,起来/v,，/w,他/r,//w,她/r,不断/d,跌倒/v,，/w,但是/c,任然/nr,不断/d,地/u,站/v,起来/v,。/w,3/m,./w,然而/c,还有/v,另外/c,一个/m,挑战/vn,需要/v,应付/v,。/w,站/v,起来/v,是/v,相对/d,容易/a,的/u,，/w,但是/c,要/v,保持/v,站立/v,状态/n,就/d,是/v,另/r,一个/m,挑战/vn,了/u,。/w,在/p,一个/m,狭小/a,的/u,空气/n,中/f,，/w,找到/v,支撑/v,，/w,孩子/n,设法/v,保持/v,站立/v,。/w,4/m,./w,现在/t,，/w,孩子/n,的/u,真正/d,任务/n,就/d,是/v,开始/v,学习/v,走路/v,了/u,。/w,但是/c,学习/v,走路/v,说/v,起来/v,很/d,容易/a,，/w,而/c,实际/n,做/v,起来/v,就/d,不/d,是/v,那么/r,容易/a,了/u,。/w,在/p,孩子/n,的/u,大脑/n,中/f,需要/v,处理/v,很多/m,事情/n,，/w,比如/v,平衡/a,身体/n,，/w,决定/v,哪个/r,脚/n,是/v,下/f,一次/mq,需要/v,放下/v,的/u,，/w,放/v,在/p,哪里/r,。/w,这/r,听/v,起来/v,像/v,是/v,一个/m,很/d,困难/an,的/u,任务/n,，/w,对/p,吗/y,？/w,它/r,实际上/d,确实/ad,是/v,一个/m,挑战/vn,，/w,先/d,要/v,学习/v,站立/v,，/w,然后/c,才/d,能/v,学习/v,行走/v,。/w,但是/c,，/w,现在/t,我们/r,不/d,都/d,学会/n,了/u,走路/v,嘛/y,，/w,再/d,也/d,不/d,会/v,被/p,这个/r,问题/n,所/u,困扰/v,了/u,。/w,现在/t,，/w,你/r,可以/v,明白/v,，/w,为什么/r,这/r,对于/p,孩子/n,是/v,多么/d,困难/an,的/u,原因/n,了/u,。/w,让/v,我们/r,形式化/v,上面/f,的/u,例子/n,。/w,例子/n,所/u,要/v,陈述/v,的/u,问题/n,是/v,“/w,走路/v,问题/n,”/w,，/w,其中/r,孩子/n,是/v,一个/m,试图/v,通过/p,采取/v,行动/vn,（/w,走路/v,）/w,来/v,操纵/v,环境/n,（/w,在/p,地上/s,走路/v,）/w,的/u,智能体/nw,，/w,他/r,//w,她/r,试图/v,从/p,一个/m,状态/n,（/w,即/v,，/w,他/r,//w,她/r,走/v,的/u,每/r,一步/mq,）/w,转移/v,到/v,另/r,一个/m,状态/n,。/w,当/p,他/r,//w,她/r,完成/v,任务/n,的/u,一个子/nw,模块/n,（/w,即/v,，/w,孩子/n,走/v,了/u,几/m,步/q,）/w,时/ng,，/w,孩子/n,会/v,获得/v,奖励/vn,（/w,比如/v,，/w,一些/m,巧克力/n,）/w,，/w,但是/c,当/p,他/r,//w,她/r,不/d,会/v,走路/v,时/ng,，/w,他/r,//w,她/r,不/d,会/v,收到/v,任何/r,巧克力/n,（/w,这/r,是/v,一个/m,负/v,反馈/v,过程/n,）/w,。/w,这/r,就/d,是/v,像/v,话/n,学习/v,问题/n,的/u,简单/a,描述/v,。/w,这/r,是/v,一个/m,有关/vn,强化/v,学习/v,很/d,好/a,的/u,介绍/v,视频/n,。/w,2/m,./w, ,与/p,其他/r,机器/n,学习/v,方法/n,的/u,比较/d,强化/v,学习/v,属于/v,更/d,打雷/v,的/u,机器/n,学习/v,算法/n,。/w,以下/f,是/v,有关/vn,机器/n,学习/v,算法/n,类型/n,的/u,描述/v,。/w,让/v,我们/r,比较/d,一下/m,强化/v,学习/v,算法/n,和/c,别的/r,类型/n,算法/n,之间/f,的/u,区别/n,：/w,监督/vn,学习/v,与/p,强化/v,学习/v,：/w,在/p,监督/vn,学习/v,中/f,，/w,在/p,外部/f,有/v,一个/m,“/w,监督/vn,主管/vn,”/w,，/w,它/r,拥有/v,所有/b,环境/n,的/u,知识/n,，/w,并且/c,与/p,智能体/nw,一起/s,共享/v,这个/r,知识/n,，/w,从而/c,帮助/v,智能体/nw,完成/v,任务/n,。/w,但是/c,这样/r,存在/v,一些/m,问题/n,，/w,因为/c,在/p,一个/m,任务/n,中/f,，/w,其中/r,存在/v,如此/r,多/a,的/u,子任务/nw,之间/f,的/u,组合/v,，/w,智能体/nw,应该/v,执行/v,并且/c,实现/v,目标/n,。/w,所以/c,，/w,创建/v,一个/m,“/w,监督/vn,主管/vn,”/w,几乎/d,是/v,不切实际/l,的/u,。/w,例如/v,，/w,在/p,象棋/n,游戏/n,中/f,，/w,存在/v,数万/nw,个/q,可以/v,移动/vn,的/u,玩法/n,。/w,因此/c,，/w,去/v,创建/v,一个/m,可以/v,获胜/v,的/u,玩法/n,知识库/n,是/v,一个/m,单调/a,乏味/a,的/u,任务/n,。/w,在/p,这些/r,问题/n,中/f,，/w,从/p,自己/r,的/u,经验/n,中/f,学习/v,，/w,并且/c,获得/v,知识/n,是/v,更加/d,合理/a,可行/a,的/u,。/w,这/r,就/d,是/v,强化/v,学习/v,和/c,监督/vn,学习/v,的/u,主要/b,区别/n,。/w,在/p,监督/vn,学习/v,和/c,强化/v,学习/v,中/f,，/w,在/p,输入/v,和/c,输出/v,之间/f,都/d,存在/v,映射/v,。/w,但是/c,在/p,强化/v,学习/v,中/f,，/w,存在/v,的/u,是/v,对/p,智能体/nw,的/u,奖励/vn,反馈/v,函数/n,，/w,而/c,不/d,是/v,像/v,监督/vn,学习/v,直接/ad,告诉/v,智能体/nw,最终/d,的/u,答案/n,。/w,无/v,监督/vn,学习/v,与/p,强化/v,学习/v,：/w,在/p,强化/v,学习/v,中/f,，/w,有/v,一个/m,从/p,输入/v,到/v,输出/v,的/u,映射/v,过程/n,，/w,但是/c,这个/r,过程/n,在/p,无/v,监督/vn,学习/v,中/f,是/v,不/d,存在/v,的/u,。/w,在/p,无/v,监督/vn,学习/v,中/f,，/w,主要/b,任务/n,是/v,找到/v,一个/m,最/d,基础/n,的/u,模式/n,，/w,而/c,不是/v,一种/mq,映射/v,关系/n,。/w,例如/v,，/w,如果/c,任务/n,是/v,向/p,用户/n,推荐/v,新闻/n,文章/n,，/w,则/d,无/v,监督/vn,学习/v,算法/n,是/v,先/d,查看/v,该/r,人/n,以前/f,读/v,过/u,的/u,类似/v,文章/n,，/w,并/c,把/p,它们/r,推荐/v,给/p,其他人/r,。/w,而/c,强化/v,学习/v,算法/n,则/d,是/v,，/w,通过/p,用户/n,的/u,一些/m,文章/n,，/w,并且/c,获得/v,用户/n,的/u,不断/d,反馈/v,，/w,从而/c,构建/v,一个/m,“/w,知识/n,图谱/n,”/w,，/w,从而/c,得知/v,用户/n,与/p,文章/n,之间/f,的/u,喜爱/v,关系/n,。/w,还有/v,第四/nw,种/q,类型/n,的/u,机器/n,学习/v,，/w,成为/v,半/m,监督/vn,学习/v,，/w,其/r,本质/n,上/f,是/v,监督/vn,学习/v,和/c,无/v,监督/vn,学习/v,的/u,组合/v,。/w,它/r,不/d,同于/c,强化/v,学习/v,，/w,类似/v,于/p,监督/vn,学习/v,和/c,半/m,监督/vn,学习/v,具有/v,直接/ad,的/u,参照/v,答案/n,，/w,而/c,强化/v,学习/v,不/d,具有/v,。/w,3/m,./w,解决/v,强化/v,学习/v,问题/n,的/u,框架/n,为了/p,理解/v,如何/r,去/v,解决/v,一个/m,强化/v,学习/v,问题/n,，/w,让/v,我们/r,通过/p,一个/m,经典/n,的/u,例子/n,来/v,说明/v,一下/m,强化/v,学习/v,问题/n,——/w,多/a,臂/ng,赌博机/n,。/w,首先/d,，/w,我们/r,需要/v,了解/v,探索/v,与/p,开发/v,的/u,基本/a,问题/n,，/w,然后/c,去/v,定义/n,解决/v,强化/v,学习/v,问题/n,的/u,框架/n,。/w,tiger/en, ,machine/en,如/v,上图/n,，/w,假设/v,你/r,已经/d,在/p,tiger/en, ,machine/en,上面/f,玩/v,了/u,很多/m,次/q,了/u,。/w,现在/t,你/r,想/v,做/v,的/u,是从/v,tiger/en, ,machine/en,上面/f,获得/v,最/d,大/a,的/u,回报/vn,，/w,并且/c,尽可能/d,的/u,快/a,。/w,你/r,会/v,怎么/r,做/v,呢/y,？/w,一个/m,比较/d,天真/a,的/u,想法/n,是/v,，/w,只/d,选择/v,一个/m,tiger/en, ,machine/en,，/w,然后/c,一整天/t,都/d,在/p,玩/v,它/r,。/w,这/r,听/v,起来/v,非常/d,无聊/a,，/w,但/c,tiger/en, ,machine/en,可能/v,会/v,给/p,你/r,一些/m,“/w,报酬/n,”/w,，/w,即/v,让/v,你/r,赢/v,钱/n,。/w,使用/v,这种/r,方法/n,，/w,你/r,可能/v,中奖/v,的/u,概率/n,大约/d,是/v,0/m,./w,00000/m,./w,./w,./w,./w,./w,1/m,。/w,也就是说/l,，/w,大多数/m,时间/n,你/r,可能/v,知识/n,坐/v,在/p,tiger/en, ,machine/en,面前/f,亏钱/nw,。/w,正式/ad,说明/v,一下/m,，/w,这/r,可以/v,被/p,定义/n,为/p,一种/mq,纯粹/b,的/u,开发/v,方法/n,。/w,但是/c,这/r,是/v,最佳/z,选择/v,吗/y,？/w,答案/n,当然/d,是/v,否定/v,的/u,。/w,让/v,我们/r,看看/v,另外/c,一种/mq,方法/n,。/w,我们/r,可以/v,拉/v,每个/r,tiger/en, ,machine/en,的/u,拉杆/n,，/w,并且/c,向/p,上帝/n,祈祷/v,，/w,让/v,我们/r,至少/d,打中/v,一个/m,。/w,当然/d,，/w,这/r,是/v,另/r,一种/mq,天真/a,的/u,想法/n,，/w,你/r,只/d,会/v,一天/mq,都/d,在/p,拉动/v,拉杆/n,，/w,但/c,只是/d,给/p,你/r,一点点/nw,报酬/n,。/w,正式/ad,说明/v,一下/m,，/w,这种/r,方法/n,只/d,是/v,一种/mq,纯粹/b,的/u,探索/v,方法/n,。/w,这/r,两种/mq,方法/n,都/d,不/d,是/v,最/d,优/ag,的/u,，/w,我们/r,必须/d,在/p,它们/r,之间/f,找到/v,适当/a,的/u,平衡点/nz,，/w,已/d,获得/v,最/d,大/a,的/u,回报/vn,。/w,这/r,被/p,称为/v,强化/v,学习/v,的/u,探索/v,和/c,开发/v,困境/n,。/w,首先/d,，/w,我们/r,正式/ad,的/u,定义/n,解决/v,强化/v,学习/v,问题/n,的/u,框架/n,，/w,然后/c,列出/v,可能/v,的/u,方法/n,来/v,解决/v,这个/r,问题/n,。/w,马尔科夫/nr,决策/n,过程/n,：/w,在/p,强化/v,学习/v,场景/n,中/f,，/w,我们/r,定义/n,问题/n,的/u,数学/n,框架/n,被/p,称之为/v,马尔科夫/nr,决策/n,过程/n,。/w,这/r,可以/v,被/p,设计/vn,为/p,：/w,状态/n,集合/v,：/w,s/en,动作/n,集合/v,：/w,a/en,奖励/vn,函数/n,：/w,r/en,策略/n,：/w,π/w,价值/n,：/w,v/en,我们/r,必须/d,采取/v,一定/d,的/u,行动/vn,（/w,a/en,）/w,，/w,让/v,我们/r,从/p,开始/v,状态/n,移动/vn,到/v,结束/v,状态/n,（/w,s/en,）/w,。/w,每当/p,我们/r,采取/v,一个/m,行动/vn,之后/f,，/w,我们/r,都/d,会/v,得到/v,一定/d,的/u,回报/vn,作为/v,奖励/vn,。/w,当然/d,，/w,所/u,获得/v,的/u,奖励/vn,的/u,性质/n,（/w,正面/d,奖励/vn,还是/c,负面/b,奖励/vn,）/w,是/v,由/p,我们/r,的/u,行动/vn,决定/v,的/u,。/w,我们/r,的/u,策略/n,集合/v,（/w,π/w,）/w,是/v,由/p,我们/r,的/u,动作/n,集合/v,来/v,确定/v,的/u,，/w,而/c,我们/r,得到/v,的/u,回报/vn,确定/v,了/u,我们/r,的/u,价值/n,（/w,v/en,）/w,。/w,在/p,这里/r,，/w,我们/r,的/u,任务/n,就/d,是/v,通过/p,选择/v,正确/a,的/u,策略/n,来/v,最大化/v,我们/r,的/u,价值/n,。/w,所以/c,我们/r,必须/d,最大化/v,下面/f,的/u,方程/n,：/w,对于/p,时间/n,t/en,，/w,所有/b,可能/v,的/u,s/en,。/w,旅行/v,推销员/n,问题/n,让/v,我们/r,通过/p,另外/c,一个/m,例子/n,来/v,说明/v,一下/m,。/w,这个/r,问题/n,是/v,一系列/b,旅行商/nw,（/w,tsp/en,）/w,问题/n,的/u,代表/n,。/w,任务/n,是/v,以/p,尽可能/d,低/a,的/u,成本/n,，/w,完成/v,从/p,地点/n,a/en,到/v,地点/n,f/en,。/w,两个/m,字母/n,之间/f,的/u,每/r,条/q,边上/f,的/u,数字/n,表示/v,两地/n,之间/f,的/u,距离/n,花费/v,。/w,如果/c,这个/r,值/n,是/v,负数/n,，/w,那么/r,表示/v,经过/p,这/r,条/q,路/n,，/w,你/r,会/v,得到/v,一定/d,的/u,报酬/n,。/w,我们/r,定义/n,价值/n,是/v,当/p,你/r,用/p,选择/v,的/u,策略/n,走/v,完/v,整个/b,路程/n,时/ng,，/w,所/u,获得/v,的/u,总价值/n,。/w,这里/r,说明/v,一下/m,符号/n,：/w,状态/n,节点/n,集合/v,：/w,{/w,a/en,,/w,b/en,,/w,c/en,,/w,d/en,,/w,e/en,,/w,f/en,}/w,动作/n,集合/v,是/v,从/p,一个/m,地点/n,到/v,另/r,一个/m,地点/n,：/w,{/w,a/en,-/w,>,b/en,,/w, ,c/en,-/w,>,d/en,,/w, ,etc/en,}/w,奖励/vn,函数/n,是/v,边上/f,的/u,值/n,策略/n,函数/n,指/v,的/u,是/v,完整/a,的/u,路径/n,规划/n,，/w,比如/v,:/w, ,{/w,a/en, ,-/w,>, ,c/en, ,-/w,>, ,f/en,}/w,现在/t,假设/v,你/r,在/p,地点/n,a/en,，/w,唯一/b,你/r,能/v,看见/v,的/u,路/n,就/d,是/v,你/r,下/f,一个/m,目的地/n,（/w,也就是说/l,，/w,你/r,只能/v,看见/v,b/en,，/w,d/en,，/w,c/en,，/w,e/en,）/w,，/w,而/c,别的/r,地点/n,你/r,是/v,不/d,知道/v,的/u,。/w,你/r,可以/v,采取/v,贪心/v,算法/n,，/w,去/v,获取/v,当前/t,状态/n,下/f,最/d,有利/a,的/u,步骤/n,，/w,也就是说/l,你/r,从/p,{/w,a/en, ,-/w,>, ,(/w,b/en,,/w,c/en,,/w,d/en,,/w,e/en,)/w,}/w,中/f,选择/v,采取/v, ,{/w,a/en,-/w,>,d/en,}/w, ,这种/r,方法/n,。/w,同样/d,，/w,现在/t,你/r,所在/n,的/u,地点/n,是/v,d/en,，/w,想/v,要/v,到达/v,地点/n,f/en,。/w,你/r,可以/v,从/p,{/w,d/en, ,-/w,>, ,(/w,b/en,,/w, ,c/en,,/w, ,f/en,)/w,}/w, ,中/f,采取/v, ,{/w,d/en, ,-/w,>, ,f/en,}/w, ,这个/r,方法/n,，/w,可以/v,让/v,你/r,得到/v,最/d,大/a,的/u,报酬/n,。/w,因此/c,，/w,我们/r,采取/v,这/r,一条/mq,路/n,。/w,至此/d,，/w,我们/r,的/u,策略/n,就/d,是/v,采取/v,{/w,a/en, ,-/w,>, ,d/en, ,-/w,>, ,f/en,}/w,，/w,我们/r,获得/v,的/u,回报/vn,是/v,-/w,120/m,。/w,恭喜/v,！/w,你/r,刚刚/d,就/d,实现/v,了/u,强化/v,学习/v,算法/n,。/w,这种/r,算法/n,被/p,称之为/v, ,epsilon/en, ,贪婪/an,算法/n,。/w,这/r,是/v,一种/mq,逐步/d,测试/vn,从而/c,解决/v,问题/n,的/u,贪婪/an,算法/n,。/w,现在/t,，/w,如果/c,见/v,你/r,（/w,推销员/n,）/w,想/v,再次/d,从/p,地点/n,a/en,到/v,地点/n,f/en,，/w,你/r,总是/d,会/v,选择/v,这/r,一条/mq,路/n,了/u,。/w,其他/r,旅游/vn,方式/n,？/w,你/r,能/v,猜/v,出/v,我们/r,的/u,策略/n,是/v,属于/v,哪个/r,类别/n,（/w,纯粹/b,的/u,探索/v,还是/c,纯粹/b,的/u,开发/v,）/w,吗/y,？/w,请/v,注意/v,，/w,我们/r,采取/v,的/u,策略/n,并/c,不/d,是/v,一个/m,最佳/z,策略/n,。/w,我们/r,必须/d,“/w,探索/v,”/w,一点/m,，/w,然后/c,去/v,寻找/v,最佳/z,的/u,策略/n,。/w,在/p,这里/r,，/w,我们/r,采取/v,的/u,方法/n,是/v,局域/nw,策略/n,的/u,而/c,学习/v,，/w,我们/r,的/u,任务/n,是/v,在/p,所有/b,可能/v,的/u,策略/n,中/f,找到/v,最佳/z,的/u,策略/n,。/w,有/v,很多/m,的/u,方法/n,都/d,可以/v,解决/v,这个/r,问题/n,，/w,在/p,这里/r,，/w,我们/r,简要/ad,的/u,列出/v,一些/m,主要/b,类别/n,：/w,策略/n,优先/v,：/w,我们/r,的/u,重点/n,是/v,找到/v,最佳/z,的/u,策略/n,回报/vn,优先/v,：/w,我们/r,的/u,重点/n,是/v,找到/v,最佳/z,的/u,回报/vn,价值/n,，/w,即/v,累计/v,奖励/vn,行动/vn,优先/v,：/w,我们/r,的/u,重点/n,是/v,在/p,每个/r,步骤/n,上/f,采取/v,最佳/z,行动/vn,在/p,以后/f,的/u,文章/n,中/f,，/w,我/r,会/v,深入/v,讨论/v,强化/v,学习/v,算法/n,。/w,到/v,那时/r,，/w,你/r,可以/v,参考/v,这/r,篇/q,关于/p,强化/v,学习/v,算法/n,调研/vn,的/u,论文/n,。/w,4/m,./w,强化/v,学习/v,的/u,实现/v,接下来/l,，/w,我们/r,将/d,使用/v,深度/n,q/en,学习/v,算法/n,。/w,q/en,学习/v,是/v,一种/mq,基于/p,策略/n,的/u,学习/v,算法/n,，/w,它/r,具有/v,和/c,神经/n,网络/n,近似/a,的/u,函数/n,表示/v,。/w,这个/r,算法/n,被/p,google/en,使用/v,，/w,并且/c,打败/v,了/u,atari/en,游戏/n,。/w,让/v,我们/r,看看/v,q/en,学习/v,的/u,伪代码/nw,：/w,1/m,./w,初始化/v,价值/n,表/n, ,‘/w,q/en,(/w,s/en,,/w, ,a/en,)/w,’/w,./w,2/m,./w,观察/v,当前/t,的/u,状态值/n, ,‘/w,s/en,’/w,./w,3/m,./w,基于/p,动作/n,选择/v,一个/m,策略/n,（/w,例如/v,，/w,epsilon/en,贪婪/an,）/w,作为/v,该/r,状态/n,选择/v,的/u,动作/n,./w,4/m,./w,根据/p,这个/r,动作/n,，/w,观察/v,回报/vn,价值/n, ,’/w,r/en,’/w, ,和/c,下/f,一个/m,新/a,的/u,状态/n, ,s/en,./w,5/m,./w,使用/v,观察/v,到/v,的/u,奖励/vn,和/c,可能/v,的/u,下/f,一个/m,状态/n,所/u,获得/v,的/u,最/d,大/a,奖励/vn,来/v,更新/v,状态/n,的/u,值/n,。/w,根据/p,上述/b,公式/n,和/c,参数/n,进行/v,更新/v,。/w,6/m,./w,将/d,状态/n,设置/v,为/p,新/a,的/u,状态/n,，/w,并且/c,重复/v,上述/b,过程/n,，/w,直到/v,达到/v,最终/d,状态/n,。/w,q/en,学习/v,的/u,简单/a,描述/v,可以/v,总结/v,如下/v,：/w,我们/r,首先/d,来/v,了解/v,一下/m, ,cartpole/en, ,问题/n,，/w,然后/c,继续/v,编写/v,我们/r,的/u,解决/v,方案/n,。/w,当/p,我/r,还是/c,一个/m,孩子/n,的/u,时候/n,，/w,我/r,记得/v,我/r,会/v,选择/v,一根/mq,木棍/n,，/w,并/c,试图/v,用/p,一只/mq,手指/n,去/v,使/v,它/r,保持/v,平衡/a,。/w,我/r,和/c,我/r,的/u,朋友/n,过去/t,有/v,这样/r,一个/m,比赛/vn,，/w,看/v,谁/r,能/v,让/v,木棍/n,保持/v,平衡/a,的/u,时间/n,更/d,多/a,，/w,谁/r,就/d,能/v,得到/v,一块/s,巧克力/n,作为/v,奖励/vn,。/w,这里/r,有/v,一个/m,简单/a,的/u,视频/n,来/v,描述/v,一个/m,真正/d,的/u, ,cart/en,-/w,pole/en, ,系统/n,。/w,让/v,我们/r,开始/v,编写/v,代码/n,吧/y,！/w,在/p,开始/v,编写/v,之前/f,，/w,我们/r,需要/v,先/d,安装/v,几/m,个/q,软件/n,。/w,步骤/n,一/m,：/w,安装/v, ,keras/en,-/w,rl/en,包/v,在/p,终端/n,中/f,，/w,你/r,可以/v,运行/vn,以下/f,命令/n,：/w,git/en, ,clone/en, ,https/en,:/w,//w,//w,github/en,./w,com/en,//w,matthiasplappert/en,//w,keras/en,-/w,rl/en,./w,git/en, ,cd/en, ,keras/en,-/w,rl/en, ,python/en, ,setup/en,./w,py/en, ,install/en,步骤/n,二/m,：/w,安装/v,cartpole/en,环境/n,的/u,依赖/v,我们/r,假设/v,你/r,已经/d,安装/v,好/a,了/u,pip/en,，/w,那么/r,你/r,只/d,需要/v,使用/v,以下/f,命令/n,进行/v,安装/v,：/w,pip/en, ,install/en, ,h/en,5/m,py/en, ,pip/en, ,install/en, ,gym/en,步骤/n,三/m,：/w,开始/v,编写/v,代码/n,首先/d,我们/r,需要/v,导入/v,一些/m,我们/r,需要/v,的/u,模块/n,import/en, ,numpy/en, ,as/en, ,np/en, ,import/en, ,gym/en, ,from/en, ,keras/en,./w,models/en, ,import/en, ,sequential/en, ,from/en, ,keras/en,./w,layers/en, ,import/en, ,dense/en,,/w, ,activation/en,,/w, ,flatten/en, ,from/en, ,keras/en,./w,optimizers/en, ,import/en, ,adam/en, ,from/en, ,rl/en,./w,agents/en,./w,dqn/en, ,import/en, ,dqnagent/en, ,from/en, ,rl/en,./w,policy/en, ,import/en, ,epsgreedyqpolicy/en, ,from/en, ,rl/en,./w,memory/en, ,import/en, ,sequentialmemory/en,然后/c,，/w,设置/v,相关/v,变量/n,env/en,_,name/en, ,=/w, ,'/w,cartpole/en,-/w,v/en,0/m,'/w, ,#, ,get/en, ,the/en, ,environment/en, ,and/en, ,extract/en, ,the/en, ,number/en, ,of/en, ,actions/en, ,available/en, ,in/en, ,the/en, ,cartpole/en, ,problem/en, ,env/en, ,=/w, ,gym/en,./w,make/en,(/w,env/en,_,name/en,)/w, ,np/en,./w,random/en,./w,seed/en,(/w,123/m,)/w, ,env/en,./w,seed/en,(/w,123/m,)/w, ,nb/en,_,actions/en, ,=/w, ,env/en,./w,action/en,_,space/en,./w,n/en,之后/f,，/w,我们/r,来/v,构建/v,一个/m,非常/d,简单/a,的/u,单/d,层/q,神经/n,网络/n,模型/n,。/w,model/en, ,=/w, ,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,flatten/en,(/w,input/en,_,shape/en,=/w,(/w,1/m,,/w,)/w, ,+/w, ,env/en,./w,observation/en,_,space/en,./w,shape/en,)/w,)/w, ,model/en,./w,add/en,(/w,dense/en,(/w,16/m,)/w,)/w, ,model/en,./w,add/en,(/w,activation/en,(/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,dense/en,(/w,nb/en,_,actions/en,)/w,)/w, ,model/en,./w,add/en,(/w,activation/en,(/w,'/w,linear/en,'/w,)/w,)/w, ,print/en,(/w,model/en,./w,summary/en,(/w,)/w,)/w,接下来/l,，/w,我们/r,配置/vn,和/c,编译/vn,我们/r,的/u,智能体/nw,。/w,我们/r,将/d,策略/n,设置/v,为/p, ,epsilon/en, ,贪婪/an,，/w,我们/r,还/d,将/d,我们/r,的/u,存储/vn,空间/n,设置/v,为/p,序列/n,存储/vn,，/w,因为/c,我们/r,要/v,需要/v,存储/vn,我们/r,执行/v,操作/v,的/u,结果/n,和/c,每/r,一个/m,操作/v,所/u,获得/v,的/u,奖励/vn,。/w,policy/en, ,=/w, ,epsgreedyqpolicy/en,(/w,)/w, ,memory/en, ,=/w, ,sequentialmemory/en,(/w,limit/en,=/w,50000/m,,/w, ,window/en,_,length/en,=/w,1/m,)/w, ,dqn/en, ,=/w, ,dqnagent/en,(/w,model/en,=/w,model/en,,/w, ,nb/en,_,actions/en,=/w,nb/en,_,actions/en,,/w, ,memory/en,=/w,memory/en,,/w, ,nb/en,_,steps/en,_,warmup/en,=/w,10/m,,/w, ,target/en,_,model/en,_,update/en,=/w,1/m,e/en,-/w,2/m,,/w, ,policy/en,=/w,policy/en,)/w, ,dqn/en,./w,compile/en,(/w,adam/en,(/w,lr/en,=/w,1/m,e/en,-/w,3/m,)/w,,/w, ,metrics/en,=/w,[/w,'/w,mae/en,'/w,]/w,)/w, ,#, ,okay/en,,/w, ,now/en, ,it/en,'/w,s/en, ,time/en, ,to/en, ,learn/en, ,something/en,!/w, ,we/en, ,visualize/en, ,the/en, ,training/en, ,here/en, ,for/en, ,show/en,,/w, ,but/en, ,this/en, ,slows/en, ,down/en, ,training/en, ,quite/en, ,a/en, ,lot/en,./w, ,dqn/en,./w,fit/en,(/w,env/en,,/w, ,nb/en,_,steps/en,=/w,5000/m,,/w, ,visualize/en,=/w,true/en,,/w, ,verbose/en,=/w,2/m,)/w,现在/t,，/w,让/v,我们/r,来/v,测试/vn,一下/m,我们/r,的/u,强化/v,学习/v,模型/n,dqn/en,./w,test/en,(/w,env/en,,/w, ,nb/en,_,episodes/en,=/w,5/m,,/w, ,visualize/en,=/w,true/en,)/w,下/f,图/n,是/v,模型/n,的/u,输出/v,结果/n,：/w,瞧/v,，/w,你/r,刚刚/d,就/d,建立/v,了/u,一个/m,强化/v,学习/v,机器人/n,！/w,5/m,./w,增加/v,复杂性/n,现在/t,，/w,你/r,已经/d,看到/v,了/u,强化/v,学习/v,的/u,一个/m,基本/a,实现/v,，/w,让/v,我们/r,开始/v,学习/v,更/d,多/a,的/u,问题/n,吧/y,，/w,每次/r,增加/v,一点点/nw,复杂性/n,。/w,汉诺塔/nr,问题/n,对于/p,那些/r,不/d,知道/v,比赛/vn,的/u,人/n,来说/u,，/w,汉诺塔/nr,问题/n,是/v,在/p,1883年/t,发明/v,的/u,。/w,它/r,是/v,由/p,3根/mq,木棍/n,和/c,一系列/mq,大小/n,不一/v,的/u,圆盘/n,组成/v,的/u,（/w,比如/v,，/w,上图/n,中/f,的/u,3个/m,）/w,。/w,从/p,最/d,左侧/f,的/u,