一/m,、/w,引言/n,本/r,材料/n,参考/v,andrew/en, ,ng/en,大神/nz,的/u,机器/n,学习/v,课程/n, ,http/en,:/w,//w,//w,cs/en,229/m,./w,stanford/en,./w,edu/en,，/w,以及/c,斯坦福/nr,无/v,监督/vn,学习/v,ufldl/en, ,tutorial/en, ,http/en,:/w,//w,//w,ufldl/en,./w,stanford/en,./w,edu/en,//w,wiki/en,//w,index/en,./w,php/en,//w,ufldl/en,_,tutorial/en,机器/n,学习/v,中/f,的/u,回归/v,问题/n,属于/v,有/v,监督/vn,学习/v,的/u,范畴/n,。/w,回归/v,问题/n,的/u,目标/n,是/v,给定/vn,d/en,维/q,输入/v,变量/n,x/en,，/w,并且/c,每/r,一个/m,输入/v,矢量/n,x/en,都/d,有/v,对应/v,的/u,值/n,y/en,，/w,要求/v,对于/p,新/a,来/v,的/u,数据/n,预测/v,它/r,对应/v,的/u,连续/a,的/u,目标值/n,t/en,。/w,比如/v,下面/f,这个/r,例子/n,：/w,假设/v,我们/r,有/v,一个/m,包含/v,47个/m,房子/n,的/u,面积/n,和/c,价格/n,的/u,数据集/nw,如下/v,：/w,我们/r,可以/v,在/p,matlab/en,中/f,画/v,出来/v,这/r,组/q,数据集/nw,，/w,如下/v,：/w,看到/v,画/v,出来/v,的/u,点/q,，/w,是不是/v,有点/d,像/v,一条/mq,直线/n,？/w,我们/r,可以/v,用/p,一条/mq,曲线/n,去/v,尽量/d,拟合/nz,这些/r,数据点/nw,，/w,那么/r,对于/p,新/a,来/v,的/u,输入/v,，/w,我么/nw,就/d,可以/v,将/d,拟合/nz,的/u,曲线/n,上/f,返回/v,对应/v,的/u,点/q,从而/c,达到/v,预测/v,的/u,目的/n,。/w,如果/c,要/v,预测/v,的/u,值/n,是/v,连续/a,的/u,比如/v,上述/b,的/u,房价/n,，/w,那么/r,就/d,属于/v,回归/v,问题/n,；/w,如果/c,要/v,预测/v,的/u,值/n,是/v,离散/vn,的/u,即/v,一个个/nw,标签/n,，/w,那么/r,就/d,属于/v,分类/vn,问题/n,。/w,这个/r,学习/v,处理/v,过程/n,如下/v,图/n,所/u,示/vg,：/w,上述/b,学习/v,过程/n,中/f,的/u,常用/a,术语/n,：/w,包含/v,房子/n,面积/n,和/c,价格/n,的/u,数据集/nw,称为/v,训练/vn,集/vg,training/en, ,set/en,；/w,输入/v,变量/n,x/en,（/w,本例/nw,中/f,为/p,面积/n,）/w,为/p,特征/n,features/en,；/w,输出/v,的/u,预测值/n,y/en,（/w,本例/nw,中/f,为/p,房价/n,）/w,为/p,目标值/n,target/en,；/w,拟合/nz,的/u,曲线/n,，/w,一般/a,表示/v,为/p,y/en, ,=/w, ,h/en,(/w,x/en,)/w,，/w,称为/v,假设/v,模型/n,hypothesis/en,；/w,训练/vn,集/vg,的/u,条目数/nw,称为/v,特征/n,的/u,维数/nr,，/w,本例/nw,为/p,47/m,。/w,二/m,、/w,线性/n,回归/v,模型/n,线性/n,回归/v,模型/n,假设/v,输入/v,特征/n,和/c,对应/v,的/u,结果/n,满足/v,线/n,性关系/n,。/w,在/p,上述/b,的/u,数据/n,集中/v,加上/v,一/m,维--/nrf,房间/n,数量/n,，/w,于是/c,数据集/nw,变为/v,：/w,于是/c,，/w,输入/v,特征/n,x/en,是/v,二维/nr,的/u,矢量/n,，/w,比如/v,x/en,1/m,(/w,i/en,)/w,表示/v,数据/n,集中/v,第/m,i/en,个/q,房子/n,的/u,面积/n,，/w,x/en,2/m,(/w,i/en,)/w,表示/v,数据/n,集中/v,第/m,i/en,个/q,房子/n,的/u,房间/n,数量/n,。/w,于是/c,可以/v,假设/v,输入/v,特征/n,x/en,与/p,房价/n,y/en,满足/v,线性/n,函数/n,，/w,比如/v,：/w,这里/r,θ,i/en,称为/v,假设/v,模型/n,即/v,映射/v,输入/v,特征/n,x/en,与/p,结果/n,y/en,的/u,线性/n,函数/n,h/en,的/u,参数/n,parameters/en,，/w,为了/p,简化/v,表示/v,，/w,我们/r,在/p,输入/v,特征/n,中/f,加入/v,x/en,0/m, ,=/w, ,1/m,，/w,于是/c,得到/v,：/w,参数/n,θ,和/c,输入/v,特征/n,x/en,都/d,为/p,矢量/n,，/w,n/en,是/v,输入/v,的/u,特征/n,x/en,的/u,个数/n,（/w,不/d,包含/v,x/en,0/m,）/w,。/w,现在/t,，/w,给/p,定/v,一个/m,训练/vn,集/vg,，/w,我们/r,应该/v,怎么/r,学习/v,参数/n,θ,，/w,从而/c,达到/v,比较/d,好/a,的/u,拟合/nz,效果/n,呢/y,？/w,一个/m,直观/a,的/u,想法/n,是/v,使得/v,预测/v,值/n,h/en,(/w,x/en,)/w,尽可能/d,接近/v,y/en,，/w,为了/p,达到/v,这个/r,目的/n,，/w,我们/r,对于/p,每/r,一个/m,参数/n,θ,，/w,定义/n,一个/m,代价/n,函数/n,cost/en, ,function/en,用/p,来/v,描述/v,h/en,(/w,x/en,(/w,i/en,)/w,)/w,'/w,与/p,对应/v,的/u,y/en,(/w,i/en,)/w,'/w,的/u,接近/v,程度/n,：/w,前面/f,乘/v,上/f,的/u,1/m,//w,2/m,是/v,为了/p,求导/nw,的/u,时候/n,，/w,使/v,常数/n,系数/n,消失/v,。/w,于是/c,我们/r,的/u,目标/n,就/d,变为/v,了/u,调整/vn,θ,使得/v,代价/n,函数/n,j/en,(/w,θ,)/w,取得/v,最小值/nz,，/w,方法/n,有/v,梯度/n,下降/v,法/j,，/w,最小二乘法/nw,等/u,。/w,2.1/m, ,梯度/n,下降/v,法/j,现在/t,我们/r,要/v,调整/vn,θ,使得/v,j/en,(/w,θ,)/w,取得/v,最小值/nz,，/w,为了/p,达到/v,这个/r,目的/n,，/w,我们/r,可以/v,对/p,θ取/nw,一个/m,随机/d,初始值/n,（/w,随机/d,初始化/v,的/u,目的/n,是/v,使/v,对称/ad,失效/v,）/w,，/w,然后/c,不断/d,地/u,迭代/vn,改变/v,θ,的/u,值/n,来/v,使/v,j/en,(/w,θ,)/w,减小/v,，/w,知道/v,最终/d,收敛/vn,取得/v,一个/m,θ值/nw,使得/v,j/en,(/w,θ,)/w,最小/a,。/w,梯度/n,下降/v,法/j,就/d,采用/v,这样/r,的/u,思想/n,：/w,对/p,θ,设定/v,一个/m,随机/d,初值/n,θ,0/m,，/w,然后/c,迭代/vn,进行/v,以下/f,更新/v,直到/v,收敛/vn,。/w,这里/r,的/u,α称/nw,为/p,学习/v,率/v,learning/en, ,rate/en,。/w,梯度/n,方向/n,由/p,j/en,(/w,θ,)/w,对/p,θ, ,的/u,偏导/nw,数/m,决定/v,，/w,由于/c,要求/v,的/u,是/v,最小值/nz,，/w,因此/c,对/p,偏导/nw,数/m,取/v,负/v,值得/v,到/v,梯度/n,方向/n,。/w,将/d,j/en,(/w,θ,)/w,代/q,入/v,得到/v,总/b,的/u,更新/v,公式/n,这样/r,的/u,更新/v,规则/n,称为/v,lms/en, ,update/en, ,rule/en,（/w,least/en, ,mean/en, ,squares/en,）/w,，/w,也/d,称为/v,widrow/en,-/w,ho/en,ﬀ, ,learning/en, ,rule/en,。/w,对于/p,如下/v,更新/v,参数/n,的/u,算法/n,：/w,由于/c,在/p,每/r,一次/mq,迭代/vn,都/d,考察/v,训练/vn,集/vg,的/u,所有/b,样本/n,，/w,而/c,称为/v,批量/d,梯度/n,下降/v,batch/en, ,gradient/en, ,descent/en,。/w,对于/p,引言/n,中/f,的/u,房价/n,数据集/nw,，/w,运行/vn,这种/r,算法/n,，/w,可以/v,得到/v,θ,0/m, ,=/w, ,71.27/m,,/w, ,θ,1/m, ,=/w, ,1.1345/m,，/w,拟合/nz,曲线/n,如下/v,图/n,：/w,如果/c,参数/n,更新/v,计算/v,算法/n,如下/v,：/w,这里/r,我们/r,按照/p,单个/b,训练/vn,样本/n,更新/v,θ,的/u,值/n,，/w,称为/v,随机/d,梯度/n,下降/v,stochastic/en, ,gradient/en, ,descent/en,。/w,比较/d,这/r,两种/mq,梯度/n,下降/v,算法/n,，/w,由于/c,batch/en, ,gradient/en, ,descent/en,在/p,每/r,一步/mq,都/d,考虑/v,全部/m,数据集/nw,，/w,因而/c,复杂度/nw,比较/d,高/a,，/w,随机/d,梯度/n,下降/v,会/v,比较/d,快/a,地/u,收敛/vn,，/w,而且/c,在/p,实际/n,情况/n,中/f,两种/mq,梯度/n,下降/v,得到/v,的/u,最/d,优解/nw,j/en,(/w,θ,)/w,一般/a,会/v,接近/v,真实/a,的/u,最小值/nz,。/w,所以/c,对于/p,较/d,大/a,的/u,数据集/nw,，/w,一般/a,采用/v,效率/n,较/d,高/a,的/u,随机/d,梯度/n,下降/v,法/j,。/w,2.2/m, ,最小二乘法/nw,（/w,lms/en,）/w,梯度/n,下降/v,算法/n,给/p,出/v,了/u,一种/mq,计算θ/nw,的/u,方法/n,，/w,但是/c,需要/v,迭代/vn,的/u,过程/n,，/w,比较/d,费时/a,而且/c,不/d,太/d,直观/a,。/w,下面/f,介绍/v,的/u,最小二乘法/nw,是/v,一种/mq,直观/a,的/u,直接/ad,利用/v,矩阵/n,运算/vn,可以/v,得到/v,θ值/nw,的/u,算法/n,。/w,为了/p,理解/v,最小二乘法/nw,，/w,首先/d,回顾/v,一下/m,矩阵/n,的/u,有关/vn,运算/vn,：/w,假设/v,函数/n,f/en,是/v,将/d,m/en,*/w,n/en,维/q,矩阵/n,映射/v,为/p,一个/m,实数/n,的/u,运算/vn,，/w,即/v,，/w,并且/c,定义/n,对于/p,矩阵/n,a/en,，/w,映射/v,f/en,(/w,a/en,)/w,对/p,a/en,的/u,梯度/n,为/p,：/w,因此/c,该/r,梯度/n,为/p,m/en,*/w,n/en,的/u,矩阵/n,。/w,例如/v,对于/p,矩阵/n,a/en,=/w,，/w,而且/c,映射/v,函数/n,f/en,(/w,a/en,)/w,定义/n,为/p,：/w,f/en,(/w,a/en,)/w, ,=/w, ,1.5/m,a/en,11/m, ,+/w, ,5/m,a/en,122/m, ,+/w, ,a/en,21/m,a/en,22/m,，/w,于是/c,梯度/n,为/p,：/w,。/w,另外/c,，/w,对于/p,矩阵/n,的/u,迹/ng,的/u,梯度/n,运算/vn,，/w,有/v,如下/v,规则/n,：/w,。/w,下面/f,，/w,我们/r,将/d,测试/vn,集中/v,的/u,输入/v,特征/n,x/en,和/c,对应/v,的/u,结果/n,y/en,表示/v,成/v,矩阵/n,或者/c,向量/n,的/u,形式/n,，/w,有/v,：/w,，/w,，/w,对于/p,预测/v,模型/n,有/v,，/w,即/v,，/w,于是/c,可以/v,很/d,容易/a,得到/v,：/w,，/w,所以/c,可以/v,得到/v,。/w,于是/c,，/w,我们/r,就/d,将/d,代价/n,函数/n,j/en,(/w,θ,)/w,表示/v,为了/p,矩阵/n,的/u,形式/n,，/w,就/d,可以/v,用/p,上述/b,提到/v,的/u,矩阵/n,运算/vn,来/v,得到/v,梯度/n,：/w,，/w,令/v,上述/b,梯度/n,为/p,0/m,，/w,得到/v,等/u,式/k,：/w,，/w,于是/c,得到/v,θ,的/u,值/n,：/w,。/w,这/r,就/d,是/v,最小二乘法/nw,得到/v,的/u,假设/v,模型/n,中/f,参数/n,的/u,值/n,。/w,2.3/m, ,加权线性/nw,回归/v,首先/d,考虑/v,下/f,图/n,中/f,的/u,几/m,种/q,曲线/n,拟合/nz,情况/n,：/w,最/d,左边/f,的/u,图/n,使用/v,线性/n,拟合/nz,，/w,但是/c,可以/v,看到/v,数据点/nw,并/c,不/d,完全/ad,在/p,一条/mq,直线/n,上/f,，/w,因而/c,拟合/nz,的/u,效果/n,并/c,不/d,好/a,。/w,如果/c,我们/r,加入/v,x/en,2项/mq,，/w,得到/v,，/w,如/v,中间/f,图/n,所/u,示/vg,，/w,该/r,二次/mq,曲线/n,可以/v,更/d,好/a,的/u,拟合/nz,数据点/nw,。/w,我们/r,继续/v,加入/v,更/d,高/a,次项/nw,，/w,可以/v,得到/v,最/d,右边/f,图/n,所/u,示/vg,的/u,拟合/nz,曲线/n,，/w,可以/v,完美/a,地/u,拟合/nz,数据点/nw,，/w,最/d,右边/f,的/u,图/n,中/f,曲线/n,为/p,5/m,阶/ng,多/a,项/q,式/k,，/w,可是/c,我们/r,都/d,很/d,清醒/a,地/u,知道/v,这个/r,曲线/n,过于/d,完美/a,了/u,，/w,对于/p,新/a,来/v,的/u,数据/n,可能/v,预测/v,效果/n,并/c,不/d,会/v,那么/r,好/a,。/w,对于/p,最/d,左边/f,的/u,曲线/n,，/w,我们/r,称之为/v,欠/v,拟合/nz,--/nrf,过/u,小/a,的/u,特征/n,集合/v,使得/v,模型/n,过于/d,简单/a,不/d,能/v,很/d,好/a,地/u,表达/v,数据/n,的/u,结构/n,，/w,最/d,右边/f,的/u,曲线/n,我们/r,称之为/v,过/u,拟合/nz,--/nrf,过/u,大/a,的/u,特征/n,集合/v,使得/v,模型/n,过于/d,复杂/a,。/w,正如/v,上述/b,例子/n,表明/v,，/w,在/p,学习/v,过程/n,中/f,，/w,特征/n,的/u,选择/v,对于/p,最终/d,学习/v,到/v,的/u,模型/n,的/u,性能/n,有/v,很/d,大/a,影响/vn,，/w,于是/c,选择/v,用/p,哪个/r,特征/n,，/w,每个/r,特征/n,的/u,重要性/n,如何/r,就/d,产生/v,了/u,加权/v,的/u,线性/n,回归/v,。/w,在/p,传统/n,的/u,线性/n,回归/v,中/f,，/w,学习/v,过程/n,如下/v,：/w,，/w,而/c,加权线性/nw,回归/v,学习/v,过程/n,如下/v,：/w,。/w,二者/r,的/u,区别/n,就/d,在于/v,对/p,不同/a,的/u,输入/v,特征/n,赋予/v,了/u,不同/a,的/u,非/h,负值/n,权重/nz,，/w,权/n,重/a,越/d,大/a,，/w,对于/p,代价/n,函数/n,的/u,影响/vn,越/d,大/a,。/w,一般/a,选取/v,的/u,权重/nz,计算/v,公式/n,为/p,：/w,，/w,其中/r,，/w,x/en,是/v,要/v,预测/v,的/u,特征/n,，/w,表示/v,离/v,x/en,越/d,近/a,的/u,样本/n,权/n,重/a,越/d,大/a,，/w,越/d,远/a,的/u,影响/vn,越/d,小/a,。/w,三/m,、/w,logistic/en,回归/v,与/p,softmax/en,回归/v,3.1/m, ,logistic/en,回归/v,下面/f,介绍/v,一下/m,logistic/en,回归/v,，/w,虽然/c,名曰/v,回归/v,，/w,但/c,实际上/d,logistic/en,回归/v,用于/v,分类/vn,问题/n,。/w,logistic/en,回归/v,实质/n,上/f,还是/c,线性/n,回归/v,模型/n,，/w,只是/d,在/p,回归/v,的/u,连续/a,值/n,结果/n,上/f,加/v,了/u,一层/mq,函数/n,映射/v,，/w,将/d,特征线性/nw,求和/vn,，/w,然后/c,使用/v,g/en,(/w,z/en,)/w,作/v,映射/v,，/w,将/d,连续/a,值/n,映射/v,到/v,离/v,散值/nw,0/m,//w,1/m,上/f,（/w,对于/p,sigmoid/en,函数/n,为/p,0/m,//w,1两/mq,类/q,，/w,而/c,对于/p,双曲/nw,正弦/n,tanh/en,函数/n,为/p,1/m,//w,-/w,1两/mq,类/q,）/w,。/w,采用/v,假设/v,模型/n,为/p,：/w,，/w,而/c,sigmoid/en,函数/n,g/en,(/w,z/en,)/w,为/p,：/w,当/p,z/en,趋/v,近/a,于/p,-/w,∞/w,，/w,g/en,(/w,z/en,)/w,趋/v,近/a,于/p,0/m,，/w,而/c,z/en,趋/v,近/a,于/p,∞/w,，/w,g/en,(/w,z/en,)/w,趋/v,近/a,于/p,1/m,，/w,从而/c,达到/v,分类/vn,的/u,目的/n,。/w,这里/r,的/u,那么/r,对于/p,这样/r,的/u,logistic/en,模型/n,，/w,怎么/r,调整/vn,参数/n,θ,呢/y,？/w,我们/r,假设/v,，/w,由于/c,是/v,两类/mq,问题/n,，/w,即/v,，/w,于是/c,得到/v,似然/nw,估计/v,为/p,：/w,对/p,似然/nw,估计/v,取/v,对数/n,可以/