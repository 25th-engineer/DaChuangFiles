欢迎/v,大家/r,前往/v,腾讯云/nw,技术/n,社区/n,，/w,获取/v,更/d,多/a,腾讯/nt,海量/n,技术/n,实践/v,干货/n,哦/e,~/w,作者/n,：/w,李春晓/nr,导语/n,：/w,“/w,从/p,入门/v,到/v,第一/m,个/q,模型/n,”/w,差点/d,就/d,成/v,了/u,“/w,从/p,入门/v,到/v,放弃/v,”/w,。/w,本文/r,是/v,机器/n,学习/v,在/p,运维/nr,场景/n,下/f,的/u,一次/mq,尝试/vn,，/w,用/p,一个/m,模型/n,实现/v,了/u,业务/n,规律/n,挖掘/v,和/c,异常/a,检测/vn,。/w,这/r,只是/d,一次/mq,尝试/vn,，/w,能否/v,上/f,线/n,运转/v,还/d,有待/v,考究/a,。/w,试/v,了/u,几/m,个/q,业务/n,的/u,数据/n,，/w,看似/v,有效/a,，/w,心里/s,却/d,仍然/d,忐忑/a,，/w,担心/v,哪里/r,出错/v,或者/c,有/v,未/d,考虑/v,到/v,的/u,坑/n,，/w,将/d,模型/n,介绍/v,如下/v,，/w,请/v,大侠/n,们/k,多多/d,指教/v,，/w,帮忙/v,指出/v,可能/v,存在/v,的/u,问题/n,，/w,一起/s,交流/vn,哈/j,。/w,背景/n,:/w,业务/n,运维/nr,需要/v,对/p,业务/n,基础/n,体验/vn,指标/n,负责/v,，/w,过去/t,的/u,分析/vn,都/d,是/v,基于/p,大/a,数据/n,，/w,统计/v,各个/r,维度/n,及其/c,组合/v,下/f,关键/n,指标/n,的/u,表现/v,。/w,比如/v,我们/r,可以/v,统计/v,到/v,不同/a,网络/n,制式/n,下/f,打开/v,一个/m,app/en,的/u,速度/n,（/w,耗时/v,）/w,，/w,也/d,可以/v,获取/v,不同/a,命令/n,字/n,的/u,成功率/n,。/w,针对/p,移动/vn,app/en,类/q,业务/n,，/w,基于/p,经验/n,，/w,我们/r,在/p,分析/vn,一个/m,指标/n,时/ng,都/d,会/v,考虑/v,这些/r,因素/n,：/w,app/en,版本/n,、/w,指标/n,相关/v,的/u,特/d,有/v,维度/n,（/w,比如/v,图片/n,下载/v,要/v,考虑/v,size/en,、/w,图片/n,类型/n,；/w, ,视频/n,点播/v,类/q,要/v,考虑/v,视频/n,类型/n,、/w,播放器/n,类型/n,等/u,）/w,、/w,用户/n,信息/n,（/w,网络/n,制式/n,、/w,省份/n,、/w,运营商/nw,、/w,城市/n,）/w,等/u,。/w,这些/r,维度/n,综合/vn,作用/n,影响/vn,关键/n,指标/n,，/w,那么/r,哪些/r,维度/n,组合/v,一定/d,好/a,，/w,哪些/r,一定/d,不好/a,？/w,耗时/v,类/q,指标/n,的/u,表现/v,往往/d,呈现/v,准/a,正态分布/n,趋势/n,，/w,其/r,长尾/nw,永远/d,存在/v,并且/c,无法/v,消除/v,，/w,这种/r,情况/n,要/v,不/d,要/v,关注/v,？/w, ,针对/p,命令/n,字/n,成功率/n,，/w,有些/r,命令/n,字/n,成功率/n,低/a,是/v,常态/n,，/w,要/v,不/d,要/v,告警/v,？/w,过去/t,我们/r,会/v,通过/p,在/p,监控/vn,中/f,设置/v,特例/n,来/v,避免/v,告警/v,。/w,有/v,没有/v,一种/mq,方法/n,，/w,能/v,自动/d,识别/v,常态/n,与/p,非常态/n,？/w,在/p,机器/n,学习/v,如火如荼/i,的/u,现在/t,，/w,也许/d,可以/v,试/v,一/m,试/v,。/w,目标/n,：/w,挖掘/v,业务/n,潜在/b,规律/n,(/w,针对/p,耗时/v,这/r,类/q,连续/a,值/n,指标/n,，/w,找/v,出/v,引起/v,长尾/nw,的/u,因素/n,)/w,监控/vn,业务/n,指标/n,时/ng,，/w,找/v,出/v,常态/n,并/c,忽略/v,常态/n,，/w,仅/d,针对/p,突发/vn,异常/a,产生/v,告警/v,并/c,给/p,出/v,异常/a,的/u,根因/nrf,。/w,之后/f,就/d,是/v,艰苦/a,的/u,屡/d,败/v,屡/d,战/vg,，/w,从/p,入门/v,到/v,差点/d,放弃/v,，/w,最终/d,搞/v,出/v,第一/m,个/q,模型/n,的/u,奋战/v,史/ng,了/u,。/w,最大/a,的/u,困难/an,是/v,没/d,写/v,过/u,代码/n,，/w,不会/v,python/en,，/w,机器/n,学习/v,理论/n,和/c,代码/n,都/d,要/v,同步/vd,学习/v,；/w,然后/c,就/d,是/v,在/p,基础/n,薄弱/a,的/u,情况/n,下/f,一/m,开始/v,还/d,太/d,贪心/v,，/w,想/v,要/v,找/v,一个/m,通用/vn,的/u,模型/n,，/w,对/p,不同/a,业务/n,、/w,不同/a,指标/n,都/d,可以/v,通用/vn,，/w,还/d,可以/v,同时/c,解决/v,两个/m,目标/n,问题/n,，/w,缺少/v,一个/m,循序渐进/i,入门/v,的/u,过程/n,，/w,难免/v,处处/d,碰壁/v,，/w,遇到/v,问题/n,解决/v,问题/n,，/w,重新/d,学习/v,。/w,好在/d,最终/d,结果/n,还是/c,出来/v,了/u,，/w,不过/c,还是/c,要/v,接受/v,教训/n,：/w,有/v,了/u,大/a,目标/n,后/f,先/d,定/v,个/q,小/a,目标/n,，/w,理清/v,思路/n,后/f,由/p,点/q,及/c,面/q,，/w,事情/n,会/v,顺利/ad,很多/m,。/w,接下来/l,直接/ad,介绍/v,模型/n,，/w,过程/n,中/f,走/v,的/u,弯路/n,就/d,忽略/v,掉/v,（/w,因为/c,太/d,多/a,太/d,弱/a,了/u,，/w,有些/r,理论/n,是/v,在/p,遇到/v,问题/n,后/f,再/d,研究/vn,才/d,搞/v,明白/v,）/w,。/w,基本/a,思路/n,：/w,1/m,./w,通过/p,学习/v,自动/d,获取/v,业务/n,规律/n,，/w,对/p,业务/n,表现/v,进行/v,预测/v,（/w,et/en,算法/n,）/w,，/w,预测/v,命中/vn,的/u,就/d,是/v,业务/n,规律/n,，/w,没/d,命中/vn,的/u,有/v,可能/v,是/v,异常/a,（/w,请/v,注意/v,，/w,是/v,有/v,可能/v,，/w,而/c,非/h,绝对/d,）/w,；/w,2/m,./w,将/d,1/m,的/u,结果/n,分别/d,输入/v,决策/n,树/v,（/w,dt/en,）/w,进行/v,可视化/nz,展示/v,；/w,用/p,预测/v,命中/vn,的/u,部分/n,生成/vn,业务/n,潜在/b,规律/n,视图/n,；/w,用/p,未/d,命中/vn,的/u,来/v,检测/vn,异常/a,，/w,并/c,展示/v,根因/nrf,。/w,步骤/n,简介/n,（/w,以/p,耗时/v,这个/r,指标/n,为/p,例/n,）/w,：/w,1/m,./w, ,准备/v,两份/mq,不/d,重合/vn,的/u,数据/n,，/w,一份/mq,用于/v,训练/vn,，/w,一份/mq,用于/v,预测/v,例/n,：/w,视频/n,播放/v,类/q,业务/n,的/u,维度/n,（/w,如/v,版本/n,，/w,机型/n,，/w,视频/n,来源/n,，/w,视频/n,编码/n,类型/n,等/u,各种/r,已/d,有/v,特征/n,）/w,，/w,及/c,耗时/v,数据/n,2/m,./w, ,将/d,目标/n,问题/n,转化/v,为/p,分类/vn,问题/n,，/w,有/v,可能/v,是/v,常见/a,的/u,二/m,分类/vn,，/w,也/d,有/v,可能/v,是/v,多/a,分类/vn,，/w,视/vg,情况/n,而/c,定/v,将/d,耗时/v,这种/r,连续性/n,指标/n,转为/v,离散/vn,值/n,，/w,目标/n,是/v,产生/v,三个/m,分类/vn,：/w,“/w,极/d,好/a,的/u,//w,0/m,”/w,，/w,“/w,一般/a,的/u,//w,1/m,”/w,，/w,“/w,极/d,差/a,的/u,//w,2/m,”/w,，/w,将/d,耗时/v,按/p,10分/mq,位/q,数/m,拆分/v,，/w,取/v,第/m,1份/mq,（/w,或者/c,前/f,2份/mq,）/w,作为/v,“/w,极/d,好/a,的/u,”/w,样本/n,，/w,中间/f,几/m,份/q,为/p,“/w,一般/a,的/u,”/w,的/u,样本/n,，/w,最后/f,1/m,（/w,或者/c,2/m,）/w,份/q,为/p,“/w,极/d,差/a,的/u,“/w,样本/n, ,。/w, ,这里/r,的/u,“/w,极/d,差/a,的/u,”/w,其实/d,就/d,是/v,正态分布/n,的/u,长尾/nw,部分/n,。/w,如/v,下/f,图/n,，/w,第一/m,列/v,是/v,耗时/v,区间/n,（/w,未/d,加/v,人工/n,定义/n,阈值/n,，/w,自动/d,获取/v,）/w,，/w,第二/m,列/v,是/v,样本量/n,。/w,3/m,./w, ,特征/n,处理/v,3.1/m, ,特征/n,数值化/nw,这里/r,表现/v,为/p,两类/mq,问题/n,，/w,但/c,处理/v,方式/n,都/d,一样/u,：/w,（/w,1/m,）/w,文本/n,转/v,数值/n,（/w,2/m,）/w,无序/b,数值/n,需要/v,削/v,掉/v,数值/n,的/u,大小/n,关系/n,,/w,比如/v,appid/en,这类/r,，/w,本身/r,是/v,无序/b,的/u,，/w,不/d,应该/v,让/v,算法/n,认为/v,65538/m,>,65537/m,方法/n,：/w,one/en,-/w,hot/en,编码/n,,/w, ,如/v,性别/n,这个/r,特征/n,有/v,三种/mq,取值/v,，/w,boy/en,,/w,girl/en,和/c,unknown/en,，/w,转换/v,为/p,三个/m,特征/n,sex/en,=/w,=/w,boy/en,,/w,sex/en,=/w,=/w,girl/en,,/w,sex/en,=/w,=/w,unknown/en,,/w, ,条件/n,满足/v,将/d,其/r,置/v,为/p,1/m,，/w,否则/c,置/v,为/p,0/m,./w,实现/v,方式/n,3种/mq,：/w,自己/r,实现/v,；/w,sklearn/en,调包/nw,；/w,pandas/en,的/u,get/en,_,dummies/en,方法/n,。/w,one/en,-/w,hot/en,编码/n,后/f,特征/n,数量/n,会/v,剧烈/a,膨胀/v,，/w,有/v,个/q,特征/n,是/v,手机/n,机型/n,，/w,处理/v,后/f,会/v,增加/v,几千/nw,维/q,，/w,同时/c,也/d,要/v,根据/p,情况/n,考虑/v,是否/v,需要/v,对/p,特征/n,做/v,过于/d,细化/v,的/u,处理/v,。/w,3.2/m, ,特征/n,降维/nw,是否/v,需要/v,降维/nw,，/w,视/vg,情况/n,而/c,定/v,，/w,我/r,这里/r,做/v,了/u,降维/nw,，/w,因为/c,特征/n,太/d,多/a,了/u,，/w,如果/c,不/d,降维/nw,，/w,最终/d,的/u,树会/nw,非常/d,庞大/a,，/w,无法/v,突出/a,关键/n,因素/n,。/w,所谓/v,降维/nw,，/w,也/d,就/d,是/v,需要/v,提取/v,出/v,特征/n,中/f,对/p,结果/n,起/v,到/v,关键/n,影响/vn,因素/n,的/u,特征/n,，/w,去掉/v,不/d,重要/a,的/u,信息/n,和/c,多余/a,信息/n,，/w,理论/n,不/d,详述/v,了/u,，/w,参考/v,：/w,http/en,:/w,//w,//w,sklearn/en,./w,lzjqsdd/en,./w,com/en,//w,modules/en,//w,feature/en,_,selection/en,./w,html/en,本文/r,用/p,了/u,et/en,的/u,feature/en,_,importance/en,这个/r,特性/n,做/v,降维/nw,，/w,将/d,5000/m,+/w,维/q,的/u,数据/n,降/v,至/p,300/m,左右/m,4/m,./w, ,用/p,et/en,算法/n,（/w,随机/d,森林/n,的/u,变种/n,，/w,extratreesclassifier/en,）/w,训练/vn,一个/m,分类/vn,模型/n,（/w,三/m,分类/vn,）/w,4.1/m, ,评价/v,模型/n,的/u,指标/n,选取/v,对于/p,分类/vn,算法/n,，/w,我们/r,首先/d,想到/v,的/u,准确性/n, ,precision/en,这个/r,指标/n,，/w,但/c,它/r,对于/p,样本/n,不/d,均衡/a,的/u,场景/n,下/f,是/v,失效/v,的/u,。/w,举/v,个/q,例子/n,，/w,我们/r,有/v,个/q,二/m,分类/vn,（/w,成功/a,和/c,失败/v,）/w,场景/n,，/w,成功/a,的/u,占/v,比/p,为/p,98%/mq,。/w,这种/r,样本/n,直接/ad,输入/v,训练/vn,模型/n,，/w,必定/d,过/u,拟合/nz,，/w,模型/n,会/v,直接/ad,忽略/v,失败/v,的/u,那/r,类/q,，/w,将/d,所有/b,都/d,预测/v,为/p,成功/a,。/w,此时/r,成功率/n,可/v,达/v,98%/mq,，/w,但/c,模型/n,其实/d,是/v,无效/v,的/u,。/w,那么/r,应该/v,用/p,什么/r,？/w,对于/p,二/m,分类/vn,，/w,可/v,用/p,roc/en,_,auc/en,_,score/en,，/w,对于/p,多/a,分类/vn,，/w,可/v,用/p,confusion/en,_,matrix/en,和/c,classification/en, ,report/en,4.2/m, ,样本/n,不/d,均衡/a,问题/n,处理/v,本文/r,用/p,的/u,例子/n,，/w,显然/ad,0/m,和/c,2/m,的/u,数量/n,非常/d,少/a,，/w,1/m,的/u,数量/n,是/v,大头/n,。/w,为了/p,不/d,对/p,1/m,这种/r,类型/n,产生/v,过/u,拟合/nz,，/w,可/v,对/p,0/m,和/c,2/m,这/r,两类/mq,做/v,过/u,抽样/vn,处理/v,。/w,常见/a,的/u,有/v,两类/mq,算法/n,：/w,（/w,1/m,）/w,直接/ad,复制/v,少数/m,类/q,样本/n,（/w,2/m,）/w,smote/en,过/u,抽样/vn,算法/n,（/w,细节/n,略/d,）/w,这里/r,两种/mq,算法/n,都/d,用/p,过/u,，/w,最终/d,选/v,了/u,smote/en,，/w,不过/c,本文/r,研究/vn,的/u,数据/n,上/f,没有/v,看出/v,明显/a,差别/n,。/w,少数/m,类/q,的/u,过/u,抽样/vn,解决/v,了/u,大/a,类/q,的/u,过/u,拟合/nz,问题/n,，/w,同时/c,也/d,带来/v,了/u,小类/nw,的/u,过/u,拟合/nz,，/w,不过/c,这里/r,的/u,模型/n,正好/z,需要/v,让/v,小类/nw,过/u,拟合/nz,，/w,我们/r,就是/d,要/v,把/p,表现/v,“/w,极/d,好/a,”/w,和/c,“/w,极/d,坏/a,”/w,的/u,部分/n,找/v,出来/v,，/w,表现/v,平平/z,的/u,在/p,异常/a,检测/vn,时/ng,加入/v,关注/v,。/w,过/u,拟合/nz,这个/r,问题/n,，/w,不用/d,过于/d,恐惧/an,，/w,反而/d,可以/v,利用/v,。/w,举/v,个/q,例子/n,，/w,“/w,患病/v,”/w,和/c,“/w,不/d,患病/v,”/w,这种/r,分类/vn,场景/n,，/w,宁可/d,将/d,“/w,患病/v,”/w,的/u,检出率/nw,高/a,一些/m,。/w,如/v,下/f,图/n,这个/r,分类/vn,报告/n,，/w,对于/p,小类/nw,样本/n,（/w,0/m,和/c,2/m,）/w,，/w,我们/r,需要/v,利用/v,recall/en,高/a,的/u,特性/n,，/w,即/v,把/p,它/r,找/v,出来/v,就/d,好/a,；/w,而/c,对于/p,大/a,类/q,样本/n,，/w,我们/r,需要/v,precision/en,高/a,的/u,特性/n,，/w,用于/v,做/v,异常/a,检测/vn,。/w,4.3/m, ,模型/n,参数/n,选取/v,sklearn/en,有/v,现成/b,的/u,gridsearchcv/en,方法/n,可/v,用/p,，/w,可以/v,看看/v,不同/a,参数/n,组合/v,下/f,模型/n,的/u,效果/n,。/w,对于/p,树类/nw,算法/n,，/w,常用/a,的/u,参数/n,就/d,是/v,深度/n,，/w,特征/n,个数/n,；/w,森林/n,类/q,算法/n,加/v,一个/m,树/v,个/q,数/m,。/w,max/en,_,depth/en,这个/r,参数/n,需要/v,尤其/d,注意/v,，/w,深度/n,大/a,了/u,，/w,容易/a,过/u,拟合/nz,，/w,一般/a,经验/n,值/n,在/p,15/m,以内/f,。/w,4.4/m, ,模型/n,训练/vn,好/a,后/f,，/w,用/p,测试/vn,数据/n,预测/v,，/w,从中/d,提取/v,各个/r,类别/n,预测/v,正确/a,的/u,和/c,不/d,正确/a,的/u,。/w,例/n,：/w,预测/v,正确/a,的/u,部分/n,：/w,获取/v,预测/v,为/p,0/m,,/w,2/m,，/w,实际/n,也/d,为/p,0/m,,/w,2/m,的/u,样本/n,标示/vn,；/w,预测/v,错误/n,的/u,部分/n,：/w,获取/v,预测/v,为/p,0/m,和/c,1/m,，/w,实际/n,为/p,2/m,的/u,样本/n,标示/vn,(/w,根据/p,情况/n,调节/vn,)/w,5/m,./w, ,输入/v,决策/n,树/v,进行/v,可视化/nz,展示/v,,/w,分别/d,做/v,业务/n,规律/n,挖掘/v,和/c,异常/a,检测/vn,这里/r,dt/en,算法/n,仅/d,用于/v,展示/v,，/