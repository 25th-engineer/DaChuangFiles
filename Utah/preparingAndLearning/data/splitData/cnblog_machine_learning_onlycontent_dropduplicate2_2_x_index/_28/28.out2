1/m,./w, ,前言/n,熟悉/v,机器/n,学习/v,的/u,童鞋/nz,都/d,知道/v,，/w,优化/v,方法/n,是/v,其中/r,一个/m,非常/d,重要/a,的/u,话题/n,，/w,最/d,常见/a,的/u,情形/n,就/d,是/v,利用/v,目标/n,函数/n,的/u,导数/n,通过/p,多次/nrf,迭代/vn,来/v,求解/v,无/v,约束/vn,最/d,优化/v,问题/n,。/w,实现/v,简单/a,，/w,coding/en, ,方便/a,，/w,是/v,训练/vn,模型/n,的/u,必备/vn,利器/n,之一/r,。/w,这/r,篇/q,博客/n,主要/b,总结/v,一下/m,使用/v,导数/n,的/u,最/d,优化/v,方法/n,的/u,几/m,个/q,基本/a,方法/n,，/w,梳理/v,梳理/v,相关/v,的/u,数学/n,知识/n,，/w,本人/r,也/d,是/v,一边/d,写/v,一边/d,学/v,，/w,如/v,有/v,问题/n,，/w,欢迎/v,指正/v,，/w,共同/d,学习/v,，/w,一起/s,进步/vn,。/w,2/m,./w, ,几/m,个/q,数学/n,概念/n,1/m,)/w, ,梯度/n,（/w,一/m,阶导/nw,数/m,）/w,考虑/v,一座/mq,在/p, ,(/w,x/en,1/m,,/w, ,x/en,2/m,)/w, ,点/q,高度/d,是/v, ,f/en,(/w,x/en,1/m,,/w, ,x/en,2/m,)/w, ,的/u,山/n,。/w,那么/r,，/w,某/r,一点/m,的/u,梯度/n,方向/n,是/v,在/p,该/r,点/q,坡度/n,最/d,陡/a,的/u,方向/n,，/w,而/c,梯度/n,的/u,大小/n,告诉/v,我们/r,坡度/n,到底/d,有/v,多/a,陡/a,。/w,注意/v,，/w,梯度/n,也/d,可以/v,告诉/v,我们/r,不/d,在/p,最快/d,变化/vn,方向/n,的/u,其他/r,方向/n,的/u,变化/vn,速度/n,（/w,二维/nr,情况/n,下/f,，/w,按照/p,梯度/n,方向/n,倾斜/v,的/u,圆/vg,在/p,平面/n,上/f,投影/vn,成/v,一个/m,椭圆/n,）/w,。/w,对于/p,一个/m,含有/v, ,n/en, ,个/q,变量/n,的/u,标量/n,函数/n,，/w,即/v,函数/n,输入/v,一个/m, ,n/en, ,维/q, ,的/u,向量/n,，/w,输出/v,一个/m,数值/n,，/w,梯度/n,可以/v,定义/n,为/p,：/w,2/m,)/w, ,hesse/en, ,矩阵/n,（/w,二阶/nr,导数/n,）/w,hesse/en, ,矩阵/n,常/d,被/p,应用/vn,于/p,牛顿法/nw,解决/v,的/u,大规模/b,优化/v,问题/n,(/w,后面/f,会/v,介绍/v,)/w,，/w,主要/b,形式/n,如下/v,：/w,当/p, ,f/en,(/w,x/en,)/w, ,为/p,二次/mq,函数/n,时/ng,，/w,梯度/n,以及/c, ,hesse/en, ,矩阵/n,很/d,容易/a,求得/v,。/w,二次/mq,函数/n,可以/v,写/v,成/v,下列/b,形式/n,：/w,其中/r, ,a/en, ,是/v, ,n/en, ,阶/ng,对称/ad,矩阵/n,，/w,b/en, ,是/v, ,n/en, ,维列/nrf,向量/n,，/w, ,c/en, ,是/v,常数/n,。/w,f/en,(/w,x/en,)/w, ,梯度/n,是/v, ,ax/en,+/w,b/en,,/w, ,hesse/en, ,矩阵/n,等于/v, ,a/en,。/w,3/m,)/w, ,jacobi/en, ,矩阵/n,jacobi/en, ,矩阵/n,实际上/d,是/v,向/p,量值/nw,函数/n,的/u,梯度/n,矩阵/n,，/w,假设/v,f/en,:/w,rn/en,→/w,rm/en, ,是/v,一个/m,从/p,n/en,维欧氏/nr,空间/n,转换/v,到/v,m/en,维欧氏/nr,空间/n,的/u,函数/n,。/w,这个/r,函数/n,由/p,m/en,个/q,实/a,函数/n,组成/v,:/w, ,。/w,这些/r,函数/n,的/u,偏导/nw,数/m,(/w,如果/c,存在/v,)/w,可以/v,组成/v,一个/m,m/en,行/v,n/en,列/v,的/u,矩阵/n,(/w,m/en, ,by/en, ,n/en,)/w,，/w,这/r,就/d,是/v,所谓/v,的/u,雅可比矩阵/nw,：/w,总结/v,一下/m,,/w,a/en,)/w, ,如果/c, ,f/en,(/w,x/en,)/w, ,是/v,一个/m,标量/n,函数/n,，/w,那么/r,雅克比矩阵/nw,是/v,一个/m,向量/n,，/w,等于/v, ,f/en,(/w,x/en,)/w, ,的/u,梯度/n,，/w, ,hesse/en, ,矩阵/n,是/v,一个/m,二维/nr,矩阵/n,。/w,如果/c, ,f/en,(/w,x/en,)/w, ,是/v,一个/m,向/p,量值/nw,函数/n,，/w,那么/r,jacobi/en, ,矩阵/n,是/v,一个/m,二维/nr,矩阵/n,，/w,hesse/en, ,矩阵/n,是/v,一个/m,三维/nz,矩阵/n,。/w,b/en,)/w, ,梯度/n,是/v, ,jacobian/en, ,矩阵/n,的/u,特例/n,，/w,梯度/n,的/u, ,jacobian/en, ,矩阵/n,就/d,是/v, ,hesse/en, ,矩阵/n,（/w,一阶/nw,偏导/nw,与/p,二阶/nr,偏导/nw,的/u,关系/n,）/w,。/w,3/m,./w, ,优化/v,方法/n,1/m,)/w, ,gradient/en, ,descentgradient/en, ,descent/en, ,又/d,叫/v, ,steepest/en, ,descent/en,，/w,是/v,利用/v,一阶/nw,的/u,梯度/n,信息/n,找到/v,函数/n,局部/n,最/d,优解/nw,的/u,一种/mq,方法/n,，/w,也/d,是/v,机器/n,学习/v,里面/f,最/d,简单/a,最/d,常用/a,的/u,一种/mq,优化/v,方法/n,。/w,gradient/en, ,descent/en, ,是/v, ,line/en, ,search/en, ,方法/n,中/f,的/u,一种/mq,，/w,主要/b,迭代/vn,公式/n,如下/v,：/w,其中/r,，/w,是/v,第/m, ,k/en, ,次/q,迭代/vn,我们/r,选择/v,移动/vn,的/u,方向/n,，/w,在/p, ,steepest/en, ,descent/en, ,中/f,，/w,移动/vn,的/u,方向/n,设定/v,为/p,梯度/n,的/u,负/v,方向/n,，/w, ,是/v,第/m, ,k/en, ,次/q,迭代/vn,用/p, ,line/en, ,search/en, ,方法/n,选择/v,移动/vn,的/u,距离/n,，/w,每次/r,移动/vn,的/u,距离/n,系数/n,可以/v,相同/a,，/w,也/d,可以/v,不同/a,，/w,有时候/d,我们/r,也/d,叫/v,学习/v,率/v,（/w,learning/en, ,rate/en,）/w,。/w,在/p,数学/n,上/f,，/w,移动/vn,的/u,距离/n,可以/v,通过/p, ,line/en, ,search/en, ,令/v,导数/n,为/p,零/m,找到/v,该/r,方向/n,上/f,的/u,最小值/nz,，/w,但是/c,在/p,实际/n,编程/vn,的/u,过程/n,中/f,，/w,这样/r,计算/v,的/u,代价/n,太/d,大/a,，/w,我们/r,一般/a,可以/v,将/d,它/r,设/v,定位/vn,一个/m,常量/n,。/w,考虑/v,一个/m,包含/v,三个/m,变量/n,的/u,函数/n, ,，/w,计算/v,梯度/n,得到/v, ,。/w,设定/v, ,learning/en, ,rate/en, ,=/w, ,1/m,，/w,算法/n,代码/n,如下/v,：/w,#, ,code/en, ,from/en, ,chapter/en, ,11/m, ,of/en, ,machine/en, ,learning/en,:/w, ,an/en, ,algorithmic/en, ,perspective/en, ,#, ,by/en, ,stephen/en, ,marsland/en, ,(/w,http/en,:/w,//w,//w,seat/en,./w,massey/en,./w,ac/en,./w,nz/en,//w,personal/en,//w,s/en,./w,r/en,./w,marsland/en,//w,mlbook/en,./w,html/en,)/w, ,#, ,gradient/en, ,descent/en, ,using/en, ,steepest/en, ,descent/en, ,from/en, ,numpy/en, ,import/en, ,*/w, ,def/en, ,jacobian/en,(/w,x/en,)/w,:/w, ,return/en, ,array/en,(/w,[/w,x/en,[/w,0/m,]/w,,/w, ,0.4/m,*/w,x/en,[/w,1/m,]/w,,/w, ,1.2/m,*/w,x/en,[/w,2/m,]/w,]/w,)/w, ,def/en, ,steepest/en,(/w,x/en,0/m,)/w,:/w, ,i/en, ,=/w, ,0/m, ,imax/en, ,=/w, ,10/m, ,x/en, ,=/w, ,x/en,0/m, ,delta/en, ,=/w, ,1/m, ,alpha/en, ,=/w, ,1/m, ,while/en, ,i/en,</w,imax/en, ,and/en, ,delta/en,>,10/m,*/w,*/w,(/w,-/w,5/m,)/w,:/w, ,p/en, ,=/w, ,-/w,jacobian/en,(/w,x/en,)/w, ,xold/en, ,=/w, ,x/en, ,x/en, ,=/w, ,x/en, ,+/w, ,alpha/en,*/w,p/en, ,delta/en, ,=/w, ,sum/en,(/w,(/w,x/en,-/w,xold/en,)/w,*/w,*/w,2/m,)/w, ,print/en, ,'/w,epoch/en,'/w,,/w, ,i/en,,/w, ,'/w,:/w,'/w, ,print/en, ,x/en,,/w, ,'/w,\/w,n/en,'/w, ,i/en, ,+/w,=/w, ,1/m, ,x/en,0/m, ,=/w, ,array/en,(/w,[/w,-/w,2/m,,/w,2/m,,/w,-/w,2/m,]/w,)/w, ,steepest/en,(/w,x/en,0/m,)/w,view/en, ,codesteepest/en, ,gradient/en, ,方法/n,得到/v,的/u,是/v,局部/n,最/d,优解/nw,，/w,如果/c,目标/n,函数/n,是/v,一个/m,凸/ag,优化/v,问题/n,，/w,那么/r,局部/n,最/d,优解/nw,就/d,是/v,全局/n,最/d,优解/nw,，/w,理想/n,的/u,优化/v,效果/n,如下/v,图/n,，/w,值得/v,注意/v,一点/m,的/u,是/v,，/w,每/r,一次/mq,迭代/vn,的/u,移动/vn,方向/n,都/d,与/p,出发点/n,的/u,等高线/n,垂直/v,：/w,需要/v,指出/v,的/u,是/v,，/w,在/p,某些/r,情况/n,下/f,，/w,最速/nw,下降/v,法/j,存在/v,锯齿/n,现象/n,（/w, ,zig/en,-/w,zagging/en,）/w,将/d,会/v,导致/v,收敛/vn,速度/n,变/v,慢/a,:/w,粗略/ad,来讲/u,，/w,在/p,二次/mq,函数/n,中/f,，/w,椭球面/nw,的/u,形状/n,受/v, ,hesse/en, ,矩阵/n,的/u,条件/n,数/m,影响/vn,，/w,长轴/n,与/p,短轴/nw,对应/v,矩阵/n,的/u,最/d,小/a,特征/n,值/n,和/c,最/d,大/a,特征/n,值/n,的/u,方向/n,，/w,其/r,大小/n,与/p,特征/n,值/n,的/u,平方根成/nw,反比/n,，/w,最/d,大/a,特征/n,值/n,与/p,最/d,小/a,特征/n,值/n,相差/v,越/d,大/a,，/w,椭球面/nw,越/d,扁/a,，/w,那么/r,优化/v,路径/n,需要/v,走/v,很/d,大/a,的/u,弯路/n,，/w,计算/v,效率/n,很/d,低/a,。/w,2/m,)/w, ,newton/en,'/w,s/en, ,method/en,在/p,最速/nw,下降/v,法/j,中/f,，/w,我们/r,看到/v,，/w,该/r,方法/n,主要/b,利用/v,的/u,是/v,目标/n,函数/n,的/u,局部/n,性质/n,，/w,具有/v,一定/d,的/u,“/w,盲目性/n,”/w,。/w,牛顿/q,法则/n,是/v,利用/v,局部/n,的/u,一阶/nw,和/c,二阶/nr,偏导/nw,信息/n,，/w,推测/v,整个/b,目标/n,函数/n,的/u,形状/n,，/w,进而/c,可以/v,求得/v,出/v,近似/a,函数/n,的/u,全局/n,最小值/nz,，/w,然后/c,将/d,当前/t,的/u,最小值/nz,设定/v,近似/a,函数/n,的/u,最小值/nz,。/w,相比/v,最速/nw,下降/v,法/j,，/w,牛顿法/nrf,带有/v,一定/d,对/p,全局/n,的/u,预测性/n,，/w,收敛/vn,性质/n,也/d,更/d,优良/z,。/w,牛顿法/nrf,的/u,主要/b,推导/vn,过程/n,如下/v,：/w,第一/m,步/q,，/w,利用/v, ,taylor/en, ,级数/n,求得/v,原/b,目标/n,函数/n,的/u,二阶/nr,近似/a,：/w,第二/m,步/q,，/w,把/p, ,x/en, ,看做/v,自/p,变量/n,，/w, ,所有/b,带有/v, ,x/en,^,k/en, ,的/u,项/q,看做/v,常量/n,，/w,令/v,一阶/nw,导数/n,为/p, ,0/m, ,，/w,即/v,可/v,求/v,近似/a,函数/n,的/u,最小值/nz,：/w,即/v,：/w,第三/nw,步/q,，/w,将/d,当前/t,的/u,最小值/nz,设定/v,近似/a,函数/n,的/u,最小值/nz,（/w,或者/c,乘/v,以/p,步长/nz,)/w,。/w,与/p, ,1/m,)/w, ,中/f,优化/v,问题/n,相同/a,，/w,牛顿法/nrf,的/u,代码/n,如下/v,：/w,newton/en,./w,py/en,#, ,code/en, ,from/en, ,chapter/en, ,11/m, ,of/en, ,machine/en, ,learning/en,:/w, ,an/en, ,algorithmic/en, ,perspective/en, ,#, ,by/en, ,stephen/en, ,marsland/en, ,(/w,http/en,:/w,//w,//w,seat/en,./w,massey/en,./w,ac/en,./w,nz/en,//w,personal/en,//w,s/en,./w,r/en,./w,marsland/en,//w,mlbook/en,./w,html/en,)/w, ,#, ,gradient/en, ,descent/en, ,using/en, ,newton/en,'/w,s/en, ,method/en, ,from/en, ,numpy/en, ,import/en, ,*/w, ,def/en, ,jacobian/en,(/w,x/en,)/w,:/w, ,return/en, ,array/en,(/w,[/w,x/en,[/w,0/m,]/w,,/w, ,0.4/m,*/w,x/en,[/w,1/m,]/w,,/w, ,1.2/m,*/w,x/en,[/w,2/m,]/w,]/w,)/w, ,def/en, ,hessian/en,(/w,x/en,)/w,:/w, ,return/en, ,array/en,(/w,[/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,0.4/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,0/m,,/w,1.2/m,]/w,]/w,)/w, ,def/en, ,newton/en,(/w,x/en,0/m,)/w,:/w, ,i/en, ,=/w, ,0/m, ,imax/en, ,=/w, ,10/m, ,x/en, ,=/w, ,x/en,0/m, ,delta/en, ,=/w, ,1/m, ,alpha/en, ,=/w, ,1/m, ,while/en, ,i/en,</w,imax/en, ,and/en, ,delta/en,>,10/m,*/w,*/w,(/w,-/w,5/m,)/w,:/w, ,p/en, ,=/w, ,-/w,dot/en,(/w,linalg/en,./w,inv/en,(/w,hessian/en,(/w,x/en,)/w,)/w,,/w,jacobian/en,(/w,x/en,)/w,)/w, ,xold/en, ,=/w, ,x/en, ,x/en, ,=/w, ,x/en, ,+/w, ,alpha/en,*/w,p/en, ,delta/en, ,=/w, ,sum/en,(/w,(/w,x/en,-/w,xold/en,)/w,*/w,*/w,2/m,)/w, ,i/en, ,+/w,=/w, ,1/m, ,print/en, ,x/en, ,x/en,0/m, ,=/w, ,array/en,(/w,[/w,-/w,2/m,,/w,2/m,,/w,-/w,2/m,]/w,)/w, ,newton/en,(/w,x/en,0/m,)/w,view/en, ,code/en,上面/f,例子/n,中/f,由于/c,目标/n,函数/n,是/v,二次/mq,凸/ag,函数/n,，/w,taylor/en, ,展开/v,等于/v,原/b,函数/n,，/w,所以/c,能/v,一次/mq,就/d,求/v,出/v,最/d,优解/nw,。/w,牛顿法/nrf,主要/b,存在/v,的/u,问题/n,是/v,：/w,hesse/en, ,矩阵/n,不可/v,逆时/nw,无法/v,计算/v,矩阵/n,的/u,逆/vg,计算/v,复杂/a,为/p, ,n/en, ,的/u,立方/q,，/w,当/p,问题/n,规模/n,比较/d,大/a,时/ng,，/w,计算量/nw,很大/d,，/w,解决/v,的/u,办法/n,是/v,采用/v,拟/v,牛顿法/nrf,如/v, ,bfgs/en,,/w, ,l/en,-/w,bfgs/en,,/w, ,dfp/en,,/w, ,broyden/en,'/w,s/en, ,algorithm/en, ,进行/v,近似/a,。/w,如果/c,初始值/n,离/v,局部/n,极/d,小值/nw,太/d,远/a,，/w,taylor/en, ,展开/v,并/c,不/d,能/v,对/p,原/b,函数/n,进行/v,良好/a,的/u,近似/a,3/m,)/w, ,levenberg/en,–,marquardt/en, ,algorithmlevenberg/en,–,marquardt/en, ,algorithm/en, ,能/v,结合/v,以上/f,两种/mq,优化/v,方法/n,的/u,优点/n,，/w,并/c,对/p,两者/r,的/u,不足/a,做出/v,改进/v,。/w,与/p, ,line/en, ,search/en, ,的/u,方法/n,不同/a,，/w,lma/en, ,属于/v,一种/mq,“/w,信赖域法/nw,”/w,(/w,trust/en, ,region/en,)/w,，/w,牛顿法/nrf,实际上/d,也/d,可以/v,看做/v,一种/mq,信赖域法/nw,，/w,即/v,利用/v,局部/n,信息/n,对/p,函数/n,进行/v,建模/vn,近似/a,，/w,求取/nw,局部/n,最小值/nz,。/w,所谓/v,的/u,信赖域法/nw,，/w,就是/d,从/p,初始点/nw,开始/v,，/w,先/d,假设/v,一个/m,可以/v,信赖/v,的/u,最大/a,位移/v, ,s/en,（/w,牛顿法/nrf,里面/f, ,s/en, ,为/p,无穷/z,大/a,）/w,，/w,然后/c,在/p,以/p,当前点/nw,为/p,中心/n,，/w,以/p, ,s/en, ,为/p,半径/n,的/u,区域/n,内/f,，/w,通过/p,寻找/v,目标/n,函数/n,的/u,一个/m,近似/a,函数/n,（/w,二次/mq,的/u,）/w,的/u,最/d,优点/n,，/w,来/v,求解/v,得到/v,真正/d,的/u,位移/v,。/w,在/p,得到/v,了/u,位移/v,之后/f,，/w,再/d,计算/v,目标/n,函数/n,值/n,，/w,如果/c,其/r,使/v,目标/n,函数/n,值/n,的/u,下降/v,满足/v,了/u,一定/d,条件/n,，/w,那么/r,就/d,说明/v,这个/r,位移/v,是/v,可靠/a,的/u,，/w,则/d,继续/v,按/p,此/r,规则/n,迭代/vn,计算/v,下去/v,；/w,如果/c,其/r,不/d,能/v,使/v,目标/n,函数/n,值/n,的/u,下降/v,满足/v,一定/d,的/u,条件/n,，/w,则/d,应/v,减/v,小信/nr,赖域/nr,的/u,范围/n,，/w,再/d,重新/d,求解/v,。/w,lma/en, ,最/d,早/a,提/v,出/v,是/v,用/p,来/v,解决/v,最/d,小/a,二/m,乘/v,法/j,曲线/n,拟合/nz,的/u,优化/v,问题/n,的/u,，/w,对于/p,随机/d,初始化/v,的/u,已知/nz,参数/n, ,beta/en,，/w, ,求得/v,的/u,目标值/n,为/p,：/w,对/p,拟合/nz,曲线/n,函数/n,进行/v,一阶/nw, ,jacobi/en, ,矩阵/n,的/u,近似/a,：/w,进而/c,推测/v,出/v, ,s/en, ,函数/n,的/u,周边/n,信息/n,：/w,位移/v,是/v,多少/r,时/ng,得到/v, ,s/en, ,函数/n,的/u,最小值/nz,呢/y,？/w,通过/p,几何/n,的/u,概念/n,，/w,当/p,残差/nw, ,垂直/v,于/p, ,j/en, ,矩阵/n,的/u, ,span/en, ,空间/n,时/ng,，/w, ,s/en, ,取得/v,最小/a,（/w,至于/p,为什么/r,？/w,请/v,参考/v,之前/f,博客/n,的/u,最后/f,一部分/m,)/w,我们/r,将/d,这个/r,公式/n,略/d,加/v,修改/v,，/w,加入/v,阻尼/n,系数/n,得到/v,：/w,就/d,是/v,莱文贝/nr,格－马/nr,夸特/nr,方法/n,。/w,这种/r,方法/n,只/d,计算/v,了/u,一阶/nw,偏导/nw,，/w,而且/c,不/d,是/v,目标/n,函数/n,的/u, ,jacobia/en, ,矩阵/n,，/w,而是/c,拟合/nz,函数/n,的/u, ,jacobia/en, ,矩阵/n,。/w,当/p, ,大/a,的/u,时候/n,可/v,信域/nw,小/a,，/w,这种/r,算法/n,会/v,接近/v,最速/nw,下降/v,法/j,，/w, ,小/a,的/u,时候/n,可/v,信域/nw,大/a,，/w,会/v,接近/v,高斯-/nr,牛顿/q,方法/n,。/w,算法/n,过程/n,如下/v,：/w,给/p,定/v,一个/m,初识/nw,值/n, ,x/en,0/m,当/p, ,并且/c,没有/v,到达/v,最/d,大/a,迭代/vn,次数/n,时/ng,重复/v,执行/v,:/w,算出/v,移动/vn,向量/n,计算/v,更新/v,值/n,：/w,计算/v,目标/n,函数/n,真实/a,减少/v,量/n,与/p,预测/v,减少/v,量/n,的/u,比率/n,if/en, ,，/w,接受/v,更新/v,值/n,else/en, ,if/en, ,，/w,说明/v,近似/a,效果/n,很/d,好/a,，/w,接受/v,更新/v,值/n,，/w,扩大/v,可/v,信域/nw,（/w,即/v,减小/v,阻尼/n,系数/n,）/w,else/en,:/w, ,目标/n,函数/n,在/p,变/v,大/a,，/w,拒绝/v,更新/v,值/n,，/w,减/v,小/a,可/v,信域/nw,（/w,即/v,增加/v,阻尼/n,系数/n,）/w,直到/v,达到/v,最/d,大/a,迭代/vn,次数/n,维基/nrf,百科/n,在/p,介绍/v, ,gradient/en, ,descent/en, ,时/ng,用/p,包含/v,了/u,细长/z,峡谷/n,的/u, ,rosenbrock/en, ,function/en,展示/v,了/u, ,zig/en,-/w,zagging/en, ,锯齿/n,现象/n,：/w,用/p, ,lma/en, ,优化/v,效率/n,如何/r,。/w,套用/v,到/v,我们/r,之前/f, ,lma/en, ,公式/n,中/f,，/w,有/v,：/w,代码/n,如下/v,：/w,levenbergmarquardt/en,./w,py/en,#, ,code/en, ,from/en, ,chapter/en, ,11/m, ,of/en, ,machine/en, ,learning/en,:/w, ,an/en, ,algorithmic/en, ,perspective/en, ,#, ,by/en, ,stephen/en, ,marsland/en, ,(/w,http/en,:/w,//w,//w,seat/en,./w,massey/en,./w,ac/en,./w,nz/en,//w,personal/en,//w,s/en,./w,r/en,./w,marsland/en,//w,mlbook/en,./w,html/en,)/w, ,#, ,the/en, ,levenberg/en, ,marquardt/en, ,algorithm/en, ,from/en, ,numpy/en, ,import/en, ,*/w, ,def/en, ,function/en,(/w,p/en,)/w,:/w, ,r/en, ,=/w, ,array/en,(/w,[/w,10/m,*/w,(/w,p/en,[/w,1/m,]/w,-/w,p/en,[/w,0/m,]/w,*/w,*/w,2/m,)/w,,/w,(/w,1/m,-/w,p/en,[/w,0/m,]/w,)/w,]/w,)/w, ,fp/en, ,=/w, ,dot/en,(/w,transpose/en,(/w,r/en,)/w,,/w,r/en,)/w, ,#,=/w, ,100/m,*/w,(/w,p/en,[/w,1/m,]/w,-/w,p/en,[/w,0/m,]/w,*/w,*/w,2/m,)/w,*/w,*/w,2/m, ,+/w, ,(/w,1/m,-/w,p/en,[/w,0/m,]/w,)/w,*/w,*/w,2/m, ,j/en, ,=/w, ,(/w,array/en,(/w,[/w,[/w,-/w,20/m,*/w,p/en,[/w,0/m,]/w,,/w,10/m,]/w,,/w,[/w,-/w,1/m,,/w,0/m,]/w,]/w,)/w,)/w, ,grad/en, ,=/w, ,dot/en,(/w,transpose/en,(/w,j/en,)/w,,/w,transpose/en,(/w,r/en,)/w,)/w, ,return/en, ,fp/en,,/w,r/en,,/w,grad/en,,/w,j/en, ,def/en, ,lm/en,(/w,p/en,0/m,,/w,tol/en,=/w,10/m,*/w,*/w,(/w,-/w,5/m,)/w,,/w,maxits/en,=/w,100/m,)/w,:/w, ,nvars/en,=/w,shape/en,(/w,p/en,0/m,)/w,[/w,0/m,]/w, ,nu/en,=/w,0.01/m, ,p/en, ,=/w, ,p/en,0/m, ,fp/en,,/w,r/en,,/w,grad/en,,/w,j/en, ,=/w, ,function/en,(/w,p/en,)/w, ,e/en, ,=/w, ,sum/en,(/w,dot/en,(/w,transpose/en,(/w,r/en,)/w,,/w,r/en,)/w,)/w, ,nits/en, ,=/w, ,0/m, ,while/en, ,nits/en,</w,maxits/en, ,and/en, ,linalg/en,./w,norm/en,(/w,grad/en,)/w,>,tol/en,:/w, ,nits/en, ,+/w,=/w, ,1/m, ,fp/en,,/w,r/en,,/w,grad/en,,/w,j/en, ,=/w, ,function/en,(/w,p/en,)/w, ,h/en,=/w,dot/en,(/w,transpose/en,(/w,j/en,)/w,,/w,j/en,)/w, ,+/w, ,nu/en,*/w,eye/en,(/w,nvars/en,)/w, ,pnew/en, ,=/w, ,zeros/en,(/w,shape/en,(/w,p/en,)/w,)/w, ,nits/en,2/m, ,=/w, ,0/m, ,while/en, ,(/w,p/en,!/w,=/w,pnew/en,)/w,./w,all/en,(/w,)/w, ,and/en, ,nits/en,2/m,</w,maxits/en,:/w, ,nits/en,2/m, ,+/w,=/w, ,1/m, ,dp/en,,/w,resid/en,,/w,rank/en,,/w,s/en, ,=/w, ,linalg/en,./w,lstsq/en,(/w,h/en,,/w,grad/en,)/w, ,pnew/en, ,=/w, ,p/en, ,-/w, ,dp/en, ,fpnew/en,,/w,rnew/en,,/w,gradnew/en,,/w,jnew/en, ,=/w, ,function/en,(/w,pnew/en,)/w, ,enew/en, ,=/w, ,sum/en,(/w,dot/en,(/w,transpose/en,(/w,rnew/en,)/w,,/w,rnew/en,)/w,)/w, ,rho/en, ,=/w, ,linalg/en,./w,norm/en,(/w,dot/en,(/w,transpose/en,(/w,r/en,)/w,,/w,r/en,)/w,-/w,dot/en,(/w,transpose/en,(/w,rnew/en,)/w,,/w,rnew/en,)/w,)/w, ,rho/en, ,//w,=/w, ,linalg/en,./w,norm/en,(/w,dot/en,(/w,transpose/en,(/w,grad/en,)/w,,/w,pnew/en,-/w,p/en,)/w,)/w, ,if/en, ,rho/en,>,0/m,:/w, ,update/en, ,=/w, ,1/m, ,p/en, ,=/w, ,pnew/en, ,e/en, ,=/w, ,enew/en, ,if/en, ,rho/en,>,0.25/m,:/w, ,nu/en,=/w,nu/en,//w,10/m, ,else/en,:/w, ,nu/en,=/w,nu/en,*/w,10/m, ,update/en, ,=/w, ,0/m, ,print/en, ,fp/en,,/w, ,p/en,,/w, ,e/en,,/w, ,linalg/en,./w,norm/en,(/w,grad/en,)/w,,/w, ,nu/en, ,p/en,0/m, ,=/w, ,array/en,(/w,[/w,-/w,1.92/m,,/w,2/m,]/w,)/w, ,lm/en,(/w,p/en,0/m,)/w,view/en, ,code/en,大概/d, ,5/m, ,次/q,迭代/vn,就/d,可以/v,得到/v,最/d,优解/nw, ,(/w,1/m,,/w, ,1/m,)/w,./w,levenberg/en,–,marquardt/en, ,algorithm/en, ,对/p,局部/n,极/d,小值/nw,很/d,敏感/a,，/w,维基/nr,百科/n,举/v,了/u,一个/m,二/m,乘/v,法/j,曲线/n,拟合/nz,的/u,例子/n,，/w,当/p,使用/v,不同/a,的/u,初始值/n,时/ng,，/w,得到/v,的/u,结果/n,差距/n,很/d,大/a,，/w,我/r,这里/r,也/d,有/v, ,python/en, ,代码/n,，/w,就/d,不/d,细/a,说/v,了/u,。/w,4/m,)/w, ,conjugate/en, ,gradients/en,共轭/nw,梯度/n,法/j,也/d,是/v,优化/v,模型/n,经常/d,经常/d,要/v,用/p,到/v,的/u,一个/m,方法/n,，/w,背后/f,的/u,数学/n,公式/n,和/c,原理/n,稍微/d,复杂/a,一些/m,，/w,光/n,这/r,一个/m,优化/v,方法/n,就/d,可以/v,写/v,一篇/mq,很/d,长/a,的/u,博文/nz,了/u,，/w,所以/c,这里/r,并/c,不/d,打算/v,详细/ad,讲解/v,每/r,一步/mq,的/u,推导/vn,过程/n,，/w,只/d,简单/a,写/v,一下/m,算法/n,的/u,实现/v,过程/n,。/w,与/p,最速/nw,梯度/n,下降/v,的/u,不同/a,，/w,共轭/nw,梯度/n,的/u,优点/n,主要/b,体现/v,在/p,选择/v,搜索/vn,方向/n,上/f,。/w,在/p,了解/v,共轭/nw,梯度/n,法/j,之前/f,，/w,我们/r,首先/d,简单/a,了解/v,一下/m,共轭/nw,方向/n,：/w,共轭/nw,方向/n,和/c,马氏/nr,距离/n,的/u,定义/n,有/v,类似/v,之/u,处/n,，/w,他们/r,都/d,考虑/v,了/u,全局/n,的/u,数据/n,分布/v,。/w,如/v,上图/n,，/w,d/en,(/w,1/m,)/w, ,方向/n,与/p,二次/mq,函数/n,的/u,等值线/n,相切/v,，/w,d/en,(/w,1/m,)/w, ,的/u,共轭/nw,方向/n, ,d/en,(/w,2/m,)/w, ,则/d,指向/vn,椭圆/n,的/u,中心/n,。/w,所以/c,对于/p,二维/nr,的/u,二次/mq,函数/n,，/w,如果/c,在/p,两个/m,共轭/nw,方向/n,上/f,进行/v,一维/mq,搜索/vn,，/w,经过/p,两次/mq,迭代/vn,必然/d,达到/v,最小点/nw,。/w,前面/f,我们/r,说/v,过/u,，/w,等值线/n,椭圆/n,的/u,形状/n,由/p, ,hesse/en, ,矩阵/n,决定/v,，/w,那么/r,，/w,上图/n,的/u,两个/m,方向/n,关于/p, ,hessen/en, ,矩阵/n,正交/nw,，/w,共轭/nw,方向/n,的/u,定义/n,如下/v,：/w,如果/c,椭圆/n,是/v,一个/m,正圆/nw,，/w, ,hessen/en, ,矩阵/n,是/v,一个/m,单位/n,矩阵/n,，/w,上面/f,等价/vn,于/p,欧/j,几/m,里/f,得/u,空间/n,中/f,的/u,正交/nw,。/w,在/p,优化/v,过程/n,中/f,，/w,如果/c,我们/r,确定/v,了/u,移动/vn,方向/n,（/w,gd/en,：/w,垂直/v,于/p,等值线/n,，/w,cg/en,：/w,共轭/nw,方向/n,）/w,，/w,然后/c,在/p,该/r,方向/n,上/f,搜索/vn,极/d,小/a,值点/nw,（/w,恰好/d,与/p,该处/r,的/u,等值线/n,相切/v,）/w,，/w,然后/c,移动/vn,到/v,最小值/nz,点/q,，/w,重复/v,以上/f,过程/n,，/w,那么/r, ,gradient/en, ,descent/en, ,和/c, ,conjugate/en, ,gradient/en, ,descent/en, ,的/u,优化/v,过程/n,可以/v,用/p,下/f,图/n,的/u,绿线/nw,与/p,红线/n,表示/v,：/w,讲/v,了/u,这么/r,多/a,，/w,共轭/nw,梯度/n,算法/n,究竟/d,是/v,如何/r,算/v,的/u,呢/y,？/w,给/p,定/v,一个/m,出发点/n, ,x/en,0/m, ,和/c,一个/m,停止/v,参数/n, ,e/en,,/w, ,第一/m,次/q,移动/vn,方向/n,为/p,最速/nw,下降/v,方向/n,:/w,while/en, ,:/w,用/p, ,newton/en,-/w,raphson/en, ,迭代/vn,计算/v,移动/vn,距离/n,，/w,以便/d,在/p,该/r,搜索/vn,方向/n,移动/vn,到/v,极/d,小/a,，/w,公式/n,就/d,不/d,写/v,了/u,，/w,具体/a,思路/n,就/d,是/v,利用/v,一/m,阶梯度/nw,的/u,信息/n,向/p,极/d,小/a,值点/nw,跳跃/v,搜索/vn,移动/vn,当前/t,的/u,优化/v,解/v, ,x/en,：/w,用/p, ,gram/