注/v,：/w,正则化/nw,是/v,用/p,来/v,防止/v,过/u,拟合/nz,的/u,方法/n,。/w,在/p,最/d,开始/v,学习/v,机器/n,学习/v,的/u,课程/n,时/ng,，/w,只是/d,觉得/v,这个/r,方法/n,就/d,像/v,某种/r,魔法/n,一样/u,非常/d,神奇/a,的/u,改变/v,了/u,模型/n,的/u,参数/n,。/w,但是/c,一直/d,也/d,无法/v,对/p,其/r,基本/a,原理/n,有/v,一个/m,透彻/a,、/w,直观/a,的/u,理解/v,。/w,直到/v,最近/t,再次/d,接触/v,到/v,这个/r,概念/n,，/w,经过/p,一番/m,苦思冥想后/nw,终于/d,有/v,了/u,我/r,自己/r,的/u,理解/v,。/w,0/m,./w, ,正则化/nw,（/w,regularization/en, ,）/w,前面/f,使用/v,多项式/n,回归/v,，/w,如果/c,多项式/n,最/d,高/a,次/q,项/q,比较/d,大/a,，/w,模型/n,就/d,容易/a,出现/v,过/u,拟合/nz,。/w,正则化/nw,是/v,一种/mq,常见/a,的/u,防止/v,过/u,拟合/nz,的/u,方法/n,，/w,一般/a,原理/n,是/v,在/p,代价/n,函数/n,后面/f,加上/v,一个/m,对/p,参数/n,的/u,约束/vn,项/q,，/w,这个/r,约束/vn,项/q,被/p,叫做/v,正则化/nw,项/q,（/w,regularizer/en,）/w,。/w,在线性/nw,回归/v,模型/n,中/f,，/w,通常/d,有/v,两种/mq,不同/a,的/u,正/d,则/d,化项/nw,：/w,加上/v,所有/b,参数/n,（/w,不/d,包括/v,$/w,\/w,theta/en,_,0/m,$/w,）/w,的/u,绝对值/n,之和/n,，/w,即/v,$/w,l/en,1/m,$/w,范数/nr,，/w,此时/r,叫做/v,lasso/en,回归/v,；/w,加上/v,所有/b,参数/n,（/w,不/d,包括/v,$/w,\/w,theta/en,_,0/m,$/w,）/w,的/u,平方和/n,，/w,即/v,$/w,l/en,2/m,$/w,范数/nr,，/w,此时/r,叫做/v,岭/ng,回归/v,./w,看/v,过/u,不少/m,关于/p,正则化/nw,原理/n,的/u,解释/v,，/w,但是/c,都/d,没有/v,获得/v,一个/m,比较/d,直观/a,的/u,理解/v,。/w,下面/f,用/p,代价/n,函数/n,的/u,图像/n,以及/c,正则化/nw,项/q,的/u,图像/n,来/v,帮助/v,解释/v,正则化/nw,之所以/c,起/v,作用/n,的/u,原因/n,。/w,0.1/m, ,代价/n,函数/n,的/u,图像/n,为了/p,可视化/nz,，/w,选择/v,直线/n,方程/n,进行/v,优化/v,。/w,假设/v,一个/m,直线/n,方程/n,以及/c,代价/n,函数/n,如下/v,：/w,$/w,\/w,hat/en,{/w,h/en,}/w,_,{/w,\/w,theta/en,}/w, ,=/w, ,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,x/en,$/w,，/w,该/r,方程/n,只/d,有/v,一个/m,特征/n,$/w,x/en,$/w,，/w,两个/m,参数/n,$/w,\/w,theta/en,_,0/m,$/w,和/c,$/w,\/w,theta/en,_,1/m,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,m/en,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,(/w,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,x/en,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w,^,2/m,}/w,$/w,，/w,该/r,代价/n,函数/n,为/p,均方/nw,误差/n,函数/n,（/w,mse/en,）/w,，/w,其中/r,$/w,m/en,$/w,表示/v,样本量/n,./w,为了/p,保持/v,简单/a,，/w,只/d,取/v,一个/m,样本点/nw,$/w,(/w,1/m,,/w, ,1/m,)/w,$/w,代入/n,上面/f,的/u,代价/n,函数/n,方程/n,中/f,，/w,可得/v,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,(/w,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,-/w, ,1/m,)/w,^,2/m,$/w,./w, ,该式/nw,是/v,一个/m,二元/mq,一次方程/n,，/w,可以/v,在/p,3维/mq,空间/n,中/f,作/v,图/n,（/w,下面/f,利用/v,网站/n,geogebra/en,画/v,出/v,该/r,方程/n,的/u,图像/n,）/w,：/w,-/w,1/m,，/w,代入/n,样本点/nw,$/w,(/w,1/m,,/w, ,1/m,)/w,$/w,后/f,的/u,代价/n,函数/n,mse/en,的/u,图像/n,由于/c,多/a,个/q,样本点/nw,的/u,代价/n,函数/n,是/v,所有/b,样本点/nw,代价/n,函数/n,之和/n,，/w,且/c,不同/a,的/u,样本点/nw,只是/d,相当/d,于/p,改变/v,了/u,代价/n,函数/n,中/f,两个/m,变量/n,的/u,参数/n,（/w,此时/r,$/w,\/w,theta/en,_,0/m,$/w,和/c,$/w,\/w,theta/en,_,1/m,$/w,是/v,变量/n,，/w,样本点/nw,的/u,取值/v,是/v,参数/n,）/w,。/w,因此/c,多样本/nw,的/u,代价/n,函数/n,mse/en,的/u,图像/n,只/d,会/v,在/p,-/w,1/m,上/f,发生/v,缩放/v,和/c,平移/vn,，/w,而/c,不/d,会/v,发生/v,过/u,大/a,的/u,形变/n,。/w,对于/p,坐标轴/n,，/w,表示/v,如下/v,：/w,使用/v,$/w,j/en,$/w,轴/q,表示/v,蓝色/n,轴线/n,，/w,上方/f,为/p,正/d,向/p,；/w,使用/v,$/w,\/w,theta/en,_,1/m,$/w,表示/v,红色/n,轴线/n,，/w,左边/f,为/p,正/d,向/p,；/w,使用/v,$/w,\/w,theta/en,_,0/m,$/w,表示/v,绿色/n,轴线/n,，/w,指向/vn,屏幕/n,外/f,的/u,方向/n,为/p,正/d,向/p,./w,此时/r,的/u,函数/n,图像/n,相当/d,于/p,一条/mq,抛物线/n,沿着/p,平面/n,$/w,j/en, ,=/w, ,0/m,$/w,上/f,直线/n,$/w,\/w,theta/en,_,0/m, ,=/w, ,-/w, ,\/w,theta/en,_,1/m,$/w,平移/vn,后/f,形成/v,的/u,图像/n,。/w,0.2/m, ,正则化/nw,项/q,的/u,图像/n,这里/r,使用/v,$/w,l/en,1/m,$/w,范数/nr,作为/v,正/d,则/d,化项/nw,，/w,加上/v,正则化/nw,项/q,之后/f,mse/en,代价/n,函数/n,变成/v,：/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,m/en,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,(/w,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,x/en,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,y/en,^,{/w,(/w,i/en,)/w,}/w,)/w,^,2/m,}/w, , ,+/w, ,\/w,lambda/en, ,|/w,|/w,\/w,theta/en,_,1/m,|/w,|/w,_,1/m,$/w,,/w,上式/nw,中/f,$/w,\/w,lambda/en,$/w,是/v,正则化/nw,项/q,的/u,参数/n,，/w,为了/p,简化/v,取/v,$/w,\/w,lambda/en, ,=/w, ,1/m,$/w,。/w,由于/c,正/d,则/d,化项/nw,中/f,始终/d,不/d,包含/v,截距/nw,项/q,$/w,\/w,theta/en,_,0/m,$/w,，/w,此时/r,的/u,$/w,l/en,1/m,$/w,范数/nr,相当/d,于/p,参数/n,$/w,\/w,theta/en,_,1/m,$/w,的/u,绝对值/n,，/w,函数/n,图像/n,如下/v,：/w,-/w,2/m,，/w,$/w,l/en,1/m,$/w,正则化/nw,项/q,的/u,图像/n,此时/r,的/u,函数/n,图像/n,相当/d,于/p,一张/mq,对/p,折/v,后/f,，/w,半/m,张开/v,的/u,纸/n,。/w,纸/n,的/u,折痕/nw,与/p,平面/n,$/w,j/en, ,=/w, ,0/m,$/w,上/f,$/w,\/w,theta/en,_,0/m,$/w,轴/q,重叠/v,。/w,0.3/m, ,代价/n,函数/n,与/p,正则化/nw,项/q,图像/n,的/u,叠加/vn,直接/ad,将/d,这/r,两个/m,图像/n,放在/v,一起/s,的/u,样子/n,：/w,-/w,3/m,，/w,同时/c,显示/v,代价/n,函数/n,与/p,正则化/nw,项/q,的/u,图像/n,将/d,两个/m,方程/n,相加/v,之后/f,，/w,即/v,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,(/w,\/w,theta/en,_,0/m, ,+/w, ,\/w,theta/en,_,1/m, ,-/w, ,1/m,)/w,^,2/m, ,+/w, ,|/w,\/w,theta/en,_,1/m,|/w,$/w,，/w,做/v,图/n,可以/v,得到/v,下面/f,的/u,图像/n,：/w,-/w,4/m,，/w,加入/v,正则化/nw,项/q,之后/f,代价/n,函数/n,的/u,图像/n,此时/r,的/u,图像/n,，/w,就/d,像/v,是/v,一个/m,圆锥体/n,被/p,捏扁/nw,了/u,之后/f,，/w,立/v,在/p,坐标/n,原/b,点/q,上/f,。/w,观察/v,添加/vn,正/d,则/d,化项/nw,前后/f,的/u,图像/n,，/w,我们/r,会/v,发现/v,：/w,加上/v,正则化/nw,项/q,之后/f,，/w,此时/r,损失/n,函数/n,就/d,分成/v,了/u,两/m,部分/n,：/w,第/m,1项/mq,为/p,原来/d,的/u,mse/en,函数/n,，/w,第/m,2项/mq,为/p,正/d,则/d,化项/nw,，/w,最终/d,的/u,结果/n,是/v,这/r,两/m,部分/n,的/u,线性/n,组合/v,;/w,在/p,第/m,1项/mq,的/u,值/n,非常/d,小/a,但/c,在/p,第/m,2项/mq,的/u,值/n,非常/d,大/a,的/u,区域/n,，/w,这些/r,值会/nw,受到/v,正则化/nw,项/q,的/u,巨大/a,影响/vn,，/w,从而/c,使得/v,这些/r,区域/n,的/u,值变/nw,的/u,与/p,正/d,则/d,化项/nw,近似/a,：/w,例如/v,原来/d,的/u,损失/n,函数/n,沿/p,$/w,\/w,theta/en,_,0/m, ,=/w, ,-/w,\/w,theta/en,_,1/m,$/w,，/w,$/w,j/en,$/w,轴/q,方向/n,上/f,的/u,值/n,始终/d,为/p,0/m,，/w,但是/c,加入/v,正则化/nw,项/q,$/w,j/en, ,=/w, ,|/w,\/w,theta/en,_,1/m,|/w,$/w,后/f,，/w,该/r,直线/n,上/f,原来/d,为/p,0/m,的/u,点/q,，/w,都/d,变成/v,了/u,$/w,\/w,theta/en,_,1/m,$/w,的/u,绝对值/n,。/w,这/r,就/d,像/v,加权/v,平均值/n,一样/u,，/w,哪/r,一项/mq,的/u,权重/nz,越/d,大/a,，/w,对/p,最终/d,结果/n,产生/v,的/u,影响/vn,也/d,越/d,大/a,;/w,如果/c,想象/v,一种/mq,非常/d,极端/n,的/u,情况/n,：/w,在/p,参数/n,的/u,整个/b,定义域/n,上/f,，/w,第/m,2项/mq,的/u,取值/v,都/d,远远/d,大于/v,第一/m,项/q,的/u,取值/v,，/w,那么/r,最终/d,的/u,损失/n,函数/n,几乎/d,100%/mq,都/d,会/v,由/p,第/m,2项/mq,决定/v,，/w,也/d,就/d,是/v,整个/b,代价/n,函数/n,的/u,图像会/nw,非常/d,类似/v,于/p,$/w,j/en,=/w,|/w,\/w,theta/en,_,1/m,|/w,$/w,（/w,-/w,2/m,）/w,而/c,不/d,是/v,原来/d,的/u,mse/en,函数/n,的/u,图像/n,（/w,-/w,1/m,）/w,。/w,这时候/r,就/d,相当/d,于/p,$/w,\/w,lambda/en,$/w,的/u,取值/v,过/u,大/a,的/u,情况/n,，/w,最终/d,的/u,全局/n,最/d,优解/nw,将/d,会/v,是/v,坐标/n,原点/n,，/w,这/r,就/d,是/v,为什么/r,在/p,这种/r,情况/n,下/f,最终/d,得到/v,的/u,解/v,全都/d,为/p,0/m,./w,1/m,./w, ,岭/ng,回归/v,岭/ng,回归/v,与/p,多项式/n,回归/v,唯一/b,的/u,不同/a,在于/v,代价/n,函数/n,上/f,的/u,差别/n,。/w,岭/ng,回归/v,的/u,代价/n,函数/n,如下/v,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,m/en,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,(/w,y/en,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,(/w,w/en, ,x/en,^,{/w,(/w,i/en,)/w,}/w, ,+/w, ,b/en,)/w,)/w,^,2/m,}/w, , ,+/w, ,\/w,lambda/en, ,|/w,|/w,w/en,|/w,|/w,_,2/m,^,2/m, ,=/w, ,mse/en,(/w,\/w,theta/en,)/w, ,+/w, ,\/w,lambda/en, ,\/w,sum/en,_,{/w,i/en, ,=/w, ,1/m,}/w,^,{/w,n/en,}/w,{/w,\/w,theta/en,_,i/en,^,2/m,}/w, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,1/m, ,-/w, ,1/m,)/w,$/w,$/w,为了/p,方便/a,计算/v,导数/n,，/w,通常/d,也/d,写/v,成/v,下面/f,的/u,形式/n,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,m/en,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,(/w,y/en,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,(/w,w/en, ,x/en,^,{/w,(/w,i/en,)/w,}/w, ,+/w, ,b/en,)/w,)/w,^,2/m,}/w, , ,+/w, ,\/w,frac/en,{/w,\/w,lambda/en,}/w,{/w,2/m,}/w, ,|/w,|/w,w/en,|/w,|/w,_,2/m,^,2/m, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,mse/en,(/w,\/w,theta/en,)/w, ,+/w, ,\/w,frac/en,{/w,\/w,lambda/en,}/w,{/w,2/m,}/w, ,\/w,sum/en,_,{/w,i/en, ,=/w, ,1/m,}/w,^,{/w,n/en,}/w,{/w,\/w,theta/en,_,i/en,^,2/m,}/w, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,1/m, ,-/w, ,2/m,)/w,$/w,$/w,上式/nw,中/f,的/u,$/w,w/en,$/w,是/v,长度/n,为/p,$/w,n/en,$/w,的/u,向量/n,，/w,不/d,包括/v,截距/nw,项/q,的/u,系数/n,$/w,\/w,theta/en,_,0/m,$/w,；/w,$/w,\/w,theta/en,$/w,是/v,长度/n,为/p,$/w,n/en, ,+/w, ,1/m,$/w,的/u,向量/n,，/w,包括/v,截距/nw,项/q,的/u,系数/n,$/w,\/w,theta/en,_,0/m,$/w,；/w,$/w,m/en,$/w,为/p,样本数/n,；/w,$/w,n/en,$/w,为/p,特征/n,数/m,./w,岭/ng,回归/v,的/u,代价/n,函数/n,仍然/d,是/v,一个/m,凸函/nw,数/m,，/w,因此/c,可以/v,利用/v,梯度/n,等于/v,0/m,的/u,方式/n,求得/v,全局/n,最/d,优解/nw,（/w,正规/a,方程/n,）/w,：/w,$/w,$/w,\/w,theta/en, ,=/w, ,(/w,x/en,^,t/en, ,x/en, ,+/w, ,\/w,lambda/en, ,i/en,)/w,^,{/w,-/w,1/m,}/w,(/w,x/en,^,t/en, ,y/en,)/w,$/w,$/w,上述/b,正规/a,方程/n,与/p,一般线性/nw,回归/v,的/u,正规/a,方程/n,相比/v,，/w,多/a,了/u,一项/mq,$/w,\/w,lambda/en, ,i/en,$/w,，/w,其中/r,$/w,i/en,$/w,表示/v,单位/n,矩阵/n,。/w,假如/c,$/w,x/en,^,t/en, ,x/en,$/w,是/v,一个/m,奇异矩阵/nw,（/w,不/d,满秩/nw,）/w,，/w,添加/vn,这/r,一项/mq,后/f,可以/v,保证/v,该项/r,可/v,逆/vg,。/w,由于/c,单位/n,矩阵/n,的/u,形状/n,是/v,对角线/n,上/f,为/p,1/m,其他/r,地方/n,都/d,为/p,0/m,，/w,看/v,起来/v,像/v,一条/mq,山岭/n,，/w,因此/c,而/c,得名/v,。/w,除了/p,上述/b,正规/a,方程/n,之外/f,，/w,还/d,可以/v,使用/v,梯度/n,下降/v,的/u,方式/n,求解/v,（/w,求/v,梯度/n,的/u,过程/n,可以/v,参考/v,一般线性/nw,回归/v,，/w,3/m,./w,2/m,./w,2节/mq,）/w,。/w,这里/r,采用/v,式子/n,$/w,1/m, ,-/w, ,2/m,$/w,来/v,求导/nw,：/w,$/w,$/w,\/w,nabla/en,_,{/w,\/w,theta/en,}/w, ,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,m/en,}/w, ,x/en,^,t/en, ,\/w,cdot/en, ,(/w,x/en, ,\/w,cdot/en, ,\/w,theta/en, ,-/w, ,y/en,)/w, , ,+/w, ,\/w,lambda/en, ,w/en, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,1/m, ,-/w, ,3/m,)/w, ,$/w,$/w,因为/c,式子/n,$/w,1/m,-/w, ,2/m,$/w,中/f,和/c,式/k,第二/m,项/q,不/d,包含/v,$/w,\/w,theta/en,_,0/m,$/w,，/w,因此/c,求/v,梯度/n,后/f,，/w,上式/nw,第二/m,项/q,中/f,的/u,$/w,w/en,$/w,本来/d,也/d,不/d,包含/v,$/w,\/w,theta/en,_,0/m,$/w,。/w,为了/p,计算/v,方便/a,，/w,添加/vn,$/w,\/w,theta/en,_,0/m, ,=/w, ,0/m,$/w,到/v,$/w,w/en,$/w,./w,因此/c,在/p,梯度/n,下降/v,的/u,过程/n,中/f,，/w,参数/n,的/u,更新/v,可以/v,表示/v,成/v,下面/f,的/u,公式/n,：/w,$/w,$/w,\/w,theta/en, ,=/w, ,\/w,theta/en, ,-/w, ,(/w,\/w,frac/en,{/w,\/w,alpha/en,}/w,{/w,m/en,}/w, ,x/en,^,t/en, ,\/w,cdot/en, ,(/w,x/en, ,\/w,cdot/en, ,\/w,theta/en, ,-/w, ,y/en,)/w, , ,+/w, ,\/w,lambda/en, ,w/en,)/w, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,1/m, ,-/w, ,4/m,)/w, ,$/w,$/w,其中/r,$/w,\/w,alpha/en,$/w,为/p,学习率/nw,，/w,$/w,\/w,lambda/en,$/w,为/p,正则化/nw,项/q,的/u,参数/n,1.1/m, ,数据/n,以及/c,相关/v,函数/n,1/m, ,import/en, ,numpy/en, ,as/en, ,np/en, ,2/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,3/m, ,from/en, ,sklearn/en,./w,preprocessing/en, ,import/en, ,polynomialfeatures/en, ,4/m, ,from/en, ,sklearn/en,./w,metrics/en, ,import/en, ,mean/en,_,squared/en,_,error/en, ,5/m, ,6/m, ,data/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w, ,-/w,2.95507616/m,,/w, ,10.94533252/m,]/w,,/w, ,7/m, ,[/w, ,-/w,0.44226119/m,,/w, ,2.96705822/m,]/w,,/w, ,8/m, ,[/w, ,-/w,2.13294087/m,,/w, ,6.57336839/m,]/w,,/w, ,9/m, ,[/w, ,1.84990823/m,,/w, ,5.44244467/m,]/w,,/w, ,10/m, ,[/w, ,0.35139795/m,,/w, ,2.83533936/m,]/w,,/w, ,11/m, ,[/w, ,-/w,1.77443098/m,,/w, ,5.6800407/m, ,]/w,,/w, ,12/m, ,[/w, ,-/w,1.8657203/m, ,,/w, ,6.34470814/m,]/w,,/w, ,13/m, ,[/w, ,1.61526823/m,,/w, ,4.77833358/m,]/w,,/w, ,14/m, ,[/w, ,-/w,2.38043687/m,,/w, ,8.51887713/m,]/w,,/w, ,15/m, ,[/w, ,-/w,1.40513866/m,,/w, ,4.18262786/m,]/w,]/w,)/w, ,16/m, ,m/en, ,=/w, ,data/en,./w,shape/en,[/w,0/m,]/w, ,#, ,样本/n,大小/n, ,17/m, ,x/en, ,=/w, ,data/en,[/w,:/w,,/w, ,0/m,]/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,#, ,将/d,array/en,转换/v,成/v,矩阵/n, ,18/m, ,y/en, ,=/w, ,data/en,[/w,:/w,,/w, ,1/m,]/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w,继续/v,使用/v,多项式/n,回归/v,中/f,的/u,数据/n,。/w,1.2/m, ,岭/ng,回归/v,的/u,手动/b,实现/v,有/v,了/u,上面/f,的/u,理论/n,基础/n,，/w,就/d,可以/v,自己/r,实现/v,岭/ng,回归/v,了/u,，/w,下面/f,是/v,python/en,代码/n,：/w,1/m, ,#, ,代价/n,函数/n, ,2/m, ,def/en, ,l/en,_,theta/en,(/w,theta/en,,/w, ,x/en,_,x/en,0/m,,/w, ,y/en,,/w, ,lamb/en,)/w,:/w, ,3/m, ,"/w,"/w,"/w, ,4/m, ,lamb/en,:/w, ,lambda/en,,/w, ,the/en, ,parameter/en, ,of/en, ,regularization/en, ,5/m, ,theta/en,:/w, ,(/w,n/en,+/w,1/m,)/w,·/w,1/m, ,matrix/en,,/w, ,contains/en, ,the/en, ,parameter/en, ,of/en, ,x/en,0/m,=/w,1/m, ,6/m, ,x/en,_,x/en,0/m,:/w, ,m/en,·/w,(/w,n/en,+/w,1/m,)/w, ,matrix/en,,/w, ,plus/en, ,x/en,0/m, ,7/m, ,"/w,"/w,"/w, ,8/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,x/en,0/m,,/w, ,theta/en,)/w, ,#, ,np/en,./w,dot/en, ,表示/v,矩阵/n,乘/v,法/j, ,9/m, ,theta/en,_,without/en,_,t/en,0/m, ,=/w, ,theta/en,[/w,1/m,:/w,]/w, ,10/m, ,l/en,_,theta/en, ,=/w, ,0.5/m, ,*/w, ,mean/en,_,squared/en,_,error/en,(/w,h/en,,/w, ,y/en,)/w, ,+/w, ,0.5/m, ,*/w, ,lamb/en, ,*/w, ,np/en,./w,sum/en,(/w,np/en,./w,square/en,(/w,theta/en,_,without/en,_,t/en,0/m,)/w,)/w, ,11/m, ,return/en, ,l/en,_,theta/en, ,12/m, ,13/m, ,#, ,梯度/n,下降/v, ,14/m, ,def/en, ,gd/en,(/w,lamb/en,,/w, ,x/en,_,x/en,0/m,,/w, ,theta/en,,/w, ,y/en,,/w, ,alpha/en,)/w,:/w, ,15/m, ,"/w,"/w,"/w, ,16/m, ,lamb/en,:/w, ,lambda/en,,/w, ,the/en, ,parameter/en, ,of/en, ,regularization/en, ,17/m, ,alpha/en,:/w, ,learning/en, ,rate/en, ,18/m, ,x/en,_,x/en,0/m,:/w, ,m/en,·/w,(/w,n/en,+/w,1/m,)/w,,/w, ,plus/en, ,x/en,0/m, ,19/m, ,theta/en,:/w, ,(/w,n/en,+/w,1/m,)/w,·/w,1/m, ,matrix/en,,/w, ,contains/en, ,the/en, ,parameter/en, ,of/en, ,x/en,0/m,=/w,1/m, ,20/m, ,"/w,"/w,"/w, ,21/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,t/en,)/w,:/w, ,22/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,x/en,0/m,,/w, ,theta/en,)/w, ,23/m, ,theta/en,_,with/en,_,t/en,0/m,_,0/m, ,=/w, ,np/en,./w,r/en,_,[/w,np/en,./w,zeros/en,(/w,[/w,1/m,,/w, ,1/m,]/w,)/w,,/w, ,theta/en,[/w,1/m,:/w,]/w,]/w, ,#, ,set/en, ,theta/en,[/w,0/m,]/w, ,=/w, ,0/m, ,24/m, ,theta/en, ,-/w,=/w, ,(/w,alpha/en, ,*/w, ,1/m,//w,m/en, ,*/w, ,np/en,./w,dot/en,(/w,x/en,_,x/en,0/m,./w,t/en,,/w, ,h/en, ,-/w, ,y/en,)/w, ,+/w, ,lamb/en,*/w,(/w,theta/en,_,with/en,_,t/en,0/m,_,0/m,)/w,)/w, ,#, ,add/en, ,the/en, ,gradient/en, ,of/en, ,regularization/en, ,term/en, ,25/m, ,if/en, ,i/en,%/w,50000/m,=/w,=/w,0/m,:/w, ,26/m, ,print/en,(/w,l/en,_,theta/en,(/w,theta/en,,/w, ,x/en,_,x/en,0/m,,/w, ,y/en,,/w, ,lamb/en,)/w,)/w, ,27/m, ,return/en, ,theta/en, ,28/m, ,29/m, ,t/en, ,=/w, ,1200000/m, ,#, ,迭代/vn,次数/n, ,30/m, ,degree/en, ,=/w, ,11/m, ,31/m, ,theta/en, ,=/w, ,np/en,./w,ones/en,(/w,(/w,degree/en, ,+/w, ,1/m,,/w, ,1/m,)/w,)/w, ,#, ,参数/n,的/u,初始化/v,，/w,degree/en, ,=/w, ,11/m,，/w,一个/m,12个/m,参数/n, ,32/m, ,alpha/en, ,=/w, ,0.0000000006/m, ,#, ,学习率/nw, ,33/m, ,#, ,alpha/en, ,=/w, ,0.003/m, ,#, ,学习率/nw, ,34/m, ,lamb/en, ,=/w, ,0.0001/m, ,35/m, ,#, ,lamb/en, ,=/w, ,0/m, ,36/m, ,poly/en,_,features/en,_,d/en, ,=/w, ,polynomialfeatures/en,(/w,degree/en,=/w,degree/en,,/w, ,include/en,_,bias/en,=/w,false/en,)/w, ,37/m, ,x/en,_,poly/en,_,d/en, ,=/w, ,poly/en,_,features/en,_,d/en,./w,fit/en,_,transform/en,(/w,x/en,)/w, ,38/m, ,x/en,_,x/en,0/m, ,=/w, ,np/en,./w,c/en,_,[/w,np/en,./w,ones/en,(/w,(/w,m/en,,/w, ,1/m,)/w,)/w,,/w, ,x/en,_,poly/en,_,d/en,]/w, ,#, ,add/en, ,x/en,0/m, ,=/w, ,1/m, ,to/en, ,each/en, ,instance/en, ,39/m, ,theta/en, ,=/w, ,gd/en,(/w,lamb/en,=/w,lamb/en,,/w, ,x/en,_,x/en,0/m,=/w,x/en,_,x/en,0/m,,/w, ,theta/en,=/w,theta/en,,/w, ,y/en,=/w,y/en,,/w, ,alpha/en,=/w,alpha/en,)/w,上面/f,第/m,10行/mq,对应/v,公式/n,$/w,1/m,-/w,2/m,$/w,，/w,第/m,24行/mq,对应/v,公式/n,$/w,1/m,-/w,3/m,$/w,。/w,由于/c,自由度/n,比较/d,大/a,，/w,此时/r,利用/v,梯度/n,下降/v,的/u,方法/n,训练/vn,模型/n,比较/d,困难/an,，/w,学习率/nw,稍微/d,大/a,一点/m,就/d,会/v,出现/v,出现/v,损失/n,函数/n,的/u,值/n,越过/v,最低点/n,不断/d,增长/v,的/u,情况/n,。/w,下面/f,是/v,训练/vn,结束/v,后/f,的/u,参数/n,以及/c,代价/n,函/n,数值/n,：/w,[/w,[/w, ,1.00078848/m,e/en,+/w,00/m,]/w, ,[/w, ,-/w,1.03862735/m,e/en,-/w,05/m,]/w, ,[/w, ,3.85144400/m,e/en,-/w,05/m,]/w, ,[/w, ,-/w,3.77233288/m,e/en,-/w,05/m,]/w, ,[/w, ,1.28959318/m,e/en,-/w,04/m,]/w, ,[/w, ,-/w,1.42449160/m,e/en,-/w,04/m,]/w, ,[/w, ,4.42760996/m,e/en,-/w,04/m,]/w, ,[/w, ,-/w,5.11518471/m,e/en,-/w,04/m,]/w, ,[/w, ,1.42533716/m,e/en,-/w,03/m,]/w, ,[/w, ,-/w,1.40265037/m,e/en,-/w,03/m,]/w, ,[/w, ,3.13638870/m,e/en,-/w,03/m,]/w, ,[/w, ,1.21862016/m,e/en,-/w,03/m,]/w,]/w, ,3.59934190413/m,从/p,上面/f,的/u,结果/n,看/v,，/w,截距/nw,项/q,的/u,参数/n,最/d,大/a,，/w,高阶/nz,项/q,的/u,参数/n,都/d,比较/d,小/a,。/w,下面/f,是/v,比较/d,原始/a,数据/n,和/c,训练/vn,出来/v,的/u,模型/n,之间/f,的/u,关系/n,：/w,1/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,2.99/m,,/w, ,1.9/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,2/m, ,poly/en,_,features/en,_,d/en,_,with/en,_,bias/en, ,=/w, ,polynomialfeatures/en,(/w,degree/en,=/w,degree/en,,/w, ,include/en,_,bias/en,=/w,true/en,)/w, ,3/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,_,d/en,_,with/en,_,bias/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,4/m, ,y/en,_,plot/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,theta/en,)/w, ,5/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,y/en,_,plot/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,6/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,7/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,'/w,)/w, ,8/m, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,'/w,)/w, ,9/m, ,plt/en,./w,show/en,(/w,)/w,-/w,1/m,，/w,手动/b,实现/v,岭/ng,回归/v,的/u,效果/n,图/n,中/f,模型/n,与/p,原始/a,数据/n,的/u,匹配度/nw,不/d,是/v,太/d,好/a,，/w,但是/c,过/u,拟合/nz,的/u,情况/n,极/d,大/a,的/u,改善/v,了/u,，/w,模型/n,变/v,的/u,更/d,简单/a,了/u,。/w,1.2/m, ,正规/a,方程/n,下面/f,使用/v,正规/a,方程/n,求解/v,：/w,其中/r,$/w,\/w,lambda/en, ,=/w, ,10/m,$/w,1/m, ,theta/en,2/m, ,=/w, ,np/en,./w,linalg/en,./w,inv/en,(/w,np/en,./w,dot/en,(/w,x/en,_,x/en,0/m,./w,t/en,,/w, ,x/en,_,x/en,0/m,)/w, ,+/w, ,10/m,*/w,np/en,./w,identity/en,(/w,x/en,_,x/en,0/m,./w,shape/en,[/w,1/m,]/w,)/w,)/w,./w,dot/en,(/w,x/en,_,x/en,0/m,./w,t/en,)/w,./w,dot/en,(/w,y/en,)/w, ,2/m, ,print/en,(/w,theta/en,2/m,)/w, ,3/m, ,print/en,(/w,l/en,_,theta/en,(/w,theta/en,2/m,,/w, ,x/en,_,x/en,0/m,,/w, ,y/en,,/w, ,lamb/en,)/w,)/w, ,4/m, ,5/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,2/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,6/m, ,poly/en,_,features/en,_,d/en,_,with/en,_,bias/en, ,=/w, ,polynomialfeatures/en,(/w,degree/en,=/w,degree/en,,/w, ,include/en,_,bias/en,=/w,true/en,)/w, ,7/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,_,d/en,_,with/en,_,bias/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,8/m, ,y/en,_,plot/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,theta/en,2/m,)/w, ,9/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,y/en,_,plot/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,10/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,11/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,'/w,)/w, ,12/m, ,plt/en,./w,ylabel/en,(/w,'/w,y/en,'/w,)/w, ,13/m, ,plt/en,./w,show/en,(/w,)/w,参数/n,即/v,代价/n,函数/n,的/u,值/n,：/w,[/w,[/w, ,0.56502653/m,]/w, ,[/w,-/w,0.12459546/m,]/w, ,[/w, ,0.26772443/m,]/w, ,[/w,-/w,0.15642405/m,]/w, ,[/w, ,0.29249514/m,]/w, ,[/w,-/w,0.10084392/m,]/w, ,[/w, ,0.22791769/m,]/w, ,[/w, ,0.1648667/m, ,]/w, ,[/w,-/w,0.05686718/m,]/w, ,[/w,-/w,0.03906615/m,]/w, ,[/w,-/w,0.00111673/m,]/w, ,[/w, ,0.00101724/m,]/w,]/w, ,0.604428719639/m,从/p,参数/n,来看/v,，/w,截距/nw,项/q,的/u,系数/n,减小/v,了/u,，/w,1/m,-/w,7/m,阶/ng,都/d,有/v,比较/d,大/a,的/u,参数/n,都/d,比较/d,大/a,，/w,后面/f,更/d,高阶/nz,项/q,的/u,参数/n,越来越/d,小/a,，/w,下面/f,是/v,函数/n,图像/n,：/w,-/w,2/m,，/w,使用/v,正规/a,方程/n,求解/v,从/p,图/n,中/f,可以/v,看到/v,，/w,虽然/c,模型/n,的/u,自由度/n,没/d,变/v,，/w,还是/c,11/m,，/w,但是/c,过/u,拟合/nz,的/u,程度/n,得到/v,了/u,改善/v,。/w,1.3/m, ,使用/v,scikit/en,-/w,learnscikit/en,-/w,learn/en,中/f,有/v,专门/d,计算岭/ns,回归/v,的/u,函数/n,，/w,而且/c,效果/n,要/v,比/p,上面/f,的/u,方法/n,好/a,。/w,使用/v,scikit/en,-/w,learn/en,中/f,的/u,岭/ng,回归/v,，/w,只/d,需要/v,输入/v,以下/f,参数/n,：/w,alpha/en,:/w, ,上面/f,公式/n,中/f,的/u,$/w,\/w,lambda/en,$/w,，/w,正则化/nw,项/q,的/u,系数/n,；/w,solver/en,:/w, ,求解/v,方法/n,；/w,x/en,:/w, ,训练/vn,样本/n,；/w,y/en,:/w, ,训练/vn,样本/n,的/u,标签/n,./w,1/m, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,ridge/en, ,2/m, ,3/m, ,#, ,代价/n,函数/n, ,4/m, ,def/en, ,l/en,_,theta/en,_,new/en,(/w,intercept/en,,/w, ,coef/en,,/w, ,x/en,,/w, ,y/en,,/w, ,lamb/en,)/w,:/w, ,5/m, ,"/w,"/w,"/w, ,6/m, ,lamb/en,:/w, ,lambda/en,,/w, ,the/en, ,parameter/en, ,of/en, ,regularization/en, ,7/m, ,theta/en,:/w, ,(/w,n/en,+/w,1/m,)/w,·/w,1/m, ,matrix/en,,/w, ,contains/en, ,the/en, ,parameter/en, ,of/en, ,x/en,0/m,=/w,1/m, ,8/m, ,x/en,_,x/en,0/m,:/w, ,m/en,·/w,(/w,n/en,+/w,1/m,)/w, ,matrix/en,,/w, ,plus/en, ,x/en,0/m, ,9/m, ,"/w,"/w,"/w, ,10/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,,/w, ,coef/en,)/w, ,+/w, ,intercept/en, ,#, ,np/en,./w,dot/en, ,表示/v,矩阵/n,乘/v,法/j, ,11/m, ,l/en,_,theta/en, ,=/w, ,0.5/m, ,*/w, ,mean/en,_,squared/en,_,error/en,(/w,h/en,,/w, ,y/en,)/w, ,+/w, ,0.5/m, ,*/w, ,lamb/en, ,*/w, ,np/en,./w,sum/en,(/w,np/en,./w,square/en,(/w,coef/en,)/w,)/w, ,12/m, ,return/en, ,l/en,_,theta/en, ,13/m, ,14/m, ,lamb/en, ,=/w, ,10/m, ,15/m, ,ridge/en,_,reg/en, ,=/w, ,ridge/en,(/w,alpha/en,=/w,lamb/en,,/w, ,solver/en,=/w,"/w,cholesky/en,"/w,)/w, ,16/m, ,ridge/en,_,reg/en,./w,fit/en,(/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,)/w, ,17/m, ,print/en,(/w,ridge/en,_,reg/en,./w,intercept/en,_,,/w, ,ridge/en,_,reg/en,./w,coef/en,_,)/w, ,18/m, ,print/en,(/w,l/en,_,theta/en,_,new/en,(/w,intercept/en,=/w,ridge/en,_,reg/en,./w,intercept/en,_,,/w, ,coef/en,=/w,ridge/en,_,reg/en,./w,coef/en,_,./w,t/en,,/w, ,x/en,=/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,=/w,y/en,,/w, ,lamb/en,=/w,lamb/en,)/w,)/w, ,19/m, ,20/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,2/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,21/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,_,d/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,22/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,ridge/en,_,reg/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,ridge/en,_,reg/en,./w,intercept/en,_, ,23/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,h/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,24/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,25/m, ,plt/en,./w,show/en,(/w,)/w,训练/vn,结束/v,后/f,得到/v,的/u,参数/n,为/p,（/w,分别/d,表示/v,截距/nw,，/w,特征/n,的/u,系数/n,；/w,代价/n,函数/n,的/u,值/n,）/w,：/w,[/w, ,3.03698398/m,]/w, ,[/w,[/w, ,-/w,2.95619849/m,e/en,-/w,02/m, ,6.09137803/m,e/en,-/w,02/m, ,-/w,4.93919290/m,e/en,-/w,02/m, ,1.10593684/m,e/en,-/w,01/m, ,-/w,4.65660197/m,e/en,-/w,02/m, ,1.06387336/m,e/en,-/w,01/m, ,5.14340826/m,e/en,-/w,02/m, ,-/w,2.29460359/m,e/en,-/w,02/m, ,-/w,1.12705709/m,e/en,-/w,02/m, ,-/w,1.73925386/m,e/en,-/w,05/m, ,2.79198986/m,e/en,-/w,04/m,]/w,]/w, ,0.213877232488/m,-/w,3/m,，/w,使用/v,scikit/en,-/w,learn/en,训练岭/ns,回归/v,经过/p,与/p,前面/f,两种/mq,方法/n,得到/v,的/u,结果/n,比较/d,，/w,这里/r,得到/v,的/u,曲线/n,更加/d,平滑/an,，/w,不仅/c,降低/v,了/u,过/u,拟合/nz,的/u,风险/n,，/w,代价/n,函数/n,的/u,值/n,也/d,非常/d,低/a,。/w,2/m,./w, ,lasso/en,回归/v,lasso/en,回归/v,于岭/ns,回归/v,非常/d,相似/a,，/w,它们/r,的/u,差别/n,在于/v,使用/v,了/u,不同/a,的/u,正/d,则/d,化项/nw,。/w,最终/d,都/d,实现/v,了/u,约束/vn,参数/n,从而/c,防止/v,过/u,拟合/nz,的/u,效果/n,。/w,但是/c,lasso/en,之所以/c,重要/a,，/w,还有/v,另/r,一个/m,原因/n,是/v,：/w,lasso/en,能够/v,将/d,一些/m,作用/n,比较/d,小/a,的/u,特征/n,的/u,参数/n,训练/vn,为/p,0/m,，/w,从而/c,获得/v,稀疏/a,解/v,。/w,也就是说/l,用/p,这种/r,方法/n,，/w,在/p,训练/vn,模型/n,的/u,过程/n,中/f,实现/v,了/u,降/v,维/q,(/w,特征/n,筛选/v,)/w,的/u,目的/n,。/w,lasso/en,回归/v,的/u,代价/n,函数/n,为/p,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,m/en,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,(/w,y/en,^,{/w,(/w,i/en,)/w,}/w, ,-/w, ,(/w,w/en, ,x/en,^,{/w,(/w,i/en,)/w,}/w, ,+/w, ,b/en,)/w,)/w,^,2/m,}/w, , ,+/w, ,\/w,lambda/en, ,|/w,|/w,w/en,|/w,|/w,_,1/m, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,mse/en,(/w,\/w,theta/en,)/w, ,+/w, ,\/w,lambda/en, ,\/w,sum/en,_,{/w,i/en, ,=/w, ,1/m,}/w,^,{/w,n/en,}/w,{/w,|/w,\/w,theta/en,_,i/en,|/w,}/w, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,2/m, ,-/w, ,1/m,)/w,$/w,$/w,上式/nw,中/f,的/u,$/w,w/en,$/w,是/v,长度/n,为/p,$/w,n/en,$/w,的/u,向量/n,，/w,不/d,包括/v,截距/nw,项/q,的/u,系数/n,$/w,θ,_,0/m,$/w,,/w, ,$/w,θ,$/w,是/v,长度/n,为/p,$/w,n/en,+/w,1/m,$/w,的/u,向量/n,，/w,包括/v,截距/nw,项/q,的/u,系数/n,$/w,θ,_,0/m,$/w,，/w,$/w,m/en,$/w,为/p,样本数/n,，/w,$/w,n/en,$/w,为/p,特征/n,数/m,./w,$/w,|/w,|/w,w/en,|/w,|/w,_,1/m,$/w,表示/v,参数/n,$/w,w/en,$/w,的/u,$/w,l/en,1/m,$/w,范数/nr,，/w,也/d,是/v,一种/mq,表示/v,距离/n,的/u,函数/n,。/w,加入/v,$/w,w/en,$/w,表示/v,3维/mq,空间/n,中/f,的/u,一个/m,点/q,$/w,(/w,x/en,,/w, ,y/en,,/w, ,z/en,)/w,$/w,，/w,那么/r,$/w,|/w,|/w,w/en,|/w,|/w,_,1/m, ,=/w, ,|/w,x/en,|/w, ,+/w, ,|/w,y/en,|/w, ,+/w, ,|/w,z/en,|/w,$/w,，/w,即/v,各个/r,方向/n,上/f,的/u,绝对值/n,（/w,长度/n,）/w,之和/n,。/w,式子/n,$/w,2/m,-/w,1/m,$/w,的/u,梯度/n,为/p,：/w,$/w,$/w,\/w,nabla/en,_,{/w,\/w,theta/en,}/w,mse/en,(/w,\/w,theta/en,)/w, ,+/w, ,\/w,lambda/en, ,\/w,begin/en,{/w,pmatrix/en,}/w, ,sign/en,(/w,\/w,theta/en,_,1/m,)/w, ,\/w,\/w, , ,sign/en,(/w,\/w,theta/en,_,2/m,)/w, ,\/w,\/w, ,\/w,vdots/en, ,\/w,\/w, ,sign/en,(/w,\/w,theta/en,_,n/en,)/w, ,\/w,end/en,{/w,pmatrix/en,}/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,2/m,-/w,2/m,)/w,$/w,$/w,其中/r,$/w,sign/en,(/w,\/w,theta/en,_,i/en,)/w,$/w,由/p,$/w,\/w,theta/en,_,i/en,$/w,的/u,符号/n,决定/v,:/w, ,$/w,\/w,theta/en,_,i/en, ,>, ,0/m,,/w, ,sign/en,(/w,\/w,theta/en,_,i/en,)/w, ,=/w, ,1/m,;/w, ,\/w, ,\/w,theta/en,_,i/en, ,=/w, ,0/m,,/w, ,sign/en,(/w,\/w,theta/en,_,i/en,)/w, ,=/w, ,0/m,;/w, ,\/w, ,\/w,theta/en,_,i/en, ,</w, ,0/m,,/w, ,sign/en,(/w,\/w,theta/en,_,i/en,)/w, ,=/w, ,-/w,1/m,$/w,./w,2/m,./w,1/m, ,lasso/en,的/u,实现/v,直接/ad,使用/v,scikit/en,-/w,learn/en,中/f,的/u,函数/n,：/w,可以/v,参考/v,官方/n,文档/n,，/w,http/en,:/w,//w,//w,scikit/en,-/w,learn/en,./w,org/en,//w,stable/en,//w,modules/en,//w,generated/en,//w,sklearn/en,./w,linear/en,_,model/en,./w,lasso/en,./w,html/en,下面/f,模型/n,中/f,的/u,参数/n,alpha/en,就/d,是/v,公式/n,(/w,2/m,-/w,1/m,)/w,中/f,的/u,参数/n,$/w,\/w,lambda/en,$/w,，/w,是/v,正则化/nw,项/q,的/u,系数/n,，/w,可以/v,取/v,大于/v,0/m,的/u,任意值/nw,。/w,alpha/en,的/u,值/n,越/d,大/a,，/w,对/p,模型/n,中/f,参数/n,的/u,惩罚/vn,力度/n,越/d,大/a,，/w,因此/c,会/v,有/v,更/d,多/a,的/u,参数/n,被/p,训练/vn,为/p,0/m,（/w,只/d,对/p,线性/n,相关/v,的/u,参数/n,起/v,作用/n,）/w,，/w,模型/n,也/d,就/d,变/v,得/u,更加/d,简单/a,了/u,。/w,1/m, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,lasso/en, ,2/m, ,3/m, ,lamb/en, ,=/w, ,0.025/m, ,4/m, ,lasso/en,_,reg/en, ,=/w, ,lasso/en,(/w,alpha/en,=/w,lamb/en,)/w, ,5/m, ,lasso/en,_,reg/en,./w,fit/en,(/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,)/w, ,6/m, ,print/en,(/w,lasso/en,_,reg/en,./w,intercept/en,_,,/w, ,lasso/en,_,reg/en,./w,coef/en,_,)/w, ,7/m, ,print/en,(/w,l/en,_,theta/en,_,new/en,(/w,intercept/en,=/w,lasso/en,_,reg/en,./w,intercept/en,_,,/w, ,coef/en,=/w,lasso/en,_,reg/en,./w,coef/en,_,./w,t/en,,/w, ,x/en,=/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,=/w,y/en,,/w, ,lamb/en,=/w,lamb/en,)/w,)/w, ,8/m, ,9/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,2/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,10/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,_,d/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,11/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,lasso/en,_,reg/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,lasso/en,_,reg/en,./w,intercept/en,_, ,12/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,h/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,13/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,14/m, ,plt/en,./w,show/en,(/w,)/w,最终/d,获得/v,的/u,参数/n,以及/c,代价/n,函数/n,的/u,值/n,为/p,：/w,其中/r,计算/v,代价/n,函数/n,值/n,的/u,函数/n,"/w,l/en,_,theta/en,_,new/en,"/w,需要/v,修改/v,其中/r,的/u,"/w,l/en,_,theta/en,"/w,为/p,"/w,l/en,_,theta/en, ,=/w, ,0.5/m, ,*/w, ,mean/en,_,squared/en,_,error/en,(/w,h/en,,/w, ,y/en,)/w, ,+/w, ,lamb/en, ,*/w, ,np/en,./w,sum/en,(/w,np/en,./w,abs/en,(/w,coef/en,)/w,)/w,"/w,[/w, ,2.86435179/m,]/w, ,[/w, ,-/w,0.00000000/m,e/en,+/w,00/m, ,5.29099723/m,e/en,-/w,01/m, ,-/w,3.61182017/m,e/en,-/w,02/m, ,9.75614738/m,e/en,-/w,02/m, ,1.61971116/m,e/en,-/w,03/m, ,-/w,3.42711766/m,e/en,-/w,03/m, ,2.78782527/m,e/en,-/w,04/m, ,-/w,1.63421713/m,e/en,-/w,04/m, ,-/w,5.64291215/m,e/en,-/w,06/m, ,-/w,1.38933655/m,e/en,-/w,05/m, ,1.02036898/m,e/en,-/w,06/m,]/w,0.0451291096773/m,从/p,结果/n,可以/v,看到/v,，/w,截距/nw,项/q,的/u,值/n,最/d,大/a,，/w,一次/mq,项/q,的/u,系数/n,为/p,0/m,，/w,二次/mq,项/q,的/u,系数/n,是/v,剩下/v,的/u,所有/b,项/q,中值/n,最/d,大/a,的/u,，/w,也/d,比较/d,符合/v,数据/n,的/u,真实/a,来源/n,。/w,这里/r,也/d,可以/v,看/v,出来/v,，/w,更/d,高阶/nz,的/u,项/q,虽然/c,系数/n,都/d,非常/d,小/a,但/c,不/d,为/p,0/m,，/w,这/r,是/v,因为/c,这些/r,项/q,之间/f,的/u,关系/n,是非线性/nw,的/u,，/w,无法/v,用/p,线性/n,组合/v,互相/d,表示/v,。/w,-/w,1/m,，/w,lasso/en,回归/v,得到/v,的/u,图像/n,-/w,1/m,是/v,目前/t,在/p,$/w,degree/en,=/w,11/m,$/w,的/u,情况/n,下/f,，/w,得到/v,的/u,最/d,好/a,模型/n,。/w,3/m,./w, ,弹性/n,网络/n,（/w, ,elastic/en, ,net/en,）/w,弹性/n,网络/n,是/v,结合/v,了/u,岭/ng,回归/v,和/c,lasso/en,回归/v,，/w,由/p,两者/r,加权/v,平均/a,所得/n,。/w,据/p,介绍/v,这种/r,方法/n,在/p,特征/n,数/m,大于/v,训练/vn,集样/nw,本数/n,或/c,有/v,些/q,特征/n,之间/f,高度/d,相关/v,时/ng,比/p,lasso/en,更加/d,稳定/a,。/w,其/r,代价/n,函数/n,为/p,：/w,$/w,$/w,j/en,(/w,\/w,theta/en,)/w, ,=/w, ,\/w,frac/en,{/w,1/m,}/w,{/w,2/m,}/w,mse/en,(/w,\/w,theta/en,)/w, ,+/w, ,r/en,\/w,lambda/en, ,\/w,sum/en,_,{/w,i/en, ,=/w, ,1/m,}/w,^,{/w,n/en,}/w,{/w,|/w,\/w,theta/en,_,i/en,|/w,}/w, ,+/w, ,\/w,frac/en,{/w,1/m,-/w,r/en,}/w,{/w,2/m,}/w, ,\/w,lambda/en, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,n/en,}/w, ,{/w,\/w,theta/en,_,i/en,^,2/m,}/w, ,\/w, ,\/w,quad/en, ,\/w,cdots/en, ,\/w, ,(/w,3/m, ,-/w, ,1/m,)/w,$/w,$/w,其中/r,$/w,r/en,$/w,表示/v,$/w,l/en,1/m,$/w,所/u,占/v,的/u,比例/n,。/w,使用/v,scikit/en,-/w,learn/en,的/u,实现/v,：/w,1/m, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,elasticnet/en, ,2/m, ,3/m, ,#, ,代价/n,函数/n, ,4/m, ,def/en, ,l/en,_,theta/en,_,ee/en,(/w,intercept/en,,/w, ,coef/en,,/w, ,x/en,,/w, ,y/en,,/w, ,lamb/en,,/w, ,r/en,)/w,:/w, ,5/m, ,"/w,"/w,"/w, ,6/m, ,lamb/en,:/w, ,lambda/en,,/w, ,the/en, ,parameter/en, ,of/en, ,regularization/en, ,7/m, ,theta/en,:/w, ,(/w,n/en,+/w,1/m,)/w,·/w,1/m, ,matrix/en,,/w, ,contains/en, ,the/en, ,parameter/en, ,of/en, ,x/en,0/m,=/w,1/m, ,8/m, ,x/en,_,x/en,0/m,:/w, ,m/en,·/w,(/w,n/en,+/w,1/m,)/w, ,matrix/en,,/w, ,plus/en, ,x/en,0/m, ,9/m, ,"/w,"/w,"/w, ,10/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,,/w, ,coef/en,)/w, ,+/w, ,intercept/en, ,#, ,np/en,./w,dot/en, ,表示/v,矩阵/n,乘/v,法/j, ,11/m, ,l/en,_,theta/en, ,=/w, ,0.5/m, ,*/w, ,mean/en,_,squared/en,_,error/en,(/w,h/en,,/w, ,y/en,)/w, ,+/w, ,r/en, ,*/w, ,lamb/en, ,*/w, ,np/en,./w,sum/en,(/w,np/en,./w,abs/en,(/w,coef/en,)/w,)/w, ,+/w, ,0.5/m, ,*/w, ,(/w,1/m,-/w,r/en,)/w, ,*/w, ,lamb/en, ,*/w, ,np/en,./w,sum/en,(/w,np/en,./w,square/en,(/w,coef/en,)/w,)/w, ,12/m, ,return/en, ,l/en,_,theta/en, ,13/m, ,14/m, ,elastic/en,_,net/en, ,=/w, ,elasticnet/en,(/w,alpha/en,=/w,0.5/m,,/w, ,l/en,1/m,_,ratio/en,=/w,0.8/m,)/w, ,15/m, ,elastic/en,_,net/en,./w,fit/en,(/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,)/w, ,16/m, ,print/en,(/w,elastic/en,_,net/en,./w,intercept/en,_,,/w, ,elastic/en,_,net/en,./w,coef/en,_,)/w, ,17/m, ,print/en,(/w,l/en,_,theta/en,_,ee/en,(/w,intercept/en,=/w,elastic/en,_,net/en,./w,intercept/en,_,,/w, ,coef/en,=/w,elastic/en,_,net/en,./w,coef/en,_,./w,t/en,,/w, ,x/en,=/w,x/en,_,poly/en,_,d/en,,/w, ,y/en,=/w,y/en,,/w, ,lamb/en,=/w,0.1/m,,/w, ,r/en,=/w,0.8/m,)/w,)/w, ,18/m, ,19/m, ,x/en,_,plot/en, ,=/w, ,np/en,./w,linspace/en,(/w,-/w,3/m,,/w, ,2/m,,/w, ,1000/m,)/w,./w,reshape/en,(/w,-/w,1/m,,/w, ,1/m,)/w, ,20/m, ,x/en,_,plot/en,_,poly/en, ,=/w, ,poly/en,_,features/en,_,d/en,./w,fit/en,_,transform/en,(/w,x/en,_,plot/en,)/w, ,21/m, ,h/en, ,=/w, ,np/en,./w,dot/en,(/w,x/en,_,plot/en,_,poly/en,,/w, ,elastic/en,_,net/en,./w,coef/en,_,./w,t/en,)/w, ,+/w, ,elastic/en,_,net/en,./w,intercept/en,_, ,22/m, ,plt/en,./w,plot/en,(/w,x/en,_,plot/en,,/w, ,h/en,,/w, ,'/w,r/en,-/w,'/w,)/w, ,23/m, ,plt/en,./w,plot/en,(/w,x/en,,/w, ,y/en,,/w, ,'/w,b/en,./w,'/w,)/w, ,24/m, ,plt/en,./w,show/en,(/w,)/w,得到/v,的/u,结果/n,为/p,：/w,[/w, ,3.31466833/m,]/w, ,[/w, ,-/w,0.00000000/m,e/en,+/w,00/m, ,0.00000000/m,e/en,+/w,00/m, ,-/w,0.00000000/m,e/en,+/w,00/m, ,1.99874040/m,e/en,-/w,01/m, ,-/w,1.21830209/m,e/en,-/w,02/m, ,2.58040545/m,e/en,-/w,04/m, ,3.01117857/m,e/en,-/w,03/m, ,-/w,8.54952421/m,e/en,-/w,04/m, ,4.35227606/m,e/en,-/w,05/m, ,-/w,2.84995639/m,e/en,-/w,06/m, ,-/w,8.36248799/m,e/en,-/w,06/m,]/w, ,0.0807738447192/m,该/r,方法/n,中/f,得到/v,了/u,，/w,更/d,多/a,的/u,0/m,，/w,当然/d,这/r,也/d,跟/p,参数/n,的/u,设置/v,有关/vn,。/w,-/w,1/m,，/w,使用/v,elastic/en,-/w,net/en,得到/v,的/u,结果/n,4/m,./w, ,正则化/nw,项/q,的/u,使用/v,以及/c,l/en,1/m,与/p,l/en,2/m,的/u,比较/d,根据/p,吴恩达/nr,老师/n,的/u,机器/n,学习/v,公开课/n,，/w,建议/n,使用/v,下面/f,的/u,步骤/n,来/v,确定/v,$/w,\/w,lambda/en,$/w,的/u,值/n,：/w,创建/v,一个/m,$/w,\/w,lambda/en,$/w,值/n,的/u,列表/v,，/w,例如/v,$/w,\/w,lambda/en, ,\/w,in/en, ,{/w,0/m,,/w, ,0.01/m,,/w, ,0.02/m,,/w, ,0.04/m,,/w, ,0.08/m,,/w, ,0.16/m,,/w, ,0.32/m,,/w, ,0.64/m,,/w, ,1.28/m,,/w, ,2.56/m,,/w, ,5.12/m,,/w, ,10.24/m,}/w,$/w,;/w,创建/v,不同/a,degree/en,的/u,模型/n,（/w,或/c,改变/v,其他/r,变量/n,）/w,;/w,遍历/nw,不同/a,的/u,模型/n,和/c,不同/a,的/u,$/w,\/w,lambda/en,$/w,值/n,;/w,使用/v,学习/v,到/v,的/u,参数/n,$/w,\/w,theta/en,$/w,（/w,包含/v,正/d,则/d,化项/nw,）/w,计算/v,验证/vn,集/vg,上/f,的/u,误差/n,（/w,计算/v,误差/n,时/ng,不/d,包含/v,正/d,则/d,化项/nw,）/w,，/w,$/w,j/en,_,{/w,cv/en,}/w,(/w,\/w,theta/en,)/w,$/w,;/w,选择/v,在/p,验证/vn,集/vg,上/f,误差/n,最/d,小/a,的/u,参数/n,组合/v,（/w,degree/en,和/c,$/w,\/w,lambda/en,$/w,）/w,;/w,使用/v,选/v,出来/v,的/u,参数/n,和/c,$/w,\/w,lambda/en,$/w,在/p,测试/vn,集/vg,上/f,测试/vn,，/w,计算/v,$/w,j/en,_,{/w,test/en,}/w,(/w,\/w,theta/en,)/w,$/w,./w,下面/f,通过/p,一张/mq,图像/n,来/v,比较/d,一下/m,岭/ng,回归/v,和/c,lasso/en,回归/v,：/w,-/w,1/m,，/w,lasso/en,与/p,岭/ng,回归/v,的/u,比较/d,（/w,俯瞰/v,图/n,）/w,上图/n,中/f,，/w,左上方/nw,表示/v,$/w,l/en,1/m,$/w,（/w,图/n,中/f,菱形/n,图案/n,）/w,和/c,代价/n,函数/n,（/w,图/n,中/f,深色/b,椭圆环/nw,）/w,；/w,左下方/f,表示/v,$/w,l/en,2/m,$/w,（/w,椭圆形/n,线圈/n,）/w,和/c,代价/n,函数/n,（/w,图/n,中/f,深色/b,椭圆环/nw,）/w,。/w,同一/b,条/q,线/n,上/f,（/w,或/c,同/p,一个/m,环上/nw,）/w,，/w,表示/v,对应/v,的/u,函/n,数值/n,相同/a,；/w,图案/n,中心/n,分别/d,表示/v,$/w,l/en,1/m,,/w, ,l/en,2/m,$/w,范数/nr,以及/c,代价/n,函数/n,的/u,最小值/nz,位置/n,。/w,右边/f,表示/v,代价/n,函数/n,加上/v,对应/v,的/u,正/d,则/d,化项/nw,之后/f,的/u,图像/n,。/w,添加/vn,正/d,则/d,化项/nw,之后/f,，/w,会/v,影响/vn,原来/d,的/u,代价/n,函数/n,的/u,最小值/nz,的/u,位置/n,，/w,以及/c,梯度/n,下降/v,时/ng,的/u,路线/n,（/w,如果/c,参数/n,调整/vn,合适/a,的话/u,，/w,最小值/nz,应该/v,在/p,距离/n,原来/d,代价/n,函数/n,最/d,小值/nw,附近/f,且/c,与/p,正则化/nw,项/q,的/u,图像/n,相交/v,，/w,因为/c,此