一/m,./w,背景/n,5月/t,9号/mq,到/v,北大/j,去/v,听/v,hulu/en,的/u,讲座/n,《/w,推荐/v,系统/n,和/c,计算/v,广告/n,在/p,视频/n,行业/n,应用/vn,》/w,，/w,想到/v,能/v,见到/v,传说/n,中/f,的/u,项亮/nr,大神/nz,，/w,特地/d,拿/v,了/u,本/r,《/w,推荐/v,系统/n,实践/v,》/w,求/v,签名/v,。/w,讲座/n,开始/v,，/w,主讲人/n,先/d,问/v,了/u,下/f,哪些/r,同学/n,有/v,机器/n,学习/v,的/u,背景/n,，/w,我/r,恬不知耻/i,的/u,毅然/d,举手/v,，/w,真/d,是/v,惭愧/an,。/w,后来/t,主讲人/n,在/p,讲座/n,中/f,提到/v,了/u,最小二乘法/nw,，/w,说/v,这个/r,是/v,机器/n,学习/v,最/d,基础/n,的/u,算法/n,。/w,神马/nz,，/w,最/d,基础/n,，/w,我/r,咋/r,不/d,知道/v,呢/y,！/w, ,看来/v,以后/f,还是/c,要/v,对/p,自己/r,有/v,清晰/a,认识/v,。/w,回来/v,赶紧/d,上百/j,度/q,，/w,搜/v,了/u,下/f,什么/r,是/v,最小二乘法/nw,。/w,先/d,看/v,下/f,百度/mq,百科/n,的/u,介绍/v,：/w,最小二乘法/nw,（/w,又/d,称/v,最/d,小平/n,方法/n,）/w,是/v,一种/mq,数学/n,优化/v,技术/n,。/w,它/r,通过/p,最小化/nw,误差/n,的/u,平方/q,和/c,寻找/v,数据/n,的/u,最佳/z,函数/n,匹配/vn,。/w,利用/v,最小二乘法/nw,可以/v,简便/a,地/u,求得/v,未知/vn,的/u,数据/n,，/w,并/c,使得/v,这些/r,求得/v,的/u,数据/n,与/p,实际/n,数据/n,之间/f,误差/n,的/u,平方/q,和/c,为/p,最/d,小/a,。/w,最小二乘法/nw,还/d,可/v,用于/v,曲线/n,拟合/nz,。/w,其他/r,一些/m,优化/v,问题/n,也/d,可/v,通过/p,最小化/nw,能量/n,或/c,最/d,大/a,化熵/nw,用/p,最小二乘法/nw,来/v,表达/v,。/w,通过/p,这/r,段/q,描述/v,可以/v,看/v,出来/v,，/w,最小二乘法/nw,也/d,是/v,一种/mq,优化/v,方法/n,，/w,求得/v,目标/n,函数/n,的/u,最优/ad,值/n,。/w,并且/c,也/d,可以/v,用于/v,曲线/n,拟合/nz,，/w,来/v,解决/v,回归/v,问题/n,。/w,难怪/d,《/w,统计/v,学习/v,方法/n,》/w,中/f,提到/v,，/w,回归/v,学习/v,最/d,常用/a,的/u,损失/n,函数/n,是/v,平方/q,损失/n,函数/n,，/w,在/p,此/r,情况/n,下/f,，/w,回归/v,问题/n,可以/v,著名/a,的/u,最小二乘法/nw,来/v,解决/v,。/w,看来/v,最小二乘法/nw,果然/d,是/v,机器/n,学习/v,领域/n,做/v,有名/a,和/c,有效/a,的/u,算法/n,之一/r,。/w,二/m,./w, ,最小二乘法/nw,我们/r,以/p,最/d,简单/a,的/u,一元线性/nw,模型/n,来/v,解释/v,最小二乘法/nw,。/w,什么/r,是/v,一元线性/nw,模型/n,呢/y,？/w, ,监督/vn,学习/v,中/f,，/w,如果/c,预测/v,的/u,变量/n,是/v,离散/vn,的/u,，/w,我们/r,称/v,其/r,为/p,分类/vn,（/w,如/v,决策/n,树/v,，/w,支持/v,向/p,量机/nw,等/u,）/w,，/w,如果/c,预测/v,的/u,变量/n,是/v,连续/a,的/u,，/w,我们/r,称/v,其/r,为/p,回归/v,。/w,回归/v,分析/vn,中/f,，/w,如果/c,只/d,包括/v,一个/m,自/p,变量/n,和/c,一个/m,因/p,变量/n,，/w,且/c,二者/r,的/u,关系/n,可/v,用/p,一条/mq,直线/n,近似/a,表示/v,，/w,这种/r,回归/v,分析/vn,称为/v,一元线性/nw,回归/v,分析/vn,。/w,如果/c,回归/v,分析/vn,中/f,包括/v,两个/m,或/c,两个/m,以上/f,的/u,自变量/n,，/w,且/c,因/p,变量/n,和/c,自变量/n,之间/f,是/v,线性/n,关系/n,，/w,则/d,称为/v,多元线性/nw,回归/v,分析/vn,。/w,对于/p,二维空间线性/nw,是/v,一条/mq,直线/n,；/w,对于/p,三维/nz,空间线性/nw,是/v,一个/m,平面/n,，/w,对于/p,多维空间线性/nw,是/v,一个/m,超平面/nz,./w,./w,./w,对于/p,一元线性/nw,回归/v,模型/n,,/w, ,假设/v,从/p,总体/n,中/f,获取/v,了/u,n/en,组/q,观察值/nw,（/w,x/en,1/m,，/w,y/en,1/m,）/w,，/w,（/w,x/en,2/m,，/w,y/en,2/m,）/w,，/w, ,…/w,，/w,（/w,xn/en,，/w,yn/en,）/w,。/w,对于/p,平面/n,中/f,的/u,这/r,n/en,个/q,点/q,，/w,可以/v,使用/v,无数/m,条/q,曲线/n,来/v,拟合/nz,。/w,要求/v,样本/n,回归/v,函数/n,尽可能/d,好/a,地/u,拟合/nz,这/r,组值/nw,。/w,综合/vn,起来/v,看/v,，/w,这/r,条/q,直线/n,处于/v,样本/n,数据/n,的/u,中心/n,位置/n,最/d,合理/a,。/w, ,选择/v,最佳/z,拟合/nz,曲线/n,的/u,标准/n,可以/v,确定/v,为/p,：/w,使/v,总/b,的/u,拟合/nz,误差/n,（/w,即/v,总/b,残差/nw,）/w,达到/v,最小/a,。/w,有/v,以下/f,三个/m,标准/n,可以/v,选择/v,：/w,（/w,1/m,）/w,用/p,“/w,残差/nw,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,是/v,一个/m,途径/n,。/w,但/c,很快/d,发现/v,计算/v,“/w,残差/nw,和/c,”/w,存在/v,相互/d,抵消/v,的/u,问题/n,。/w,（/w,2/m,）/w,用/p,“/w,残差/nw,绝对值/n,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,也/d,是/v,一个/m,途径/n,。/w,但/c,绝对值/n,的/u,计算/v,比较/d,麻烦/an,。/w,（/w,3/m,）/w,最小二乘法/nw,的/u,原则/n,是/v,以/p,“/w,残差/nw,平方/q,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,。/w,用/p,最/d,小/a,二/m,乘/v,法除/nw,了/u,计算/v,比较/d,方便/a,外/f,，/w,得到/v,的/u,估计/v,量/n,还/d,具有/v,优良/z,特性/n,。/w,这种/r,方法/n,对/p,异常/a,值/n,非常/d,敏感/a,。/w,最/d,常用/a,的/u,是/v,普通/a,最小二乘法/nw,（/w, ,ordinary/en, , ,least/en, ,square/en,，/w,ols/en,）/w,：/w,所/u,选择/v,的/u,回归/v,模型/n,应该/v,使/v,所有/b,观察值/nw,的/u,残差/nw,平方/q,和/c,达到/v,最小/a,。/w,（/w,q/en,为/p,残差/nw,平方和/n,）/w,-/w, ,即/v,采用/v,平方/q,损失/n,函数/n,。/w,样本/n,回归/v,模型/n,：/w,其中/r,ei/en,为/p,样本/n,（/w,xi/en,,/w, ,yi/en,）/w,的/u,误差/n,平方/q,损失/n,函数/n,：/w,则/d,通过/p,q/en,最/d,小/a,确定/v,这/r,条/q,直线/n,，/w,即/v,确定/v,，/w,以为/v,变量/n,，/w,把/p,它们/r,看作/v,是/v,q/en,的/u,函数/n,，/w,就/d,变成/v,了/u,一个/m,求/v,极/d,值/n,的/u,问题/n,，/w,可以/v,通过/p,求/v,导数/n,得到/v,。/w,求/v,q/en,对/p,两个/m,待/v,估/v,参数/n,的/u,偏导/nw,数/m,：/w,根据/p,数学/n,知识/n,我们/r,知道/v,，/w,函数/n,的/u,极值/nz,点/q,为/p,偏导/nw,为/p,0/m,的/u,点/q,。/w,解得/nr,：/w,这/r,就/d,是/v,最小二乘法/nw,的/u,解法/n,，/w,就是/d,求得/v,平方/q,损失/n,函数/n,的/u,极值/nz,点/q,。/w,三/m,./w, ,c/en,+/w,+/w,实现/v,代码/n,1/m, ,//w,*/w, ,2/m, ,最小二乘法/nw,c/en,+/w,+/w,实现/v, ,3/m, ,参数/n,1/m,为/p,输入/v,文件/n, ,4/m, ,输入/v, ,：/w, ,x/en, ,5/m, ,输出/v,：/w, ,预测/v,的/u,y/en, ,6/m, ,*/w,//w, ,7/m, ,#,include/en,</w,iostream/en,>, ,8/m, ,#,include/en,</w,fstream/en,>, ,9/m, ,#,include/en,</w,vector/en,>, ,10/m, ,using/en, ,namespace/en, ,std/en,;/w, ,11/m, ,12/m, ,class/en, ,leastsquare/en,{/w, ,13/m, ,double/en, ,a/en,,/w, ,b/en,;/w, ,14/m, ,public/en,:/w, ,15/m, ,leastsquare/en,(/w,const/en, ,vector/en,</w,double/en,>,&/w, ,x/en,,/w, ,const/en, ,vector/en,</w,double/en,>,&/w, ,y/en,)/w, ,16/m, ,{/w, ,17/m, ,double/en, ,t/en,1/m,=/w,0/m,,/w, ,t/en,2/m,=/w,0/m,,/w, ,t/en,3/m,=/w,0/m,,/w, ,t/en,4/m,=/w,0/m,;/w, ,18/m, ,for/en,(/w,int/en, ,i/en,=/w,0/m,;/w, ,i/en,</w,x/en,./w,size/en,(/w,)/w,;/w, ,+/w,+/w,i/en,)/w, ,19/m, ,{/w, ,20/m, ,t/en,1/m, ,+/w,=/w, ,x/en,[/w,i/en,]/w,*/w,x/en,[/w,i/en,]/w,;/w, ,21/m, ,t/en,2/m, ,+/w,=/w, ,x/en,[/w,i/en,]/w,;/w, ,22/m, ,t/en,3/m, ,+/w,=/w, ,x/en,[/w,i/en,]/w,*/w,y/en,[/w,i/en,]/w,;/w, ,23/m, ,t/en,4/m, ,+/w,=/w, ,y/en,[/w,i/en,]/w,;/w, ,24/m, ,}/w, ,25/m, ,a/en, ,=/w, ,(/w,t/en,3/m,*/w,x/en,./w,size/en,(/w,)/w, ,-/w, ,t/en,2/m,*/w,t/en,4/m,)/w, ,//w, ,(/w,t/en,1/m,*/w,x/en,./w,size/en,(/w,)/w, ,-/w, ,t/en,2/m,*/w,t/en,2/m,)/w,;/w, ,//w,//w, ,求得/v,β,1/m, ,26/m, ,b/en, ,=/w, ,(/w,t/en,1/m,*/w,t/en,4/m, ,-/w, ,t/en,2/m,*/w,t/en,3/m,)/w, ,//w, ,(/w,t/en,1/m,*/w,x/en,./w,size/en,(/w,)/w, ,-/w, ,t/en,2/m,*/w,t/en,2/m,)/w,;/w, ,//w,//w, ,求得/v,β,2/m, ,27/m, ,}/w, ,28/m, ,29/m, ,double/en, ,gety/en,(/w,const/en, ,double/en, ,x/en,)/w, ,const/en, ,30/m, ,{/w, ,31/m, ,return/en, ,a/en,*/w,x/en, ,+/w, ,b/en,;/w, ,32/m, ,}/w, ,33/m, ,34/m, ,void/en, ,print/en,(/w,)/w, ,const/en, ,35/m, ,{/w, ,36/m, ,cout/en,</w,</w,"/w,y/en, ,=/w, ,"/w,</w,</w,a/en,</w,</w,"/w,x/en, ,+/w, ,"/w,</w,</w,b/en,</w,</w,"/w,\/w,n/en,"/w,;/w, ,37/m, ,}/w, ,38/m, ,39/m, ,}/w,;/w, ,40/m, ,41/m, ,int/en, ,main/en,(/w,int/en, ,argc/en,,/w, ,char/en, ,*/w,argv/en,[/w,]/w,)/w, ,42/m, ,{/w, ,43/m, ,if/en,(/w,argc/en, ,!/w,=/w, ,2/m,)/w, ,44/m, ,{/w, ,45/m, ,cout/en,</w,</w,"/w,usage/en,:/w, ,datafile/en,./w,txt/en,"/w,</w,</w,endl/en,;/w, ,46/m, ,return/en, ,-/w,1/m,;/w, ,47/m, ,}/w, ,48/m, ,else/en, ,49/m, ,{/w, ,50/m, ,vector/en,</w,double/en,>, ,x/en,;/w, ,51/m, ,ifstream/en, ,in/en,(/w,argv/en,[/w,1/m,]/w,)/w,;/w, ,52/m, ,for/en,(/w,double/en, ,d/en,;/w, ,in/en,>,>,d/en,;/w, ,)/w, ,53/m, ,x/en,./w,push/en,_,back/en,(/w,d/en,)/w,;/w, ,54/m, ,int/en, ,sz/en, ,=/w, ,x/en,./w,size/en,(/w,)/w,;/w, ,55/m, ,vector/en,</w,double/en,>, ,y/en,(/w,x/en,./w,begin/en,(/w,)/w,+/w,sz/en,//w,2/m,,/w, ,x/en,./w,end/en,(/w,)/w,)/w,;/w, ,56/m, ,x/en,./w,resize/en,(/w,sz/en,//w,2/m,)/w,;/w, ,57/m, ,leastsquare/en, ,ls/en,(/w,x/en,,/w, ,y/en,)/w,;/w, ,58/m, ,ls/en,./w,print/en,(/w,)/w,;/w, ,59/m, ,60/m, ,cout/en,</w,</w,"/w,input/en, ,x/en,:/w,\/w,n/en,"/w,;/w, ,61/m, ,double/en, ,x/en,0/m,;/w, ,62/m, ,while/en,(/w,cin/en,>,>,x/en,0/m,)/w, ,63/m, ,{/w, ,64/m, ,cout/en,</w,</w,"/w,y/en, ,=/w, ,"/w,</w,</w,ls/en,./w,gety/en,(/w,x/en,0/m,)/w,</w,</w,endl/en,;/w, ,65/m, ,cout/en,</w,</w,"/w,input/en, ,x/en,:/w,\/w,n/en,"/w,;/w, ,66/m, ,}/w, ,67/m, ,}/w, ,68/m, ,}/w,四/m,./w, ,最小二乘法/nw,与/p,梯度/n,下降/v,法/j,最小二乘法/nw,跟/p,梯度/n,下降/v,法/j,都/d,是/v,通过/p,求导/nw,来/v,求/v,损失/n,函数/n,的/u,最小值/nz,，/w,那/r,它们/r,有/v,什么/r,区别/n,呢/y,。/w,相同/a,1/m,./w,本质/n,相同/a,：/w,两种/mq,方法/n,都/d,是/v,在/p,给/p,定/v,已/d,知/v,数据/n,（/w,independent/en, ,&/w, ,dependent/en, ,variables/en,）/w,的/u,前提/n,下/f,对/p,dependent/en, ,variables/en,算/v,出出/v,一个/m,一般性/n,的/u,估值/v,函数/n,。/w,然后/c,对/p,给/p,定/v,新/a,数据/n,的/u,dependent/en, ,variables/en,进行/v,估算/v,。/w,2/m,./w,目标/n,相同/a,：/w,都/d,是/v,在/p,已知/nz,数据/n,的/u,框架/n,内/f,，/w,使得/v,估算/v,值/n,与/p,实际/n,值/n,的/u,总/b,平方差尽量/nw,更/d,小/a,（/w,事实上/l,未必/d,一定/d,要/v,使用/v,平方/q,）/w,，/w,估算/v,值/n,与/p,实际/n,值/n,的/u,总/b,平方差/n,的/u,公式/n,为/p,：/w,其中/r,为/p,第/m,i/en,组/q,数据/n,的/u,independent/en, ,variable/en,，/w,为/p,第/m,i/en,组/q,数据/n,的/u,dependent/en, ,variable/en,，/w,为/p,系数/n,向量/n,。/w,不同/a,1/m,./w,实现/v,方法/n,和/c,结果/n,不同/a,：/w,最小二乘法/nw,是/v,直接/ad,对/p,求导/nw,找/v,出/v,全局/n,最小/a,，/w,是非/n,迭/d,代/q,法/j,。/w,而/c,梯度/n,下降/v,法/j,是/v,一种/mq,迭/d,代/q,法/j,，/w,先/d,给/p,定/v,一个/m,，/w,然后/c,向/p,下降/v,最/d,快/a,的/u,方向/n,调整/vn,，/w,在/p,若干/m,次/q,迭代/vn,之后/f,找到/v,局部/n,最/d,小/a,。/w,梯度/n,下降/v,法/j,的/u,缺点/n,是/v,到/v,最小点/nw,的/u,时候/n,收敛/vn,速度/n,变/v,慢/a,，/w,并且/c,对/p,初始点/nw,的/u,选择/v,极为/d,敏感/a,，/w,其/r,改进