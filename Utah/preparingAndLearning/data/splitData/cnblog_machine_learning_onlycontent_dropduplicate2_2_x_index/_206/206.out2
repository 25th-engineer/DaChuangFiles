一/m,引言/n,：/w,支持/v,向/p,量机/nw,这/r,部分/n,确实/ad,很多/m,，/w,想/v,要/v,真正/d,的/u,去/v,理解/v,它/r,，/w,不仅仅/d,知道/v,理论/n,，/w,还要/v,进行/v,相关/v,的/u,代码/n,编写/v,和/c,测试/vn,，/w,二者/r,想/v,和/c,结合/v,，/w,才能/v,更/d,好/a,的/u,帮助/v,我们/r,理解/v,svm/en,这/r,一/m,非常/d,优秀/a,的/u,分类/vn,算法/n,支持/v,向/p,量机/nw,是/v,一种/mq,二类/b,分类/vn,算法/n,，/w,假设/v,一个/m,平面/n,可以/v,将/d,所有/b,的/u,样本/n,分为/v,两类/mq,，/w,位于/v,正侧/nw,的/u,样本/n,为/p,一类/b,，/w,值/n,为/p,+/w,1/m,，/w,而/c,位于/v,负/v,一侧/f,的/u,样本/n,为/p,另外/c,一类/b,，/w,值/n,为/p,-/w,1/m,。/w,我们/r,说/v,分类/vn,，/w,不仅仅/d,是/v,将/d,不同/a,的/u,类别/n,样本/n,分隔/v,开/v,，/w,还要/v,以/p,比较/d,大/a,的/u,置信/v,度/q,来/v,分隔/v,这些/r,样本/n,，/w,这样/r,才/d,能/v,使/v,绝大部分/m,样本/n,被/p,分开/v,。/w,比如/v,，/w,我们/r,想/v,通过/p,一个/m,平面/n,将/d,两个/m,类别/n,的/u,样本/n,分开/v,，/w,如果/c,这些/r,样本/n,是/v,线性/n,可/v,分/q,（/w,或者/c,近视线性/nw,可/v,分/q,）/w,，/w,那么/r,这样/r,的/u,平面/n,有/v,很多/m,，/w,但是/c,如果/c,我们/r,加上/v,要/v,以/p,最/d,大/a,的/u,置信/v,度/q,来/v,将/d,这些/r,样本/n,分开/v,，/w,那么/r,这样/r,的/u,平面/n,只/d,有/v,一条/mq,。/w,那么/r,怎么/r,才/d,能/v,找到/v,这样/r,的/u,平面/n,呢/y,？/w,这里/r,不得不/d,提到/v,几/m,个/q,概念/n,1/m, ,几何/n,间隔/n,几何/n,间隔/n,的/u,概念/n,，/w,简单/a,理解/v,就/d,是/v,样本点/nw,到/v,分隔/v,平面/n,的/u,距离/n,2/m, ,间隔/n,最大化/v,想/v,要/v,间隔/n,最大化/v,，/w,我们/r,必须/d,找到/v,距离/n,分隔/v,平面/n,最近/t,的/u,点/q,，/w,并且/c,使得/v,距离/n,平面/n,最近/t,的/u,点/q,尽可能/d,的/u,距离/n,平面/n,最/d,远/a,，/w,这样/r,，/w,每/r,一个/m,样本/n,就/d,都/d,能够/v,以/p,比较/d,大/a,的/u,置信/v,度/q,被/p,分隔/v,开/v,算法/n,的/u,分类/vn,预测/v,能力/n,也/d,就/d,越/d,好/a,显然/ad,，/w,svm/en,算法/n,的/u,关键/n,所在/n,，/w,就是/d,找到/v,使得/v,间隔/n,最大化/v,的/u,分隔/v,超平面/nz,（/w,如果/c,特征/n,是/v,高/a,维度/n,的/u,情况/n,，/w,我们/r,称/v,这样/r,的/u,平面/n,为/p,超平面/nz,）/w,这里/r,关于/p,svm/en,学习/v,，/w,推荐/v,两/m,本书/r,：/w,统计/v,学习/v,方法/n,（/w,李航/nr,）/w,和/c,机器/n,学习/v,实战/n,，/w,二者/r,结合/v,，/w,可以/v,帮助/v,我们/r,理解/v,svm/en,算法/n,2/m, ,支持/v,向/p,量机/nw,关于/p,支持/v,向/p,量机/nw,的/u,推导/vn,，/w,无论/c,是/v,书/n,上/f,还是/c,很多/m,很/d,优秀/a,的/u,博客/n,都/d,写/v,的/u,非常/d,清楚/a,，/w,大家/r,有/v,兴趣/n,可以/v,看/v,上面/f,推荐/v,的/u,统计/v,与/p,学习/v,方法/n,书/n,，/w,写/v,的/u,浅显/a,易懂/a,，/w,或者/c,看/v,这/r,几/m,篇/q,博客/n,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,app/en,_,12062011/m,//w,article/en,//w,details/en,//w,50536369/m,机器/n,学习/v,算法/n,支持/v,向/p,量机/nw,系列/q,博客/n,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,zouxy/en,09/m,//w,article/en,//w,details/en,//w,16955347/m,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,zouxy/en,09/m,//w,article/en,//w,details/en,//w,17291543/m,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,zouxy/en,09/m,//w,article/en,//w,details/en,//w,17291805/m,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,zouxy/en,09/m,//w,article/en,//w,details/en,//w,17292011/m,这/r,两位/mq,博主/nr,都/d,重点/n,讲解/v,了/u,svm/en,的/u,推导/vn,过程/n,。/w,这里/r,我/r,就/d,本着/p,站/v,在/p,巨人/n,的/u,肩膀/n,上/f,的/u,思想/n,，/w,不再/d,赘述/v,，/w,我的/nt,侧重点/n,在于/v,实际/n,的/u,代码/n,编写/v,上/f,，/w,比较/d,理论/n,总/b,归/v,要/v,回到/v,实践/v,上/f,，/w,这/r,也/d,是/v,每个/r,算法/n,的/u,归宿/n,所在/n,。/w,好/a,了/u,，/w,下面/f,我/r,就/d,简要/ad,写/v,出/v,简要/ad,介绍/v,一下/m,，/w,线性/n,支持/v,向量/n,机/ng,，/w,近似线性/nw,支持/v,向/p,量机/nw,以及/c,非线性/b,支持/v,向/p,量机/nw,（/w,核/n,函数/n,）/w,1/m, ,线性/n,支持/v,向/p,量机/nw,求解线性/nw,支持/v,向/p,量机/nw,的/u,过程/n,是/v,凸/ag,二次/mq,规划/n,问题/n,，/w,所谓/v,凸/ag,二次/mq,规划/n,问题/n,，/w,就/d,是/v,目标/n,函数/n,是/v,凸/ag,的/u,二次/mq,可/v,微/ag,函数/n,，/w,约束/vn,函数/n,为/p,仿射/nw,函数/n,（/w,满足/v,f/en,(/w,x/en,)/w,=/w,a/en,*/w,x/en,+/w,b/en,,/w,a/en,,/w,x/en,均/d,为/p,n/en,为/p,向量/n,）/w,。/w,而/c,我们/r,说/v,求解/v,凸/ag,二次/mq,规划/n,问题/n,可以/v,利用/v,对偶/n,算法/n,--/nrf,即/v,引入/v,拉格朗日/nrf,算子/n,，/w,利用/v,拉格朗日/nrf,对/p,偶性/nw,将/d,原始/a,问题/n,的/u,最/d,优解/nw,问题/n,转化/v,为/p,拉格朗日/nrf,对偶/n,问题/n,，/w,这样/r,就/d,将/d,求/v,w/en,*/w,，/w,b/en,的/u,原始/a,问题/n,的/u,极/d,小/a,问题/n,转化/v,为/p,求/v,alpha/en,*/w,（/w,alpha/en,>,=/w,0/m,）/w,的/u,对偶/n,问题/n,的/u,极/d,大/a,问题/n,，/w,即/v,求/v,出/v,alpha/en,*/w,，/w,在/p,通过/p,kkt/en,条件/n,求/v,出/v,对应/v,的/u,参数/n,w/en,*/w,，/w,b/en,，/w,从而/c,找到/v,这样/r,的/u,间隔/n,最大化/v,超平面/nz,，/w,进而/c,利用/v,该/r,平面/n,完成/v,样本/n,分类/vn,2/m, ,近似线性/nw,支持/v,向/p,量机/nw,当/p,数据集/nw,并/c,不/d,是/v,严格/ad,线性/n,可/v,分/q,时/ng,，/w,即/v,满足/v,绝不/d,部分/n,样本点/nw,是/v,线性/n,可/v,分/q,，/w,存在/v,极少部分/nw,异常/a,点/q,；/w,这里/r,也就是说/l,存在/v,部分/n,样本/n,不/d,能/v,满足/v,约束/vn,条件/n,，/w,此时/r,我们/r,可以/v,引入/v,松弛/a,因子/n,，/w,这样/r,这些/r,样本点/nw,到/v,超平面/nz,的/u,函数/n,距离/n,加上/v,松弛/a,因子/n,，/w,就/d,能/v,保证/v,被/p,超平面/nz,分隔/v,开/v,来/v,；/w,当然/d,，/w,添加/vn,了/u,松弛/a,因子/n,sigma/en,，/w,我们/r,也/d,会/v,添加/vn,对应/v,的/u,代价/n,项/q,，/w,使得/v,alpha/en,满足/v,0/m,=/w,</w,alpha/en,</w,=/w,c/en,3/m, ,非线性/b,支持/v,向/p,量机/nw,显然/ad,，/w,当/p,数据集/nw,不/d,是/v,线性/n,可/v,分/q,的/u,，/w,即/v,我们/r,不能/v,通过/p,前面/f,的/u,线性/n,模型/n,来/v,对/p,数据集/nw,进行/v,分类/vn,。/w,此时/r,，/w,我们/r,必须/d,想/v,办法/n,将/d,这些/r,样本/n,特征/n,符合/v,线性/n,模型/n,，/w,才/d,能/v,通过/p,线性/n,模型/n,对/p,这些/r,样本/n,进行/v,分类/vn,。/w,这/r,就要/d,用/p,到/v,核/n,函数/n,，/w,核/n,函数/n,的/u,功能/n,就/d,是/v,将/d,低维/nw,的/u,特征/n,空间/n,映射/v,到/v,高维/nr,的/u,特征/n,空间/n,，/w,而/c,在/p,高维/nr,的/u,特征/n,空间/n,中/f,，/w,这些/r,样本/n,进/v,过/u,转化/v,后/f,，/w,变成/v,了/u,线性/n,可/v,分/q,的/u,情况/n,，/w,这样/r,，/w,在/p,高维/nr,空间/n,中/f,，/w,我们/r,就/d,能够/v,利用/v,线性/n,模型/n,来/v,解决/v,数据集/nw,分类/vn,问题/n,好/a,了/u,，/w,我们/r,就/d,只/d,讲/v,这么/r,写/v,大致/d,的/u,概念/n,，/w,如果/c,想/v,要/v,透彻/a,理解/v,svm/en,建议/n,还是/c,要/v,看看/v,上面/f,的/u,书/n,和/c,博客/n,文章/n,，/w,篇幅/n,有限/a,，/w,我/r,这里/r,的/u,中心/n,在于/v,凸/ag,二次/mq,规划/n,的/u,优化/v,算法/n,--/nrf,smo/en,(/w,序列/n,最/d,小/a,最/d,优化/v,算法/n,)/w,3/m, ,smo/en,算法/n,smo/en,是/v,一种/mq,用于/v,训练/vn,svm/en,的/u,强大/a,算法/n,，/w,它/r,将/d,大/a,的/u,优化/v,问题/n,分解/v,为/p,多/a,个/q,小/a,的/u,优化/v,问题/n,来/v,进行/v,求解/v,。/w,而/c,这些/r,小/a,优化/v,问题/n,往往/d,很/d,容易/a,求解/v,，/w,并且/c,对/p,它们/r,进行/v,顺序/n,求解/v,和/c,对/p,整体/n,求解/v,结果/n,是/v,一致/a,的/u,。/w,在/p,结果/n,一致/a,的/u,情况/n,下/f,，/w,显然/ad,smo/en,算法/n,的/u,求解/v,时间/n,要/v,短/a,很多/m,，/w,这样/r,当/p,数据集/nw,容量/n,很/d,大/a,时/ng,，/w,smo/en,就/d,是/v,一致/a,十分/d,高效/b,的/u,算法/n,smo/en,算法/n,的/u,目标/n,是/v,找到/v,一系列/mq,alpha/en,和/c,b/en,，/w,而/c,求/v,出/v,这些/r,alpha/en,，/w,我们/r,就/d,能/v,求/v,出/v,权重/nz,w/en,，/w,这样/r,就/d,能/v,得到/v,分隔/v,超平面/nz,，/w,从而/c,完成/v,分类/vn,任务/n,smo/en,算法/n,的/u,工作/vn,原理/n,是/v,：/w,每次/r,循环/vn,中/f,选择/v,两个/m,alpha/en,进行/v,优化/v,处理/v,。/w,一旦/d,找到/v,一对/m,合适/a,的/u,alpha/en,，/w,那么/r,就/d,增大/v,其中/r,一个/m,而/c,减少/v,另外/c,一个/m,。/w,这里/r,的/u,"/w,合适/a,"/w,,/w,意味着/v,在/p,选择/v,alpha/en,对/p,时/ng,必须/d,满足/v,一定/d,的/u,条件/n,，/w,条件/n,之一/r,是/v,这/r,两个/m,alpha/en,不/d,满足/v,最/d,优化/v,问题/n,的/u,kkt/en,条件/n,，/w,另外/c,一个/m,条件/n,是/v,这/r,两个/m,alpha/en,还/d,没有/v,进行/v,区间化/nw,处理/v,对于/p,smo/en,算法/n,编写/v,，/w,我们/r,采用/v,由/p,简单/a,到/v,复杂/a,的/u,方法/n,，/w,层层/q,递进/v,，/w,完成/v,最终/d,的/u,smo/en,算法/n,实现/v,，/w,最后/f,通过/p,实际/n,的/u,用例/nw,对/p,svm/en,模型/n,进行/v,训练/vn,，/w,并/c,验证/vn,准确性/n,1/m, ,简化/v,版/n,smo/en,算法/n,简化/v,版/n,smo/en,算法/n,，/w,省略/v,了/u,确定/v,要/v,优化/v,的/u,最佳/z,alpha/en,对/p,的/u,步骤/n,，/w,而是/c,首先/d,在/p,数据集/nw,上/f,进行/v,遍历/nw,每/r,一个/m,alpha/en,，/w,再/d,在/p,剩余/vn,的/u,数据/n,集中/v,找到/v,另外/c,一个/m,alpha/en,，/w,构成/v,要/v,优化/v,的/u,alpha/en,对/p,，/w,同时/c,对/p,其/r,进行/v,优化/v,，/w,这里/r,的/u,同时/c,是/v,要/v,确保/v,公式/n,：/w,Σα/nw,i/en,*/w,label/en,(/w,i/en,)/w,=/w,0/m,。/w,所以/c,改变/v,一个/m,alpha/en,显然/ad,会/v,导致/v,等/u,式/k,失效/v,，/w,所以/c,这里/r,需要/v,同时/c,改变/v,两个/m,alpha/en,。/w,接下来/l,看/v,实际/n,的/u,代码/n,：/w,简易/a,版/n,smo/en,算法/n,的/u,辅助/vn,函数/n,：/w,#,smo/en,算法/n,相关/v,辅助/vn,中/f,的/u,辅助/vn,函数/n, ,#,1/m, ,解析/v,文本/n,数据/n,函数/n,，/w,提取/v,每个/r,样本/n,的/u,特征/n,组成/v,向量/n,，/w,添加/vn,到/v,数据/n,矩阵/n, ,#,添加/vn,样本/n,标签/n,到/v,标签/n,向/p,量/n, ,def/en, ,loaddataset/en,(/w,filename/en,)/w,:/w, ,datamat/en,=/w,[/w,]/w,;/w,labelmat/en,=/w,[/w,]/w, ,fr/en,=/w,open/en,(/w,filename/en,)/w, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,linearr/en,=/w,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w, ,datamat/en,./w,append/en,(/w,[/w,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,labelmat/en,./w,append/en,(/w,(/w,float/en,(/w,)/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,return/en, ,datamat/en,,/w,labelmat/en, ,#,2/m, ,在/p,样本/n,集中/v,采取/v,随机/d,选择/v,的/u,方法/n,选取/v,第二/m,个/q,不/d,等于/v,第一/m,个/q,alphai/en,的/u, ,#,优化/v,向量/n,alphaj/en, ,def/en, ,selectjrand/en,(/w,i/en,,/w,m/en,)/w,:/w, ,j/en,=/w,i/en, ,while/en,(/w,j/en,=/w,=/w,i/en,)/w,:/w, ,j/en,=/w,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,m/en,)/w,)/w, ,return/en, ,j/en, ,#,3/m, ,约束/vn,范围/n,l/en,</w,=/w,alphaj/en,</w,=/w,h/en,内/f,的/u,更新/v,后/f,的/u,alphaj/en,值/n, ,def/en, ,clipalpha/en,(/w,aj/en,,/w,h/en,,/w,l/en,)/w,:/w, ,if/en, ,aj/en,>,h/en,:/w, ,aj/en,=/w,h/en, ,if/en, ,l/en,>,aj/en,：/w, ,aj/en,=/w,l/en, ,return/en, ,aj/en,上面/f,是/v,简易/a,版/n,smo/en,算法/n,需要/v,用/p,到/v,的/u,一些/m,功能/n,，/w,我们/r,将/d,其/r,包装/vn,成/v,函数/n,，/w,需要/v,时/ng,调用/v,即可/v,，/w,接下来/l,看/v,算法/n,的/u,伪代码/nw,：/w,#,smo/en,算法/n,的/u,伪代码/nw, ,#,创建/v,一个/m,alpha/en,向/p,量/n,并/c,将/d,其/r,初始/b,化为/v,0/m,向量/n, ,#,当/p,迭代/vn,次数/n,小于/v,最/d,大/a,迭代/vn,次数/n,时/ng,(/w,w/en,外/f,循环/vn,)/w, ,#,对/p,数据/n,集中/v,每个/r,数据/n,向量/n,(/w,内/f,循环/vn,)/w,:/w, ,#,如果/c,该/r,数据/n,向量/n,可以/v,被/p,优化/v,：/w, ,#,随机/d,选择/v,另外/c,一个/m,数据/n,向量/n, ,#,同时/c,优化/v,这/r,两个/m,向量/n, ,#,如果/c,两个/m,向量/n,都/d,不能/v,被/p,优化/v,，/w,退出/v,内/f,循环/vn,#,如果/c,所有/b,向量/n,都/d,没有/v,被/p,优化/v,，/w,增加/v,迭代/vn,次数/n,，/w,继续/v,下/f,一次/mq,循环/vn,实际/n,代码/n,如下/v,：/w,#,@/w,datamat/en, ,：/w,数据/n,列表/v, ,#,@/w,classlabels/en,：/w,标签/n,列/v,表/n, ,#,@/w,c/en, ,：/w,权衡/v,因子/n,（/w,增加/v,松弛/a,因子/n,而/c,在/p,目标/n,优化/v,函数/n,中/f,引入/v,了/u,惩罚/vn,项/q,）/w, ,#,@/w,toler/en, ,：/w,容错率/nw, ,#,@/w,maxiter/en, ,：/w,最/d,大/a,迭代/vn,次数/n, ,def/en, ,smosimple/en,(/w,datamat/en,,/w,classlabels/en,,/w,c/en,,/w,toler/en,,/w,maxiter/en,)/w,:/w, ,#,将/d,列表/v,形式/n,转为/v,矩阵/n,或/c,向/p,量/n,形式/n, ,datamatrix/en,=/w,mat/en,(/w,datamatin/en,)/w,;/w,labelmat/en,=/w,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w, ,#,初始化/v,b/en,=/w,0/m,，/w,获取/v,矩阵/n,行列/n, ,b/en,=/w,0/m,;/w,m/en,,/w,n/en,=/w,shape/en,(/w,datamatrix/en,)/w, ,#,新建/v,一个/m,m/en,行/v,1列/mq,的/u,向量/n, ,alphas/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,#,迭代/vn,次数/n,为/p,0/m, ,iter/en,=/w,0/m, ,while/en,(/w,iter/en,</w,maxiter/en,)/w,:/w, ,#,改变/v,的/u,alpha/en,对数/n, ,alphapairschanged/en,=/w,0/m, ,#,遍历/nw,样本/n,集中/v,样本/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,计算/v,支持/v,向/p,量机/nw,算法/n,的/u,预测值/n, ,fxi/en,=/w,float/en,(/w,multiply/en,(/w,alphas/en,,/w,labelmat/en,)/w,./w,t/en,*/w,\/w, ,(/w,datamatrix/en,*/w,datamatrix/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,)/w,)/w,+/w,b/en, ,#,计算/v,预测/v,值/n,与/p,实际/n,值/n,的/u,误差/n, ,ei/en,=/w,fxi/en,-/w,float/en,(/w,labelmat/en,[/w,i/en,]/w,)/w, ,#,如果/c,不/d,满足/v,kkt/en,条件/n,，/w,即/v,labelmat/en,[/w,i/en,]/w,*/w,fxi/en,</w,1/m,(/w,labelmat/en,[/w,i/en,]/w,*/w,fxi/en,-/w,1/m,</w,-/w,toler/en,)/w, ,#,and/en, ,alpha/en,</w,c/en, ,或者/c,labelmat/en,[/w,i/en,]/w,*/w,fxi/en,>,1/m,(/w,labelmat/en,[/w,i/en,]/w,*/w,fxi/en,-/w,1/m,>,toler/en,)/w,and/en, ,alpha/en,>,0/m, ,if/en,(/w,(/w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,</w,-/w,toler/en,)/w,and/en,(/w,alpha/en,</w,c/en,)/w,)/w,or/en,\/w, ,(/w,(/w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,>,toler/en,)/w,and/en,(/w,alpha/en,[/w,i/en,]/w,>,0/m,)/w,)/w,)/w,:/w, ,#,随机/d,选择/v,第二/m,个/q,变量/n,alphaj/en, ,j/en,=/w,selectjrand/en,(/w,i/en,,/w,m/en,)/w, ,#,计算/v,第二/m,个/q,变量/n,对应/v,数据/n,的/u,预测值/n, ,fxj/en,=/w,float/en,(/w,multiply/en,(/w,alphas/en,,/w,labelmat/en,)/w,./w,t/en,*/w,\/w, ,(/w,datamatrix/en,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,)/w,./w,t/en,)/w,+/w,b/en, ,#,计算/v,与/p,测试/vn,与/p,实际/n,值/n,的/u,差值/n, ,ej/en,=/w,fxj/en,-/w,float/en,(/w,label/en,[/w,j/en,]/w,)/w, ,#,记录/v,alphai/en,和/c,alphaj/en,的/u,原始值/nw,，/w,便于/v,后续/vn,的/u,比较/d, ,alphaiold/en,=/w,alphas/en,[/w,i/en,]/w,./w,copy/en,(/w,)/w, ,alphajold/en,=/w,alphas/en,[/w,j/en,]/w,./w,copy/en,(/w,)/w, ,#,如何/r,两个/m,alpha/en,对应/v,样本/n,的/u,标签/n,不/d,相同/a, ,if/en,(/w,labelmat/en,[/w,i/en,]/w,!/w,=/w,labelmat/en,[/w,j/en,]/w,)/w,:/w, ,#,求/v,出/v,相应/v,的/u,上下/f,边界/n, ,l/en,=/w,max/en,(/w,0/m,,/w,alphas/en,[/w,j/en,]/w,-/w,alphas/en,[/w,i/en,]/w,)/w, ,h/en,=/w,min/en,(/w,c/en,,/w,c/en,+/w,alphas/en,[/w,j/en,]/w,-/w,alphas/en,[/w,i/en,]/w,)/w, ,else/en,:/w, ,l/en,=/w,max/en,(/w,0/m,,/w,alphas/en,[/w,j/en,]/w,+/w,alphas/en,[/w,i/en,]/w,-/w,c/en,)/w, ,h/en,=/w,min/en,(/w,c/en,,/w,alphas/en,[/w,j/en,]/w,+/w,alphas/en,[/w,i/en,]/w,)/w, ,if/en, ,l/en,=/w,=/w,h/en,:/w,print/en,(/w,"/w,l/en,=/w,=/w,h/en,)/w,;/w,continue/en, ,#,根据/p,公式/n,计算/v,未经/d,剪辑/vn,的/u,alphaj/en, ,#,------------------------------------------/nrf, ,eta/en,=/w,2.0/m,*/w,datamatrix/en,[/w,i/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,datamatrix/en,[/w,i/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,datamatrix/en,[/w,j/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,#,如果/c,eta/en,>,=/w,0/m,,/w,跳出/v,本次/r,循环/vn, ,if/en, ,eta/en,>,=/w,0/m,:/w,print/en,(/w,"/w,eta/en,>,=/w,0/m,"/w,)/w,:/w,continue/en, ,alphas/en,[/w,j/en,]/w,-/w,=/w,labelmat/en,[/w,j/en,]/w,*/w,(/w,ei/en,-/w,ej/en,)/w,//w,eta/en, ,alphas/en,[/w,j/en,]/w,=/w,clipalpha/en,(/w,alphas/en,[/w,j/en,]/w,,/w,h/en,,/w,l/en,)/w, ,#,------------------------------------------/nrf, ,#,如果/c,改变/v,后/f,的/u,alphaj/en,值/n,变化/vn,不/d,大/a,，/w,跳出/v,本次/r,循环/vn, ,if/en,(/w,abs/en,(/w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,</w,0.00001/m,)/w,:/w,print/en,(/w,"/w,j/en, ,not/en, ,moving/en,\/w, ,enough/en,"/w,)/w,;/w,continue/en, ,#,否则/c,，/w,计算/v,相应/v,的/u,alphai/en,值/n, ,alphas/en,[/w,i/en,]/w,+/w,=/w,labelmat/en,[/w,j/en,]/w,*/w,labelmat/en,[/w,i/en,]/w,*/w,(/w,alphajold/en,-/w,alphas/en,[/w,j/en,]/w,)/w, ,#,再/d,分别/d,计算/v,两个/m,alpha/en,情况/n,下/f,对于/p,的/u,b/en,值/n, ,b/en,1/m,=/w,b/en,-/w,ei/en,-/w,labelmat/en,[/w,i/en,]/w,*/w,(/w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,datamatrix/en,[/w,i/en,,/w,:/w,]/w,*/w,datamat/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,labelmat/en,[/w,j/en,]/w,*/w,(/w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,datamatrix/en,[/w,i/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,b/en,2/m,=/w,b/en,-/w,ej/en,-/w,labelmat/en,[/w,i/en,]/w,*/w,(/w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,datamatrix/en,[/w,i/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,labelmat/en,[/w,j/en,]/w,*/w,(/w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,datamatrix/en,[/w,j/en,,/w,:/w,]/w,*/w,datamatrix/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,#,如果/c,0/m,</w,alphai/en,</w,c/en,,/w,那么/r,b/en,=/w,b/en,1/m, ,if/en,(/w,0/m,</w,alphas/en,[/w,i/en,]/w,)/w, ,and/en, ,(/w,c/en,>,alphas/en,[/w,i/en,]/w,)/w,:/w,b/en,=/w,b/en,1/m, ,#,否则/c,如果/c,0/m,</w,alphai/en,</w,c/en,,/w,那么/r,b/en,=/w,b/en,1/m, ,elif/en, ,(/w,0/m,</w,alphas/en,[/w,j/en,]/w,)/w, ,and/en, ,(/w,c/en,>,alphas/en,[/w,j/en,]/w,)/w,:/w,b/en,=/w,b/en,2/m, ,#,否则/c,，/w,alphai/en,，/w,alphaj/en,=/w,0/m,或/c,c/en, ,else/en,:/w,b/en,=/w,(/w,b/en,1/m,+/w,b/en,2/m,)/w,//w,2.0/m, ,#,如果/c,走/v,到/v,此/r,步/q,，/w,表面/n,改变/v,了/u,一对/mq,alpha/en,值/n, ,alphapairschanged/en,+/w,=/w,1/m, ,print/en,(/w,"/w,iter/en,:/w, ,&/w,d/en, ,i/en,:/w,%/w,d/en,,/w,paird/en, ,changed/en, ,%/w,d/en,"/w,,/w,%/w,(/w,iter/en,,/w,i/en,,/w,alphapairschanged/en,)/w,)/w, ,#,最后/f,判断/v,是否/v,有/v,改变/v,的/u,alpha/en,对/p,，/w,没有/v,就/d,进行/v,下/f,一次/mq,迭代/vn, ,if/en,(/w,alphapairschanged/en,=/w,=/w,0/m,)/w,:/w,iter/en,+/w,=/w,1/m, ,#,否则/c,，/w,迭代/vn,次数/n,置/v,0/m,，/w,继续/v,循环/vn, ,else/en,:/w,iter/en,=/w,0/m, ,print/en,(/w,"/w,iteration/en, ,number/en,:/w, ,%/w,d/en,"/w, ,%/w,iter/en,)/w, ,#,返回/v,最后/f,的/u,b/en,值/n,和/c,alpha/en,向量/n, ,return/en, ,b/en,,/w,alphas/en,上面/f,的/u,代码量/nw,看起来/v,很多/m,，/w,但/c,事实上/l,只要/c,理解/v,了/u,svm/en,算法/n,的/u,理论/n,知识/n,，/w,就/d,很/d,容易/a,理解/v,，/w,其/r,只不过/d,是/v,将/d,理论/n,转化/v,为/p,机器/n,可以/v,运行/vn,的/u,语言/n,而已/y,。/w,上面/f,代码/n,在/p,一台/mq,性能/n,一般/a,的/u,笔记本/n,上/f,对/p,100个/m,样本/n,的/u,数据集/nw,上/f,运行/vn,，/w,收敛/vn,时间/n,14.5秒/t,，/w,取得/v,了/u,令/v,人/n,满意/v,的/u,分类/vn,效果/n,当然/d,，/w,上面/f,的/u,代码/n,通过/p,对/p,整个/b,数据集/nw,进行/v,两次/mq,遍历/nw,的/u,方法/n,来/v,寻找/v,alpha/en,对/p,的/u,方法/n,，/w,显然/ad,存在/v,一定/d,的/u,不足/a,，/w,如果/c,数据集/nw,规模/n,较/d,小/a,的/u,情况/n,下/f,，/w,或许/d,还/d,可以/v,满足/v,要求/v,。/w,但是/c,对于/p,大规模/b,的/u,数据集/nw,而言/u,，/w,上面/f,的/u,代码/n,显然/ad,收敛/vn,速度/n,非常/d,慢/a,，/w,所以/c,，/w,接下来/l,我们/r,在/p,此/r,基础/n,上/f,对/p,选取/v,合适/a,的/u,alpha/en,对/p,方法/n,进行/v,改进/v,，/w,采用/v,启发式/nw,的/u,方法/n,来/v,选取/v,合适/a,的/u,alpha/en,对/p,，/w,从而/c,提升/v,运算/vn,效率/n,。/w,2/m, ,启发式/nw,选取/v,alpha/en,变量/n,的/u,smo/en,算法/n,启发式/nw,的/u,smo/en,算法/n,一个/m,外/f,循环/vn,来/v,选择/v,第一/m,个/q,alpha/en,值/n,，/w,并且/c,其/r,选择/v,过程/n,会/v,在/p,下面/f,两种/mq,方法/n,之间/f,进行/v,交替/v,：/w,（/w,1/m,）/w,在/p,所有/b,数据集/nw,上/f,进行/v,单/d,遍/q,扫描/v,（/w,2/m,）/w,另/r,一种/mq,方法/n,是/v,在/p,间隔/n,边界/n,上/f,样本点/nw,进行/v,单/d,遍/q,扫描/v,，/w,所谓/v,间隔/n,边界/n,上/f,的/u,点/q,即/v,为/p,支持/v,向量/n,点/q,。/w,显然/ad,，/w,对于/p,整个/b,数据集/nw,遍历/nw,比较/d,容易/a,，/w,而/c,对于/p,那些/r,处于/v,间隔/n,边界/n,上/f,的/u,点/q,，/w,我们/r,还/d,需要/v,事先/d,将/d,这些/r,点/q,对应/v,的/u,alpha/en,值/n,找/v,出来/v,，/w,存放/v,在/p,一个/m,列表/v,中/f,，/w,然后/c,对/p,列表/v,进行/v,遍历/nw,；/w,此外/c,，/w,在/p,选择/v,第一/m,个/q,alpha/en,值/n,后/f,，/w,算/v,法会/n,通过/p,一个/m,内/f,循环/vn,来/v,选择/v,第二/m,个/q,值/n,，/w,在/p,优化/v,的/u,过程/n,中/f,依据/n,alpha/en,的/u,更新/v,公式/n,α,new/en,,/w,unc/en,=/w,aold/en,+/w,label/en,*/w,(/w,ei/en,-/w,ej/en,)/w,//w,η,，/w,(/w,η,=/w,datamat/en,[/w,i/en,,/w,:/w,]/w,*/w,datamat/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,+/w,datamat/en,[/w,j/en,,/w,:/w,]/w,*/w,datamat/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,-/w,2/m,*/w,datamat/en,[/w,i/en,,/w,:/w,]/w,*/w,datamat/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,)/w,,/w,可知/v,alpha/en,值/n,的/u,变化/vn,程度/n,更/d,ei/en,-/w,ej/en,的/u,差值/n,成/v,正比/n,，/w,所以/c,，/w,为了/p,使/v,alpha/en,有/v,足够/v,大/a,的/u,变化/vn,，/w,选择/v,使/v,ei/en,-/w,ej/en,最/d,大/a,的/u,alpha/en,值/n,作为/v,另外/c,一个/m,alpha/en,。/w,所以/c,，/w,我们/r,还/d,可以/v,建立/v,一个/m,全局/n,的/u,缓存/n,用于/v,保存/v,误差值/nw,，/w,便于/v,我们/r,选择/v,合适/a,的/u,alpha/en,值/n,下面/f,是/v,创建/v,的/u,一个/m,数据/n,结构/n,类/q,，/w,便于/v,我们/r,存取/vn,算法/n,中/f,需要/v,用/p,到/v,的/u,重要/a,数据/n,：/w,#,启发式/nw,smo/en,算法/n,的/u,支持/v,函数/n, ,#,新建/v,一个/m,类/q,的/u,收据/n,结构/n,，/w,保存/v,当前/t,重要/a,的/u,值/n, ,class/en, ,optstruct/en,:/w, ,def/en, ,_,_,init/en,_,_,(/w,self/en,,/w,datamatin/en,,/w,classlabels/en,,/w,c/en,,/w,toler/en,)/w,:/w, ,self/en,./w,x/en,=/w,datamatin/en, ,self/en,./w,labelmat/en,=/w,classlabels/en, ,self/en,./w,c/en,=/w,c/en, ,self/en,./w,tol/en,=/w,toler/en, ,self/en,./w,m/en,=/w,shape/en,(/w,datamatin/en,)/w,[/w,0/m,]/w, ,self/en,./w,alphas/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,self/en,./w,m/en,,/w,1/m,)/w,)/w,)/w, ,self/en,./w,b/en,=/w,0/m, ,self/en,./w,ecache/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,self/en,./w,m/en,,/w,2/m,)/w,)/w,)/w, ,#,格式化/v,计算/v,误差/n,的/u,函数/n,，/w,方便/a,多次/m,调用/v, ,def/en, ,calcek/en,(/w,os/en,,/w,k/en,)/w,:/w, ,fxk/en,=/w,float/en,(/w,multiply/en,(/w,os/en,./w,alphas/en,,/w,os/en,./w,labelmat/en,)/w,./w,t/en,*/w,\/w, ,(/w,os/en,./w,x/en,*/w,os/en,./w,x/en,[/w,k/en,,/w,:/w,]/w,./w,t/en,)/w,)/w,+/w,os/en,./w,b/en, ,ek/en,=/w,fxk/en,-/w,float/en,(/w,os/en,./w,labelmat/en,[/w,k/en,]/w,)/w, ,return/en, ,ek/en, ,#,修改/v,选择/v,第二/m,个/q,变量/n,alphaj/en,的/u,方法/n, ,def/en, ,selectj/en,(/w,i/en,,/w,os/en,,/w,ei/en,)/w,:/w, ,maxk/en,=/w,-/w,1/m,;/w,maxdeltae/en,=/w,-/w,;/w,ej/en,=/w,0/m, ,#,将/d,误差/n,矩阵/n,每/r,一行/n,第一/m,列/v,置/v,1/m,，/w,以此/d,确定/v,出/v,误差/n,不/d,为/p,0/m, ,#,的/u,样本/n, ,os/en,./w,ecache/en,[/w,i/en,]/w,=/w,[/w,1/m,,/w,ei/en,]/w, ,#,获取/v,缓存/n,中/f,ei/en,不为/c,0/m,的/u,样本/n,对应/v,的/u,alpha/en,列表/v, ,validecachelist/en,=/w,nonzero/en,(/w,os/en,./w,cache/en,[/w,:/w,,/w,0/m,]/w,./w,a/en,)/w,[/w,0/m,]/w, ,#,在/p,误差/n,不/d,为/p,0/m,的/u,列表/v,中/f,找/v,出/v,使/v,abs/en,(/w,ei/en,-/w,ej/en,)/w,最/d,大/a,的/u,alphaj/en, ,if/en,(/w,len/en,(/w,validecachelist/en,)/w,>,0/m,)/w,:/w, ,for/en, ,k/en, ,in/en, ,validecachelist/en,:/w, ,if/en, ,k/en, ,=/w,=/w,i/en,:/w,continue/en, ,ek/en,=/w,calcek/en,(/w,os/en,,/w,k/en,)/w, ,deltae/en,=/w,abs/en,(/w,ei/en,-/w,ek/en,)/w, ,if/en,(/w,deltae/en,>,maxdeltae/en,)/w,:/w, ,maxk/en,=/w,k/en,;/w,maxdeltae/en,=/w,deltae/en,;/w,ej/en,=/w,ek/en, ,return/en, ,maxk/en,,/w,ej/en, ,else/en,:/w, ,#,否则/c,，/w,就/d,从/p,样本/n,集中/v,随机/d,选取/v,alphaj/en, ,j/en,=/w,selectjrand/en,(/w,i/en,,/w,os/en,./w,m/en,)/w, ,ej/en,=/w,calcek/en,(/w,os/en,,/w,j/en,)/w, ,return/en, ,j/en,,/w,ej/en, ,#,更新/v,误差/n,矩阵/n, ,def/en, ,updateek/en,(/w,os/en,,/w,k/en,)/w,:/w, ,ek/en,=/w,calcek/en,(/w,os/en,,/w,k/en,)/w, ,os/en,./w,ecache/en,[/w,k/en,]/w,=/w,[/w,1/m,,/w,ek/en,]/w,好/a,了/u,，/w,有/v,了/u,这些/r,辅助性/nw,的/u,函数/n,，/w,我们/r,就/d,可以/v,很/d,容易/a,的/u,实现/v,启发式/nw,的/u,smo/en,算法/n,的/u,具体/a,代码/n,：/w,#,smo/en,外/f,循环/vn,代码/n, ,def/en, ,smop/en,(/w,datamatin/en,,/w,classlabels/en,,/w,c/en,,/w,toler/en,,/w,maxiter/en,,/w,ktup/en,=/w,(/w,'/w,lin/en,'/w,,/w,0/m,)/w,)/w,：/w, ,#,保存/v,关键/n,数据/n, ,os/en,=/w,optstruct/en,(/w,mat/en,(/w,datamatin/en,)/w,,/w,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w,,/w,c/en,,/w,toler/en,)/w, ,iter/en,=/w,0/m, ,enrireset/en,=/w,true/en,;/w,alphapairschanged/en,=/w,0/m, ,#,选取/v,第一/m,个/q,变量/n,alpha/en,的/u,三种/mq,情况/n,，/w,从/p,间隔/n,边界/n,上/f,选取/v,或者/c,整个/b,数据集/nw, ,while/en,(/w,iter/en,</w,maxiter/en,)/w,and/en,(/w,(/w,alphapairschanged/en,>,0/m,)/w,or/en,(/w,entireset/en,)/w,)/w,:/w, ,alphapairschanged/en,=/w,0/m, ,#,没有/v,alpha/en,更新/v,对/p, ,if/en, ,entireset/en,:/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,os/en,./w,m/en,)/w,:/w, ,alphapairschanged/en,+/w,=/w,innerl/en,(/w,i/en,,/w,os/en,)/w, ,print/en,(/w,"/w,fullset/en,,/w,iter/en,:/w, ,%/w,d/en, ,i/en,:/w,%/w,d/en,,/w,pairs/en, ,changed/en, ,%/w,d/en,"/w,,/w,%/w,\/w, ,(/w,iter/en,,/w,i/en,,/w,alphapairschanged/en,)/w,)/w, ,else/en,:/w, ,#,统计/v,alphas/en,向量/n,中/f,满足/v,0/m,</w,alpha/en,</w,c/en,的/u,alpha/en,列表/v, ,nonboundis/en,=/w,nonzero/en,(/w,(/w,os/en,./w,alphas/en,./w,a/en,)/w,>,0/m,)/w,*/w,(/w,os/en,./w,alphas/en,./w,a/en,</w,c/en,)/w,)/w,[/w,0/m,]/w, ,for/en, ,i/en, ,in/en, ,nonboundis/en,:/w, ,alphapairschanged/en,+/w,=/w,innerl/en,(/w,i/en,,/w,os/en,)/w, ,print/en,(/w,"/w,non/en,-/w,bound/en,,/w,iter/en,:/w, ,%/w,d/en, ,i/en,:/w,%/w,d/en,,/w,pairs/en, ,changed/en, ,%/w,d/en,"/w,,/w,%/w,\/w, ,(/w,iter/en,,/w,i/en,,/w,alphapairschanged/en,)/w,)/w, ,iter/en,+/w,=/w,1/m, ,if/en, ,entireset/en,:/w,entireset/en,=/w,false/en, ,#,如果/c,本次/r,循环/vn,没有/v,改变/v,的/u,alpha/en,对/p,，/w,将/d,entireset/en,置/v,为/p,true/en,，/w, ,#,下/f,个/q,循环/vn,仍/d,遍历/nw,数据集/nw, ,elif/en, ,(/w,alphapairschanged/en,=/w,=/w,0/m,)/w,:/w,entireset/en,=/w,true/en, ,print/en,(/w,"/w,iteration/en, ,number/en,:/w, ,%/w,d/en,"/w,,/w,%/w,iter/en,)/w, ,return/en, ,os/en,./w,b/en,,/w,os/en,./w,alphas/en,#,内/f,循环/vn,寻找/v,alphaj/en, ,def/en, ,innerl/en,(/w,i/en,,/w,os/en,)/w,:/w, ,#,计算/v,误差/n, ,ei/en,=/w,calcek/en,(/w,os/en,,/w,i/en,)/w, ,#,违背/v,kkt/en,条件/n, ,if/en,(/w,(/w,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,</w,-/w,os/en,./w,tol/en,)/w,and/en,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,</w,os/en,./w,c/en,)/w,)/w,or/en,\/w, ,(/w,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,>,os/en,./w,tol/en,)/w,and/en,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,>,0/m,)/w,)/w,)/w,:/w, ,j/en,,/w,ej/en,=/w,selectj/en,(/w,i/en,,/w,os/en,,/w,ei/en,)/w, ,alphaiold/en,=/w,alphas/en,[/w,i/en,]/w,./w,copy/en,(/w,)/w,;/w,alphajold/en,=/w,alphas/en,[/w,j/en,]/w,./w,copy/en,(/w,)/w, ,#,计算/v,上下界/nw, ,if/en,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,!/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,)/w,:/w, ,l/en,=/w,max/en,(/w,0/m,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,h/en,=/w,min/en,(/w,os/en,./w,c/en,,/w,os/en,./w,c/en,+/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,else/en,:/w, ,l/en,=/w,max/en,(/w,0/m,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,+/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,os/en,./w,c/en,)/w, ,h/en,=/w,min/en,(/w,os/en,./w,c/en,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,+/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,if/en, ,l/en,=/w,=/w,h/en,:/w,print/en,(/w,"/w,l/en,=/w,=/w,h/en,"/w,)/w,;/w,return/en, ,0/m, ,#,计算/v,两个/m,alpha/en,值/n, ,eta/en,=/w,2.0/m,*/w,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,-/w,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,if/en, ,eta/en,>,=/w,0/m,:/w,print/en,(/w,"/w,eta/en,>,=/w,0/m,"/w,)/w,;/w,return/en, ,0/m, ,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,ei/en,-/w,ej/en,)/w,//w,eta/en, ,os/en,./w,alphas/en,[/w,j/en,]/w,=/w,clipalpha/en,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,,/w,h/en,,/w,l/en,)/w, ,updateek/en,(/w,os/en,,/w,j/en,)/w, ,if/en,(/w,abs/en,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,</w,0.00001/m,)/w,:/w, ,print/en,(/w,"/w,j/en, ,not/en, ,moving/en, ,enough/en,"/w,)/w,;/w,return/en, ,0/m, ,os/en,./w,alphas/en,[/w,i/en,]/w,+/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,\/w, ,(/w,alphajold/en,-/w,os/en,./w,alphas/en,[/w,j/en,]/w,)/w, ,updateek/en,(/w,os/en,,/w,i/en,)/w, ,#,在/p,这/r,两个/m,alpha/en,值/n,情况/n,下/f,，/w,计算/v,对应/v,的/u,b/en,值/n, ,#,注/v,，/w,非线性/b,可/v,分/q,情况/n,，/w,将/d,所有/b,内/f,积项/nw,替换/v,为/p,核/n,函数/n,k/en,[/w,i/en,,/w,j/en,]/w, ,b/en,1/m,=/w,os/en,./w,b/en,-/w,ei/en,-/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,b/en,2/m,=/w,os/en,./w,b/en,-/w,ej/en,-/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,os/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,-/w,\/w, ,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,*/w,os/en,./w,x/en,[/w,j/en,,/w,:/w,]/w,./w,t/en, ,if/en,(/w,0/m,</w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w,and/en, ,(/w,os/en,./w,c/en,>,os/en,./w,alphas/en,[/w,i/en,]/w,)/w,:/w,os/en,./w,b/en,=/w,b/en,1/m, ,elif/en,(/w,0/m,</w,os/en,./w,alphas/en,[/w,j/en,]/w,)/w,and/en, ,(/w,os/en,./w,c/en,>,os/en,./w,alphas/en,[/w,j/en,]/w,)/w,:/w,os/en,./w,b/en,=/w,b/en,2/m, ,else/en,:/w,os/en,./w,b/en,=/w,(/w,b/en,1/m,+/w,b/en,2/m,)/w,//w,2.0/m, ,#,如果/c,有/v,alpha/en,对/p,更新/v, ,return/en, ,1/m, ,#,否则/c,返回/v,0/m, ,else/en, ,return/en, ,0/m,显然/ad,，/w,上面/f,的/u,smo/en,完整/a,代码/n,是/v,分为/v,内外/f,两个/m,循环/vn,函数/n,来/v,编写/v,的/u,，/w,采取/v,这样/r,的/u,结构/n,可以/v,更/d,方便/a,我们/r,去/v,理解/v,选取/v,两个/m,alpha/en,的/u,过程/n,；/w,既然/c,，/w,我们/r,已经/d,计算/v,出/v,了/u,alpha/en,值/n,和/c,b/en,值/n,，/w,那么/r,显然/ad,我们/r,可以/v,利用/v,公式/n,w/en,*/w,=/w,Σα/nw,i/en,*/w,label/en,[/w,i/en,]/w,*/w,datamat/en,[/w,i/en,,/w,:/w,]/w,计算/v,出/v,相应/v,的/u,权值/nw,参数/n,，/w,然后/c,就/d,可以/v,得到/v,间隔/n,超平面/nz,的/u,公式/n,w/en,*/w,x/en,+/w,b/en,*/w,来/v,完成/v,样本/n,的/u,分类/vn,了/u,，/w,由于/c,svm/en,算法/n,是/v,一种/mq,二类/b,分类/vn,算法/n,，/w,正值/v,为/p,1/m,，/w,负值/n,为/p,-/w,1/m,，/w,即/v,分类/vn,的/u,决策/n,函数/n,为/p,跳跃/v,函数/n,sign/en,（/w,w/en,*/w,x/en,+/w,b/en,*/w,）/w,然后/c,，/w,我们/r,可以/v,编写/v,一/m,小/a,段/q,测试/vn,代码/n,，/w,来/v,利用/v,smo/en,算法/n,得到/v,的/u,alpha/en,值/n,和/c,b/en,值/n,，/w,计算/v,分类/vn,决策/n,函数/n,，/w,从而/c,实现/v,具体/a,的/u,预测/v,分类/vn,了/u,#,求/v,出/v,了/u,alpha/en,值/n,和/c,对应/v,的/u,b/en,值/n,，/w,就/d,可以/v,求/v,出/v,对应/v,的/u,w/en,值/n,，/w,以及/c,分类/vn,函数/n,值/n, ,def/en, ,predict/en,(/w,alphas/en,,/w,dataarr/en,,/w,classlabels/en,)/w,:/w, ,x/en,=/w,mat/en,(/w,dataarr/en,)/w,;/w,labelmat/en,=/w,mat/en,(/w,classlabels/en,)/w, ,m/en,,/w,n/en,=/w,shape/en,(/w,x/en,)/w, ,w/en,=/w,zeros/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,w/en,+/w,=/w,multiply/en,(/w,alphas/en,[/w,i/en,]/w,*/w,labelmat/en,[/w,i/en,]/w,,/w,x/en,[/w,i/en,,/w,:/w,]/w,./w,t/en,)/w, ,result/en,=/w,dataarr/en,[/w,0/m,]/w,*/w,mat/en,(/w,ws/en,)/w,+/w,b/en, ,return/en, ,sign/en,(/w,result/en,)/w,看/v,一下/m,分类/vn,效果/n,：/w,3/m, ,核/n,函数/n,核/n,函数/n,的/u,目的/n,主要/b,是/v,为了/p,解决/v,非线性/b,分类/vn,问题/n,，/w,通过/p,核/n,技巧/n,将/d,低维/nw,的/u,非线性/b,特征/n,转化/v,为/p,高维/nr,的/u,线性/n,特征/n,，/w,从而/c,可以/v,通过/p,线性/n,模型/n,来/v,解决/v,非线性/b,的/u,分类/vn,问题/n,。/w,如/v,下/f,图/n,，/w,当/p,数据集/nw,不/d,是/v,线性/n,可/v,分/q,时/ng,，/w,即/v,数据集/nw,分布/v,是/v,下面/f,的/u,圆形/n,该/r,怎么办/v,呢/y,？/w,显然/ad,，/w,此时/r,数据集线性/nw,不可分/nw,，/w,我们/r,无法/v,用/p,一个/m,超平面/nz,来/v,将/d,两种/mq,样本/n,分隔/v,开/v,；/w,那么/r,我们/r,就/d,希望/v,将/d,这些/r,数据/n,进行/v,转化/v,，/w,转化/v,之后/f,的/u,数据/n,就/d,能够/v,通过/p,一个/m,线性/n,超平面/nz,将/d,不同/a,类别/n,的/u,样本/n,分开/v,，/w,这/r,就/d,需要/v,核/n,函数/n,，/w,核/n,函数/n,的/u,目的/n,主要/b,是/v,为了/p,解决/v,非线性/b,分类/vn,问题/n,，/w,通过/p,核/n,技巧/n,将/d,低维/nw,的/u,非线性/b,特征/n,转化/v,为/p,高维/nr,的/u,线性/n,特征/n,，/w,从而/c,可以/v,通过/p,线性/n,模型/n,来/v,解决/v,非线性/b,的/u,分类/vn,问题/n,。/w,而/c,径/ng,向/p,基核/nr,函数/n,，/w,是/v,svm/en,中/f,常用/a,的/u,一个/m,核/n,函数/n,。/w,径/ng,向/p,基核/nr,函数/n,是/v,一个/m,采用/v,向/p,量/n,作为/v,自/p,变量/n,的/u,函数/n,，/w,能够/v,基于/p,向量/n,距离/n,运算/vn,输出/v,一个/m,标量/n,。/w,径/ng,向/p,基核/nr,函数/n,的/u,高斯/nr,版本/n,公式/n,为/p,：/w,k/en,(/w,x/en,，/w,y/en,)/w,=/w,exp/en,(/w,-/w,|/w,|/w,x/en,-/w,y/en,|/w,|/w,2/m,//w,2/m,σ,2/m,)/w,,/w,其中/r,，/w,σ,为/p,到达/v,率/v,，/w,决定/v,了/u,函数/n,值/n,跌落/v,至/p,0/m,的/u,速度/n,下面/f,通过/p,代码/n,编写/v,高斯/nr,核/n,函数/n,：/w,#,径向/n,基核/nr,函数/n,是/v,svm/en,常用/a,的/u,核函/nw,数/m, ,#,核/n,转换/v,函数/n, ,def/en, ,kerneltrans/en,(/w,x/en,,/w,a/en,,/w,ktup/en,)/w,:/w, ,m/en,,/w,n/en,=/w,shape/en,(/w,x/en,)/w, ,k/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,m/en,,/w,1/m,)/w,)/w,)/w, ,#,如果/c,核/n,函数/n,类型/n,为/p,'/w,lin/en,'/w, ,if/en, ,ktup/en,[/w,0/m,]/w,=/w,=/w,'/w,lin/en,'/w,:/w,k/en,=/w,x/en,*/w,a/en,./w,t/en, ,#,如果/c,核/n,函数/n,类型/n,为/p,'/w,rbf/en,'/w,:/w,径向/n,基核/nr,函数/n, ,#,将/d,每个/r,样本/n,向量/n,利用/v,核/n,函数/n,转为/v,高维/nr,空间/n, ,elif/en, ,ktup/en,[/w,0/m,]/w,=/w,=/w,'/w,rbf/en,'/w, ,for/en, ,j/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,deltarow/en,=/w,x/en,[/w,j/en,,/w,:/w,]/w,-/w,a/en, ,k/en,[/w,j/en,]/w,=/w,deltarow/en,*/w,deltarow/en,./w,t/en, ,k/en,=/w,exp/en,(/w,k/en,//w,(/w,-/w,1/m,*/w,ktup/en,[/w,1/m,]/w,*/w,*/w,2/m,)/w,)/w, ,else/en,：/w,raise/en, ,nameerror/en,(/w,'/w,houston/en, ,we/en, ,have/en, ,a/en, ,problem/en, ,--/nrf, ,\/w, ,that/en, ,kernel/en, ,is/en, ,not/en, ,recognised/en,'/w,)/w, ,return/en, ,k/en, ,#,对/p,核/n,函数/n,处理/v,的/u,样本/n,特征/n,，/w,存入/v,到/v,optstruct/en,中/f, ,class/en, ,optstruct/en,：/w, ,def/en, ,_,_,init/en,_,_,(/w,self/en,,/w,datamatin/en,,/w,classlabels/en,,/w,c/en,,/w,toler/en,,/w,ktup/en,)/w,:/w, ,self/en,./w,x/en,=/w,datamatin/en, ,self/en,./w,labelmat/en,=/w,classlabels/en, ,self/en,./w,c/en,=/w,c/en, ,self/en,./w,tol/en,=/w,toler/en, ,self/en,./w,m/en,=/w,shape/en,(/w,datamatin/en,)/w,[/w,0/m,]/w, ,self/en,./w,alphas/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,self/en,./w,m/en,,/w,1/m,)/w,)/w,)/w, ,self/en,./w,b/en,=/w,0/m, ,self/en,./w,ecache/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,self/en,./w,m/en,,/w,2/m,)/w,)/w,)/w, ,self/en,./w,k/en,=/w,mat/en,(/w,zeros/en,(/w,(/w,self/en,./w,m/en,,/w,self/en,./w,m/en,)/w,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,self/en,./w,m/en,)/w,:/w, ,self/en,./w,k/en,[/w,:/w,,/w,i/en,]/w,=/w,kerneltrans/en,(/w,self/en,./w,x/en,,/w,self/en,./w,x/en,[/w,i/en,,/w,:/w,]/w,,/w,ktup/en,)/w,需要/v,说明/v,的/u,是/v,，/w,这里/r,引入/v,了/u,一个/m,变量/n,ktup/en,,/w,ktup/en,是/v,一个/m,包含/v,核/n,信息/n,的/u,元组/nw,，/w,它/r,提供/v,了/u,选取/v,的/u,核/n,函数/n,的/u,类型/n,，/w,比如线性/nw,'/w,lin/en,'/w,或者/c,径向/n,基核/nr,函数/n,'/w,rbf/en,'/w,;/w,以及/c,用户/n,提供/v,的/u,到达/v,率/v,σ,有/v,了/u,高斯/nr,核/n,函数/n,之后/f,，/w,我们/r,只要/c,将/d,上面/f,的/u,smo/en,算法/n,中/f,所有/b,的/u,内积/n,项/q,替换/v,为/p,核/n,函数/n,即可/v,，/w,比如/v,讲/v,datamat/en,[/w,i/en,,/w,:/w,]/w,*/w,datamat/en,[/w,j/en,,/w,:/w,]/w,./w,t/en,替换/v,为/p,k/en,[/w,i/en,,/w,j/en,]/w,即可/v,，/w,替换/v,效果/n,如下/v,：/w,def/en, ,innerl/en,(/w,i/en,,/w,os/en,)/w,:/w, ,#,计算/v,误差/n, ,ei/en,=/w,calcek/en,(/w,os/en,,/w,i/en,)/w, ,#,违背/v,kkt/en,条件/n, ,if/en,(/w,(/w,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,</w,-/w,os/en,./w,tol/en,)/w,and/en,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,</w,os/en,./w,c/en,)/w,)/w,or/en,\/w, ,(/w,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,ei/en,>,os/en,./w,tol/en,)/w,and/en,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,>,0/m,)/w,)/w,)/w,:/w, ,j/en,,/w,ej/en,=/w,selectj/en,(/w,i/en,,/w,os/en,,/w,ei/en,)/w, ,alphaiold/en,=/w,alphas/en,[/w,i/en,]/w,./w,copy/en,(/w,)/w,;/w,alphajold/en,=/w,alphas/en,[/w,j/en,]/w,./w,copy/en,(/w,)/w, ,#,计算/v,上下界/nw, ,if/en,(/w,os/en,./w,labelmat/en,[/w,i/en,]/w,!/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,)/w,:/w, ,l/en,=/w,max/en,(/w,0/m,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,h/en,=/w,min/en,(/w,os/en,./w,c/en,,/w,os/en,./w,c/en,+/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,else/en,:/w, ,l/en,=/w,max/en,(/w,0/m,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,+/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,os/en,./w,c/en,)/w, ,h/en,=/w,min/en,(/w,os/en,./w,c/en,,/w,os/en,./w,alphas/en,[/w,j/en,]/w,+/w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w, ,if/en, ,l/en,=/w,=/w,h/en,:/w,print/en,(/w,"/w,l/en,=/w,=/w,h/en,"/w,)/w,;/w,return/en, ,0/m, ,#,计算/v,两个/m,alpha/en,值/n, ,eta/en,=/w,2.0/m,*/w,os/en,./w,k/en,[/w,i/en,,/w,j/en,]/w,-/w,os/en,./w,k/en,[/w,i/en,,/w,i/en,]/w,-/w,os/en,./w,k/en,[/w,j/en,,/w,j/en,]/w, ,if/en, ,eta/en,>,=/w,0/m,:/w,print/en,(/w,"/w,eta/en,>,=/w,0/m,"/w,)/w,;/w,return/en, ,0/m, ,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,ei/en,-/w,ej/en,)/w,//w,eta/en, ,os/en,./w,alphas/en,[/w,j/en,]/w,=/w,clipalpha/en,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,,/w,h/en,,/w,l/en,)/w, ,updateek/en,(/w,os/en,,/w,j/en,)/w, ,if/en,(/w,abs/en,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,</w,0.00001/m,)/w,:/w, ,print/en,(/w,"/w,j/en, ,not/en, ,moving/en, ,enough/en,"/w,)/w,;/w,return/en, ,0/m, ,os/en,./w,alphas/en,[/w,i/en,]/w,+/w,=/w,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,\/w, ,(/w,alphajold/en,-/w,os/en,./w,alphas/en,[/w,j/en,]/w,)/w, ,updateek/en,(/w,os/en,,/w,i/en,)/w, ,#,在/p,这/r,两个/m,alpha/en,值/n,情况/n,下/f,，/w,计算/v,对应/v,的/u,b/en,值/n, ,#,注/v,，/w,非线性/b,可/v,分/q,情况/n,，/w,将/d,所有/b,内/f,积项/nw,替换/v,为/p,核/n,函数/n,k/en,[/w,i/en,,/w,j/en,]/w, ,b/en,1/m,=/w,os/en,./w,b/en,-/w,ei/en,-/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,os/en,./w,k/en,[/w,i/en,,/w,i/en,]/w,-/w,\/w, ,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,os/en,./w,k/en,[/w,i/en,,/w,j/en,]/w, ,b/en,2/m,=/w,os/en,./w,b/en,-/w,ej/en,-/w,os/en,./w,labelmat/en,[/w,i/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,i/en,]/w,-/w,alphaiold/en,)/w,*/w,\/w, ,os/en,./w,k/en,[/w,i/en,,/w,j/en,]/w,-/w,\/w, ,os/en,./w,labelmat/en,[/w,j/en,]/w,*/w,(/w,os/en,./w,alphas/en,[/w,j/en,]/w,-/w,alphajold/en,)/w,*/w,\/w, ,os/en,./w,k/en,[/w,i/en,,/w,j/en,]/w, ,if/en,(/w,0/m,</w,os/en,./w,alphas/en,[/w,i/en,]/w,)/w,and/en, ,(/w,os/en,./w,c/en,>,os/en,./w,alphas/en,[/w,i/en,]/w,)/w,:/w,os/en,./w,b/en,=/w,b/en,1/m, ,elif/en,(/w,0/m,</w,os/en,./w,alphas/en,[/w,j/en,]/w,)/w,and/en, ,(/w,os/en,./w,c/en,>,os/en,./w,alphas/en,[/w,j/en,]/w,)/w,:/w,os/en,./w,b/en,=/w,b/en,2/m, ,else/en,:/w,os/en,./w,b/en,=/w,(/w,b/en,1/m,+/w,b/en,2/m,)/w,//w,2.0/m, ,#,如果/c,有/v,alpha/en,对/p,更新/v, ,return/en, ,1/m, ,#,否则/c,返回/v,0/m, ,else/en, ,return/en, ,0/m,有/v,了/u,核/n,函数/n,，/w,我们/r,就/d,能/v,对/p,非线性/b,的/u,数据集/nw,进行/v,分类/vn,预测/v,了/u,，/w,接下来/l,就/d,是/v,编写/v,代码/n,利用/v,核函/nw,数/m,进行/v,测试/vn,，/w,需要/v,说明/v,的/u,是/v,，/w,在/p,优化/v,的/u,过程/n,中/f,，/w,我们/r,仅仅/d,需要/v,找到/v,支持/v,向量/n,和/c,其/r,对应/v,的/u,alpha/en,值/n,，/w,而/c,对于/p,其他/r,的/u,样本值/nw,可以/v,不用/d,管/v,，/w,甚至/d,可以/v,舍弃/v,，/w,因为/c,这些/r,样本/n,将/d,不/d,会/v,对/p,分类/vn,预测/v,函数/n,造成/v,任何/r,影响/vn,。/w,这/r,也/d,就/d,是/v,svm/en,相比/v,knn/en,算法/n,的/u,优秀/a,的/u,地方/n,所/u,在/p,#,测试/vn,核/n,函数/n, ,#,用户/n,指定/v,到达/v,率/v, ,def/en, ,testrbf/en,(/w,k/en,1/m,=/w,1.3/m,)/w,:/w, ,#,第一/m,个/q,测试/vn,集/vg, ,dataarr/en,,/w,labelarr/en,=/w,loaddataset/en,(/w,'/w,testsetrbf/en,./w,txt/en,'/w,)/w, ,b/en,,/w,alphas/en,=/w,smop/en,(/w,dataarr/en,,/w,labelarr/en,,/w,200/m,,/w,0.0001/m,,/w,10000/m,,/w,(/w,'/w,rbf/en,'/w,,/w,k/en,1/m,)/w,)/w, ,datamat/en,=/w,mat/en,(/w,dataarr/en,)/w,;/w,labelmat/en,=/w,mat/en,(/w,labelarr/en,)/w,./w,transpose/en,(/w,)/w, ,svind/en,=/w,nonzero/en,(/w,alphas/en,./w,a/en,>,0/m,)/w,[/w,0/m,]/w, ,svs/en,=/w,datamat/en,[/w,svind/en,]/w, ,labelsv/en,=/w,labelmat/en,[/w,svind/en,]/w, ,print/en,(/w,"/w,there/en, ,are/en, ,%/w,d/en, ,support/en, ,vectors/en,"/w,,/w,%/w,shape/en,(/w,svs/en,)/w,[/w,0/m,]/w,)/w, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamat/en,)/w, ,errorcount/en,=/w,0/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,kerneleval/en,=/w,kerneltrans/en,(/w,svs/en,,/w,datamat/en,[/w,i/en,,/w,:/w,]/w,,/w,(/w,'/w,rbf/en,'/w,,/w,k/en,1/m,)/w,)/w, ,predict/en,=/w,kerneleval/en,./w,t/en,*/w,multiply/en,(/w,labelsv/en,,/w,alphas/en,[/w,svind/en,]/w,)/w,+/w,b/en, ,if/en, ,sign/en,(/w,predict/en,)/w,!/w,=/w,sign/en,(/w,labelarr/en,[/w,i/en,]/w,)/w,:/w,errorcount/en,+/w,=/w,1/m, ,print/en,(/w,"/w,the/en, ,training/en, ,error/en, ,rate/en, ,is/en,:/w, ,%/w,f/en,"/w,,/w,%/w,(/w,float/en,(/w,errorcount/en,)/w,//w,m/en,)/w,)/w, ,#,第二/m,个/q,测试/vn,集/vg, ,dataarr/en,,/w,labelarr/en,=/w,loaddataset/en,(/w,'/w,testsetrbf/en,2/m,./w,txt/en,'/w,)/w, ,datamat/en,=/w,mat/en,(/w,dataarr/en,)/w,;/w,labelmat/en,=/w,mat/en,(/w,labelarr/en,)/w,./w,transpose/en,(/w,)/w, ,errorcount/en,=/w,0/m, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamat/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,kerneleval/en,=/w,kerneltrans/en,(/w,svs/en,,/w,datamat/en,[/w,i/en,,/w,:/w,]/w,,/w,(/w,'/w,rbf/en,'/w,,/w,k/en,1/m,)/w,)/w, ,predict/en,=/w,kerneleval/en,./w,t/en,*/w,multiply/en,(/w,labelsv/en,,/w,alphas/en,[/w,svind/en,]/w,)/w,+/w,b/en, ,if/en, ,sign/en,(/w,predict/en,)/w,!/w,=/w,sign/en,(/w,labelarr/en,[/w,i/en,]/w,)/w,:/w,errorcount/en,+/w,=/w,1/m, ,print/en,(/w,"/w,the/en, ,training/en, ,error/en, ,rate/en, ,is/en,:/w, ,%/w,f/en,"/w,,/w,%/w,(/w,float/en,(/w,errorcount/en,)/w,//w,m/en,)/w,)/w,当/p,用户/n,输入/v,σ,=/w,1.3时/t,的/u,实验/vn,结果/n,为/p,：/w,当/p,σ,=/w,0.1时/t,实验/vn,结果/n,为/p,：/w,通过/p,输入/v,不同/a,的/u,σ值/nw,（/w,当然/d,，/w,迭代/vn,次数/n,也/d,会/v,有/v,一定/d,的/u,影响/vn,，/w,我们/r,只/d,讨论/v,σ值/nw,）/w,，/w,我们/r,发现/v,测试/vn,错误/n,率/v,，/w,训练/vn,误差率/n,，/w,支持/v,向/p,量/n,个/q,数/m,都/d,会/v,发生/v,变化/vn,，/w,在/p,一定/d,的/u,范围/n,内/f,，/w,支持/v,向/p,量/n,数目/n,的/u,下降/v,，/w,会/v,使得/v,训练/vn,错误/n,率/v,和/c,测试/vn,错误/n,率/v,都/d,下降/v,，/w,但是/c,当/p,抵达/v,某/r,处/n,的/u,最优/ad,值/n,时/ng,，/w,再次/d,通过/p,增大/v,σ值/nw,的/u,方法/n,减少/v,支持/v,向量/n,，/w,此时/r,训练/vn,错误/n,率/v,下降/v,，/w,而/c,测试/vn,误差/n,上升/v,简言之/l,，/w,对于/p,固定/a,的/u,数据集/nw,，/w,支持/v,向量/n,的/u,数目/n,存在/v,一个/m,最优/ad,值/n,，/w,如果/c,支持/v,向/p,量/n,太/d,少/a,，/w,会/v,得到/v,一个/m,很/d,差/a,的/u,决策/n,边界/n,；/w,而/c,支持/v,向/p,量/n,太/d,多/a,，/w,也/d,相当/d,于/p,利用/v,整个/b,数据集/nw,进行/v,分类/vn,，/w,就/d,类似/v,于/p,knn/en,算法/n,，/w,显然/ad,运算/vn,速度/n,不/d,高/a,。/w,三/m,，/w,svm/en,实例/n,：/w,手写/v,识别/v,问题/n,相/d,较/d,于/p,第二/m,张/q,的/u,knn/en,算法/n,，/w,尽管/c,knn/en,也/d,能/v,取得/v,不错/a,的/u,效果/n,；/w,但是/c,从/p,节省/v,内存/n,的/u,角度/n,出发/v,，/w,显然/ad,svm/en,算法/n,更胜一筹/i,，/w,因为/c,其/r,不/d,需要/v,保存/v,真/d,个/q,数据集/nw,，/w,而/c,只/d,需要/v,其/r,作用/n,的/u,支持/v,向量/n,点/q,，/w,而/c,取得/v,不错/a,的/u,分类/vn,效果/n,。/w,#,实例/n,：/w,手写/v,识别/v,问题/n, ,#,支持/v,向/p,量机/nw,由于/c,只/d,需要/v,保存/v,支持/v,向量/n,，/w,所以/c,相对于/nw,knn/en,保存/v,整个/b,数据集/nw,占用/v,更/d,少/a,内/f,存/v, ,#,且/c,取得/v,可比/vn,的/u,效果/n, ,#,基于/p,svm/en,的/u,手写/v,数字/n,识别/v, ,def/en, ,loadimages/en,(/w,dirname/en,)/w,:/w, ,from/en, ,os/en, ,import/en, ,listdir/en, ,hwlabels/en,=/w,[/w,]/w, ,trainingfilelist/en,=/w,listdir/en,(/w,dirname/en,)/w, ,m/en,=/w,len/en,(/w,trainingfilelist/en,)/w, ,trainingmat/en,=/w,zeros/en,(/w,(/w,m/en,,/w,1024/m,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,filenamestr/en,=/w,trainingfilelist/en,[/w,i/en,]/w, ,filestr/en,=/w,filenamestr/en,./w,split/en,(/w,'/w,./w,'/w,)/w,[/w,0/m,]/w, ,classnumstr/en,=/w,int/en,(/w,filestr/en,./w,split/en,(/w,'/w,_,'/w,)/w,[/w,0/m,]/w,)/w, ,if/en, ,classnumstr/en,=/w,=/w,9/m,:/w,hwlabels/en,./w,append/en,(/w,-/w,1/m,)/w, ,else/en,:/w,hwlabels/en,./w,append/en,(/w,1/m,)/w, ,trainingmat/en,[/w,i/en,,/w,:/w,]/w,=/w,img/en,2/m,vector/en,(/w,'/w,%/w,s/en,//w,%/w,s/en,'/w,,/w,%/w,(/w,dirname/en,,/w,filenamestr/en,)/w,)/w, ,return/en, ,hwlabels/en,,/w,trainingmat/en, ,#,将/d,图像/n,转为/v,向/p,量/n, ,def/en, ,img/en,2/m,vector/en,(/w,fileaddir/en,)/w,:/w, ,featvec/en,=/w,zeros/en,(/w,(/w,1/m,,/w,1024/m,)/w,)/w, ,fr/en,=/w,open/en,(/w,filename/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,32/m,)/w,:/w, ,linestr/en,=/w,fr/en,./w,readline/en,(/w,)/w, ,for/en, ,j/en, ,in/en, ,range/en,(/w,32/m,)/w,:/w, ,featvec/en,[/w,0/m,,/w,32/m,*/w,i/en,+/w,j/en,]/w,=/w,int/en,(/w,linestr/en,[/w,j/en,]/w,)/w, ,return/en, ,featvec/en, ,#,利用/v,svm/en,测试/vn,数字/n, ,def/en, ,testdigits/en,(/w,ktup/en,=/w,(/w,'/w,rbf/en,'/w,,/w,10/m,)/w,)/w,:/w, ,#,训练/vn,集/vg, ,dataarr/en,,/w,labelarr/en,=/w,loaddataset/en,(/w,'/w,trainingdigits/en,'/w,)/w, ,b/en,,/w,alphas/en,=/w,smop/en,(/w,dataarr/en,,/w,labelarr/en,,/w,200/m,,/w,0.0001/m,,/w,10000/m,,/w,ktup/en,)/w, ,datamat/en,=/w,mat/en,(/w,dataarr/en,)/w,;/w,labelmat/en,=/w,mat/en,(/w,labelarr/en,)/w,./w,transpose/en,(/w,)/w, ,svind/en,=/w,nonzero/en,(/w,alphas/en,./w,a/en,>,0/m,)/w,[/w,0/m,]/w, ,svs/en,=/w,datamat/en,[/w,svind/en,]/w, ,labelsv/en,=/w,labelmat/en,[/w,svind/en,]/w, ,print/en,(/w,"/w,there/en, ,are/en, ,%/w,d/en, ,support/en, ,vectors/en,"/w,,/w,%/w,shape/en,(/w,svs/en,)/w,[/w,0/m,]/w,)/w, ,m/en,,/w,n/en,=/w,shape/en,(/w,datamat/en,)/w, ,errorcount/en,=/w,0/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,kerneleval/en,=/w,kerneltrans/en,(/w,svs/en,,/w,datamat/en,[/w,i/en,,/w,:/w,]/w,,/w,ktup/en,)/w, ,predict/en,=/w,kerneleval/en,./w,t/en,*/w,multiply/en,(/w,labelsv/en,,/w,alphas/en,[/w,svind/en,]/w,)/w,+/w,b/en, ,if/en, ,sign/en,(/w,predict/en,)/w,!/w,=/w,sign/en,(/w,labelarr/en,[/w,i/en,]/w,)/w,:/w,errorcount/en,+/w,=/w,1/m, ,print/en,(/w,"/w,the/en, ,training/en, ,error/en, ,rate/en, ,is/en,:/w, ,%/w,f/en,"/w,,/w,%/w,(/w,float/en,(/w,errorcount/en,)/w,//w,m/en,)/w,)/w, ,#,测试/vn,集/vg, ,dataarr/en,,/w,labelarr/en,=/w,loadd