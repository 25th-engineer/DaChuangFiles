一/m,，/w,引言/n,前面/f,讲/v,到/v,的/u,基本/a,都/d,是/v,分类/vn,问题/n,，/w,分类/vn,问题/n,的/u,目标/n,变量/n,是/v,标称型/nw,数据/n,，/w,或者/c,离散型/nw,数据/n,。/w,而/c,回归/v,的/u,目标/n,变量/n,为/p,连续型/nw,，/w,也/d,即/v,是/v,回归/v,对/p,连续型/nw,变量/n,做出/v,预测/v,，/w,最/d,直接/ad,的/u,办法/n,是/v,依据/n,输入/v,写/v,出/v,一个/m,目标值/n,的/u,计算/v,公式/n,，/w,这样/r,，/w,对于/p,给/p,定/v,的/u,输入/v,，/w,利用/v,该/r,公式/n,可以/v,计算/v,出/v,相应/v,的/u,预测/v,输出/v,。/w,这个/r,公式/n,称为/v,回归/v,方程/n,，/w,而/c,求/v,回归/v,方程/n,显然/ad,就/d,是/v,求/v,该/r,方程/n,的/u,回归/v,系数/n,，/w,而/c,一旦/d,有/v,了/u,这些/r,回归/v,系数/n,，/w,再/d,给/p,定/v,输入/v,，/w,就/d,可以/v,将/d,这些/r,回归/v,系数/n,乘/v,以/p,输入值/nw,，/w,就/d,得到/v,了/u,预测值/n,。/w,二/m,，/w,线性/n,回归线性/nw,回归/v,，/w,简单/a,而言/u,，/w,就是/d,将/d,输入/v,项/q,分别/d,乘/v,以/p,一些/m,常量/n,，/w,再/d,将/d,结果/n,加/v,起来/v,得到/v,输出/v,。/w,假设/v,输入/v,数据/n,存放/v,在/p,矩阵/n,x/en,中/f,，/w,而/c,回归/v,系数/n,存放/v,在/p,向量/n,w/en,中/f,，/w,那么/r,对于/p,给/p,定/v,的/u,数据/n,x/en,1/m,，/w,预测/v,结果/n,将/d,会/v,通过/p,y/en,=/w,xtw/en,给出/v,。/w,那么/r,，/w,如何/r,才/d,能够/v,找/v,出/v,最佳/z,的/u,回归/v,系数/n,向/p,量/n,w/en,呢/y,？/w,很/d,容易/a,想到/v,使用/v,最小化/nw,误差/n,的/u,w/en,，/w,但是/c,这里/r,的/u,误差/n,为/p,预测/v,y/en,值/n,和/c,真实/a,y/en,值/n,的/u,差值/n,，/w,使用/v,该/r,误差/n,的/u,简单/a,累加/v,将/d,会/v,出现/v,正/d,差值/n,和/c,负/v,差值/n,的/u,相互/d,抵消/v,，/w,所以/c,，/w,我们/r,可以/v,采用/v,平方/q,误差/n,来/v,进行/v,度量/v,。/w,即/v,：/w,Σ,(/w,yi/en,-/w,xitw/en,)/w,2/m,,/w,i/en,=/w,1/m,,/w,2/m,,/w,3/m,./w,./w,./w,./w,./w,./w,n/en,(/w,n/en,为/p,样本/n,总数/n,)/w,这样/r,，/w,用/p,矩阵/n,表示/v,可以/v,写/v,成/v,(/w,y/en,-/w,xw/en,)/w,t/en,(/w,y/en,-/w,xw/en,)/w,./w,因为/c,要求/v,函数/n,的/u,极小/d,值/n,，/w,再/d,对/p,w/en,求/v,导得/nw,，/w,xt/en,(/w,y/en,-/w,xw/en,)/w,，/w,则/d,令/v,其/r,等于/v,0/m,，/w,即可/v,得到/v,w/en,的/u,最/d,优解/nw,：/w,w/en,*/w,=/w,(/w,xtx/en,)/w,-/w,1/m,xty/en,需要/v,注意/v,的/u,是/v,，/w,公式/n,中/f,，/w,出现/v,的/u,求/v,逆/vg,运算/vn,，/w,而/c,对于/p,任意/d,一个/m,矩阵/n,而言/u,，/w,不/d,一定/d,可/v,逆/vg,，/w,所以/c,，/w,我们/r,在/p,实际/n,写/v,代码/n,过程/n,中/f,，/w,需要/v,事先/d,确定/v,矩阵/n,是否/v,可/v,逆/vg,，/w,否则/c,很/d,可能/v,会/v,造成/v,程序/n,出现/v,严重/a,的/u,错误/n,。/w,有/v,了/u,回归/v,系数/n,的/u,求解/v,公式/n,，/w,我们/r,就/d,可以/v,写/v,代码/n,来/v,根据/p,样本/n,数据/n,拟合/nz,出/v,最佳/z,的/u,回归/v,系数/n,向/p,量/n,w/en,了/u,：/w,form/en, ,numpy/en, ,import/en, ,*/w, ,#,解析/v,文件/n,中/f,的/u,数据/n,为/p,适合/v,机器/n,处理/v,的/u,形式/n, ,def/en, ,loaddataset/en,(/w,filename/en,)/w,:/w, ,numfeat/en,=/w,len/en,(/w,open/en,(/w,filename/en,)/w,./w,readline/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w,)/w,-/w,1/m, ,datamat/en,=/w,[/w,]/w,;/w,labelmat/en,=/w,[/w,]/w, ,fr/en,=/w,open/en,(/w,filename/en,)/w, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,linearr/en,=/w,[/w,]/w, ,curline/en,=/w,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,'/w,\/w,t/en,'/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numfeat/en,)/w,:/w, ,linearr/en,./w,extend/en,(/w,float/en,(/w,curline/en,[/w,i/en,]/w,)/w,)/w, ,datamat/en,./w,append/en,(/w,linearr/en,)/w, ,labelmat/en,./w,append/en,(/w,float/en,(/w,curline/en,[/w,-/w,1/m,]/w,)/w,)/w, ,return/en, ,datamat/en,,/w,labelmat/en, ,#,标准/n,线性/n,回归/v,算法/n, ,#,ws/en,=/w,(/w,x/en,./w,t/en,*/w,x/en,)/w,./w,i/en,*/w,(/w,x/en,./w,t/en,*/w,y/en,)/w, ,def/en, ,standregres/en,(/w,xarr/en,,/w,yarr/en,)/w,:/w, ,#,将/d,列表/v,形式/n,的/u,数据/n,转为/v,numpy/en,矩阵/n,形式/n, ,xmat/en,=/w,mat/en,(/w,xarr/en,)/w,;/w,ymat/en,=/w,mat/en,(/w,yarr/en,)/w,./w,t/en, ,#,求/v,矩阵/n,的/u,内积/n, ,xtx/en,=/w,xmat/en,./w,t/en,*/w,xmat/en, ,#,numpy/en,线性/n,代数/n,库/n,linalg/en, ,#,调用/v,linalg/en,./w,det/en,(/w,)/w,计算/v,矩阵/n,行列式/n, ,#,计算/v,矩阵/n,行列式/n,是否/v,为/p,0/m, ,if/en, ,linalg/en,./w,det/en,(/w,xtx/en,)/w,=/w,=/w,0.0/m,:/w, ,print/en,(/w,'/w,this/en, ,matrix/en, ,is/en, ,singular/en,,/w,cannot/en, ,do/en, ,inverse/en,'/w,)/w, ,return/en, ,#,如果/c,可/v,逆/vg,，/w,根据/p,公式/n,计算/v,回归/v,系数/n, ,ws/en,=/w,xtx/en,./w,i/en,*/w,(/w,xmat/en,./w,t/en,*/w,ymat/en,)/w, ,#,可以/v,用/p,yhat/en,=/w,xmat/en,*/w,ws/en,计算/v,实际/n,值/n,y/en,的/u,预测值/n, ,#,返回/v,归/v,系数/n, ,return/en, ,ws/en,这里/r,，/w,需要/v,说明/v,的/u,是/v,，/w,numpy/en,提供/v,了/u,一个/m,线性/n,代数/n,的/u,库/n,linalg/en,，/w,其中/r,包含/v,有/v,很多/m,有用/a,的/u,函数/n,，/w,其中/r,就/d,有/v,代码/n,中/f,用/p,到/v,的/u,计算/v,矩阵/n,行列式/n,值得/v,函数/n,linalg/en,./w,det/en,(/w,)/w,,/w,如果/c,行列式/n,值/n,为/p,0/m,，/w,则/d,矩阵/n,不可/v,逆/vg,，/w,如果/c,不/d,为/p,0/m,，/w,那么/r,就/d,可以/v,顺利/ad,求/v,出/v,回归/v,系数/n,。/w,此外/c,，/w,我们/r,知道/v,线性/n,回归/v,的/u,方程/n,的/u,一般/a,形式/n,为/p,：/w,y/en,=/w,wx/en,+/w,b/en,；/w,即/v,存在/v,一定/d,的/u,偏移量/nz,b/en,，/w,于是/c,，/w,我们/r,可以/v,将/d,回归/v,系数/n,和/c,特征/n,向/p,量/n,均/d,增加/v,一个/m,维度/n,，/w,将/d,函数/n,的/u,偏移值/nw,b/en,也/d,算作/v,回归/v,系数/n,的/u,一部分/m,，/w,占据/v,回归/v,系数/n,向/p,量/n,中/f,的/u,一个/m,维度/n,，/w,比如/v,w/en,=/w,(/w,w/en,1/m,,/w,w/en,2/m,,/w,./w,./w,./w,,/w,wn/en,,/w,b/en,)/w,。/w,相应/v,地/u,，/w,将/d,每/r,条/q,数据/n,特征/n,向量/n,的/u,第一/m,个/q,维度/n,设置/v,为/p,1.0/m,，/w,即/v,所有/b,特征/n,向量/n,的/u,第一/m,个/q,维度/n,值/n,均/d,为/p,1.0/m,,/w,这样/r,，/w,最后/f,得到/v,的/u,回归/v,函数/n,形式/n,为/p,y/en,=/w,w/en,[/w,0/m,]/w,+/w,w/en,[/w,1/m,]/w,*/w,x/en,1/m,+/w,./w,./w,./w,+/w,w/en,[/w,n/en,]/w,*/w,xn/en,./w,通过/p,上面/f,的/u,数据/n,我们/r,可以/v,得到/v,一个/m,拟合/nz,的/u,线性/n,回归/v,模型/n,，/w,但是/c,我们/r,还/d,需要/v,验证/vn,该/r,模型/n,的/u,好坏/n,。/w,如果/c,将/d,所有/b,样本/n,的/u,真实/a,值/n,y/en,保存/v,于/p,一个/m,数列/n,，/w,将/d,所有/b,的/u,预测值/n,yhat/en,保存/v,在/p,另外/c,一个/m,数列/n,，/w,那么/r,我们/r,可以/v,通过/p,计算/v,这/r,两个/m,序列/n,的/u,相关/v,系数/n,，/w,来/v,度量/v,预测/v,值/n,与/p,真实/a,值得/v,匹配/vn,程度/n,。/w,我们/r,可以/v,通过/p,numpy/en,库/n,中/f,提供/v,的/u,corrcoef/en,(/w,)/w,函数/n,计算/v,两个/m,序列/n,的/u,相关性/n,。/w,比如/v,如下/v,代码/n,可以/v,得到/v,真实/a,值/n,和/c,预测/v,值/n,序列/n,的/u,相关性/n,，/w,相关性/n,最/d,好/a,为/p,1/m,，/w,最差/a,为/p,0/m,，/w,表示/v,不/d,相关/v,。/w,#,计算/v,预测/v,值/n,序列/n,yhat/en,=/w,xmat/en,*/w,ws/en, ,corrcoef/en,(/w,yhat/en,./w,t/en,,/w,ymat/en,)/w,三/m,，/w,局部/n,加权线性/nw,回归线性/nw,回归/v,一个/m,比较/d,容易/a,出现/v,的/u,问题/n,是/v,有/v,可能/v,出现/v,欠/v,拟合/nz,现象/n,，/w,欠/v,拟合/nz,显然/ad,不/d,能/v,取得/v,最/d,好/a,的/u,预测/v,效果/n,。/w,因为/c,，/w,我们/r,求/v,的/u,是/v,均方/nw,误差/n,最/d,小/a,的/u,模型/n,，/w,所以/c,可以/v,在/p,估计/v,中/f,引入/v,一些/m,偏差/n,，/w,从而/c,降低/v,预测/v,的/u,均方/nw,误差/n,，/w,达到/v,偏差/n,和/c,方差/nr,的/u,折中/vn,，/w,从而/c,找到/v,最佳/z,的/u,模型/n,参数/n,，/w,即/v,回归/v,系数/n,。/w,解决/v,上述/b,问题/n,的/u,一个/m,方法/n,即/v,是/v,局部/n,加权线性/nw,回归/v,(/w,lwlr/en,)/w,。/w,即/v,在/p,算法/n,中/f,，/w,为/p,每/r,一个/m,待/v,预测/v,的/u,数据点/nw,附近/f,的/u,赋予/v,一定/d,的/u,权重/nz,，/w,越/d,靠近/v,预测点/nw,的/u,数据点/nw,分配/vn,的/u,权重/nz,越/d,高/a,。/w,这里/r,，/w,我们/r,采用/v,高斯/nr,核/n,函数/n,为/p,预测点/nw,附近/f,的/u,数据点/nw,分配权/n,重/a,，/w,即/v,：/w,w/en,(/w,i/en,,/w,i/en,)/w,=/w,exp/en,(/w,|/w,x/en,(/w,i/en,)/w,-/w,x/en,|/w,//w,-/w,2/m,*/w,k/en,2/m,)/w,，/w,其中/r,参数/n,k/en,可以/v,由/p,用户/n,自己/r,定义/n,。/w,显然/ad,，/w,有/v,上面/f,高斯/nr,核/n,函数/n,可知/v,，/w,矩阵/n,w/en,是/v,一个/m,只/d,含/v,对/p,角/q,元素/n,的/u,矩阵/n,。/w,这样/r,，/w,回归/v,系数/n,的/u,解/v,的/u,形式/n,变为/v,：/w,w/en,*/w,=/w,(/w,xtwx/en,)/w,-/w,1/m,(/w,xtwy/en,)/w,。/w,对/p,上述/b,代码/n,稍/d,作/v,修改/v,之后/f,得到/v,如下/v,局部/n,加权线性/nw,回归/v,函数/n,#,局部/n,加权线性/nw,回归/v, ,#,每个/r,测/v,试点/vn,赋予/v,权重/nz,系数/n, ,#,@/w,testpoint/en,:/w,测试/vn,点/q, ,#,@/w,xarr/en,：/w,样本/n,数据/n,矩阵/n, ,#,@/w,yarr/en,：/w,样本/n,对应/v,的/u,原始值/nw, ,#,@/w,k/en,：/w,用户/n,定义/n,的/u,参数/n,，/w,决定/v,权重/nz,的/u,大小/n,，/w,默认/v,1.0/m, ,def/en, ,lwlr/en,(/w,testpoint/en,,/w,xarr/en,,/w,yarr/en,,/w,k/en,=/w,1.0/m,)/w,:/w, ,#,转为/v,矩阵/n,形式/n, ,xmat/en,=/w,mat/en,(/w,xarr/en,)/w,;/w,ymat/en,=/w,mat/en,(/w,yarr/en,)/w,./w,t/en, ,#,样本数/n, ,m/en,=/w,shape/en,(/w,xmat/en,)/w,[/w,0/m,]/w, ,#,初始化权/nw,重/a,矩阵/n,为/p,m/en,*/w,m/en,的/u,单位/n,阵/ng, ,weights/en,=/w,mat/en,(/w,eye/en,(/w,(/w,m/en,)/w,)/w,)/w, ,#,循环/vn,遍历/nw,各个/r,样本/n, ,for/en, ,j/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,计算/v,预测点/nw,与/p,该/r,样本/n,的/u,偏差/n, ,diffmat/en,=/w,testpoint/en,-/w,xmat/en,[/w,j/en,,/w,:/w,]/w, ,#,根据/p,偏差/n,利用/v,高斯/nr,核/n,函数/n,赋予/v,该/r,样本/n,相应/v,的/u,权重/nz, ,weights/en,[/w,j/en,,/w,j/en,]/w,=/w,exp/en,(/w,diffmat/en,*/w,diffmat/en,./w,t/en,//w,(/w,-/w,2.0/m,*/w,k/en,*/w,*/w,2/m,)/w,)/w, ,#,将/d,权/n,重/a,矩阵/n,应用/vn,到/v,公式/n,中/f, ,xtx/en,=/w,xmat/en,./w,t/en,*/w,(/w,weights/en,*/w,xmat/en,)/w, ,#,计算/v,行列/n,式值/nw,是否/v,为/p,0/m,，/w,即/v,确定/v,是否/v,可/v,逆/vg, ,if/en, ,linalg/en,./w,det/en,(/w,xtx/en,)/w,=/w,=/w,0.0/m, ,print/en,(/w,'/w,this/en, ,matrix/en, ,is/en, ,singular/en,,/w,cannot/en, ,do/en, ,inverse/en,'/w,)/w, ,return/en, ,#,根据/p,公式/n,计算/v,回归/v,系数/n, ,ws/en,=/w,xtx/en,./w,i/en,*/w,(/w,xmat/en,./w,t/en,*/w,(/w,weights/en,*/w,ymat/en,)/w,)/w, ,#,计算/v,测试/vn,点/q,的/u,预测值/n, ,return/en, ,testpoint/en,*/w,ws/en, ,#,测试/vn,集/vg,进行/v,预测/v, ,def/en, ,lwlrtest/en,(/w,testarr/en,,/w,xarr/en,,/w,yarr/en,,/w,k/en,=/w,1.0/m,)/w,:/w, ,#,测试/vn,集/vg,样本/n,数/m, ,m/en,=/w,shape/en,(/w,testarr/en,)/w,[/w,0/m,]/w, ,#,测试/vn,集/vg,预测/v,结果/n,保存/v,在/p,yhat/en,列表/v,中/f, ,yhat/en,=/w,zeros/en,(/w,m/en,)/w, ,#,遍历/nw,每/r,一个/m,测试/vn,样本/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,#,计算/v,预测/v,值/n, ,yhat/en,[/w,i/en,]/w,=/w,lwlr/en,(/w,testarr/en,[/w,i/en,]/w,,/w,xarr/en,,/w,yarr/en,,/w,k/en,)/w, ,return/en, ,yhat/en,需要/v,说明/v,的/u,是/v,，/w,当/p,为/p,某/r,一/m,预测点/nw,附件/n,的/u,数据点/nw,分配权/n,重/a,时/ng,，/w,由/p,高斯/nr,核/n,函数/n,公式/n,可知/v,，/w,与/p,预测/v,点约/nw,相近/a,的/u,点/q,分配/vn,得到/v,的/u,权重/nz,越/d,大/a,，/w,否则/c,权/n,重/a,将/d,以/p,指数/n,级/q,衰减/vn,，/w,与/p,预测点/nw,足够/v,远/a,的/u,数据/n,点权/nw,重/a,接近/v,0/m,，/w,那么/r,这些/r,数据点/nw,将/d,不/d,会/v,在/p,该次/nw,预测/v,中/f,起/v,作用/n,。/w,当然/d,，/w,用户/n,可以/v,通过/p,自己/r,设定/v,参数/n,k/en,来/v,控制/v,衰减/vn,的/u,速度/n,，/w,如果/c,k/en,值/n,较大/d,，/w,衰减/vn,速度/n,较/d,慢/a,，/w,这样/r,就/d,会/v,有/v,更/d,多/a,的/u,数据点/nw,共同/d,参与/v,决策/n,；/w,否则/c,，/w,如果/c,参数/n,k/en,非常/d,小/a,，/w,那么/r,衰减/vn,速度/n,极/d,快/a,，/w,参与/v,预测点/nw,决策/n,的/u,数据点/nw,就/d,很少/ad,。/w,所以/c,，/w,我们/r,在/p,实验/vn,中/f,，/w,应该/v,多/a,选择/v,几/m,组/q,不同/a,的/u,k/en,值/n,，/w,得到/v,不同/a,的/u,回归/v,模型/n,，/w,从而/c,找到/v,最/d,优/ag,的/u,回归/v,模型/n,对应/v,的/u,k/en,值/n,。/w,下/f,图/n,从/p,上/f,到/v,下/f,，/w,依次/d,是/v,k/en,取/v,1.0/m,,/w,0.01/m,及/c,0.003/m,情况/n,下/f,，/w,对应/v,的/u,拟合/nz,模型/n,。/w,图/n,中/f,，/w,当/p,k/en,=/w,1.0/m,(/w,上图/n,)/w,时/ng,，/w,意味着/v,所有/b,的/u,数据/n,等/u,权重/nz,，/w,这样/r,，/w,拟合/nz,结果/n,与/p,普通/a,的/u,线性/n,回归/v,拟合/nz,结果/n,一致/a,，/w,显然/ad,很/d,可能/v,出现/v,欠/v,拟合/nz,情况/n,。/w,当/p,k/en,=/w,0.01时/t,(/w,中图/nrf,)/w,，/w,显然/ad,得到/v,了/u,最/d,好/a,的/u,拟合/nz,效果/n,，/w,因为/c,此时/r,掌握/v,了/u,数据/n,的/u,潜在/b,模式/n,，/w,在/p,预测/v,时/ng,剔除/v,了/u,部分/n,不/d,重要/a,数据/n,的/u,影响/vn,，/w,增大/v,了/u,重要/a,数据/n,的/u,权重/nz,。/w,而/c,k/en,=/w,0.003/m,(/w,下图/n,)/w,，/w,可以/v,看出/v,预测/v,时/ng,，/w,纳入/v,了/u,太/d,多/a,的/u,噪声/n,点/q,，/w,拟合/nz,的/u,直线/n,与/p,数据点/nw,过于/d,贴近/v,，/w,出现/v,了/u,过/u,拟合/nz,的/u,现象/n,。/w,此外/c,，/w,局部/n,加权线性/nw,回归/v,也/d,存在/v,一定/d,的/u,问题/n,，/w,相对于/nw,普通/a,的/u,线性/n,回归/v,，/w,由于/c,引入/v,了/u,权重/nz,，/w,大大/d,增加/v,了/u,计算量/nw,，/w,虽然/c,取得/v,了/u,不错/a,的/u,拟合/nz,效果/n,，/w,但/c,也/d,相应/v,地/u,付出/v,了/u,计算量/nw,的/u,代价/n,。/w,我们/r,发现/v,，/w,在/p,k/en,=/w,0.01时/t,，/w,大多/d,的/u,数据点/nw,的/u,权重/nz,都/d,接近/v,0/m,，/w,所以/c,，/w,如果/c,我们/r,能/v,避免/v,这些/r,计算/v,，/w,将/d,一定/d,程度/n,上/f,减少/v,程序/n,运行/vn,的/u,时间/n,，/w,从而/c,缓解/v,计算量/nw,增加/v,带来/v,的/u,问题/n,。/w,四/m,，/w,示例/n,：/w,预测/v,鲍鱼/n,的/u,年龄/n,接下来/l,，/w,就/d,利用/v,上述/b,算法/n,对/p,真实/a,的/u,数据/n,进行/v,测试/vn,，/w,并/c,计算/v,预测/v,的/u,误差/n,。/w,鲍鱼/n,的/u,年龄/n,可以/v,通过/p,鲍鱼壳/nw,的/u,层数/n,推算/v,得到/v,。/w,在/p,运行/vn,代码/n,前/f,，/w,我们/r,还/d,需要/v,添加/vn,计算/v,预测/v,误差/n,的/u,函数/n,代码/n,：/w,#,计算/v,平方/q,误差/n,的/u,和/c, ,def/en, ,rsserror/en,(/w,yarr/en,,/w,yhatarr/en,)/w,:/w, ,#,返回/v,平方/q,误差/n,和/c, ,return/en, ,(/w,(/w,yarr/en,-/w,yhatarr/en,)/w,*/w,*/w,2/m,)/w,./w,sum/en,(/w,)/w,当然/d,，/w,为了/p,得到/v,更/d,好/a,的/u,效果/n,，/w,我们/r,有/v,必要/a,采取/v,交叉/vn,验证/vn,的/u,方法/n,，/w,选取/v,多/a,个/q,样本/n,集/vg,来/v,进行/v,测试/vn,，/w,找/v,出/v,预测/v,误差/n,最/d,小/a,的/u,回归/v,模型/n,。/w,五/m,，/w,缩减/v,系数/n,"/w,理解/v,"/w,数据/n,的/u,方法/n,试想/v,，/w,如果/c,此时/r,数据集/nw,样本/n,的/u,特征/n,维度/n,大于/v,样本/n,的/u,数量/n,，/w,此时/r,我们/r,还/d,能/v,采取/v,上面/f,的/u,线性/n,回归/v,方法/n,求/v,出/v,最佳/z,拟合/nz,参数/n,么/y,？/w,显然/ad,不/d,可能/v,，/w,因为/c,当/p,样本/n,特征/n,维度/n,大于/v,样本/n,数/m,时/ng,，/w,数据/n,矩阵/n,显然/ad,是/v,非/h,满/a,秩/ng,矩阵/n,，/w,那么/r,对/p,非/h,满/a,秩/ng,矩阵/n,求/v,逆运算/n,会/v,出现/v,错误/n,。/w,为了/p,解决/v,这个/r,问题/n,，/w,科学家/n,提/v,出/v,了/u,岭/ng,回归/v,的/u,概念/n,，/w,此外/c,还有/v,一种/mq,称为/v,"/w,前/f,向/p,逐步/d,回归/v,"/w,的/u,算法/n,，/w,该/r,算法/n,可以/v,取得/v,很/d,好/a,的/u,效果/n,且/c,计算/v,相对/d,容易/a,。/w,1/m, ,岭/ng,回归/v,简单/a,而言/u,，/w,岭/ng,回归/v,即/v,是/v,在/p,矩阵/n,xtx/en,上/f,加入/v,一个/m,λ,i/en,从而/c,使得/v,矩阵/n,非/h,奇异/a,，/w,进而/c,能/v,对/p,矩阵/n,xtx/en,+/w,λ,i/en,求/v,逆/vg,。/w,其中/r,矩阵/n,i/en,是/v,一个/m,单位/n,矩阵/n,，/w,即/v,对角线/n,上/f,元素/n,皆/d,为/p,1/m,，/w,其他/r,均/d,为/p,0/m,。/w,这样/r,，/w,回归/v,系数/n,的/u,计算/v,公式/n,变为/v,：/w,w/en,*/w,=/w,(/w,xtx/en,+/w,λ,i/en,)/w,-/w,1/m,(/w,xty/en,)/w,公式/n,中/f,通过/p,引入/v,该/r,惩罚/vn,项/q,，/w,从而/c,减少/v,不/d,重要/a,的/u,参数/n,，/w,更/d,好/a,的/u,理解/v,和/c,利用/v,数据/n,。/w,此外/c,，/w,增加/v,了/u,相关/v,约束/vn,：/w,Σ,wi/en,2/m,</w,=/w,λ,，/w,即/v,回归/v,系数/n,向/p,量/n,中/f,每个/r,参数/n,的/u,平方/q,和/c,不/d,能/v,大于/v,λ,，/w,这/r,就/d,避免/v,了/u,当/p,两个/m,或/c,多/a,个/q,特征/n,相关/v,时/ng,，/w,可能/v,出现/v,很/d,大/a,的/u,正/d,系数/n,和/c,很/d,大/a,的/u,负/v,系数/n,。/w,上面/f,的/u,岭/ng,回归/v,就/d,是/v,一种/mq,缩减/v,方法/n,，/w,通过/p,此/r,方法/n,可以/v,去掉/v,不/d,重要/a,的/u,参数/n,，/w,更/d,好/a,的/u,理解/v,数据/n,的/u,重要性/n,和/c,非/h,重要性/n,，/w,从而/c,更/d,好/a,的/u,预测/v,数据/n,。/w,在/p,岭/ng,回归/v,算法/n,中/f,，/w,通过/p,预测/v,误差/n,最小化/nw,来/v,得到/v,最/d,优/ag,的/u,λ值/nw,。/w,数据/n,获取/v,之后/f,，/w,将/d,数据/n,随机/d,分成/v,两/m,部分/n,，/w,一部分/m,用于/v,训练/vn,模型/n,，/w,另/r,一部分/m,则/d,用于/v,测试/vn,预测/v,误差/n,。/w,为了/p,找到/v,最/d,优/ag,的/u,λ,，/w,可以/v,选择/v,多/a,个/q,不同/a,λ值/nw,重复/v,上述/b,测试/vn,过程/n,，/w,最终/d,得到/v,一个/m,使/v,预测/v,误差/n,最/d,小/a,的/u,λ,。/w,#,岭/ng,回归/v, ,#,@/w,xmat/en,:/w,样本/n,数据/n, ,#,@/w,ymat/en,：/w,样本/n,对应/v,的/u,原始值/nw, ,#,@/w,lam/en,：/w,惩罚/vn,项/q,系数/n,lamda/en,，/w,默认值/nw,为/p,0.2/m, ,def/en, ,ridgeregres/en,(/w,xmat/en,,/w,ymat/en,,/w,lam/en,=/w,0.2/m,)/w,:/w, ,#,计算/v,矩阵/n,内/f,积/v, ,xtx/en,=/w,xmat/en,./w,t/en,*/w,xmat/en, ,#,添加/vn,惩罚/vn,项/q,，/w,使/v,矩阵/n,xtx/en,变换/v,后/f,可/v,逆/vg, ,denom/en,=/w,xtx/en,+/w,eye/en,(/w,shape/en,(/w,xmat/en,)/w,[/w,1/m,]/w,)/w,*/w,lam/en, ,#,判断/v,行列式/n,值/n,是否/v,为/p,0/m,，/w,确定/v,是否/v,可/v,逆/vg, ,if/en, ,linalg/en,./w,det/en,(/w,denom/en,)/w,=/w,=/w,0.0/m,:/w, ,print/en,(/w,'/w,this/en, ,matrix/en, ,is/en, ,singular/en,,/w,cannot/en, ,do/en, ,inverse/en,'/w,)/w, ,return/en, ,#,计算/v,回归/v,系数/n, ,ws/en,=/w,denom/en,./w,i/en,*/w,(/w,xmat/en,./w,t/en,*/w,ymat/en,)/w, ,return/en, ,ws/en, ,#,特征/n,需要/v,标准化/vn,处理/v,，/w,使/v,所有/b,特征/n,具有/v,相同/a,重要性/n, ,def/en, ,ridgetest/en,(/w,xarr/en,,/w,yarr/en,)/w,:/w, ,xmat/en,=/w,mat/en,(/w,xarr/en,)/w,;/w,ymat/en,=/w,mat/en,(/w,yarr/en,)/w,./w,t/en, ,#,计算/v,均值/n, ,ymean/en,=/w,mean/en,(/w,ymat/en,,/w,0/m,)/w, ,ymat/en,=/w,ymat/en,-/w,ymean/en, ,xmeans/en,=/w,mean/en,(/w,xmat/en,,/w,0/m,)/w, ,#,计算/v,各个/r,特征/n,的/u,方差/nr, ,xvar/en,=/w,var/en,(/w,xmat/en,,/w,0/m,)/w, ,#,特征/n,-/w,均值/n,//w,方差/nr, ,xmat/en,=/w,(/w,xmat/en,-/w,xmeans/en,)/w,//w,xvar/en, ,#,在/p,30个/m,不同/a,的/u,lamda/en,下/f,进行/v,测试/vn, ,numtestpts/en,=/w,30/m, ,#,30次/mq,的/u,结果/n,保存/v,在/p,wmat/en,中/f, ,wmat/en,=/w,zeros/en,(/w,(/w,numtestpts/en,,/w,shape/en,(/w,xmat/en,)/w,[/w,1/m,]/w,)/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtestpts/en,)/w,:/w, ,#,计算/v,对应/v,lamda/en,回归/v,系数/n,，/w,lamda/en,以/p,指数/n,形式/n,变换/v, ,ws/en,=/w,ridgeregres/en,(/w,xmat/en,,/w,ymat/en,,/w,exp/en,(/w,i/en,-/w,10/m,)/w,)/w, ,wmat/en,[/w,i/en,,/w,:/w,]/w,=/w,ws/en,./w,t/en, ,return/en, ,wmat/en,需要/v,说明/v,的/u,几/m,点/q,如下/v,：/w,（/w,1/m,）/w,代码/n,中/f,用/p,到/v,numpy/en,库/n,中/f,的/u,eye/en,(/w,)/w,方法/n,来/v,生成/vn,单位/n,矩阵/n,。/w,（/w,2/m,）/w,代码/n,中/f,仍/d,保留/v,了/u,判断/v,行列式/n,是否/v,为/p,0/m,的/u,代码/n,，/w,原因/n,是/v,当/p,λ,取值/v,为/p,0时/t,，/w,又/d,回到/v,了/u,普通/a,的/u,线性/n,回归/v,，/w,那么/r,矩阵/n,很/d,可能/v,出现/v,不可/v,逆/vg,的/u,情况/n,（/w,3/m,）/w,岭/ng,回归/v,中/f,数据/n,需要/v,进行/v,标准化/vn,处理/v,，/w,即/v,数据/n,的/u,每/r,一/m,维度/n,特征/n,减去/v,相应/v,的/u,特征/n,均值/n,之后/f,，/w,再/d,除/p,以/p,特征/n,的/u,方差/nr,。/w,（/w,4/m,）/w,这里/r,，/w,选择/v,了/u,30个/m,不同/a,的/u,λ,进行/v,测试/vn,，/w,并且/c,这里/r,的/u,λ,是/v,按照/p,指数/n,级/q,进行/v,变化/vn,，/w,从而/c,可以/v,看出/v,当λ/nw,非常/d,小/a,和/c,非常/d,大/a,的/u,情况/n,下/f,对/p,结果/n,造成/v,的/u,影响/vn,下/f,图示/v,出/v,了/u,回归/v,系数/n,与/p,log/en,(/w,λ,)/w,之间/f,的/u,关系/n,:/w,可以/v,看出/v,，/w,当/p,λ,非常/d,小时/n,，/w,系数/n,与/p,普通/a,回归/v,一样/u,。/w,而/c,λ,非常/d,大/a,时/ng,，/w,所有/b,回归/v,系数/n,缩减/v,为/p,0/m,。/w,这样/r,，/w,可以/v,在/p,中间/f,的/u,某处/r,找到/v,使得/v,预测/v,结果/n,最/d,好/a,的/u,λ,。/w,2/m, ,逐步/d,前/f,向/p,回归/v,逐步/d,前/f,向/p,回归/v,是/v,一种/mq,贪心/v,算法/n,，/w,即/v,每/r,一步/mq,都/d,尽可能/d,的/u,减小/v,误差/n,。/w,从/p,一/m,开始/v,，/w,所有/b,的/u,权重/nz,都/d,设/v,为/p,1/m,，/w,然后/c,每/r,一步/mq,所/u,做/v,的/u,决策/n,是/v,对/p,某个/r,权重/nz,增加/v,或/c,减少/v,一个/m,较/d,小/a,的/u,数值/n,。/w,算法/n,的/u,伪代码/nw,为/p,：/w,数据/n,标准化/vn,，/w,使/v,其/r,分布/v,满足/v,均值/n,为/p,0/m,,/w,和/c,方差/nr,为/p,1/m, ,在/p,每/r,轮/q,的/u,迭代/vn,中/f,：/w, ,设置/v,当前/t,最/d,小/a,的/u,误差/n,为/p,正/d,无穷/z, ,对/p,每个/r,特征/n,：/w, ,增大/v,或/c,减/v,小/a,：/w, ,改变/v,一个/m,系数/n,得到/v,一个/m,新/a,的/u,w/en, ,计算/v,新/a,w/en,下/f,的/u,误差/n, ,如果/c,误差/n,小于/v,当前/t,最/d,小/a,的/u,误差/n,：/w,设置/v,最小/a,误差/n,等于/v,当前/t,误差/n, ,将/d,当前/t,的/u,w/en,设置/v,为/p,最/d,优/ag,的/u,w/en, ,将/d,本次/r,迭代/vn,得到/v,的/u,预测/v,误差/n,最/d,小/a,的/u,w/en,存入/v,矩阵/n,中/f,返回/v,多次/m,迭代/vn,下/f,的/u,回归/v,系数/n,组成/v,的/u,矩阵/n,#,前/f,向/p,逐步/d,回归/v, ,#,@/w,eps/en,：/w,每次/r,迭代/vn,需要/v,调整/vn,的/u,步长/nz, ,def/en, ,stagewise/en,(/w,xarr/en,,/w,yarr/en,,/w,eps/en,=/w,0.01/m,,/w,numit/en,=/w,100/m,)/w,:/w, ,xmat/en,=/w,mat/en,(/w,xarr/en,)/w,;/w,ymat/en,=/w,mat/en,(/w,yarr/en,)/w, ,ymean/en,=/w,mean/en,(/w,ymat/en,,/w,0/m,)/w, ,ymat/en,=/w,ymat/en,-/w,ymean/en, ,#,将/d,特征/n,标准化/vn,处理/v,为/p,均值/n,为/p,0/m,，/w,方差/nr,为/p,1/m, ,xmat/en,=/w,regularize/en,(/w,xmat/en,)/w, ,m/en,,/w,n/en,=/w,shape/en,(/w,xmat/en,)/w, ,#,将/d,每次/r,迭代/vn,中/f,得到/v,的/u,回归/v,系数/n,存入/v,矩阵/n, ,returnmat/en,=/w,zeros/en,(/w,(/w,numit/en,,/w,m/en,)/w,)/w, ,ws/en,=/w,zeros/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w,;/w,wstest/en,=/w,ws/en,./w,copy/en,(/w,)/w,;/w,wsmat/en,=/w,ws/en,./w,copy/en,(/w,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numit/en,)/w,:/w, ,print/en, ,ws/en,./w,t/en, ,#,初始化/v,最小/a,误差/n,为/p,正/d,无穷/z, ,lowesterror/en,=/w,inf/en,;/w, ,for/en, ,j/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,#,对/p,每个/r,特征/n,的/u,系数/n,执行/v,增加/v,和/c,减少/v,eps/en,*/w,sign/en,操作/v, ,for/en, ,sign/en, ,in/en, ,[/w,-/w,1/m,,/w,1/m,]/w,:/w, ,wstest/en,=/w,ws/en,./w,copy/en,(/w,)/w, ,wstest/en,[/w,j/en,]/w,+/w,=/w,eps/en,*/w,sign/en, ,#,变化/vn,后/f,计算/v,相应/v,预测/v,值/n, ,ytest/en,=/w,xmat/en,*/w,wstest/en, ,#,保存/v,最/d,小/a,的/u,误差/n,以及/c,对应/v,的/u,回归/v,系数/n, ,rsse/en,=/w,rsserror/en,(/w,ymat/en,./w,a/en,,/w,ytest/en,./w,a/en,)/w, ,if/en, ,rsse/en,</w,lowesterror/en,:/w, ,lowesterror/en,=/w,rsse/en, ,wsmat/en,=/w,wstest/en, ,ws/en,=/w,wsmat/en,./w,copy/en,(/w,)/w, ,returnmat/en,[/w,i/en,,/w,:/w,]/w,=/w,ws/en, ,return/en, ,returnmat/en,下面/f,看/v,一次/mq,迭代/vn,的/u,算法/n,执行/v,过程/n,，/w,此时/r,学习/v,步长/nz,eps/en,=/w,0.01/m,：/w,可以/v,看到/v,，/w,上述/b,结果/n,中/f,w/en,1/m,和/c,w/en,6/m,都/d,是/v,0/m,，/w,这/r,表明/v,了/u,这/r,两个/m,维度/n,的/u,特征/n,对/p,预测/v,结果/n,不/d,构成/v,影响/vn,，/w,即/v,所谓/v,的/u,不/d,重要/a,特征/n,。/w,此外/c,，/w,在/p,eps/en,=/w,0.01/m,情况/n,下/f,，/w,一段/mq,时间/n,后/f,系数/n,就/d,已经/d,饱和/vn,并/c,在/p,特定值/nw,之间/f,来回/v,震荡/vn,，/w,这/r,显然/ad,是/v,步长/nz,太/d,大/a,的/u,缘故/n,，/w,我们/r,可以/v,据此/d,调整/vn,较/d,小/a,的/u,步长/nz,。/w,前/f,向/p,逐步/d,回归/v,算法/n,也/d,属于/v,缩减/v,算法/n,。/w,它/r,主要/b,的/u,优点/n,是/v,可以/v,帮助/v,我们/r,更/d,好/a,地/u,理解/v,现有/v,的/u,模型/n,并/c,作出/v,改进/v,。/w,当/p,构建/v,出/v,一个/m,模型/n,时/ng,，/w,可以/v,运行/vn,该/r,算法/n,找/v,出/v,重要/a,的/u,特征/n,，/w,这样/r,就/d,可能/v,及时/ad,停止/v,对/p,不/d,重要/a,特征/n,的/u,收集/v,。/w,同样/d,，/w,在/p,算法/n,测试/vn,的/u,过程/n,中/f,，/w,可以/v,使用/v,s/en,折/v,交叉/vn,验证/vn,的/u,方法/n,，/w,选择/v,误差/n,最/d,小/a,的/u,模型/n,。/w,此外/c,，/w,当/p,我们/r,不管/c,是/v,应用岭/ns,回归/v,还是/c,前/f,向/p,逐步/d,回归/v,等/u,缩减/v,算法/n,时/ng,，/w,就/d,相应/v,的/u,为/p,模型/n,增加/v,了/u,偏差/n,，/w,与此同时/c,也/d,就/d,减小/v,了/u,模型/n,的/u,方差/nr,。/w,而/c,最/d,优/ag,的/u,模型/n,往往/d,是/v,在/p,模型/n,偏差/n,和/c,方差/nr,的/u,折中/vn,时/ng,获得/v,。/w,否则/c,，/w,当/p,模型/n,方差/nr,很/d,大/a,偏差/n,很/d,小时/n,模型/n,复杂度/nw,很/d,大/a,而/c,出现/v,过/u,拟合/nz,现象/n,，/w,而/c,方差/nr,很/d,小/a,偏差/n,很/d,大/a,时而/d,容易/a,出现/v,欠/v,拟合/nz,现象/n,。/w,因此/c,，/w,权衡/v,模型/n,的/u,偏差/n,和/c,方差/nr,可以/v,做出/v,最/d,好/a,的/u,预测/v,。/w,六/m,，/w,岭/ng,回归/v,应用/vn,示例/n,：/w,预测/v,乐高/nr,玩具/n,套装/n,的/u,价格/n,我们/r,知道/v,乐高/nr,玩具/n,是/v,一种/mq,拼/v,装/v,类/q,玩具/n,，/w,由/p,很多/m,大小/n,不同/a,的/u,塑料/n,插件/nz,组成/v,。/w,一种/mq,乐高/nr,玩具/n,套装/n,基本上/d,在/p,几/m,年/q,后/f,就/d,会/v,停产/v,，/w,但/c,乐高/nr,收藏者/nw,之间/f,仍/d,会/v,在/p,停产/v,后/f,彼此/r,交易/n,。/w,这样/r,，/w,我们/r,可以/v,拟合/nz,一个/m,回归/v,模型/n,，/w,从而/c,对/p,乐高/nr,套装/n,进行/v,估价/vn,。/w,显然/ad,这样/r,做/v,十分/d,有/v,意义/n,。/w,算法/n,流程/n,：/w,1/m, ,收集/v,数据/n,：/w,用/p,google/en, ,shopping/en,的/u,api/en,收集/v,数据/n,2/m, ,准备/v,数据/n,：/w,从/p,返回/v,的/u,json/en,数据/n,中/f,抽取/vn,价格/n,3/m, ,分析/vn,数据/n,：/w,可视化/nz,并/c,观察/v,数据/n,4/m, ,训练/vn,算法/n,：/w,构建/v,不同/a,的/u,模型/n,，/w,采用/v,岭/ng,回归/v,和/c,普通线性/nw,回归/v,训练/vn,模型/n,5/m, ,测试/vn,算法/n,：/w,使用/v,交叉/vn,验证/vn,来/v,测试/vn,不同/a,的/u,模型/n,，/w,选择/v,效果/n,最/d,好/a,的/u,模型/n,1/m, ,收集/v,数据/n,：/w,使用/v,google/en, ,购物/v,的/u,api/en,来/v,获取/v,玩具/n,套装/n,的/u,相关/v,信息/n,和/c,价格/n,，/w,可以/v,通过/p,urllib/en,2/m,发送/v,http/en,请求/v,，/w,api/en,将/d,以/p,json/en,格式/n,返回/v,需要/v,的/u,产品/n,信息/n,，/w,python/en,的/u,json/en,解析/v,模块/n,可以/v,帮助/v,我们/r,从/p,json/en,格式/n,中/f,解析/v,出/v,所/u,需要/v,的/u,数据/n,。/w,收集/v,数据/n,的/u,代码/n,如下/v,：/w,#,收集/v,数据/n, ,#,添加/vn,时间/n,函数/n,库/n, ,from/en, ,time/en, ,import/en, ,sleep/en, ,#,添加/vn,json/en,库/n, ,import/en, ,json/en, ,#,添加/vn,urllib/en,2/m,库/n, ,import/en, ,urllib/en,2/m, ,#,@/w,retx/en,:/w,样本/n,玩具/n,特征/n,矩阵/n, ,#,@/w,rety/en,：/w,样本/n,玩具/n,的/u,真实/a,价格/n, ,#,@/w,setnum/en,：/w,获取/v,样本/n,的/u,数量/n, ,#,@/w,yr/en,：/w,样本/n,玩具/n,的/u,年份/n, ,#,@/w,numpce/en,:/w,玩具/n,套装/n,的/u,零件/n,数/m, ,#,@/w,origpce/en,:/w,原始/a,价格/n, ,def/en, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,setnum/en,,/w,yr/en,,/w,numpce/en,,/w,origprc/en,)/w,:/w, ,#,睡眠/vn,十秒/t, ,sleep/en,(/w,10/m,)/w, ,#,拼接/vn,查询/v,的/u,url/en,字符串/n, ,myapistr/en,=/w,'/w,get/en, ,from/en, ,code/en,./w,google/en,./w,com/en,'/w, ,searchurl/en,=/w,'/w,https/en,:/w,//w,//w,www/en,./w,googleapis/en,./w,com/en,//w,shopping/en,//w,search/en,//w,v/en,1/m,//w,public/en,//w,products/en,?/w,\/w, ,key/en,=/w,%/w,s/en,&/w,country/en,=/w,us/en,&/w,q/en,=/w,lego/en,+/w,%/w,d/en,&/w,alt/en,=/w,json/en,'/w, ,%/w,(/w,myapistr/en,,/w,setnum/en,)/w, ,#,利用/v,urllib/en,2/m,访问/v,url/en,地址/n, ,pg/en,=/w,urllib/en,2/m,./w,urlopen/en,(/w,searchurl/en,)/w, ,#,利用/v,json/en,打开/v,和/c,解析/v,url/en,获得/v,的/u,数据/n,，/w,数据/n,信息/n,存入/v,字典/n,中/f, ,retdict/en,=/w,json/en,./w,load/en,(/w,pg/en,./w,read/en,(/w,)/w,)/w, ,#,遍历/nw,数据/n,的/u,每/r,一个/m,条目/n, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,retdict/en,[/w,'/w,items/en,'/w,]/w,)/w,)/w,:/w, ,try/en,:/w, ,#,获得/v,当前/t,条目/n, ,curritem/en,=/w,retdict/en,[/w,'/w,items/en,'/w,]/w,[/w,i/en,]/w, ,#,当前/t,条目/n,对应/v,的/u,产品/n,为/p,新/a,产品/n, ,if/en, ,curritem/en,[/w,'/w,product/en,'/w,]/w,[/w,'/w,condition/en,'/w,]/w,=/w,=/w,'/w,new/en,'/w,:/w, ,#,标记/n,为/p,新/a, ,newflag/en,=/w,1/m, ,else/en,:/w,newflag/en,=/w,0/m, ,#,得到/v,当前/t,目录/n,产品/n,的/u,库存/n,列表/v, ,listofinv/en,=/w,curritem/en,[/w,'/w,product/en,'/w,]/w,[/w,'/w,inventories/en,'/w,]/w, ,#,遍历/nw,库存/n,中/f,的/u,每/r,一个/m,条目/n, ,for/en, ,item/en, ,in/en, ,listofinv/en,:/w, ,#,得到/v,该/r,条目/n,玩具/n,商品/n,的/u,价格/n, ,sellingprice/en,=/w,item/en,[/w,'/w,price/en,'/w,]/w, ,#,价格/n,低于/v,原价/n,的/u,50%/mq,视为/v,不/d,完整/a,套装/n, ,if/en, ,sellingprice/en,>,origprc/en,*/w,0.5/m,：/w, ,print/en,(/w,'/w,%/w,d/en,\/w,t/en,%/w,d/en,\/w,t/en,%/w,d/en,\/w,t/en,%/w,f/en,\/w,t/en,%/w,f/en,'/w,,/w,%/w,(/w,yr/en,,/w,numpce/en,,/w,newflag/en,,/w,\/w, ,origprc/en,,/w,sellingprice/en,)/w,)/w, ,#,将/d,符合/v,条件/n,套装/n,信息/n,作为/v,特征/n,存入/v,数据/n,矩阵/n, ,retx/en,./w,append/en,(/w,[/w,yr/en,,/w,numpce/en,,/w,newflag/en,,/w,origpce/en,]/w,)/w, ,#,将/d,对应/v,套装/n,的/u,出售/v,价格/n,存入/v,矩阵/n, ,rety/en,./w,append/en,(/w,sellingprice/en,)/w, ,except/en,:/w,print/en,(/w,'/w,problem/en, ,with/en, ,item/en, ,%/w,d/en,'/w,,/w,%/w,i/en,)/w, ,#,多次/m,调用/v,收集/v,数据/n,函数/n,，/w,获取/v,多/a,组/q,不同/a,年份/n,，/w,不同/a,价格/n,的/u,数据/n, ,def/en, ,setdatacollect/en,(/w,retx/en,,/w,rety/en,)/w,:/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,8288/m,,/w,2006/m,,/w,800/m,,/w,49.99/m,)/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,10030/m,,/w,2002/m,,/w,3096/m,,/w,49.99/m,)/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,10179/m,,/w,2007/m,,/w,5195/m,,/w,499.99/m,)/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,10181/m,,/w,2007/m,,/w,3428/m,,/w,199.99/m,)/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,10189/m,,/w,2008/m,,/w,5922/m,,/w,299.99/m,)/w, ,searchforset/en,(/w,retx/en,,/w,rety/en,,/w,10196/m,,/w,2009/m,,/w,3263/m,,/w,249.99/m,)/w,需要/v,指出/v,的/u,是/v,，/w,我们/r,在/p,代码/n,中/f,发送/v,http/en,请求/v,，/w,需要/v,从/p,numpy/en,导入/v,urllib/en,2/m,模块/n,；/w,使用/v,json/en,解析/v,获得/v,的/u,数据/n,时/ng,需要/v,导入/v,json/en,模块/n,；/w,同时/c,为/p,避免/v,多/a,个/q,函数/n,同时/c,访问/v,网站/n,，/w,在/p,程序/n,开始/v,时/ng,先/d,睡眠/vn,一定/d,的/u,时间/n,，/w,用于/v,缓冲/vn,，/w,即/v,需要/v,调用/v,time/en,模块/n,的/u,sleep/en,。/w,此外/c,，/w,由于/c,套装/n,是/v,由/p,多/a,个/q,小/a,插件/nz,组成/v,，/w,所以/c,存在/v,插件/nz,损失/n,的/u,情况/n,，/w,所以/c,需要/v,过滤/v,掉/v,这样/r,的/u,玩具/n,套装/n,，/w,我们/r,可以/v,通过/p,一定/d,的/u,过滤/v,条件/n,(/w,一般/a,套/q,装有/v,缺失/n,可能/v,有/v,标识/n,，/w,可/v,通过/p,关键/n,词/n,筛选/v,，/w,或者/c,通过/p,贝叶斯/nr,估计/v,估计/v,套装/n,完整性/n,）/w,，/w,这里/r,用/p,的/u,是/v,价格/n,来/v,判断/v,，/w,如果/c,当前/t,价格/n,不/d,到/v,原始/a,价格/n,的/u,一半/m,，/w,那么/r,这样/r,的/u,套装/n,必然/d,有/v,缺陷/n,，/w,损坏/v,和/c,缺失/n,等/u,。/w,因为/c,，/w,一旦/d,具有/v,收藏/v,价值/n,的/u,玩具/n,套装/n,停产/v,，/w,必然/d,价格/n,相对/d,上涨/v,，/w,所以/c,出现/v,这种/r,价格/n,反常/a,的/u,情况/n,表明/v,该/r,产品/n,套装/n,存在/v,一定/d,的/u,缺陷/n,，/w,可以/v,将/d,其/r,过滤/v,掉/v,。/w,2/m, ,训练/vn,算法/n,：/w,建立/v,模型/n,上面/f,有/v,了/u,数据/n,，/w,那么/r,我们/r,就/d,可以/v,开始/v,完成/v,代码/n,进行/v,模型/n,训练/vn,了/u,，/w,这里/r,采用/v,岭/ng,回归/v,来/v,训练/vn,模型/n,，/w,并且/c,采用/v,交叉/vn,验证/vn,的/u,方法/n,来/v,求/v,出/v,每个/r,λ,对应/v,的/u,测试/vn,误差/n,的/u,均值/n,，/w