一/m,、/w,概述/v,前/f,两章/mq,我们/r,要求/v,分类器/nw,做出/v,艰难/a,决策/n,，/w,给出/v,“/w,该/r,数据/n,实例/n,属于/v,哪/r,一类/mq,”/w,这/r,类/q,问题/n,的/u,明确/ad,答案/n,。/w,不过/c,，/w,分类器/nw,有时/d,会/v,产生/v,错误/n,结果/n,，/w,这时/r,可以/v,要求/v,分类器/nw,给/p,出/v,一个/m,最/d,优/ag,的/u,类别/n,猜测/vn,结果/n,，/w,同时/c,给/p,出/v,这个/r,猜测/vn,的/u,概率/n,估计值/nw,。/w,概率/n,论/v,是/v,许多/m,机器/n,学习/v,算法/n,的/u,基础/n,，/w,所以/c,深刻/a,理解/v,这/r,一/m,主题/n,就/d,显得/v,十分/d,重要/a,。/w,第/m,3章/mq,在/p,计算/v,特征/n,值取/nw,某个/r,值/n,的/u,概率/n,时/ng,涉及/v,了/u,一些/m,概率/n,知识/n,，/w,在/p,那里/r,我们/r,先/d,统计/v,特征/n,在/p,数据/n,集中/v,取/v,某个/r,特定值/nw,的/u,次数/n,，/w,然后/c,除/p,以/p,数据集/nw,的/u,实例/n,总数/n,，/w,就/d,得到/v,了/u,特征/n,取/v,该值/nw,的/u,概率/n,。/w,我们/r,将/d,在/p,此/r,基础/n,上/f,深人/nw,讨论/v,。/w,本/r,章/q,会/v,给/p,出/v,一些/m,使用/v,概率/n,论/v,进行/v,分类/vn,的/u,方法/n,。/w,首先/d,从/p,一个/m,最/d,简单/a,的/u,概率/n,分类器/nw,开始/v,，/w,然后/c,给/p,出/v,一些/m,假设/v,来/v,学习/v,朴素/a,贝叶斯分类器/nw,。/w,我们/r,称之为/v,“/w,朴素/a,”/w,，/w,是/v,因为/c,整个/b,形式化/v,过程/n,只/d,做/v,最/d,原始/a,、/w,最/d,简单/a,的/u,假设/v,。/w,不必/d,担心/v,，/w,你/r,会/v,详细/ad,了解/v,到/v,这些/r,假设/v,。/w,我们/r,将/d,充分/ad,利用/v,python/en,的/u,文本/n,处理/v,能力/n,将/d,文档/n,切分/v,成/v,词向量/nw,，/w,然后/c,利用/v,词向量/nw,对/p,文档/n,进行/v,分类/vn,。/w,我们/r,还/d,将/d,构建/v,另/r,一个/m,分类器/nw,，/w,观察/v,其/r,在/p,真实/a,的/u,垃圾/n,邮件/n,数据/n,集中/v,的/u,过滤/v,效果/n,，/w,必要/a,时/ng,还/d,会/v,回顾/v,一下/m,条件/n,概率/n,。/w,最后/f,，/w,我们/r,将/d,介绍/v,如何/r,从/p,个人/n,发布/v,的/u,大量/m,广告/n,中/f,学习/v,分类器/nw,，/w,并/c,将/d,学习/v,结果/n,转换/v,成/v,人类/n,可/v,理解/v,的/u,信息/n,。/w,假设/v,现在/t,我们/r,有/v,一个/m,数据集/nw,，/w,它/r,由/p,两类/mq,数据/n,组成/v,，/w,数据/n,分布/v,如/v,图/n,所/u,示/vg,。/w,我们/r,现在/t,用/p,p/en,1/m,(/w,x/en,,/w,y/en,)/w,表示/v,数据点/nw,(/w,x/en,,/w,y/en,)/w,属于/v,类别/n,1/m,(/w,以/p,图/n,中/f,用/p,圆点/n,表示/v,的/u,类别/n,）/w,的/u,概率/n,，/w,用/p,p/en,2/m,(/w,x/en,,/w,y/en,)/w,表示/v,数据点/nw,(/w,x/en,,/w,y/en,)/w,属于/v,类别/n,2/m, ,(/w, ,图/n,中/f,用/p,三角形/n,表示/v,的/u,类别/n,）/w,的/u,概率/n,，/w,那么/r,对于/p,一个/m,新/a,数据点/nw,(/w,x/en,,/w,y/en,)/w,，/w,可以/v,用/p,下面/f,的/u,规则/n,来/v,判断/v,它/r,的/u,类别/n,：/w,也就是说/l,，/w,我们/r,会/v,选择/v,高/a,概率/n,对应/v,的/u,类别/n,。/w,这/r,就/d,是/v,贝叶斯/nr,决策/n,理论/n,的/u,核心/n,思想/n,，/w,即/v,选择/v,具有/v,最/d,高/a,概率/n,的/u,决策/n,。/w,回到/v,图/n,，/w,如果/c,该/r,图/n,中/f,的/u,整个/b,数据/n,使用/v,6个/m,浮点数/nz,来/v,表示/v,，/w,并且/c,计算/v,类别/n,概率/n,的/u,python/en,代码/n,只/d,有/v,两行/mq,，/w,那么/r,你/r,会/v,更/d,倾向/n,于/p,使用/v,下面/f,哪/r,种/q,方法/n,来/v,对/p,该/r,数据点/nw,进行/v,分类/vn,？/w,(/w,1/m,)/w,使用/v,第/m,1章/mq,的/u,knn/en, ,，/w,进行/v,1000次/mq,距离/n,计算/v,；/w,(/w,2/m,)/w,使用/v,第/m,2章/mq,的/u,决策树/nz,，/w,分别/d,沿/p,x/en,轴/q,、/w,y/en,轴/q,划分/v,数据/n,；/w,(/w,3/m,)/w,计算/v,数据点/nw,属于/v,每个/r,类别/n,的/u,概率/n,，/w,并/c,进行/v,比较/d,。/w,使用/v,决策/n,树/v,不/d,会/v,非常/d,成功/a,；/w,而/c,和/c,简单/a,的/u,概率/n,计算/v,相比/v,，/w,knn/en,的/u,计算量/nw,太大/d,。/w,因此/c,，/w,对于/p,上述/b,问题/n,，/w,最佳/z,选择/v,是/v,使用/v,刚才/t,提到/v,的/u,概率/n,比较/d,方法/n,二/m,、/w,优/ag,缺点/n,优点/n,：/w,在/p,数据/n,较/d,少/a,的/u,情况/n,下/f,仍然/d,有效/a,，/w,可以/v,处理/v,多/a,类别/n,问题/n,。/w,缺点/n,：/w,对于/p,输入/v,数据/n,的/u,准备/v,方式/n,较为/d,敏感/a,。/w,适用/v,数据/n,类型/n,：/w,标称型/nw,数据/n,。/w,三/m,、/w,数学/n,公式/n,贝叶斯/nr,定理/n,了解/v,贝叶斯/nr,定理/n,之前/f,，/w,需要/v,先/d,了解/v,下/f,条件/n,概率/n,。/w,p/en,(/w,a/en,|/w,b/en,)/w,表示/v,在/p,事件/n,b/en,已经/d,发生/v,的/u,条件/n,下/f,事件/n,a/en,发生/v,的/u,概率/n,：/w,假如/c,我们/r,已经/d,知道/v,了/u,p/en,(/w,a/en,|/w,b/en,)/w,，/w,但是/c,现在/t,我们/r,想/v,要求/v,p/en,(/w,b/en,|/w,a/en,)/w,，/w,也/d,就是/d,在/p,事件/n,a/en,发生/v,的/u,条件/n,下/f,事件/n,b/en,发生/v,的/u,概率/n,，/w,这时/r,贝叶斯/nr,定理/n,就/d,派/v,上/f,用场/n,了/u,。/w,前面/f,提到/v,贝叶斯/nr,决策/n,理论/n,要求/v,计算/v,两个/m,概率/n,p/en,1/m,(/w,x/en,,/w,y/en,)/w, ,和/c,p/en,2/m,(/w,x/en,,/w,y/en,)/w,；/w,但/c,这/r,两个/m,准则/n,并/c,不/d,是/v,贝叶斯/nr,决策/n,理论/n,的/u,所有/b,内容/n,。/w,使用/v,p/en,1/m,(/w,)/w, ,p/en,2/m,(/w,)/w,只是/d,为了/p,简化/v,描述/v,，/w,而/c,真正/d,需要/v,计算/v,和/c,比较/d,的/u,是/v,p/en,(/w,c/en,1/m,|/w,x/en,,/w,y/en,)/w, ,和/c,p/en,(/w,c/en,2/m,|/w,x/en,,/w,y/en,)/w,。/w, ,这些/r,符号/n,的/u,意思/n,是/v,：/w,给/p,定/v,某个/r,x/en,,/w,y/en,表示/v,的/u,数据点/nw,，/w,那么/r,该/r,数据点/nw,来自/v,类别/n,c/en,1/m,的/u,概率/n,是/v,多少/r,?/w, ,来自/v,c/en,2/m,的/u,概率/n,又/d,是/v,多少/r,？/w,现/tg,分别/d,有/v, ,a/en,、/w,b/en, ,两个/m,容器/n,，/w,在/p,容器/n, ,a/en, ,里/f,分别/d,有/v, ,7/m, ,个/q,红球/nz,和/c, ,3/m, ,个/q,白球/nr,，/w,在/p,容器/n, ,b/en, ,里/f,有/v, ,1/m, ,个/q,红球/nz,和/c, ,9/m, ,个/q,白球/nr,，/w,现/tg,已知/nz,从/p,这/r,两个/m,容器/n,里/f,任意/d,抽出/v,了/u,一个/m,球/n,，/w,问/v,这个/r,球/n,是/v,红球/nz,且/c,来自/v,容器/n, ,a/en, ,的/u,概率/n,是/v,多少/r,?/w,假设/v,已经/d,抽出/v,红球/nz,为/p,事件/n, ,b/en,，/w,选中/v,容器/n, ,a/en, ,为/p,事件/n, ,a/en,，/w,则/d,有/v,：/w,p/en,(/w,b/en,)/w, ,=/w, ,8/m,//w,20/m,，/w,p/en,(/w,a/en,)/w, ,=/w, ,1/m,//w,2/m,，/w,p/en,(/w,b/en,|/w,a/en,)/w, ,=/w, ,7/m,//w,10/m,，/w,按照/p,公式/n,，/w,则/d,有/v,：/w,p/en,(/w,a/en,|/w,b/en,)/w, ,=/w, ,(/w,7/m,//w,10/m,)/w,*/w,(/w,1/m,//w,2/m,)/w, ,//w, ,(/w,8/m,//w,20/m,)/w, ,=/w, ,0.875/m,四/m,、/w,使用/v,朴素/a,贝叶斯/nr,进行/v,文档/n,分类/vn,机器/n,学习/v,的/u,一个/m,重要/a,应用/vn,就/d,是/v,文档/n,的/u,自动/d,分类/vn,。/w,在/p,文档/n,分类/vn,中/f,，/w,整个/b,文档/n,（/w,如/v,一封/mq,电子/n,邮件/n,）/w,是/v,实例/n,，/w,而/c,电子/n,邮件/n,中/f,的/u,某些/r,元素/n,则/d,构成/v,特征/n,。/w,虽然/c,电子/n,邮件/n,是/v,一种/mq,会/v, ,不断/d,增加/v,的/u,文本/n,，/w,但/c,我们/r,同样/d,也/d,可以/v,对/p,新闻/n,报道/v,、/w,用户/n,留言/v,、/w,政府/n,公文/n,等/u,其他/r,任意/d,类型/n,的/u,文本/n,进行/v,分类/vn,。/w,我们/r,可以/v,观察/v,文档/n,中/f,出现/v,的/u,词/n,，/w,并/c,把/p,每个/r,词/n,的/u,出现/v,或者/c,不/d,出/v, ,现/tg,作为/v,一个/m,特征/n,，/w,这样/r,得到/v,的/u,特征/n,数目/n,就/d,会/v,跟/p,词汇表/n,中/f,的/u,词目/nw,一样/u,多/a,。/w,朴素/a,贝叶斯/nr,是/v,上节/t,介绍/v,的/u,贝叶斯分类器/nw,的/u,一个/m,扩展/v,，/w,是/v,用于/v,文档/n,分类/vn,的/u,常用/a,算法/n,。/w,使用/v,每个/r,词/n,作为/v,特征/n,并/c,观察/v,它们/r,是否/v,出现/v,，/w,这样/r,得到/v,的/u,特征/n,数目/n,会/v,有/v,多少/r,呢/y,？/w,针对/p,的/u,是/v,哪/r,一种/mq,人类/n,语言/n,呢/y,？/w,当然/d,不止/v,一种/mq,语言/n,。/w,据/p,估计/v,，/w,仅/d,在/p,英语/nz,中/f,，/w,单词/n,的/u,总数/n,就/d,有/v,500000/m,之/u,多/a,。/w,为了/p,能/v,进行/v,英文/nz,阅读/v,，/w,估计/v,需要/v,掌握/v,数千/nw,单词/n,。/w,所谓/v,独立/v,,/w,指/v,的/u,是/v,统计/v,意义/n,上/f,的/u,独立/v,，/w,即/v,一个/m,特征/n,或者/c,单词/n,出现/v,的/u,可能性/n,与/p,它/r,和/c,其他/r,单词/n,相邻/v,没有/v,关系/n,。/w,这个/r,假设/v,正是/v,朴素/a,贝叶斯分类器/nw,中/f,朴素/a,一/m,词/n,的/u,含义/n,,/w,朴素/a,贝叶斯/nr,分类器/nw,中/f,的/u,另/r,一个/m,假设/v,是/v,，/w,每个/r,特征/n,同等/b,重要/a,./w,算法/n,一般/a,流程/n,1/m,./w,数据/n,的/u,收集/v,2/m,./w,数据/n,的/u,准备/v,：/w,数/m,值型/nw,或/c,布尔型/nr,3/m,./w,分析/vn,数据/n,4/m,./w,训练/vn,算法/n,：/w,计算/v,不同/a,的/u,独立/v,特征/n,的/u,条件/n,概率/n,5/m,./w,测试/vn,算法/n,：/w,计算/v,错误/n,率/v,6/m,./w,使用/v,算法/n,：/w,以/p,实际/n,应用/vn,为/p,驱动/vn,朴素/a,贝叶斯伪代码/nw,1/m,./w,计算/v,各个/r,独立/v,特征/n,在/p,各个/r,分类/vn,中/f,的/u,条件/n,概率/n,2/m,./w,计算/v,各/r,类别/n,出现/v,的/u,概率/n,3/m,./w,对于/p,特定/b,的/u,特征/n,输入/v,，/w,计算/v,其/r,相应/v,属于/v,特定/b,分类/vn,的/u,条件/n,概率/n,4/m,./w,选择/v,条件/n,概率/n,最/d,大/a,的/u,类别/n,作为/v,该/r,输入/v,类别/n,进行/v,返回/v,五/m,、/w,准备/v,数据/n,：/w,从/p,文本/n,中/f,构建/v,词向量/nw,我们/r,将/d,把/p,文本/n,看成/v,单词/n,向量/n,或者/c,词条/n,向量/n,，/w,也就是说/l,将/d,句子/n,转换/v,为/p,向量/n,。/w,考虑/v,出现/v,在/p,所有/b,文档/n,中/f,的/u,所有/b,单词/n,，/w,再/d,决定/v,将/d,哪些/r,词纳/nw,人/n,词汇表/n,或者/c,说/v,所/u,要/v,的/u,词汇/n,集合/v,，/w,然后/c,必须/d,要/v,将/d,每/r,一篇/mq,文档/n,转换/v,为/p,词汇表/n,上/f,的/u,向量/n,。/w,词表/n,到/v,向量/n,的/u,转换/v,函数/n,：/w,1/m, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,2/m, ,postinglist/en,=/w,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,3/m, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,4/m, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,5/m, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,6/m, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,7/m, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,8/m, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,#,1/m, ,代表/n,侮辱/v,性词/nw,,/w, ,0/m, ,代表/n,正常/a,言论/n, ,9/m, ,return/en, ,postinglist/en,,/w,classvec/en, ,10/m, ,11/m, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,#,根据/p,数据集/nw,返回/v, ,关键/n,词汇/n,向/p,量/n, ,12/m, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,#, ,创建/v,空/a,的/u,集合/v, ,13/m, ,for/en, ,document/en, ,in/en, ,dataset/en,:/w, ,14/m, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#, ,操作符/n, ,|/w, ,用/p,来/v,求/v,两个/m,集合/v,的/u,并/c,集/vg, ,15/m, ,return/en, ,list/en,(/w,vocabset/en,)/w, ,#, ,返回/v, ,集合/v,中/f, ,所有/b,不/d,重复/v,的/u,关键词/n, ,16/m, ,17/m, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w,#, ,vocablist/en,=/w,词汇表/n, ,，/w,inputset/en, ,=/w, ,输入/v,的/u,文档/n, ,#,文档/n,词汇/n, ,转换/v, ,成/v,文档/n, ,向量/n, ,18/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,#, ,生成/vn,一个/m,值/n,为/p,0/m,，/w,长度/n,和/c,vocablist/en,一样/u,的/u,集合/v, ,19/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,20/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,21/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,22/m, ,else/en,:/w, ,print/en, ,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,23/m, ,return/en, ,returnvec/en, ,#, ,返回/v, ,输入/v,文档/n,inputset/en, ,的/u,向量/n,第一/m,个/q,函数/n,loaddataset/en,(/w,)/w,创建/v,了/u,一些/m,实验/vn,样本/n,。/w,该/r,函数/n,返回/v,的/u,第一/m,个/q,变量/n,是/v,进行/v,词条/n,切分/v,后/f,的/u,文档/n,集合/v,,/w,这些/r,文档/n,来自/v,斑点/n,犬/ng,爱好者/n,留言板/nw,。/w,这些/r,留言/v,文本/n,被/p,切分/v,成/v,一系列/mq,的/u,词条/n,集合/v,，/w,标点符号/n,从/p,文本/n,中/f,去掉/v,，/w,后面/f,会/v,探讨/v,文本/n,处理/v,的/u,细节/n,。/w,loaddataset/en,(/w, ,)/w,函数/n,返回/v,的/u,第二/m,个/q,变量/n,是/v,一个/m,类别/n,标签/n,的/u,集合/v,。/w,这里/r,有/v,两类/mq,，/w,侮辱性/n,和/c,非侮辱性/nw,。/w,这些/r,文本/n,的/u,类别/n,由/p,人工/n,标注/v,，/w,这些/r,标注/v,信息/n,用于/v,训练/vn,程序/n,以便/d,自动/d,检测/vn,侮辱性/n,留言/v,。/w,下/f,一个/m,函数/n,createvocablist/en,（/w,）/w,会/v,创建/v,一个/m,包含/v,在/p,所有/b,文档/n,中/f,出现/v,的/u,不/d,重复/v,词/n,的/u,列表/v,，/w,为此/l,使用/v,了/u,python/en, ,的/u,set/en,数据/n,类型/n,。/w,将/d,词条/n,列表/v,输/v,给/p,set/en,构造/v,数/m,，/w,set/en,（/w,）/w,就/d,会/v,返回/v,一个/m,不/d,重复/v,词表/n,。/w,首先/d,，/w,创建/v,一个/m,空/a,集合/v,,/w, ,然后/c,将/d,每篇/r,文档/n,返回/v,的/u,新词/n,集合/v,添加/vn,到/v,该/r,集合/v,中/f,。/w,操作/v,符丨/nw,用于/v,求/v,两个/m,集合/v,的/u,并/c,集/vg,，/w,这/r,也/d,是/v,一个/m,按位/nw,或/c,（/w,or/en,)/w, ,操作符/n,（/w,参见/v,附录/n,0/m,）/w, ,。/w,在/p,数学/n,符号/n,表示/v,上/f,，/w,按位/nw,或/c,操作/v,与/p,集合/v,求/v,并/c,操作/v,使用/v,相同/a,记号/n,。/w,获得/v,词汇表/n,后/f,，/w,便/d,可以/v,使用/v,函数/n,setofwords/en,2/m,vec/en,（/w,）/w,，/w,该/r,函数/n,的/u,输人/n,参数/n,为/p,词汇表/n,及/c,某个/r,文档/n,，/w,输出/v,的/u,是/v,文档/n,向量/n,，/w,向量/n,的/u,每/r,一/m,元素/n,为/p,1/m,或/c,0/m,，/w,分别/d,表示/v,词汇表/n,中/f,的/u,单词/n,在/p,输/v,人文/n,档/q,中/f,是否/v,出现/v,。/w,函数/n,首先/d,创建/v,一个/m,和/c,词汇/n,表/n,等/u,长/a,的/u,向量/n,，/w,并/c,将/d,其/r,元素/n,都/d,设置/v,为/p,0/m, ,。/w,接着/c,，/w,遍历/nw,文档/n,中/f,的/u,所有/b,单词/n,，/w,如果/c,出现/v,了/u,词汇表/n,中/f,的/u,单词/n,，/w,则/d,将/d,输出/v,的/u,文档/n,向/p,量/n,中/f,的/u,对应值/nw,设为/v,1/m,。/w,一切/r,都/d,顺利/ad,的/u,话/n,，/w,就/d,不/d,需要/v,检查/vn,某个/r,词/n,是否/v,还/d,vobalist/en,中/f,，/w,后边/f,可能/v,会/v,用/p,到/v,这/r,一/m,操作/v,。/w,测试/vn,代码/n,：/w,1/m, ,>,>,>, ,listopost/en,,/w,listclasses/en,=/w,bayes/en,./w,loaddataset/en,(/w,)/w, ,2/m, ,>,>,>, ,listopost/en, ,3/m, ,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,4/m, ,>,>,>, ,listclasses/en, ,5/m, ,[/w,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,]/w, ,6/m, ,>,>,>, ,myvocablist/en,=/w,bayes/en,./w,createvocablist/en,(/w,listopost/en,)/w, ,7/m, ,>,>,>, ,myvocablist/en, ,8/m, ,[/w,'/w,garbage/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,please/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,maybe/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,quit/en,'/w,,/w, ,'/w,mr/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,cute/en,'/w,]/w, ,9/m, ,#,检查/vn,上述/b,的/u,词表/n,发现/v,，/w,这里/r,不/d,会/v,出现/v,重复/v,的/u,单词/n, ,10/m, ,>,>,>, ,bayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,listopost/en,[/w,0/m,]/w,)/w,#, ,把/p,文档/n,转换/v,成/v,向/p,理/n, ,11/m, ,[/w,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,]/w, ,12/m, ,>,>,>, ,bayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,listopost/en,[/w,3/m,]/w,)/w,#, ,把/p,文档/n,转换/v,成/v,向/p,理/n, ,13/m, ,[/w,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,]/w,六/m,、/w,训练/vn,算法/n,：/w,从/p,词向量/nw,计算/v,概率/n,前面/f,介绍/v,了/u,如何/r,将/d,一组/mq,单词/n,转换/v,为/p,一组/mq,数字/n,，/w,接下来/l,看看/v,如何/r,使用/v,这些/r,数字/n,计算/v,概率/n,。/w,现在/t,已经/d,知道/v,一个/m,词/n,是否/v,出现/v,在/p,一篇/mq,文档/n,中/f,，/w,也/d,知道/v,该/r,文档/n,所/u,属/v,的/u,类别/n,。/w,还/d,记得/v,前面/f,提到/v,的/u,贝叶斯/nr,准则/n,？/w,我们/r,重写/v,贝叶斯/nr,准则/n,，/w,将/d,之前/f,的/u,x/en,、/w,y/en,替换/v,为/p,w/en,。/w,粗体/nw,w/en,表示/v,这/r,是/v,一个/m,向量/n,，/w,即/v,它/r,由/p,多/a,个/q,数值/n,组成/v,。/w,在/p,这个/r,例子/n,中/f,，/w,数值/n,个数/n,与/p,词汇表/n,中/f,的/u,词/n,个数/n,相同/a,。/w,我们/r,将/d,使用/v,上述/b,公式/n,，/w,对/p,每个/r,类/q,计算/v,该值/nw,，/w,然后/c,比较/d,这/r,两个/m,概率/n,值/n,的/u,大小/n,。/w,如何/r,计算/v,呢/y,？/w,首先/d,可以/v,通过/p,类别/n,i/en,（/w,侮辱性/n,留言/v,或/c,非侮辱性/nw,留言/v,）/w,中/f,文档/n,数/m,除/p,以/p,总/b,的/u,文档/n,数/m,来/v,计算/v,概率/n,p/en,(/w,ci/en,)/w,。/w,接下来/l,计算/v,p/en,(/w,w/en,|/w,ci/en,)/w,，/w,这里/r,就要/d,用/p,到/v,朴素/a,贝叶斯/nr,假设/v,。/w,如果/c,将/d,w/en,展开/v,为/p,一个个/nw,独立/v,特征/n,，/w,那么/r,就/d,可以/v,将/d,上述/b,概率/n,写作/v,p/en,(/w,w/en,0/m,,/w,w/en,1/m,,/w,w/en,2/m,./w,./w,wn/en,|/w,ci/en,)/w,。/w,这里/r,假设/v,所有/b,词/n,都/d,互相/d,独立/v,，/w,该/r,假设/v,也/d,称作/v,条件/n,独立性/n,假设/v,，/w,它/r,意味/n,着/u,可以/v,使用/v,p/en,(/w,w/en,0/m,|/w,ci/en,)/w,p/en,(/w,w/en,1/m,|/w,ci/en,)/w,p/en,(/w,w/en,2/m,|/w,ci/en,)/w,./w,./w,./w,p/en,(/w,wn/en,|/w,ci/en,)/w,来/v,计算/v,上述/b,概率/n,，/w,这/r,就/d,极大/a,地/u,简化/v,了/u,计算/v,的/u,过程/n,。/w,该/r,函数/n,的/u,伪代码/nw,如下/v,：/w,计算/v,每个/r,类别/n,中/f,的/u,文档/n,数目/n,对/p,每篇/r,训练/vn,文档/n,：/w,对/p,每个/r,类别/n,：/w,如果/c,词条/n,出现/v,文档/n,中/f,―/w,增加/v,该/r,词条/n,的/u,计/v,数值/n,增加/v,所有/b,词条/n,的/u,计/v,数值/n,对/p,每个/r,类别/n,：/w,对/p,每个/r,词条/n,：/w,将/d,该/r,词条/n,的/u,数目/n,除/p,以/p,总/b,词条/n,数目/n,得到/v,条件/n,概率/n,还/d,回/v,每个/r,类别/n,的/u,条件/n,概率/n,朴素/a,贝叶斯分类器/nw,训练/vn,函数/n,：/w,1/m, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w, ,#,trainmatrix/en, ,所有/b,文档/n,的/u,向量/n,形式/n, ,traincategory/en, ,文档/n,的/u,分类/vn, ,类别/n,向/p,量/n, ,#,计算/v,不同/a,分类/vn,的/u,文档/n,概率/n,，/w,即/v, ,p/en,(/w,w/en,|/w,c/en,1/m,)/w, ,p/en,(/w,w/en,|/w,c/en,0/m,)/w, ,2/m, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,#, ,numtraindocs/en, ,=/w, ,总/b,文档/n,数/m, ,3/m, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,#, ,numwords/en,=/w, ,词汇/n,长度/n, ,4/m, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,#, ,计算/v, ,分类/vn,=/w,1/m, ,的/u,文档/n,比例/n, ,p/en,(/w,1/m,)/w,的/u,概率/n,，/w,这/r,是/v,一个/m,二/m,分类/vn,的/u,问题/n, ,p/en,(/w,0/m,)/w,=/w,1/m,-/w,p/en,(/w,1/m,)/w, ,5/m, ,p/en,0/m,num/en, ,=/w, ,zeros/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,zeros/en,(/w,numwords/en,)/w, ,#,初始化/v,概率/n,，/w, ,分子/n, ,6/m, ,p/en,0/m,denom/en, ,=/w, ,0.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,0.0/m, ,#,定义/n,分/q,母/b, ,7/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,8/m, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,#,类别/n,为/p, ,1/m, ,9/m, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,#, ,分子/n,向/p,量/n,累计/v,相加/v, ,10/m, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w,#,分母/n, ,向量/n,之和/n, ,11/m, ,else/en,:/w, ,12/m, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,13/m, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,14/m, ,p/en,1/m,vect/en, ,=/w, ,p/en,1/m,num/en,//w,p/en,1/m,denom/en, ,#, ,当/p,类别/n,为/p, ,1/m, ,时/ng,，/w,计算/v,每个/r,文档/n,中/f,出现/v, ,词汇/n,的/u,概率/n, ,15/m, ,p/en,0/m,vect/en, ,=/w, ,p/en,0/m,num/en,//w,p/en,0/m,denom/en, ,#, ,16/m, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en,代码/n,函数/n,中/f,的/u,输入/v,参数/n,为/p,文档/n,矩阵/n,trainma/en,-/w,trix/en,，/w,以及/c,由/p,每篇/r,文档/n,类别/n,标签/n,所/u,构成/v,的/u,向量/n,train/en,-/w,category/en,。/w,首先/d,，/w,计算/v,文档/n,属于/v,侮辱性/n,文档/n,（/w,class/en,=/w,1/m,）/w,的/u,概率/n,，/w,即/v,p/en,(/w,1/m,)/w,。/w,因为/c,这/r,是/v,一个/m,二类/b,分类/vn,问题/n,，/w,所以/c,可以/v,通过/p,1/m,-/w,p/en,(/w,1/m,)/w,得到/v,p/en,(/w,0/m,)/w,。/w,对于/p,多于/v,两类/mq,的/u,分类/vn,问题/n,，/w,则/d,需要/v,对/p,代码/n,稍加/v,修改/v,。/w,计算/v,p/en,(/w,wi/en,|/w,c/en,1/m,)/w,和/c,p/en,(/w,wi/en,|/w,c/en,0/m,)/w,，/w,需要/v,初始化/v,程序/n,中/f,的/u,分子/n,变量/n,和/c,分母/n,变量/n,①,。/w,由于/c,w/en,中/f,元素/n,如此/r,众多/m,，/w,因此/c,可以/v,使用/v,numpy/en,数/m,组/q,快速/d,计算/v,这些/r,值/n,。/w,上述/b,程序/n,中/f,的/u,分母/n,变量/n,是/v,一个/m,元素/n,个数/n,等于/v,词汇/n,表/n,大小/n,的/u,numpy/en,数/m,组/q,。/w,在/p,for/en,循环/vn,中/f,，/w,要/v,遍历/nw,训练/vn,集/vg,trainmatrix/en,中/f,的/u,所有/b,文档/n,。/w,一旦/d,某个/r,词语/n,（/w,侮辱性/n,或/c,正常/a,词/n,语/ng,）/w,在/p,某/r,一/m,文档/n,中/f,出现/v,，/w,则/d,该词/nw,对应/v,的/u,个数/n,（/w,p/en,1/m,num/en,或者/c,p/en,0/m,num/en,）/w,就/d,加/v,1/m,，/w,而且/c,在/p,所有/b,的/u,文档/n,中/f,，/w,该/r,文档/n,的/u,总/b,词数/n,也/d,相应/v,加/v,1/m,②,。/w,对于/p,两个/m,类别/n,都/d,要/v,进行/v,同样/d,的/u,计算/v,处理/v,。/w,最后/f,，/w,对/p,每个/r,元素/n,除/p,以/p,该/r,类别/n,中/f,的/u,总/b,词/n,数/m,③,。/w,利用/v,numpy/en,可以/v,很/d,好/a,实现/v,，/w,用/p,一个/m,数组/n,除/p,以/p,浮/v,点数/n,即可/v,，/w,若/c,使用/v,常规/n,的/u,python/en,列表/v,则/d,难以/d,完成/v,这种/r,任务/n,，/w,读者/n,可以/v,自己/r,尝试/vn,一下/m,。/w,最后/f,，/w,函数/n,会/v,返回/v,两个/m,向量/n,和/c,一个/m,概率/n,。/w,接下来/l,试验/vn,一下/m,，/w,在/p,python/en,提示符/n,下/f,输入/v,：/w,1/m, ,>,>,>, ,listoposts/en,,/w,listclasses/en,=/w,bayes/en,./w,loaddataset/en,(/w,)/w, ,2/m, ,3/m, ,>,>,>, ,listoposts/en, ,4/m, ,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,5/m, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,6/m, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,7/m, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,8/m, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,9/m, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,10/m, ,>,>,>, ,listclasses/en, ,11/m, ,[/w,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,]/w, ,12/m, ,13/m, ,>,>,>, ,myvocablist/en,=/w,bayes/en,./w,createvocablist/en,(/w,listoposts/en,)/w, ,14/m, ,#,至此/d,我们/r,构建/v,了/u,一个/m,包含/v,所有/b,词/n,的/u,列表/v,myvocablist/en,。/w, ,15/m, ,>,>,>, ,myvocablist/en, ,16/m, ,[/w,'/w,garbage/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,please/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,maybe/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,quit/en,'/w,,/w, ,'/w,mr/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,cute/en,'/w,]/w, ,17/m, ,18/m, ,>,>,>, ,trainmat/en,=/w,[/w,]/w, ,19/m, ,>,>,>, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w, ,20/m, ,trainmat/en,./w,append/en,(/w,bayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,postindoc/en,)/w,)/w, ,21/m, ,22/m, ,>,>,>, ,trainmat/en, ,23/m, ,[/w,[/w,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,]/w,,/w, ,24/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,25/m, ,[/w,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,]/w,,/w, ,26/m, ,[/w,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,27/m, ,[/w,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,28/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,]/w,]/w, ,29/m, ,#,该/r,for/en,循环/vn,使用/v,词向量/nw,来/v,填充/v,trainmat/en,列表/v,。/w,下面/f,给/p,出/v,属于/v,侮辱性/n,文档/n,的/u,概率/n,以及/c,两个/m,类别/n,的/u,概率/n,向/p,量/n, ,30/m, ,>,>,>, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,=/w,bayes/en,./w,trainnb/en,0/m,(/w,trainmat/en,,/w,listclasses/en,)/w, ,31/m, ,>,>,>, ,pab/en, ,#,这/r,就/d,是/v,任意/d,文档/n,属于/v,侮辱性/n,文档/n,的/u,概率/n,。/w, ,32/m, ,0.5/m, ,33/m, ,>,>,>, ,p/en,0/m,v/en, ,34/m, ,array/en,(/w,[/w, ,0/m,./w, ,,/w, ,0.04166667/m,,/w, ,0.125/m, ,,/w, ,0.04166667/m,,/w, ,0/m,./w, ,,/w, ,35/m, ,0/m,./w, ,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,36/m, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.08333333/m,,/w, ,0/m,./w, ,,/w, ,37/m, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.04166667/m,,/w, ,38/m, ,0/m,./w, ,,/w, ,0.04166667/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.04166667/m,,/w, ,39/m, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,0.04166667/m,,/w, ,40/m, ,0.04166667/m,,/w, ,0.04166667/m,]/w,)/w, ,41/m, ,>,>,>, ,p/en,1/m,v/en, ,42/m, ,array/en,(/w,[/w, ,0.05263158/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.10526316/m,,/w, ,0.05263158/m,,/w, ,43/m, ,0.05263158/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.05263158/m,,/w, ,44/m, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0.05263158/m,,/w, ,0.05263158/m,,/w, ,45/m, ,0.15789474/m,,/w, ,0.05263158/m,,/w, ,0.05263158/m,,/w, ,0.05263158/m,,/w, ,0/m,./w, ,,/w, ,46/m, ,0.10526316/m,,/w, ,0/m,./w, ,,/w, ,0.05263158/m,,/w, ,0.05263158/m,,/w, ,0/m,./w, ,,/w, ,47/m, ,0/m,./w, ,,/w, ,0.05263158/m,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,0/m,./w, ,,/w, ,48/m, ,0/m,./w, ,,/w, ,0/m,./w, ,]/w,)/w,首先/d,，/w,我们/r,发现/v,文档/n,属于/v,侮辱/v,类/q,的/u,概率/n,pab/en,为/p,0.5/m,，/w,该值/nw,是/v,正确/a,的/u,。/w,接下来/l,，/w,看/v,一/m,看/v,在/p,给定/vn,文档/n,类别/n,条件/n,下/f,词汇表/n,中/f,单词/n,的/u,出现/v,概率/n,，/w,看看/v,是否/v,正确/a,。/w,词汇表/n,中/f,的/u,第一/m,个/q,词/n,是/v,cute/en,，/w,其/r,在/p,类别/n,0/m,中/f,出现/v,1次/mq,，/w,而/c,在/p,类别/n,1/m,中/f,从未/d,出现/v,。/w,对应/v,的/u,条件/n,概率/n,分别/d,为/p,0.041/m, ,666/m, ,67/m,与/p,0.0/m,。/w,该/r,计算/v,是/v,正确/a,的/u,。/w,我们/r,找/v,找/v,所有/b,概/d,率/v,中/f,的/u,最大值/nz,，/w,该值/nw,出现/v,在/p,p/en,(/w,1/m,)/w,数/m,组/q,第/m,26个/m,下标/n,位置/n,，/w,大小/n,为/p,0.157/m, ,89474/m,。/w,在/p,myvocablist/en,的/u,第/m,26个/m,下标/n,位置/n,上/f,可以/v,查/v,到/v,该/r,单词/n,是/v,stupid/en,。/w,这/r,意味/n,着/u,stupid/en,是/v,最/d,能/v,表征/v,类别/n,1/m,（/w,侮辱性/n,文档/n,类/q,）/w,的/u,单词/n,。/w,七/m,、/w,测试/vn,算法/n,：/w,根据/p,现实/n,情况/n,修改/v,分类器/nw,利用/v,贝叶斯分类器/nw,对/p,文档/n,进行/v,分类/vn,时/ng,，/w,要/v,计算/v,多/a,个/q,概率/n,的/u,乘积/n,以/p,获得/v,文档/n,属于/v,某个/r,类别/n,的/u,概率/n,，/w,即/v,计算/v,p/en,(/w,w/en,0/m,|/w,1/m,)/w,p/en,(/w,w/en,1/m,|/w,1/m,)/w,p/en,(/w,w/en,2/m,|/w,1/m,)/w,。/w,如果/c,其中/r,一个/m,概率/n,值/n,为/p,0/m,，/w,那么/r,最后/f,的/u,乘积/n,也/d,为/p,0/m,。/w,为/p,降低/v,这种/r,影响/vn,，/w,可以/v,将/d,所有/b,词/n,的/u,出现/v,数/m,初始/b,化为/v,1/m,，/w,并/c,将/d,分/q,母/b,初/f,始/vg,化为/v,2/m,。/w,在/p,文本/n,编辑器/n,中/f,打开/v,bayes/en,./w,py/en,文件/n,，/w,并/c,将/d,trainnb/en,0/m,(/w,)/w,的/u,第/m,4行/mq,和/c,第/m,5行/mq,修改/v,为/p,：/w,p/en,0/m,num/en,=/w,ones/en,(/w,numwords/en,)/w,;/w,p/en,1/m,num/en,=/w,ones/en,(/w,numwords/en,)/w,p/en,0/m,denom/en,=/w,2.0/m,;/w,p/en,1/m,denom/en,=/w,2.0/m,另/r,一个/m,遇到/v,的/u,问题/n,是/v,下/f,溢/v,出/v,，/w,这/r,是/v,由于/c,太/d,多/a,很/d,小/a,的/u,数/m,相/d,乘/v,造成/v,的/u,。/w,当/p,计算/v,乘积/n,p/en,(/w,w/en,0/m,|/w,ci/en,)/w,p/en,(/w,w/en,1/m,|/w,ci/en,)/w,p/en,(/w,w/en,2/m,|/w,ci/en,)/w,./w,./w,./w,p/en,(/w,wn/en,|/w,ci/en,)/w,时/ng,，/w,由于/c,大部分/m,因子/n,都/d,非常/d,小/a,，/w,所以/c,程序/n,会/v,下/f,溢/v,出/v,或者/c,得到/v,不/d,正确/a,的/u,答案/n,。/w,（/w,读者/n,可以/v,用/p,python/en,尝试/vn,相乘/v,许多/m,很/d,小/a,的/u,数/m,，/w,最后/f,四舍/mq,五/m,入/v,后/f,会/v,得到/v,0/m,。/w,）/w,一种/mq,解决/v,办法/n,是/v,对/p,乘/v,积取/nw,自然/d,对数/n,。/w,在/p,代数/n,中/f,有/v,ln/en,(/w,a/en,*/w,b/en,)/w, ,=/w,ln/en,(/w,a/en,)/w,+/w,ln/en,(/w,b/en,)/w,，/w,于是/c,通过/p,求/v,对数/n,可以/v,避免/v,下/f,溢/v,出/v,或者/c,浮点数/nz,舍/v,入/v,导致/v,的/u,错误/n,。/w,同时/c,，/w,采用/v,自然/d,对数/n,进行/v,处理/v,不/d,会/v,有/v,任何/r,损失/n,。/w,图/n, ,给/p,出/v,函数/n,f/en,(/w,x/en,)/w,与/p,ln/en,(/w,f/en,(/w,x/en,)/w,)/w,的/u,曲线/n,。/w,检查/vn,这/r,两条/mq,曲线/n,，/w,就/d,会/v,发现/v,它们/r,在/p,相同/a,区域/n,内/f,同时/c,增加/v,或者/c,减少/v,，/w,并且/c,在/p,相同点/n,上/f,取/v,到/v,极值/nz,。/w,它们/r,的/u,取值/v,虽然/c,不同/a,，/w,但/c,不/d,影响/vn,最终/d,结果/n,。/w,函数/n,f/en,(/w,x/en,)/w,与/p,ln/en,(/w,f/en,(/w,x/en,)/w,)/w,会/v,一块/s,增大/v,。/w,这/r,表明/v,想/v,求/v,函数/n,的/u,最大值/nz,时/ng,，/w,可以/v,使用/v,该/r,函数/n,的/u,自然/d,对数/n,来/v,替换/v,原/b,函数/n,进行/v,求解/v,通过/p,修改/v,return/en,前/f,的/u,两行/mq,代码/n,，/w,将/d,上述/b,做法/n,用/p,到/v,分类器/nw,中/f,：/w,p/en,1/m,vect/en,=/w,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w,p/en,0/m,vect/en,=/w,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w,修改/v,后/f,的/u, ,trainnb/en,0/m, ,代码/n,：/w,1/m, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w, ,2/m, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,3/m, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,4/m, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,5/m, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,#,change/en, ,to/en, ,ones/en,(/w,)/w, ,6/m, ,p/en,0/m,denom/en, ,=/w, ,2.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,#,change/en, ,to/en, ,2.0/m, ,7/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,8/m, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,9/m, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,10/m, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,11/m, ,else/en,:/w, ,12/m, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,13/m, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,14/m, ,p/en,1/m,vect/en, ,=/w, ,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w, ,#,change/en, ,to/en, ,log/en,(/w,)/w, ,15/m, ,p/en,0/m,vect/en, ,=/w, ,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w, ,#,change/en, ,to/en, ,log/en,(/w,)/w, ,16/m, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en,现在/t,已经/d,准备/v,好/a,构建/v,完整/a,的/u,分类器/nw,了/u,。/w,当/p,使用/v,numpy/en,向量/n,处理/v,功能/n,时/ng,，/w,这/r,一切/r,变/v,得/u,十分/d,简单/a,。/w,打开/v,文本/n,编辑器/n,，/w,将/d,下面/f,的/u,代码/n,添加/vn,到/v,bayes/en,./w,py/en,中/f,：/w,朴素/a,贝叶斯/nr,分类/vn,函数/n,1/m, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,#,根据/p, ,输入/v,的/u, ,文档/n, ,对/p,文档/n,进行/v,分类/vn, ,预测/v, ,p/en,(/w,w/en,|/w,c/en,0/m,)/w,=/w,p/en,0/m,vec/en, ,p/en,(/w,w/en,|/w,c/en,1/m,)/w,=/w,p/en,0/m,vec/en, ,2/m, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,#,element/en,-/w,wise/en, ,mult/en, ,3/m, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en,)/w, ,+/w, ,log/en,(/w,1.0/m, ,-/w, ,pclass/en,1/m,)/w, ,4/m, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,5/m, ,return/en, ,1/m, ,6/m, ,else/en,:/w, ,7/m, ,return/en, ,0/m, ,8/m, ,9/m, ,def/en, ,testingnb/en,(/w,)/w,:/w, ,10/m, ,listoposts/en,,/w,listclasses/en, ,=/w, ,loaddataset/en,(/w,)/w, ,11/m, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en,)/w, ,12/m, ,trainmat/en,=/w,[/w,]/w, ,13/m, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w, ,14/m, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,postindoc/en,)/w,)/w, ,15/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,listclasses/en,)/w,)/w, ,16/m, ,testentry/en, ,=/w, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w, ,17/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,18/m, ,print/en, ,(/w,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w,)/w, ,19/m, ,testentry/en, ,=/w, ,[/w,'/w,stupid/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w, ,20/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,21/m, ,print/en, ,(/w,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w,)/w,classifynb/en,代码/n,有/v,4个/m,输入/v,：/w,要/v,分类/vn,的/u,向量/n,vec/en,2/m,clas/en,-/w,sify/en,以及/c,使用/v,函数/n,trainnb/en,0/m,(/w,)/w,计算/v,得到/v,的/u,三个/m,概率/n,。/w,使用/v,numpy/en,的/u,数/m,组/q,来/v,计算/v,两个/m,向量/n,相乘/v,的/u,结果/n,①,。/w,这里/r,的/u,相乘/v,是/v,指/v,对应/v,元素/n,相乘/v,，/w,即/v,先/d,将/d,两个/m,向/p,量/n,中/f,的/u,第/m,1个/m,元素/n,相乘/v,，/w,然后/c,将/d,第/m,2个/m,元素/n,相乘/v,，/w,以此类推/l,。/w,接下来/l,将/d,词汇表/n,中/f,所有/b,词/n,的/u,对应值/nw,相加/v,，/w,然后/c,将/d,该值/nw,加/v,到/v,类别/n,的/u,对数/n,概率/n,上/f,。/w,最后/f,，/w,比较/d,类别/n,的/u,概率/n,返回/v,大概率/nw,对应/v,的/u,类别/n,标签/n,。/w,下面/f,来/v,看看/v,实际/n,结果/n,。/w,将/d,程序/n,清单/n,4/m,-/w,3/m,中/f,的/u,代码/n,添加/vn,之后/f,，/w,在/p,python/en,提示符/n,下/f,输入/v,：/w,1/m, ,>,>,>, ,imp/en,./w,reload/en,(/w,bayes/en,)/w, ,2/m, ,</w,module/en, ,'/w,bayes/en,'/w, ,from/en, ,'/w,f/en,:/w,\/w,\/w,99999/m,_,算法/n,\/w,\/w,《/w,机器/n,学习/v,实战/n,》/w,源代码/n,\/w,\/w,machinelearninginaction/en,\/w,\/w,ch/en,04/m,\/w,\/w,bayes/en,./w,py/en,'/w,>, ,3/m, ,>,>,>, ,bayes/en,./w,testingnb/en,(/w,)/w, ,4/m, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w, ,classified/en, ,as/en,:/w, ,0/m, ,5/m, ,[/w,'/w,stupid/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w, ,classified/en, ,as/en,:/w, ,1/m,八/m,、/w,文档/n,词袋/nw,模型/n,目前/t,为止/u,，/w,我们/r,将/d,每个/r,词/n,的/u,出现/v,与否/u,作为/v,一个/m,特征/n,，/w,这/r,可以/v,被/p,描述/v,为/p,词集/nw,模型/n,（/w,set/en,-/w,of/en,-/w,words/en, ,model/en,）/w,。/w,如果/c,一个/m,词/n,在/p,文档/n,中/f,出现/v,不止/v,一次/mq,，/w,这/r,可能/v,意味/n,着/u,包含/v,该词/nw,是否/v,出现/v,在/p,文档/n,中/f,所/u,不/d,能/v,表达/v,的/u