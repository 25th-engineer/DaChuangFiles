假期/t,结束/v,，/w,你/r,的/u,状态/n,有/v,没/d,有/v,回归/v,？/w,那么/r,，/w,放空/v,脑袋/n,后/f,，/w,先/d,来/v,学习/v,学习/v,，/w,欢迎/v,大家/r,继续/v,关注/v,腾讯云/nw,技术/n,社区/n,。/w,作者/n,：/w,赵成龙/nr,这/r,是/v,一篇/mq,很/d,难/a,写/v,的/u,文章/n,，/w,因为/c,我/r,希望/v,这/r,篇/q,文章/n,能/v,对/p,大家/r,有所/v,帮助/v,。/w,我/r,不/d,会/v,给/p,大家/r,介绍/v,机器/n,学习/v,，/w,数据/n,挖掘/v,的/u,行业/n,背景/n,，/w,也/d,不/d,会/v,具体/a,介绍/v,逻辑/n,回归/v,，/w,svm/en,，/w,gbdt/en,，/w,神经/n,网络/n,等/u,学习/v,算法/n,的/u,理论/n,依据/n,和/c,数学/n,推导/vn,，/w,本文/r,更/d,多/a,的/u,是/v,在/p,流程化/n,上/f,帮助/v,大家/r,快速/d,的/u,入门/v,机器/n,学习/v,和/c,数据/n,建模/vn,。/w,本文/r,主要/b,分为/v,四个/m,部分/n,（/w,限于/v,时间/n,关系/n,会/v,分为/v,上下/f,两篇/mq,）/w,：/w,上/f,篇/q,：/w,准备/v,篇/q,，/w,主要/b,涉及/v,环境/n,搭建/v,以及/c,pandas/en,基本/a,知识/n,。/w,应用/vn,篇/q,，/w,我/r,会/v,以/p,kaggle/en,上/f,的/u,titanic/en,为/p,例/n,，/w,从/p,数据源/nz,获取/v,，/w,数据/n,清洗/vn,，/w,特征/n,处理/v,，/w,模型/n,选择/v,，/w,模型/n,输出/v,与/p,运用/v,。/w,下篇/n,：/w,优化/v,篇/q,，/w,介绍/v,了/u,几/m,种/q,优化/v,的/u,方法/n,。/w,思考/v,篇/q,，/w,提出/v,几/m,个/q,困扰/v,我/r,的/u,问题/n,，/w,希望/v,能/v,得到/v,大家/r,的/u,帮助/v,吧/y,。/w,一/m, ,准备/v,篇/q,1/m,环境/n,搭建/v,整个/b,sklearn/en,的/u,实验/vn,环境/n,是/v,：/w,python/en, ,2.7/m, ,+/w, ,pycharm/en, ,+/w, ,anaconda/en,。/w,2/m, ,pandas/en,基础/n,这里/r,只能/v,大家/r,介绍/v,下面/f,会/v,用/p,到/v,的/u,pandas/en,知识/n,，/w,有/v,兴趣/n,的/u,可以/v,去/v,具体/a,的/u,学习/v,。/w,给/p,大家/r,推荐/v,一本/mq,参考书/n,：/w,《/w,python/en, ,for/en, ,data/en, ,analysis/en,》/w,。/w,有/v,基础/n,的/u,可以/v,直接/ad,跳/v,到/v,应用/vn,篇/q,。/w,pandas/en,主要/b,会/v,用/p,到/v,series/en, ,和/c,dataframe/en,两种/mq,数据/n,结构/n,。/w,series/en,像/v,是/v,一维/mq,的/u,数组/n,，/w,而/c,dataframe/en,更/d,像/v,是/v,一种/mq,二维/mq,的/u,表/n,结构/n,。/w,series/en,的/u,构造/v,方法/n,：/w,label/en,=/w,[/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,data/en, ,=/w, ,pd/en,./w,series/en,(/w,data/en,=/w,label/en,,/w,index/en,=/w,[/w,'/w,a/en,'/w,,/w,'/w,b/en,'/w,,/w,'/w,c/en,'/w,,/w,'/w,d/en,'/w,,/w,'/w,e/en,'/w,]/w,,/w,dtype/en,=/w,int/en,,/w,name/en,=/w,"/w,label/en,"/w,)/w, ,print/en, ,dataseries/en,取/v,数据/n,，/w,通过/p,index/en,取数/nw,data/en,[/w,'/w,a/en,'/w,]/w, ,data/en,[/w,[/w,'/w,a/en,'/w,,/w,'/w,b/en,'/w,]/w,]/w,dataframe/en,的/u,构造/v,（/w,1/m,）/w,以/p,字典/n,的/u,形式/n,构造/v,frame/en, ,=/w, ,pd/en,./w,dataframe/en,(/w,{/w,'/w,name/en,'/w,:/w,[/w,'/w,time/en,'/w,,/w,'/w,jack/en,'/w,,/w,'/w,lily/en,'/w,]/w,,/w,'/w,age/en,'/w,:/w,[/w,20/m,,/w,30/m,,/w,12/m,]/w,,/w,"/w,weight/en,"/w,:/w,[/w,56.7/m,,/w,64.0/m,,/w,50.0/m,]/w,}/w,)/w,（/w,2/m,）/w,由/p,dataframe/en, ,构建/v,dataframeframe/en,1/m, ,=/w, ,pd/en,./w,dataframe/en,(/w,frame/en,,/w,columns/en,=/w,[/w,"/w,name/en,"/w,,/w,"/w,age/en,"/w,]/w,)/w,从/p,frame/en,中/f,读取/v,了/u,两列/mq,构成/v,新/a,的/u,dataframe/en,。/w,dataframe/en,的/u,操作/v,1/m, ,增加/v,列/v,frame/en,1/m,[/w,"/w,friends/en,_,num/en,"/w,]/w,=/w,[/w,10/m,,/w,12/m,,/w,14/m,]/w,2/m, ,删除/v,列/v,frame/en,2/m, ,=/w, ,frame/en,1/m,./w,drop/en,(/w,[/w,"/w,name/en,"/w,,/w,"/w,age/en,"/w,]/w,,/w,axis/en,=/w,1/m,)/w,3/m, ,查找/v,数据/n,行/v,frame/en,1/m,[/w,frame/en,1/m,[/w,"/w,friends/en,_,num/en,"/w,]/w,>,10/m,]/w,结果/n,如下/v,：/w,dataframe/en,的/u,统计/v,方法/n,1/m, ,apply/en, ,配合/v,lambda/en, ,处理/v,列/v,，/w,如/v,将/d,frame/en,1/m,的/u,age/en,列/v,进行/v,分段/vn,。/w,frame/en,1/m,[/w,"/w,age/en,_,group/en,"/w,]/w, ,=/w, ,frame/en,1/m,[/w,"/w,age/en,"/w,]/w,./w,apply/en,(/w,lambda/en, ,x/en,:/w, ,0/m, ,if/en, ,x/en, ,</w, ,20/m, ,else/en, ,1/m,)/w,2/m, ,describe/en,输出/v,统计/v,信息/n,，/w,非常/d,强大/a,frame/en,1/m,./w,describe/en,(/w,)/w,给/p,出/v,了/u,8个/m,统计量/nw,，/w,对/p,我们/r,的/u,数据/n,处理/v,特别/d,有用/a,。/w,有/v,个/q,问题/n,，/w,直接/ad,使用/v,describe/en,方法/n,只能/v,统计/v,数值/n,类/q,的/u,列/v,，/w,对于/p,字符/n,类/q,的/u,变量/n,没有/v,统计/v,。/w,加个/nw,参数/n,就/d,行/v,。/w,frame/en,1/m,./w,describe/en,(/w,include/en,=/w,[/w,'/w,o/en,'/w,]/w,)/w,3/m, ,缺失/n,值/n,处理/v,pandas/en, ,对/p,缺/v,失值/nw,一般/a,填充/v,nan/en,。/w,#,以/p,0/m,填充/v,缺/v,失值/nw, ,frame/en,1/m,./w,fillna/en,(/w,0/m,)/w, ,#,丢掉/v,任何/r,包含/v,nan/en,的/u,行/v, ,frame/en,1/m,./w,dropna/en,(/w,)/w, ,#,删除/v,全/a,为/p,nan/en,的/u,行/v, ,frame/en,1/m,./w,dropna/en,(/w,how/en,=/w,"/w,all/en,"/w,)/w,二/m, ,应用/vn,篇/q,1/m, ,数据/n,读取/v,本例/nw,以/p,titanic/en,作为/v,数据源/nz,。/w,大家/r,可以/v,在/p,附件/n,获取/v,到/v,数据/n,。/w,data/en, ,=/w, ,pd/en,./w,dataframe/en,(/w,pd/en,./w,read/en,_,csv/en,(/w,train/en,_,path/en,)/w,)/w, ,data/en,_,test/en, ,=/w, ,pd/en,./w,dataframe/en,(/w,pd/en,./w,read/en,_,csv/en,(/w,test/en,_,path/en,)/w,)/w, ,data/en,_,test/en, ,=/w, ,data/en,_,test/en,[/w,[/w,"/w,pclass/en,"/w,,/w,"/w,name/en,"/w,,/w,"/w,sex/en,"/w,,/w,"/w,age/en,"/w,,/w,"/w,sibsp/en,"/w,,/w,"/w,parch/en,"/w,,/w,"/w,ticket/en,"/w,,/w,"/w,fare/en,"/w,,/w,"/w,cabin/en,"/w,,/w,"/w,embarked/en,"/w,]/w,]/w, ,x/en, ,=/w, ,data/en,[/w,[/w,"/w,pclass/en,"/w,,/w,"/w,name/en,"/w,,/w,"/w,sex/en,"/w,,/w,"/w,age/en,"/w,,/w,"/w,sibsp/en,"/w,,/w,"/w,parch/en,"/w,,/w,"/w,ticket/en,"/w,,/w,"/w,fare/en,"/w,,/w,"/w,cabin/en,"/w,,/w,"/w,embarked/en,"/w,]/w,]/w, ,y/en, ,=/w, ,data/en,[/w,[/w,"/w,survived/en,"/w,]/w,]/w, ,print/en, ,x/en,./w,describe/en,(/w,)/w, ,print/en, ,x/en,./w,describe/en,(/w,include/en,=/w,[/w,'/w,o/en,'/w,]/w,)/w, ,print/en, ,data/en,_,test/en,./w,describe/en,(/w,)/w, ,print/en, ,data/en,_,test/en,./w,describe/en,(/w,include/en,=/w,[/w,'/w,o/en,'/w,]/w,)/w,数据/n,的/u,初始/b,统计/v,信息/n,：/w,2/m, ,数据/n,清洗/vn,1/m, ,缺失/n,值/n,处理/v,。/w,age/en,和/c,embarked/en,列/v,存在/v,少量/m,缺/v,失值/nw,，/w,分别/d,处理/v,。/w,#,用/p,众数/nw,填充/v,缺/v,失值/nw, ,data/en,_,set/en,[/w,"/w,embarked/en,"/w,]/w,=/w,data/en,_,set/en,[/w,"/w,embarked/en,"/w,]/w,./w,fillna/en,(/w,'/w,s/en,'/w,)/w, ,#,用/p,均值/n,填充/v,age/en,缺失/n,值/n, ,data/en,_,set/en,[/w,"/w,age/en,"/w,]/w,=/w,data/en,_,set/en,[/w,"/w,age/en,"/w,]/w,./w,fillna/en,(/w,data/en,_,set/en,[/w,"/w,age/en,"/w,]/w,./w,mean/en,(/w,)/w,)/w,2/m, ,删除/v,缺失率/nw,较/d,大/a,的/u,列/v,（/w,初步/d,处理/v,时/ng,）/w,cabin/en,列/v,的/u,缺失率/nw,达到/v,了/u,75%/mq,，/w,删除/v,改列/nw,。/w,data/en,_,set/en, ,=/w, ,data/en,_,set/en,./w,drop/en,(/w,[/w, ,"/w,cabin/en,"/w,]/w,,/w, ,axis/en,=/w,1/m,)/w,3/m, ,特征/n,处理/v,特征/n,处理/v,是/v,基于/p,具体/a,的/u,数据/n,的/u,，/w,所以/c,在/p,特征/n,处理/v,之前/f,要/v,对/p,数据/n,做/v,充分/ad,的/u,理解/v,。/w,特征/n,处理/v,没有/v,固定/a,方法/n,之/u,说/v,，/w,主要/b,靠/v,个人/n,的/u,经验/n,与/p,观察/v,，/w,通过/p,不断/d,的/u,尝试/vn,和/c,变换/v,，/w,以/p,期望/v,挖掘/v,出/v,较/d,好/a,的/u,特征/n,变量/n,。/w,所以/c,说/v,，/w,特征/n,处理/v,是/v,模型/n,建立/v,过程/n,中/f,最/d,耗时/v,和/c,耗神/nw,的/u,工作/vn,。/w,1/m,）/w,单变量/nr,特征/n,提取/v,。/w,#,根据/p,name/en,的/u,长度/n,，/w,抽象/a,出/v,name/en,_,len/en,特征/n, ,data/en,_,set/en,[/w,"/w,name/en,_,len/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,name/en,"/w,]/w,./w,apply/en,(/w,len/en,)/w,观察/v,name/en,列/v,通过/p,观察/v,name/en,列/v,数据/n,，/w,可以/v,发现/v,名字/n,中/f,带有/v,性别/n,和/c,婚否/nw,的/u,称谓/vn,信息/n,。/w,提取/v,这些/r,信息/n,（/w,可能/v,是/v,有用/a,的/u,特征/n,）/w,。/w,data/en,_,set/en,[/w,"/w,name/en,_,class/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,name/en,"/w,]/w,./w,apply/en,(/w,lambda/en, ,x/en, ,:/w, ,x/en,./w,split/en,(/w,"/w,,/w,"/w,)/w,[/w,1/m,]/w,)/w,./w,apply/en,(/w,lambda/en, ,x/en, ,:/w,x/en,./w,split/en,(/w,)/w,[/w,0/m,]/w,)/w,2/m,）/w,多变量/nw,的/u,组合/v,sibsp/en, ,代表/n,兄弟/n,姐妹/n,和/c,配偶/n,的/u,数量/n,parch/en, ,代表/n,父母/n,和/c,子女/n,的/u,数量/n,因此/c,可以/v,将/d,sibsp/en,和/c,parch/en,结合/v,获得/v,家庭/n,成员/n,的/u,数量/n,data/en,_,set/en,[/w,"/w,family/en,_,num/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,parch/en,"/w,]/w, ,+/w, ,data/en,_,set/en,[/w,"/w,sibsp/en,"/w,]/w, ,+/w,13/m,）/w,名义/n,变量/n,转数/nw,值/n,变量/n,#,embarked/en, ,data/en,_,set/en,[/w,"/w,embarked/en,"/w,]/w,=/w,data/en,_,set/en,[/w,"/w,embarked/en,"/w,]/w,./w,map/en,(/w,{/w,'/w,s/en,'/w,:/w,1/m,,/w,'/w,c/en,'/w,:/w,2/m,,/w,'/w,q/en,'/w,:/w,3/m,}/w,)/w,./w,astype/en,(/w,int/en,)/w, ,#,sex/en, ,data/en,_,set/en,[/w,"/w,sex/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,sex/en,"/w,]/w,./w,apply/en,(/w,lambda/en, ,x/en, ,:/w, ,0/m, ,if/en, ,x/en,=/w,=/w,'/w,male/en,'/w, ,else/en, ,1/m,)/w,4/m,）/w,数据/n,分段/vn,根据/p,统计/v,信息/n,和/c,经验/n,分段/vn,#,[/w,7.91/m,,/w,14.45/m,,/w,31.0/m,]/w,根据/p,fare/en,的/u,统计/v,信息/n,进行/v,分段/vn, ,data/en,_,set/en,[/w,"/w,fare/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,fare/en,"/w,]/w,./w,apply/en,(/w,lambda/en, ,x/en,:/w,cutfeature/en,(/w,[/w,7.91/m,,/w,14.45/m,,/w,31.0/m,]/w,,/w,x/en,)/w,)/w, ,#,[/w,18/m,,/w,48/m,,/w,64/m,]/w,按照/p,经验/n,分段/vn, ,data/en,_,set/en,[/w,"/w,age/en,"/w,]/w, ,=/w, ,data/en,_,set/en,[/w,"/w,age/en,"/w,]/w,./w,apply/en,(/w,lambda/en, ,x/en,:/w,cutfeature/en,(/w,[/w,18/m,,/w,48/m,,/w,64/m,]/w,,/w,x/en,)/w,)/w,简单/a,的/u,数据/n,处理/v,后/f,，/w,我们/r,得到/v,了/u,如下/v,12维/mq,数据/n,：/w,4/m, ,模型/n,选择/v,与/p,测试/vn,初步/d