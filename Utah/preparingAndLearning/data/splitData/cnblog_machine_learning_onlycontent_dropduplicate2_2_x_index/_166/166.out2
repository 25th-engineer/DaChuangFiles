【注/nw,】/w,该/r,系列/q,文章/n,以及/c,使用/v,到/v,安装/v,包/v,//w,测试/vn,数据/n, ,可以/v,在/p,《/w,倾/v,情/n,大/a,奉/v,送/v,--/nrf,spark/en,入门/v,实战/n,系列/q,》/w,获取/v,1/m,、/w,mllib/en,实例/n,1.1/m, ,聚类/nw,实例/n,1/m,./w,1/m,./w,1/m, ,算法/n,说明/v,聚类/nw,（/w,cluster/en, ,analysis/en,）/w,有时/d,也/d,被/p,翻译/v,为/p,簇类/nw,，/w,其/r,核心/n,任务/n,是/v,：/w,将/d,一组/mq,目标/n,object/en,划分/v,为/p,若干/m,个/q,簇/ng,，/w,每个/r,簇/ng,之间/f,的/u,object/en,尽可能/d,相似/a,，/w,簇/ng,与/p,簇/ng,之间/f,的/u,object/en,尽可能/d,相异/nw,。/w,聚类/nw,算法/n,是/v,机器/n,学习/v,（/w,或者/c,说是/v,数据/n,挖掘/v,更/d,合适/a,）/w,中/f,重要/a,的/u,一部分/m,，/w,除了/p,最为/d,简单/a,的/u,k/en,-/w,means/en,聚类/nw,算法/n,外/f,，/w,比较/d,常见/a,的/u,还有/v,层次法/nw,（/w,cure/en,、/w,chameleon/en,等/u,）/w,、/w,网格/n,算法/n,（/w,sting/en,、/w,wavecluster/en,等/u,）/w,，/w,等等/u,。/w,较/d,权威/n,的/u,聚类/nw,问题/n,定义/n,：/w,所谓/v,聚类/nw,问题/n,，/w,就是/d,给/p,定/v,一个/m,元素/n,集合/v,d/en,，/w,其中/r,每个/r,元素/n,具有/v,n/en,个/q,可/v,观察/v,属性/n,，/w,使用/v,某种/r,算法/n,将/d,d/en,划分/v,成/v,k/en,个子/n,集/vg,，/w,要求/v,每个/r,子集/n,内部/f,的/u,元素/n,之间/f,相/d,异度/nw,尽可能/d,低/a,，/w,而/c,不同子集/nw,的/u,元素/n,相/d,异度/nw,尽可能/d,高/a,。/w,其中/r,每个/r,子集/n,叫做/v,一个/m,簇/ng,。/w,k/en,-/w,means/en,聚类/nw,属于/v,无/v,监督/vn,学习/v,，/w,以往/t,的/u,回归/v,、/w,朴素/a,贝叶斯/nr,、/w,svm/en,等/u,都/d,是/v,有/v,类别/n,标签/n,y/en,的/u,，/w,也就是说/l,样例/nw,中/f,已经/d,给/p,出/v,了/u,样例/nw,的/u,分类/vn,。/w,而/c,聚类/nw,的/u,样本/n,中/f,却/d,没有/v,给/p,定/v,y/en,，/w,只有/c,特征/n,x/en,，/w,比如/v,假设/v,宇宙/n,中/f,的/u,星星/n,可以/v,表示/v,成/v,三维/nz,空间/n,中/f,的/u,点集/nw,。/w,聚类/nw,的/u,目的/n,是/v,找到/v,每个/r,样本/n,x/en,潜在/b,的/u,类别/n,y/en,，/w,并/c,将/d,同/p,类别/n,y/en,的/u,样本/n,x/en,放/v,在/p,一起/s,。/w,比如/v,上面/f,的/u,星星/n,，/w,聚类/nw,后/f,结果/n,是/v,一个个/nw,星团/n,，/w,星团/n,里面/f,的/u,点/q,相互/d,距离/n,比较/d,近/a,，/w,星团/n,间/f,的/u,星星/n,距离/n,就/d,比较/d,远/a,了/u,。/w,与/p,分类/vn,不同/a,，/w,分类/vn,是/v,示例式/nw,学习/v,，/w,要求/v,分类/vn,前/f,明确/ad,各个/r,类别/n,，/w,并/c,断言/v,每个/r,元素/n,映射/v,到/v,一个/m,类别/n,。/w,而/c,聚类/nw,是/v,观察式/nw,学习/v,，/w,在/p,聚类/nw,前/f,可以/v,不/d,知道/v,类别/n,甚至/d,不/d,给/p,定/v,类别/n,数量/n,，/w,是/v,无/v,监督/vn,学习/v,的/u,一种/mq,。/w,目前/t,聚类/nw,广泛/a,应用/vn,于/p,统计学/n,、/w,生物学/n,、/w,数据库/n,技术/n,和/c,市场/n,营销/vn,等/u,领域/n,，/w,相应/v,的/u,算法/n,也/d,非常/d,多/a,。/w,1/m,./w,1/m,./w,2/m, ,实例/n,介绍/v,在/p,该/r,实例/n,中将/n,介绍/v,k/en,-/w,means/en,算法/n,，/w,k/en,-/w,means/en,属于/v,基于/p,平方/q,误差/n,的/u,迭代/vn,重/a,分配/vn,聚类/nw,算法/n,，/w,其/r,核心/n,思想/n,十分/d,简单/a,：/w,l/en,随机/d,选择/v,k/en,个/q,中心点/nz,；/w,l/en,计算所/n,有点/d,到/v,这/r,k/en,个/q,中心点/nz,的/u,距离/n,，/w,选择/v,距离/n,最近/t,的/u,中心点/nz,为/p,其/r,所在/n,的/u,簇/ng,；/w,l/en,简单/a,地/u,采用/v,算术/n,平均数/n,（/w,mean/en,）/w,来/v,重新/d,计算/v,k/en,个/q,簇/ng,的/u,中心/n,；/w,l/en,重复/v,步骤/n,2/m,和/c,3/m,，/w,直至/v,簇类/nw,不再/d,发生/v,变化/vn,或者/c,达到/v,最/d,大/a,迭/d,代值/nw,；/w,l/en,输出/v,结果/n,。/w,k/en,-/w,means/en,算法/n,的/u,结果/n,好坏/n,依赖/v,于/p,对/p,初始/b,聚类/nw,中心/n,的/u,选择/v,，/w,容易/a,陷入/v,局部/n,最/d,优解/nw,，/w,对/p,k/en,值/n,的/u,选择/v,没有/v,准则/n,可/v,依循/nw,，/w,对/p,异常/a,数据/n,较为/d,敏感/a,，/w,只能/v,处理/v,数值/n,属性/n,的/u,数据/n,，/w,聚类/nw,结构/n,可能/v,不/d,平衡/a,。/w,本/r,实例/n,中/f,进行/v,如下/v,步骤/n,：/w,1/m,./w,装载/vn,数据/n,，/w,数据/n,以/p,文本/n,文件/n,方式/n,进行/v,存放/v,；/w,2/m,./w,将/d,数据/n,集聚/vn,类/q,，/w,设置/v,2个类/mq,和/c,20次/mq,迭代/vn,，/w,进行/v,模型/n,训练/vn,形成/v,数据/n,模型/n,；/w,3/m,./w,打印/v,数据/n,模型/n,的/u,中心点/nz,；/w,4/m,./w,使用/v,误差/n,平方之和/nw,来/v,评估/vn,数据/n,模型/n,；/w,5/m,./w,使用/v,模型/n,测试/vn,单点/n,数据/n,；/w,6/m,./w,交叉/vn,评估/vn,1/m,，/w,返回/v,结果/n,；/w,交叉/vn,评估/vn,2/m,，/w,返回/v,数据集/nw,和/c,结果/n,。/w,1/m,./w,1/m,./w,3/m,测试/vn,数据/n,说明/v,该/r,实例/n,使用/v,的/u,数据/n,为/p,kmeans/en,_,data/en,./w,txt/en,，/w,可以/v,在/p,本/r,系列/q,附带/v,资源/n,//w,data/en,//w,class/en,8/m,//w,目录/n,中/f,找到/v,。/w,在/p,该/r,文件/n,中/f,提供/v,了/u,6个点/mq,的/u,空间/n,位置/n,坐标/n,，/w,使用/v,k/en,-/w,means/en,聚类/nw,对/p,这些/r,点/q,进行/v,分类/vn,。/w,使用/v,的/u,kmeans/en,_,data/en,./w,txt/en,的/u,数据/n,如下/v,所/u,示/vg,：/w,0.0/m, ,0.0/m, ,0/m,./w,00/m,./w,1/m, ,0.1/m, ,0/m,./w,10/m,./w,2/m, ,0.2/m, ,0/m,./w,29/m,./w,0/m, ,9.0/m, ,9/m,./w,09/m,./w,1/m, ,9.1/m, ,9/m,./w,19/m,./w,2/m, ,9.2/m, ,9/m,./w,21/m,./w,1/m,./w,4/m,程序/n,代码/n,import/en, ,org/en,./w,apache/en,./w,log/en,4/m,j/en,./w,{/w,level/en,,/w, ,logger/en,}/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,{/w,sparkconf/en,,/w, ,sparkcontext/en,}/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,clustering/en,./w,kmeansimport/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectorsobject/en, ,kmeans/en, ,{/w,def/en, ,main/en,(/w,args/en,:/w, ,array/en,[/w,string/en,]/w,)/w, ,{/w,//w,//w, ,屏蔽/v,不必要/v,的/u,日志/n,显示/v,在/p,终端/n,上/f,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,apache/en,./w,spark/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,warn/en,)/w,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,eclipse/en,./w,jetty/en,./w,server/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,off/en,)/w,//w,//w, ,设置/v,运行/vn,环境/n,val/en, ,conf/en, ,=/w, ,new/en, ,sparkconf/en,(/w,)/w,./w,setappname/en,(/w,"/w,kmeans/en,"/w,)/w,./w,setmaster/en,(/w,"/w,local/en,[/w,4/m,]/w,"/w,)/w,val/en, ,sc/en, ,=/w, ,new/en, ,sparkcontext/en,(/w,conf/en,)/w,//w,//w, ,装载/vn,数据集/nw,val/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,//w,home/en,//w,hadoop/en,//w,upload/en,//w,class/en,8/m,//w,kmeans/en,_,data/en,./w,txt/en,"/w,,/w, ,1/m,)/w,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en,(/w,s/en, ,=/w,>, ,vectors/en,./w,dense/en,(/w,s/en,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,//w,//w, ,将/d,数据/n,集聚/vn,类/q,，/w,2个类/mq,，/w,20次/mq,迭代/vn,，/w,进行/v,模型/n,训练/vn,形成/v,数据/n,模型/n,val/en, ,numclusters/en, ,=/w, ,2/m,val/en, ,numiterations/en, ,=/w, ,20/m,val/en, ,model/en, ,=/w, ,kmeans/en,./w,train/en,(/w,parseddata/en,,/w, ,numclusters/en,,/w, ,numiterations/en,)/w,//w,//w, ,打印/v,数据/n,模型/n,的/u,中心点/nz,println/en,(/w,"/w,cluster/en, ,centers/en,:/w,"/w,)/w,for/en, ,(/w,c/en, ,</w,-/w, ,model/en,./w,clustercenters/en,)/w, ,{/w,println/en,(/w,"/w, , ,"/w, ,+/w, ,c/en,./w,tostring/en,)/w,}/w,//w,//w, ,使用/v,误差/n,平方之和/nw,来/v,评估/vn,数据/n,模型/n,val/en, ,cost/en, ,=/w, ,model/en,./w,computecost/en,(/w,parseddata/en,)/w,println/en,(/w,"/w,within/en, ,set/en, ,sum/en, ,of/en, ,squared/en, ,errors/en, ,=/w, ,"/w, ,+/w, ,cost/en,)/w,//w,//w, ,使用/v,模型/n,测试/vn,单点/n,数据/n,println/en,(/w,"/w,vectors/en, ,0.2/m, ,0.2/m, ,0.2/m, ,is/en, ,belongs/en, ,to/en, ,clusters/en,:/w,"/w, ,+/w, ,model/en,./w,predict/en,(/w,vectors/en,./w,dense/en,(/w,"/w,0.2/m, ,0.2/m, ,0.2/m,"/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,)/w,println/en,(/w,"/w,vectors/en, ,0.25/m, ,0.25/m, ,0.25/m, ,is/en, ,belongs/en, ,to/en, ,clusters/en,:/w,"/w, ,+/w, ,model/en,./w,predict/en,(/w,vectors/en,./w,dense/en,(/w,"/w,0.25/m, ,0.25/m, ,0.25/m,"/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,)/w,println/en,(/w,"/w,vectors/en, ,8/m, ,8/m, ,8/m, ,is/en, ,belongs/en, ,to/en, ,clusters/en,:/w,"/w, ,+/w, ,model/en,./w,predict/en,(/w,vectors/en,./w,dense/en,(/w,"/w,8/m, ,8/m, ,8/m,"/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,)/w,//w,//w, ,交叉/vn,评估/vn,1/m,，/w,只/d,返回/v,结果/n,val/en, ,testdata/en, ,=/w, ,data/en,./w,map/en,(/w,s/en, ,=/w,>, ,vectors/en,./w,dense/en,(/w,s/en,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,val/en, ,result/en,1/m, ,=/w, ,model/en,./w,predict/en,(/w,testdata/en,)/w,result/en,1/m,./w,saveastextfile/en,(/w,"/w,//w,home/en,//w,hadoop/en,//w,upload/en,//w,class/en,8/m,//w,result/en,_,kmeans/en,1/m,"/w,)/w,//w,//w, ,交叉/vn,评估/vn,2/m,，/w,返回/v,数据集/nw,和/c,结果/n,val/en, ,result/en,2/m, ,=/w, ,data/en,./w,map/en, ,{/w,line/en, ,=/w,>,val/en, ,linevectore/en, ,=/w, ,vectors/en,./w,dense/en,(/w,line/en,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,linevectore/en,)/w,line/en, ,+/w, ,"/w, ,"/w, ,+/w, ,prediction/en,}/w,./w,saveastextfile/en,(/w,"/w,//w,home/en,//w,hadoop/en,//w,upload/en,//w,class/en,8/m,//w,result/en,_,kmeans/en,2/m,"/w,)/w,sc/en,./w,stop/en,(/w,)/w,}/w,}/w,1/m,./w,1/m,./w,5/m, ,idea/en,执行/v,情况/n,第一/m,步/q, , , ,使用/v,如下/v,命令/n,启动/v,spark/en,集群/nz,$/w,cd/en, ,//w,app/en,//w,hadoop/en,//w,spark/en,-/w,1/m,./w,1/m,./w,0/m,$/w,sbin/en,//w,start/en,-/w,all/en,./w,sh/en,第二/m,步/q, , , ,在/p,idea/en,中/f,设置/v,运行/vn,环境/n,在/p,idea/en,运行/vn,配置/vn,中/f,设置/v,kmeans/en,运行/vn,配置/vn,，/w,由于/c,读入/v,的/u,数据/n,已经/d,在/p,程序/n,中/f,指定/v,，/w,故/c,在/p,该/r,设置/v,界面/n,中/f,不/d,需要/v,设置/v,输入/v,参数/n,第三/nw,步/q, , , ,执行/v,并/c,观察/v,输出/v,在/p,运行/vn,日志/n,窗口/s,中/f,可以/v,看到/v,，/w,通过/p,计算/v,计算/v,出/v,模型/n,并/c,找/v,出/v,两个/m,簇中心点/nt,：/w,(/w,9.1/m,，/w,9.1/m,，/w,9.1/m,)/w,和/c,(/w,0.1/m,，/w,0.1/m,，/w,0.1/m,)/w,，/w,使用/v,模型/n,对/p,测试/vn,点/q,进行/v,分类/vn,求/v,出/v,分/q,属于/v,族簇/nw,。/w,第四/nw,步/q, , , ,查看/v,输出/v,结果/n,文件/n,在/p,//w,home/en,//w,hadoop/en,//w,upload/en,//w,class/en,8/m,目录/n,中/f,有/v,两个/m,输出/v,目录/n,：/w,查看/v,结果/n,1/m,，/w,在/p,该/r,目录/n,中/f,只/d,输出/v,了/u,结果/n,，/w,分别/d,列出/v,了/u,6个点/mq,所/u,属/v,不同/a,的/u,族簇/nw,查看/v,结果/n,2/m,，/w,在/p,该/r,目录/n,中/f,输出/v,了/u,数据集/nw,和/c,结果/n,1.2/m, ,回归/v,算法/n,实例/n,1/m,./w,2/m,./w,1/m, ,算法/n,说明/v,线性/n,回归/v,是/v,利用/v,称为/v,线性/n,回归/v,方程/n,的/u,函数/n,对/p,一个/m,或/c,多/a,个/q,自/p,变量/n,和/c,因/p,变量/n,之间/f,关系/n,进行/v,建模/vn,的/u,一种/mq,回归/v,分析/vn,方法/n,，/w,只/d,有/v,一个/m,自/p,变量/n,的/u,情况/n,称为/v,简单/a,回归/v,，/w,大于/v,一个/m,自/p,变量/n,情况/n,的/u,叫做/v,多元/b,回归/v,，/w,在/p,实际/n,情况/n,中/f,大多数/m,都/d,是/v,多元/b,回归/v,。/w,线性/n,回归/v,（/w,linear/en, ,regression/en,）/w,问题/n,属于/v,监督/vn,学习/v,（/w,supervised/en, ,learning/en,）/w,范畴/n,，/w,又/d,称/v,分类/vn,（/w,classification/en,）/w,或/c,归纳/v,学习/v,（/w,inductive/en, ,learning/en,）/w,。/w,这/r,类/q,分析/vn,中/f,训练/vn,数据/n,集中/v,给/p,出/v,的/u,数据/n,类型/n,是/v,确定/v,的/u,。/w,机器/n,学习/v,的/u,目标/n,是/v,，/w,对于/p,给/p,定/v,的/u,一个/m,训练/vn,数据集/nw,，/w,通过/p,不断/d,的/u,分析/vn,和/c,学习/v,产生/v,一个/m,联系/v,属性/n,集合/v,和/c,类标/nw,集合/v,的/u,分类/vn,函数/n,（/w,classification/en, ,function/en,）/w,或/c,预测/v,函数/n,）/w,prediction/en, ,function/en,）/w,，/w,这个/r,函数/n,称为/v,分类/vn,模型/n,（/w,classification/en, ,model/en,——/w,或/c,预测/v,模型/n,（/w,prediction/en, ,model/en,）/w,。/w,通过/p,学习/v,得到/v,的/u,模型/n,可以/v,是/v,一个/m,决策/n,树/v,、/w,规格/n,集/vg,、/w,贝叶斯模型/nw,或/c,一个/m,超/v,平面/n,。/w,通过/p,这个/r,模型/n,可以/v,对/p,输入/v,对象/n,的/u,特征/n,向量/n,预测/v,或/c,对/p,对象/n,的/u,类标/nw,进行/v,分类/vn,。/w,回归/v,问题/n,中/f,通常/d,使用/v,最小/a,二/m,乘/v,（/w,least/en, ,squares/en,）/w,法来/nrf,迭代/vn,最/d,优/ag,的/u,特征/n,中/f,每个/r,属性/n,的/u,比重/n,，/w,通过/p,损失/n,函数/n,（/w,loss/en, ,function/en,）/w,或/c,错误/n,函数/n,（/w,error/en, ,function/en,)/w,定义/n,来/v,设置/v,收敛/vn,状态/n,，/w,即/v,作为/v,梯度/n,下降/v,算法/n,的/u,逼近/v,参数/n,因子/n,。/w,1/m,./w,2/m,./w,2/m, ,实例/n,介绍/v,该/r,例子/n,给/p,出/v,了/u,如何/r,导入/v,训练/vn,集/vg,数据/n,，/w,将/d,其/r,解析/v,为/p,带/v,标签/n,点/q,的/u,rdd/en,，/w,然后/c,使用/v,了/u,linearregressionwithsgd/en, ,算法/n,来/v,建立/v,一个/m,简单/a,的/u,线性/n,模型/n,来/v,预测/v,标签/n,的/u,值/n,，/w,最后/f,计算/v,了/u,均方/nw,差/a,来/v,评估/vn,预测/v,值/n,与/p,实际/n,值/n,的/u,吻合度/nw,。/w,线性/n,回归/v,分析/vn,的/u,整个/b,过程/n,可以/v,简单/a,描述/v,为/p,如下/v,三个/m,步骤/n,：/w,（/w,1/m,）/w,寻找/v,合适/a,的/u,预测/v,函数/n,，/w,即/v,上文/n,中/f,的/u, ,h/en,(/w,x/en,)/w, ,，/w,用/p,来/v,预测/v,输入/v,数据/n,的/u,判断/v,结果/n,。/w,这个/r,过程/n,是/v,非常/d,关键/n,的/u,，/w,需要/v,对/p,数据/n,有/v,一定/d,的/u,了解/v,或/c,分析/vn,，/w,知道/v,或者/c,猜测/vn,预测/v,函数/n,的/u,“/w,大概/d,”/w,形式/n,，/w,比如/v,是/v,线性/n,函数/n,还是/c,非线性/b,函数/n,，/w,若是非线性/nw,的/u,则/d,无法/v,用/p,线性/n,回归/v,来得/v,出/v,高/a,质量/n,的/u,结果/n,。/w,（/w,2/m,）/w,构造/v,一个/m,loss/en,函数/n,（/w,损失/n,函数/n,）/w,，/w,该/r,函数/n,表示/v,预测/v,的/u,输出/v,（/w,h/en,）/w,与/p,训练/vn,数据/n,标签/n,之间/f,的/u,偏差/n,，/w,可以/v,是/v,二者/r,之间/f,的/u,差/a,（/w,h/en,-/w,y/en,）/w,或者/c,是/v,其他/r,的/u,形式/n,（/w,如/v,平方差开方/nw,）/w,。/w,综合/vn,考虑/v,所有/b,训练/vn,数据/n,的/u,“/w,损失/n,”/w,，/w,将/d,loss/en,求/v,和/c,或者/c,求/v,平均/a,，/w,记/v,为/p, ,j/en,(/w,θ,)/w, ,函数/n,，/w,表示/v,所有/b,训练/vn,数据/n,预测/v,值/n,与/p,实际/n,类别/n,的/u,偏差/n,。/w,（/w,3/m,）/w,显然/ad,，/w, ,j/en,(/w,θ,)/w, ,函数/n,的/u,值/n,越/d,小/a,表示/v,预测/v,函数/n,越/d,准确/a,（/w,即/v,h/en,函数/n,越/d,准确/a,）/w,，/w,所以/c,这/r,一步/mq,需要/v,做/v,的/u,是/v,找到/v, ,j/en,(/w,θ,)/w, ,函数/n,的/u,最小值/nz,。/w,找/v,函数/n,的/u,最小值/nz,有/v,不同/a,的/u,方法/n,，/w,spark/en,中/f,采用/v,的/u,是/v,梯度/n,下降/v,法/j,（/w,stochastic/en, ,gradient/en, ,descent/en,，/w,sgd/en,)/w,。/w,1/m,./w,2/m,./w,3/m,程序/n,代码/n,import/en, ,org/en,./w,apache/en,./w,log/en,4/m,j/en,./w,{/w,level/en,,/w, ,logger/en,}/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,{/w,sparkcontext/en,,/w, ,sparkconf/en,}/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,linearregressionwithsgdimport/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,regression/en,./w,labeledpointimport/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,linalg/en,./w,vectorsobject/en, ,linearregression/en, ,{/w,def/en, ,main/en,(/w,args/en,:/w,array/en,[/w,string/en,]/w,)/w,:/w, ,unit/en, ,=/w,{/w,//w,//w, ,屏蔽/v,不必要/v,的/u,日志/n,显示/v,终端/n,上/f,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,apache/en,./w,spark/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,error/en,)/w,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,eclipse/en,./w,jetty/en,./w,server/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,off/en,)/w,//w,//w, ,设置/v,运行/vn,环境/n,val/en, ,conf/en, ,=/w, ,new/en, ,sparkconf/en,(/w,)/w,./w,setappname/en,(/w,"/w,kmeans/en,"/w,)/w,./w,setmaster/en,(/w,"/w,local/en,[/w,4/m,]/w,"/w,)/w,val/en, ,sc/en, ,=/w, ,new/en, ,sparkcontext/en,(/w,conf/en,)/w,//w,//w, ,load/en, ,and/en, ,parse/en, ,the/en, ,dataval/en, ,data/en, ,=/w, ,sc/en,./w,textfile/en,(/w,"/w,//w,home/en,//w,hadoop/en,//w,upload/en,//w,class/en,8/m,//w,lpsa/en,./w,data/en,"/w,)/w,val/en, ,parseddata/en, ,=/w, ,data/en,./w,map/en, ,{/w, ,line/en, ,=/w,>,val/en, ,parts/en, ,=/w, ,line/en,./w,split/en,(/w,'/w,,/w,'/w,)/w,labeledpoint/en,(/w,parts/en,(/w,0/m,)/w,./w,todouble/en,,/w, ,vectors/en,./w,dense/en,(/w,parts/en,(/w,1/m,)/w,./w,split/en,(/w,'/w, ,'/w,)/w,./w,map/en,(/w,_,./w,todouble/en,)/w,)/w,)/w,}/w,//w,//w, ,building/en, ,the/en, ,modelval/en, ,numiterations/en, ,=/w, ,100/m,val/en, ,model/en, ,=/w, ,linearregressionwithsgd/en,./w,train/en,(/w,parseddata/en,,/w, ,numiterations/en,)/w,//w,//w, ,evaluate/en, ,model/en, ,on/en, ,training/en, ,examples/en, ,and/en, ,compute/en, ,training/en, ,errorval/en, ,valuesandpreds/en, ,=/w, ,parseddata/en,./w,map/en, ,{/w, ,point/en, ,=/w,>,val/en, ,prediction/en, ,=/w, ,model/en,./w,predict/en,(/w,point/en,./w,features/en,)/w,(/w,point/en,./w,label/en,,/w, ,prediction/en,)/w,}/w,val/en, ,mse/en, ,=/w, ,valuesandpreds/en,./w,map/en,{/w, ,case/en,(/w,v/en,,/w, ,p/en,)/w, ,=/w,>, ,math/en,./w,pow/en,(/w,(/w,v/en, ,-/w, ,p/en,)/w,,/w, ,2/m,)/w,}/w,./w,reduce/en, ,(/w,_, ,+/w, ,_,)/w, ,//w, ,valuesandpreds/en,./w,countprintln/en,(/w,"/w,training/en, ,mean/en, ,squared/en, ,error/en, ,=/w, ,"/w, ,+/w, ,mse/en,)/w,sc/en,./w,stop/en,(/w,)/w,}/w,}/w,1/m,./w,2/m,./w,4/m, ,执行/v,情况/n,第一/m,步/q, , , ,启动/v,spark/en,集群/nz,$/w,cd/en, ,//w,app/en,//w,hadoop/en,//w,spark/en,-/w,1/m,./w,1/m,./w,0/m,$/w,sbin/en,//w,start/en,-/w,all/en,./w,sh/en,第二/m,步/q, , , ,在/p,idea/en,中/f,设置/v,运行/vn,环境/n,在/p,idea/en,运行/vn,配置/vn,中/f,设置/v,linearregression/en,运行/vn,配置/vn,，/w,由于/c,读入/v,的/u,数据/n,已经/d,在/p,程序/n,中/f,指定/v,，/w,故/c,在/p,该/r,设置/v,界面/n,中/f,不/d,需要/v,设置/v,输入/v,参数/n,第三/nw,步/q, , , ,执行/v,并/c,观察/v,输出/v,1.3/m, ,协同/v,过滤/v,实例/n,1/m,./w,3/m,./w,1/m, ,算法/n,说明/v,协同/v,过滤/v,（/w,collaborative/en, ,filtering/en,，/w,简称/v,cf/en,，/w,wiki/en,上/f,的/u,定义/n,是/v,：/w,简单/a,来说/u,是/v,利用/v,某个/r,兴趣/n,相投/v,、/w,拥有/v,共同/d,经验/n,之/u,群体/n,的/u,喜好/v,来/v,推荐/v,感/vg,兴趣/n,的/u,资讯/n,给/p,使用者/n,，/w,个人/n,透过/v,合作/vn,的/u,机制/n,给予/v,资讯/n,相当/d,程度/n,的/u,回应/v,（/w,如/v,评分/vn,）/w,并/c,记录/v,下来/v,以/p,达到/v,过滤/v,的/u,目的/n,，/w,进而/c,帮助/v,别人/r,筛选/v,资讯/n,，/w,回应/v,不/d,一定/d,局限/v,于/p,特别/d,感/vg,兴趣/n,的/u,，/w,特别/d,不/d,感/vg,兴趣/n,资讯/n,的/u,纪录/n,也/d,相当/d,重要/a,。/w,协同/v,过滤/v,常/d,被/p,应用/vn,于/p,推荐/v,系统/n,。/w,这些/r,技术/n,旨在/v,补充/v,用户/n,—/w,商品/n,关联/vn,矩阵/n,中/f,所/u,缺/v,失/v,的/u,部分/n,。/w,mllib/en, ,当前/t,支持/v,基于/p,模型/n,的/u,协同/v,过滤/v,，/w,其中/r,用户/n,和/c,商品/n,通过/p,一/m,小组/n,隐性/b,因子/n,进行/v,表达/v,，/w,并且/c,这些/r,因子/n,也/d,用于/v,预测/v,缺失/n,的/u,元素/n,。/w,mllib/en, ,使用/v,交替/v,最小二乘法/nw,（/w,als/en,）/w, ,来/v,学习/v,这些/r,隐性/b,因子/n,。/w,用户/n,对/p,物品/n,或者/c,信息/n,的/u,偏/d,好/a,，/w,根据/p,应用/vn,本身/r,的/u,不同/a,，/w,可能/v,包括/v,用户/n,对/p,物品/n,的/u,评分/vn,、/w,用户/n,查看/v,物品/n,的/u,记录/v,、/w,用户/n,的/u,购买/v,记录/v,等/u,。/w,其实/d,这些/r,用户/n,的/u,偏/d,好/a,信息/n,可以/v,分为/v,两类/mq,：/w,l/en, , ,显式/nw,的/u,用户/n,反馈/v,：/w,这/r,类/q,是/v,用户/n,在/p,网站/n,上/f,自然/d,浏览/vn,或者/c,使用/v,网站/n,以外/f,，/w,显式/nw,地/u,提供/v,反馈/v,信息/n,，/w,例如/v,用户/n,对/p,物品/n,的/u,评分/vn,或者/c,对/p,物品/n,的/u,评论/n,。/w,l/en, , ,隐式/nw,的/u,用户/n,反馈/v,：/w,这/r,类/q,是/v,用户/n,在/p,使用/v,网站/n,是/v,产生/v,的/u,数据/n,，/w,隐式/nw,地/u,反映/v,了/u,用户/n,对/p,物品/n,的/u,喜好/v,，/w,例如/v,用户/n,购买/v,了/u,某/r,物品/n,，/w,用户/n,查看/v,了/u,某/r,物品/n,的/u,信息/n,，/w,等等/u,。/w,显式/nw,的/u,用户/n,反馈/v,能/v,准确/a,地/u,反映/v,用户/n,对/p,物品/n,的/u,真实/a,喜好/v,，/w,但/c,需要/v,用户/n,付出/v,额外/b,的/u,代价/n,；/w,而/c,隐式/nw,的/u,用户/n,行为/n,，/w,通过/p,一些/m,分析/vn,和/c,处理/v,，/w,也/d,能/v,反映/v,用户/n,的/u,喜好/v,，/w,只是/d,数据/n,不/d,是/v,很/d,精确/a,，/w,有些/r,行为/n,的/u,分析/vn,存在/v,较/d,大/a,的/u,噪音/n,。/w,但/c,只要/c,选择/v,正确/a,的/u,行为/n,特征/n,，/w,隐式/nw,的/u,用户/n,反馈/v,也/d,能/v,得到/v,很/d,好/a,的/u,效果/n,，/w,只是/d,行为/n,特征/n,的/u,选择/v,可能/v,在/p,不同/a,的/u,应用/vn,中/f,有/v,很/d,大/a,的/u,不同/a,，/w,例如/v,在/p,电子商务/nt,的/u,网站/n,上/f,，/w,购买/v,行为/n,其实/d,就/d,是/v,一个/m,能/v,很/d,好/a,表现/v,用户/n,喜好/v,的/u,隐式/nw,反馈/v,。/w,推荐/v,引擎/n,根据/p,不同/a,的/u,推荐/v,机制/n,可能/v,用/p,到/v,数据源/nz,中/f,的/u,一部分/m,，/w,然后/c,根据/p,这些/r,数据/n,，/w,分析/vn,出/v,一定/d,的/u,规则/n,或者/c,直接/ad,对/p,用户/n,对/p,其他/r,物品/n,的/u,喜好/v,进行/v,预测/v,计算/v,。/w,这样/r,推荐/v,引擎/n,可以/v,在/p,用户/n,进入/v,时/ng,给/p,他/r,推荐/v,他/r,可能/v,感/vg,兴趣/n,的/u,物品/n,。/w,mllib/en,目前/t,支持/v,基于/p,协同/v,过滤/v,的/u,模型/n,，/w,在/p,这个/r,模型/n,里/f,，/w,用户/n,和/c,产品/n,被/p,一组/mq,可以/v,用/p,来/v,预测/v,缺失/n,项目/n,的/u,潜在/b,因子/n,来/v,描述/v,。/w,特别/d,是/v,我们/r,实现/v,交替/v,最小/a,二/m,乘/v,（/w,als/en,）/w,算法/n,来/v,学习/v,这些/r,潜在/b,的/u,因子/n,，/w,在/p, ,mllib/en, ,中/f,的/u,实现/v,有/v,如下/v,参数/n,：/w,l/en, , ,numblocks/en,是/v,用于/v,并行化/nw,计算/v,的/u,分/q,块/q,个数/n,（/w,设置/v,为/p,-/w,1时/t, ,为/p,自动/d,配置/vn,）/w,；/w,l/en, , ,rank/en,是/v,模型/n,中/f,隐性/b,因子/n,的/u,个数/n,；/w,l/en, , ,iterations/en,是/v,迭代/vn,的/u,次数/n,；/w,l/en, , ,lambda/en,是/v,als/en, ,的/u,正则化/nw,参数/n,；/w,l/en, , ,implicitprefs/en,决定/v,了/u,是/v,用/p,显性/b,反馈/v,als/en, ,的/u,版本/n,还是/c,用/p,隐性/b,反馈/v,数据集/nw,的/u,版本/n,；/w,l/en, , ,alpha/en,是/v,一个/m,针对/p,于隐性/nw,反馈/v, ,als/en, ,版本/n,的/u,参数/n,，/w,这个/r,参数/n,决定/v,了/u,偏/d,好/a,行为/n,强度/n,的/u,基准/n,。/w,1/m,./w,3/m,./w,2/m, ,实例/n,介绍/v,在/p,本/r,实例/n,中/f,将/d,使用/v,协同/v,过滤算法/nw,对/p,grouplens/en, ,research/en,（/w,http/en,:/w,//w,//w,grouplens/en,./w,org/en,//w,datasets/en,//w,movielens/en,//w,）/w,提供/v,的/u,数据/n,进行/v,分析/vn,，/w,该/r,数据/n,为/p,一组/mq,从/p,20/m,世纪/n,90年/t,末/f,到/v,21/m,世纪/n,初/f,由/p,movielens/en,用户/n,提供/v,的/u,电影/n,评分/vn,数据/n,，/w,这些/r,数据/n,中/f,包括/v,电影/n,评分/vn,、/w,电影元/nw,数据/n,（/w,风格/n,类型/n,和/c,年代/n,）/w,以及/c,关于/p,用户/n,的/u,人口/n,统计学/n,数据/n,（/w,年龄/n,、/w,邮编/j,、/w,性别/n,和/c,职业/n,等/u,）/w,。/w,根据/p,不同/a,需求/n,该/r,组织/v,提供/v,了/u,不同/a,大小/n,的/u,样本/n,数据/n,，/w,不同/a,样本/n,信息/n,中/f,包含/v,三种/mq,数据/n,：/w,评分/vn,、/w,用户/n,信息/n,和/c,电影/n,信息/n,。/w,对/p,这些/r,数据/n,分析/vn,进行/v,如下/v,步骤/n,：/w,1/m,./w, ,装载/vn,如下/v,两种/mq,数据/n,：/w,a/en,)/w,装载/vn,样本/n,评分/vn,数据/n,，/w,其中/r,最后/f,一列/mq,时间/n,戳除/nw,10/m,的/u,余数/n,作为/v,key/en,，/w,rating/en,为/p,值/n,；/w,b/en,)/w,装载/vn,电影/n,目录/n,对照表/n,（/w,电影/n,id/en,-/w,>,电影/n,标题/n,）/w,2/m,./w,将/d,样本/n,评分/vn,表/n,以/p,key/en,值切/nw,分成/v,3个/m,部分/n,，/w,分别/d,用于/v,训练/vn, ,(/w,60%/mq,，/w,并/c,加入/v,用户/n,评分/vn,)/w,,/w, ,校验/v, ,(/w,20%/mq,)/w,,/w, ,and/en, ,测试/vn, ,(/w,20%/mq,)/w,3/m,./w,训练/vn,不同/a,参数/n,下/f,的/u,模型/n,，/w,并/c,再/d,校验/v,集中/v,验证/vn,，/w,获取/v,最佳/z,参数/n,下/f,的/u,模型/n,4/m,./w,用/p,最佳/z,模型/n,预测/v,测试/vn,集/vg,的/u,评分/vn,，/w,计算/v,和/c,实际/n,评分/vn,之间/f,的/u,均/d,方根/n,误差/n,5/m,./w,根据/p,用户/n,评分/vn,的/u,数据/n,，/w,推荐/v,前/f,十部/mq,最/d,感/vg,兴趣/n,的/u,电影/n,（/w,注意/v,要/v,剔除/v,用户/n,已经/d,评分/vn,的/u,电影/n,）/w,1/m,./w,3/m,./w,3/m, ,测试/vn,数据/n,说明/v,在/p,movielens/en,提供/v,的/u,电影/n,评分/vn,数据/n,分为/v,三个/m,表/n,：/w,评分/vn,、/w,用户/n,信息/n,和/c,电影/n,信息/n,，/w,在/p,该/r,系列/q,提供/v,的/u,附属/vn,数据/n,提供/v,大概/d,6000位/mq,读者/n,和/c,100万个/m,评分/vn,数据/n,，/w,具体/a,位置/n,为/p,//w,data/en,//w,class/en,8/m,//w,movielens/en,//w,data/en,目录/n,下/f,，/w,对/p,三个/m,表/n,数据/n,说明/v,可以/v,参考/v,该/r,目录/n,下/f,readme/en,文档/n,。/w,1/m,./w,评分/vn,数据/n,说明/v,（/w,ratings/en,./w,data/en,)/w,该/r,评分/vn,数据/n,总共/d,四个字/mq,段/q,，/w,格式/n,为/p,userid/en,:/w,:/w,movieid/en,:/w,:/w,rating/en,:/w,:/w,timestamp/en,，/w,分为/v,为/p,用户/n,编号/v,：/w,：/w,电影/n,编号/v,：/w,：/w,评分/vn,：/w,：/w,评分/vn,时间/n,戳/v,，/w,其中/r,各个/r,字段/n,说明/v,如下/v,：/w,l/en,用户/n,编号/v,范围/n,1/m,~/w,6040/m,l/en,电影/n,编号/v,1/m,~/w,3952/m,l/en,电影/n,评分/vn,为/p,五星/nz,评分/vn,，/w,范围/n,0/m,~/w,5/m,l/en,评分/vn,时间/n,戳/v,单位/n,秒/q,l/en,每个/r,用户/n,至少/d,有/v,20个/m,电影/n,评分/vn,使用/v,的/u,ratings/en,./w,dat/en,的/u,数据/n,样本/n,如下/v,所/u,示/vg,：/w,1/m,:/w,:/w,1193/m,:/w,:/w,5/m,:/w,:/w,9783007601/m,:/w,:/w,661/m,:/w,:/w,3/m,:/w,:/w,9783021091/m,:/w,:/w,914/m,:/w,:/w,3/m,:/w,:/w,9783019681/m,:/w,:/w,3408/m,:/w,:/w,4/m,:/w,:/w,9783002751/m,:/w,:/w,2355/m,:/w,:/w,5/m,:/w,:/w,9788242911/m,:/w,:/w,1197/m,:/w,:/w,3/m,:/w,:/w,9783022681/m,:/w,:/w,1287/m,:/w,:/w,5/m,:/w,:/w,9783020391/m,:/w,:/w,2804/m,:/w,:/w,5/m,:/w,:/w,9783007192/m,./w,用户/n,信息/n,(/w,users/en,./w,dat/en,)/w,用户/n,信息/n,五个字/mq,段/q,，/w,格式/n,为/p,userid/en,:/w,:/w,gender/en,:/w,:/w,age/en,:/w,:/w,occupation/en,:/w,:/w,zip/en,-/w,code/en,，/w,分为/v,为/p,用户/n,编号/v,：/w,：/w,性别/n,：/w,：/w,年龄/n,：/w,：/w,职业/n,:/w,:/w,邮编/j,，/w,其中/r,各个/r,字段/n,说明/v,如下/v,：/w,l/en,用户/n,编号/v,范围/n,1/m,~/w,6040/m,l/en,性别/n,，/w,其中/r,m/en,为/p,男性/n,，/w,f/en,为/p,女性/n,l/en,不同/a,的/u,数字/n,代表/n,不同/a,的/u,年龄/n,范围/n,，/w,如/v,：/w,25/m,代表/n,25/m,~/w,34岁/mq,范围/n,l/en,职业/n,信息/n,，/w,在/p,测试/vn,数据/n,中/f,提供/v,了/u,21/m,中/f,职业/n,分类/vn,l/en,地区/n,邮编/j,使用/v,的/u,users/en,./w,dat/en,的/u,数据/n,样本/n,如下/v,所/u,示/vg,：/w,1/m,:/w,:/w,f/en,:/w,:/w,1/m,:/w,:/w,10/m,:/w,:/w,480672/m,:/w,:/w,m/en,:/w,:/w,56/m,:/w,:/w,16/m,:/w,:/w,700723/m,:/w,:/w,m/en,:/w,:/w,25/m,:/w,:/w,15/m,:/w,:/w,551174/m,:/w,:/w,m/en,:/w,:/w,45/m,:/w,:/w,7/m,:/w,:/w,024605/m,:/w,:/w,m/en,:/w,:/w,25/m,:/w,:/w,20/m,:/w,:/w,554556/m,:/w,:/w,f/en,:/w,:/w,50/m,:/w,:/w,9/m,:/w,:/w,551177/m,:/w,:/w,m/en,:/w,:/w,35/m,:/w,:/w,1/m,:/w,:/w,068108/m,:/w,:/w,m/en,:/w,:/w,25/m,:/w,:/w,12/m,:/w,:/w,114133/m,./w,电影/n,信息/n,(/w,movies/en,./w,dat/en,)/w,电影/n,数据/n,分为/v,三个字/mq,段/q,，/w,格式/n,为/p,movieid/en,:/w,:/w,title/en,:/w,:/w,genres/en,，/w,分为/v,为/p,电影/n,编号/v,：/w,：/w,电影/n,名/q,：/w,：/w,电影/n,类别/n,，/w,其中/r,各个/r,字段/n,说明/v,如下/v,：/w,l/en,电影/n,编号/v,1/m,~/w,3952/m,l/en,由/p,imdb/en,提供/v,电影/n,名称/n,，/w,其中/r,包括/v,电影/n,上映/v,年份/n,l/en,电影/n,分类/vn,，/w,这里/r,使用/v,实际/n,分类/vn,名非/nw,编号/v,，/w,如/v,：/w,action/en,、/w,crime/en,等/u,使用/v,的/u,movies/en,./w,dat/en,的/u,数据/n,样本/n,如下/v,所/u,示/vg,：/w,1/m,:/w,:/w,toy/en, ,story/en, ,(/w,1995/m,)/w,:/w,:/w,animation/en,|/w,children/en,'/w,s/en,|/w,comedy/en,2/m,:/w,:/w,jumanji/en, ,(/w,1995/m,)/w,:/w,:/w,adventure/en,|/w,children/en,'/w,s/en,|/w,fantasy/en,3/m,:/w,:/w,grumpier/en, ,old/en, ,men/en, ,(/w,1995/m,)/w,:/w,:/w,comedy/en,|/w,romance/en,4/m,:/w,:/w,waiting/en, ,to/en, ,exhale/en, ,(/w,1995/m,)/w,:/w,:/w,comedy/en,|/w,drama/en,5/m,:/w,:/w,father/en, ,of/en, ,the/en, ,bride/en, ,part/en, ,ii/en, ,(/w,1995/m,)/w,:/w,:/w,comedy/en,6/m,:/w,:/w,heat/en, ,(/w,1995/m,)/w,:/w,:/w,action/en,|/w,crime/en,|/w,thriller/en,7/m,:/w,:/w,sabrina/en, ,(/w,1995/m,)/w,:/w,:/w,comedy/en,|/w,romance/en,8/m,:/w,:/w,tom/en, ,and/en, ,huck/en, ,(/w,1995/m,)/w,:/w,:/w,adventure/en,|/w,children/en,'/w,s/en,1/m,./w,3/m,./w,4/m, ,程序/n,代码/n,import/en, ,java/en,./w,io/en,./w,fileimport/en, ,scala/en,./w,io/en,./w,sourceimport/en, ,org/en,./w,apache/en,./w,log/en,4/m,j/en,./w,{/w,level/en,,/w, ,logger/en,}/w,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkconfimport/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontextimport/en, ,org/en,./w,apache/en,./w,spark/en,./w,sparkcontext/en,./w,_,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,rdd/en,./w,_,import/en, ,org/en,./w,apache/en,./w,spark/en,./w,mllib/en,./w,recommendation/en,./w,{/w,als/en,,/w, ,rating/en,,/w, ,matrixfactorizationmodel/en,}/w,object/en, ,movielensals/en, ,{/w,def/en, ,main/en,(/w,args/en,:/w, ,array/en,[/w,string/en,]/w,)/w, ,{/w,//w,//w, ,屏蔽/v,不必要/v,的/u,日志/n,显示/v,在/p,终端/n,上/f,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,apache/en,./w,spark/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,warn/en,)/w,logger/en,./w,getlogger/en,(/w,"/w,org/en,./w,eclipse/en,./w,jetty/en,./w,server/en,"/w,)/w,./w,setlevel/en,(/w,level/en,./w,off/en,)/w,if/en, ,(/w,args/en,./w,length/en, ,!/w,=/w, ,2/m,)/w, ,{/w,println/en,(/w,"/w,usage/en,:/w, ,//w,path/en,//w,to/en,//w,spark/en,//w,bin/en,//w,spark/en,-/w,submit/en, ,--/nrf,driver/en,-/w,memory/en, ,2/m,g/en, ,--/nrf,class/en, ,week/en,7/m,./w,movielensals/en, ,"/w, ,+/w,"/w,week/en,7/m,./w,jar/en, ,movielenshomedir/en, ,personalratingsfile/en,"/w,)/w,sys/en,./w,exit/en,(/w,1/m,)/w,}/w,//w,//w, ,设置/v,运行/vn,环境/n,val/en, ,conf/en, ,=/w, ,new/en, ,sparkconf/en,(/w,)/w,./w,setappname/en,(/w,"/w,movielensals/en,"/w,)/w,./w,setmaster/en,(/w,"/w,local/en,[/w,4/m,]/w,"/w,)/w,val/en, ,sc/en, ,=/w, ,new/en, ,sparkcontext/en,(/w,conf/en,)/w,//w,//w, ,装载/vn,用户/n,评分/vn,，/w,该/r,评分/vn,由/p,评分器/nw,生成/vn,val/en, ,myratings/en, ,=/w, ,loadratings/en,(/w,args/en,(/w,1/m,)/w,)/w,val/en, ,myratingsrdd/en, ,=/w, ,sc/en,./w,parallelize/en,(/w,myratings/en,,/w, ,1/m,)/w,//w,//w, ,样本/n,数据/n,目录/n,val/en, ,movielenshomedir/en, ,=/w, ,args/en,(/w,0/m,)/w,//w,//w, ,装载/vn,样本/n,评分/vn,数据/n,，/w,其中/r,最后/f,一列/mq,timestamp/en,取/v,除/p,10/m,的/u,余数/n,作为/v,key/en,，/w,rating/en,为/p,值/n,,/w,即/v,(/w,int/en,,/w,rating/en,)/w,val/en, ,ratings/en, ,=/w, ,sc/en,./w,textfile/en,(/w,new/en, ,file/en,(/w,movielenshomedir/en,,/w, ,"/w,ratings/en,./w,dat/en,"/w,)/w,./w,tostring/en,)/w,./w,map/en, ,{/w, ,line/en, ,=/w,>,val/en, ,fields/en, ,=/w, ,line/en,./w,split/en,(/w,"/w,:/w,:/w,"/w,)/w,(/w,fields/en,(/w,3/m,)/w,./w,tolong/en, ,%/w, ,10/m,,/w, ,rating/en,(/w,fields/en,(/w,0/m,)/w,./w,toint/en,,/w, ,fields/en,(/w,1/m,)/w,./w,toint/en,,/w, ,fields/en,(/w,2/m,)/w,./w,todouble/en,)/w,)/w,}/w,//w,//w, ,装载/vn,电影/n,目录/n,对照表/n,（/w,电影/n,id/en,-/w,>,电影/n,标题/n,）/w,val/en, ,movies/en, ,=/w, ,sc/en,./w,textfile/en,(/w,new/en, ,file/en,(/w,movielenshomedir/en,,/w, ,"/w,movies/en,./w,dat/en,"/w,)/w,./w,tostring/en,)/w,./w,map/en, ,{/w, ,line/en, ,=/w,>,val/en, ,fields/en, ,=/w, ,line/en,./w,split/en,(/w,"/w,:/w,:/w,"/w,)/w,(/w,fields/en,(/w,0/m,)/w,./w,toint/en,,/w, ,fields/en,(/w,1/m,)/w,)/w,}/w,./w,collect/en,(/w,)/w,./w,tomapval/en, ,numratings/en, ,=/w, ,ratings/en,./w,count/en,(/w,)/w,val/en, ,numusers/en, ,=/w, ,ratings/en,./w,map/en,(/w,_,./w,_,2/m,./w,user/en,)/w,./w,distinct/en,(/w,)/w,./w,count/en,(/w,)/w,val/en, ,nummovies/en, ,=/w, ,ratings/en,./w,map/en,(/w,_,./w,_,2/m,./w,product/en,)/w,./w,distinct/en,(/w,)/w,./w,count/en,(/w,)/w,println/en,(/w,"/w,got/en, ,"/w, ,+/w, ,numratings/en, ,+/w, ,"/w, ,ratings/en, ,from/en, ,"/w, ,+/w, ,numusers/en, ,+/w, ,"/w, ,users/en, ,on/en, ,"/w, ,+/w, ,nummovies/en, ,+/w, ,"/w, ,movies/en,./w,"/w,)/w,//w,//w, ,将/d,样本/n,评分/vn,表/n,以/p,key/en,值切/nw,分成/v,3个/m,部分/n,，/w,分别/d,用于/v,训练/vn, ,(/w,60%/mq,，/w,并/c,加入/v,用户/n,评分/vn,)/w,,/w, ,校验/v, ,(/w,20%/mq,)/w,,/w, ,and/en, ,测试/vn, ,(/w,20%/mq,)/w,//w,//w, ,该/r,数据/n,在/p,计算/v,过程/n,中/f,要/v,多次/m,应用/vn,到/v,，/w,所以/c,cache/en,到/v,内存/n,val/en, ,numpartitions/en, ,=/w, ,4/m,val/en, ,training/en, ,=/w, ,ratings/en,./w,filter/en,(/w,x/en, ,=/w,>, ,x/en,./w,_,1/m, ,</w, ,6/m,)/w,./w,values/en,./w,union/en,(/w,myratingsrdd/en,)/w, ,//w,//w,注意/v,ratings/en,是/v,(/w,int/en,,/w,rating/en,)/w,，/w,取/v,value/en,即可/v,./w,repartition/en,(/w,numpartitions/en,)/w,./w,cache/en,(/w,)/w,val/en, ,validation/en, ,=/w, ,ratings/en,./w,filter/en,(/w,x/en, ,=/w,>, ,x/en,./w,_,1/m, ,>,=/w, ,6/m, ,&/w,&/w, ,x/en,./w,_,1/m, ,</w, ,8/m,)/w,./w,values/en,./w,repartition/en,(/w,numpartitions/en,)/w,./w,cache/en,(/w,)/w,val/en, ,test/en, ,=/w, ,ratings/en,./w,filter/en,(/w,x/en, ,=/w,>, ,x/en,./w,_,1/m, ,>,=/w, ,8/m,)/w,./w,values/en,./w,cache/en,(/w,)/w,val/en, ,numtraining/en, ,=/w, ,training/en,./w,count/en,(/w,)/w,val/en, ,numvalidation/en, ,=/w, ,validation/en,./w,count/en,(/w,)/w,val/en, ,numtest/en, ,=/w, ,test/en,./w,count/en,(/w,)/w,println/en,(/w,"/w,training/en,:/w, ,"/w, ,+/w, ,numtraining/en, ,+/w, ,"/w,,/w, ,validation/en,:/w, ,"/w, ,+/w, ,numvalidation/en, ,+/w, ,"/w,,/w, ,test/en,:/w, ,"/w, ,+/w, ,numtest/en,)/w,//w,//w, ,训练/vn,不同/a,参数/n,下/f,的/u,模型/n,，/w,并/c,在/p,校验/v,集中/v,验证/vn,，/w,获取/v,最佳/z,参数/n,下/f,的/u,模型/n,val/en, ,ranks/en, ,=/w, ,list/en,(/w,8/m,,/w, ,12/m,)/w,val/en, ,lambdas/en, ,=/w, ,list/en,(/w,0.1/m,,/w, ,10.0/m,)/w,val/en, ,numiters/en, ,=/w, ,list/en,(/w,10/m,,/w, ,20/m,)/w,var/en, ,bestmodel/en,:/w, ,option/en,[/w,matrixfactorizationmodel/en,]/w, ,=/w, ,nonevar/en, ,bestvalidationrmse/en, ,=/w, ,double/en,./w,maxvaluevar/en, ,bestrank/en, ,=/w, ,0/m,var/en, ,bestlambda/en, ,=/w, ,-/w,1.0/m,var/en, ,bestnumiter/en, ,=/w, ,-/w,1/m,for/en, ,(/w,rank/en, ,</w,-/w, ,ranks/en,;/w, ,lambda/en, ,</w,-/w, ,lambdas/en,;/w, ,numiter/en, ,</w,-/w, ,numiters/en,)/w, ,{/w,val/en, ,model/en, ,=/w, ,als/en,./w,train/en,(/w,training/en,,/w, ,rank/en,,/w, ,numiter/en,,/w, ,lambda/en,)/w,val/en, ,validationrmse/en, ,=/w, ,computermse/en,(/w,model/en,,/w, ,validation/en,,/w, ,numvalidation/en,)/w,println/en,(/w,"/w,rmse/en, ,(/w,validation/en,)/w, ,=/w, ,"/w, ,+/w, ,validationrmse/en, ,+/w, ,"/w, ,for/en, ,the/en, ,model/en, ,trained/en, ,with/en, ,rank/en, ,=/w, ,"/w,+/w, ,rank/en, ,+/w, ,"/w,,/w, ,lambda/en, ,=/w, ,"/w, ,+/w, ,lambda/en, ,+/w, ,"/w,,/w, ,and/en, ,numiter/en, ,=/w, ,"/w, ,+/w, ,numiter/en, ,+/w, ,"/w,./w,"/w,)/w,if/en, ,(/w,validationrmse/en, ,</w, ,bestvalidationrmse/en,)/w, ,{/w,bestmodel/en, ,=/w, ,some/en,(/w,model/en,)/w,bestvalidationrmse/en, ,=/w, ,validationrmsebestrank/en, ,=/w, ,rankbestlambda/en, ,=/w, ,lambdabestnumiter/en, ,=/w, ,numiter/en,}/w,}/w,//w,//w, ,用/p,最佳/z,模型/n,预测/v,测试/vn,集/vg,的/u,评分/vn,，/w,并/c,计算/v,和/c,实际/n,评分/vn,之间/f,的/u,均/d,方根/n,误差/n,val/en, ,testrmse/en, ,=/w, ,computermse/en,(/w,bestmodel/en,./w,get/en,,/w, ,test/en,,/w, ,numtest/en,)/w,println/en,(/w,"/w,the/en, ,best/en, ,model/en, ,was/en, ,trained/en, ,with/en, ,rank/en, ,=/w, ,"/w, ,+/w, ,bestrank/en, ,+/w, ,"/w, ,and/en, ,lambda/en, ,=/w, ,"/w, ,+/w, ,bestlambda/en, , ,+/w, ,"/w,,/w, ,and/en, ,numiter/en, ,=/w, ,"/w, ,+/w, ,bestnumiter/en, ,+/w, ,"/w,,/w, ,and/en, ,its/en, ,rmse/en, ,on/en, ,the/en, ,test/en, ,set/en, ,is/en, ,"/w, ,+/w, ,testrmse/en, ,+/w, ,"/w,./w,"/w,)/w,//w,//w, ,create/en, ,a/en, ,naive/en, ,baseline/en, ,and/en, ,compare/en, ,it/en, ,with/en, ,the/en, ,best/en, ,modelval/en, ,meanrating/en, ,=/w, ,training/en,./w,union/en,(/w,validation/en,)/w,./w,map/en,(/w,_,./w,rating/en,)/w,./w,meanval/en, ,baselinermse/en, ,=/w,math/en,./w,sqrt/en,(/w,test/en,./w,map/en,(/w,x/en, ,=/w,>, ,(/w,meanrating/en, ,-/w, ,x/en,./w,rating/en,)/w, ,*/w, ,(/w,meanrating/en, ,-/w, ,x/en,./w,rating/en,)/w,)/w,./w,mean/en,)/w,val/en, ,improvement/en, ,=/w, ,(/w,baselinermse/en, ,-/w, ,testrmse/en,)/w, ,//w, ,baselinermse/en, ,*/w, ,100/m,println/en,(/w,"/w,the/en, ,best/en, ,model/en, ,improves/en, ,the/en, ,baseline/en, ,by/en, ,"/w, ,+/w, ,"/w,%/w,1.2/m,f/en,"/w,./w,format/en,(/w,improvement/en,)/w, ,+/w, ,"/w,%/w,./w,"/w,)/w,//w,//w, ,推荐/v,前/f,十部/mq,最/d,感/vg,兴趣/n,的/u,电影/n,，/w,注意/v,要/v,剔除/v,用户/n,已经/d,评分/vn,的/u,电影/n,val/en, ,myratedmovieids/en, ,=/w, ,myratings/en,./w,map/en,(/w,_,./w,product/en,)/w,./w,tosetval/en, ,candidates/en, ,=/w, ,sc/en,./w,parallelize/en,(/w,movies/en,./w,keys/en,./w,filter/en,(/w,!/w,myratedmovieids/en,./w,contains/en,(/w,_,)/w,)/w,./w,toseq/en,)/w,val/en, ,recommendations/en, ,=/w, ,bestmodel/en,./w,get/en,./w,predict/en,(/w,candidates/en,./w,map/en,(/w,(/w,0/m,,/w, ,_,)/w,)/w,)/w,./w,collect/en,(/w,)/w,./w,sortby/en,(/w,-/w,_,./w,rating/en,)/w,./w,take/en,(/w,10/m,)/w,var/en, ,i/en, ,=/w, ,1/m,println/en,(/w,"/w,movies/en, ,recommended/en, ,for/en, ,you/en,:/w,"/w,)/w,recommendations/en,./w,foreach/en, ,{/w, ,r/en, ,=/w,>,println/en,(/w,"/w,%/w,2/m,d/en,"/w,./w,format/en,(/w,i/en,)/w, ,+/w, ,"/w,:/w, ,"/w, ,+/w, ,movies/en,(/w,r/en,./w,product/en,)/w,)/w,i/en, ,+/w,=/w, ,1/m,}/w,sc/en,./w,stop/en,(/w,)/w,}/w,//w,*/w,*/w, ,校验/v,集/vg,预测/v,数据/n,和/c,实际/n,数据/n,之间/f,的/u,均/d,方根/n,误差/n, ,*/w,*/w,//w,def/en, ,computermse/en,(/w,model/en,:/w, ,matrixfactorizationmodel/en,,/w, ,data/en,:/w, ,rdd/en,[/w,rating/en,]/w,,/w, ,n/en,:/w, ,long/en,)/w,:/w, ,double/en, ,=/w, ,{/w,val/en, ,predictions/en,:/w, ,rdd/en,[/w,rating/en,]/w, ,=/w, ,model/en,./w,predict/en,(/w,data/en,./w,map/en,(/w,x/en, ,=/w,>, ,(/w,x/en,./w,user/en,,/w, ,x/en,./w,product/en,)/w,)/w,)/w,val/en, ,predictionsandratings/en, ,=/w, ,predictions/en,./w,map/en,(/w,x/en, ,=/w,>, ,(/w,(/w,x/en,./w,user/en,,/w, ,x/en,./w,product/en,)/w,,/w, ,x/en,./w,rating/en,)/w,)/w,./w,join/en,(/w,data/en,./w,map/en,(/w,x/en, ,=/w,>, ,(/w,(/w,x/en,./w,user/en,,/w, ,x/en,./w,product/en,)/w,,/w, ,x/en,./w,rating/en,)/w,)/w,)/w,./w,valuesmath/en,./w,sqrt/en,(/w,predictionsandratings/en,./w,map/en,(/w,x/en, ,=/w,>, ,(/w,x/en,./w,_,1/m, ,-/w, ,x/en,./w,_,2/m,)/w, ,*/w, ,(/w,x/en,./w,_,1/m, ,-/w, ,x/en,./w,_,2/m,)/w,)/w,./w,reduce/en,(/w,_, ,+/w, ,_,)/w, ,//w, ,n/en,)/w,}/w,//w,*/w,*/w, ,装载/vn,用户/n,评分/vn,文件/n, ,*/w,*/w,//w,def/en, ,loadratings/en,(/w,path/en,:/w, ,string/en,)/w,:/w, ,seq/en,[/w,rating/en,]/w, ,=/w, ,{/w,val/en, ,lines/en, ,=/w, ,source/en,./w,fromfile/en,(/w,path/en,)/w,./w,getlines/en,(/w,)/w,val/en, ,ratings/en, ,=/w, ,lines/en,./w,map/en, ,{/w, ,line/en, ,=/w,>,val/en, ,fields/en, ,=/w, ,line/en,./w,split/en,(/w,"/w,:/w,:/w,"/w,)/w,rating/en,(/w,fields/en,(/w,0/m,)/w,./w,toint/en,,/w, ,fields/en,(/w,1/m,)/w,./w,to