kmeans/en,聚类/nw,相信/v,大家/r,都/d,已经/d,很/d,熟悉/v,了/u,。/w,在/p,python/en,里/f,我们/r,用/p,kmeans/en,通常/d,调用/v,sklearn/en,包/v,（/w,当然/d,自己/r,写/v,也/d,很/d,简单/a,）/w,。/w,那么/r,在/p,spark/en,里能/nz,不能/v,也/d,直接/ad,使用/v,sklean/en,包/v,呢/y,？/w,目前/t,来说/u,直接/ad,使用/v,有点/d,困难/an,，/w,不过/c,我/r,看到/v,spark/en,-/w,packages/en,里/f,已经/d,有/v,了/u,，/w,但/c,还/d,没有/v,发布/v,。/w,不过/c,没关系/l,，/w,pyspark/en,里/f,有/v,ml/en,包/v,，/w,除了/p,ml/en,包/v,，/w,还/d,可以/v,使用/v,mllib/en,，/w,这个/r,在/p,后期/f,会/v,写/v,，/w,也/d,很/d,方便/a,。/w,首先/d,来/v,看/v,一下/m,spark/en,自/p,带/v,的/u,例子/n,：/w,1/m, ,from/en, ,pyspark/en,./w,mllib/en,./w,linalg/en, ,import/en, ,vectors/en, ,2/m, ,from/en, ,pyspark/en,./w,ml/en,./w,clustering/en, ,import/en, ,kmeans/en, ,3/m, ,from/en, ,pyspark/en,./w,sql/en, ,import/en, ,sqlcontext/en, ,4/m, ,from/en, ,pyspark/en,./w,mllib/en,./w,linalg/en, ,import/en, ,vectors/en, ,5/m, ,#,导入/v,数据/n, ,6/m, ,data/en, ,=/w, ,[/w,(/w,vectors/en,./w,dense/en,(/w,[/w,0.0/m,,/w, ,0.0/m,]/w,)/w,,/w,)/w,,/w, ,(/w,vectors/en,./w,dense/en,(/w,[/w,1.0/m,,/w, ,1.0/m,]/w,)/w,,/w,)/w,,/w,(/w,vectors/en,./w,dense/en,(/w,[/w,9.0/m,,/w, ,8.0/m,]/w,)/w,,/w,)/w,,/w, ,(/w,vectors/en,./w,dense/en,(/w,[/w,8.0/m,,/w, ,9.0/m,]/w,)/w,,/w,)/w,]/w, ,7/m, ,df/en, ,=/w, ,sqlcontext/en,./w,createdataframe/en,(/w,data/en,,/w, ,[/w,"/w,features/en,"/w,]/w,)/w, ,8/m, ,#,kmeans/en,模型/n, ,9/m, ,kmeans/en, ,=/w, ,kmeans/en,(/w,k/en,=/w,2/m,,/w, ,seed/en,=/w,1/m,)/w, ,10/m, ,model/en, ,=/w, ,kmeans/en,./w,fit/en,(/w,df/en,)/w, ,11/m, ,#,簇心/nw,数量/n, ,12/m, ,centers/en, ,=/w, ,model/en,./w,clustercenters/en,(/w,)/w, ,13/m, ,len/en,(/w,centers/en,)/w, ,14/m, ,#,2/m, ,15/m, ,#,训练/vn,模型/n, ,16/m, ,transformed/en, ,=/w, ,model/en,./w,transform/en,(/w,df/en,)/w,./w,select/en,(/w,"/w,features/en,"/w,,/w, ,"/w,prediction/en,"/w,)/w, ,17/m, ,rows/en, ,=/w, ,transformed/en,./w,collect/en,(/w,)/w, ,18/m, ,rows/en,[/w,0/m,]/w,./w,prediction/en, ,=/w,=/w, ,rows/en,[/w,1/m,]/w,./w,prediction/en, ,19/m, ,#,true/en, ,20/m, ,rows/en,[/w,2/m,]/w,./w,prediction/en, ,=/w,=/w, ,rows/en,[/w,3/m,]/w,./w,prediction/en, ,21/m, ,#, ,true/en,这个/r,例子/n,很/d,简单/a,，/w,导入/v,的/u,数据/n,是/v,四个/m,稠密/a,向/p,量/n,(/w,可以/v,自己/r,在/p,二维/nr,向/p,量/n,里/f,画/v,一下/m,)/w,，/w,设定/v,了/u,两个/m,簇心/nw,，/w,最后/f,验证/vn,预测/v,的/u,结果/n,是否/v,正确/a,，/w,显示/v,为/p,true/en,，/w,证明/v,预测/v,正确/a,。/w,算法/n,中/f,具体/a,的/u,参数/n,可以/v,参考/v,api/en,中/f,的/u,说明/v,。/w,然而/c,实际/n,生产/vn,中/f,我们/r,的/u,数据集/nw,不/d,可能/v,以/p,这样/r,的/u,方式/n,一条条/nw,写/v,进去/v,，/w,一般/a,是/v,读/v,取/v,文件/n,，/w,关于/p,怎么/r,读/v,取/v,文件/n,，/w,可以/v,具体/a,看/v,我/r,的/u,这/r,篇/q,博文/nz,。/w,这里/r,我们/r,采用/v,iris/en,数据集/nw,（/w,不要/d,问/v,我/r,为什么/r,又/d,是/v,iris/en,数据集/nw,，/w,因为/c,真的/d,太/d,方便/a,了/u,）/w,来/v,给/p,大家/r,讲解/v,一下/m,。/w,我/r,的/u,数据集/nw,是/v,csv/en,格式/n,的/u,，/w,而/c,spark/en,又/d,不能/v,直接/ad,读/v,取/v,csv/en,格式/n,的/u,数据/n,，/w,这里/r,我们/r,有/v,两个/m,方式/n,，/w,一/m,是/v,我/r,提到/v,的/u,这/r,篇/q,博文/nz,里/f,有/v,写/v,怎么/r,读/v,取/v,csv/en,文件/n,，/w,二/m,是/v,安装/v,spark/en,-/w,csv/en,包/v,（/w,在/p,这里/r,下载/v,）/w,,/w,github/en,地址/n,在/p,这里/r,。/w,按照/p,步骤/n,安装/v,可以/v,了/u,。/w,这里/r,友情/n,提示/vn,一下/m,大家/r,，/w,github/en,的/u,安装/v,方法/n,是/v,：/w,$/w,spark/en,_,home/en,//w,bin/en,//w,spark/en,-/w,shell/en, ,--/nrf,packages/en, ,com/en,./w,databricks/en,:/w,spark/en,-/w,csv/en,_,2.11/m,:/w,1/m,./w,4/m,./w,0/m,如果/c,报错/nw,了/u,，/w,可以/v,把/p, ,--/nrf,packages/en, ,换/v,成/v, ,--/nrf,jars/en,，/w,如果/c,还是/c,不行/a,，/w,在/p,加/v,一个/m, ,common/en,-/w,csv/en,./w,jars/en,包/v,放/v,到/v,lib/en,下面/f,就/d,可以/v,了/u,。/w,我/r,因为/c,这个/r,耽误/v,了/u,不少/m,时间/n,，/w,不过/c,具体/a,问题/n,也/d,得/u,具体/a,分析/vn,。/w,安装/v,好/a,这个/r,包/v,以后/f,，/w,就/d,可以/v,读/v,取/v,数据/n,了/u,1/m, ,from/en, ,pyspark/en,./w,sql/en, ,import/en, ,sqlcontext/en, ,2/m, ,sqlcontext/en, ,=/w, ,sqlcontext/en,(/w,sc/en,)/w, ,3/m, ,data/en, ,=/w, ,sqlcontext/en,./w,read/en,./w,format/en,(/w,'/w,com/en,./w,databricks/en,./w,spark/en,./w,csv/en,'/w,)/w,./w,options/en,(/w,header/en,=/w,'/w,true/en,'/w,,/w, ,inferschema/en,=/w,'/w,true/en,'/w,)/w,./w,load/en,(/w,'/w,iris/en,./w,csv/en,'/w,)/w, ,4/m, ,data/en,./w,show/en,(/w,)/w,读/v,取/v,数据/n,以后/f,，/w,我们/r,来/v,看/v,一下/m,数据集/nw,：/w,1/m, ,+/w,------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,-------/nrf,+/w, ,2/m, ,|/w,row/en,./w,id/en,|/w,sepal/en,./w,length/en,|/w,sepal/en,./w,width/en,|/w,petal/en,./w,length/en,|/w,petal/en,./w,width/en,|/w,species/en,|/w, ,3/m, ,+/w,------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,-------/nrf,+/w, ,4/m, ,|/w, ,1/m,|/w, ,5.1/m,|/w, ,3.5/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,5/m, ,|/w, ,2/m,|/w, ,4.9/m,|/w, ,3.0/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,6/m, ,|/w, ,3/m,|/w, ,4.7/m,|/w, ,3.2/m,|/w, ,1.3/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,7/m, ,|/w, ,4/m,|/w, ,4.6/m,|/w, ,3.1/m,|/w, ,1.5/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,8/m, ,|/w, ,5/m,|/w, ,5.0/m,|/w, ,3.6/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,9/m, ,|/w, ,6/m,|/w, ,5.4/m,|/w, ,3.9/m,|/w, ,1.7/m,|/w, ,0.4/m,|/w, ,0/m,|/w, ,10/m, ,|/w, ,7/m,|/w, ,4.6/m,|/w, ,3.4/m,|/w, ,1.4/m,|/w, ,0.3/m,|/w, ,0/m,|/w, ,11/m, ,|/w, ,8/m,|/w, ,5.0/m,|/w, ,3.4/m,|/w, ,1.5/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,12/m, ,|/w, ,9/m,|/w, ,4.4/m,|/w, ,2.9/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,13/m, ,|/w, ,10/m,|/w, ,4.9/m,|/w, ,3.1/m,|/w, ,1.5/m,|/w, ,0.1/m,|/w, ,0/m,|/w, ,14/m, ,|/w, ,11/m,|/w, ,5.4/m,|/w, ,3.7/m,|/w, ,1.5/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,15/m, ,|/w, ,12/m,|/w, ,4.8/m,|/w, ,3.4/m,|/w, ,1.6/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,16/m, ,|/w, ,13/m,|/w, ,4.8/m,|/w, ,3.0/m,|/w, ,1.4/m,|/w, ,0.1/m,|/w, ,0/m,|/w, ,17/m, ,|/w, ,14/m,|/w, ,4.3/m,|/w, ,3.0/m,|/w, ,1.1/m,|/w, ,0.1/m,|/w, ,0/m,|/w, ,18/m, ,|/w, ,15/m,|/w, ,5.8/m,|/w, ,4.0/m,|/w, ,1.2/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,19/m, ,|/w, ,16/m,|/w, ,5.7/m,|/w, ,4.4/m,|/w, ,1.5/m,|/w, ,0.4/m,|/w, ,0/m,|/w, ,20/m, ,|/w, ,17/m,|/w, ,5.4/m,|/w, ,3.9/m,|/w, ,1.3/m,|/w, ,0.4/m,|/w, ,0/m,|/w, ,21/m, ,|/w, ,18/m,|/w, ,5.1/m,|/w, ,3.5/m,|/w, ,1.4/m,|/w, ,0.3/m,|/w, ,0/m,|/w, ,22/m, ,|/w, ,19/m,|/w, ,5.7/m,|/w, ,3.8/m,|/w, ,1.7/m,|/w, ,0.3/m,|/w, ,0/m,|/w, ,23/m, ,|/w, ,20/m,|/w, ,5.1/m,|/w, ,3.8/m,|/w, ,1.5/m,|/w, ,0.3/m,|/w, ,0/m,|/w, ,24/m, ,+/w,------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,-------/nrf,+/w,25/m, ,only/en, ,showing/en, ,top/en, ,20/m, ,rows/en,第二/m,步/q,：/w,提取/v,特征/n,我们/r,在/p,上/f,一步/mq,导入/v,的/u,数据/n,中/f,label/en,是/v,string/en,类型/n,的/u,，/w,但/c,在/p,spark/en,中/f,要/v,变成/v,数/m,值型/nw,才/d,能/v,计算/v,，/w,不然/c,就/d,会报/n,错/n,。/w,可以/v,利用/v,stringindexer/en,功能/n,将/d,字符/n,串/v,转化/v,为数值型/nw,1/m, ,from/en, ,pyspark/en,./w,ml/en,./w,feature/en, ,import/en, ,stringindexer/en, ,2/m, ,3/m, ,feature/en, ,=/w, ,stringindexer/en,(/w,inputcol/en,=/w,"/w,species/en,"/w,,/w, ,outputcol/en,=/w,"/w,targetlabel/en,"/w,)/w, ,4/m, ,target/en, ,=/w, ,feature/en,./w,fit/en,(/w,data/en,)/w,./w,transform/en,(/w,data/en,)/w, ,5/m, ,target/en,./w,show/en,(/w,)/w,targetlabel/en,这/r,一列/mq,就/d,是/v,species/en,转化/v,成/v,数值/n,型/k,的/u,结果/n,1/m, ,+/w,------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,-------/nrf,+/w,-----------/nrf,+/w, ,2/m, ,|/w,row/en,./w,id/en,|/w,sepal/en,./w,length/en,|/w,sepal/en,./w,width/en,|/w,petal/en,./w,length/en,|/w,petal/en,./w,width/en,|/w,species/en,|/w,targetlabel/en,|/w, ,3/m, ,+/w,------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,------------/nrf,+/w,-----------/nrf,+/w,-------/nrf,+/w,-----------/nrf,+/w, ,4/m, ,|/w, ,1/m,|/w, ,5.1/m,|/w, ,3.5/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,5/m, ,|/w, ,2/m,|/w, ,4.9/m,|/w, ,3.0/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,6/m, ,|/w, ,3/m,|/w, ,4.7/m,|/w, ,3.2/m,|/w, ,1.3/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,7/m, ,|/w, ,4/m,|/w, ,4.6/m,|/w, ,3.1/m,|/w, ,1.5/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,8/m, ,|/w, ,5/m,|/w, ,5.0/m,|/w, ,3.6/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,9/m, ,|/w, ,6/m,|/w, ,5.4/m,|/w, ,3.9/m,|/w, ,1.7/m,|/w, ,0.4/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,10/m, ,|/w, ,7/m,|/w, ,4.6/m,|/w, ,3.4/m,|/w, ,1.4/m,|/w, ,0.3/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,11/m, ,|/w, ,8/m,|/w, ,5.0/m,|/w, ,3.4/m,|/w, ,1.5/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,12/m, ,|/w, ,9/m,|/w, ,4.4/m,|/w, ,2.9/m,|/w, ,1.4/m,|/w, ,0.2/m,|/w, ,0/m,|/w, ,0.0/m,|/w, ,13/m, ,|/w, ,10/m,|/w, ,4.9/m,|/w, ,3.1/m,|/w, ,