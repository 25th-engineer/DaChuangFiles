有幸/v,参加/v,了/u,微软/nt,openhack/en,挑战赛/n,，/w,虽然/c,题目/n,难度/n,不/d,大/a,，/w,但是/c,很/d,有意思/l,，/w,学/v,到/v,了/u,很多/m,东西/n,，/w,还/d,有幸/v,认识/v,了/u,微软/nt,梁健/nr,老师/n,，/w,谢谢/v,您/r,的/u,帮助/v,！/w,同时/c,还/d,认识/v,同行/n,的/u,很多/m,朋友/n,，/w,非常/d,高兴/a,，/w,把/p,这/r,段/q,难忘/v,的/u,比赛/vn,记录/v,一下/m,~/w,~/w,也/d,分享/v,一下/m,代码/n,，/w,给/p,那些/r,没有/v,参加/v,的/u,朋友/n,，/w,数据集/nw,(/w,文/ng,末/f,链接/n,)/w,首先/d,每/r,支/q,队伍/n,会/v,收到/v,一个/m,数据集/nw,，/w,它/r,是/v,一个/m,登山公司/nt,提供/v,的/u,装备/n,图片/n,，/w,有/v,登山/vn,镐/ng,，/w,鞋子/n,，/w,登山/vn,扣/v,，/w,不/d,知道/v,叫/v,什么/r,的/u,雪地/n,爪/ng,？/w,手套/n,，/w,冲锋衣/nw,，/w,安全带/n,。/w,。/w,。/w,一共/d,12个/m,类别/n,，/w,每个/r,类别/n,几/m,百个/m,样本/n,，/w,我们/r,的/u,任务/n,就是/d,对/p,这些/r,图片/n,分类/vn,和/c,识别/v,简单/a,看/v,一下/m,：/w,赛题/nw,：/w,赛题/nw,共有/v,6道/mq,，/w,简单/a,描述/v,一下/m,：/w,1/m,、/w,搭建/v,环境/n,(/w,略/d,过/u,)/w,2/m,、/w,图像/n,正规化/vn,(/w,包括/v,颜色/n,和/c,大小/n,)/w,3/m,、/w,通过/p,机器/n,学习/v,方法/n,对/p,图像/n,分类/vn,，/w,precision/en,>,0.84/m,、/w,通过/p,深度/n,学习/v,方法/n,对/p,图像/n,分类/vn,，/w,precision/en,>,0.95/m,、/w,部署/v,(/w,略/d,过/u,)/w,6/m,、/w,目标/n,检测/vn,(/w,用/p,全新/b,的/u,数据集/nw,，/w,检测/vn,雪地/n,中/f,的/u,登山者/nw,是否/v,带头/v,盔/nw,！/w,！/w,航拍/nz,图像/n,，/w,有点/d,难度/n,~/w,)/w,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,下面/f,是/v,每/r,道/q,题目/n,的/u,详细/ad,描述/v,和/c,代码/n,题目/n,2/m,完成/v,以下/f,任务/n,:/w,选择/v,一种/mq,基本/a,颜色/n,，/w,例如/v,白色/n,并/c,填充/v,所有/b,图片/n,尺寸/n,不/d,是/v,1/m,:/w,1/m,比例/n,的/u,图像/n,不/d,通过/p,直接/ad,拉/v,伸/v,的/u,方式/n,，/w,重塑/v,至/p,128/m,x/en,128/m,x/en,3/m,像素/n,的/u,阵列/n,形状/n,确保/v,每个/r,图像/n,的/u,像素/n,范围/n,从/p,0/m,到/v,255/m,(/w,包含/v,或/c,[/w,0/m,,/w,255/m,]/w,)/w,，/w,也/d,称为/v,“/w,对比度/n,拉/v,伸/v,”/w,(/w,contrast/en, ,stretching/en,)/w,./w,标准化/vn,或/c,均衡/a,以/p,确保/v,像素/n,在/p,[/w,0/m,,/w,255/m,]/w,范围/n,内/f,./w,成功/a,完成/v,的/u,标准/n,团队/n,将/d,在/p,jupyter/en, ,notebook/en,中/f,运行/vn,一个/m,代码/n,单元/n,，/w,绘制/v,原始/a,图像/n,，/w,然后/c,绘制/v,填充/v,后/f,的/u,像/v,素值/nr,归/v,一化/nw,或/c,均衡/a,图像/n,,/w, ,展示/v,给/p,教练/n,看/v,./w,团队/n,将/d,在/p,jupyter/en, ,notebook/en, ,为/p,教练/n,运行/vn,一个/m,代码/n,单元/n,，/w,显示/v,的/u,像/v,素值/nr,的/u,直方图/n,应该/v,在/p,0/m,到/v,255/m,的/u,范围/n,内/f,（/w,包括/v,0/m,和/c,255/m,）/w,./w,def/en, ,normalize/en,(/w,src/en,)/w,:/w, ,arr/en, ,=/w, ,array/en,(/w,src/en,)/w, ,arr/en, ,=/w, ,arr/en,./w,astype/en,(/w,'/w,float/en,'/w,)/w, ,#, ,do/en, ,not/en, ,touch/en, ,the/en, ,alpha/en, ,channel/en, ,for/en, ,i/en, ,in/en, ,range/en,(/w,3/m,)/w,:/w, ,minval/en, ,=/w, ,arr/en,[/w,./w,./w,./w,,/w,i/en,]/w,./w,min/en,(/w,)/w, ,maxval/en, ,=/w, ,arr/en,[/w,./w,./w,./w,,/w,i/en,]/w,./w,max/en,(/w,)/w, ,if/en, ,minval/en, ,!/w,=/w, ,maxval/en,:/w, ,arr/en,[/w,./w,./w,./w,,/w,i/en,]/w, ,-/w,=/w, ,minval/en, ,arr/en,[/w,./w,./w,./w,,/w,i/en,]/w, ,*/w,=/w, ,(/w,255.0/m,//w,(/w,maxval/en,-/w,minval/en,)/w,)/w, ,arr/en, ,=/w, ,arr/en,./w,astype/en,(/w,uint/en,8/m,)/w, ,return/en, ,image/en,./w,fromarray/en,(/w,arr/en,,/w,'/w,rgb/en,'/w,)/w, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,from/en, ,pil/en, ,import/en, ,imagecolor/en, ,from/en, ,matplotlib/en,./w,pyplot/en, ,import/en, ,imshow/en, ,from/en, ,pil/en, ,import/en, ,image/en, ,from/en, ,pylab/en, ,import/en, ,*/w, ,import/en, ,copy/en, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,10/m,,/w,10/m,)/w,)/w, ,#,设置/v,窗口/s,大小/n, ,#, ,src/en, ,=/w, ,image/en,./w,open/en,(/w,"/w,100974/m,./w,jpeg/en,"/w,)/w, ,src/en, ,=/w, ,image/en,./w,open/en,(/w,"/w,rose/en,./w,jpg/en,"/w,)/w, ,src/en,_,array/en, ,=/w, ,array/en,(/w,src/en,)/w, ,plt/en,./w,subplot/en,(/w,2/m,,/w,2/m,,/w,1/m,)/w,,/w, ,plt/en,./w,title/en,(/w,'/w,src/en,'/w,)/w, ,plt/en,./w,imshow/en,(/w,src/en,)/w,,/w, ,plt/en,./w,axis/en,(/w,'/w,off/en,'/w,)/w, ,ar/en,=/w,src/en,_,array/en,[/w,:/w,,/w,:/w,,/w,0/m,]/w,./w,flatten/en,(/w,)/w, ,ag/en,=/w,src/en,_,array/en,[/w,:/w,,/w,:/w,,/w,1/m,]/w,./w,flatten/en,(/w,)/w, ,ab/en,=/w,src/en,_,array/en,[/w,:/w,,/w,:/w,,/w,2/m,]/w,./w,flatten/en,(/w,)/w, ,plt/en,./w,subplot/en,(/w,2/m,,/w,2/m,,/w,2/m,)/w,,/w, ,plt/en,./w,title/en,(/w,'/w,src/en, ,hist/en,'/w,)/w, ,plt/en,./w,axis/en,(/w,[/w,0/m,,/w,255/m,,/w,0/m,,/w,0.03/m,]/w,)/w, ,plt/en,./w,hist/en,(/w,ar/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,red/en,'/w,,/w,edgecolor/en,=/w,'/w,r/en,'/w,,/w,hold/en,=/w,1/m,)/w, ,#,原始/a,图像/n,直方图/n, ,plt/en,./w,hist/en,(/w,ag/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,g/en,'/w,,/w,edgecolor/en,=/w,'/w,g/en,'/w,,/w,hold/en,=/w,1/m,)/w, ,#,原始/a,图像/n,直方图/n, ,plt/en,./w,hist/en,(/w,ab/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,b/en,'/w,,/w,edgecolor/en,=/w,'/w,b/en,'/w,)/w, ,#,原/b,g/en,始/vg,图像/n,直方图/n, ,dst/en, ,=/w, ,normalize/en,(/w,src/en,)/w, ,dst/en,_,array/en, ,=/w, ,array/en,(/w,dst/en,)/w, ,plt/en,./w,subplot/en,(/w,2/m,,/w,2/m,,/w,3/m,)/w,,/w, ,plt/en,./w,title/en,(/w,'/w,dst/en,'/w,)/w, ,plt/en,./w,imshow/en,(/w,dst/en,)/w,,/w, ,plt/en,./w,axis/en,(/w,'/w,off/en,'/w,)/w, ,ar/en,=/w,dst/en,_,array/en,[/w,:/w,,/w,:/w,,/w,0/m,]/w,./w,flatten/en,(/w,)/w, ,ag/en,=/w,dst/en,_,array/en,[/w,:/w,,/w,:/w,,/w,1/m,]/w,./w,flatten/en,(/w,)/w, ,ab/en,=/w,dst/en,_,array/en,[/w,:/w,,/w,:/w,,/w,2/m,]/w,./w,flatten/en,(/w,)/w, ,plt/en,./w,subplot/en,(/w,2/m,,/w,2/m,,/w,4/m,)/w,,/w, ,plt/en,./w,title/en,(/w,'/w,dst/en, ,hist/en,'/w,)/w, ,plt/en,./w,axis/en,(/w,[/w,0/m,,/w,255/m,,/w,0/m,,/w,0.03/m,]/w,)/w, ,plt/en,./w,hist/en,(/w,ar/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,red/en,'/w,,/w,edgecolor/en,=/w,'/w,r/en,'/w,,/w,hold/en,=/w,1/m,)/w, ,#,原始/a,图像/n,直方图/n, ,plt/en,./w,hist/en,(/w,ag/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,g/en,'/w,,/w,edgecolor/en,=/w,'/w,g/en,'/w,,/w,hold/en,=/w,1/m,)/w, ,#,原始/a,图像/n,直方图/n, ,plt/en,./w,hist/en,(/w,ab/en,,/w, ,bins/en,=/w,256/m,,/w, ,normed/en,=/w,1/m,,/w,facecolor/en,=/w,'/w,b/en,'/w,,/w,edgecolor/en,=/w,'/w,b/en,'/w,)/w, ,#,原/b,g/en,始/vg,图像/n,直方图/n,view/en, ,code/en,题目/n,3/m,使用/v,一个/m,非/h,参数化/nw,分类/vn,方法/n,(/w,参考/v, ,参考/v,文档/n,)/w,来/v,创建/v,一个/m,模型/n,，/w,预测/v,新/a,的/u,户外/s,装备/n,图像/n,的/u,分类/vn,情况/n,，/w,训练/vn,来自/v,挑战/vn,2/m,的/u,预/d,处理/v,过/u,的/u,128/m,x/en,128/m,x/en,3/m,的/u,装备/n,图像/n,。/w,所/u,使用/v,的/u,算法/n,可以/v,从/p,scikit/en,-/w,learn/en,库/n,中/f,挑选/v,现有/v,的/u,非/h,参数/n,化算法/nw,来/v,做/v,分类/vn,。/w,向/p,教练/n,展示/v,所/u,提供/v,的/u,测试/vn,数据集/nw,的/u,精确度/n,，/w,并且/c,精确度/n,分数/n,需要/v,超过/v,80%/mq,。/w,dir/en,_,data/en, ,=/w,"/w,data/en,//w,preprocess/en,_,images/en,//w,"/w, ,equipments/en, ,=/w, ,[/w,'/w,axes/en,'/w,,/w, ,'/w,boots/en,'/w,,/w, ,'/w,carabiners/en,'/w,,/w, ,'/w,crampons/en,'/w,,/w, ,'/w,gloves/en,'/w,,/w, ,'/w,hardshell/en,_,jackets/en,'/w,,/w, ,'/w,harnesses/en,'/w,,/w, ,'/w,helmets/en,'/w,,/w, ,'/w,insulated/en,_,jackets/en,'/w,,/w, ,'/w,pulleys/en,'/w,,/w, ,'/w,rope/en,'/w,,/w, ,'/w,tents/en,'/w,]/w, ,train/en,_,data/en, ,=/w, ,[/w,]/w, ,y/en, ,=/w, ,[/w,]/w, ,import/en, ,os/en, ,from/en, ,pil/en, ,import/en, ,image/en, ,for/en, ,equip/en,_,name/en, ,in/en, ,equipments/en,:/w, ,dir/en,_,equip/en, ,=/w, ,dir/en,_,data/en, ,+/w, ,equip/en,_,name/en, ,for/en, ,filename/en, ,in/en, ,os/en,./w,listdir/en,(/w,dir/en,_,equip/en,)/w,:/w, ,if/en,(/w,filename/en,./w,find/en,(/w,'/w,jpeg/en,'/w,)/w,!/w,=/w,-/w,1/m,)/w,:/w, ,name/en, ,=/w, ,dir/en,_,equip/en, ,+/w, ,'/w,//w,'/w, ,+/w, ,filename/en, ,img/en, ,=/w, ,image/en,./w,open/en,(/w,name/en,)/w,./w,convert/en,(/w,'/w,l/en,'/w,)/w, ,train/en,_,data/en,./w,append/en,(/w,list/en,(/w,img/en,./w,getdata/en,(/w,)/w,)/w,)/w, ,y/en,./w,append/en,(/w,equip/en,_,name/en,)/w,view/en, ,codefrom/en, ,sklearn/en, ,import/en, ,svm/en, ,from/en, ,sklearn/en,./w,cross/en,_,validation/en, ,import/en, ,train/en,_,test/en,_,split/en, ,train/en,_,x/en,,/w,test/en,_,x/en,,/w, ,train/en,_,y/en,,/w, ,test/en,_,y/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,train/en,_,data/en,,/w, ,y/en,,/w, ,test/en,_,size/en, ,=/w, ,0.3/m,,/w, ,random/en,_,state/en, ,=/w, ,0/m,)/w, ,from/en, ,sklearn/en, ,import/en, ,neighbors/en, ,from/en, ,sklearn/en,./w,metrics/en, ,import/en, ,precision/en,_,recall/en,_,fscore/en,_,support/en, ,as/en, ,score/en, ,from/en, ,sklearn/en,./w,metrics/en, ,import/en, ,precision/en,_,score/en,,/w,recall/en,_,score/en, ,clf/en,_,knn/en, ,=/w, ,neighbors/en,./w,kneighborsclassifier/en,(/w,algorithm/en,=/w,'/w,kd/en,_,tree/en,'/w,)/w, ,clf/en,_,knn/en,./w,fit/en,(/w,train/en,_,x/en,,/w, ,train/en,_,y/en,)/w, ,y/en,_,pred/en, ,=/w, ,clf/en,_,knn/en,./w,predict/en,(/w,test/en,_,x/en,)/w,view/en, ,codeprint/en,(/w,_,_,doc/en,_,_,)/w, ,import/en, ,itertools/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,from/en, ,sklearn/en, ,import/en, ,svm/en,,/w, ,datasets/en, ,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,train/en,_,test/en,_,split/en, ,from/en, ,sklearn/en,./w,metrics/en, ,import/en, ,confusion/en,_,matrix/en, ,def/en, ,plot/en,_,confusion/en,_,matrix/en,(/w,cm/en,,/w, ,classes/en,,/w, ,normalize/en,=/w,false/en,,/w, ,title/en,=/w,'/w,confusion/en, ,matrix/en,'/w,,/w, ,cmap/en,=/w,plt/en,./w,cm/en,./w,blues/en,)/w,:/w, ,"/w,"/w,"/w, ,this/en, ,function/en, ,prints/en, ,and/en, ,plots/en, ,the/en, ,confusion/en, ,matrix/en,./w, ,normalization/en, ,can/en, ,be/en, ,applied/en, ,by/en, ,setting/en, ,`,normalize/en,=/w,true/en,`,./w, ,"/w,"/w,"/w, ,if/en, ,normalize/en,:/w, ,cm/en, ,=/w, ,cm/en,./w,astype/en,(/w,'/w,float/en,'/w,)/w, ,//w, ,cm/en,./w,sum/en,(/w,axis/en,=/w,1/m,)/w,[/w,:/w,,/w, ,np/en,./w,newaxis/en,]/w, ,print/en,(/w,"/w,normalized/en, ,confusion/en, ,matrix/en,"/w,)/w, ,else/en,:/w, ,print/en,(/w,'/w,confusion/en, ,matrix/en,,/w, ,without/en, ,normalization/en,'/w,)/w, ,print/en,(/w,cm/en,)/w, ,plt/en,./w,imshow/en,(/w,cm/en,,/w, ,interpolation/en,=/w,'/w,nearest/en,'/w,,/w, ,cmap/en,=/w,cmap/en,)/w, ,plt/en,./w,title/en,(/w,title/en,)/w, ,plt/en,./w,colorbar/en,(/w,)/w, ,tick/en,_,marks/en, ,=/w, ,np/en,./w,arange/en,(/w,len/en,(/w,classes/en,)/w,)/w, ,plt/en,./w,xticks/en,(/w,tick/en,_,marks/en,,/w, ,classes/en,,/w, ,rotation/en,=/w,45/m,)/w, ,plt/en,./w,yticks/en,(/w,tick/en,_,marks/en,,/w, ,classes/en,)/w, ,fmt/en, ,=/w, ,'/w,./w,2/m,f/en,'/w, ,if/en, ,normalize/en, ,else/en, ,'/w,d/en,'/w, ,thresh/en, ,=/w, ,cm/en,./w,max/en,(/w,)/w, ,//w, ,2/m,./w, ,for/en, ,i/en,,/w, ,j/en, ,in/en, ,itertools/en,./w,product/en,(/w,range/en,(/w,cm/en,./w,shape/en,[/w,0/m,]/w,)/w,,/w, ,range/en,(/w,cm/en,./w,shape/en,[/w,1/m,]/w,)/w,)/w,:/w, ,plt/en,./w,text/en,(/w,j/en,,/w, ,i/en,,/w, ,format/en,(/w,cm/en,[/w,i/en,,/w, ,j/en,]/w,,/w, ,fmt/en,)/w,,/w, ,horizontalalignment/en,=/w,"/w,center/en,"/w,,/w, ,color/en,=/w,"/w,white/en,"/w, ,if/en, ,cm/en,[/w,i/en,,/w, ,j/en,]/w, ,>, ,thresh/en, ,else/en, ,"/w,black/en,"/w,)/w, ,plt/en,./w,tight/en,_,layout/en,(/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,true/en, ,label/en,'/w,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,predicted/en, ,label/en,'/w,)/w, ,#, ,compute/en, ,confusion/en, ,matrix/en, ,#, ,cnf/en,_,matrix/en, ,=/w, ,confusion/en,_,matrix/en,(/w,y/en,_,test/en,,/w, ,y/en,_,pred/en,)/w, ,np/en,./w,set/en,_,printoptions/en,(/w,precision/en,=/w,2/m,)/w, ,confusion/en,_,mat/en, ,=/w, ,confusion/en,_,matrix/en,(/w,test/en,_,y/en,,/w, ,y/en,_,pred/en,,/w, ,labels/en, ,=/w, ,equipments/en,)/w, ,#, ,plot/en, ,non/en,-/w,normalized/en, ,confusion/en, ,matrix/en, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,10/m,,/w,10/m,)/w,)/w, ,plot/en,_,confusion/en,_,matrix/en,(/w,confusion/en,_,mat/en,,/w, ,classes/en,=/w,equipments/en,,/w, ,title/en,=/w,'/w,confusion/en, ,matrix/en,,/w, ,without/en, ,normalization/en,'/w,)/w, ,#, ,plot/en, ,normalized/en, ,confusion/en, ,matrix/en, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,10/m,,/w,10/m,)/w,)/w, ,plot/en,_,confusion/en,_,matrix/en,(/w,confusion/en,_,mat/en,,/w, ,classes/en,=/w,equipments/en,,/w, ,normalize/en,=/w,true/en,,/w, ,title/en,=/w,'/w,normalized/en, ,confusion/en, ,matrix/en,'/w,)/w, ,plt/en,./w,show/en,(/w,)/w,view/en, ,code/en,因为/c,要求/v,精确度/n,>,0.8/m,，/w,sklearn/en,中/f,的/u,很多/m,算法/n,应该/v,都/d,能/v,满足/v,，/w,我/r,选择/v,了/u,准确度/n,比较/d,高/a,的/u,knn/en,来/v,建模/vn,，/w,应该/v,足够/v,用/p,了/u,算/v,一下/m,presion/en,和/c,recall/en,，/w,轻松/a,超越/v,0.8/m,题目/n,4/m,挑战/vn,完成/v,标准/n,，/w,使用/v,深度/n,学习/v,模型/n,，/w,如/v,cnn/en,分析/vn,复杂/a,数据/n,团队/n,将/d,在/p,jupyter/en, ,notebook/en,上/f,为/p,教练/n,运行/vn,一个/m,代码/n,单元/n,，/w,展示/v,模型/n,的/u,准确度/n,为/p,90/m,％/w,或/c,更/d,高/a,准确度/n,如果/c,要/v,>,0.9/m,，/w,sklearn/en,中/f,的/u,机器/n,学习/v,算法/n,就/d,很/d,难/a,达到/v,了/u,，/w,关键/n,时刻/n,只能/v,上/f,cnnimport/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,from/en, ,pil/en, ,import/en, ,imagecolor/en, ,from/en, ,matplotlib/en,./w,pyplot/en, ,import/en, ,imshow/en, ,from/en, ,pil/en, ,import/en, ,image/en, ,from/en, ,pylab/en, ,import/en, ,*/w, ,dir/en,_,data/en, ,=/w,"/w,data/en,//w,preprocess/en,_,images/en,//w,"/w, ,equipments/en, ,=/w, ,[/w,'/w,axes/en,'/w,,/w, ,'/w,boots/en,'/w,,/w, ,'/w,carabiners/en,'/w,,/w, ,'/w,crampons/en,'/w,,/w, ,'/w,gloves/en,'/w,,/w, ,'/w,hardshell/en,_,jackets/en,'/w,,/w, ,'/w,harnesses/en,'/w,,/w, ,'/w,helmets/en,'/w,,/w, ,'/w,insulated/en,_,jackets/en,'/w,,/w, ,'/w,pulleys/en,'/w,,/w, ,'/w,rope/en,'/w,,/w, ,'/w,tents/en,'/w,]/w, ,train/en,_,data/en, ,=/w, ,[/w,]/w, ,y/en, ,=/w, ,[/w,]/w, ,import/en, ,os/en, ,from/en, ,pil/en, ,import/en, ,image/en, ,i/en,=/w,0/m, ,for/en, ,equip/en,_,name/en, ,in/en, ,equipments/en,:/w, ,dir/en,_,equip/en, ,=/w, ,dir/en,_,data/en, ,+/w, ,equip/en,_,name/en, ,for/en, ,filename/en, ,in/en, ,os/en,./w,listdir/en,(/w,dir/en,_,equip/en,)/w,:/w, ,if/en,(/w,filename/en,./w,find/en,(/w,'/w,jpeg/en,'/w,)/w,!/w,=/w,-/w,1/m,)/w,:/w, ,name/en, ,=/w, ,dir/en,_,equip/en, ,+/w, ,'/w,//w,'/w, ,+/w, ,filename/en, ,img/en, ,=/w, ,image/en,./w,open/en,(/w,name/en,)/w,./w,convert/en,(/w,'/w,l/en,'/w,)/w, ,train/en,_,data/en,./w,append/en,(/w,array/en,(/w,img/en,)/w,./w,tolist/en,(/w,)/w,)/w, ,y/en,./w,append/en,(/w,i/en,)/w, ,i/en, ,+/w,=/w, ,1/m, ,train/en,_,data/en, ,=/w, ,np/en,./w,asarray/en,(/w,train/en,_,data/en,)/w,view/en, ,codefrom/en, ,sklearn/en, ,import/en, ,svm/en, ,from/en, ,sklearn/en,./w,cross/en,_,validation/en, ,import/en, ,train/en,_,test/en,_,split/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,import/en, ,keras/en, ,num/en,_,classes/en,=/w,12/m, ,img/en,_,rows/en,=/w,128/m, ,img/en,_,cols/en,=/w,128/m, ,train/en,_,x/en,,/w, ,test/en,_,x/en,,/w, ,train/en,_,y/en,,/w, ,test/en,_,y/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,train/en,_,data/en,,/w, ,y/en,,/w, ,test/en,_,size/en, ,=/w, ,0.3/m,,/w, ,random/en,_,state/en, ,=/w, ,0/m,)/w, ,train/en,_,x/en, ,=/w, ,train/en,_,x/en,./w,reshape/en,(/w,train/en,_,x/en,./w,shape/en,[/w,0/m,]/w,,/w, ,img/en,_,rows/en,,/w, ,img/en,_,cols/en,,/w, ,1/m,)/w, ,test/en,_,x/en, ,=/w, ,test/en,_,x/en,./w,reshape/en,(/w,test/en,_,x/en,./w,shape/en,[/w,0/m,]/w,,/w, ,img/en,_,rows/en,,/w, ,img/en,_,cols/en,,/w, ,1/m,)/w, ,train/en,_,x/en, ,=/w, ,train/en,_,x/en,./w,astype/en,(/w,'/w,float/en,32/m,'/w,)/w, ,test/en,_,x/en, ,=/w, ,test/en,_,x/en,./w,astype/en,(/w,'/w,float/en,32/m,'/w,)/w, ,train/en,_,x/en, ,//w,=/w, ,255/m, ,test/en,_,x/en, ,//w,=/w, ,255/m, ,print/en,(/w,'/w,x/en,_,train/en, ,shape/en,:/w,'/w,,/w, ,train/en,_,x/en,./w,shape/en,)/w, ,print/en,(/w,train/en,_,x/en,./w,shape/en,[/w,0/m,]/w,,/w, ,'/w,train/en, ,samples/en,'/w,)/w, ,print/en,(/w,test/en,_,x/en,./w,shape/en,[/w,0/m,]/w,,/w, ,'/w,test/en, ,samples/en,'/w,)/w, ,#, ,convert/en, ,class/en, ,vectors/en, ,to/en, ,binary/en, ,class/en, ,matrices/en, ,train/en,_,y/en, ,=/w, ,keras/en,./w,utils/en,./w,to/en,_,categorical/en,(/w,train/en,_,y/en,,/w, ,num/en,_,classes/en,)/w, ,test/en,_,y/en, ,=/w, ,keras/en,./w,utils/en,./w,to/en,_,categorical/en,(/w,test/en,_,y/en,,/w, ,num/en,_,classes/en,)/w,view/en, ,codefrom/en, ,keras/en,./w,layers/en, ,import/en, ,dense/en,,/w, ,activation/en,,/w, ,convolution/en,2/m,d/en,,/w, ,maxpooling/en,2/m,d/en,,/w, ,flatten/en, ,from/en, ,keras/en,./w,models/en, ,import/en, ,sequential/en, ,from/en, ,keras/en,./w,layers/en, ,import/en, ,convolution/en,2/m,d/en,,/w,maxpooling/en,2/m,d/en,,/w, ,conv/en,2/m,d/en, ,import/en, ,keras/en, ,model/en, ,=/w, ,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,conv/en,2/m,d/en,(/w,32/m,,/w, ,kernel/en,_,size/en,=/w,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,,/w, ,input/en,_,shape/en,=/w,(/w,128/m,,/w, ,128/m,,/w, ,1/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,maxpooling/en,2/m,d/en,(/w,pool/en,_,size/en,=/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,conv/en,2/m,d/en,(/w,64/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,maxpool