python/en,机器/n,学习/v,实战/n,（/w,二/m,）/w,版权/n,声明/n,：/w,本文/r,为/p,博主/nr,原创/b,文章/n,，/w,转载/v,请/v,指明/v,转载/v,地址/n,http/en,:/w,//w,//w,www/en,./w,cnblogs/en,./w,com/en,//w,fydeblog/en,//w,p/en,//w,7159775/m,./w,html/en,前言/n,这/r,篇/q,notebook/en,是/v,关于/p,机器/n,学习/v,监督/vn,学习/v,中/f,的/u,决策树/nz,算法/n,，/w,内容/n,包括/v,决策树/nz,算法/n,的/u,构造/v,过程/n,，/w,使用/v,matplotlib/en,库/n,绘制/v,树形图/n,以及/c,使用/v,决策树/nz,预测/v,隐形/b,眼睛/n,类型/n,./w,操作系统/l,：/w,ubuntu/en,14.04/m,（/w,win/en,也/d,ok/en,）/w, , , ,运行/vn,环境/n,：/w,anaconda/en,-/w,python/en,2.7/m,-/w,jupyter/en, ,notebook/en, , , , ,参考/v,书籍/n,：/w,机器/n,学习/v,实战/n,和/c,源码/nw, , , ,notebook/en, ,writer/en, ,----/nrf,方阳/nr,注意/v,事项/n,：/w,在/p,这里/r,说/v,一句/mq,，/w,默认/v,环境/n,python/en,2.7/m,的/u,notebook/en,，/w,用/p,python/en,3.6/m,的/u,会/v,出/v,问题/n,，/w,还有/v,我/r,的/u,目录/n,可能/v,跟/p,你们/r,的/u,不/d,一样/u,，/w,你们/r,自己/r,跑/v,的/u,时候/n,记得/v,改/v,目录/n,，/w,我/r,会/v,把/p,notebook/en,和/c,代码/n,以及/c,数据集/nw,放到/v,结尾/v,的/u,百度/nt,云盘/nw,，/w,方便/a,你们/r,下载/v,！/w,决策树/nz,原理/n,：/w,不断/d,通过/p,数据集/nw,的/u,特征/n,来/v,划分/v,数据集/nw,，/w,直到/v,遍历/nw,所有/b,划分/v,数据集/nw,的/u,属性/n,，/w,或/c,每个/r,分支/n,下/f,的/u,实例/n,都/d,具有/v,相同/a,的/u,分类/vn,，/w,决策树/nz,算法/n,停止/v,运行/vn,。/w,决策树/nz,的/u,优缺点/n,及/c,适用/v,类型/n,优点/n, ,:/w,计算/v,复杂/a,度/q,不/d,高/a,,/w, ,输出/v,结果/n,易于/v,理解/v,,/w,对/p,中间值/nw,的/u,缺失/n,不/d,敏感/a,,/w,可以/v,处理/v,不/d,相关/v,特征/n,数据/n,。/w,缺点/n, ,:/w,可能/v,会/v,产生/v,过度/d,匹配/vn,问题/n,。/w,适用/v,数据/n,类型/n,:/w,数值/n,型/k,和/c,标称型/nw,先举/nw,一个/m,小/a,例子/n,，/w,让/v,你/r,了解/v,决策树/nz,是/v,干/v,嘛/y,的/u,，/w,简单/a,来说/u,，/w,决策树/nz,算法/n,就/d,是/v,一种/mq,基于/p,特征/n,的/u,分类器/nw,，/w,拿/v,邮件/n,来说/u,吧/y,，/w,试想/v,一下/m,，/w,邮件/n,的/u,类型/n,有/v,很多/m,种/q,，/w,有/v,需要/v,及时/ad,处理/v,的/u,邮件/n,，/w,无聊/a,是/v,观看/v,的/u,邮件/n,，/w,垃圾/n,邮件/n,等等/u,，/w,我们/r,需要/v,去/v,区分/v,这些/r,，/w,比如/v,根据/p,邮件/n,中/f,出现/v,里/f,你/r,的/u,名字/n,还有/v,你/r,朋友/n,的/u,名字/n,，/w,这些/r,特征/n,就/d,会/v,就/d,可以/v,将/d,邮件/n,分成/v,两类/mq,，/w,需要/v,及时/ad,处理/v,的/u,邮件/n,和/c,其他/r,邮件/n,，/w,这时候/r,在/p,分类/vn,其他/r,邮件/n,，/w,例如/v,邮件/n,中/f,出现/v,buy/en,，/w,money/en,等/u,特征/n,，/w,说明/v,这/r,是/v,垃圾/n,推广/v,文件/n,，/w,又/d,可以/v,将/d,其他/r,文件/n,分成/v,无聊/a,是/v,观看/v,的/u,邮件/n,和/c,垃圾/n,邮件/n,了/u,。/w,1/m,./w,决策树/nz,的/u,构造/v,1.1/m, ,信息/n,增益/v,试想/v,一下/m,，/w,一个/m,数据集/nw,是/v,有/v,多/a,个/q,特征/n,的/u,，/w,我们/r,该/r,从/p,那个/r,特征/n,开始/v,划分/v,呢/y,，/w,什么样/r,的/u,划分/v,方式/n,会/v,是/v,最/d,好/a,的/u,？/w,我们/r,知道/v,划分/v,数据集/nw,的/u,大/a,原则/n,是/v,将/d,无序/b,的/u,数据/n,变/v,得/u,更加/d,有序/a,，/w,这样/r,才/d,能/v,分类/vn,得/u,更加/d,清楚/a,，/w,这里/r,就/d,提出/v,了/u,一种/mq,概念/n,，/w,叫做/v,信息/n,增益/v,，/w,它/r,的/u,定义/n,是/v,在/p,划分/v,数据集/nw,之前/f,之后/f,信息/n,发生/v,的/u,变化/vn,，/w,变化/vn,越/d,大/a,，/w,证明/v,划分/v,得/u,越/d,好/a,，/w,所以/c,在/p,划分/v,数据集/nw,的/u,时候/n,，/w,获得/v,增益/v,最/d,高/a,的/u,特征/n,就/d,是/v,最/d,好/a,的/u,选择/v,。/w,这里/r,又/d,会/v,扯/v,到/v,另/r,一个/m,概念/n,，/w,信息论/n,中/f,的/u,熵/g,，/w,它/r,是/v,集合/v,信息/n,的/u,度量/v,方式/n,，/w,熵/g,变化/vn,越/d,大/a,，/w,信息/n,增益/v,也/d,就/d,越/d,大/a,。/w,信息/n,增益/v,是/v,熵/g,的/u,减少/v,或者/c,是/v,数据/n,无序度/nw,的/u,减少/v,./w,一个/m,符号/n,x/en,在/p,信息论/n,中/f,的/u,信息/n,定义/n,是/v, ,l/en,(/w,x/en,)/w,=/w, ,-/w,log/en,(/w,p/en,(/w,x/en,)/w,)/w, ,,/w,这里/r,都/d,是/v,以/p,2/m,为/p,底/f,，/w,不再/d,复述/vn,。/w,则/d,熵/g,的/u,计算/v,公式/n,是/v, ,h/en, ,=/w,-/w,∑/w,p/en,(/w,xi/en,)/w,log/en,(/w,p/en,(/w,xi/en,)/w,)/w, ,(/w,i/en,=/w,1/m,,/w,2/m,,/w,./w,./w,n/en,)/w,下面/f,开始/v,实现/v,给/p,定/v,数据集/nw,，/w,计算/v,熵/g,参考/v,代码/n,：/w,1/m, ,from/en, ,math/en, ,import/en, ,log/en, ,#,we/en, ,use/en, ,log/en, ,function/en, ,to/en, ,calculate/en, ,the/en, ,entropy/en, ,2/m, ,import/en, ,operator/en,1/m, ,def/en, ,calcshannonent/en,(/w,dataset/en,)/w,:/w, ,2/m, ,numentries/en, ,=/w, ,len/en,(/w,dataset/en,)/w, ,3/m, ,labelcounts/en, ,=/w, ,{/w,}/w, ,4/m, ,for/en, ,featvec/en, ,in/en, ,dataset/en,:/w, ,#,the/en, ,the/en, ,number/en, ,of/en, ,unique/en, ,elements/en, ,and/en, ,their/en, ,occurance/en, ,5/m, ,currentlabel/en, ,=/w, ,featvec/en,[/w,-/w,1/m,]/w, ,6/m, ,if/en, ,currentlabel/en, ,not/en, ,in/en, ,labelcounts/en,./w,keys/en,(/w,)/w,:/w, ,labelcounts/en,[/w,currentlabel/en,]/w, ,=/w, ,0/m, ,7/m, ,labelcounts/en,[/w,currentlabel/en,]/w, ,+/w,=/w, ,1/m, ,8/m, ,shannonent/en, ,=/w, ,0.0/m, ,9/m, ,for/en, ,key/en, ,in/en, ,labelcounts/en,:/w, ,10/m, ,prob/en, ,=/w, ,float/en,(/w,labelcounts/en,[/w,key/en,]/w,)/w,//w,numentries/en, ,11/m, ,shannonent/en, ,-/w,=/w, ,prob/en, ,*/w, ,log/en,(/w,prob/en,,/w,2/m,)/w, ,#,log/en, ,base/en, ,2/m, ,12/m, ,return/en, ,shannonent/en,程序/n,思路/n,：/w, ,首先/d,计算/v,数据/n,集中/v,实例/n,的/u,总数/n,,/w,由于/c,代码/n,中/f,多次/m,用/p,到/v,这个/r,值/n,,/w,为了/p,提高/v,代码/n,效率/n,,/w,我们/r,显式/nw,地/u,声明/n,一个/m,变量/n,保存/v,实例/n,总数/n,./w, ,然后/c, ,,/w,创建/v,一个/m,数据/n,字典/n,labelcounts/en,,/w,它/r,的/u,键值/nr,是/v,最后/f,一列/mq,（/w,分类/vn,的/u,结果/n,）/w,的/u,数值/n,./w,如果/c,当前/t,键值/nr,不/d,存在/v,,/w,则/d,扩展/v,字典/n,并/c,将/d,当前/t,键值/nr,加入/v,字典/n,。/w,每个/r,键值/nr,都/d,记录/v,了/u,当前/t,类别/n,出现/v,的/u,次数/n,。/w, ,最后/f, ,,/w, ,使用/v,所有/b,类/q,标签/n,的/u,发生/v,频率/n,计算/v,类别/n,出现/v,的/u,概率/n,。/w,我们/r,将/d,用/p,这个/r,概率/n,计算/v,香/a,农熵/nr,。/w,让/v,我们/r,来/v,测试/vn,一下/m,，/w,先/d,自己/r,定义/n,一个/m,数据集/nw,下/f,表/n,的/u,数据/n,包含/v, ,5/m, ,个/q,海洋/n,动物/n,,/w,特征/n,包括/v,:/w,不/d,浮/v,出/v,水面/n,是否/v,可以/v,生存/v,,/w,以及/c,是否/v,有/v,脚蹼/n,。/w,我们/r,可以/v,将/d,这些/r,动物/n,分成/v,两类/mq,:/w, ,鱼类/n,和/c,非/h,鱼类/n,。/w,根据/p,上面/f,的/u,表格/n,，/w,我们/r,可以/v,定义/n,一个/m,createdataset/en,函数/n,参考/v,代码/n,如下/v,1/m, ,def/en, ,createdataset/en,(/w,)/w,:/w, ,2/m, ,dataset/en, ,=/w, ,[/w,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,3/m, ,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,4/m, ,[/w,1/m,,/w, ,0/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,5/m, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,6/m, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,]/w, ,7/m, ,labels/en, ,=/w, ,[/w,'/w,no/en, ,surfacing/en,'/w,,/w,'/w,flippers/en,'/w,]/w, ,8/m, ,#,change/en, ,to/en, ,discrete/en, ,values/en, ,9/m, ,return/en, ,dataset/en,,/w, ,labels/en,把/p,所有/b,的/u,代码/n,都/d,放在/v,trees/en,./w,py/en,中/f,（/w,以下/f,在/p,jupyter/en,）/w,cd/en, ,//w,home/en,//w,fangyang/en,//w,桌面/n,//w,machinelearninginaction/en,//w,ch/en,03/m,//w,home/en,//w,fangyang/en,//w,桌面/n,//w,machinelearninginaction/en,//w,ch/en,03/m,import/en, ,treesmydat/en,,/w, ,labels/en, ,=/w, ,trees/en,./w,createdataset/en,(/w,)/w,mydat/en, ,#,old/en, ,data/en, ,set/en,[/w,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,0/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,]/w,labels/en,[/w,'/w,no/en, ,surfacing/en,'/w,,/w, ,'/w,flippers/en,'/w,]/w,trees/en,./w,calcshannonent/en,(/w,mydat/en,)/w, ,#,calculate/en, ,the/en, ,entropy/en,0.9709505944546686/m,mydat/en,[/w,0/m,]/w,[/w,-/w,1/m,]/w,=/w,'/w,maybe/en,'/w, ,#,change/en, ,the/en, ,result/en, ,,/w,and/en, ,look/en, ,again/en, ,the/en, ,entropymydat/en, ,#,new/en, ,data/en, ,set/en,[/w,[/w,1/m,,/w, ,1/m,,/w, ,'/w,maybe/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,0/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,]/w,trees/en,./w,calcshannonent/en,(/w,mydat/en,)/w, ,#, ,the/en, ,new/en, ,entropy/en,1.3709505944546687/m,我们/r,可以/v,看到/v,当/p,结果/n,分类/vn,改变/v,，/w,熵/g,也/d,发生/v,里/f,变化/vn,，/w,主要/b,是/v,因为/c,最后/f,的/u,结果/n,发生/v,里/f,改变/v,，/w,相应/v,的/u,概率/n,也/d,发生/v,了/u,改变/v,，/w,根据/p,公式/n,，/w,熵/g,也/d,会/v,改变/v,1.2/m, ,划分/v,数据集/nw,前面/f,已经/d,得到/v,了/u,如何/r,去/v,求/v,信息/n,熵/g,的/u,函数/n,，/w,但/c,我们/r,的/u,划分/v,是/v,以/p,哪个/r,特征/n,划分/v,的/u,呢/y,，/w,不/d,知道/v,，/w,所以/c,我们/r,还要/v,写/v,一个/m,以/p,给/p,定/v,特征/n,划分/v,数据集/nw,的/u,函数/n,。/w,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,splitdataset/en,(/w,dataset/en,,/w, ,axis/en,,/w, ,value/en,)/w,:/w, ,2/m, ,retdataset/en, ,=/w, ,[/w,]/w, ,3/m, ,for/en, ,featvec/en, ,in/en, ,dataset/en,:/w, ,4/m, ,if/en, ,featvec/en,[/w,axis/en,]/w, ,=/w,=/w, ,value/en,:/w, ,5/m, ,reducedfeatvec/en, ,=/w, ,featvec/en,[/w,:/w,axis/en,]/w, ,#,chop/en, ,out/en, ,axis/en, ,used/en, ,for/en, ,splitting/en, ,6/m, ,reducedfeatvec/en,./w,extend/en,(/w,featvec/en,[/w,axis/en,+/w,1/m,:/w,]/w,)/w, ,7/m, ,retdataset/en,./w,append/en,(/w,reducedfeatvec/en,)/w, ,8/m, ,return/en, ,retdataset/en,函数/n,的/u,三个/m,输人/n,参数/n,:/w,待/v,划分/v,的/u,数据集/nw,（/w,dataset/en,）/w,、/w,划分/v,数据集/nw,的/u,特征/n,（/w,axis/en,）/w,、/w,特征/n,的/u,返回值/nw,（/w,value/en,）/w,。/w,输出/v,是/v,划分/v,后/f,的/u,数据集/nw,（/w,retdataset/en,）/w,小/a,知识/n,：/w,python/en,语言/n,在/p,函数/n,中/f,传递/v,的/u,是/v,列表/v,的/u,引用/v, ,,/w,在/p,函数/n,内部/f,对/p,列表/v,对象/n,的/u,修改/v,,/w, ,将/d,会/v,影响/vn,该/r,列表/v,对象/n,的/u,整个/b,生存/v,周期/n,。/w,为了/p,消除/v,这个/r,不良/a,影响/vn, ,,/w,我们/r,需要/v,在/p,函数/n,的/u,开始/v,声明/n,一个/m,新/a,列表/v,对象/n,。/w, ,因为/c,该/r,函数/n,代码/n,在/p,同一/b,数据集/nw,上/f,被/p,调用/v,多次/m,,/w,为了/p,不/d,修改/v,原始/a,数据集/nw,,/w,创建/v,一个/m,新/a,的/u,列表/v,对象/n,retdataset/en,这个/r,函数/n,也/d,挺/d,简单/a,的/u,，/w,根据/p,axis/en,的/u,值/n,所/u,指/v,的/u,对象/n,来/v,进行/v,划分/v,数据集/nw,，/w,比如/v,axis/en,=/w,0/m,，/w,就/d,按照/p,第一/m,个/q,特征/n,来/v,划分/v,，/w,featvec/en,[/w,:/w,axis/en,]/w,就/d,是/v,空/a,,/w,下面/f,经过/p,一个/m,extend/en,函数/n,，/w,将/d,featvec/en,[/w,axis/en,+/w,1/m,:/w,]/w,后面/f,的/u,数/m,存/v,到/v,reducefeatvec/en,中/f,，/w,然后/c,通过/p,append/en,函数/n,以/p,列表/v,的/u,形式/n,存/v,到/v,retdataset/en,中/f,。/w,这里/r,说/v,一下/m,entend/en,和/c,append/en,函数/n,的/u,功能/n,，/w,举/v,个/q,例子/n,吧/y,a/en,=/w,[/w,1/m,,/w,2/m,,/w,3/m,]/w, ,b/en,=/w,[/w,4/m,,/w,5/m,,/w,6/m,]/w, ,a/en,./w,append/en,(/w,b/en,)/w,a/en,[/w,1/m,,/w, ,2/m,,/w, ,3/m,,/w, ,[/w,4/m,,/w, ,5/m,,/w, ,6/m,]/w,]/w,a/en,=/w,[/w,1/m,,/w,2/m,,/w,3/m,]/w, ,a/en,./w,extend/en,(/w,b/en,)/w,a/en,[/w,1/m,,/w, ,2/m,,/w, ,3/m,,/w, ,4/m,,/w, ,5/m,,/w, ,6/m,]/w,可见/v,append/en,函数/n,是/v,直接/ad,将/d,b/en,的/u,原型/n,导入/v,a/en,中/f,，/w,extend/en,是/v,将/d,b/en,中/f,的/u,元素/n,导入/v,到/v,a/en,中/f,下面/f,再/d,来/v,测/v,试一下/n,mydat/en,,/w, ,labels/en, ,=/w, ,trees/en,./w,createdataset/en,(/w,)/w, ,#,initializationmydat/en,[/w,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,0/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,1/m,,/w, ,'/w,no/en,'/w,]/w,]/w,trees/en,./w,splitdataset/en,(/w,mydat/en,,/w,0/m,,/w,1/m,)/w, ,#,choose/en, ,the/en, ,first/en, ,character/en, ,to/en, ,split/en, ,the/en, ,dataset/en,[/w,[/w,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,'/w,yes/en,'/w,]/w,,/w, ,[/w,0/m,,/w, ,'/w,no/en,'/w,]/w,]/w,trees/en,./w,splitdataset/en,(/w,mydat/en,,/w,0/m,,/w,0/m,)/w,#, ,change/en, ,the/en, ,value/en, ,,/w,look/en, ,the/en, ,difference/en, ,of/en, ,previous/en, ,results/en,[/w,[/w,1/m,,/w, ,'/w,no/en,'/w,]/w,,/w, ,[/w,1/m,,/w, ,'/w,no/en,'/w,]/w,]/w,好/a,了/u,，/w,我们/r,知道/v,了/u,怎样/r,以/p,某个/r,特征/n,划分/v,数据集/nw,了/u,，/w,但/c,我们/r,需要/v,的/u,是/v,最/d,好/a,的/u,数据集/nw,划分/v,方式/n,，/w,所以/c,要/v,结合/v,前面/f,两个/m,函数/n,，/w,计算/v,以/p,每个/r,特征/n,为/p,划分/v,方式/n,，/w,相应/v,最后/f,的/u,信息熵/nz,，/w,我们/r,要/v,找到/v,最/d,大/a,信息/n,熵/g,，/w,它/r,所/u,对应/v,的/u,特征/n,就/d,是/v,我们/r,要/v,找/v,的/u,最/d,好/a,划分/v,方式/n,。/w,所以/c,有/v,了/u,函数/n,choosebestfeaturetospilt/en,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,choosebestfeaturetosplit/en,(/w,dataset/en,)/w,:/w, ,2/m, ,numfeatures/en, ,=/w, ,len/en,(/w,dataset/en,[/w,0/m,]/w,)/w, ,-/w, ,1/m, ,#,the/en, ,last/en, ,column/en, ,is/en, ,used/en, ,for/en, ,the/en, ,labels/en, ,3/m, ,baseentropy/en, ,=/w, ,calcshannonent/en,(/w,dataset/en,)/w, ,#,calculate/en, ,the/en, ,original/en, ,entropy/en, ,4/m, ,bestinfogain/en, ,=/w, ,0.0/m,;/w, ,bestfeature/en, ,=/w, ,-/w,1/m, ,5/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numfeatures/en,)/w,:/w, ,#,iterate/en, ,over/en, ,all/en, ,the/en, ,features/en, ,6/m, ,featlist/en, ,=/w, ,[/w,example/en,[/w,i/en,]/w, ,for/en, ,example/en, ,in/en, ,dataset/en,]/w,#,create/en, ,a/en, ,list/en, ,of/en, ,all/en, ,the/en, ,examples/en, ,of/en, ,this/en, ,feature/en, ,7/m, ,uniquevals/en, ,=/w, ,set/en,(/w,featlist/en,)/w, ,#,get/en, ,a/en, ,set/en, ,of/en, ,unique/en, ,values/en, ,8/m, ,newentropy/en, ,=/w, ,0.0/m, ,9/m, ,for/en, ,value/en, ,in/en, ,uniquevals/en,:/w, ,10/m, ,subdataset/en, ,=/w, ,splitdataset/en,(/w,dataset/en,,/w, ,i/en,,/w, ,value/en,)/w, ,11/m, ,prob/en, ,=/w, ,len/en,(/w,subdataset/en,)/w,//w,float/en,(/w,len/en,(/w,dataset/en,)/w,)/w, ,12/m, ,newentropy/en, ,+/w,=/w, ,prob/en, ,*/w, ,calcshannonent/en,(/w,subdataset/en,)/w, ,13/m, ,infogain/en, ,=/w, ,baseentropy/en, ,-/w, ,newentropy/en, ,#,calculate/en, ,the/en, ,info/en, ,gain/en,;/w, ,ie/en, ,reduction/en, ,in/en, ,entropy/en, ,14/m, ,if/en, ,(/w,infogain/en, ,>, ,bestinfogain/en,)/w,:/w, ,#,compare/en, ,this/en, ,to/en, ,the/en, ,best/en, ,gain/en, ,so/en, ,far/en, ,15/m, ,bestinfogain/en, ,=/w, ,infogain/en, ,#,if/en, ,better/en, ,than/en, ,current/en, ,best/en,,/w, ,set/en, ,to/en, ,best/en, ,16/m, ,bestfeature/en, ,=/w, ,i/en, ,17/m, ,return/en, ,bestfeature/en, ,#,returns/en, ,an/en, ,integer/en,这个/r,函数/n,就/d,是/v,把/p,前面/f,两个/m,函数/n,整合/vn,起来/v,了/u,，/w,先/d,算/v,出/v,特征/n,的/u,数目/n,，/w,由于/c,最后/f,一个/m,是/v,标签/n,，/w,不/d,算/v,特征/n,，/w,所以/c,以/p,数据集/nw,长度/n,来/v,求/v,特征/n,数/m,时/ng,，/w,要/v,减/v,1/m,。/w,然后/c,求/v,原始/a,的/u,信息熵/nz,，/w,是/v,为了/p,跟/p,新/a,的/u,信息熵/nz,，/w,进行/v,比较/d,，/w,选出/v,变化/vn,最/d,大/a,所/u,对应/v,的/u,特征/n,。/w,这里/r,有/v,一个/m,双重/b,循环/vn,，/w,外/f,循环/vn,是/v,按/p,特征/n,标号/n,进行/v,循环/vn,的/u,，/w,下标/n,从小到大/l,，/w,featlist/en,是/v,特征/n,标号/n,对应/v,下/f,的/u,每个/r,样本/n,的/u,值/n,，/w,是/v,一个/m,列表/v,，/w,而/c,uniquevals/en,是/v,基于/p,这个/r,特征/n,的/u,所有/b,可能/v,的/u,值/n,的/u,集合/v,，/w,内/f,循环/vn,做/v,的/u,是/v,以/p,特征/n,集合/v,中/f,的/u,每/r,一个/m,元素/n,作为/v,划分/v,，/w,最后/f,求得/v,这个/r,特征/n,下/f,的/u,平均/a,信息/n,熵/g,，/w,然后/c,原始/a,的/u,信息/n,熵/g,进行/v,比较/d,，/w,得出/v,信息/n,增益/v,，/w,最后/f,的/u,if/en,语句/n,是/v,要/v,找到/v,最/d,大/a,信息/n,增益/v,，/w,并/c,得到/v,最/d,大/a,信息/n,增益/v,所/u,对应/v,的/u,特征/n,的/u,标号/n,。/w,现在/t,来/v,测试/vn,测试/vn,import/en, ,trees/en, ,mydat/en,,/w, ,labels/en, ,=/w, ,trees/en,./w,createdataset/en,(/w,)/w, ,trees/en,./w,choosebestfeaturetosplit/en,(/w,mydat/en,)/w, ,#,return/en, ,the/en, ,index/en, ,of/en, ,best/en, ,character/en, ,to/en, ,split/en,01.3/m, ,递归/nw,构建/v,决策树/nz,好/a,了/u,，/w,到/v,现在/t,，/w,我们/r,已经/d,知道/v,如何/r,基于/p,最/d,好/a,的/u,属性/n,值/n,去/v,划分/v,数据集/nw,了/u,，/w,现在/t,进行/v,下/f,一步/mq,，/w,如何/r,去/v,构造/v,决策树/nz,决策树/nz,的/u,实现/v,原理/n,：/w,得到/v,原始/a,数据集/nw,,/w, ,然后/c,基于/p,最/d,好/a,的/u,属性/n,值/n,划分/v,数据集/nw,,/w,由于/c,特征/n,值/n,可能/v,多于/v,两个/m,,/w,因此/c,可能/v,存在/v,大于/v,两个/m,分支/n,的/u,数据集/nw,划分/v,。/w,第一/m,次/q,划分/v,之后/f,,/w, ,数据/n,将/d,被/p,向/p,下/f,传递/v,到/v,树/v,分支/n,的/u,下/f,一个/m,节点/n,,/w, ,在/p,这个/r,节点/n,上/f, ,,/w,我们/r,可以/v,再次/d,划分/v,数据/n,。/w,因此/c,我们/r,可以/v,采用/v,递归/nw,的/u,原则/n,处理/v,数据集/nw,。/w,递归/nw,结束/v,的/u,条件/n,是/v,:/w,程序/n,遍历/nw,完/v,所有/b,划分/v,数据集/nw,的/u,属性/n,,/w, ,或者/c,每个/r,分支/n,下/f,的/u,所有/b,实例/n,都/d,具有/v,相同/a,的/u,分类/vn,。/w,这里/r,先/d,构造/v,一个/m,majoritycnt/en,函数/n,，/w,它/r,的/u,作用/n,是/v,返回/v,出现/v,次数/n,最/d,多/a,的/u,分类/vn,名称/n,，/w,后面/f,会/v,用/p,到/v,def/en, ,majoritycnt/en,(/w,classlist/en,)/w,:/w, ,classcount/en,=/w,{/w,}/w, ,for/en, ,vote/en, ,in/en, ,classlist/en,:/w, ,if/en, ,vote/en, ,not/en, ,in/en, ,classcount/en,./w,keys/en,(/w,)/w,:/w, ,classcount/en,[/w,vote/en,]/w, ,=/w, ,0/m, ,classcount/en,[/w,vote/en,]/w, ,+/w,=/w, ,1/m, ,sortedclasscount/en, ,=/w, ,sorted/en,(/w,classcount/en,./w,iteritems/en,(/w,)/w,,/w, ,key/en,=/w,operator/en,./w,itemgetter/en,(/w,1/m,)/w,,/w, ,reverse/en,=/w,true/en,)/w, ,return/en, ,sortedclasscount/en,[/w,0/m,]/w,[/w,0/m,]/w,这个/r,函数/n,在/p,实战/n,一/m,中/f,的/u,一个/m,函数/n,是/v,一样/u,的/u,，/w,复述/vn,一遍/mq,，/w,classcount/en,定义/n,为/p,存储/vn,字典/n,，/w,每当/p,，/w,由于/c,后面/f,加/v,了/u,1/m,，/w,所以/c,每次/r,出现/v,键值/nr,就/d,加/v,1/m,，/w,就/d,可以/v,就算/d,出/v,键值/nr,出现/v,的/u,次数/n,里/f,。/w,最后/f,通过/p,sorted/en,函数/n,将/d,classcount/en,字典/n,分解/v,为/p,列表/v,，/w,sorted/en,函数/n,的/u,第二/m,个/q,参数/n,导入/v,了/u,运算/vn,符模块/nr,的/u,itemgetter/en,方法/n,，/w,按照/p,第二/m,个/q,元素/n,的/u,次序/n,（/w,即/v,数字/n,）/w,进行/v,排序/vn,，/w,由于/c,此处/s,reverse/en,=/w,true/en,，/w,是/v,逆序/nw,，/w,所以/c,按照/p,从/p,大/a,到/v,小/a,的/u,次序/n,排列/v,。/w,让/v,我们/r,来/v,测/v,试一下/n,import/en, ,numpy/en, ,as/en, ,np/en, ,classlist/en, ,=/w, ,np/en,./w,array/en,(/w,mydat/en,)/w,./w,t/en,[/w,-/w,1/m,]/w,classlistarray/en,(/w,[/w,'/w,yes/en,'/w,,/w, ,'/w,yes/en,'/w,,/w, ,'/w,no/en,'/w,,/w, ,'/w,no/en,'/w,,/w, ,'/w,no/en,'/w,]/w,,/w, ,dtype/en,=/w,'/w,|/w,s/en,21/m,'/w,)/w,majoritycnt/en,(/w,classlist/en,)/w, ,#,the/en, ,number/en, ,of/en, ,'/w,no/en,'/w, ,is/en, ,3/m,,/w, ,'/w,yes/en,'/w, ,is/en, ,2/m,,/w,so/en, ,return/en, ,'/w,no/en,'/w,‘/w,no/en,’/w,接/v,下来/v,是/v,创建/v,决策树/nz,函数/n,代码/n,如下/v,：/w,1/m, ,def/en, ,createtree/en,(/w,dataset/en,,/w,labels/en,)/w,:/w, ,2/m, ,classlist/en, ,=/w, ,[/w,example/en,[/w,-/w,1/m,]/w, ,for/en, ,example/en, ,in/en, ,dataset/en,]/w, ,3/m, ,if/en, ,classlist/en,./w,count/en,(/w,classlist/en,[/w,0/m,]/w,)/w, ,=/w,=/w, ,len/en,(/w,classlist/en,)/w,:/w, ,4/m, ,return/en, ,classlist/en,[/w,0/m,]/w,#,stop/en, ,splitting/en, ,when/en, ,all/en, ,of/en, ,the/en, ,classes/en, ,are/en, ,equal/en, ,5/m, ,if/en, ,len/en,(/w,dataset/en,[/w,0/m,]/w,)/w, ,=/w,=/w, ,1/m,:/w, ,#,stop/en, ,splitting/en, ,when/en, ,there/en, ,are/en, ,no/en, ,more/en, ,features/en, ,in/en, ,dataset/en, ,6/m, ,return/en, ,majoritycnt/en,(/w,classlist/en,)/w, ,7/m, ,bestfeat/en, ,=/w, ,choosebestfeaturetosplit/en,(/w,dataset/en,)/w, ,8/m, ,bestfeatlabel/en, ,=/w, ,labels/en,[/w,bestfeat/en,]/w, ,9/m, ,mytree/en, ,=/w, ,{/w,bestfeatlabel/en,:/w,{/w,}/w,}/w, ,10/m, ,del/en,(/w,labels/en,[/w,bestfeat/en,]/w,)/w, ,#,delete/en, ,the/en, ,best/en, ,feature/en, ,,/w, ,so/en, ,it/en, ,can/en, ,find/en, ,the/en, ,next/en, ,best/en, ,feature/en, ,11/m, ,featvalues/en, ,=/w, ,[/w,example/en,[/w,bestfeat/en,]/w, ,for/en, ,example/en, ,in/en, ,dataset/en,]/w, ,12/m, ,uniquevals/en, ,=/w, ,set/en,(/w,featvalues/en,)/w, ,13/m, ,for/en, ,value/en, ,in/en, ,uniquevals/en,:/w, ,14/m, ,sublabels/en, ,=/w, ,labels/en,[/w,:/w,]/w, ,#,copy/en, ,all/en, ,of/en, ,labels/en,,/w, ,so/en, ,trees/en, ,don/en,'/w,t/en, ,mess/en, ,up/en, ,existing/en, ,labels/en, ,15/m, ,mytree/en,[/w,bestfeatlabel/en,]/w,[/w,value/en,]/w, ,=/w, ,createtree/en,(/w,splitdataset/en,(/w,dataset/en,,/w, ,bestfeat/en,,/w, ,value/en,)/w,,/w,sublabels/en,)/w, ,16/m, ,return/en, ,mytree/en,前面/f,两个/m,if/en,语句/n,是/v,判断/v,分类/vn,是否/v,结束/v,，/w,当/p,所有/b,的/u,类/q,都/d,相等/v,时/ng,，/w,也/d,就/d,是/v,属于/v,同一/b,类/q,时/ng,，/w,结束/v,再/d,分类/vn,，/w,又/d,或/c,特征/n,全部/m,已经/d,分类/vn,完成/v,了/u,，/w,只/d,剩下/v,最后/f,的/u,class/en,，/w,也/d,结束/v,分类/vn,。/w,这/r,是/v,判断/v,递归/nw,结束/v,的/u,两个/m,条件/n,。/w,一般/a,开始/v,的/u,时候/n,是/v,不/d,会/v,运行/vn,这/r,两步/mq,的/u,，/w,先/d,选/v,最/d,好/a,的/u,特征/n,，/w,使用/v, ,choosebestfeaturetosplit/en,函数/n,得到/v,最/d,好/a,的/u,特征/n,，/w,然后/c,进行/v,分类/vn,，/w,这里/r,创建/v,了/u,一个/m,大/a,字典/n,mytree/en,，/w,它/r,将/d,决策树/nz,的/u,整个/b,架构/n,全/a,包含/v,进去/v,,/w,这个/r,等/u,会/v,在/p,测试/vn,的/u,时候/n,说/v,，/w,然后/c,对/p,数据集/nw,进行/v,划分/v,，/w,用/p,splitdataset/en,函数/n,，/w,就/d,可以/v,得到/v,划分/v,后/f,新/a,的/u,数据集/nw,，/w,然后/c,再/d,进行/v,createtrees/en,函数/n,，/w,直到/v,递归/nw,结束/v,。/w,来/v,测/v,试一下/n,mytree/en, ,=/w, ,trees/en,./w,createtree/en,(/w,mydat/en,,/w,labels/en,)/w,mytree/en,{/w,'/w,no/en, ,surfacing/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,}/w,}/w,再/d,来说/u,说/v,上面/f,没/d,详细/ad,说明/v,的/u,大/a,字典/n,，/w,mytree/en,是/v,特征/n,是/v,‘/w,no/en, ,surfacing/en,’/w,,/w,根据/p,这个/r,分类/vn,，/w,得到/v,两个/m,分支/n,‘/w,0/m,’/w,和/c,‘/w,1/m,‘/w,，/w,‘/w,0/m,’/w,分支/n,由于/c,全/a,是/v,同一/b,类/q,就/d,递归/nw,结束/v,里/f,，/w,‘/w,1/m,’/w,分支/n,不/d,满足/v,递归/nw,结束/v,条件/n,，/w,继续/v,进行/v,分类/vn,，/w,它/r,又/d,会/v,生成/vn,它/r,自己/r,的/u,字典/n,，/w,又/d,会/v,分/q,成/v,两个/m,分支/n,，/w,并且/c,这/r,两个/m,分支/n,满足/v,递归/nw,结束/v,的/u,条件/n,，/w,所以/c,返回/v,‘/w,no/en, ,surfacing/en,’/w,上/f,的/u,‘/w,1/m,’/w,分支/n,是/v,一个/m,字典/n,。/w,这种/r,嵌套/v,的/u,字典/n,正是/v,决策树/nz,算法/n,的/u,结果/n,，/w,我们/r,可以/v,使用/v,它/r,和/c,matplotlib/en,来/v,进行/v,画/v,决策/n,1.4/m, ,使用/v,决策树/nz,执行/v,分类/vn,这个/r,就/d,是/v,将/d,测试/vn,合成/v,一个/m,函数/n,，/w,定义/n,为/p,classify/en,函数/n,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,classify/en,(/w,inputtree/en,,/w,featlabels/en,,/w,testvec/en,)/w,:/w, ,2/m, ,firststr/en, ,=/w, ,inputtree/en,./w,keys/en,(/w,)/w,[/w,0/m,]/w, ,3/m, ,seconddict/en, ,=/w, ,inputtree/en,[/w,firststr/en,]/w, ,4/m, ,featindex/en, ,=/w, ,featlabels/en,./w,index/en,(/w,firststr/en,)/w, ,5/m, ,key/en, ,=/w, ,testvec/en,[/w,featindex/en,]/w, ,6/m, ,valueoffeat/en, ,=/w, ,seconddict/en,[/w,key/en,]/w, ,7/m, ,if/en, ,isinstance/en,(/w,valueoffeat/en,,/w, ,dict/en,)/w,:/w, ,8/m, ,classlabel/en, ,=/w, ,classify/en,(/w,valueoffeat/en,,/w, ,featlabels/en,,/w, ,testvec/en,)/w, ,9/m, ,else/en,:/w, ,classlabel/en, ,=/w, ,valueoffeat/en, ,10/m, ,return/en, ,classlabel/en,这个/r,函数/n,就/d,是/v,一个/m,根据/p,决策树/nz,来/v,判断/v,新/a,的/u,测试/vn,向量/n,是/v,那种/r,类型/n,，/w,这/r,也/d,是/v,一个/m,递归/nw,函数/n,，/w,拿/v,上面/f,决策树/nz,的/u,结果/n,来说/u,吧/y,。/w,{/w,'/w,no/en, ,surfacing/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,}/w,}/w,，/w,这/r,是/v,就是/d,我们/r,的/u,inputtree/en,，/w,首先/d,通过/p,函数/n,的/u,第一/m,句/q,话/n,得到/v,它/r,的/u,第一/m,个/q,bestfeat/en,，/w,也/d,就/d,是/v,‘/w,no/en, ,surfacing/en,’/w,，/w,赋/v,给/p,了/u,firststr/en,，/w,seconddict/en,就/d,是/v,‘/w,no/en, ,surfacing/en,’/w,的/u,值/n,，/w,也/d,就/d,是/v, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,}/w,，/w,然后/c,用/p,index/en,函数/n,找到/v,firststr/en,的/u,标号/n,，/w,结果/n,应该/v,是/v,0/m,，/w,根据/p,下标/n,，/w,把/p,测试/vn,向量/n,的/u,值赋/nw,给/p,key/en,，/w,然后/c,找到/v,对应/v,seconddict/en,中/f,的/u,值/n,，/w,这里/r,有/v,一个/m,isinstance/en,函数/n,，/w,功能/n,是/v,第一/m,个/q,参数/n,的/u,类型/n,等于/v,后面/f,参数/n,的/u,类型/n,，/w,则/d,返回/v,true/en,，/w,否则/c,返回/v,false/en,，/w,testvec/en,列表/v,第一/m,位/q,是/v,1/m,，/w,则/d,valueoffeat/en,的/u,值/n,是/v, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,，/w,是/v,dict/en,，/w,则/d,递归/nw,调用/v,这个/r,函数/n,，/w,再/d,进行/v,classify/en,，/w,知道/v,不/d,是/v,字典/n,，/w,也/d,就/d,最后/f,的/u,结果/n,了/u,，/w,其实/d,就/d,是/v,将/d,决策树/nz,过/u,一遍/mq,，/w,找到/v,对应/v,的/u,labels/en,罢了/y,。/w,这里/r,有/v,一个/m,小/a,知识点/nw,，/w,在/p,jupyter/en, ,notebook/en,中/f,，/w,显示/v,绿色/n,的/u,函数/n,，/w,可以/v,通过/p,下面/f,查询/v,它/r,的/u,功能/n,，/w,例如/v,isinstance/en,?/w, ,#,run/en, ,it/en, ,,/w, ,you/en, ,will/en, ,see/en, ,a/en, ,below/en, ,window/en, ,which/en, ,is/en, ,used/en, ,to/en, ,introduce/en, ,this/en, ,function/en,让/v,我们/r,来/v,测试/vn,测试/vn,trees/en,./w,classify/en,(/w,mytree/en,,/w,labels/en,,/w,[/w,1/m,,/w,0/m,]/w,)/w,‘/w,no/en,’/w,trees/en,./w,classify/en,(/w,mytree/en,,/w,labels/en,,/w,[/w,1/m,,/w,1/m,]/w,)/w,‘/w,yes/en,'/w,1.5/m, ,决策树/nz,的/u,存储/vn,构造/v,决策树/nz,是/v,很/d,耗时/v,的/u,任务/n,,/w,即使/c,处理/v,很/d,小/a,的/u,数据集/nw,,/w, ,如/v,前面/f,的/u,样本/n,数据/n,,/w, ,也/d,要/v,花费/v,几/m,秒/q,的/u,时间/n, ,,/w,如果/c,数据集/nw,很大/d,,/w,将/d,会/v,耗费/v,很多/m,计算/v,时间/n,。/w,然而/c,用/p,创建/v,好/a,的/u,决策树/nz,解决/v,分类/vn,问题/n,，/w,可以/v,很快/d,完成/v,。/w,因此/c, ,,/w,为了/p,节省/v,计算/v,时间/n,,/w,最好/d,能够/v,在/p,每次/r,执行/v,分类/vn,时/ng,调用/v,巳经/nw,构造/v,好/a,的/u,决策树/nz,。/w,解决/v,方案/n,：/w,使用/v,pickle/en,模块/n,存储/vn,决策树/nz,参考/v,代码/n,：/w,def/en, ,storetree/en,(/w,inputtree/en,,/w,filename/en,)/w,:/w, ,import/en, ,pickle/en, ,fw/en, ,=/w, ,open/en,(/w,filename/en,,/w,'/w,w/en,'/w,)/w, ,pickle/en,./w,dump/en,(/w,inputtree/en,,/w,fw/en,)/w, ,fw/en,./w,close/en,(/w,)/w, ,def/en, ,grabtree/en,(/w,filename/en,)/w,:/w, ,import/en, ,pickle/en, ,fr/en, ,=/w, ,open/en,(/w,filename/en,)/w, ,return/en, ,pickle/en,./w,load/en,(/w,fr/en,)/w,就是/d,将/d,决策树/nz,写/v,到/v,文件/n,中/f,，/w,用/p,的/u,时候/n,在/p,取/v,出来/v,，/w,测试/vn,一下/m,就/d,明白/v,了/u,trees/en,./w,storetree/en,(/w,mytree/en,,/w,'/w,classifierstorage/en,./w,txt/en,'/w,)/w, ,#,run/en, ,it/en, ,,/w,store/en, ,the/en, ,treetrees/en,./w,grabtree/en,(/w,'/w,classifierstorage/en,./w,txt/en,'/w,)/w,{/w,'/w,no/en, ,surfacing/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,}/w,}/w,决策树/nz,的/u,构造/v,部分/n,结束/v,了/u,，/w,下面/f,介绍/v,怎样/r,绘制/v,决策树/nz,2/m,./w, ,使用/v,matplotlib/en,注解/n,绘制/v,树形图/n,前面/f,我们/r,看到/v,决策树/nz,最后/f,输出/v,是/v,一个/m,大/a,字典/n,，/w,非常/d,丑陋/a,，/w,我们/r,想/v,让/v,它/r,更/d,有/v,层次感/n,，/w,更加/d,清晰/a,，/w,最好/d,是/v,图形状/nw,的/u,，/w,于是/c,，/w,我们/r,要/v,matplotlib/en,去/v,画/v,决策树/nz,。/w,2.1/m, ,matplotlib/en,注解/n,matplotlib/en,提供/v,了/u,一个/m,注解/n,工具/n,annotations/en,,/w,它/r,可以/v,在/p,数据/n,图形/n,上/f,添加/vn,文本/n,注释/vn,。/w,创建/v,一个/m,treeplotter/en,./w,py/en,文件/n,来/v,存储/vn,画/v,图/n,的/u,相关/v,函数/n,首先/d,是/v,使用/v,文本/n,注解/n,绘制/v,树/v,节点/n,，/w,参考/v,代码/n,如下/v,：/w,1/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,2/m, ,3/m, ,decisionnode/en, ,=/w, ,dict/en,(/w,boxstyle/en,=/w,"/w,sawtooth/en,"/w,,/w, ,fc/en,=/w,"/w,0.8/m,"/w,)/w, ,4/m, ,leafnode/en, ,=/w, ,dict/en,(/w,boxstyle/en,=/w,"/w,round/en,4/m,"/w,,/w, ,fc/en,=/w,"/w,0.8/m,"/w,)/w, ,5/m, ,arrow/en,_,args/en, ,=/w, ,dict/en,(/w,arrowstyle/en,=/w,"/w,</w,-/w,"/w,)/w, ,6/m, ,7/m, ,def/en, ,plotnode/en,(/w,nodetxt/en,,/w, ,centerpt/en,,/w, ,parentpt/en,,/w, ,nodetype/en,)/w,:/w, ,8/m, ,createplot/en,./w,ax/en,1/m,./w,annotate/en,(/w,nodetxt/en,,/w, ,xy/en,=/w,parentpt/en,,/w, ,xycoords/en,=/w,'/w,axes/en, ,fraction/en,'/w,,/w,\/w, ,9/m, ,xytext/en,=/w,centerpt/en,,/w, ,textcoords/en,=/w,'/w,axes/en, ,fraction/en,'/w,,/w,\/w, ,10/m, ,va/en,=/w,"/w,center/en,"/w,,/w, ,ha/en,=/w,"/w,center/en,"/w,,/w, ,bbox/en,=/w,nodetype/en,,/w, ,arrowprops/en,=/w,arrow/en,_,args/en, ,)/w, ,11/m, ,12/m, ,def/en, ,createplot/en,1/m,(/w,)/w,:/w, ,13/m, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,1/m,,/w, ,facecolor/en,=/w,'/w,white/en,'/w,)/w, ,14/m, ,fig/en,./w,clf/en,(/w,)/w, ,15/m, ,createplot/en,./w,ax/en,1/m, ,=/w, ,plt/en,./w,subplot/en,(/w,111/m,,/w, ,frameon/en,=/w,false/en,)/w, ,#,ticks/en, ,for/en, ,demo/en, ,puropses/en, ,16/m, ,plotnode/en,(/w,'/w,a/en, ,decision/en, ,node/en,'/w,,/w, ,(/w,0.5/m,,/w, ,0.1/m,)/w,,/w, ,(/w,0.1/m,,/w, ,0.5/m,)/w,,/w, ,decisionnode/en,)/w, ,17/m, ,plotnode/en,(/w,'/w,a/en, ,leaf/en, ,node/en,'/w,,/w, ,(/w,0.8/m,,/w, ,0.1/m,)/w,,/w, ,(/w,0.3/m,,/w, ,0.8/m,)/w,,/w, ,leafnode/en,)/w, ,18/m, ,plt/en,./w,show/en,(/w,)/w,前面/f,三行/mq,是/v,定义/n,文本/n,框/q,和/c,箭头/n,格式/n,，/w,decisionnode/en,是/v,锯/v,齿/n,形/ng,方框/n,，/w,文本/n,框/q,的/u,大小/n,是/v,0.8/m,，/w,leafnode/en,是/v,4/m,边/d,环绕/v,型/k,，/w,跟/p,矩形/n,类似/v,，/w,大小/n,也/d,是/v,4/m,，/w,arrow/en,_,args/en,是/v,指/v,箭头/n,，/w,我们/r,在/p,后面/f,结果/n,是/v,会/v,看到/v,这些/r,东西/n,，/w,这些/r,数据/n,以/p,字典/n,类型/n,存储/vn,。/w,第一/m,个/q,plotnode/en,函数/n,的/u,功能/n,是/v,绘制/v,带/v,箭头/n,的/u,注解/n,，/w,输入/v,参数/n,分别/d,是/v,文本/n,框/q,的/u,内容/n,，/w,文本/n,框/q,的/u,中心/n,坐标/n,，/w,父/ng,结点/nw,坐标/n,和/c,文本/n,框/q,的/u,类型/n,，/w,这些/r,都/d,是/v,通过/p,一个/m,createplot/en,./w,ax/en,1/m,./w,annotate/en,函数/n,实现/v,的/u,，/w,create/en,./w,ax/en,1/m,是/v,一个/m,全局/n,变量/n,，/w,这个/r,函数/n,不/d,多/a,将/d,，/w,会/v,用/p,就/d,行/v,了/u,。/w,第二/m,个/q,函数/n,createplot/en,就/d,是/v,生/v,出/v,图形/n,，/w,也/d,没/d,什么/r,东西/n,，/w,函数/n,第一/m,行/v,是/v,生成/vn,图像/n,的/u,画框/n,，/w,横纵/nw,坐标/n,最/d,大/a,值/n,都/d,是/v,1/m,，/w,颜色/n,是/v,白色/n,，/w,下/f,一个/m,是/v,清屏/nw,，/w,下/f,一个/m,就/d,是/v,分图/nw,，/w,111/m,中/f,第一/m,个/q,1/m,是/v,行数/n,，/w,第二/m,个/q,是/v,列数/nw,，/w,第三/nw,个/q,是/v,第几/nw,个/q,图/n,，/w,这里/r,就/d,一个/m,图/n,，/w,跟/p,matlab/en,中/f,的/u,一样/u,，/w,matplotlib/en,里面/f,的/u,函数/n,都/d,是/v,和/c,matlab/en,差不多/l,。/w,来/v,测试/vn,一下/m,吧/y,reset/en, ,-/w,f/en, ,#,clear/en, ,all/en, ,the/en, ,module/en, ,and/en, ,datacd/en, ,桌面/n,//w,machinelearninginaction/en,//w,ch/en,03/m,//w,home/en,//w,fangyang/en,//w,桌面/n,//w,machinelearninginaction/en,//w,ch/en,03/m,import/en, ,treeplotter/en, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plttreeplotter/en,./w,createplot/en,1/m,(/w,)/w,2.2/m, ,构造/v,注解/n,树/v,绘制/v,一棵/mq,完整/a,的/u,树/v,需要/v,一些/m,技巧/n,。/w,我们/r,虽然/c,有/v, ,x/en, ,、/w,y/en, ,坐标/n,,/w,但是/c,如何/r,放置/v,所有/b,的/u,树/v,节点/n,却/d,是/v,个/q,问题/n,，/w,我们/r,必须/d,知道/v,有/v,多少/r,个/q,叶/j,节点/n,,/w,以便/d,可以/v,正确/a,确定/v,x/en,轴/q,的/u,长度/n,;/w,我们/r,还/d,需要/v,知道/v,树/v,有/v,多少/r,层/q,，/w,以便/d,可以/v,正确/a,确定/v,y/en,轴/q,的/u,高度/d,。/w,这里/r,定义/n,了/u,两个/m,新/a,函数/n,getnumleafs/en,(/w,)/w,和/c,gettreedepth/en,(/w,)/w,，/w,以/p,求/v,叶/j,节点/n,的/u,数目/n,和/c,树/v,的/u,层数/n,。/w,参考/v,代码/n,：/w,1/m, ,def/en, ,getnumleafs/en,(/w,mytree/en,)/w,:/w, ,2/m, ,numleafs/en, ,=/w, ,0/m, ,3/m, ,firststr/en, ,=/w, ,mytree/en,./w,keys/en,(/w,)/w,[/w,0/m,]/w, ,4/m, ,seconddict/en, ,=/w, ,mytree/en,[/w,firststr/en,]/w, ,5/m, ,for/en, ,key/en, ,in/en, ,seconddict/en,./w,keys/en,(/w,)/w,:/w, ,6/m, ,if/en, ,type/en,(/w,seconddict/en,[/w,key/en,]/w,)/w,./w,_,_,name/en,_,_,=/w,=/w,'/w,dict/en,'/w,:/w,#,test/en, ,to/en, ,see/en, ,if/en, ,the/en, ,nodes/en, ,are/en, ,dictonaires/en,,/w, ,if/en, ,not/en, ,they/en, ,are/en, ,leaf/en, ,nodes/en, ,7/m, ,numleafs/en, ,+/w,=/w, ,getnumleafs/en,(/w,seconddict/en,[/w,key/en,]/w,)/w, ,8/m, ,else/en,:/w, ,numleafs/en, ,+/w,=/w,1/m, ,9/m, ,return/en, ,numleafs/en, ,10/m, ,11/m, ,def/en, ,gettreedepth/en,(/w,mytree/en,)/w,:/w, ,12/m, ,maxdepth/en, ,=/w, ,0/m, ,13/m, ,firststr/en, ,=/w, ,mytree/en,./w,keys/en,(/w,)/w,[/w,0/m,]/w, ,14/m, ,seconddict/en, ,=/w, ,mytree/en,[/w,firststr/en,]/w, ,15/m, ,for/en, ,key/en, ,in/en, ,seconddict/en,./w,keys/en,(/w,)/w,:/w, ,16/m, ,if/en, ,type/en,(/w,seconddict/en,[/w,key/en,]/w,)/w,./w,_,_,name/en,_,_,=/w,=/w,'/w,dict/en,'/w,:/w,#,test/en, ,to/en, ,see/en, ,if/en, ,the/en, ,nodes/en, ,are/en, ,dictonaires/en,,/w, ,if/en, ,not/en, ,they/en, ,are/en, ,leaf/en, ,nodes/en, ,17/m, ,thisdepth/en, ,=/w, ,1/m, ,+/w, ,gettreedepth/en,(/w,seconddict/en,[/w,key/en,]/w,)/w, ,18/m, ,else/en,:/w, ,thisdepth/en, ,=/w, ,1/m, ,19/m, ,if/en, ,thisdepth/en, ,>, ,maxdepth/en,:/w, ,maxdepth/en, ,=/w, ,thisdepth/en, ,20/m, ,return/en, ,maxdepth/en,我们/r,可以/v,看到/v,两个/m,方法/n,有点/d,似曾相识/i,，/w,没错/v,，/w,我们/r,在/p,进行/v,决策树/nz,分类/vn,测试/vn,时/ng,，/w,用/p,的/u,跟/p,这个/r,几乎/d,一样/u,，/w,分类/vn,测试/vn,中/f,的/u,isinstance/en,函数/n,换/v,了/u,一种/mq,方式/n,去/v,判断/v,，/w,递归/nw,依然/d,在/p,，/w,不过/c,是/v,每/r,递归/nw,依次/d,，/w,高度/d,增加/v,1/m,，/w,叶子数/nw,同样/d,是/v,检测/vn,是否/v,为/p,字典/n,，/w,不/d,是/v,字典/n,则/d,增加/v,相应/v,的/u,分支/n,。/w,这里/r,还/d,写/v,了/u,一个/m,函数/n,retrievetree/en,，/w,它/r,的/u,作用/n,是/v,预先/d,存储/vn,的/u,树/v,信息/n,,/w,避免/v,了/u,每/r,次/q,测试/vn,代码/n,时/ng,都/d,要/v,从/p,数据/n,中/f,创/vg,建树/n,的/u,麻烦/an,参考/v,代码/n,如下/v,1/m, ,def/en, ,retrievetree/en,(/w,i/en,)/w,:/w, ,2/m, ,listoftrees/en, ,=/w,[/w,{/w,'/w,no/en, ,surfacing/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,}/w,}/w,,/w, ,3/m, ,{/w,'/w,no/en, ,surfacing/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,{/w,'/w,flippers/en,'/w,:/w, ,{/w,0/m,:/w, ,{/w,'/w,head/en,'/w,:/w, ,{/w,0/m,:/w, ,'/w,no/en,'/w,,/w, ,1/m,:/w, ,'/w,yes/en,'/w,}/w,}/w,,/w, ,1/m,:/w, ,'/w,no/en,'/w,}/w,}/w,}/w,}/w, ,4/m, ,]/w, ,5/m, ,return/en, ,listoftrees/en,[/w,i/en,]/w,这个/r,没/d,什么/r,好说/a,的/u,，/w,就是/d,把/p,决策树/nz,的/u,结果/n,存在/v,一个/m,函数/n,中/f,，/w,方便/a,调用/v,，/w,跟/p,前面/f,的/u,存储/vn,决策树/nz,差不多/l,。/w,有/v,了/u,前面/f,这些/r,基础/n,后/f,，/w,我们/r,就/d,可以/v,来/v,画/v,树/v,了/u,。/w,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,plotmidtext/en,(/w,cntrpt/en,,/w, ,parentpt/en,,/w, ,txtstring/en,)/w,:/w, ,2/m, ,xmid/en, ,=/w, ,(/w,parentpt/en,[/w,0/m,]/w,-/w,cntrpt/en,[/w,0/m,]/w,)/w,//w,2.0/m, ,+/w, ,cntrpt/en,[/w,0/m,]/w, ,3/m, ,ymid/en, ,=/w, ,(/w,parentpt/en,[/w,1/m,]/w,-/w,cntrpt/en,[/w,1/m,]/w,)/w,//w,2.0/m, ,+/w, ,cntrpt/en,[/w,1/m,]/w, ,4/m, ,createplot/en,./w,ax/en,1/m,./w,text/en,(/w,xmid/en,,/w, ,ymid/en,,/w, ,txtstring/en,,/w, ,va/en,=/w,"/w,center/en,"/w,,/w, ,ha/en,=/w,"/w,center/en,"/w,,/w, ,rotation/en,=/w,30/m,)/w, ,5/m, ,6/m, ,def/en, ,plottree/en,(/w,mytree/en,,/w, ,parentpt/en,,/w, ,nodetxt/en,)/w,:/w,#,if/en, ,the/en, ,first/en, ,key/en, ,tells/en, ,you/en, ,what/en, ,feat/en, ,was/en, ,split/en, ,on/en, ,7/m, ,numleafs/en, ,=/w, ,getnumleafs/en,(/w,mytree/en,)/w, ,#,this/en, ,determines/en, ,the/en, ,x/en, ,width/en, ,of/en, ,this/en, ,tree/en, ,8/m, ,depth/en, ,=/w, ,gettreedepth/en,(/w,mytree/en,)/w, ,9/m, ,firststr/en, ,=/w, ,mytree/en,./w,keys/en,(/w,)/w,[/w,0/m,]/w, ,#,the/en, ,text/en, ,label/en, ,for/en, ,this/en, ,node/en, ,should/en, ,be/en, ,this/en, ,10/m, ,cntrpt/en, ,=/w, ,(/w,plottree/en,./w,xoff/en, ,+/w, ,(/w,1.0/m, ,+/w, ,float/en,(/w,numleafs/en,)/w,)/w,//w,2.0/m,//w,plottree/en,./w,totalw/en,,/w, ,plottree/en,./w,yoff/en,)/w, ,11/m, ,plotmidtext/en,(/w,cntrpt/en,,/w, ,parentpt/en,,/w, ,nodetxt/en,)/w, ,12/m, ,plotnode/en,(/w,firststr/en,,/w, ,cntrpt/en,,/w, ,parentpt/en,,/w, ,decisionnode/en,)/w, ,13/m, ,seconddict/en, ,=/w, ,mytree/en,[/w,firststr/en,]/w, ,14/m, ,plottree/en,./w,yoff/en, ,=/w, ,plottree/en,./w,yoff/en, ,-/w, ,1.0/m,//w,plottree/en,./w,totald/en, ,15/m, ,for/en, ,key/en, ,in/en, ,seconddict/en,./w,keys/en,(/w,)/w,:/w, ,16/m, ,if/en, ,type/en,(/w,seconddict/en,[/w,key/en,]/w,)/w,./w,_,_,name/en,_,_,=/w,=/w,'/w,dict/en,'/w,:/w,#,test/en, ,to/en, ,see/en, ,if/en, ,the/en, ,nodes/en, ,are/en, ,dictonaires/en,,/w, ,if/en, ,not/en, ,they/en, ,are/en, ,leaf/en, ,nodes/en, ,17/m, ,plottree/en,(/w,seconddict/en,[/w,key/en,]/w,,/w,cntrpt/en,,/w,str/en,(/w,key/en,)/w,)/w, ,#,recursion/en, ,18/m, ,else/en,:/w, ,#,it/en,'/w,s/en, ,a/en, ,leaf/en, ,node/en, ,print/en, ,the/en, ,leaf/en, ,node/en, ,19/m, ,plottree/en,./w,xoff/en, ,=/w, ,plottree/en,./w,xoff/en, ,+/w, ,1.0/m,//w,plottree/en,./w,totalw/en, ,20/m, ,plotnode/en,(/w,seconddict/en,[/w,key/en,]/w,,/w, ,(/w,plottree/en,./w,xoff/en,,/w, ,plottree/en,./w,yoff/en,)/w,,/w, ,cntrpt/en,,/w, ,leafnode/en,)/w, ,21/m, ,plotmidtext/en,(/w,(/w,plottree/en,./w,xoff/en,,/w, ,plottree/en,./w,yoff/en,)/w,,/w, ,cntrpt/en,,/w, ,str/en,(/w,key/en,)/w,)/w, ,22/m,