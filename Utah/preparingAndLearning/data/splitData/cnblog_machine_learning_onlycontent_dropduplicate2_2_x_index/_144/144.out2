python/en,机器/n,学习/v,实战/n,（/w,三/m,）/w,版权/n,声明/n,：/w,本文/r,为/p,博主/nr,原创/b,文章/n,，/w,转载/v,请/v,指明/v,转载/v,地址/n,www/en,./w,cnblogs/en,./w,com/en,//w,fydeblog/en,//w,p/en,//w,7277205/m,./w,html/en,前言/n,这/r,篇/q,博客/n,是/v,关于/p,机器/n,学习/v,中/f,基于/p,概率/n,论/v,的/u,分类/vn,方法/n,--/nrf,朴素/a,贝叶斯/nr,，/w,内容/n,包括/v,朴素/a,贝叶斯分类器/nw,，/w,垃圾/n,邮件/n,的/u,分类/vn,，/w,解析/v,rss/en,源/ng,数据/n,以及/c,用/p,朴素/a,贝叶斯来/nrf,分析/vn,不同/a,地区/n,的/u,态度/n,./w,操作系统/l,：/w,ubuntu/en,14.04/m, ,运行/vn,环境/n,：/w,anaconda/en,-/w,python/en,2.7/m,-/w,jupyter/en, ,notebook/en, ,参考/v,书籍/n,：/w,机器/n,学习/v,实战/n,和/c,源码/nw,,/w,机器/n,学习/v,（/w,周志华/nr,）/w, ,notebook/en, ,writer/en, ,----/nrf,方阳/nr,注意/v,事项/n,：/w,在/p,这里/r,说/v,一句/mq,，/w,默认/v,环境/n,python/en,2.7/m,的/u,notebook/en,，/w,用/p,python/en,3.6/m,的/u,会/v,出/v,问题/n,，/w,还有/v,我/r,的/u,目录/n,可能/v,跟/p,你们/r,的/u,不/d,一样/u,，/w,你们/r,自己/r,跑/v,的/u,时候/n,记得/v,改/v,目录/n,，/w,我/r,会/v,把/p,notebook/en,和/c,代码/n,以及/c,数据/n,集放/nw,到/v,结尾/v,的/u,百度/nt,云盘/nw,，/w,方便/a,你们/r,下载/v,！/w,1/m,./w, ,基于/p,贝叶斯/nr,决策/n,理论/n,的/u,分类/vn,方法/n,朴素/a,贝叶斯/nr,的/u,特点/n,优/ag, ,点/q,:/w, ,在/p,数据/n,较/d,少/a,的/u,情况/n,下/f,仍然/d,有效/a,,/w,可以/v,处理/v,多/a,类别/n,问题/n,。/w,缺/v, ,点/q,:/w, ,对于/p,输入/v,数据/n,的/u,准备/v,方式/n,较为/d,敏感/a,。/w,适用/v,数据/n,类型/n,:/w,标称/v,型/k,数据/n,。/w,贝叶斯/nr,决策/n,理论/n,的/u,核心/n,思想/n,：/w,选择/v,具有/v,最/d,高/a,概率/n,的/u,决策/n,。/w,（/w,最小化/nw,每个/r,样本/n,的/u,条件/n,风险/n,，/w,则/d,总体/n,风险/n,也/d,就/d,最/d,小/a,，/w,就/d,是/v,选择/v,最高/a,概率/n,，/w,减小/v,风险/n,）/w,2/m,./w, ,条件/n,概率/n,2.1/m, ,简单/a,回顾/v,条件/n,概率/n,在/p,朴素/a,贝叶斯里面/nw,是/v,必不可少/l,的/u,一环/nt,，/w,下面/f,来/v,简单/a,介绍/v,介绍/v,假设/v,现在/t,有/v,一个/m,装/v,了/u,7块/mq,石头/n,的/u,罐子/n,,/w,其中/r,3块/mq,是/v,灰色/n,的/u,,/w, ,4块/mq,是/v,黑色/n,的/u, ,。/w,如果/c,从/p,罐子/n,中/f,随机/d,取出/v,一块/mq,石头/n,,/w,那么/r,是/v,灰色/n,石头/n,的/u,可能性/n,是/v,多少/r,?/w, ,由于/c,取/v,石头/n,有/v, ,7/m, ,种/q,可能/v, ,,/w,其中/r, ,3种/mq,为/p,灰色/n, ,,/w,所以/c,取出/v,灰色/n,石头/n,的/u,概率/n,为/p, ,3/m,//w,7/m, ,。/w,那么/r,取/v,到/v,黑色/n,石头/n,的/u,概率/n,又/d,是/v,多少/r,呢/y,?/w,很/d,显然/ad, ,,/w,是/v,4/m,//w,7/m, ,。/w,如果/c,这/r,7块/mq,石头/n,放/v,在/p,两个桶/mq,中/f,,/w,那么/r,上述/b,概率/n,应该/v,如何/r,计算/v,?/w, ,（/w,设/v,两个桶/mq,分为/v,a/en,，/w,b/en,，/w,a/en,桶/q,装/v,了/u,2个/m,灰色/n,和/c,2个/m,黑色/n,的/u,石头/n,，/w,b/en,桶/q,装/v,了/u,1个/m,灰色/n,和/c,2个/m,黑色/n,的/u,石头/n,）/w,要/v,计算/v,p/en,(/w,gray/en,)/w,或者/c,p/en,(/w,black/en,)/w, ,,/w,事先/d,得/u,知道/v,石头/n,所/u,在/p,桶/q,的/u,信息/n,会/v,不/d,会/v,改变/v,结果/n,?/w,你/r,有/v,可能/v,巳经/nw,想到/v,计算/v,从/p,b/en,桶/q,中/f,取/v,到/v,灰色/n,石头/n,的/u,概率/n,的/u,办法/n,,/w,这/r,就/d,是/v,所谓/v,的/u,条件/n,概率/n,./w,来/v,计算/v,p/en,(/w,gray/en,|/w,bucketb/en,)/w,,/w,这个/r,是/v,条件/n,概率/n,，/w,在/p,已知/nz,是/v,从/p,b/en,桶/q,拿/v,出/v,石头/n,的/u,条件/n,下/f,，/w,拿/v,到/v,灰色/n,石头/n,的/u,概率/n,。/w,计算/v,公式/n,：/w,p/en,(/w,gray/en,|/w,bucketb/en,)/w, ,=/w, ,p/en,(/w,gray/en, ,and/en, ,bucketb/en,)/w, ,//w, ,p/en,(/w,bucketb/en,)/w, ,（/w,将/d,两者/r,同时/c,发生/v,的/u,概率/n,除/p,以/p,前提/n,条件/n,发生/v,的/u,概率/n,）/w,我们/r,知道/v,p/en,(/w,bucketb/en,)/w,就/d,是/v,3/m,//w,7/m,，/w,b/en,桶/q,的/u,石头/n,数/m,//w,总/b,石头/n,数/m,，/w, ,p/en,(/w,gray/en, ,and/en, ,bucketb/en,)/w, ,是/v,1/m,//w,7/m,，/w,b/en,桶/q,中/f,的/u,灰色/n,石头/n,数/m,//w,总/b,石头/n,数/m,，/w,所以/c,p/en,(/w,gray/en,|/w,bucketb/en,)/w, ,=/w, ,1/m,//w,3/m,这里/r,说/v,一下/m,p/en,(/w,gray/en, ,and/en, ,bucketb/en,)/w, ,，/w,它/r,等于/v,p/en,(/w,bucketb/en,|/w,gray/en,)/w,乘/v,以/p,p/en,(/w,gray/en,)/w,的/u,，/w,先/d,发生/v,gray/en,,/w,然后/c,在/p,gray/en,的/u,基础/n,上/f,发生/v,bucketb/en,，/w,就/d,是/v,gray/en, ,and/en, ,bucketb/en,所以/c,这里/r,的/u,公式/n,还/d,可以/v,变/v,一下/m,，/w,p/en,(/w,gray/en,|/w,bucketb/en,)/w, ,=/w, ,p/en,(/w,gray/en, ,and/en, ,bucketb/en,)/w, ,//w, ,p/en,(/w,bucketb/en,)/w, ,=/w,p/en,(/w,bucketb/en,|/w,gray/en,)/w,*/w, ,p/en,(/w,gray/en,)/w, ,//w, ,p/en,(/w,bucketb/en,)/w,一般/a,情况/n,下/f,，/w,写成/v, ,p/en,(/w,c/en,|/w,x/en,)/w, ,=/w, ,p/en,(/w,x/en,|/w,c/en,)/w,*/w, ,p/en,(/w,c/en,)/w, ,//w, ,p/en,(/w,x/en,)/w, ,这/r,就/d,是/v,贝叶斯/nr,准则/n,2.2/m, ,使用/v,条件/n,概率/n,进行/v,分类/vn,贝叶斯决策论/nw,中/f,真正/d,比较/d,的/u,是/v,条件/n,概率/n,p/en,(/w,c/en,1/m,|/w,x/en,,/w,y/en,)/w,和/c,p/en,(/w,c/en,2/m,|/w,x/en,,/w,y/en,)/w,，/w,这些/r,符号/n,所/u,代表/n,的/u,具体/a,意义/n,是/v,，/w,给/p,定/v,某个/r,由/p,x/en,，/w,y/en,表示/v,的/u,数据点/nw,，/w,想/v,知道/v,该/r,数据点/nw,来自/v,类别/n,c/en,1/m,的/u,概率/n,是/v,多少/r,?/w,数据点/nw,来自/v,类别/n,c/en,2/m,的/u,概率/n,又/d,是/v,多少/r,?/w,如果/c, ,p/en,(/w,c/en,1/m,|/w,x/en,,/w,y/en,)/w, ,>, ,p/en,(/w,c/en,2/m,|/w,x/en,,/w,y/en,)/w, ,，/w,属于/v,类别/n,c/en,1/m, ,如果/c, ,p/en,(/w,c/en,2/m,|/w,x/en,,/w,y/en,)/w, ,>, ,p/en,(/w,c/en,1/m,|/w,x/en,,/w,y/en,)/w, ,，/w,属于/v,类别/n,c/en,2/m,这些/r,概率/n,可以/v,有/v,2.1/m,的/u,贝叶斯/nr,准则/n,计算/v,3/m,./w, ,使用/v,朴素/a,贝叶斯/nr,进行/v,留言/v,分类/vn,朴素/a,贝叶斯/nr,的/u,一般/a,过程/n,(/w,1/m,)/w, ,收集/v,数据/n,:/w,可以/v,使用/v,任何/r,方法/n,。/w,本章/r,使用/v,rss/en,源/ng,。/w,(/w,2/m,)/w, ,准备/v,数据/n,:/w,需要/v,数/m,值型/nw,或者/c,布尔型/nr,数据/n,。/w,(/w,3/m,)/w, ,分析/vn,数据/n,:/w,有/v,大量/m,特征/n,时/ng,,/w,绘制/v,特征/n,作用/n,不/d,大/a,,/w,此时/r,使用/v,直方图/n,效果/n,更/d,好/a,。/w,(/w,4/m,)/w, ,训练/vn,算法/n,:/w,计算/v,不同/a,的/u,独立/v,特征/n,的/u,条件/n,概率/n,。/w,(/w,5/m,)/w, ,测试/vn,算法/n,:/w,计算/v,错误率/n,。/w,(/w,6/m,)/w, ,使用/v,算法/n,:/w,一个/m,常见/a,的/u,朴素/a,贝叶斯应用/nw,是/v,文档/n,分类/vn,。/w,可以/v,在/p,任意/d,的/u,分类/vn,场景/n,中/f,使用/v,朴素/a,贝叶斯命类器/nw,,/w,不/d,一定/d,非/h,要是/c,文本/n,朴素/a,贝叶斯/nr,的/u,两个/m,假设/v, ,(/w,1/m,)/w, ,特征/n,之间/f,是/v,统计/v,独立/v,的/u,，/w,即/v,一个/m,特征/n,或者/c,单词/n,出现/v,的/u,可能性/n,与/p,它/r,和/c,其他/r,单词/n,相邻/v,没有/v,关系/n,。/w, ,(/w,2/m,)/w, ,每个/r,特征/n,同等/b,重要/a,。/w,以上/f,两个/m,假设/v,是/v,有/v,问题/n,的/u,，/w,不/d,够/v,严谨/a,，/w,但/c,处理/v,方便/a,，/w,实际/n,效果/n,却/d,很/d,好/a,。/w,3.1/m, ,准备/v,数据/n,：/w,从/p,文本/n,中/f,构建/v,词向量词表/nw,到/v,向量/n,的/u,转换/v,函数/n,如下/v,：/w,1/m, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,2/m, ,postinglist/en,=/w,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,3/m, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,4/m, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,5/m, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,6/m, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,7/m, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,8/m, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,#,1/m, ,is/en, ,abusive/en,,/w, ,0/m, ,not/en, ,9/m, ,return/en, ,postinglist/en,,/w,classvec/en, ,10/m, ,11/m, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,12/m, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,#,create/en, ,empty/en, ,set/en, ,13/m, ,for/en, ,document/en, ,in/en, ,dataset/en,:/w, ,14/m, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#,union/en, ,of/en, ,the/en, ,two/en, ,sets/en, ,15/m, ,return/en, ,list/en,(/w,vocabset/en,)/w, ,16/m, ,17/m, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,18/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,19/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,20/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,21/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,22/m, ,else/en,:/w, ,print/en, ,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,23/m, ,return/en, ,returnvec/en,第一/m,个/q,loaddataset/en,函数/n,是/v,返回/v,词条/n,切分/v,后/f,的/u,文档/n,集合/v,postlist/en,（/w,选/v,自/p,斑点/n,犬/ng,爱好者/n,留言板/nw,）/w,和/c,类别/n,标签/n,集合/v,classvec/en,（/w,1/m,代表/n,侮辱/v,，/w,0则/mq,是/v,正常/a,言论/n,）/w,第二/m,个/q,createvocablist/en,函数/n,会/v,返回/v,输入/v,数据集/nw,所有/b,不/d,重复/v,词汇/n,的/u,列表/v,第三/nw,个/q,setofwords/en,2/m,vec/en,函数/n,的/u,功能/n,是/v,遍历/nw,输入/v,vocablist/en,的/u,所有/b,单词/n,,/w,如果/c,当初/t,出现/v,了/u,inputset/en,中/f,的/u,单词/n,，/w,returnvec/en,对应/v,位数/n,的/u,值/n,返回/v,1/m,，/w,无/v,则/d,返回/v,0/m,简单/a,来讲/u,，/w,第一/m,个/q,函数/n,的/u,作用/n,是/v,界定/v,训练/vn,类别/n,，/w,看/v,之后/f,的/u,文档/n,是否/v,含有/v,类别/n,中/f,的/u,词汇/n,，/w,第二/m,个/q,函数/n,的/u,作用/n,是/v,将/d,一篇/mq,文档/n,做成/v,列表/v,，/w,方便/a,后面/f,进行/v,标记/n,。/w,第三/nw,个/q,函数/n,则/d,是/v,将/d,第二/m,个/q,函数/n,生成/vn,的/u,列表/v,根据/p,第一/m,个/q,类别/n,词汇/n,进行/v,标记/n,，/w,将/d,单词/n,转化/v,成/v,数字/n,，/w,方便/a,后面/f,计算/v,条件/n,概率/n,。/w,测试/vn,一下/m,吧/y,(/w,所有/b,函数/n,都/d,放/v,在/p,bayes/en,中/f,)/w,cd/en, ,桌面/n,//w,machinelearninginaction/en,//w,ch/en,04/m,//w,home/en,//w,fangyang/en,//w,桌面/n,//w,machinelearninginaction/en,//w,ch/en,04/m,import/en, ,bayeslistoposts/en,,/w,listclasses/en, ,=/w, ,bayes/en,./w,loaddataset/en,(/w,)/w,myvocablist/en, ,=/w, ,bayes/en,./w,createvocablist/en,(/w,listoposts/en,)/w,myvocablistbayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,listoposts/en,[/w,0/m,]/w,)/w,bayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,listoposts/en,[/w,3/m,]/w,)/w,3.2/m, ,训练/vn,算法/n, ,:/w,从/p,词向量/nw,计算/v,概率/n,根据/p,上面/f,介绍/v,的/u,三个/m,函数/n,，/w,我们/r,知道/v,如何/r,将/d,一组/mq,单词/n,转换/v,为/p,一组/mq,数字/n,，/w,也/d,知道/v,一个/m,词/n,是否/v,出现/v,在/p,一篇/mq,文档/n,中/f,。/w,现在/t,已知/nz,文档/n,的/u,类别/n,，/w,让/v,我们/r,使用/v,转换/v,得到/v,的/u,数字/n,来/v,计算/v,条件/n,概率/n,吧/y,还是/c,根据/p,上面/f,的/u,贝叶斯/nr,准则/n,来/v,计算/v,条件/n,概率/n,，/w,不过/c,公式/n,会/v,有/v,一点/m,不/d,一样/u,p/en,(/w,ci/en,|/w,w/en,)/w, ,=/w, ,p/en,(/w,w/en,|/w,ci/en,)/w,*/w, ,p/en,(/w,ci/en,)/w, ,//w, ,p/en,(/w,w/en,)/w, ,(/w,这里/r,的/u,ci/en,表示/v,所/u,属/v,类别/n,，/w,这里/r,有/v,两种/mq,可能性/n,1/m,和/c,0/m,，/w,w/en,为/p,向量/n,，/w,由/p,多/a,个/q,数值/n,组成/v,)/w,我们/r,根据/p,上面/f,的/u,公式/n,对/p,每个/r,类/q,进行/v,计算/v,，/w,然后/c,比较/d,这/r,两个/m,概率/n,值/n,的/u,大小/n,。/w,计算/v,过程/n,如下/v,首先/d,可以/v,通过/p,类别/n, ,i/en, ,(/w, ,侮辱性/n,留言/v,或/c,非/h,侮辱性/n,留言/v,)/w,中/f,文档/n,数/m,除/p,以/p,总/b,的/u,文档/n,数/m,来/v,计算/v,概率/n,p/en,(/w,ci/en,)/w,，/w,接下来/l,计算/v,p/en,(/w,w/en,|/w,ci/en,)/w,，/w,由于/c,p/en,(/w,w/en,|/w,ci/en,)/w, ,=/w, ,p/en,(/w,w/en,0/m,,/w,w/en,1/m,,/w,w/en,2/m,./w,./w,wn/en,|/w,ci/en,)/w,，/w,又/d,因为/c,所有/b,词/n,都/d,相互/d,独立/v,，/w,所以/c,p/en,(/w,w/en,|/w,ci/en,)/w, ,=/w, ,p/en,(/w,w/en,0/m,|/w,ci/en,)/w,p/en,(/w,w/en,1/m,|/w,ci/en,)/w,p/en,(/w,w/en,2/m,|/w,ci/en,)/w,./w,./w,./w,p/en,(/w,wn/en,|/w,ci/en,)/w,于是/c,函数/n,的/u,伪代码/nw,相应/v,如下/v,计算/v,每个/r,类别/n,中/f,的/u,文档/n,数目/n, ,对/p,每篇/r,训练/vn,文档/n,:/w, ,对/p,每个/r,类别/n,:/w, ,如果/c,词条/n,出现/v,文档/n,中/f,―/w,增加/v,该/r,词条/n,的/u,计数/v,值/n, ,增加/v,所有/b,词条/n,的/u,计数/v,值/n, ,对/p,每个/r,类别/n,:/w, ,对/p,每个/r,词条/n,:/w, ,将/d,该/r,词条/n,的/u,数目/n,除/p,以/p,总/b,词条/n,数目/n,得到/v,条件/n,概率/n, ,返回/v,每个/r,类别/n,的/u,条件/n,概率/n,参考/v,代码/n,如下/v,1/m, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w, ,2/m, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,3/m, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,4/m, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,5/m, ,p/en,0/m,num/en, ,=/w, ,zeros/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,zeros/en,(/w,numwords/en,)/w, ,6/m, ,p/en,0/m,denom/en, ,=/w, ,0.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,0.0/m, ,7/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,8/m, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,9/m, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,10/m, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,11/m, ,else/en,:/w, ,12/m, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,13/m, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,14/m, ,p/en,1/m,vect/en, ,=/w, ,p/en,1/m,num/en,//w,p/en,1/m,denom/en, ,15/m, ,p/en,0/m,vect/en, ,=/w, ,p/en,0/m,num/en,//w,p/en,0/m,denom/en, ,16/m, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en,输入/v,的/u,trainmatrix/en,是/v,文档/n,经过/p,setofwords/en,2/m,vec/en,函数/n,转换/v,后/f,的/u,列表/v,，/w,traincategory/en,是/v,每篇/r,文档/n,构成/v,类别/n,标签/n,向量/n,。/w,输出/v,是/v,返回/v,每个/r,类别/n,的/u,概率/n,，/w,pabusive/en,等于/v,类别/n,和/c,除/p,以/p,训练/vn,的/u,样本数/n,，/w,这个/r,就/d,是/v,说明/v,一下/m,文档/n,类别/n,的/u,概率/n,分布/v,，/w,没有/v,什么/r,其他/r,意思/n,由于/c,要/v,算/v,每/r,一个/m,词语/n,的/u,概率/n,，/w,这里/r,用/p,到/v,里/f,numpy/en,的/u,array/en,数组/n,，/w,可以/v,很/d,方便/a,的/u,计算/v,每个/r,词语/n,的/u,概率/n,，/w,即/v,是/v,用/p,p/en,0/m,num/en,和/c,p/en,1/m,num/en,来/v,统计/v,不同/a,类别/n,样本/n,的/u,词语/n,所/u,出现/v,的/u,次数/n,，/w,最后/f,对/p,每个/r,元素/n,除/p,以/p,该/r,类别/n,中/f,的/u,总/b,词数/n,来/v,测试/vn,一下/m,吧/y,from/en, ,numpy/en, ,import/en, ,*/w,reload/en,(/w,bayes/en,)/w,</w,module/en, ,'/w,bayes/en,'/w, ,from/en, ,'/w,bayes/en,./w,py/en,'/w,>,listoposts/en,,/w,listclasses/en, ,=/w, ,bayes/en,./w,loaddataset/en,(/w,)/w,myvocablist/en, ,=/w, ,bayes/en,./w,createvocablist/en,(/w,listoposts/en,)/w,trainmat/en, ,=/w, ,[/w,]/w,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w, ,trainmat/en,./w,append/en,(/w,bayes/en,./w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w,postindoc/en,)/w,)/w,p/en,0/m,v/en, ,,/w, ,p/en,1/m,v/en,,/w, ,pab/en, ,=/w, ,bayes/en,./w,trainnb/en,0/m,(/w,trainmat/en,,/w,listclasses/en,)/w,p/en,0/m,vp/en,1/m,v/en,看/v,一/m,看/v,在/p,给定/vn,文档/n,类别/n,条件/n,下/f,词汇表/n,中/f,单词/n,的/u,出现/v,概率/n,,/w, ,看看/v,是否/v,正确/a,./w,词汇表/n,中/f,的/u,第一/m,个/q,词/n,是/v,cute/en, ,,/w, ,其/r,在/p,类别/n, ,0/m,中/f,出现/v,1次/mq, ,,/w,而/c,在/p,类别/n,1/m,中/f,从未/d,出现/v,。/w,对应/v,的/u,条件/n,概率/n,分别/d,为/p, ,0.04166667/m, ,与/p, ,0.0/m,,/w,该/r,计算/v,是/v,正确/a,的/u,我们/r,找/v,找/v,所有/b,概/d,率/v,中/f,的/u,最大值/nz,,/w,该/r,值/n,出现/v,在/p,p/en,(/w,1/m,)/w,数组/n,第/m,21个/m,下标/n,位置/n,,/w,大小/n,为/p, ,0/m,./w,15789474/m,./w,可以/v,查/v,到/v,该/r,单词/n,是/v,stupid/en,，/w,这/r,意味着/v,它/r,最/d,能/v,表征/v,类别/n,1/m,的/u,单词/n,。/w,3.3/m, ,测试/vn,算法/n,：/w,根据/p,现实/n,情况/n,修改/v,分类器/nw,利用/v,贝叶斯分类器/nw,进行/v,文档/n,文类/nw,时/ng,，/w,要/v,计算/v,每个/r,元素/n,的/u,条件/n,概率/n,并/c,相乘/v,，/w,若/c,其中/r,有/v,一个/m,概率/n,值/n,等于/v,0/m,，/w,那么/r,最后/f,的/u,乘积/n,也/d,为/p,0/m,，/w,为/p,降低/v,这种/r,影响/vn,，/w,可以/v,将/d,所有/b,词/n,的/u,出现/v,数/m,初始/b,化为/v,1/m, ,,/w,并/c,将/d,分/q,母/b,初/f,始/vg,化为/v,2/m, ,。/w,相应/v,的/u,trainnb/en,0/m,(/w,)/w,的/u,第/m,4行/mq,和/c,第/m,5行/mq,修改/v,为/p,：/w,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,;/w, , ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, , , , , , ,#,change/en, ,to/en, ,ones/en,(/w,)/w,p/en,0/m,denom/en, ,=/w, ,2.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , , ,#,change/en, ,to/en, ,2.0/m,另/r,一个/m,问题/n,是/v,向/p,下/f,溢/v,出/v,，/w,乘积/n,p/en,(/w,w/en,0/m,|/w,ci/en,)/w,p/en,(/w,w/en,1/m,|/w,ci/en,)/w,p/en,(/w,w/en,2/m,|/w,ci/en,)/w,./w,./w,./w,p/en,(/w,wn/en,|/w,ci/en,)/w,太/d,小/a,的/u,缘故/n, ,解决/v,的/u,办法/n,是/v,对/p,乘/v,积取/nw,对数/n,相应/v,的/u,trainnb/en,0/m,(/w,)/w,的/u,第/m,13行/mq,和/c,第/m,14行/mq,修改/v,为/p,：/w,p/en,1/m,vect/en, ,=/w, ,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w, , , , , , , , ,#,change/en, ,to/en, ,log/en,(/w,)/w,p/en,0/m,vect/en, ,=/w, ,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w, , , , , , , , ,#,change/en, ,to/en, ,log/en,(/w,)/w,将/d,更改/v,好/a,的/u,函数/n,命名/v,为/p,trainnb/en,0/m,_,change/en,现在/t,已经/d,准备/v,好/a,构建/v,完整/a,的/u,分类器/nw,了/u,。/w,当/p,使用/v,numpy/en,向量/n,处理/v,功能/n,时/ng, ,,/w, ,这/r,一切/r,变/v,得/u,十分/d,简单/a,./w,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,2/m, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,#,element/en,-/w,wise/en, ,mult/en, ,3/m, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en,)/w, ,+/w, ,log/en,(/w,1.0/m, ,-/w, ,pclass/en,1/m,)/w, ,4/m, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,5/m, ,return/en, ,1/m, ,6/m, ,else/en,:/w, ,7/m, ,return/en, ,0/m, ,8/m, ,def/en, ,testingnb/en,(/w,)/w,:/w, ,9/m, ,listoposts/en,,/w,listclasses/en, ,=/w, ,loaddataset/en,(/w,)/w, ,10/m, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en,)/w, ,11/m, ,trainmat/en,=/w,[/w,]/w, ,12/m, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w, ,13/m, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,postindoc/en,)/w,)/w, ,14/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en, ,=/w, ,trainnb/en,0/m,_,change/en,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,listclasses/en,)/w,)/w, ,15/m, ,testentry/en, ,=/w, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w, ,16/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,17/m, ,print/en, ,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w, ,18/m, ,testentry/en, ,=/w, ,[/w,'/w,stupid/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w, ,19/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,20/m, ,print/en, ,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w,第一/m,个/q,函数/n,就/d,是/v,两个/m,类别/n,的/u,条件/n,概率/n,进行/v,比较/d,，/w,输出/v,最终/d,的/u,类别/n,信息/n,。/w, ,第二/m,个/q,函数/n,就/d,是/v,一个/m,测试/vn,函数/n,，/w,函数/n,前面/f,部分/n,跟/p,上面/f,一样/u,，/w,后面/f,引入/v,两个/m,测试/vn,样本/n,，/w,进行/v,分类/vn,。/w,reload/en,(/w,bayes/en,)/w,</w,module/en, ,'/w,bayes/en,'/w, ,from/en, ,'/w,bayes/en,./w,pyc/en,'/w,>,bayes/en,./w,testingnb/en,(/w,)/w,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w, ,classified/en, ,as/en,:/w, ,0/m, ,[/w,'/w,stupid/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w, ,classified/en, ,as/en,:/w, ,13.4/m, ,文档/n,词袋/nw,模型/n,我们/r,将/d,每个/r,词/n,的/u,出现/v,与否/u,作为/v,一个/m,特征/n,,/w,这/r,可以/v,被/p,描述/v,为/p,词集/nw,模型/n,，/w,上面/f,就/d,是/v,词集/nw,模型/n,。/w,如果/c,一个/m,词/n,在/p,文档/n,中/f,出现/v,不/d,止/v,一次/mq,,/w,这/r,可能/v,意味/n,着/u,包含/v,该词/nw,是否/v,出现/v,在/p,文档/n,中/f,所/u,不/d,能/v,表达/v,的/u,某种/r,信息/n,,/w,这种/r,方法/n,被/p,称为/v,词袋/nw,模型/n,。/w,词集/nw,和/c,词袋/nw,的/u,区别/n,：/w,在/p,词袋/nw,中/f,,/w,每个/r,单词/n,可以/v,出现/v,多次/m, ,,/w,而/c,在/p,词集/nw,中/f,,/w,每个/r,词/n,只能/v,出现/v,一次/mq,。/w,为/p,适应/v,词袋/nw,模型/n, ,,/w,需要/v,对/p,函数/n,setofwords/en,2/m,vec/en,稍加/v,修改/v,，/w,修改/v,后/f,的/u,函数/n,为/p,bagofwords/en,2/m,vec/en,，/w,代码/n,如下/v,：/w,1/m, ,def/en, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,2/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,3/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,4/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,5/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,+/w,=/w, ,1/m, ,6/m, ,return/en, ,returnvec/en,这个/r,返回/v,的/u,列表/v,表现/v,的/u,是/v,单词/n,出现/v,的/u,次数/n,，/w,还/d,不再/d,是/v,是否/v,出现/v,4/m,./w, ,使用/v,朴素/a,贝叶斯/nr,过滤/v,垃圾/n,邮件/n,4.1/m, ,准备/v,数据/n,：/w,切分/v,文本/n,前面/f,介绍/v,的/u,词向量/nw,是/v,直接/ad,给/p,定/v,的/u,，/w,下面/f,来/v,介绍/v,如何/r,从/p,文本/n,中/f,构建/v,自己/r,的/u,词列表/nw,先/d,从/p,一个/m,文本字符串/nw,介绍/v,mysent/en, ,=/w, ,'/w, ,this/en, ,book/en, ,is/en, ,the/en, ,best/en, ,book/en, ,on/en, ,python/en, ,or/en, ,m/en,./w,l/en,./w, ,i/en, ,have/en, ,ever/en, ,laid/en, ,eyes/en, ,upon/en,./w,'/w,mysent/en,./w,split/en,(/w,)/w,可以/v,看到/v,,/w, ,切/v,分/q,的/u,结果/n,不错/a,,/w, ,但是/c,标点符号/n,也/d,被/p,当成/v,了/u,词/n,的/u,一部分/m,./w,解决/v,方法/n,：/w,可以/v,使用/v,正/d,则/d,表示/v,式/k,来/v,切分/v,句子/n, ,,/w,其中/r,分隔符/n,是/v,除/p,单词/n,、/w,数字/n,外/f,的/u,任意/d,字符/n,串/v,import/en, ,reregex/en, ,=/w, ,re/en,./w,compile/en,(/w,'/w,\/w,\/w,w/en,*/w,'/w,)/w,listoftokens/en, ,=/w, ,regex/en,./w,split/en,(/w,mysent/en,)/w,listoftokens/en,可以/v,看到/v,里面/f,的/u,标点/n,没有/v,了/u,，/w,但/c,剩下/v,一些/m,空/a,字符/n,，/w,还要/v,进行/v,一步/mq,，/w,去掉/v,这些/r,空/a,字符/n,。/w,[/w,tok/en, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>,0/m,]/w,空字符/n,消掉/nw,了/u,，/w,我们/r,可以/v,看到/v,，/w,有的/r,词/n,首/m,字母/n,是/v,大写/n,的/u,，/w,这/r,对/p,句子/n,查找/v,很/d,有用/a,，/w,但/c,我们/r,是/v,构建/v,词袋/nw,模型/n,，/w,所以/c,还是/c,希望/v,格式/n,统一/vn,，/w,还要/v,处理/v,一下/m,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>,0/m,]/w,可以/v,看到/v,大写/n,全部/m,变成/v,了/u,小写/n,，/w,如果/c,是/v,想/v,从/p,小写/n,变成/v,大写/n,，/w,只/d,需/v,将/d,tok/en,./w,lower/en,(/w,)/w,改成/v,top/en,./w,upper/en,(/w,)/w,即/v,可/v,我们/r,构建/v,一个/m,testparse/en,函数/n,，/w,来/v,切分/v,文本/n,，/w,代码/n,如下/v,1/m, ,def/en, ,textparse/en,(/w,bigstring/en,)/w,:/w, ,#,input/en, ,is/en, ,big/en, ,string/en,,/w, ,#,output/en, ,is/en, ,word/en, ,list/en, ,2/m, ,import/en, ,re/en, ,3/m, ,listoftokens/en, ,=/w, ,re/en,./w,split/en,(/w,r/en,'/w,\/w,w/en,*/w,'/w,,/w, ,bigstring/en,)/w, ,4/m, ,return/en, ,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>, ,2/m,]/w,4.2/m, ,测试/vn,算法/n,：/w,使用/v,朴素/a,贝叶斯/nr,进行/v,交叉/vn,验证/vn,参考/v,代码/n,如下/v,：/w,1/m, ,def/en, ,spamtest/en,(/w,)/w,:/w, ,2/m, ,doclist/en,=/w,[/w,]/w,;/w, ,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w,[/w,]/w, ,3/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1/m,,/w,26/m,)/w,:/w, ,4/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,spam/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,5/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,6/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,7/m, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,8/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,ham/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,9/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,10/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,11/m, ,classlist/en,./w,append/en,(/w,0/m,)/w, ,12/m, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w,#,create/en, ,vocabulary/en, ,13/m, ,trainingset/en, ,=/w, ,range/en,(/w,50/m,)/w,;/w, ,testset/en,=/w,[/w,]/w, ,#,create/en, ,test/en, ,set/en, ,14/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,15/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en,)/w,)/w,)/w, ,16/m, ,testset/en,./w,append/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,17/m, ,del/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,18/m, ,trainmat/en,=/w,[/w,]/w,;/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,19/m, ,for/en, ,docindex/en, ,in/en, ,trainingset/en,:/w,#,train/en, ,the/en, ,classifier/en, ,(/w,get/en, ,probs/en,)/w, ,trainnb/en,0/m, ,20/m, ,trainmat/en,./w,append/en,(/w,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w,)/w, ,21/m, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en,]/w,)/w, ,22/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,trainclasses/en,)/w,)/w, ,23/m, ,errorcount/en, ,=/w, ,0/m, ,24/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,#,classify/en, ,the/en, ,remaining/en, ,items/en, ,25/m, ,wordvector/en, ,=/w, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w, ,26/m, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en,)/w, ,!/w,=/w, ,classlist/en,[/w,docindex/en,]/w,:/w, ,27/m, ,errorcount/en, ,+/w,=/w, ,1/m, ,28/m, ,print/en, ,"/w,classification/en, ,error/en,"/w,,/w,doclist/en,[/w,docindex/en,]/w, ,29/m, ,print/en, ,'/w,the/en, ,error/en, ,rate/en, ,is/en,:/w, ,'/w,,/w,float/en,(/w,errorcount/en,)/w,//w,len/en,(/w,testset/en,)/w, ,30/m, ,#,return/en, ,vocablist/en,,/w,fulltext/en,第一/m,个/q,循环/vn,是/v,对/p,垃圾/n,邮件/n,和/c,非/h,垃圾/n,邮件/n,进行/v,切分/v,，/w,然后/c,生成/vn,词列表/nw,和/c,类/q,标签/n,第二/m,个/q,循环/vn,是/v,0/m,到/v,50个/m,数/m,中/f,随机/d,生成/vn,10个/m,序号/n,第三/nw,个/q,循环/vn,是/v,将/d,第二/m,个/q,循环/vn,得到/v,的/u,序号/n,映射/v,到/v,词列表/nw,，/w,得到/v,训练集/nw,和/c,相应/v,的/u,类别/n,，/w,然后/c,进行/v,训练/vn,算法/n,第四/nw,个/q,循环/vn,是/v,进行/v,错误/n,率/v,计算/v,，/w,分类/vn,出/v,的/u,类别/n,与/p,实际/n,类别/n,相/d,比较/d,，/w,累计/v,错误/n,的/u,样本数/n,，/w,最后/f,除/p,以/p,总数/n,，/w,得到/v,错误/n,率/v,bayes/en,./w,spamtest/en,(/w,)/w,the/en, ,error/en, ,rate/en, ,is/en,:/w, ,0.0/m,bayes/en,./w,spamtest/en,(/w,)/w,每次/r,运行/vn,得出/v,的/u,结果/n,可能/v,不/d,太/d,一样/u,，/w,因为/c,是/v,随机/d,选/v,的/u,序号/n,5/m,./w, ,使用/v,朴素/a,贝叶斯分类器/nw,从/p,个人/n,广告/n,中/f,获取/v,区域/n,倾向/n,在/p,这个/r,最后/f,的/u,例子/n,当中/f,,/w,我们/r,将/d,分别/d,从/p,美国/ns,的/u,两个/m,城市/n,中/f,选取/v,一些/m,人/n,,/w,通过/p,分析/vn,这些/r,人/n,发布/v,的/u,征婚/vn,广告/n,信息/n,,/w,来/v,比较/d,这/r,两个/m,城市/n,的/u,人们/n,在/p,广告/n,用/p,词/n,上/f,是否/v,不同/a,。/w,如果/c,结论/n,确实/ad,是/v,不同/a,,/w,那么/r,他们/r,各自/r,常用/a,的/u,词/n,是/v,哪些/r,?/w,从/p,人们/n,的/u,用词/n,当中/f,,/w,我们/r,能否/v,对/p,不同/a,城市/n,的/u,人/n,所/u,关心/v,的/u,内容/n,有所/v,了解/v,？/w,下面/f,将/d,使用/v,来自/v,不同/a,城市/n,的/u,广告/n,训练/vn,一个/m,分类器/nw,,/w,然后/c,观察/v,分类器/nw,的/u,效果/n,。/w,我们/r,的/u,目的/n,并/c,不/d,是/v,使用/v,该/r,分类器/nw,进行/v,分类/vn,,/w,而是/c,通过/p,观察/v,单词/n,和/c,条件/n,概率/n,值/n,来/v,发现/v,与/p,特定/b,城市/n,相关/v,的/u,内容/n,。/w,5.1/m, ,收集/v,数据/n,：/w,导入/v,rss/en,源接/nw,下来/v,要/v,做/v,的/u,第一/m,件/q,事/n,是/v,使用/v,python/en,下载/v,文本/n,,/w,而/c,利用/v,rss/en,，/w,这/r,很/d,容易/a,得到/v,，/w,而/c,universal/en, ,feed/en, ,parser/en, ,是/v,python/en,最/d,常用/a,的/u,rss/en,程序库/nz,。/w,由于/c,python/en,默认/v,不/d,会/v,安装/v,feedparser/en,，/w,所以/c,需要/v,自己/r,手动/b,安装/v,，/w,这里/r,附上/v,ubuntu/en,下/f,的/u,安装/v,方法/n,第一/m,步/q,：/w,wget/en, ,http/en,:/w,//w,//w,pypi/en,./w,python/en,./w,org/en,//w,packages/en,//w,source/en,//w,f/en,//w,feedparser/en,//w,feedparser/en,-/w,5/m,./w,1/m,./w,3/m,./w,tar/en,./w,gz/en,#,md/en,5/m,=/w,f/en,2253/m,de/en,78085/m,a/en,1/m,d/en,5738/m,f/en,626/m,fcc/en,1/m,d/en,8/m,f/en,71/m,第二/m,步/q,：/w,tar/en, ,zxf/en, ,feedparser/en,-/w,5/m,./w,1/m,./w,3/m,./w,tar/en,./w,gz/en,第三/nw,步/q,：/w,cd/en, ,feedparser/en,-/w,5/m,./w,1/m,./w,3/m,第四/nw,步/q,：/w,python/en, ,setup/en,./w,py/en, ,install/en,具体/a,可以/v,看到/v,这个/r,链接/n,：/w,blog/en,./w,csdn/en,./w,net/en,//w,tinkle/en,181129/m,//w,article/en,//w,details/en,//w,45343267/m,相关/v,文档/n,：/w,http/en,:/w,//w,//w,code/en,./w,google/en,./w,com/en,//w,p/en,//w,feedparser/en,//w,import/en, ,feedparserny/en, ,=/w, ,feedparser/en,./w,parse/en,(/w,'/w,http/en,:/w,//w,//w,newyork/en,./w,craigslist/en,./w,org/en,//w,stp/en,//w,index/en,./w,rss/en,'/w,)/w,上面/f,是/v,打开/v,了/u,craigslist/en,上/f,的/u,rss/en,源/ng,，/w,要/v,访问/v,所有/b,条目/n,的/u,列表/v,，/w,输入/v,以下/f,代码/n,ny/en,[/w,'/w,entries/en,'/w,]/w,len/en,(/w,ny/en,[/w,'/w,entries/en,'/w,]/w,)/w,out/en,：/w,25/m,可以/v,构建/v,一个/m,类似/v,spamtest/en,的/u,函数/n,来/v,对/p,测试/vn,过程/n,自动化/vn,1/m, ,def/en, ,calcmostfreq/en,(/w,vocablist/en,,/w,fulltext/en,)/w,:/w, ,2/m, ,import/en, ,operator/en, ,3/m, ,freqdict/en, ,=/w, ,{/w,}/w, ,4/m, ,for/en, ,token/en, ,in/en, ,vocablist/en,:/w, ,5/m, ,freqdict/en,[/w,token/en,]/w,=/w,fulltext/en,./w,count/en,(/w,token/en,)/w, ,6/m, ,sortedfreq/en, ,=/w, ,sorted/en,(/w,freqdict/en,./w,iteritems/en,(/w,)/w,,/w, ,key/en,=/w,operator/en,./w,itemgetter/en,(/w,1/m,)/w,,/w, ,reverse/en,=/w,true/en,)/w, ,7/m, ,return/en, ,sortedfreq/en,[/w,:/w,30/m,]/w, ,8/m, ,9/m, ,def/en, ,localwords/en,(/w,feed/en,1/m,,/w,feed/en,0/m,)/w,:/w, ,10/m, ,import/en, ,feedparser/en, ,11/m, ,doclist/en,=/w,[/w,]/w,;/w, ,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w,[/w,]/w, ,12/m, ,minlen/en, ,=/w, ,min/en,(/w,len/en,(/w,feed/en,1/m,[/w,'/w,entries/en,'/w,]/w,)/w,,/w,len/en,(/w,feed/en,0/m,[/w,'/w,entries/en,'/w,]/w,)/w,)/w, ,13/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,minlen/en,)/w,:/w, ,14/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,feed/en,1/m,[/w,'/w,entries/en,'/w,]/w,[/w,i/en,]/w,[/w,'/w,summary/en,'/w,]/w,)/w, ,15/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,16/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,17/m, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,#,ny/en, ,is/en, ,class/en, ,1/m, ,18/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,feed/en,0/m,[/w,'/w,entries/en,'/w,]/w,[/w,i/en,]/w,[/w,'/w,summary/en,'/w,]/w,)/w, ,19/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,20/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,21/m, ,classlist/en,./w,append/en,(/w,0/m,)/w, ,22/m, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w,#,create/en, ,vocabulary/en, ,23/m, ,top/en,30/m,words/en, ,=/w, ,calcmostfreq/en,(/w,vocablist/en,,/w,fulltext/en,)/w, ,#,remove/en, ,top/en, ,30/m, ,words/en, ,24/m, ,for/en, ,pairw/en, ,in/en, ,top/en,30/m,words/en,:/w, ,25/m, ,if/en, ,pairw/en,[/w,0/m,]/w, ,in/en, ,vocablist/en,:/w, ,vocablist/en,./w,remove/en,(/w,pairw/en,[/w,0/m,]/w,)/w, ,26/m, ,trainingset/en, ,=/w, ,range/en,(/w,2/m,*/w,minlen/en,)/w,;/w, ,testset/en,=/w,[/w,]/w, ,#,create/en, ,test/en, ,set/en, ,27/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,20/m,)/w,:/w, ,28/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en,)/w,)/w,)/w, ,29/m, ,testset/en,./w,append/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,30/m, ,del/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,31/m, ,trainmat/en,=/w,[/w,]/w,;/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,32/m, ,for/en, ,docindex/en, ,in/en, ,trainingset/en,:/w,#,train/en, ,the/en, ,classifier/en, ,(/w,get/en, ,probs/en,)/w, ,trainnb/en,0/m, ,33/m, ,trainmat/en,./w,append/en,(/w,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w,)/w, ,34/m, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en,]/w,)/w, ,35/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,trainclasses/en,)/w,)/w, ,36/m, ,errorcount/en, ,=/w, ,0/m, ,37/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,#,classify/en, ,the/en, ,remaining/en, ,items/en, ,38/m, ,wordvector/en, ,=/w, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w, ,39/m, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en,)/w, ,!/w,=/w, ,classlist/en,[/w,docindex/en,]/w,:/w, ,40/m, ,errorcount/en, ,+/w,=/w, ,1/m, ,41/m, ,print/en, ,'/w,the/en, ,error/en, ,rate/en, ,is/en,:/w, ,'/w,,/w,float/en,(/w,errorcount/en,)/w,//w,len/en,(/w,testset/en,)/w, ,42/m, ,return/en, ,vocablist/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,vlocalwords/en,函数/n,与/p,之前/f,介绍/v,的/u,spamtest/en,函数/n,类似/v,，/w,不同/a,的/u,是/v,它/r,是/v,使用/v,两个/m,rss/en,作为/v,参数/n,。/w,上面/f,还/d,新增/v,了/u,一个/m,辅助/vn,函数/n,calcmostfreq/en,,/w,该/r,函数/n,遍历/nw,词汇表/n,中/f,的/u,每个/r,词/n,并/c,统计/v,它/r,在/p,文本/n,中/f,出现/v,的/u,次数/n,,/w,然后/c,根据/p,出现/v,次数/n,从/p,高/a,到/v,低/a,对/p,词典/n,进行/v,排序/vn, ,,/w, ,最后/f,返回/v,排序/vn,最/d,高/a,的/u,30个/m,单词/n,下面/f,来/v,测试/vn,一下/m,cd/en, ,桌面/n,//w,machinelearninginaction/en,//w,ch/en,04/m,//w,home/en,//w,fangyang/en,//w,桌面/n,//w,machinelearninginaction/en,//w,ch/en,04/m,import/en, ,bayesimport/en, ,feedparserny/en, ,=/w, ,feedparser/en,./w,parse/en,(/w,'/w,http/en,:/w,//w,//w,newyork/en,./w,craigslist/en,./w,org/en,//w,stp/en,//w,index/en,./w,rss/en,'/w,)/w,sf/en, ,=/w, ,feedparser/en,./w,parse/en,(/w,'/w,http/en,:/w,//w,//w,sfbay/en,./w,craigslist/en,./w,org/en,//w,stp/en,//w,index/en,./w,rss/en,'/w,)/w,vocablist/en,,/w,psf/en,,/w,pny/en, ,=/w, ,bayes/en,./w,localwords/en,(/w,ny/en,,/w,sf/en,)/w,the/en, ,error/en, ,rate/en, ,is/en, ,：/w,0.15/m,vocablist/en,,/w,psf/en,,/w,pny/en, ,=/w, ,bayes/en,./w,localwords/en,(/w,ny/en,,/w,sf/en,)/w,the/en, ,error/en, ,rate/en, ,is/en, ,：/w,0.4/m,我们/r,会/v,发现/v,这里/r,的/u,错误/n,率/v,要/v,远/a,高于/v,垃圾/n,邮件/n,中/f,的/u,错误/n,率/v,，/w,这/r,是/v,因为/c,这里/r,关注/v,的/u,是/v,单词/n,概率/n,而/c,不/d,是/v,实际/n,分类/vn,，/w,可以/v,通过/p,calcmostfreq/en,函数/n,改变/v,移/v,除/p,单词/n,数/m,，/w,降低/v,错误/n,率/v,，/w,因为/c,次数/n,最/d,多/a,的/u,前/f,30个/m,单词/n,涵盖/v,了/u,所有/b,用/p,词/n,的/u,30%/mq,，/w,产生/v,这种/r,现象/n,的/u,原因/n,是/v,语言/n,中/f,大部分/m,都/d,是/v,冗余/n,和/c,结构/n,辅助性/nw,内容/n,。/w,5.2/m, ,分析/vn,数据/n,：/w,显示/v,地域/n,相关/v,的/u,用/p,词/n,将/d,psf/en,和/c,pny/en,进行/v,排序/vn,，/w,然后/c,按照/p,顺序/n,将/d,词/n,打印/v,出来/v,，/w,这里/r,用/p,gettopwords/en,函数/n,表示/v,这个/r,功能/n,1/m, ,def/en, ,gettopwords/en,(/w,ny/en,,/w,sf/en,)/w,:/w, ,2/m, ,import/en, ,operator/en, ,3/m, ,vocablist/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,=/w,localwords/en,(/w,ny/en,,/w,sf/en,)/w, ,4/m, ,topny/en,=/w,[/w,]/w,;/w, ,topsf/en,=/w,[/w,]/w, ,5/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,p/en,0/m,v/en,)/w,)/w,:/w, ,6/m, ,if/en, ,p/en,0/m,v/en,[/w,i/en,]/w, ,>, ,-/w,6.0/m, ,:/w, ,topsf/en,./w,append/en,(/w,(/w,vocablist/en,[/w,i/en,]/w,,/w,p/en,0/m,v/en,[/w,i/en,]/w,)/w,)/w, ,7/m, ,if/en, ,p/en,1/m,v/en,[/w,i/en,]/w, ,>, ,-/w,6.0/m, ,:/w, ,topny/en,./w,append/en,(/w,(/w,vocablist/en,[/w,i/en,]/w,,/w,p/en,1/m,v/en,[/w,i/en,]/w,)/w,)/w, ,8/m, ,sortedsf/en, ,=/w, ,sorted/en,(/w,topsf/en,,/w, ,key/en,=/w,lambda/en, ,pair/en,:/w, ,pair/en,[/w,1/m,]/w,,/w, ,reverse/en,=/w,true/en,)/w, ,9/m, ,print/en, ,"/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,sf/en,*/w,*/w,"/w, ,10/m, ,for/en, ,item/en, ,in/en, ,sortedsf/en,:/w, ,11/m, ,print/en, ,item/en,[/w,0/m,]/w, ,12/m, ,sortedny/en, ,=/w, ,sorted/en,(/w,topny/en,,/w, ,key/en,=/w,lambda/en, ,pair/en,:/w, ,pair/en,[/w,1/m,]/w,,/w, ,reverse/en,=/w,true/en,)/w, ,13/m, ,print/en, ,"/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,ny/en,*/w,*/w,"/w, ,14/m, ,for/en, ,item/en, ,in/en, ,sortedny/en,:/w, ,15/m, ,print/en, ,item/en,[/w,0/m,]/w,输入/v,是/v,两个/m,rss/en,源/ng,，/w,然后