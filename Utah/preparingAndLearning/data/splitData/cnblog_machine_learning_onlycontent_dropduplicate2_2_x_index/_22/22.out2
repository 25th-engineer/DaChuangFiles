1/m,./w, ,mnist/en,数据集/nw,1.1/m, ,概述/v,tensorflow/en,框架/n,载/v,tensorflow/en,./w,contrib/en,./w,learn/en,./w,python/en,./w,learn/en,./w,datasets/en,包/v,中/f,提供/v,多/a,个/q,机器/n,学习/v,的/u,数据集/nw,。/w,本节/t,介绍/v,的/u,是/v,mnist/en,数据集/nw,，/w,其/r,功能/n,都/d,定义/n,在/p,mnist/en,./w,py/en,模块/n,中/f,。/w,mnist/en,是/v,一个/m,入门/v,级/q,的/u,计算机/n,视觉/n,数据集/nw,，/w,它/r,包含/v,各种/r,手写/v,数字/n,图片/n,：/w,图/n, ,11/m,它/r,也/d,包含/v,每/r,一张/mq,图片/n,对应/v,的/u,标签/n,，/w,告诉/v,我们/r,这个/r,是/v,数字/n,几/m,。/w,比如/v,，/w,上面/f,这/r,四张/mq,图片/n,的/u,标签/n,分别/d,是/v,5/m,，/w,0/m,，/w,4/m,，/w,11.2/m, ,加/v,载有/v,两种/mq,方式/n,可以/v,获取/v,mnist/en,数据集/nw,：/w,1/m,)/w, ,自动/d,下载/v,tensorflow/en,框架/n,提供/v,了/u,一个/m,函数/n,：/w,read/en,_,data/en,_,sets/en,，/w,该/r,函数/n,能够/v,实现/v,自动/d,下载/v,的/u,功能/n,。/w,如下/v,所示/nz,的/u,程序/n,，/w,就/d,能够/v,自动/d,下载/v,数据集/nw,。/w,from/en, ,tensorflow/en,./w,examples/en,./w,tutorials/en,./w,mnist/en, ,import/en, ,input/en,_,datamnist/en, ,=/w, ,input/en,_,data/en,./w,read/en,_,data/en,_,sets/en,(/w,"/w,mnist/en,_,data/en,//w,"/w,,/w, ,one/en,_,hot/en,=/w,true/en,)/w,//w,//w,由于/c,input/en,_,data/en,只是/d,对/p,read/en,_,data/en,_,sets/en,进行/v,了/u,包装/vn,，/w,其/r,什么/r,也/d,没有/v,做/v,，/w,所以/c,我们/r,可以/v,直接/ad,使用/v,read/en,_,data/en,_,sets/en,./w,from/en, ,tensorflow/en,./w,contrib/en,./w,learn/en,./w,python/en,./w,learn/en,./w,datasets/en,./w,mnist/en, ,import/en, ,read/en,_,data/en,_,setsmnist/en,=/w,read/en,_,data/en,_,sets/en,(/w,"/w,mnist/en,_,data/en,"/w,,/w,one/en,_,hot/en,=/w,true/en,)/w,2/m,)/w, ,手动/b,下载/v,用户/n,也/d,能够/v,手动/b,下载/v,数据集/nw,，/w,然后/c,向/p,read/en,_,data/en,_,sets/en,函数/n,传递/v,所/u,在/p,的/u,本地/r,目录/n,，/w,如下/v,所示/nz,：/w,from/en, ,tensorflow/en,./w,examples/en,./w,tutorials/en,./w,mnist/en, ,import/en, ,input/en,_,datamnist/en, ,=/w, ,input/en,_,data/en,./w,read/en,_,data/en,_,sets/en,(/w,"/w,//w,tmp/en,//w,mnist/en,_,data/en,//w,"/w,,/w, ,false/en,,/w, ,one/en,_,hot/en,=/w,true/en,)/w,ps/en,：/w,mnist/en,数据集/nw,可以/v,yann/en, ,lecun/en,'/w,s/en, ,website/en,进行/v,下载/v,，/w,如/v,所示/nz,是/v,下载/v,后/f,的/u,目录/n,：/w,//w,tmp/en,//w,mnist/en,_,data/en,//w,图/n, ,121.3/m, ,结构/n,1/m,)/w, ,数据/n,分类/vn,自动/d,下载/v,方式/n,的/u,数据集/nw,被/p,分/q,成/v,如/v,表/n, ,11所/mq,示/vg,的/u,三/m,部分/n,。/w,这样/r,的/u,切分/v,很/d,重要/a,，/w,在/p,机器/n,学习/v,模型/n,设计/vn,时/ng,必须/d,有/v,一个/m,单独/d,的/u,测试/vn,数据集/nw,不/d,用于/v,训练/vn,，/w,而是/c,用/p,来/v,评估/vn,这个/r,模型/n,的/u,性能/n,，/w,从而/c,更加/d,容易/a,把/p,设计/vn,的/u,模型/n,推广/v,到/v,其他/r,数据集/nw,上/f,（/w,泛化/nw,）/w,。/w,表/n, ,11/m,数据集/nw,目的/n,mnist/en,./w,train/en,55000/m, ,组/q,图片/n,和/c,标签/n,,/w, ,用于/v,训练/vn,。/w,mnist/en,./w,test/en,10000/m, ,组/q,图片/n,和/c,标签/n,,/w, ,用于/v,最终/d,测试/vn,训练/vn,的/u,准确性/n,。/w,mnist/en,./w,validation/en,5000/m, ,组/q,图片/n,和/c,标签/n,,/w, ,用于/v,迭代/vn,验证/vn,训练/vn,的/u,准确性/n,。/w,ps/en,：/w,若是/c,手动/b,下载/v,则/d,只/d,有/v,两/m,部分/n,，/w,即/v,表/n,中/f,的/u,train/en,和/c,test/en,两/m,部分/n,。/w,2/m,)/w, ,数据/n,展开/v,正如/v,前面/f,提到/v,的/u,一样/u,，/w,每/r,一个/m,mnist/en,数据/n,单元/n,有/v,两/m,部分/n,组成/v,：/w,一张/mq,包含/v,手写/v,数字/n,的/u,图片/n,和/c,一个/m,对应/v,的/u,标签/n,。/w,我们/r,把/p,这些/r,图片/n,设/v,为/p,"/w,x/en,"/w,，/w,把/p,这些/r,标签/n,设/v,为/p,"/w,y/en,"/w,。/w,训练/vn,数据集/nw,和/c,测试/vn,数据集/nw,都/d,包含/v,x/en,和/c,y/en,，/w,比如/v,训练/vn,数据集/nw,的/u,图片/n,是/v, ,mnist/en,./w,train/en,./w,images/en, ,，/w,训练/vn,数据集/nw,的/u,标签/n,是/v, ,mnist/en,./w,train/en,./w,labels/en,。/w,其中/r,每/r,一张/mq,图片/n,包含/v,28/m,像素/n,*/w,28/m,像素/n,。/w,我们/r,可以/v,用/p,一个/m,数字/n,数/m,组/q,来/v,表示/v,这/r,张/q,图片/n,：/w,图/n, ,13/m,tensorflow/en,把/p,这个/r,数组/n,展开/v,成/v,一个/m,向量/n,（/w,数组/n,）/w,，/w,长度/n,是/v, ,28/m,x/en,28/m, ,=/w, ,784/m,，/w,即/v,tensorflow/en,将/d,一个/m,二维/nr,的/u,数组/n,展开/v,成/v,一个/m,一维/nw,的/u,数/m,组/q,，/w,从/p,[/w,28/m,,/w, ,28/m,]/w,数/m,组/q,转换/v,为/p,[/w,784/m,]/w,数/m,组/q,。/w,因此/c,，/w,在/p,mnist/en,训练/vn,数据/n,集中/v,，/w,mnist/en,./w,train/en,./w,images/en, ,是/v,一个/m,形状/n,为/p, ,[/w,60000/m,,/w, ,784/m,]/w, ,的/u,张量/nr,，/w,第一/m,个/q,维度/n,数字/n,用/p,来/v,索引/n,图片/n,，/w,第二/m,个/q,维度/n,数字/n,用/p,来/v,索引/n,每张/r,图片/n,中/f,的/u,像素/n,点/q,。/w,在/p,此/r,张量/nr,里/f,的/u,每/r,一个/m,元素/n,，/w,都/d,表示/v,某/r,张/q,图片/n,里/f,的/u,某个/r,像素/n,的/u,灰度值/nw,，/w,值介/nw,于/p,0/m,和/c,1/m,之间/f,，/w,如/v,图/n, ,14所/mq,示/vg,的/u,二维/nr,结构/n,。/w,图/n, ,14/m,相/d,对应/v,的/u,mnist/en,数据集/nw,的/u,标签/n,是/v,介于/v,0/m,到/v,9/m,的/u,数字/n,，/w,用/p,来/v,描述/v,给/p,定/v,图片/n,里/f,表示/v,的/u,数字/n,。/w,为了/p,用于/v,这个/r,教程/n,，/w,我们/r,使/v,标签/n,数据/n,是/v,"/w,one/en,-/w,hot/en, ,vectors/en,"/w,。/w,一个/m,one/en,-/w,hot/en,向量/n,除了/p,某/r,一位/mq,的/u,数字/n,是/v,1/m,以外/f,其余/r,各/r,维度/n,数字/n,都/d,是/v,0/m,。/w,所以/c,在/p,此/r,教程/n,中/f,，/w,数字/n,n/en,将/d,表示/v,成/v,一个/m,只有/c,在/p,第/m,n/en,维度/n,（/w,从/p,0/m,开始/v,）/w,数字/n,为/p,1/m,的/u,10/m,维向量/nw,。/w,比如/v,，/w,标签/n,0/m,将/d,表示/v,成/v,(/w,[/w,1/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,,/w,0/m,]/w,)/w,。/w,因此/c,，/w,mnist/en,./w,train/en,./w,labels/en, ,是/v,一个/m, ,[/w,60000/m,,/w, ,10/m,]/w, ,的/u,数字/n,矩阵/n,。/w,图/n, ,152/m,./w, ,mnist/en,分类/vn,学习/v,2.1/m, ,实现/v,理论/n,2/m,./w,1/m,./w,1/m, ,m/en,-/w,p/en,神经元/n,模型/n,传统/n,的/u,m/en,-/w,p/en,神经元/n,模型/n,中/f,，/w,每个/r,神经元/n,都/d,接收/v,来自/v,n/en,个/q,其它/r,神经元/n,传递/v,过来/v,的/u,输入/v,信号/n,，/w,这些/r,输入/v,信号/n,通过/p,待/v,权重/nz,的/u,连接/v,进行/v,传递/v,，/w,神经元/n,接收/v,到/v,的/u,总/b,输入值/nw,将/d,与/p,神经元/n,的/u,阈值/n,进行/v,比较/d,，/w,然后/c,通过/p,"/w,激活/vn,函数/n,"/w,处理/v,以/p,产生/v,神经元/n,的/u,输出/v,。/w,如/v,图/n, ,21所/mq,示/vg,的/u,一个/m,神经元/n,模型/n,。/w,图/n, ,21/m,ps/en,：/w,图/n,中/f,所/u,示/vg,的/u,值/n,都/d,为/p,real/en, ,value/en,，/w,并非/v,为/p,向量/n,或/c,矩阵/n,。/w,2/m,./w,1/m,./w,2/m, ,softmax/en,函数/n,softmax/en,函数/n,与/p,sigmoid/en,函数/n,类似/v,都/d,可以/v,作为/v,神经/n,网络/n,的/u,激活/vn,函数/n,。/w,sigmoid/en,将/d,一个/m,real/en, ,value/en,映射/v,到/v,（/w,0/m,,/w,1/m,）/w,的/u,区间/n,（/w,当然/d,也/d,可以/v,是/v,（/w,-/w,1/m,,/w,1/m,）/w,）/w,，/w,这样/r,可以/v,用/p,来/v,做/v,二/m,分类/vn,。/w,而/c,softmax/en,把/p,一个/m,k/en,维/q,的/u,real/en, ,value/en,向量/n,[/w,a/en,1/m,,/w,a/en,2/m,,/w,a/en,3/m,,/w,a/en,4/m,…/w,./w,]/w,映射/v,成/v,一个/m,[/w,b/en,1/m,,/w,b/en,2/m,,/w,b/en,3/m,,/w,b/en,4/m,…/w,./w,]/w,，/w,其中/r,bi/en,是/v,一个/m,0/m,-/w,1/m,的/u,常数/n,，/w,然后/c,可以/v,根据/p,bi/en,的/u,大小/n,来/v,进行/v,多/a,分类/vn,的/u,任务/n,，/w,如/v,取权/nw,重/a,最/d,大/a,的/u,一维/mq,。/w,所以/c,对于/p,mnist/en,分类/vn,任务/n,是/v,多/a,分类/vn,类型/n,，/w,所以/c,需要/v,使用/v,softmax/en,函数/n,作为/v,神经/n,网络/n,的/u,激活/vn,函数/n,。/w,2/m,./w,1/m,./w,3/m, ,mnist/en,模型/n,分析/vn,正如/v,图/n, ,14所/mq,分析/vn,的/u,，/w,输入/v,的/u,训练/vn,图片/n,或/c,测试/vn,图片/n,为/p,一个/m,[/w,60000/m,,/w, ,784/m,]/w,的/u,矩阵/n,，/w,每张/r,图片/n,都/d,是/v,一个/m,[/w,784/m,]/w,的/u,向量/n,；/w,输出/v,为/p,一个/m,[/w,60000/m,,/w, ,10/m,]/w,的/u,矩阵/n,，/w,每张/r,图片/n,都/d,对应/v,有/v,一个/m,[/w,10/m,]/w,的/u,向量/n,标签/n,。/w,所以/c,对于/p,每张/r,图片/n,的/u,输入/v,和/c,每个/r,标签/n,的/u,输出/v,，/w,其/r,神经/n,网络/n,模型/n,可/v,表示/v,为/p,错误/n,!/w, ,未/d,找到/v,引用/v,源/ng,。/w,所/u,示/vg,的/u,简化/v,版本/n,，/w,图/n,中/f,所有/b,值/n,都/d,为/p,read/en, ,value/en,。/w,图/n, ,22/m, ,前馈/nw,神经/n,网络/n,（/w,一个/m,带有/v,10个/m,神经元/n,的/u,隐藏层/nw,）/w,如果/c,把/p,它/r,写/v,成/v,一个/m,等式/n,，/w,我们/r,可以/v,得到/v,：/w,我们/r,也/d,可以/v,用/p,向/p,量/n,表示/v,这个/r,计算/v,过程/n,：/w,用/p,矩阵/n,乘法/n,和/c,向量/n,相加/v,。/w,这/r,有助于/v,提高/v,计算/v,效率/n,。/w,（/w,也/d,是/v,一种/mq,更/d,有效/a,的/u,思考/v,方式/n,）/w,更进一步/l,，/w,可以/v,写/v,成/v,更加/d,紧凑/a,的/u,方式/n,：/w,式/k,中/f,，/w, ,b/en,和/c,y/en,都/d,为/p,一个/m,[/w,10/m,]/w,类型/n,的/u,向量/n,，/w,x/en,为/p,一个/m,[/w,784/m,]/w,类型/n,的/u,向量/n,，/w,w/en,是/v,一个/m,[/w,10/m,,/w,784/m,]/w,类型/n,的/u,矩阵/n,。/w,2.2/m, ,tensorflow/en,实现/v,对于/p,机器/n,学习/v,中/f,的/u,监督/vn,学习/v,任务/n,可以/v,分/q,四个/m,步骤/n,完成/v,，/w,如下/v,所示/nz,：/w,模型/n,选择/v,：/w,选择/v,一个/m,estimator/en,对象/n,；/w,模型/n,训练/vn,：/w,根据/p,训练/vn,数据集/nw,来/v,训练/vn,模型/n,；/w,模型/n,测试/vn,：/w,测量/vn,模型/n,的/u,泛化/nw,能力/n,，/w,即/v,对/p,其/r,评分/vn,；/w,模型/n,应用/vn,：/w,进行/v,实际/n,预测/v,或/c,应用/vn,。/w,2/m,./w,2/m,./w,1/m, ,模型/n,选择/v,由于/c,我们/r,已经/d,选择/v,神经/n,网络/n,为/p,监督/vn,学习/v,任务/n,的/u,模型/n,，/w,即/v,式/k,(/w,3/m,)/w,所/u,示/vg,的/u,等式/n,，/w,我们/r,可/v,通过/p,使用/v,下/f,标/v,来/v,表明/v,等/u,式/k,中/f,变量/n,的/u,维数/nr,，/w,如下/v,所示/nz,：/w,所以/c,在/p,tensorflow/en,中/f,的/u,实现/v,，/w,就/d,需要/v,定义/n,相应/v,的/u,变量/n,和/c,等式/n,。/w,但是/c,式/k,(/w,4/m,)/w,中/f,的/u,x/en,是/v,一个/m,[/w,784/m,]/w,的/u,向量/n,，/w,而/c,实际/n,待/v,训练/vn,的/u,输入/v,数据/n,是/v,一个/m,[/w,60000/m,,/w, ,784/m,]/w, ,的/u,矩阵/n,，/w,所以/c,需要/v,对/p,式/k,(/w,4/m,)/w,进行/v,稍微/d,的/u,变形/v,，/w,使/v,其/r,满足/v,数据/n,输入/v,和/c,数据/n,输出/v,的/u,要求/v,，/w,即/v,如下/v,所示/nz,的/u,等式/n,:/w,x/en,是/v,输入/v,参数/n,，/w,为/p,训练/vn,数据/n,，/w,即/v,多/a,张/q,图像/n,；/w,w/en,和/c,b/en,是/v,未知/vn,参数/n,，/w,即/v,通过/p,神经/n,网络/n,来/v,训练/vn,的/u,数据/n,；/w,y/en,为/p,输出/v,参数/n,，/w,为/p,图像/n,标签/n,，/w,将/d,使用/v,该/r,值/n,与/p,已知/nz,标签/n,进行/v,比较/d,。/w,如下/v,所示/nz,是/v,tensorflow/en,的/u,实现/v,：/w,#, ,create/en, ,the/