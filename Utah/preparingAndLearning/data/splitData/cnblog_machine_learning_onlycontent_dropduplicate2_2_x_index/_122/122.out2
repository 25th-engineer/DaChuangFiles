gbdt/en,（/w,又称/v,gradient/en, ,boosted/en, ,decision/en, ,tree/en,//w,grdient/en, ,boosted/en, ,regression/en, ,tree/en,）/w,，/w,是/v,一种/mq,迭代/vn,的/u,决策/n,树/v,算法/n,，/w,该/r,算法/n,由/p,多/a,个/q,决策/n,树/v,组成/v,。/w,它/r,最早/d,见于/v,yahoo/en,，/w,后/f,被/p,广泛/a,应用/vn,在/p,搜索/vn,排序/vn,、/w,点击率/nw,预估/v,上/f,。/w,xgboost/en,是/v,陈天奇/nr,大/a,牛/n,新/a,开发/v,的/u,boosting/en,库/n,。/w,它/r,是/v,一个/m,大规模/b,、/w,分布/v,式/k,的/u,通用/vn,gradient/en, ,boosting/en,（/w,gbdt/en,）/w,库/n,，/w,它/r,在/p,gradient/en, ,boosting/en,框架/n,下/f,实现/v,了/u,gbdt/en,和/c,一些/m,广义/n,的/u,线性/n,机器/n,学习/v,算法/n,。/w,本文/r,首先/d,讲解/v,了/u,gbdt/en,的/u,原理/n,，/w,分析/vn,了/u,代码/n,实现/v,；/w,随后/d,分析/vn,了/u,xgboost/en,的/u,原理/n,和/c,实现/v,逻辑/n,。/w,本文/r,的/u,目录/n,如下/v,：/w,一/m,、/w,gbdt/en,1/m,./w, ,gbdt/en,简介/n,2/m,./w, ,gbdt/en,公式/n,推导/vn,3/m,./w, ,优缺点/n,4/m,./w, ,实现/v,分析/vn,5/m,./w, ,常用/a,参数/n,和/c,调/v,优/ag,二/m,、/w,xgboost/en,1/m,./w, ,xgboost/en,简介/n,2/m,./w, ,xgboost/en,公式/n,推导/vn,3/m,./w, ,优缺点/n,4/m,./w, ,实现/v,分析/vn,5/m,./w, ,常用/a,参数/n,和/c,调/v,优/ag,一/m,、/w,gbdt/en,//w,gbrt/en,1/m,./w, ,gbdt/en,简介/n,gbdt/en,是/v,一个/m,基于/p,迭代/vn,累加/v,的/u,决策/n,树/v,算法/n,，/w,它/r,通过/p,构造/v,一组/mq,弱/a,的/u,学习器/nw,（/w,树/v,）/w,，/w,并/c,把/p,多/a,颗/q,决策/n,树/v,的/u,结果/n,累/a,加/v,起来/v,作为/v,最终/d,的/u,预测/v,输出/v,。/w,树/v,模型/n,也/d,分为/v,决策/n,树/v,和/c,回归/v,树/v,，/w,决策树/nz,常/d,用/p,来/v,分类/vn,问题/n,，/w,回归/v,树常/nr,用/p,来/v,预测/v,问题/n,。/w,决策/n,树常/nr,用于/v,分类/vn,标签/n,值/n,，/w,比如/v,用户/n,性别/n,、/w,网页/n,是否/v,是/v,垃圾/n,页面/n,、/w,用户/n,是/v,不/d,是/v,作弊/vn,；/w,而/c,回归/v,树常/nr,用于/v,预测/v,真实/a,数值/n,，/w,比如/v,用户/n,的/u,年龄/n,、/w,用户/n,点击/v,的/u,概率/n,、/w,网页/n,相关/v,程度/n,等等/u,。/w,由于/c,gbdt/en,的/u,核心/n,在/p,与/p,累加/v,所有/b,树/v,的/u,结果/n,作为/v,最终/d,结果/n,，/w,而/c,分类/vn,结果/n,对于/p,预测/v,分类/vn,并/c,不/d,是/v,这么/r,的/u,容易/a,叠加/vn,（/w,稍/d,等/u,后面/f,会/v,看到/v,，/w,其实/d,并/c,不是/v,简单/a,的/u,叠加/vn,，/w,而是/c,每/r,一步/mq,每/r,一棵/mq,树/v,拟合/nz,的/u,残差/nw,和/c,选择/v,分裂点/nw,评价/v,方式/n,都/d,是/v,经过/p,公式/n,推导/vn,得到/v,的/u,）/w,，/w,所以/c,gbdt/en,中/f,的/u,树/v,都/d,是/v,回归/v,树/v,（/w,其实/d,回归/v,树/v,也/d,能/v,用/p,来/v,做/v,分类/vn,的/u,哈/j,）/w,。/w,同样/d,的/u,我们/r,经常/d,会/v,把/p,randomforest/en,的/u,思想/n,引入/v,到/v,gbdt/en,里面/f,来/v,，/w,即/v,每/r,棵/q,树/v,建树/n,的/u,时候/n,我们/r,会/v,对/p,特征/n,和/c,样本/n,同时/c,进行/v,采样/v,，/w,然后/c,对/p,采样/v,的/u,样本/n,和/c,特征/n,进行/v,建树/n,。/w,好/a,啦/y,，/w,既然/c,每/r,棵/q,树/v,拟合/nz,的/u,值/n,、/w,预测值/n,、/w,分裂点/nw,选取/v,都/d,不/d,是/v,随便/ad,选取/v,的/u,，/w,那么/r,到底/d,是/v,如何/r,选择/v,的/u,呢/y,？/w,我们/r,先/d,进入/v,gbdt/en,的/u,公式/n,推导/vn,吧/y,2/m,./w, ,gbdt/en,公式/n,推导/vn,我们/r,都/d,知道/v,lr/en,的/u,映射/v,函数/n,是/v,，/w,损失/n,函数/n,是/v,。/w,对于/p,分类/vn,问题/n,来说/u,，/w,我们/r,一般/a,选取/v,映射/v,函数/n,，/w,构造/v,损失/n,函数/n,，/w,然后/c,逐步/d,求解/v,使得/v,损失/n,函数/n,最小化/nw,就/d,行/v,了/u,，/w,可是/c,对于/p,回归/v,问题/n,，/w,求解/v,的/u,方式/n,就/d,有/v,些/q,不/d,同/p,了/u,。/w,那么/r,gbdt/en,的/u,目标/n,函数/n,和/c,损失/n,函数/n,分别/d,又/d,是/v,什么/r,的/u,呢/y,？/w,每个/r,树/v,拟合/nz,的/u,残差/nw,是/v,什么/r,呢/y,？/w,首先/d,gbdt/en,和/c,lr/en,是/v,不/d,一样/u,的/u,，/w,因为/c,gbdt/en,是/v,希望/v,组合/v,一组/mq,弱/a,的/u,学习器/nw,的/u,线性/n,组合/v,，/w,于是/c,我们/r,有/v,：/w,那么/r,它/r,的/u,目标/n,函数/n,就/d,如下/v,，/w,其中/r,如/v,上/f,公式/n,中/f,是/v,p/en,步长/nz,，/w,而/c,h/en,(/w,x/en,;/w,am/en,)/w,是/v,第/m,m/en,颗/q,树/v,的/u,预测值/n,---/nrf,梯度/n,方向/n,。/w,我们/r,可以/v,在/p,函数/n,空间/n,上/f,形式/n,使用/v,梯度/n,下降/v,法/j,求解/v,，/w,首先/d,固定/a,x/en,，/w,对/p,f/en,(/w,x/en,)/w,求/v,其/r,最/d,优解/nw,。/w,下面/f,给/p,出/v,框架/n,流程/n,和/c,logloss/en,下/f,的/u,推导/vn,，/w,框架/n,流程/n,如下/v,：/w,我们/r,需要/v,估计/v,g/en,_,m/en,(/w,x/en,)/w,，/w,这里/r,使用/v,决策/n,树/v,实现/v,去/v,逼近/v,g/en,_,m/en,(/w,x/en,)/w,，/w,使得/v,两者/r,之间/f,的/u,距离/n,尽可能/d,的/u,近/a,。/w,而/c,距离/n,的/u,衡量/v,方式/n,有/v,很多/m,种/q,，/w,比如/v,均方/nw,误差/n,和/c,logloss/en,误差/n,。/w,我/r,在/p,这里/r,给/p,出/v,logloss/en,损失/n,函数/n,下/f,的/u,具体/a,推导/vn,：/w,（/w,gbdt/en,预测/v,值/n,到/v,输出/v,概率/n,[/w,0/m,,/w,1/m,]/w,的/u,sigmoid/en,转换/v,）/w,下面/f,，/w,我们/r,需要/v,首先/d,求解/v,f/en,0/m,，/w,然后/c,再/d,求解/v,每个/r,梯度/n,。/w,step/en, ,1/m,./w, ,首先/d,求解/v,初始值/n,f/en,0/m,，/w,令/v,其/r,偏导/nw,为/p,0/m,。/w,（/w,实现/v,时/ng,是/v,第/m,1颗/mq,树/v,需要/v,拟合/nz,的/u,残差/nw,）/w,step/en,2/m,./w, ,估计/v,g/en,_,m/en,(/w,x/en,)/w,，/w,并/c,用/p,决策/n,树/v,对/p,其/r,进行/v,拟合/nz,。/w,g/en,_,m/en,(/w,x/en,)/w,是/v,梯度/n,，/w,实现/v,时/ng,是/v,第/m,m/en,颗/q,树/v,需要/v,拟合/nz,的/u,残差/nw,：/w,step/en,3/m,./w, , ,使用/v,牛顿/q,法求/nw,解/v,下降/v,方向/n,步长/nz,。/w,r/en,_,jm/en,是/v,拟合/nz,的/u,步长/nz,，/w,实现/v,时/ng,是/v,每/r,棵/q,树/v,的/u,预测值/n,：/w,step/en,4/m,./w, ,预测/v,时/ng,就/d,很/d,简单/a,啦/y,，/w,把/p,每/r,棵/q,树/v,的/u,预测/v,值/n,乘/v,以/p,缩放/v,因子/n,加/v,到/v,一起/s,就/d,得到/v,预测/v,值啦/nw,：/w,注意/v,如果/c,需要/v,输出/v,的/u,区间/n,在/p,(/w,0/m,,/w,1/m,)/w,之间/f,，/w,我们/r,还/d,需要/v,做/v,如下/v,转换/v,：/w,3/m,./w, ,优缺点/n,gbdt/en,的/u,优点/n,当然/d,很/d,明显/a,啦/y,，/w,它/r,的/u,非线性/b,变换/v,比较/d,多/a,，/w,表达/v,能力/n,强/a,，/w,而且/c,不/d,需要/v,做/v,复杂/a,的/u,特征/n,工程/n,和/c,特征/n,变换/v,。/w,gbdt/en,的/u,缺点/n,也/d,很/d,明显/a,，/w,boost/en,是/v,一个/m,串行/b,过程/n,，/w,不好/a,并行化/nw,，/w,而且/c,计算/v,复杂度/nw,高/a,，/w,同时/c,不/d,太/d,适合/v,高维/nr,洗漱/v,特征/n,。/w,4/m,./w, ,实现/v,分析/vn,5/m,./w, ,参数/n,和/c,模型/n,调/v,优/ag,gbdt/en,常用/a,的/u,参数/n,有/v,如下/v,几/m,个/q,：/w,1/m,./w, ,树/v,个数/n,2/m,./w, ,树/v,深度/n,3/m,./w, ,缩放/v,因子/n,4/m,./w, ,损失/n,函数/n,5/m,./w, ,数据/n,采样/v,比/p,6/m,./w, ,特征/n,采样/v,比/p,二/m,、/w,xgboostxgboost/en,是/v,boosting/en, ,tree/en,的/u,一个/m,很/d,牛/n,的/u,实现/v,，/w,它/r,在/p,最近/t,kaggle/en,比赛/vn,中/f,大放异彩/i,。/w,它/r, ,有/v,以下/f,几/m,个/q,优良/z,的/u,特性/n,：/w,1/m,./w, ,显示/v,的/u,把/p,树/v,模型/n,复杂度/nw,作为/v,正/d,则/d,项/q,加/v,到/v,优化/v,目标/n,中/f,。/w,2/m,./w, ,公式/n,推导/vn,中/f,用到/v,了/u,二阶/nr,导数/n,，/w,用/p,了/u,二阶/nr,泰勒/nr,展开/v,。/w,（/w,gbdt/en,用/p,牛顿/q,法貌/nw,似/vg,也/d,是/v,二阶/nr,信息/n,）/w,3/m,./w, ,实现/v,了/u,分裂点/nw,寻找/v,近似/a,算法/n,。/w,4/m,./w, ,利用/v,了/u,特征/n,的/u,稀疏性/nw,。/w,5/m,./w, ,数据/n,事先/d,排序/vn,并且/c,以/p,block/en,形式/n,存储/vn,，/w,有利于/v,并行/v,计算/v,。/w,6/m,./w, ,基于/p,分布式/b,通信/vn,框架/n,rabit/en,，/w,可以/v,运行/vn,在/p,mpi/en,和/c,yarn/en,上/f,。/w,（/w,最新/a,已经/d,不/d,基于/p,rabit/en,了/u,）/w,7/m,./w, ,实现/v,做/v,了/u,面向/v,体系/n,结构/n,的/u,优化/v,，/w,针对/p,cache/en,和/c,内存/n,做/v,了/u,性能/n,优化/v,。/w,在/p,项目/n,实测/vn,中/f,使用/v,发现/v,，/w,xgboost/en,的/u,训练/vn,速度/n,要/v,远远/d,快/a,于/p,传统/n,的/u,gbdt/en,实现/v,，/w,10倍/mq,量级/n,。/w,1/m,./w, ,原理/n,在/p,有/v,监督/vn,学习/v,中/f,，/w,我们/r,通常/d,会/v,构造/v,一个/m,目标/n,函数/n,和/c,一个/m,预测/v,函数/n,，/w,使用/v,训练/vn,样本/n,对/p,目标/n,函数/n,最小化/nw,学习/v,到/v,相关/v,的/u,参数/n,，/w,然后/c,用/p,预测/v,函数/n,和/c,训练/vn,样本/n,得到/v,的/u,参数/n,来/v,对/p,未知/vn,的/u,样本/n,进行/v,分类/vn,的/u,标注/v,或者/c,数值/n,的/u,预测/v,。/w,一般/a,目标/n,函数/n,是/v,如下/v,形式/n,的/u,，/w,我们/r,通过/p,对/p,目标/n,函数/n,最小化/nw,，/w,求解/v,模型/n,参数/n,。/w,预测/v,函数/n,、/w,损失/n,函数/n,、/w,正则化/nw,因子/n,在/p,不同/a,模型/n,下/f,是/v,各/r,不/d,相同/a,的/u,。/w,其中/r,预测/v,函数/n,有/v,如下/v,几/m,种/q,形式/n,：/w,1/m,./w, ,普通/a,预测/v,函数/n,a/en,./w, ,线性/n,下/f,我们/r,的/u,预测/v,函数/n,为/p,：/w,b/en,./w, ,逻辑/n,回归/v,下/f,我们/r,的/u,预测/v,函数/n,为/p,：/w,2/m,./w, ,损失/n,函数/n,：/w,a/en,./w, ,平方/q,损失/n,函数/n,：/w,b/en,./w, ,logistic/en,损失/n,函数/n,：/w,3/m,./w, ,正则化/nw,：/w,a/en,./w, ,l/en,1/m, , ,参数/n,求/v,和/c,b/en,./w, ,l/en,2/m, , ,参数/n,平方求/nw,和/c,其实/d,我/r,个人/n,感觉/n,boosting/en, , ,tree/en,的/u,求解/v,方式/n,和/c,以上/f,略/d,有/v,不同/a,，/w,boosting/en, ,tree/en,由于/c,是/v,回归/v,树/v,，/w,一般/a,是/v,构造/v,树/v,来/v,拟合/nz,残差/nw,，/w,而/c,不/d,是/v,最小化/nw,损失/n,函数/n,。/w,且/c,看/v,gbdt/en,情况/n,下/f,我们/r,的/u,预测/v,函数/n,为/p,：/w,而/c,xgboost/en,引入/v,了/u,二阶导/nr,来/v,进行/v,求解/v,，/w,并且/c,引入/v,了/u,节点/n,的/u,数目/n,、/w,参数/n,的/u,l/en,2/m,正/d,则/d,来/v,评估/vn,模型/n,的/u,复杂度/nw,。/w,那么/r,xgboost/en,是/v,如何/r,构造/v,和/c,预测/v,的/u,呢/y,？/w,首先/d,我们/r,给/p,出/v,结果/n,，/w,xgboost/en,的/u,预测/v,函数/n,为/p,：/w,而/c,目标/n,函数/n,为/p,：/w,那么/r,作者/n,是/v,如何/r,构思/v,得到/v,这些/r,预测/v,函数/n,和/c,优化/v,目标/n,的/u,呢/y,？/w,它们/r,又/d,如何/r,求解/v,得到/v,的/u,呢/y,？/w, ,答案/n,是/v,作者/n,巧妙/a,的/u,利用/v,了/u,泰勒/nr,二阶/nr,展开/v,和/c,巧妙/a,的/u,定义/n,了/u,正/d,则/d,项/q,，/w,用/p,求解/v,到/v,的/u,数值/n,作为/v,树/v,的/u,预测值/n,。/w,我们/r,定义/n,正/d,则/d,化项/nw,：/w,可以/v,得到/v,目标/n,函数/n,转化/v,为/p,：/w,然后/c,就/d,可以/v,求解/v,得到/v,：/w,同样/d,在/p,分裂点/nw,选择/v,的/u,时候/n,也/d,，/w,以/p,目标/n,函数/n,最小化/nw,为/p,目标/n,。/w,2/m,./w, ,实现/v,分析/vn,：/w,3/m,./w, ,参数/n,调/v,优/ag,：/w,a/en,./w, ,初阶/nw,参数/n,调/v,优/ag,：/w,1/m,)/w,./w, ,booster/en,2/m,)/w,./w, ,objective/en,3/m,)/w,./w, ,eta/en,4/m,)/w,./w, ,gamma/en,5/m,)/w,./w, ,min/en,_,child/en,_,weight/en,6/m,)/w,./w, ,max/en,_,depth/en,7/m,)/w,./w, ,colsample/en,_,bytree/en,8/m,)/w,./w, ,subsample/en,9/m,)/w,./w, ,num/en,_,round/en,10/m,)/w,./w, ,save/en,_,period/en,参考/v,文献/n,：/w,1/m,./w, ,xgboost/en,导读/v,和/c,实践/v,：/w,http/en,:/w,//w,//w,vdisk/en,./w,weibo/en,./w,com/en,//w,s/en,//w,vlqwp/en,3/m,erg/en,2/m,yo/en,//w,14316586792/m,./w, ,gbdt/en,(/w,mart/en,)/w, ,迭代/vn,决策/n,树/v,入门/v,教程/n,：/w, ,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,w/en,28971023/m,//w,article/en,//w,detai