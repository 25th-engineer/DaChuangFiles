声明/n,：/w,本篇/r,博文/nz,是/v,学习/v,《/w,机器/n,学习/v,实战/n,》/w,一/m,书/n,的/u,方式/n,路程/n,，/w,系/v,原创/b,，/w,若/c,转载/v,请/v,标明/v,来源/n,。/w,1/m, ,贝叶斯/nr,定理/n,的/u,引入/v,概率/n,论/v,中/f,的/u,经典/n,条件/n,概率/n,公式/n,：/w,公式/n,的/u,理解/v,为/p,，/w,p/en,（/w,x/en, ,，/w,y/en,）/w,=/w, ,p/en,（/w,y/en,，/w,x/en,）/w,</w,=/w,>, ,p/en,（/w,x/en, ,|/w, ,y/en,）/w,p/en,（/w,y/en,）/w,=/w, ,p/en,（/w,y/en, ,|/w, ,x/en,）/w,p/en, ,（/w,x/en,）/w,，/w,即/v, ,x/en, ,和/c, ,y/en, ,同时/c,发生/v,的/u,概率/n,与/p, ,y/en, ,和/c, ,x/en, ,同时/c,发生/v,的/u,概率/n,一样/u,。/w,2/m, ,朴素/a,贝叶斯/nr,定理/n,朴素/a,贝叶斯/nr,的/u,经典/n,应用/vn,是/v,对/p,垃圾/n,邮件/n,的/u,过滤/v,，/w,是/v,对/p,文本/n,格式/n,的/u,数据/n,进行/v,处理/v,，/w,因此/c,这里/r,以此/d,为/p,背景/n,讲解/v,朴素/a,贝叶斯/nr,定理/n,。/w,设/v,d/en, ,是/v,训练/vn,样本/n,和/c,相/d,关联/vn,的/u,类/q,标号/n,的/u,集合/v,，/w,其中/r,训练/vn,样本/n,的/u,属性/n,集/vg,为/p, , , , , , , , , , ,x/en, ,{/w, ,x/en,1/m,,/w,x/en,2/m,,/w, ,./w,./w,./w, ,,/w, ,xn/en, ,}/w,,/w, ,共有/v,n/en, ,个/q,属性/n,；/w,类/q,标号/n,为/p, ,c/en,{/w, ,c/en,1/m,,/w,c/en,2/m,,/w, ,./w,./w,./w, ,,/w,cm/en, ,}/w,,/w, ,有/v,m/en, ,中/f,类别/n,。/w,朴素/a,贝叶斯/nr,定理/n,：/w,其中/r,，/w,p/en,（/w,ci/en, ,|/w, ,x/en,）/w,为/p,后验/nw,概率/n,，/w,p/en,（/w,ci/en,）/w,为/p,先验/n,概率/n,，/w,p/en,（/w,x/en, ,|/w, ,ci/en,）/w,为/p,条件/n,概率/n,。/w,朴素/a,贝叶斯/nr,的/u,两个/m,假设/v,：/w,1/m,、/w,属性/n,之间/f,相互/d,独立/v,。/w,2/m,、/w,每个/r,属性/n,同等/b,重要/a,。/w,通过/p,假设/v,1/m, ,知/v,，/w,条件/n,概率/n,p/en,（/w,x/en, ,|/w, ,ci/en,）/w,可以/v,简化/v,为/p,：/w,3/m, ,朴素/a,贝叶斯算法/nw,朴素/a,贝叶斯算法/nw,的/u,核心/n,思想/n,：/w,选择/v,具有/v,最高/a,后验/nw,概率/n,作为/v,确定/v,类别/n,的/u,指标/n,。/w,下面/f,是/v,以/p,过滤/v,有/v,侮辱性/n,的/u,评论/n,为/p,例/n,，/w,介绍/v,朴素/a,贝叶斯/nr,利用/v,python/en, ,语言/n,实现/v,的/u,过程/n,，/w,其/r,本质/n,是/v,利用/v,词/n,和/c,类别/n,的/u,联合/v,概率/n,来/v,预测/v,给/p,定文档/nw,属于/v,某个/r,类别/n,。/w,4/m, ,使用/v,python/en,对/p,文本/n,分类/vn,4.1/m, ,建立/v,文本/n,数据/n,文本/n,数据/n,用/p,一个个/nw,对象/n,组成/v,，/w,一个/m,对象/n,是/v,由/p,若干/m,单词/n,组成/v,，/w,每个/r,对象/n,对应/v,一个/m,确定/v,的/u,类别/n,。/w,代码/n,如下/v,：/w,1/m, ,#, ,文本/n,数据集/nw, ,2/m, ,def/en, ,loaddatalist/en,(/w,)/w,:/w, ,3/m, ,postinglist/en, ,=/w, ,[/w, ,4/m, ,[/w,'/w,my/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,has/en,'/w,,/w,'/w,flea/en,'/w,,/w,'/w,problems/en,'/w,,/w,'/w,help/en,'/w,,/w,'/w,please/en,'/w,]/w,,/w, ,5/m, ,[/w,'/w,maybe/en,'/w,,/w,'/w,not/en,'/w,,/w,'/w,take/en,'/w,,/w,'/w,him/en,'/w,,/w,'/w,to/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,park/en,'/w,,/w,'/w,stupid/en,'/w,]/w,,/w, ,6/m, ,[/w,'/w,my/en,'/w,,/w,'/w,dalmation/en,'/w,,/w,'/w,is/en,'/w,,/w,'/w,so/en,'/w,,/w,'/w,cute/en,'/w,,/w,'/w,i/en,'/w,,/w,'/w,love/en,'/w,,/w,'/w,him/en,'/w,]/w,,/w, ,7/m, ,[/w,'/w,stop/en,'/w,,/w,'/w,posting/en,'/w,,/w,'/w,stupid/en,'/w,,/w,'/w,worthless/en,'/w,,/w,'/w,garbage/en,'/w,]/w,,/w, ,8/m, ,[/w,'/w,mr/en,'/w,,/w,'/w,licks/en,'/w,,/w,'/w,ate/en,'/w,,/w,'/w,my/en,'/w,,/w,'/w,steak/en,'/w,,/w,'/w,how/en,'/w,,/w,'/w,to/en,'/w,,/w,'/w,stop/en,'/w,,/w,'/w,him/en,'/w,]/w,,/w, ,9/m, ,[/w,'/w,quit/en,'/w,,/w,'/w,buying/en,'/w,,/w,'/w,worthless/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,food/en,'/w,,/w,'/w,stupid/en,'/w,]/w,]/w, ,10/m, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,11/m, ,return/en, ,postinglist/en, ,,/w,classvec/en,4.2/m, ,对/p,文本/n,数据/n,的/u,处理/v,从/p,文本/n,数据/n,中/f,提取/v,出/v,训练/vn,样本/n,的/u,属性/n,集/vg,，/w,这里/r,是/v,属性/n,集/vg,是/v,由/p,单词/n,组成/v,的/u,词汇/n,集/vg,。/w,代码/n,如下/v,：/w,1/m, ,#, ,提取/v,训练集/nw,的/u,所有/b,词/n, ,2/m, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,3/m, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,4/m, ,for/en, ,document/en, ,in/en, ,dataset/en, ,:/w, ,5/m, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#, ,两个/m,集合/v,的/u,并/c,集/vg, ,6/m, ,return/en, ,list/en,(/w,vocabset/en,)/w,这里/r,利用/v,集合/v,的/u,性质/n,对/p,数据集/nw,提取/v,不同/a,的/u,单词/n,，/w,函数/n, ,createvocablist/en,(/w,)/w, ,返回/v,值/n,是/v,列表/v,类型/n,。/w,4.3/m, ,对/p,词/n,汇集/v,转化/v,成/v,数值/n,类型/n,因为/c,单词/n,的/u,字符/n,串/v,类型/n,无法/v,参与/v,到/v,数值/n,的/u,计算/v,，/w,因此/c,把/p,一个/m,对象/n,的/u,数据/n,由/p,词汇/n,集中/v,的/u,哪些/r,单词/n,组成/v,表示/v,成/v,：/w,0/m, ,该/r,对象/n,没有/v,这个/r,词/n,，/w,1/m, ,该/r,对象/n,有/v,这个/r,词/n,。/w,代码/n,如下/v,：/w,1/m, ,#, ,根据/p,类别/n,对/p,词/n,进行/v,划分/v,数值型/nw,的/u,类别/n, ,2/m, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,3/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,4/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,5/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,6/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,7/m, ,else/en, ,:/w, ,8/m, ,print/en, ,"/w,the/en, ,word/en, ,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,9/m, ,return/en, ,returnvec/en,参数/n, ,vocablist/en, ,是/v,词汇/n,集/vg,，/w,inputset/en, ,是/v,对象/n,的/u,数据/n,，/w,而/c,返回/v,值/n,是/v,由/p,词汇/n,集/vg,的/u,转换/v,成/v, ,0/m, ,和/c, ,1/m, ,组成/v,的/u,对象/n,单词/n,在/p,词汇/n,集/vg,的/u,标记/n,。/w,4.4/m, ,朴素/a,贝叶斯分类器/nw,的/u,训练/vn,函数/n,这里/r,说明/v,一下/m,，/w,训练/vn,样本/n,是/v,postinglist/en, ,列表/v,数据/n,，/w,属性/n,集/vg,是/v,词汇/n,集/vg,，/w,类/q,标号/n,是/v,classvec/en, ,列表/v,数据/n,。/w,在/p,编写/v,代码/n,时/ng,考虑/v,到/v,对象/n,的/u,单词/n,在/p,词汇/n,集中/v,占有率/n,比较/d,低/a,，/w,会/v,造成/v,词/n,汇集/v,转化/v,时/ng,有/v,大量/m,的/u, ,0/m, ,组成/v,，/w,同时/c,又/d,会/v,造成/v,条件/n,概率/n,大量/m,为/p, ,0/m, ,；/w,又/d,有/v,计算/v,真实/a,概率/n,值/n,普遍/ad,偏/d,小/a,，/w,容易/a,造成/v,下/f,溢/v,出/v,。/w,因此/c,，/w,代码/n,对/p,计算/v,条件/n,概率/n,时/ng,进行/v,转换/v,，/w,但/c,不/d,影响/vn,条件/n,概率/n,的/u,大小/n,排序/vn,，/w,也/d,就/d,不/d,会/v,影响/vn,朴素/a,贝叶斯/nr,的/u,使用/v,。/w,代码/n,如下/v,：/w,1/m, ,'/w,'/w,'/w, ,2/m, ,求/v,贝叶斯公式/nw,中/f,的/u,先验/n,概率/n, ,pabusive/en, ,,/w,条件/n,概率/n, ,p/en,0/m,vect/en,、/w,p/en,1/m,vect/en,；/w,函数/n,中/f,所/u,求/v,的/u,概率/n,值/n, ,3/m, ,是/v,变形/v,值/n,，/w,不/d,影响/vn,贝叶斯/nr,的/u,核心/n,思想/n,：/w,选择/v,具有/v,最高/a,概率/n,的/u,决策/n, ,4/m, ,'/w,'/w,'/w, ,5/m, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w, ,traincategory/en,)/w,:/w, ,6/m, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,#, ,样本/n,中/f,对象/n,的/u,个数/n, ,7/m, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,#, ,样本/n,中/f,所有/b,词/n,的/u,集合/v,个数/n, ,8/m, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w, ,//w, ,float/en,(/w,numtraindocs/en,)/w, ,#, ,对/p,类别/n,只/d,有/v,两种/mq,的/u,先验/n,概率/n,计算/v, ,9/m, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,初始/b,化为/v,1/m,，/w,为了/p,防止/v,计算/v,条件/n,概率/n,出现/v,为/p,0/m, ,10/m, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,11/m, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,12/m, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,初始/b,化为/v,2/m,，/w,词/n,的/u,出现/v,数/m,初/f,始数/nw,为/p,1/m,的/u,情况/n,下/f,，/w,增加/v,分/q,母值/nw,避免/v,概率/n,值/n,大于/nrf,1/m, ,13/m, ,p/en,0/m,denom/en, ,=/w, ,2.0/m, ,14/m, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,15/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,#, ,遍历/nw,所有/b,对象/n, ,16/m, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,#, ,类别/n,类型/n,的/u,判断/v, ,17/m, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,计算/v, ,18/m, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,计算/v, ,19/m, ,else/en,:/w, ,20/m, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,计算/v, ,21/m, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,计算/v, ,22/m, ,p/en,1/m,vect/en, ,=/w, ,log/en, ,(/w, ,p/en,1/m,num/en, ,//w, ,p/en,1/m,denom/en,)/w, ,#, ,条件/n,概率/n,,/w,用/p,对数/n,的/u,形式/n,计算/v,是/v,为/p,避免/v,概率/n,值/n,太/d,小/a,造成/v,下/f,溢/v,出/v, ,23/m, ,p/en,0/m,vect/en, ,=/w, ,log/en, ,(/w,p/en,0/m,num/en, ,//w, ,p/en,0/m,denom/en,)/w, ,#, ,条件/n,概率/n,,/w,用/p,对数/n,的/u,形式/n,计算/v,是/v,为/p,避免/v,概率/n,值/n,太/d,小/a,造成/v,下/f,溢/v,出/v, ,24/m, ,return/en, ,p/en,0/m,vect/en,,/w, ,p/en,1/m,vect/en,,/w, ,pabusive/en,4.5/m, ,朴素/a,贝叶斯/nr,的/u,分类/vn,函数/n,根据/p,先验/n,概率/n,和/c,条件/n,概率/n,对/p,不同/a,类别/n,的/u,后验/nw,概率/n,进行/v,计算/v,，/w,并/c,选取/v,后验/nw,概率/n,最/d,大/a,的/u,类别/n,作为/v,朴素/a,贝叶斯/nr,预测/v,结果/n,值/n,。/w,代码/n,如下/v,：/w,1/m, ,#, ,计算/v,后验/nw,概率/n,，/w,并/c,选择/v,最高/a,概率/n,作为/v,预测/v,类别/n, ,2/m, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,3/m, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en, ,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,的/u,每/r,一项/mq,的/u,条件/n,概率/n,相加/v,（/w,对数/n,相加/v,为/p,条件/n,概率/n,的/u,相乘/v,）/w, ,4/m, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en, ,)/w, ,+/w, ,log/en,(/w,1.0/m,-/w,pclass/en,1/m, ,)/w, ,#, ,后面/f,加上/v,的/u,一项/mq,是/v,先验/n,概率/n, ,5/m, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,6/m, ,return/en, ,1/m, ,7/m, ,else/en, ,:/w, ,8/m, ,return/en, ,04.6/m, ,测试/vn,样本/n,的/u,预测/v,通过/p,朴素/a,贝叶斯算法/nw,给/p,出/v,两个/m,未知/vn,类别/n,的/u,对象/n,预测/v,其/r,类别/n,。/w,代码/n,如下/v,：/w,1/m, ,#, ,对/p,侮辱性/n,语言/n,的/u,测试/vn, ,2/m, ,def/en, ,testingnb/en,(/w,)/w,:/w, ,3/m, ,listoposts/en,,/w, ,listclasses/en, ,=/w, ,loaddatalist/en,(/w,)/w, ,#, ,训练/vn,样本/n,的/u,数据/n,，/w,listoposts/en, ,为/p,样本/n,，/w,listclasses/en, ,为/p,样本/n,的/u,类别/n, ,4/m, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en, ,)/w, ,#, ,样本/n,的/u,词汇/n,集/vg, ,5/m, ,trainmat/en, ,=/w, ,[/w,]/w, ,#, ,对/p,样本/n,的/u,所有/b,对象/n,相关/v,的/u,单词/n,转化/v,为/p,数值/n, ,6/m, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en, ,:/w, ,7/m, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,postindoc/en, ,)/w, ,)/w, ,8/m, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pab/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,listclasses/en,)/w,)/w, ,#, ,样本/n,的/u,先验/n,概率/n,和/c,条件/n,概率/n, ,9/m, ,10/m, ,testentry/en, ,=/w, ,[/w,'/w,love/en,'/w,,/w,'/w,my/en,'/w,,/w,'/w,dalmation/en,'/w,,/w,'/w,love/en,'/w,]/w, ,#, ,未知/vn,类别/n,的/u,对象/n, ,11/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,testentry/en, ,)/w, ,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,转化/v,为/p,数值/n, ,12/m, ,print/en, ,testentry/en, ,,/w,'/w,classified/en, ,as/en, ,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,预测/v,其/r,类别/n, ,13/m, ,14/m, ,testentry/en, ,=/w, ,[/w,'/w,stupid/en,'/w,,/w,'/w,garbage/en,'/w,]/w, ,#, ,未知/vn,类别/n,的/u,对象/n, ,15/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,testentry/en, ,)/w,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,转化/v,为/p,数值/n, ,16/m, ,print/en, ,testentry/en,,/w, ,'/w,classified/en, ,as/en, ,:/w, ,'/w,,/w, ,classifynb/en,(/w,thisdoc/en,,/w, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pab/en,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,预测/v,其/r,类别/n,其/r,运行/vn,结果/n,图/n,：/w,对象/n, ,[/w,'/w,love/en,'/w,,/w,'/w,my/en,'/w,,/w,'/w,dalmation/en,'/w,,/w,'/w,love/en,'/w,]/w, ,由/p,直观/a,可知/v,，/w,其/r,类别/n,是非/n,侮辱性/n,词汇/n,，/w,与/p,预测/v,结果/n,（/w,0/m, ,代表/n,正常/a,语言/n,）/w,相同/a,；/w,对象/n, ,[/w,'/w,stupid/en,'/w,,/w,'/w,garbage/en,'/w,]/w, ,类别/n,是/v,侮辱性/n,词汇/n,，/w,与/p,预测/v,结果/n,（/w,1/m, ,代表/n,侮辱性/n,语言/n,）/w,相同/a,，/w,说明/v,朴素/a,贝叶斯算法/nw,对/p,预测/v,类别/n,有效/a,。/w,5/m, ,例子/n,：/w,对/p,垃圾/n,邮件/n,的/u,识别/v,这里/r,给/p,出/v,朴素/a,贝叶斯算法/nw,最/d,经典/n,的/u,应用/vn,实例/n,，/w,对/p,垃圾/n,邮件/n,的/u,过滤/v,识别/v,。/w,由于/c,邮件/n,是/v,以/p,文件/n,的/u,形式/n,保存/v,，/w,因此/c,我们/r,要/v,对/p,邮件/n,的/u,内容/n,进行/v,提取/v,并/c,处理/v,成/v,符合/v,算法/n,可/v,用/p,的/u,类型/n,。/w,5.1/m, ,邮件/n,文件/n,解析/v,利用/v,正/d,则/d,语言/n,对/p,邮件/n,的/u,内容/n,进行/v,单词/n,的/u,划分/v,。/w,代码/n,如下/v,：/w,1/m, ,#, ,邮件/n,文件/n,解析/v, ,2/m, ,def/en, ,textparse/en,(/w,bigstring/en,)/w,:/w, ,3/m, ,import/en, ,re/en, ,4/m, ,listoftokens/en, ,=/w, ,re/en,./w,split/en,(/w,r/en,'/w,\/w,w/en,*/w,'/w,,/w, ,bigstring/en,)/w, ,#, ,利用/v,正/d,则/d,语言/n,对/p,邮件/n,文本/n,进行/v,解析/v, ,5/m, ,return/en, ,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>, ,2/m,]/w, ,#, ,限定/v,单词/n,的/u,字母/n,大于/v,2/m,第/m,5/m, ,行/v,代码/n,解释/v,：/w, ,lower/en,(/w,)/w, ,方法/n,转换/v,字符/n,串/v,中/f,所有/b,大写字符/nw,为/p,小写/n,5.2/m, ,垃圾/n,邮件/n,测试/vn,函数/n,代码/n,如下/v,1/m, ,#, ,完整/a,的/u,垃圾/n,邮件/n,测试/vn,函数/n, ,2/m, ,def/en, ,spamtest/en,(/w,)/w,:/w, ,3/m, ,doclist/en,=/w,[/w,]/w,;/w,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w, ,[/w,]/w, ,4/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1/m,,/w,26/m,)/w,:/w, ,5/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,spam/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w,i/en, ,)/w,./w,read/en,(/w,)/w,)/w, ,6/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,#, ,把/p,解析/v,后/f,的/u,邮件/n,作为/v,训练/vn,样本/n, ,7/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,8/m, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,#, ,邮件/n,所/u,对应/v,的/u,类别/n, ,9/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,ham/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,10/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,#, ,把/p,解析/v,后/f,的/u,邮件/n,作为/v,训练/vn,样本/n, ,11/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en, ,)/w, ,12/m, ,classlist/en, ,./w,append/en,(/w,0/m,)/w, ,#, ,邮件/n,所/u,对应/v,的/u,类别/n, ,13/m, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w, ,#, ,样本/n,生成/vn,的/u,词汇/n,集/vg, ,14/m, ,#, ,随机/d,产生/v,十个/m,测试/vn,样本/n,和/c,四十个/m,训练/vn,样本/n, ,15/m, ,trainingset/en, ,=/w, ,range/en,(/w,50/m,)/w,;/w,testset/en, ,=/w, ,[/w,]/w, ,16/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,17/m, ,randindex/en, ,=/w, ,int/en, ,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en, ,)/w,)/w,)/w, ,18/m, ,testset/en,./w,append/en,(/w,trainingset/en, ,[/w,randindex/en, ,]/w,)/w, ,19/m, ,del/en,[/w,trainingset/en,[/w,randindex/en,]/w,]/w, ,20/m, ,#, ,对/p,训练/vn,样本/n,进行/v,词/n,的/u,转化/v,成/v,数值/n,类型/n, ,21/m, ,trainmat/en, ,=/w, ,[/w,]/w, ,22/m, ,trainclasses/en, ,=/w, ,[/w,]/w, ,23/m, ,for/en, ,docindex/en, ,in/en, ,trainingset/en, ,:/w, ,24/m, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,doclist/en, ,[/w,docindex/en, ,]/w,)/w, ,)/w, ,25/m, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en, ,]/w,)/w, ,26/m, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pspam/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w, ,array/en,(/w,trainclasses/en,)/w,)/w, ,#, ,训练/vn,样本/n,的/u,先验/n,概率/n,及/c,条件/n,概率/n, ,27/m, ,errorcount/en, ,=/w, ,0/m, ,#, ,测试/vn,样本/n,的/u,出错/v,数/m,初始化/v, ,28/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,29/m, ,wordvector/en, ,=/w, ,setofwords/en,2/m,vec/en,(/w,vocablist/en, ,,/w,doclist/en,[/w,docindex/en, ,]/w,)/w, ,#, ,测试/vn,对象/n,的/u,词/n,的/u,数值/n,转化/v, ,30/m, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pspam/en,)/w, ,!/w,=/w, ,classlist/en,[/w,docindex/en, ,]/w,:/w, ,#, ,预测/v,的/u,类别/n,与/p,真实/a,类别/n,的/u,对比/v, ,31/m, ,errorcount/en, ,+/w,=/w, ,1/m, ,32/m, ,print/en, ,'/w,the/en, ,error/en, ,rate/en, ,is/en, ,:/w, ,'/w,,/w, ,float/en, ,(/w,errorcount/en, ,)/w,//w, ,len/en,(/w,testset/en,)/w, ,#, ,测试/vn,样本/n,的/u,出错率/n,第/m,17/m, ,行/v,代码/n,解释/v,：/w,uniform/en,(/w,)/w, ,函数/n,是/v,在/p,random/en,模块/n,里/f,，/w,将/d,随机/d,生成/vn,下/f,一个/m,实数/n,，/w,它/r,在/p, ,[/w,x/en,,/w, ,y/en,)/w, ,范围/n,内/f,。/w,x/en, ,--/nrf, ,随机数/n,的/u,最小值/nz,，/w,包含/v,该值/nw,。/w,y/en, ,--/nrf, ,随机数/n,的/u,最大值/nz,，/w,不/d,包含/v,该值/nw,。/w,返回/v,值/n,是/v,一个/m,浮点数/nz,运行/vn,结果/n,图/n,结果/n,显示/v,测试/vn,集/vg,的/u,出错/v,比例/n,是/v,10%/mq,，/w,由于/c,训练集/nw,是/v,随机/d,组合/v,的/u,，/w,因此/c,每次/r,运行/vn,的/u,结果/n,会/v,有所不同/l,。/w,在/p,《/w,机器/n,学习/v,实战/n,》/w,一/m,书/n,中/f,给/p,出/v,这个/r,算法/n,的/u,错误/n,率/v,在/p,6%/mq,左右/m,，/w,说明/v,朴素/a,贝叶斯算法/nw,在/p,严苛/nz,的/u,条件/n,下/f,也/d,有/v,较/d,好/a,的/u,效果/n,。/w,严苛/nz,条件/n,是/v,指/v,我们/r,对/p,属性/n,都/d,是/v,独立/v,的/u,，/w,这/r,在/p,现实/n,中/f,很/d,难/a,找到/v,符合/v,这样/r,的/u,条件/n,。/w,对/p,垃圾/n,邮件/n,的/u,过滤/v,也/d,是/v,不/d,例外/v,的/u,，/w,如/v,bacon/en,(/w,培根/n,)/w, ,出现/v,在/p,unhealthy/en, ,（/w,不/d,健康/a,的/u,）/w,后面/f,与/p,出现/v,在/p,delicious/en,（/w,美味/n,的/u,）/w,后面/f,的/u,概率/n,是/v,不同/a,的/u,，/w,bacon/en,（/w,培根/n,）/w,常常/d,与/p,delicious/en, ,（/w,美味/n,的/u,）/w,搭配/vn,。/w,附/v, ,完整/a,代码/n,#, ,-/w,*/w,-/w, ,coding/en,:/w,utf/en,-/w,8/m, ,-/w,*/w,-/w, ,from/en, ,numpy/en, ,import/en, ,*/w, ,#, ,文本/n,数据集/nw, ,def/en, ,loaddatalist/en,(/w,)/w,:/w, ,postinglist/en, ,=/w, ,[/w, ,[/w,'/w,my/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,has/en,'/w,,/w,'/w,flea/en,'/w,,/w,'/w,problems/en,'/w,,/w,'/w,help/en,'/w,,/w,'/w,please/en,'/w,]/w,,/w, ,[/w,'/w,maybe/en,'/w,,/w,'/w,not/en,'/w,,/w,'/w,take/en,'/w,,/w,'/w,him/en,'/w,,/w,'/w,to/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,park/en,'/w,,/w,'/w,stupid/en,'/w,]/w,,/w, ,[/w,'/w,my/en,'/w,,/w,'/w,dalmation/en,'/w,,/w,'/w,is/en,'/w,,/w,'/w,so/en,'/w,,/w,'/w,cute/en,'/w,,/w,'/w,i/en,'/w,,/w,'/w,love/en,'/w,,/w,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,stop/en,'/w,,/w,'/w,posting/en,'/w,,/w,'/w,stupid/en,'/w,,/w,'/w,worthless/en,'/w,,/w,'/w,garbage/en,'/w,]/w,,/w, ,[/w,'/w,mr/en,'/w,,/w,'/w,licks/en,'/w,,/w,'/w,ate/en,'/w,,/w,'/w,my/en,'/w,,/w,'/w,steak/en,'/w,,/w,'/w,how/en,'/w,,/w,'/w,to/en,'/w,,/w,'/w,stop/en,'/w,,/w,'/w,him/en,'/w,]/w,,/w, ,[/w,'/w,quit/en,'/w,,/w,'/w,buying/en,'/w,,/w,'/w,worthless/en,'/w,,/w,'/w,dog/en,'/w,,/w,'/w,food/en,'/w,,/w,'/w,stupid/en,'/w,]/w,]/w, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,return/en, ,postinglist/en, ,,/w,classvec/en, ,#, ,提取/v,训练/vn,集中/v,的/u,所有/b,词/n, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, ,for/en, ,document/en, ,in/en, ,dataset/en, ,:/w, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#, ,两个/m,集合/v,的/u,并/c,集/vg, ,return/en, ,list/en,(/w,vocabset/en,)/w, ,#, ,根据/p,类别/n,对/p,词/n,进行/v,划分/v,数值型/nw,的/u,类别/n, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,else/en, ,:/w, ,print/en, ,"/w,the/en, ,word/en, ,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en, ,return/en, ,returnvec/en, ,#, ,文档/n,词/n,袋/q,模型/n,，/w,可以/v,对/p,重复/v,的/u,单词/n,计数/v, ,def/en, ,bagofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,+/w,=/w, ,1/m, ,return/en, ,returnvec/en, ,'/w,'/w,'/w, ,求/v,贝叶斯公式/nw,中/f,的/u,先验/n,概率/n, ,pabusive/en, ,,/w,条件/n,概率/n, ,p/en,0/m,vect/en,、/w,p/en,1/m,vect/en,；/w,函数/n,中/f,所/u,求/v,的/u,概率/n,值/n, ,是/v,变形/v,值/n,，/w,不/d,影响/vn,贝叶斯/nr,的/u,核心/n,思想/n,：/w,选择/v,具有/v,最高/a,概率/n,的/u,决策/n, ,'/w,'/w,'/w, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w, ,traincategory/en,)/w,:/w, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,#, ,样本/n,中/f,对象/n,的/u,个数/n, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,#, ,样本/n,中/f,所有/b,词/n,的/u,集合/v,个数/n, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w, ,//w, ,float/en,(/w,numtraindocs/en,)/w, ,#, ,对/p,类别/n,只/d,有/v,两种/mq,的/u,先验/n,概率/n,计算/v, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,初始/b,化为/v,1/m,，/w,为了/p,防止/v,计算/v,条件/n,概率/n,出现/v,为/p,0/m, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,初始/b,化为/v,2/m,，/w,词/n,的/u,出现/v,数/m,初/f,始数/nw,为/p,1/m,的/u,情况/n,下/f,，/w,增加/v,分/q,母值/nw,避免/v,概率/n,值/n,大于/nrf,1/m, ,p/en,0/m,denom/en, ,=/w, ,2.0/m, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,#, ,遍历/nw,所有/b,对象/n, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,#, ,类别/n,类型/n,的/u,判断/v, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,计算/v, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,计算/v, ,else/en,:/w, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,#, ,对/p,所有/b,词/n,在/p,不同/a,的/u,类别/n,下/f,出现/v,次数/n,的/u,计算/v, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,#, ,对/p,不同/a,类别/n,出现/v,次数/n,的/u,计算/v, ,p/en,1/m,vect/en, ,=/w, ,log/en, ,(/w, ,p/en,1/m,num/en, ,//w, ,p/en,1/m,denom/en,)/w, ,#, ,条件/n,概率/n,,/w,用/p,对数/n,的/u,形式/n,计算/v,是/v,为/p,避免/v,概率/n,值/n,太/d,小/a,造成/v,下/f,溢/v,出/v, ,p/en,0/m,vect/en, ,=/w, ,log/en, ,(/w,p/en,0/m,num/en, ,//w, ,p/en,0/m,denom/en,)/w, ,#, ,条件/n,概率/n,,/w,用/p,对数/n,的/u,形式/n,计算/v,是/v,为/p,避免/v,概率/n,值/n,太/d,小/a,造成/v,下/f,溢/v,出/v, ,return/en, ,p/en,0/m,vect/en,,/w, ,p/en,1/m,vect/en,,/w, ,pabusive/en, ,#, ,计算/v,后验/nw,概率/n,，/w,并/c,选择/v,最高/a,概率/n,作为/v,预测/v,类别/n, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en, ,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,的/u,每/r,一项/mq,的/u,条件/n,概率/n,相加/v,（/w,对数/n,相加/v,为/p,条件/n,概率/n,的/u,相乘/v,）/w, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en, ,)/w, ,+/w, ,log/en,(/w,1.0/m,-/w,pclass/en,1/m, ,)/w, ,#, ,后面/f,加上/v,的/u,一项/mq,是/v,先验/n,概率/n, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,return/en, ,1/m, ,else/en, ,:/w, ,return/en, ,0/m, ,#, ,对/p,侮辱性/n,语言/n,的/u,测试/vn, ,def/en, ,testingnb/en,(/w,)/w,:/w, ,listoposts/en,,/w, ,listclasses/en, ,=/w, ,loaddatalist/en,(/w,)/w, ,#, ,训练/vn,样本/n,的/u,数据/n,，/w,listoposts/en, ,为/p,样本/n,，/w,listclasses/en, ,为/p,样本/n,的/u,类别/n, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en, ,)/w, ,#, ,样本/n,的/u,词汇/n,集/vg, ,trainmat/en, ,=/w, ,[/w,]/w, ,#, ,对/p,样本/n,的/u,所有/b,对象/n,相关/v,的/u,单词/n,转化/v,为/p,数值/n, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en, ,:/w, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,postindoc/en, ,)/w, ,)/w, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pab/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,listclasses/en,)/w,)/w, ,#, ,样本/n,的/u,先验/n,概率/n,和/c,条件/n,概率/n, ,testentry/en, ,=/w, ,[/w,'/w,love/en,'/w,,/w,'/w,my/en,'/w,,/w,'/w,dalmation/en,'/w,,/w,'/w,love/en,'/w,]/w, ,#, ,未知/vn,类别/n,的/u,对象/n, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,testentry/en, ,)/w, ,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,转化/v,为/p,数值/n, ,print/en, ,testentry/en, ,,/w,'/w,classified/en, ,as/en, ,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,预测/v,其/r,类别/n, ,testentry/en, ,=/w, ,[/w,'/w,stupid/en,'/w,,/w,'/w,garbage/en,'/w,]/w, ,#, ,未知/vn,类别/n,的/u,对象/n, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en, ,,/w,testentry/en, ,)/w,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,单词/n,转化/v,为/p,数值/n, ,print/en, ,testentry/en,,/w, ,'/w,classified/en, ,as/en, ,:/w, ,'/w,,/w, ,classifynb/en,(/w,thisdoc/en,,/w, ,p/en,0/m,v/en,,/w, ,p/en,1/m,v/en,,/w, ,pab/en,)/w, ,#, ,对/p,未知/vn,对象/n,的/u,预测/v,其/r,类别/n, ,#, ,邮件/n,文件/n,解析/v, ,def/en, ,textparse/en,(/w,bigstring/en,)/w,:/w, ,import/en, ,re/en, ,listoftokens/en, ,=/w, ,re/en,./w,split/en,(/w,r/en,'/w,\/w,w/en,*/w,'/w,,/w, ,bigstring/en,)/w, ,#, ,利用/v,正/d,则/d,语言/n,对/p,邮件/n,文本/n,进行/v,解析/v, ,return/en, ,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>, ,2/m,]/w, ,#, ,限定/v,单词/n,的/u,字母/n,大于/v,2/m, ,#, ,完整/a,的/u,垃圾/n,邮件/n,测试/vn,函数/n, ,def/en, ,spamtest/en,(/w,)/w,:/w, ,doclist/en,=/w,[/w,]/w,;/w,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1/m,,/w,26/m,)/w,:/w, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,spam/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w,i/en, ,)/w,./w,read/en,(/w,)/w,)/w, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,#, ,把/p,解析/v,后/f,的/u,邮件/n,作为/v,训练/vn,样本/n, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,#, ,邮件/n,所/u,对应/v,的/u,类别/n, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,ham/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,#, ,把/p,解析/v,后/f,的/u,邮件/n,作为/v,训练/vn,样本/n, ,fulltext/en,./w,extend/en,(/w,wordlist/en, ,)/w, ,classlist/en, ,./w,append/en,(/w,0/m,)/w, ,#, ,邮件/n,所/u,对应/v,的/u,类别/n, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w, ,#, ,样本/n,生成/vn,的/u,词汇/n,集/vg, ,#, ,随机/d,产生/v,十个/m,测试/vn,样本/n,和/c,四十个/m,训练/vn,样本/n, ,trainingset/en, ,=/w, ,range/en,(/w,50/m,)/w,;/w,testset/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,randindex/en, ,=/w, ,int/en, ,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en, ,)/w,)/w,)/w, ,testset/en,./w,append/en,(/w,trainingset/en, ,[/w,randindex/en, ,]/w,)/w, ,del/en,[/w,trainingset/en,[/w,randindex/en,]/w,]/w, ,#, ,对/p,训练/vn,样本/n,进行/v,词/n,的/u,转化/v,成/v,数值/n,类型/n, ,trainmat/en, ,=/w, ,[/w,]/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,for/en