一/m,、/w,概述/v,这/r,会/v,是/v,激动人心/l,的/u,一章/mq,，/w,因为/c,我们/r,将/d,首/m,次/q,接触/v,到/v,最/d,优化/v,算法/n,。/w,仔细/ad,想想/v,就/d,会/v,发现/v,，/w,其实/d,我们/r,日常/b,生活/vn,中/f,遇到/v,过/u,很多/m,最/d,优化/v,问题/n,，/w,比如/v,如何/r,在/p,最/d,短/a,时间/n,内/f,从/p,a/en,点/q,到/v,达/v,b/en,点/q,？/w,如何/r,投入/v,最/d,少/a,工作量/n,却/d,获得/v,最/d,大/a,的/u,效益/n,？/w,如何/r,设计/vn,发动机/n,使得/v,油耗/n,最/d,少/a,而/c,功率/n,最/d,大/a,？/w,可见/v,，/w,最/d,优化/v,的/u,作用/n,十分/d,强大/a,。/w,接下来/l,，/w,我们/r,介绍/v,几/m,个/q,最/d,优化/v,算法/n,，/w,并/c,利用/v,它们/r,训练/vn,出/v,一个/m,非线性/b,函数/n,用于/v,分类/vn,。/w,假设/v,现在/t,有/v,一些/m,数据点/nw,，/w,我们/r,用/p,一条/mq,直线/n,对/p,这些/r,点/q,进行/v,拟合/nz,（/w,该线/nz,称为/v,最佳/z,拟合/nz,直线/n,）/w,，/w,这个/r,拟合/nz,过程/n,就/d,称作/v,回归/v,。/w,利用/v,logistic/en,回归/v,进行/v,分类/vn,的/u,主要/b,思想/n,是/v,：/w,根据/p,现有/v,数据/n,对/p,分类/vn,边界线/n,建立/v,回归/v,公式/n,，/w,以此/d,进行/v,分类/vn,。/w,这里/r,的/u,“/w,回归/v,”/w,一/m,词/n,源于/v,最佳/z,拟合/nz,，/w,表示/v,要/v,找到/v,最佳/z,拟合/nz,参数/n,集/vg,，/w,其/r,背后/f,的/u,数学/n,分析/vn,将/d,在/p,下一部分/nw,介绍/v,。/w,训练/vn,分类器/nw,时/ng,的/u,做法/n,就/d,是/v,寻找/v,最佳/z,拟合/nz,参数/n,，/w,使用/v,的/u,是/v,最/d,优化/v,算法/n,。/w,接下来/l,介绍/v,这个/r,二值型/nw,输出/v,分类器/nw,的/u,数学/n,原理/n,。/w,logistic/en,回归/v,的/u,一般/a,过程/n,（/w,1/m,）/w,收集/v,数据/n,：/w,采用/v,任意/d,方法/n,收集/v,数据/n,。/w,（/w,2/m,）/w,准备/v,数据/n,：/w,由于/c,需要/v,进行/v,距离/n,计算/v,，/w,因此/c,要求/v,数据/n,类型/n,为数值型/nw,。/w,另外/c,，/w,结构化/n,数据/n,格式/n,则/d,最佳/z,。/w,（/w,3/m,）/w,分析/vn,数据/n,：/w,采用/v,任意/d,方法/n,对/p,数据/n,进行/v,分析/vn,。/w,（/w,4/m,）/w,训练/vn,算法/n,：/w,大部分/m,时间/n,将/d,用于/v,训练/vn,，/w,训练/vn,的/u,目的/n,是/v,为了/p,找到/v,最佳/z,的/u,分类/vn,回归/v,系数/n,。/w,（/w,5/m,）/w,测试/vn,算法/n,：/w,一旦/d,训练/vn,步骤/n,完成/v,，/w,分类/vn,将/d,会/v,很快/d,。/w,（/w,6/m,）/w,使用/v,算法/n,：/w,首先/d,，/w,我们/r,需要/v,输入/v,一些/m,数据/n,，/w,并/c,将/d,其/r,转换/v,成/v,对应/v,的/u,结构化/n,数值/n,；/w,接着/c,，/w,基于/p,训练/vn,好/a,的/u,回归/v,系数/n,就/d,可以/v,对/p,这些/r,数值/n,进行/v,简单/a,的/u,回归/v,计算/v,，/w,判定/v,它们/r,属于/v,哪个/r,类别/n,；/w,在/p,这/r,之后/f,，/w,我们/r,就/d,可以/v,在/p,输出/v,的/u,类别/n,上/f,做/v,一些/m,其他/r,分析/vn,工作/vn,。/w,二/m,、/w,优/ag,缺点/n,优点/n,：/w,计算/v,代价/n,不/d,高/a,，/w,易于/v,理解/v,和/c,实现/v,。/w,缺点/n,：/w,容易/a,欠/v,拟合/nz,，/w,分类/vn,精度/n,可能/v,不/d,高/a,。/w,适用/v,数据/n,类型/n,：/w,数值/n,型/k,和/c,标称型/nw,数据/n,。/w,三/m,、/w,数学/n,公式/n,我们/r,想/v,要/v,的/u,函数/n,应该/v,是/v,，/w,能/v,接受/v,所有/b,的/u,输入/v,然后/c,预测/v,出/v,类别/n,。/w,例如/v,，/w,在/p,两个类/mq,的/u,情况/n,下/f,，/w,上述/b,函数/n,输出/v,0/m,或/c,1/m,。/w,或许/d,你/r,之前/f,接触/v,过/u,具有/v,这种/r,性质/n,的/u,函数/n,，/w,该/r,函数/n,称为/v,海维塞德/nw,阶跃/nw,函数/n,（/w,heaviside/en, ,step/en, ,function/en,）/w,，/w,或者/c,直接/ad,称为/v,单位/n,阶跃/nw,函数/n,。/w,然而/c,，/w,海维塞德/nw,阶跃/nw,函数/n,的/u,问题/n,在于/v,：/w,该/r,函数/n,在/p,跳跃点/nw,上/f,从/p,0/m,瞬间/t,跳跃/v,到/v,1/m,，/w,这个/r,瞬间/t,跳跃/v,过程/n,有时/d,很/d,难/a,处理/v,。/w,幸好/d,，/w,另/r,一个/m,函数/n,也/d,有/v,类似/v,的/u,性质/n,，/w,且/c,数学/n,上/f,更/d,易/a,处理/v,，/w,这/r,就/d,是/v,sigmoid/en,函数/n,。/w,sigmoid/en,函数/n,具体/a,的/u,计算/v,公式/n,如下/v,：/w,-/w,1/m,给/p,出/v,了/u,sigmoid/en,函数/n,在/p,不同/a,坐标/n,尺度/n,下/f,的/u,两条/mq,曲线图/n,。/w,当/p,x/en,为/p,0时/t,，/w,sigmoid/en,函数/n,值/n,为/p,0.5/m,。/w,随着/p,x/en,的/u,增大/v,，/w,对应/v,的/u,sigmoid/en,值/n,将/d,逼近/v,于/p,1/m,；/w,而/c,随着/p,x/en,的/u,减小/v,，/w,sigmoid/en,值/n,将/d,逼近/v,于/p,0/m,。/w,如果/c,横/v,坐标/n,刻度/n,足够/v,大/a,（/w,-/w,1/m,下图/n,）/w,，/w,sigmoid/en,函数/n,看/v,起来/v,很/d,像/v,一个/m,阶跃/nw,函数/n,。/w,-/w,1/m,　,两种/mq,坐标/n,尺度/n,下/f,的/u,sigmoid/en,函数/n,图/n,。/w,上图/n,的/u,横/v,坐标/n,为/p,-/w,5/m,到/v,5/m,，/w,这时/r,的/u,曲线/n,变化/vn,较为/d,平滑/an,；/w,下/f,图/n,横/v,坐标/n,的/u,尺度/n,足够/v,大/a,，/w,可以/v,看到/v,，/w,在/p,x/en,=/w,0点/mq,处/n,sigmoid/en,函数/n,看/v,起来/v,很/d,像/v,阶跃/nw,函数/n,因此/c,，/w,为了/p,实现/v,logistic/en,回归/v,分类器/nw,，/w,我们/r,可以/v,在/p,每个/r,特征/n,上/f,都/d,乘/v,以/p,一个/m,回归/v,系数/n,，/w,然后/c,把/p,所有/b,的/u,结果/n,值/n,相加/v,，/w,将/d,这个/r,总和/n,代入/n,sigmoid/en,函数/n,中/f,，/w,进而/c,得到/v,一个/m,范围/n,在/p,0/m,~/w,1/m,之间/f,的/u,数值/n,。/w,任何/r,大于/v,0.5/m,的/u,数据/n,被/p,分入/nw,1类/mq,，/w,小于/v,0.5/m,即/v,被/p,归入/v,0类/mq,。/w,所以/c,，/w,logistic/en,回归/v,也/d,可以/v,被/p,看成/v,是/v,一种/mq,概率/n,估计/v,。/w,确定/v,了/u,分类器/nw,的/u,函数/n,形式/n,之后/f,，/w,现在/t,的/u,问题/n,变成/v,了/u,：/w,最佳/z,回归/v,系数/n,是/v,多少/r,？/w,如何/r,确定/v,它们/r,的/u,大小/n,？/w,四/m,、/w,基于/p,最/d,优化/v,方法/n,的/u,最佳/z,回归/v,系数/n,确定/v,sigmoid/en,函数/n,的/u,输入/v,记/v,为/p,z/en,，/w,由/p,下面/f,公式/n,得出/v,：/w, ,其中/r, ,wi/en, ,为/p,最佳/z,拟合/nz,参数/n,，/w,每/r,一/m, ,列/v, ,数据/n,都/d,对应/v,一个/m,w/en,拟合/nz,参数/n,。/w,如果/c,采用/v,向/p,量/n,的/u,写法/n,，/w,上述/b,公式/n,可以/v,写/v,成/v,z/en,=/w,wx/en,，/w,它/r,表示/v,将/d,这/r,两个/m,数值/n,向量/n,对应/v,元素/n,相/d,乘/v,然后/c,全部/m,加/v,起来/v,即/v,得到/v,z/en,值/n,。/w,其中/r,的/u,向量/n,x/en,是/v,分类器/nw,的/u,输入/v,数据/n,，/w,向量/n,w/en,也/d,就是/d,我们/r,要/v,找到/v,的/u,最佳/z,参数/n,（/w,系数/n,）/w,，/w,从而/c,使得/v,分类器/nw,尽可能/d,地/u,精确/a,。/w,为了/p,寻找/v,该/r,最佳/z,参数/n,，/w,需要/v,用/p,到/v,最/d,优化/v,理论/n,的/u,一些/m,知识/n,。/w,下面/f,首先/d,介绍/v,梯度/n,上升/v,的/u,最/d,优化/v,方法/n,，/w,我们/r,将/d,学习/v,到/v,如何/r,使用/v,该/r,方法/n,求得/v,数据集/nw,的/u,最佳/z,参数/n,。/w,接下来/l,，/w,展示/v,如何/r,绘制/v,梯度/n,上升法/nw,产生/v,的/u,决策/n,边界/n,图/n,，/w,该/r,图/n,能/v,将/d,梯度/n,上升法/nw,的/u,分类/vn,效果/n,可视化/nz,地/u,呈现/v,出/v,来/v,。/w,最后/f,我们/r,将/d,学习/v,随机/d,梯度/n,上升/v,算法/n,，/w,以及/c,如何/r,对/p,其/r,进行/v,修改/v,以/p,获得/v,更/d,好/a,的/u,结果/n,。/w,梯度/n,上升法/nw,我们/r,介绍/v,的/u,第一/m,个/q,最/d,优化/v,算法/n,叫做/v,梯度/n,上升法/nw,。/w,梯度/n,上升法/nw,基于/p,的/u,思想/n,是/v,：/w,要/v,找到/v,某/r,函数/n,的/u,最大值/nz,，/w,最/d,好/a,的/u,方法/n,是/v,沿着/p,该/r,函数/n,的/u,梯度/n,方向/n,探寻/v,。/w,如果/c,梯度/n,记/v,为/p,∇,，/w,则/d,函数/n,f/en,(/w,x/en,,/w,y/en,)/w,的/u,梯度/n,由/p,下式/nw,表示/v,：/w,这/r,是/v,机器/n,学习/v,中/f,最/d,易/a,造成/v,混淆/v,的/u,一个/m,地方/n,，/w,但/c,在/p,数学/n,上/f,并/c,不/d,难/a,，/w,需要/v,做/v,的/u,只是/d,牢记/v,这些/r,符号/n,的/u,意义/n,。/w,这个/r,梯度/n,意味/n,着/u,要/v,沿/p,x/en,的/u,方向/n,移动/vn,，/w,沿/p,y/en,的/u,方向/n,移动/vn,。/w,其中/r,，/w,函数/n,f/en,(/w,x/en,,/w,y/en,)/w,必/d,须要/v,在/p,待/v,计算/v,的/u,点/q,上/f,有/v,定义/n,并且/c,可微/nw,。/w,一个/m,具体/a,的/u,函数/n,例子/n,见/v,-/w,2/m,。/w,-/w,2/m,　,梯度/n,上升/v,算法/n,到达/v,每个/r,点/q,后/f,都/d,会/v,重新/d,估计/v,移动/vn,的/u,方向/n,。/w,从/p,p/en,0/m,开始/v,，/w,计算/v,完/v,该/r,点/q,的/u,梯度/n,，/w,函数/n,就/d,根据/p,梯度/n,移动/vn,到/v,下/f,一点/m,p/en,1/m,。/w,在/p,p/en,1点/mq,，/w,梯度/n,再次/d,被/p,重新/d,计算/v,，/w,并/c,沿/p,新/a,的/u,梯度/n,方向/n,移动/vn,到/v,p/en,2/m,。/w,如此/r,循环/vn,迭代/vn,，/w,直到/v,满足/v,停止/v,条件/n,。/w,迭代/vn,的/u,过程/n,中/f,，/w,梯度/n,算子/n,总是/d,保证/v,我们/r,能/v,选取/v,到/v,最佳/z,的/u,移动/vn,方向/n,-/w,2/m,中/f,的/u,梯度/n,上升/v,算法/n,沿/p,梯度/n,方向/n,移动/vn,了/u,一步/mq,。/w,可以/v,看到/v,，/w,梯度/n,算子/n,总是/d,指向/vn,函数/n,值/n,增长/v,最/d,快/a,的/u,方向/n,。/w,这里/r,所/u,说/v,的/u,是/v,移动/vn,方向/n,，/w,而/c,未/d,提到/v,移动量/nw,的/u,大小/n,。/w,该/r,量值/nw,称为/v,步长/nz,，/w,记/v,做/v,α,。/w,用/p,向/p,量/n,来/v,表示/v,的话/u,，/w,梯度/n,上升/v,算法/n,的/u,迭代/vn,公式/n,如下/v,：/w,该/r,公式/n,将/d,一直/d,被/p,迭代/vn,执行/v,，/w,直至/v,达到/v,某个/r,停止/v,条件/n,为止/u,，/w,比如/v,迭代/vn,次数/n,达到/v,某个/r,指定值/nw,或/c,算法/n,达到/v,某个/r,可以/v,允许/v,的/u,误差/n,范围/n,。/w,五/m,、/w,训练/vn,算法/n,：/w,使用/v,梯度/n,上升/v,找到/v,最佳/z,参数/n,-/w,3/m,　,一个/m,简单/a,数据集/nw,，/w,下面/f,将/d,采用/v,梯度/n,上升法/nw,找到/v,logistic/en,回归/v,分类器/nw,在/p,此/r,数据集/nw,上/f,的/u,最佳/z,回归/v,系数/n,-/w,3/m,中/f,有/v,100个/m,样本点/nw,，/w,每个/r,点/q,包含/v,两个/m,数/m,值型/nw,特征/n,：/w,x/en,1/m,和/c,x/en,2/m,。/w,在/p,此/r,数据集/nw,上/f,，/w,我们/r,将/d,通过/p,使用/v,梯度/n,上升法/nw,找到/v,最佳/z,回归/v,系数/n,，/w,也/d,就/d,是/v,拟合/nz,出/v,logistic/en,回归/v,模型/n,的/u,最佳/z,参数/n,。/w,梯度/n,上升法/nw,的/u,伪代码/nw,如下/v,：/w,每个/r,回归/v,系数/n,初始/b,化为/v,1/m,重复/v,r/en,次/q,：/w,计算/v,整个/b,数据集/nw,的/u,梯度/n,使用/v,alpha/en,×/w,gradient/en,更新/v,回归/v,系数/n,的/u,向量/n,返回/v,回归/v,系数/n,程序/n,清单/n,5/m,-/w,1/m, ,logistic/en,回归/v,梯度/n,上升/v,优化/v,算法/n,1/m, ,def/en, ,loaddataset/en,(/w,)/w,:/w,　,　,#,每/r,行/v,前/f,两个/m,值/n,分别/d,是/v,x/en,1/m,和/c,x/en,2/m,，/w,第三/nw,个/q,值/n,是/v,数据/n,对应/v,的/u,类别/n,标签/n,。/w,此外/c,，/w,为了/p,方便/a,计算/v,，/w,该/r,函数/n,还/d,将/d,x/en,0/m,的/u,值设/nw,为/p,1.0/m, ,2/m, ,datamat/en, ,=/w, ,[/w,]/w,;/w, ,labelmat/en, ,=/w, ,[/w,]/w, ,3/m, ,fr/en, ,=/w, ,open/en,(/w,'/w,testset/en,./w,txt/en,'/w,)/w, ,4/m, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,5/m, ,linearr/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,6/m, ,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w, ,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w, ,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,7/m, ,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,8/m, ,return/en, ,datamat/en,,/w,labelmat/en, ,#, ,分类/vn,用/p, ,1/m, ,，/w,0/m, ,表示/v, ,9/m, ,10/m, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,11/m, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w, ,12/m, ,13/m, ,def/en, ,gradascent/en,(/w,datamatin/en,,/w, ,classlabels/en,)/w,:/w,　,　,#, ,梯度/n,上升/v,算法/n, ,变量/n,alpha/en,是/v,向/p,目标/n,移动/vn,的/u,步长/nz,，/w,maxcycles/en,是/v,迭代/vn,次数/n,。/w, ,14/m, ,datamatrix/en, ,=/w, ,mat/en,(/w,datamatin/en,)/w, ,#, ,数据集/nw,转/v, ,矩阵/n, ,15/m, ,labelmat/en, ,=/w, ,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w, ,#, ,分类/vn,向/p,量/n, ,转/v,置/v, ,16/m, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,17/m, ,alpha/en, ,=/w, ,0.001/m, ,18/m, ,maxcycles/en, ,=/w, ,500/m, ,19/m, ,weights/en, ,=/w, ,ones/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w,　,　,#,weights/en, ,与/p,列/v,的/u,数量/n,相同/a, ,20/m, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxcycles/en,)/w,:/w, ,#,heavy/en, ,on/en, ,matrix/en, ,operations/en, ,21/m, ,h/en, ,=/w, ,sigmoid/en,(/w,datamatrix/en,*/w,weights/en,)/w, ,#, ,把/p, ,z/en, ,代/q,入/v,到/v, ,sigmoid/en, ,函数/n,当中/f, ,22/m, ,error/en, ,=/w, ,(/w,labelmat/en, ,-/w, ,h/en,)/w, ,#,向量/n,的/u,减法/n, ,23/m, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,datamatrix/en,./w,transpose/en,(/w,)/w,*/w, ,error/en, ,#, ,数学/n,公式/n, ,alpha/en,=/w,移动/vn,步长/nz, ,24/m, ,return/en, ,weights/en,接/v,下来/v,看看/v,实际/n,效果/n,，/w,在/p,python/en,提示符/n,下/f,，/w,敲/v,入/v,下面/f,的/u,代码/n,：/w,1/m, ,>,>,>, ,import/en, ,logregres/en, ,2/m, ,>,>,>, ,dataarr/en,,/w,labelmat/en,=/w,logregres/en,./w,loaddataset/en,(/w,)/w, ,3/m, ,>,>,>, ,logregres/en,./w,gradascent/en,(/w,dataarr/en,,/w,labelmat/en,)/w, ,4/m, ,　,　, ,matrix/en,(/w,[/w,[/w,4.12414349/m,]/w,,/w, ,[/w,0.48007329/m,]/w,,/w, ,[/w,-/w,0.6168482/m,]/w,]/w,)/w,求/v,出/v,了/u,数据集/nw,每/r,一列/mq,的/u,最佳/z,拟合/nz,参数/n,据/p, ,w/en, ,的/u,值/n,。/w,六/m,、/w,分析/vn,数据/n,：/w,画/v,出/v,决策/n,边界/n,上面/f,已经/d,解出/nw,了/u,一组/mq,回归/v,系数/n,，/w,它/r,确定/v,了/u,不同/a,类别/n,数据/n,之间/f,的/u,分隔线/nw,。/w,那么/r,怎样/r,画/v,出/v,该/r,分隔线/nw,，/w,从而/c,使得/v,优化/v,的/u,过程/n,便于/v,理解/v,呢/y,？/w,下面/f,将/d,解决/v,这个/r,问题/n,，/w,打开/v,logregres/en,./w,py/en,并/c,添加/vn,如下/v,代码/n,。/w,画/v,出/v,数据集/nw,和/c,logistic/en,回归/v,最佳/z,拟合/nz,直线/n,的/u,函数/n,1/m, ,def/en, ,plotbestfit/en,(/w,weights/en,)/w,:/w, ,2/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,3/m, ,datamat/en,,/w,labelmat/en,=/w,loaddataset/en,(/w,)/w, ,4/m, ,dataarr/en, ,=/w, ,array/en,(/w,datamat/en,)/w, ,5/m, ,n/en, ,=/w, ,shape/en,(/w,dataarr/en,)/w,[/w,0/m,]/w, ,6/m, ,xcord/en,1/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,1/m, ,=/w, ,[/w,]/w, ,7/m, ,xcord/en,2/m, ,=/w, ,[/w,]/w,;/w, ,ycord/en,2/m, ,=/w, ,[/w,]/w, ,8/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,9/m, ,if/en, ,int/en,(/w,labelmat/en,[/w,i/en,]/w,)/w,=/w,=/w, ,1/m,:/w, ,10/m, ,xcord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,1/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,11/m, ,else/en,:/w, ,12/m, ,xcord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,1/m,]/w,)/w,;/w, ,ycord/en,2/m,./w,append/en,(/w,dataarr/en,[/w,i/en,,/w,2/m,]/w,)/w, ,13/m, ,fig/en, ,=/w, ,plt/en,./w,figure/en,(/w,)/w, ,14/m, ,ax/en, ,=/w, ,fig/en,./w,add/en,_,subplot/en,(/w,111/m,)/w, ,15/m, ,ax/en,./w,scatter/en,(/w,xcord/en,1/m,,/w, ,ycord/en,1/m,,/w, ,s/en,=/w,30/m,,/w, ,c/en,=/w,'/w,red/en,'/w,,/w, ,marker/en,=/w,'/w,s/en,'/w,)/w, ,16/m, ,ax/en,./w,scatter/en,(/w,xcord/en,2/m,,/w, ,ycord/en,2/m,,/w, ,s/en,=/w,30/m,,/w, ,c/en,=/w,'/w,green/en,'/w,)/w, ,17/m, ,x/en, ,=/w, ,arange/en,(/w,-/w,3.0/m,,/w, ,3.0/m,,/w, ,0.1/m,)/w, ,18/m, ,y/en, ,=/w, ,(/w,-/w,weights/en,[/w,0/m,]/w,-/w,weights/en,[/w,1/m,]/w,*/w,x/en,)/w,//w,weights/en,[/w,2/m,]/w, ,#,①, ,最佳/z,拟合/nz,直线/n, ,19/m, ,ax/en,./w,plot/en,(/w,x/en,,/w, ,y/en,)/w, ,20/m, ,plt/en,./w,xlabel/en,(/w,'/w,x/en,1/m,'/w,)/w,;/w, ,plt/en,./w,ylabel/en,(/w,'/w,x/en,2/m,'/w,)/w,;/w, ,21/m, ,plt/en,./w,show/en,(/w,)/w,程序/n,清单/n,5/m,-/w,2/m,中/f,的/u,代码/n,是/v,直接/ad,用/p,matplotlib/en,画/v,出来/v,的/u,。/w,唯一/b,要/v,指出/v,的/u,是/v,，/w,①,处/n,设置/v,了/u,sigmoid/en,函数/n,为/p,0/m,。/w,回忆/v,5.2节/mq,，/w,0/m,是/v,两个/m,分类/vn,（/w,类别/n,1/m,和/c,类别/n,0/m,）/w,的/u,分界处/nw,。/w,因此/c,，/w,我们/r,设定/v,0/m,=/w,w/en,0/m,x/en,0/m,+/w,w/en,1/m,x/en,1/m,+/w,w/en,2/m,x/en,2/m,，/w,然后/c,解出/nw,x/en,2/m,和/c,x/en,1/m,的/u,关系式/n,（/w,即/v,分隔线/nw,的/u,方程/n,，/w,注意/v,x/en,0/m,＝/w,1/m,）/w,。/w,运行/vn,程序/n,清单/n,5/m,-/w,2/m,的/u,代码/n,，/w,在/p,python/en,提示符/n,下/f,输入/v,：/w,1/m, ,>,>,>, ,from/en, ,numpy/en, ,import/en,*/w, ,2/m, ,>,>,>, ,reload/en,(/w,logregres/en,)/w, ,3/m, ,</w,module/en,'/w,logregres/en,'/w,from/en,'/w,logregres/en,./w,py/en,'/w,>, ,4/m, ,>,>,>, ,logregres/en,./w,plotbestfit/en,(/w,weights/en,./w,geta/en,(/w,)/w,)/w,梯度/n,上升/v,算法/n,在/p,500次/mq,迭代/vn,后/f,得到/v,的/u,logistic/en,回归/v,最佳/z,拟合/nz,直线/n,这个/r,分类/vn,结果/n,相当/d,不错/a,，/w,从/p,图/n,上/f,看/v,只/d,错分/nw,了/u,两/m,到/v,四个点/mq,。/w,但是/c,，/w,尽管/c,例子/n,简单/a,且/c,数据集/nw,很小/a,，/w,这个/r,方法/n,却/d,需要/v,大量/m,的/u,计算/v,（/w,300次/mq,乘法/n,）/w,。/w,因此/c,下/f,一节/mq,将/d,对/p,该/r,算法/n,稍/d,作/v,改进/v,，/w,从而/c,使/v,它/r,可以/v,用/p,在/p,真实/a,数据集/nw,上/f,。/w,七/m,、/w,训练/vn,算法/n,：/w,随机/d,梯度/n,上升/v,梯度/n,上升/v,算法/n,在/p,每次/r,更新/v,回归/v,系数/n,时/ng,都/d,需要/v,遍历/nw,整个/b,数据集/nw,，/w,该/r,方法/n,在/p,处理/v,100个/m,左右/m,的/u,数据集/nw,时尚/n,可/v,，/w,但/c,如果/c,有/v,数十亿/nw,样本/n,和/c,成千上万/i,的/u,特征/n,，/w,那么/r,该/r,方法/n,的/u,计算/v,复杂/a,度/q,就/d,太/d,高/a,了/u,。/w,一种/mq,改进/v,方法/n,是/v,一次/mq,仅/d,用/p,一个/m,样本点/nw,来/v,更新/v,回归/v,系数/n,，/w,该/r,方法/n,称为/v,随机/d,梯度/n,上升/v,算法/n,。/w,由于/c,可以/v,在/p,新/a,样本/n,到来/vn,时/ng,对/p,分类器/nw,进行/v,增量/n,式/k,更新/v,，/w,因而/c,随机/d,梯度/n,上升/v,算法/n,是/v,一个/m,在线/vn,学习/v,算法/n,。/w,与/p,“/w,在线/vn,学习/v,”/w,相/d,对应/v,，/w,一次/mq,处理/v,所有/b,数据/n,被/p,称作/v,是/v,“/w,批处理/v,”/w,。/w,随机/d,梯度/n,上升/v,算法/n,可以/v,写/v,成/v,如下/v,的/u,伪代码/nw,：/w,所有/b,回归/v,系数/n,初始/b,化为/v,1对/mq,数据/n,集中/v,每个/r,样本/n,计算/v,该/r,样本/n,的/u,梯度/n,使用/v,alpha/en,×/w,gradient/en,更新/v,回归/v,系数/n,值/n,返回/v,回归/v,系数/n,值/n,程序/n,清单/n,5/m,-/w,3/m, ,随机/d,梯度/n,上升/v,算法/n,1/m, ,def/en, ,stocgradascent/en,0/m,(/w,datamatrix/en,,/w, ,classlabels/en,)/w,:/w, ,2/m, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,3/m, ,alpha/en, ,=/w, ,0.01/m, ,4/m, ,weights/en, ,=/w, ,ones/en,(/w,n/en,)/w, ,#,初始化/v, ,所有数/nw,为/p,1/m,的/u,向量/n, ,5/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,6/m, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamatrix/en,[/w,i/en,]/w,*/w,weights/en,)/w,)/w, ,#, ,两/m,向/p,理相/nw,乘/v, ,h/en, ,=/w, ,一个/m,数值/n, ,7/m, ,error/en, ,=/w, ,classlabels/en,[/w,i/en,]/w, ,-/w, ,h/en,　,　,#,error/en, ,这/r,一个/m,数值/n, ,8/m, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,error/en, ,*/w, ,datamatrix/en,[/w,i/en,]/w, ,9/m, ,return/en, ,weights/en,可以/v,看到/v,，/w,随机/d,梯度/n,上升/v,算法/n,与/p,梯度/n,上升/v,算法/n,在/p,代码/n,上/f,很/d,相似/a,，/w,但/c,也/d,有/v,一些/m,区别/n,：/w,第一/m,，/w,后者/r,的/u,变量/n,h/en,和/c,误差/n,error/en,都/d,是/v,向量/n,，/w,而/c,前者/r,则/d,全/a,是/v,数值/n,；/w,第二/m,，/w,前者/r,没有/v,矩阵/n,的/u,转换/v,过程/n,，/w,所有/b,变量/n,的/u,数据/n,类型/n,都/d,是/v,numpy/en,数组/n,。/w,测试/vn,代码/n,：/w,1/m, ,>,>,>, ,dataarr/en,,/w,labelmat/en,=/w,logregres/en,./w,loaddataset/en,(/w,)/w, ,2/m, ,>,>,>, ,weights/en,=/w,logregres/en,./w,stocgradascent/en,0/m,(/w,array/en,(/w,dataarr/en,)/w,,/w,labelmat/en,)/w, ,3/m, ,>,>,>, ,weights/en, ,4/m, ,array/en,(/w,[/w, ,1.01702007/m,,/w, ,0.85914348/m,,/w, ,-/w,0.36579921/m,]/w,)/w,5/m, ,>,>,>,logregres/en,./w,plotbestfit/en,(/w,weights/en,)/w,执行/v,完毕/v,后/f,将/d,得到/v,-/w,5所/mq,示/vg,的/u,最佳/z,拟合/nz,直线图/nw,，/w,该/r,图/n,与/p,-/w,4/m,有/v,一些/m,相似/a,之/u,处/n,。/w,可以/v,看到/v,，/w,拟合/nz,出来/v,的/u,直线/n,效果/n,还/d,不错/a,，/w,但/c,并/c,不/d,像/v,-/w,4/m,那样/r,完美/a,。/w,这里/r,的/u,分类器/nw,错分/nw,了/u,三分之一/nw,的/u,样本/n,。/w,-/w,5/m,　,随机/d,梯度/n,上升/v,算法/n,在/p,上述/b,数据集/nw,上/f,的/u,执行/v,结果/n,，/w,最佳/z,拟合/nz,直线/n,并非/v,最佳/z,分类线/nw,直接/ad,比较/d,程序/n,清单/n,5/m,-/w,3/m,和/c,程序/n,清单/n,5/m,-/w,1/m,的/u,代码/n,结果/n,是/v,不/d,公平/a,的/u,，/w,后者/r,的/u,结果/n,是/v,在/p,整个/b,数据集/nw,上/f,迭代/vn,了/u,500次/mq,才/d,得到/v,的/u,。/w,一个/m,判断/v,优化/v,算法/n,优劣/n,的/u,可靠/a,方法/n,是/v,看/v,它/r,是否/v,收敛/vn,，/w,也就是说/l,参数/n,是否/v,达到/v,了/u,稳定/a,值/n,，/w,是否/v,还/d,会/v,不断/d,地/u,变化/vn,？/w,对此/d,，/w,我们/r,在/p,程序/n,清单/n,5/m,-/w,3/m,中/f,随机/d,梯度/n,上升/v,算法/n,上/f,做/v,了/u,些/q,修改/v,，/w,使/v,其/r,在/p,整个/b,数据集/nw,上/f,运行/vn,200次/mq,。/w,最终/d,绘制/v,的/u,三个/m,回归/v,系数/n,的/u,变化/vn,情况/n,如/v,-/w,6/m,所示/nz,。/w,-/w,6/m,　,运行/vn,随机/d,梯度/n,上升/v,算法/n,，/w,在/p,数据集/nw,的/u,一次/mq,遍历/nw,中/f,回归/v,系数/n,与/p,迭代/vn,次数/n,的/u,关系/n,图/n,。/w,回归/v,系数/n,经过/p,大量/m,迭代/vn,才/d,能/v,达到/v,稳定/a,值/n,，/w,并且/c,仍然/d,有/v,局部/n,的/u,波动/vn,现象/n,-/w,6/m,展示/v,了/u,随机/d,梯度/n,上升/v,算法/n,在/p,200次/mq,迭代/vn,过程/n,中/f,回归/v,系数/n,的/u,变化/vn,情况/n,。/w,其中/r,的/u,系数/n,2/m,，/w,也/d,就/d,是/v,-/w,5/m,中/f,的/u,x/en,2只/mq,经过/p,了/u,50次/mq,迭代/vn,就/d,达到/v,了/u,稳定/a,值/n,，/w,但/c,系数/n,1/m,和/c,0则/mq,需要/v,更/d,多次/nrf,的/u,迭代/vn,。/w,另外/c,值得/v,注意/v,的/u,是/v,，/w,在/p,大/a,的/u,波动/vn,停止/v,后/f,，/w,还有/v,一些/m,小/a,的/u,周期性/n,波动/vn,。/w,不难/d,理解/v,，/w,产生/v,这种/r,现象/n,的/u,原因/n,是/v,存在/v,一些/m,不能/v,正确/a,分类/vn,的/u,样本点/nw,（/w,数据集/nw,并非线性/nw,可分/v,）/w,，/w,在/p,每次/r,迭代/vn,时/ng,会/v,引发/v,系数/n,的/u,剧烈/a,改变/v,。/w,我们/r,期望/v,算法/n,能/v,避免/v,来回/v,波动/vn,，/w,从而/c,收敛/vn,到/v,某个/r,值/n,。/w,另外/c,，/w,收敛/vn,速度/n,也/d,需要/v,加快/v,。/w,对于/p,-/w,6/m,存在/v,的/u,问题/n,，/w,可以/v,通过/p,修改/v,程序/n,清单/n,5/m,-/w,3/m,的/u,随机/d,梯度/n,上升/v,算法/n,来/v,解决/v,，/w,具体/a,代码/n,如下/v,。/w,程序/n,清单/n,5/m,-/w,4/m,　,改进/v,的/u,随机/d,梯度/n,上升/v,算法/n,1/m, ,def/en, ,stocgradascent/en,1/m,(/w,datamatrix/en,,/w, ,classlabels/en,,/w, ,numiter/en,=/w,150/m,)/w,:/w, ,2/m, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,3/m, ,weights/en, ,=/w, ,ones/en,(/w,n/en,)/w, ,#,initialize/en, ,to/en, ,all/en, ,ones/en, ,4/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,numiter/en,)/w,:/w, ,5/m, ,dataindex/en, ,=/w, ,range/en,(/w,m/en,)/w, ,6/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,7/m, ,alpha/en, ,=/w, ,4/m,//w,(/w,1.0/m,+/w,j/en,+/w,i/en,)/w,+/w,0.0001/m, ,#,apha/en, ,decreases/en, ,with/en, ,iteration/en,,/w, ,does/en, ,not/en, , ,//w,//w, ,①,alpha/en,每次/r,迭代/vn,时/ng,需要/v,调整/vn, ,8/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,dataindex/en,)/w,)/w,)/w,#,go/en, ,to/en, ,0/m, ,because/en, ,of/en, ,the/en, ,constant/en,//w,//w, ,②, , ,随机/d,选取/v,更新/v, ,9/m, ,h/en, ,=/w, ,sigmoid/en,(/w,sum/en,(/w,datamatrix/en,[/w,randindex/en,]/w,*/w,weights/en,)/w,)/w, ,10/m, ,error/en, ,=/w, ,classlabels/en,[/w,randindex/en,]/w, ,-/w, ,h/en, ,11/m, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,error/en, ,*/w, ,datamatrix/en,[/w,randindex/en,]/w, ,12/m, ,del/en,(/w,dataindex/en,[/w,randindex/en,]/w,)/w, ,13/m, ,return/en, ,weights/en,程序/n,清单/n,5/m,-/w,4/m,与/p,程序/n,清单/n,5/m,-/w,3/m,类似/v,，/w,但/c,增加/v,了/u,两处/mq,代码/n,来/v,进行/v,改进/v,。/w,第一/m,处/n,改进/v,在/p,①,处/n,。/w,一方面/c,，/w,alpha/en,在/p,每次/r,迭代/vn,的/u,时候/n,都/d,会/v,调整/vn,，/w,这/r,会/v,缓解/v,-/w,6/m,上/f,的/u,数据/n,波动/vn,或者/c,高频/b,波动/vn,。/w,另外/c,，/w,虽然/c,alpha/en,会/v,随着/p,迭代/vn,次数/n,不断/d,减小/v,，/w,但/c,永远/d,不/d,会/v,减/v,小/a,到/v,0/m,，/w,这/r,是/v,因为/c,①,中/f,还/d,存在/v,一个/m,常数/n,项/q,。/w,必须/d,这样/r,做/v,的/u,原因/n,是/v,为了/p,保证/v,在/p,多次/m,迭代/vn,之后/f,新/a,数据/n,仍然/d,具有/v,一定/d,的/u,影响/vn,。/w,如果/c,要/v,处理/v,的/u,问题/n,是/v,动态/n,变化/vn,的/u,，/w,那么/r,可以/v,适当/a,加大/v,上述/b,常数/n,项/q,，/w,来/v,确保/v,新/a,的/u,值/n,获得/v,更/d,大/a,的/u,回归/v,系数/n,。/w,另/r,一点/m,值得/v,注意/v,的/u,是/v,，/w,在/p,降低/v,alpha/en,的/u,函数/n,中/f,，/w,alpha/en,每次/r,减少/v,1/m,//w,(/w,j/en,+/w,i/en,)/w,，/w,其中/r,j/en,是/v,迭代/vn,次数/n,，/w,i/en,是/v,样本点/nw,的/u,下标/n,。/w,这样/r,当/p,j/en,</w,</w,max/en,(/w,i/en,)/w,时/ng,，/w,alpha/en,就/d,不/d,是/v,严格/ad,下降/v,的/u,。/w,避免/v,参数/n,的/u,严格/ad,下降/v,也/d,常/d,见于/v,模拟/b,退火算法/nw,等/u,其他/r,优化/v,算法/n,中/f,。/w,程序/n,清单/n,5/m,-/w,4/m,第二/m,个/q,改进/v,的/u,地方/n,在/p,②,处/n,，/w,这里/r,通过/p,随机/d,选取/v,样/q,本来/d,更新/v,回归/v,系数/n,。/w,这种/r,方法/n,将/d,减少/v,周期性/n,的/u,波动/vn,（/w,如/v,-/w,6/m,中/f,的/u,波动/vn,）/w,。/w,具体/a,实现/v,方法/n,与/p,第/m,3章/mq,类似/v,，/w,这种/r,方法/n,每次/r,随机/d,从/p,列表/v,中/f,选出/v,一个/m,值/n,，/w,然后/c,从/p,列表/v,中/f,删掉/v,该值/nw,（/w,再/d,进行/v,下/f,一次/mq,迭代/vn,）/w,。/w,此外/c,，/w,改进/v,算法/n,还/d,增加/v,了/u,一个/m,迭代/vn,次数/n,作为/v,第/m,3个/m,参数/n,。/w,如果/c,该/r,参数/n,没有/v,给/p,定/v,的话/u,，/w,算法/n,将/d,默认/v,迭代/vn,150次/mq,。/w,如果/c,给/p,定/v,，/w,那么/r,算法/n,将/d,按照/p,新/a,的/u,参数/n,值/n,进行/v,迭代/vn,。/w,与/p,stocgradascent/en,1/m,(/w,)/w,类似/v,，/w,-/w,7/m,显示/v,了/u,每次/r,迭代/vn,时/ng,各个/r,回归/v,系数/n,的/u,变化/vn,情况/n,。/w,-/w,7/m,　,使用/v,样本/n,随机/d,选择/v,和/c,alpha/en,动态/n,减少/v,机制/n,的/u,随机/d,梯度/n,上升/v,算法/n,stocgradascent/en,1/m,(/w,)/w,所/u,生成/vn,的/u,系数/n,收敛/vn,示意图/n,。/w,该/r,方法/n,比/p,采用/v,固定/a,alpha/en,的/u,方法/n,收敛/vn,速度/n,更/d,快/a,比较/d,-/w,7/m,和/c,-/w,6/m,可以/v,看到/v,两点/mq,不同/a,。/w,第一/m,点/q,是/v,，/w,-/w,7/m,中/f,的/u,系数/n,没有/v,像/v,-/w,6里/mq,那样/r,出现/v,周期性/n,的/u,波动/vn,，/w,这/r,归功/v,于/p,stocgradascent/en,1/m,(/w,)/w,里/f,的/u,样本/n,随机/d,选择/v,机制/n,；/w,第二/m,点/q,是/v,，/w,-/w,7/m,的/u,水平/n,轴/q,比-/nrf,6/m,短/a,了/u,很多/m,，/w,这/r,是/v,由于/c,stocgradascent/en,1/m,(/w,)/w,可以/v,收敛/vn,得/u,更/d,快/a,。/w,这次/r,我们/r,仅仅/d,对/p,数据集/nw,做/v,了/u,20次/mq,遍历/nw,，/w,而/c,之前/f,的/u,方法/n,是/v,500次/mq,。/w,下面/f,看看/v,在/p,同一/b,个/q,数据集/nw,上/f,的/u,分类/vn,效果/n,1/m, ,>,>,>, ,weights/en,=/w,logregres/en,./w,stocgradascent/en,1/m,(/w,array/en,(/w,dataarr/en,)/w,,/w,labelmat/en,)/w, ,2/m, ,>,>,>, ,weights/en, ,3/m, ,array/en,(/w,[/w, ,14.38360334/m,,/w, ,0.9962485/m, ,,/w, ,-/w,1.96508465/m,]/w,)/w, ,4/m, ,>,>,>, ,logregres/en,./w,plotbestfit/en,(/w,weights/en,)/w,-/w,8/m,　,使用/v,改进/v,的/u,随机/d,梯度/n,上升/v,算法/n,得到/v,的/u,系数/n,程序/n,运行/vn,之后/f,应该/v,能/v,看到/v,类似/v,-/w,8/m,的/u,结果/n,图/n,。/w,该/r,分隔线/nw,达到/v,了/u,与/p,gradientascent/en,(/w,)/w,差不多/l,的/u,效果/n,，/w,但是/c,所/u,使用/v,的/u,计算量/nw,更少/d,。/w,八/m,、/w,示例/n,：/w,从/p,疝气/n,病症/n,预测/v,病马/nw,的/u,死亡率/n,本节/t,将/d,使用/v,logistic/en,回归/v,来/v,预测/v,患有/v,疝病/nw,的/u,马/n,的/u,存活/vn,问题/n,。/w,这里/r,的/u,数据/n,包含/v,368个/m,样本/n,和/c,28个/m,特征/n,。/w,我/r,并非/v,育马/nw,专家/n,，/w,从/p,一些/m,文献/n,中/f,了解/v,到/v,，/w,疝病/nw,是/v,描述/v,马胃肠痛/nw,的/u,术语/n,。/w,然而/c,，/w,这种/r,病/n,不/d,一定/d,源自/v,马/n,的/u,胃肠/n,问题/n,，/w,其他/r,问题/n,也/d,可能/v,引发/v,马疝病/nw,。/w,该/r,数据/n,集中/v,包含/v,了/u,医院/n,检测/vn,马疝病/nw,的/u,一些/m,指标/n,，/w,有的/r,指标/n,比较/d,主观/n,，/w,有的/r,指标/n,难以/d,测量/vn,，/w,例如/v,马/n,的/u,疼痛/an,级别/n,。/w,示例/n,：/w,使用/v,logistic/en,回归/v,估计/v,马疝病/nw,的/u,死亡率/n,（/w,1/m,）/w,收集/v,数据/n,：/w,给/p,定/v,数据/n,文件/n,。/w,（/w,2/m,）/w,准备/v,数据/n,：/w,用/p,python/en,解析/v,文本/n,文件/n,并/c,填充/v,缺/v,失值/nw,。/w,（/w,3/m,）/w,分析/vn,数据/n,：/w,可视化/nz,并/c,观察/v,数据/n,。/w,（/w,4/m,）/w,训练/vn,算法/n,：/w,使用/v,优化/v,算法/n,，/w,找到/v,最佳/z,的/u,系数/n,。/w,（/w,5/m,）/w,测试/vn,算法/n,：/w,为了/p,量化/v,回归/v,的/u,效果/n,，/w,需要/v,观察/v,错误率/n,。/w,根据/p,错误/n,率/v,决定/v,是否/v,回退/nw,到/v,训练/vn,阶段/n,，/w,通过/p,改变/v,迭代/vn,的/u,次数/n,和/c,步长/nz,等/u,参数/n,来/v,得到/v,更/d,好/a,的/u,回归/v,系数/n,。/w,（/w,6/m,）/w,使用/v,算法/n,：/w,实现/v,一个/m,简单/a,的/u,命令/n,行/v,程序/n,来/v,收集/v,马/n,的/u,症状/n,并/c,输出/v,预测/v,结果/n,并非/v,难事/n,，/w,这/r,可以/v,做/v,为/p,留给/v,读者/n,的/u,一道/mq,习题/n,。/w,另外/c,需要/v,说明/v,的/u,是/v,，/w,除了/p,部分/n,指标/n,主观/n,和/c,难以/d,测量/vn,外/f,，/w,该/r,数据/n,还/d,存在/v,一个/m,问题/n,，/w,数据/n,集中/v,有/v,30%/mq,的/u,值/n,是/v,缺失/n,的/u,。/w,下面/f,将/d,首先/d,介绍/v,如何/r,处理/v,数据/n,集中/v,的/u,数据/n,缺失/n,问题/n,，/w,然后/c,再/d,利用/v,logistic/en,回归/v,和/c,随机/d,梯度/n,上升/v,算法/n,来/v,预测/v,病马/nw,的/u,生死/n,。/w,1/m,、/w,准备/v,数据/n,：/w,处理/v,数据/n,中/f,的/u,缺失/n,值/n,数据/n,中/f,的/u,缺失/n,值/n,是/v,个/q,非常/d,棘手/a,的/u,问题/n,，/w,有/v,很多/m,文献/n,都/d,致力/v,于/p,解决/v,这个/r,问题/n,。/w,那么/r,，/w,数据/n,缺失/n,究竟/d,带来/v,了/u,什么/r,问题/n,？/w,假设/v,有/v,100个/m,样本/n,和/c,20个/m,特征/n,，/w,这些/r,数据/n,都/d,是/v,机器/n,收集/v,回来/v,的/u,。/w,若/c,机器/n,上/f,的/u,某个/r,传感器/n,损坏/v,导致/v,一个/m,特征/n,无效/v,时/ng,该/r,怎么办/v,？/w,此时/r,是否/v,要/v,扔掉/v,整个/b,数据/n,？/w,这种/r,情况/n,下/f,，/w,另外/c,19个/m,特征/n,怎么办/v,？/w,它们/r,是否/v,还/d,可/v,用/p,？/w,答案/n,是/v,肯定/v,的/u,。/w,因为/c,有时候/d,数据/n,相当/d,昂贵/a,，/w,扔掉/v,和/c,重新/d,获取/v,都/d,是/v,不/d,可取/a,的/u,，/w,所以/c,必须/d,采用/v,一些/m,方法/n,来/v,解决/v,这个/r,问题/n,。/w,下面/f,给/p,出/v,了/u,一些/m,可/v,选/v,的/u,做法/n,：/w,•/w,使用/v,可/v,用/p,特征/n,的/u,均值/n,来/v,填补/v,缺/v,失值/nw,；/w,•/w,使用/v,特殊/a,值/n,来/v,填补/v,缺/v,失值/nw,，/w,如/v,-/w,1/m,；/w,•忽/nw,略/d,有/v,缺/v,失值/nw,的/u,样本/n,；/w,•/w,使用/v,相似/a,样本/n,的/u,均值/n,添/v,补缺/v,失值/nw,；/w,•/w,使用/v,另外/c,的/u,机器/n,学习/v,算法/n,预测/v,缺/v,失值/nw,。/w,现在/t,，/w,我们/r,对/p,下/f,一节/mq,要/v,用/p,的/u,数据集/nw,进行/v,预处理/vn,，/w,使/v,其/r,可以/v,顺利/ad,地/u,使用/v,分类/vn,算法/n,。/w,在/p,预/d,处理/v,阶段/n,需要/v,做/v,两件/mq,事/n,：/w,第一/m,，/w,所有/b,的/u,缺失/n,值/n,必须/d,用/p,一个/m,实数/n,值/n,来/v,替换/v,，/w,因为/c,我们/r,使用/v,的/u,numpy/en,数据/n,类型/n,不/d,允许/v,包含/v,缺/v,失值/nw,。/w,这里/r,选择/v,实数/n,0/m,来/v,替换/v,所有/b,缺失/n,值/n,，/w,恰好/d,能/v,适用/v,于/p,logistic/en,回归/v,。/w,这样/r,做/v,的/u,直觉/n,在于/v,，/w,我们/r,需要/v,的/u,是/v,一个/m,在/p,更新/v,时/ng,不/d,会/v,影响/vn,系数/n,的/u,值/n,。/w,回归/v,系数/n,的/u,更新/v,公式/n,如下/v,：/w,weights/en,=/w,weights/en,+/w,alpha/en,*/w,error/en,*/w,datamatrix/en,[/w,randindex/en,]/w,如果/c,datamatrix/en,的/u,某/r,特征/n,对/p,应值/nw,为/p,0/m,，/w,那么/r,该/r,特征/n,的/u,系数/n,将/d,不/d,做/v,更新/v,，/w,即/v,：/w, , , ,weights/en,=/w,weights/en,另外/c,，/w,由于/c,sigmoid/en,(/w,0/m,)/w,=/w,0.5/m,，/w,即/v,它/r,对/p,结果/n,的/u,预测/v,不/d,具有/v,任何/r,倾向性/n,，/w,因此/c,上述/b,做法/n,也/d,不/d,会/v,对/p,误差/n,项/q,造成/v,任何/r,影响/vn,。/w,基于/p,上述/b,原因/n,，/w,将/d,缺/v,失值/nw,用/p,0/m,代替/v,既/c,可以/v,保留/v,现有/v,数据/n,，/w,也/d,不/d,需要/v,对/p,优化/v,算法/n,进行/v,修改/v,。/w,此外/c,，/w,该/r,数据/n,集中/v,的/u,特征/n,取值/v,一般/a,不/d,为/p,0/m,，/w,因此/c,在/p,某种/r,意义/n,上/f,说/v,它/r,也/d,满足/v,“/w,特殊/a,值/n,”/w,这个/r,要求/v,。/w,预/d,处理/v,中/f,做/v,的/u,第二/m,件/q,事/n,是/v,，/w,如果/c,在/p,测试/vn,数据/n,集中/v,发现/v,了/u,一条/mq,数据/n,的/u,类别/n,标签/n,已经/d,缺失/n,，/w,那么/r,我们/r,的/u,简单/a,做法/n,是/v,将/d,该/r,条/q,数据/n,丢弃/v,。/w,这/r,是/v,因为/c,类别/n,标签/n,与/p,特征/n,不同/a,，/w,很/d,难/a,确定/v,采用/v,某个/r,合适/a,的/u,值/n,来/v,替换/v,。/w,采用/v,logistic/en,回归/v,进行/v,分类/vn,时/ng,这种/r,做法/n,是/v,合理/a,的/u,，/w,而/c,如果/c,采用/v,类似/v,knn/en,的/u,方法/n,就/d,可能/v,不/d,太/d