一/m,./w, ,简介/n,首先/d,来/v,看/v,百度/nt,百科/n,对/p,最小二乘法/nw,的/u,介绍/v,：/w,最小二乘法/nw,（/w,又/d,称/v,最/d,小平/n,方法/n,）/w,是/v,一种/mq,数学/n,优化/v,技术/n,。/w,它/r,通过/p,最小化/nw,误差/n,的/u,平方/q,和/c,寻找/v,数据/n,的/u,最佳/z,函数/n,匹配/vn,。/w,利用/v,最小二乘法/nw,可以/v,简便/a,地/u,求得/v,未知/vn,的/u,数据/n,，/w,并/c,使得/v,这些/r,求得/v,的/u,数据/n,与/p,实际/n,数据/n,之间/f,误差/n,的/u,平方/q,和/c,为/p,最/d,小/a,。/w,最小二乘法/nw,还/d,可/v,用于/v,曲线/n,拟合/nz,。/w,其他/r,一些/m,优化/v,问题/n,也/d,可/v,通过/p,最小化/nw,能量/n,或/c,最/d,大/a,化熵/nw,用/p,最小二乘法/nw,来/v,表达/v,。/w,简而言之/l,，/w,最小二乘法/nw,同/p,梯度/n,下降/v,类似/v,，/w,都/d,是/v,一种/mq,求解/v,无/v,约束/vn,最/d,优化/v,问题/n,的/u,常用/a,方法/n,，/w,并且/c,也/d,可以/v,用于/v,曲线/n,拟合/nz,，/w,来/v,解决/v,回归/v,问题/n,。/w,最小二乘法/nw,实质/n,就/d,是/v,最小化/nw,“/w,均方/nw,误差/n,”/w,，/w,而/c,均方/nw,误差/n,就/d,是/v,残差/nw,平方和/n,的/u,1/m,//w,m/en,(/w,m/en,为/p,样本数/n,)/w,，/w,同时/c,均方/nw,误差/n,也/d,是/v,回归/v,任务/n,中/f,最/d,常用/a,的/u,性能/n,度量/v,。/w,二/m,./w, ,对于/p,一元线性/nw,模型/n,如果/c,以/p,最/d,简单/a,的/u,一元线性/nw,模型/n,来/v,解释/v,最小二乘法/nw,。/w,回归/v,分析/vn,中/f,，/w,如果/c,只/d,包括/v,一个/m,自/p,变量/n,和/c,一个/m,因/p,变量/n,，/w,且/c,二者/r,的/u,关系/n,可/v,用/p,一条/mq,直线/n,近似/a,表示/v,，/w,这种/r,回归/v,分析/vn,称为/v,一元线性/nw,回归/v,分析/vn,。/w,如果/c,回归/v,分析/vn,中/f,包括/v,两个/m,或/c,两个/m,以上/f,的/u,自变量/n,，/w,且/c,因/p,变量/n,和/c,自变量/n,之间/f,是/v,线性/n,关系/n,，/w,则/d,称为/v,多元线性/nw,回归/v,分析/vn,。/w,对于/p,二维空间线性/nw,是/v,一条/mq,直线/n,；/w,对于/p,三维/nz,空间线性/nw,是/v,一个/m,平面/n,，/w,对于/p,多维空间线性/nw,是/v,一个/m,超平面/nz,./w,./w,./w,对于/p,一元线性/nw,回归/v,模型/n,,/w, ,假设/v,从/p,总体/n,中/f,获取/v,了/u,m/en,组/q,观察值/nw,（/w,x/en,1/m,，/w,y/en,1/m,）/w,，/w,（/w,x/en,2/m,，/w,y/en,2/m,）/w,，/w, ,…/w,，/w,（/w,xm/en,，/w,ym/en,）/w,。/w,对于/p,平面/n,中/f,的/u,这/r,m/en,个/q,点/q,，/w,可以/v,使用/v,无数/m,条/q,曲线/n,来/v,拟合/nz,。/w,要求/v,样本/n,回归/v,函数/n,尽可能/d,好/a,地/u,拟合/nz,这/r,组值/nw,。/w,综合/vn,起来/v,看/v,，/w,这/r,条/q,直线/n,处于/v,样本/n,数据/n,的/u,中心/n,位置/n,最/d,合理/a,。/w, ,选择/v,最佳/z,拟合/nz,曲线/n,的/u,标准/n,可以/v,确定/v,为/p,：/w,使/v,总/b,的/u,拟合/nz,误差/n,（/w,即/v,总/b,残差/nw,）/w,达到/v,最小/a,。/w,有/v,以下/f,三个/m,标准/n,可以/v,选择/v,：/w,（/w,1/m,）/w,用/p,“/w,残差/nw,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,是/v,一个/m,途径/n,。/w,但/c,可能/v,会/v,出现/v,计算/v,“/w,残差/nw,和/c,”/w,存在/v,相互/d,抵消/v,的/u,问题/n,。/w,（/w,2/m,）/w,用/p,“/w,残差/nw,绝对值/n,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,也/d,是/v,一个/m,途径/n,。/w,但/c,绝对值/n,的/u,计算/v,比较/d,麻烦/an,。/w,（/w,3/m,）/w,最小二乘法/nw,的/u,原则/n,是/v,以/p,“/w,残差/nw,平方/q,和/c,最/d,小/a,”/w,确定/v,直线/n,位置/n,。/w,用/p,最/d,小/a,二/m,乘/v,法除/nw,了/u,计算/v,比较/d,方便/a,外/f,，/w,得到/v,的/u,估计/v,量/n,还/d,具有/v,优良/z,特性/n,。/w,这种/r,方法/n,对/p,异常/a,值/n,非常/d,敏感/a,。/w,最/d,常用/a,的/u,是/v,普通/a,最小二乘法/nw,（/w, ,ordinary/en, , ,least/en, ,square/en,，/w,ols/en,）/w,：/w,所/u,选择/v,的/u,回归/v,模型/n,应该/v,使/v,所有/b,观察值/nw,的/u,残差/nw,平方/q,和/c,达到/v,最小/a,。/w,在/p,讲/v,最/d,小/a,二/m,乘/v,的/u,详情/n,之前/f,，/w,首先/d,明确/ad,两点/mq,：/w,1/m,./w,我们/r,假设/v,在/p,测量/vn,系统/n,中/f,不/d,存在/v,有/v,系统/n,误差/n,，/w,只/d,存在/v,有/v,纯/a,偶然/a,误差/n,。/w,比如/v,体重计/nw,或者/c,身高/n,计/v,本身/r,有/v,问题/n,，/w,测量/vn,出来/v,的/u,数据/n,都/d,偏/d,大/a,或者/c,都/d,偏/d,小/a,，/w,这种/r,误差/n,是/v,绝对/d,不/d,存在/v,的/u,。/w,（/w,或者说/nw,这/r,不能/v,叫/v,误差/n,，/w,这/r,叫/v,错误/n,）/w,2/m,./w,误差/n,是/v,符合/v,正态分布/n,的/u,，/w,因此/c,最后/f,误差/n,的/u,均值/n,为/p,0/m,（/w,这/r,一点/mq,很/d,重要/a,)/w, ,。/w,明确/ad,了/u,上面/f,两点/mq,以后/f,，/w,重点/n,来/v,了/u,：/w,为了/p,计算/v,β,0/m,,/w,β,1/m,的/u,值/n,，/w,我们/r,采取/v,如下/v,规则/n,：/w,β,0/m,,/w,β,1/m,应该/v,使/v,计算/v,出来/v,的/u,函数/n,曲线/n,与/p,观察值/nw,的/u,差/a,的/u,平方/q,和/c,最/d,小/a,。/w,用/p,数学/n,公式/n,描述/v,就/d,是/v,：/w,其中/r,，/w,yie/en,表示/v,根据/p,y/en,=/w,β,0/m,+/w,β,1/m,x/en,估算/v,出来/v,的/u,值/n,，/w,yi/en,是/v,观察/v,得到/v,的/u,真实/a,值/n,。/w,为什么/r,要/v,用/p,残差/nw,的/u,平方/q,和/c,最/d,小/a,？/w,用/p,差/a,的/u,绝对值/n,不行/a,么/y,？/w,以下/f,是/v,一个/m,相对/d,靠谱/nw,的/u,解释/v,：/w,我们/r,假设/v,直线/n,对于/p,坐标/n, ,xi/en, ,给/p,出/v,的/u,预测/v, ,f/en,(/w,xi/en,)/w, ,是/v,最/d,靠谱/nw,的/u,预测/v,，/w,所有/b,纵/c,坐标/n,偏离/v, ,f/en,(/w,xi/en,)/w, ,的/u,那些/r,数据点/nw,都/d,含有/v,噪音/n,，/w,是/v,噪音/n,使得/v,它们/r,偏离/v,了/u,完美/a,的/u,一条/mq,直线/n,，/w,一个/m,合理/a,的/u,假设/v,就/d,是/v,偏离/v,路线/n,越/d,远/a,的/u,概率/n,越/d,小/a,，/w,具体/a,小/a,多少/r,，/w,可以/v,用/p,一个/m,正态分布/n,曲线/n,来/v,模拟/b,，/w,这个/r,分布/v,曲线/n,以/p,直线/n,对/p, ,xi/en, ,给/p,出/v,的/u,预测/v, ,f/en,(/w,xi/en,)/w, ,为/p,中心/n,，/w,实际/n,纵/c,坐标/n,为/p, ,yi/en, ,的/u,点/q, ,(/w,xi/en,,/w, ,yi/en,)/w, ,发生/v,的/u,概率/n,就/d,正比/n,于/p, ,exp/en,[/w,-/w,(/w,Δ,yi/en,)/w,^,2/m,]/w,。/w,（/w,exp/en,(/w,./w,./w,)/w, ,代表/n,以/p,常数/n, ,e/en, ,为/p,底/f,的/u,多少/r,次方/n,）/w,。/w,所以/c,我们/r,在/p,前面/f,的/u,两点/mq,里/f,提到/v,，/w,假设/v,误差/n,的/u,分布/v,要/v,为/p,一个/m,正态分布/n,，/w,原因/n,就/d,在/p,这里/r,了/u,。/w,另外/c,说/v,一点/mq,我/r,自己/r,的/u,理解/v,：/w,从/p,数学/n,处理/v,的/u,角度/n,来说/u,，/w,绝对值/n,的/u,数学/n,处理/v,过程/n,，/w,比/p,平方和/n,的/u,处理/v,要/v,复杂/a,很多/m,。/w,搞/v,过/u,机器/n,学习/v,的/u,同学/n,都/d,知道/v,，/w,l/en,1/m,正则/nw,就/d,是/v,绝对值/n,的/u,方式/n,，/w,而/c,l/en,2/m,正则/nw,是/v,平方和/n,的/u,形式/n,。/w,l/en,1/m,能/v,产生/v,稀疏/a,的/u,特征/n,，/w,这/r,对/p,大规模/b,的/u,机器/n,学习/v,灰常/d,灰常/d,重要/a,。/w,但是/c,l/en,1/m,的/u,求解/v,过程/n,，/w,实在/d,是/v,太/d,过/u,蛋疼/nw,。/w,所以/c,即使/c,l/en,1/m,能/v,产生/v,稀疏/a,特征/n,，/w,不/d,到/v,万不得已/i,，/w,我们/r,也/d,还是/c,宁可/d,用/p,l/en,2/m,正则/nw,，/w,因为/c,l/en,2/m,正则/nw,计算/v,起来/v,方便/a,得/u,多/a,。/w,。/w,。/w,明确/ad,了/u,前面/f,的/u,cost/en, ,function/en,以后/f,，/w,后面/f,的/u,优化/v,求解/v,过程/n,反倒/d,变/v,得/u,s/en,容易/a,了/u,。/w,样本/n,的/u,回归/v,模型/n,很/d,容易/a,得出/v,：/w,现在/t,需要/v,确定/v,β,0/m,、/w,β,1/m,，/w,使/v,cost/en, ,function/en,最/d,小/a,。/w,学/v,过/u,高数/nw,的/u,同志/n,们/k,都/d,清楚/a,，/w,求导/nw,就/d,ok/en,。/w,对于/p,这种/r,形式/n,的/u,函数/n,求导/nw,，/w,根据/p,数学/n,知识/n,我们/r,知道/v,，/w,函数/n,的/u,极值/nz,点/q,为/p,偏导/nw,为/p,0/m,的/u,点/q,。/w,将/d,这/r,两个/m,方程/n,稍微/d,整理/v,一下/m,，/w,使用/v,克莱姆法则/nw,，/w,很/d,容易/a,求解/v,得出/v,：/w,这/r,就/d,是/v,最小二乘法/nw,的/u,解法/n,，/w,就/d,是/v,求得/v,平方/q,损失/n,函数/n,的/u,极值/nz,点/q,。/w,需要/v,注意/v,的/u,一点/m,是/v,β,0/m,是/v,常数/n,项/q,对应/v,的/u,系数/n,，/w,此处/s,相当/d,于/p,添加/vn,了/u,一个/m,特征/n,值/n,x/en,0/m,且/c,x/en,0/m,恒/ag,为/p,1/m,，/w,也/d,就/d,是/v,目标/n,函数/n,中/f,的/u,β,0/m,可以/v,看成/v,β,0/m,x/en,0/m,,/w,这样/r,的/u,话/n,就/d,不同/a,单独/d,考虑/v,常数/n,项/q,了/u,(/w,在/p,后面/f,的/u,多元线性/nw,模型/n,就/d,用到/v,了/u,该/r,性质/n,)/w,。/w,三/m,./w, ,对于/p,多元线性/nw,模型/n,如果/c,我们/r,推广/v,到/v,更/d,一般/a,的/u,情况/n,，/w,假如/c,有/v,更/d,多/a,的/u,模型/n,变量/n,x/en,1/m,,/w,x/en,2/m,,/w,⋯,,/w,xn/en,，/w,可以/v,用/p,线性/n,函数/n,表示/v,如下/v,：/w,对于/p,m/en,个/q,样本/n,来说/u,，/w,可以/v,用/p,如下/v,线性/n,方程组/n,表示/v,：/w,如果/c,将/d,样本/n,矩阵/n,xij/en,记/v,为/p,矩阵/n,a/en,,/w,将/d,参数/n,矩/ng,阵记/nw,为/p,向/p,量β/nw,，/w,真实/a,值记/nw,为/p,向量/n,y/en,，/w,上述/b,线性/n,方程组/n,可以/v,表示/v,为/p,：/w,对于/p,最小/a,二/m,乘/v,来说/u,，/w,最终/d,的/u,矩阵/n,表达/v,形式/n,可以/v,表示/v,为/p,：/w,其中/r,m/en,≥/w,n/en,,/w,由于/c,考虑/v,到/v,了/u,常数/n,项/q,，/w,故/c,属/v,性值/nw,个数/n,由/p,n/en,变为/v,n/en,+/w,1/m,。/w,关于/p,这个/r,方程/n,的/u,解法/n,，/w,具体/a,如下/v,：/w,其中/r,倒数/v,第二/m,行/v,中/f,的/u,中间/f,两项/mq,为/p,标量/n,，/w,所以/c,二者/r,相等/v,。/w,然后/c,利用/v,该式/nw,对/p,向/p,量β/nw,求导/nw,：/w,(/w,1/m,)/w,由/p,矩阵/n,的/u,求导/nw,法则/n,：/w,可知/v,(/w,1/m,)/w,式/k,的/u,结果/n,为/p,：/w,令/v,上式/nw,结果/n,等于/v,0/m,可得/v,：/w,(/w,2/m,)/w,上式/nw,就/d,是/v,最小二乘法/nw,的/u,解析/v,解/v,，/w,它/r,是/v,一个/m,全局/n,最/d,优解/nw,。/w,四/m,./w, ,其他/r,一些/m,想法/n,1/m,./w, ,最小二乘法/nw,和/c,梯度/n,下降/v,乍/d,一/m,看看/v,β,的/u,最终/d,结果/n,，/w,感觉/n,很/d,面熟/a,，/w,仔细/ad,一/m,看/v,，/w,这/r,不/d,就/d,是/v,ng/en,的/u,ml/en,课程/n,中/f,所/u,讲/v,到/v,的/u,正规/a,方程/n,嘛/y,！/w,实际上/d,，/w,ng/en,所/u,说/v,的/u,的/u,正规/a,方程/n,的/u,解法/n,就/d,是/v,最/d,小/a,二/m,乘/v,法求/nw,解析/v,解/v,的/u,解法/n,。/w,(/w,1/m,)/w,最小二乘法/nw,和/c,梯度/n,下降/v,法在线性/nw,回归/v,问题/n,中/f,的/u,目标/n,函数/n,是/v,一样/u,的/u,(/w,或者说/nw,本质/n,相同/a,)/w,，/w,都/d,是/v,通过/p,最小化/nw,均方/nw,误差/n,来/v,构建/v,拟合/nz,曲线/n,。/w,(/w,2/m,)/w,二者/r,的/u,不同点/n,可见/v,下/f,图/n,(/w,正规/a,方程/n,就/d,是/v,最小二乘法/nw,)/w,：/w,需要/v,注意/v,的/u,一点/m,是/v,最小二乘法/nw,只/d,适用/v,于/p,线性/n,模型/n,(/w,这里/r,一般/a,指线性/nw,回归/v,)/w,；/w,而/c,梯度/n,下降/v,适用性/n,极/d,强/a,，/w,一般而言/l,，/w,只要/c,是/v,凸/ag,函数/n,，/w,都/d,可以/v,通过/p,梯度/n,下降/v,法/j,得到/v,全局/n,最/d,优/ag,值/n,(/w,对于/p,非凸函数/nw,，/w,能够/v,得到/v,局部/n,最/d,优解/nw,)/w,。/w,梯度/n,下降/v,法/j,只要/c,保证/v,目标/n,函数/n,存在/v,一阶/nw,连续/a,偏导/nw,，/w,就/d,可以/v,使用/v,。/w,2/m,./w,最小二乘法/nw,的/u,一些/m,限制/v,和/c,解决/v,方法/n,：/w,我们/r,由/p,第三/nw,部分/n,(/w,2/m,)/w,式/k,可/v,知道/v,，/w,要/v,保证/v,最小二乘法/nw,有/v,解/v,，/w,就/d,得/u,保证/v,ata/en,是/v,一个/m,可逆/vn,阵/ng,(/w,非/h,奇异/a,矩阵/n,)/w,；/w,那/r,如果/c,ata/en,不可/v,逆/vg,怎么办/v,？/w,什么/r,情况/n,下/f,ata/en,不可/v,逆/vg,？/w,关于/p,ata/en,在/p,什么/r,情况/n,下/f,不可/v,逆/vg,：/w,(/w,1/m,)/w,当/p,样本/n,的/u,数量/n,小于/v,参数/n,向/p,量/n,(/w,即/v,β,)/w,的/u,维度/n,时/ng,，/w,此时/r,ata/en,一定/d,是/v,不可/v,逆/vg,的/u,。/w,例如/v,：/w,你/r,有/v,1000个/m,特征/n,，/w,但/c,你/r,的/u,样本/n,数目/n,小于/v,1000/m,的话/u,，/w,那么/r,构造/v,出/v,的/u,ata/en,就/d,是/v,不可/v,逆/vg,的/u,。/w,(/w,2/m,)/w,在/p,所有/b,特征/n,中/f,若/c,存在/v,一个/m,特征/n,与/p,另/r,一个/m,特征线性/nw,相关/v,或/c,一个/m,特征/n,与/p,若干/m,个/q,特征线性/nw,相关/v,时/ng,，/w,此时/r,ata/en,也/d,是/v,不可/v,逆/vg,的/u,。/w,为什么/r,呢/y,？/w,具体来说/nw,假设/v,,/w,a/en,是/v,m/en,*/w,n/en,维/q,的/u,矩阵/n,，/w,若/c,存在线性/nw,相关/v,的/u,