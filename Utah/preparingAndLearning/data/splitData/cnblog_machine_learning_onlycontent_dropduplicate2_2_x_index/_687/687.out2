欢迎/v,大家/r,前往/v,腾讯云/nw,技术/n,社区/n,，/w,获取/v,更/d,多/a,腾讯/nt,海量/n,技术/n,实践/v,干货/n,哦/e,~/w,作者/n,：/w,汪毅雄/nr,导语/n, ,本文/r,用/p,容易/a,理解/v,的/u,语言/n,和/c,例子/n,来/v,解释/v,了/u,决策/n,树/v,三种/mq,常见/a,的/u,算法/n,及其/c,优劣/n,、/w,随机/d,森林/n,的/u,含义/n,，/w,相信/v,能/v,帮助/v,初/f,学者/n,真正/d,地/u,理解/v,相关/v,知识/n,。/w,决策/n,树/v,引言/n,决策/n,树/v,，/w,是/v,机器/n,学习/v,中/f,一种/mq,非常/d,常见/a,的/u,分类/vn,方法/n,，/w,也/d,可以/v,说是/v,所有/b,算法/n,中/f,最/d,直观/a,也/d,最/d,好/a,理解/v,的/u,算法/n,。/w,先/d,举/v,个/q,最/d,简单/a,的/u,例子/n,：/w,a/en,：/w,你/r,去/v,不/d,去/v,吃饭/v,？/w,b/en,：/w,你/r,去/v,我/r,就/d,去/v,。/w,“/w,你/r,去/v,我/r,就/d,去/v,”/w,，/w,这/r,是/v,典型/n,的/u,决策/n,树/v,思想/n,。/w,再/d,举/v,个/q,例子/n,：/w,有人/r,找/v,我/r,借/v,钱/n,（/w,当然/d,不/d,太/d,可能/v,。/w,。/w,。/w,）/w,，/w,借/v,还是/c,不/d,借/v,？/w,我/r,会/v,结合/v,根据/p,我/r,自己/r,有/v,没有/v,钱/n,、/w,我/r,自己/r,用/p,不/d,用/p,钱/n,、/w,对方/n,信用/n,好/a,不/d,好/a,这/r,三个/m,特征/n,来/v,决定/v,我/r,的/u,答案/n,。/w,我们/r,把/p,转/v,到/v,更/d,普遍/ad,一点/m,的/u,视角/n,，/w,对于/p,一些/m,有/v,特征/n,的/u,数据/n,，/w,如果/c,我们/r,能够/v,有/v,这么/r,一颗/mq,决策/n,树/v,，/w,我们/r,也/d,就/d,能/v,非常/d,容易/a,地/u,预测/v,样本/n,的/u,结论/n,。/w,所以/c,问题/n,就/d,转换/v,成/v,怎么/r,求/v,一颗/mq,合适/a,的/u,决策/n,树/v,，/w,也/d,就/d,是/v,怎么/r,对/p,这些/r,特征/n,进行/v,排序/vn,。/w,在/p,对/p,特征/n,排序/vn,前/f,先/d,设想/vn,一下/m,，/w,对/p,某/r,一个/m,特征/n,进行/v,决策/n,时/ng,，/w,我们/r,肯定/v,希望/v,分类/vn,后/f,样本/n,的/u,纯度/n,越/d,高/a,越/d,好/a,，/w,也就是说/l,分支/n,结点/nw,的/u,样本/n,尽可能/d,属于/v,同一/b,类别/n,。/w,所以/c,在/p,选择/v,根/q,节点/n,的/u,时候/n,，/w,我们/r,应该/v,选择/v,能够/v,使得/v,“/w,分支/n,结点/nw,纯度/n,最高/a,”/w,的/u,那个/r,特征/n,。/w,在/p,处理/v,完/v,根/q,节点/n,后/f,，/w,对于/p,其/r,分支/n,节点/n,，/w,继续/v,套用/v,根/q,节点/n,的/u,思想/n,不断/d,递归/nw,，/w,这样/r,就/d,能/v,形成/v,一颗/mq,树/v,。/w,这/r,其实/d,也/d,是/v,贪心/v,算法/n,的/u,基本/a,思想/n,。/w,那/r,怎么/r,量化/v,“/w,纯度/n,最高/a,”/w,呢/y,？/w,熵/g,就/d,当仁不让了/nw,，/w,它/r,是/v,我们/r,最/d,常用/a,的/u,度量/v,纯度/n,的/u,指标/n,。/w,其/r,数学/n,表达/v,式/k,如下/v,：/w,其中/r,n/en,表示/v,结论/n,有/v,多少/r,种/q,可能/v,取值/v,，/w,p/en,表示/v,在/p,取/v,第/m,k/en,个值/nw,的/u,时候/n,发生/v,的/u,概率/n,，/w,对于/p,样本/n,而言/u,就/d,是/v,发生/v,的/u,频率/n,//w,总/b,个/q,数/m,。/w,熵/g,越/d,小/a,，/w,说明/v,样本/n,越/d,纯/a,。/w,以/p,一个/m,两点/nw,分布/v,样本/n,x/en,（/w,x/en,=/w,0/m,或/c,1/m,）/w,的/u,熵/g,的/u,函数/n,图像/n,来/v,说明/v,吧/y,，/w,横/v,坐标/n,表示/v,样本/n,值/n,为/p,1/m,的/u,概率/n,，/w,纵/c,坐标/n,表示/v,熵/g,。/w,可以/v,看到/v,到/v,当/p,p/en,（/w,x/en,=/w,1/m,）/w,=/w,0时/t,，/w,也就是说/l,所有/b,的/u,样本/n,都/d,为/p,0/m,，/w,此时/r,熵/g,为/p,0/m,./w,当/p,p/en,（/w,x/en,=/w,1/m,）/w,=/w,1时/t,，/w,也就是说/l,所有/b,的/u,样本/n,都/d,为/p,1/m,，/w,熵/g,也/d,为/p,0/m,./w,当/p,p/en,（/w,x/en,=/w,1/m,）/w,=/w,0.5时/t,，/w,也/d,就/d,是/v,样本/n,中/f,0/m,，/w,1/m,各/r,占/v,一半/m,，/w,此时/r,熵/g,能/v,取得/v,最大值/nz,。/w,扩展/v,一下/m,，/w,样本/n,x/en,可能/v,取值/v,为/p,n/en,种/q,（/w,x/en,1/m,。/w,。/w,。/w,。/w,xn/en,）/w,。/w,可以/v,证明/v,，/w,当/p,p/en,（/w,xi/en,）/w,都/d,等于/v,1/m,//w,n/en, ,时/ng,，/w,也/d,就/d,是/v,样本/n,绝对/d,均匀/ad,，/w,熵/g,能/v,达到/v,最/d,大/a,。/w,当/p,p/en,（/w,xi/en,）/w,有/v,一个/m,为/p,1/m,，/w,其他/r,都/d,为/p,0时/t,，/w,也/d,就/d,是/v,样本/n,取值/v,都/d,是/v,xi/en,，/w,熵/g,最/d,小/a,。/w,决策/n,树/v,算法/n,id/en,3/m,假设/v,在/p,样本/n,集/vg,x/en,中/f,，/w,对于/p,一个/m,特征/n,a/en,，/w,它/r,可能/v,有/v,（/w,a/en,1/m,，/w,a/en,2/m,。/w,。/w,。/w,an/en,）/w,这些/r,取值/v,，/w,如果/c,用/p,特征/n,a/en,对/p,样本/n,集/vg,x/en,进行/v,划分/v,（/w,把/p,它/r,当根/nrf,节点/n,）/w,，/w,肯定/v,会/v,有/v,n/en,个/q,分支/n,结点/nw,。/w,刚才/t,提/v,了/u,，/w,我们/r,希望/v,划分/v,后/f,，/w,分支/n,结点/nw,的/u,样本/n,越/d,纯/a,越/d,好/a,，/w,也/d,就/d,是/v,分支/n,结点/nw,的/u,“/w,总熵/nw,”/w,越/d,小/a,越/d,好/a,。/w,因为/c,每个/r,分支/n,结点/nw,的/u,个数/n,不/d,一样/u,，/w,因此/c,我们/r,计算/v,“/w,总熵/nw,”/w,时/ng,应该/v,做/v,一个/m,加权/v,，/w,假设/v,第/m,i/en,个/q,结点/nw,样本/n,个数/n,为/p,w/en,(/w,ai/en,)/w,，/w,其/r,在/p,所有/b,样本/n,中/f,的/u,权值/nw,为/p,w/en,(/w,ai/en,)/w, ,//w, ,w/en,(/w,x/en,)/w,。/w,所以/c,我们/r,可以/v,得到/v,一个/m,总熵/nw,：/w,这个/r,公式/n,代表/n,含义/n,一句/mq,话/n,：/w,加权/v,后/f,各个/r,结点/nw,的/u,熵/g,的/u,总和/n,。/w,这个/r,值/n,应该/v,越/d,小/a,，/w,纯度/n,越/d,高/a,。/w,这时候/r,，/w,我们/r,引入/v,一个/m,名词/n,叫/v,信息/n,增益/v,g/en,（/w,x/en,，/w,a/en,）/w,，/w,意思/n,就/d,是/v,a/en,这个/r,特征/n,给/p,样本/n,带来/v,的/u,信息/n,的/u,提升/v,。/w,公式/n,就/d,是/v,：/w,，/w,由于/c,h/en,(/w,x/en,)/w,对/p,一个/m,样本/n,而言/u,，/w,是/v,一个/m,固定值/nw,，/w,因此/c,信息/n,增益/v,g/en,应该/v,越/d,大/a,越/d,好/a,。/w,寻找/v,使得/v,信息/n,增益/v,最/d,大/a,的/u,特征/n,作为/v,目标/n,结点/nw,，/w,并/c,逐步/d,递/v,归构/nw,建树/n,，/w,这/r,就/d,是/v,id/en,3/m,算法/n,的/u,思想/n,，/w,好/a,了/u,以/p,一个/m,简单/a,的/u,例子/n,来/v,说明/v,信息/n,增益/v,的/u,计算/v,：/w,上面/f,的/u,例子/n,，/w,我/r,计算/v,一下/m,特征/n,1/m,的/u,信息/n,增益/v,首先/d,计算/v,样本/n,的/u,熵/g,h/en,（/w,x/en,）/w,再/d,计算/v,总熵/nw,，/w,可以/v,看到/v,特征/n,1/m,有/v,3个/m,结点/nw,a/en,、/w,b/en,、/w,c/en,，/w,其/r,分别/d,为/p,6个/m,、/w,6个/m,、/w,5个/m,所以/c,a/en,的/u,权值/nw,为/p,6/m,//w,(/w,6/m,+/w,6/m,+/w,5/m,)/w,,/w, ,b/en,的/u,权值/nw,为/p,6/m,//w,(/w,6/m,+/w,6/m,+/w,5/m,)/w,,/w, ,c/en,的/u,为/p,5/m,//w,(/w,6/m,+/w,6/m,+/w,5/m,)/w,因为/c,我们/r,希望/v,划分/v,后/f,结点/nw,的/u,纯度/n,越/d,高/a,越/d,好/a,，/w,因此/c,还/d,需要/v,再/d,分别/d,计算/v,结点/nw,a/en,、/w,b/en,、/w,c/en,的/u,熵/g,特征/n,1/m,=/w,a/en,：/w,3个/m,是/v,、/w,3个/m,否/vg,，/w,其/r,熵/g,为/p,特征/n,1/m,=/w,b/en,：/w,2个/m,是/v,、/w,4个/m,否/vg,，/w,其/r,熵/g,为/p,特征/n,1/m,=/w,c/en,：/w,4个/m,是/v,、/w,1个/m,否/vg,，/w,其/r,熵/g,为/p,这样/r,分支/n,结点/nw,的/u,总熵/nw,就/d,等于/v,：/w,特征/n,1/m,的/u,信息/n,增益/v,就/d,等于/v,0.998/m,-/w,0.889/m,=/w,0.109/m,类似/v,地/u,，/w,我们/r,也/d,能/v,算/v,出/v,其他/r,的/u,特征/n,的/u,信息/n,增益/v,，/w,最终/d,取/v,信息/n,增益/v,最/d,大/a,的/u,特征/n,作为/v,根/q,节点/n,。/w,以上/f,计算/v,也/d,可以/v,有/v,经验/n,条件/n,熵/g,来/v,推导/vn,：/w,g/en,（/w,x/en,,/w,a/en,）/w,=/w,h/en,(/w,x/en,)/w, ,-/w, ,h/en,(/w,x/en,|/w,a/en,)/w,，/w,这/r,部分/n,有/v,兴趣/n,的/u,同学/n,可以/v,了解/v,一下/m,。/w,c/en,4.5/m,在/p,id/en,3/m,算法/n,中/f,其实/d,有/v,个/q,很/d,明显/a,的/u,问题/n,。/w,如果/c,有/v,一个/m,样本/n,集/vg,，/w,它/r,有/v,一个/m,叫/v,id/en,或者/c,姓名/n,之类/r,的/u,（/w,唯一/b,的/u,）/w,的/u,特征/n,，/w,那/r,就/d,完蛋/v,了/u,。/w,设想/vn,一下/m,，/w,如果/c,有/v,n/en,个/q,样本/n,，/w,id/en,这个/r,特征/n,肯定/v,会/v,把/p,这个/r,样本/n,也/d,分成/v,n/en,份/q,，/w,也/d,就/d,是/v,有/v,n/en,个/q,结点/nw,，/w,每个/r,结点/nw,只/d,有/v,一个/m,值/n,，/w,那/r,每个/r,结点/nw,的/u,熵/g,就/d,为/p,0/m,。/w,就是说/c,所有/b,分支/n,结点/nw,的/u,总熵/nw,为/p,0/m,，/w,那么/r,这个/r,特征/n,的/u,信息/n,增益/v,一定/d,会/v,达到/v,最大值/nz,。/w,因此/c,如果/c,此时/r,用/p,id/en,3/m,作为/v,决策/n,树/v,算法/n,，/w,根/q,节点/n,必然/d,是/v,id/en,这个/r,特征/n,。/w,但是/c,显然/ad,这/r,是/v,不/d,合理/a,的/u,。/w,。/w,。/w,当然/d,上面/f,说/v,的/u,是/v,极限/n,情况/n,，/w,一般/a,情况/n,下/f,，/w,如果/c,一个/m,特征/n,对/p,样本/n,划分/v,的/u,过于/d,稀疏/a,，/w,这个/r,也/d,是/v,不/d,合理/a,的/u,（/w,换句话/nw,就是/d,，/w,偏向/v,更/d,多/a,取值/v,的/u,特征/n,）/w,。/w,为了/p,解决/v,这个/r,问题/n,，/w,c/en,4.5/m,算法/n,采用/v,了/u,信息/n,增益率/nw,来/v,作为/v,特征/n,选取/v,标准/n,。/w,所谓/v,信息/n,增益率/nw,，/w,是/v,在/p,信息/n,增益/v,基础/n,上/f,，/w,除了/p,一项/mq,split/en, ,information/en,,/w,来/v,惩罚值/nw,更/d,多/a,的/u,属性/n,。/w,而/c,这个/r,split/en, ,information/en,其实/d,就/d,是/v,特征/n,个数/n,的/u,熵/g,h/en,（/w,a/en,）/w,。/w,为什么/r,这样/r,可以/v,减少/v,呢/y,，/w,以/p,上面/f,id/en,的/u,例子/n,来/v,理解/v,一下/m,。/w,如果/c,id/en,把/p,n/en,个/q,样本/n,分成/v,了/u,n/en,份/q,，/w,那/r,id/en,这个/r,特征/n,的/u,取值/v,的/u,概率/n,都/d,是/v,1/m,//w,n/en,，/w,文章/n,引言/n,已经/d,说/v,了/u,，/w,样本/n,绝对/d,均匀/ad,的/u,时候/n,，/w,熵/g,最/d,大/a,。/w,因此/c,这种/r,情况/n,，/w,以/p,id/en,为/p,特征/n,，/w,虽然/c,信息/n,增益/v,最/d,大/a,，/w,但是/c,惩罚/vn,因子/n,split/en, ,information/en,也/d,最/d,大/a,，/w,以/p,此/r,来/v,拉/v,低/a,其/r,增益率/nw,，/w,这/r,就/d,是/v,c/en,4.5/m,的/u,思想/n,。/w,cart/en,决策/n,树/v,的/u,目的/n,最终/d,还是/c,寻找/v,到/v,区分/v,样本/n,的/u,纯度/n,的/u,量化/v,标准/n,。/w,在/p,cart/en,决策/n,树/v,中/f,，/w,采用/v,的/u,是/v,基尼/nr,指数/n,来/v,作为/v,其/r,衡量/v,标准/n,。/w,基尼/nr,系数/n,直观/a,的/u,理解/v,是/v,，/w,从/p,集合/v,中/f,随机/d,抽取/vn,两个/m,样本/n,，/w,如果/c,样本/n,集合/v,越/d,纯/a,，/w,取/v,到/v,不同/a,样本/n,的/u,概率/n,越/d,小/a,。/w,这个/r,概率/n,反应/vn,的/u,就/d,是/v,基尼/nr,系数/n,。/w,因此/c,如果/c,一个/m,样本/n,有/v,k/en,个/q,分类/vn,。/w,假设/v,样本/n,的/u,某/r,一个/m,特征/n,a/en,有/v,n/en,个/q,取值/v,的话/u,，/w,其/r,某/r,一个/m,结点/nw,取/v,到/v,不同/a,样本/n,的/u,概率/n,为/p,：/w,因此/c,k/en,个/q,分类/vn,的/u,概率/n,总和/n,，/w,我们/r,称之为基尼系数/nw,：/w,而/c,基尼/nr,指数/n,，/w,则/d,是/v,对/p,所有/b,结点/nw,的/u,基尼/nr,系数/n,进行/v,加权/v,处理/v,计算/v,出来/v,后/f,，/w,我们/r,会/v,选择/v,基尼/nr,系数/n,最/d,小/a,的/u,那个/r,特征/n,作为/v,最/d,优/ag,划分/v,特征/n,。/w,剪枝/vn,剪枝/vn,的/u,目的/n,其实/d,就/d,是/v,防止/v,过/u,拟合/nz,，/w,它/r,是/v,决策/n,树/v,防止/v,过/u,拟合/nz,的/u,最/d,主要/b,手段/n,。/w,决策/n,树/v,中/f,，/w,为了/p,尽可能/d,争取/v,的/u,分类/vn,训练/vn,样本/n,，/w,所以/c,我们/r,的/u,决策/n,树/v,也/d,会/v,一直/d,生长/v,。/w,但是/c,呢/y,，/w,有时候/d,训练/vn,样本/n,可能/v,会/v,学/v,的/u,太/d,好/a,，/w,以至于/c,把/p,某些/r,样本/n,的/u,特/d,有/v,属性/n,当成/v,一般/a,属性/n,。/w,这时候/r,就/d,我们/r,就/d,需要/v,主动/ad,去除/v,一些/m,分支/n,，/w,来/v,降低/v,过/u,拟合/nz,的/u,风险/n,。/w,剪枝/vn,一般/a,有/v,两种/mq,方式/n,：/w,预剪/nw,枝/q,和/c,后/f,剪枝/vn,。/w,预剪/nw,枝/q,一般/a,情况/n,下/f,，/w,只要/c,结点/nw,样本/n,已经/d,100%/mq,纯/a,了/u,，/w,树/v,才/d,会/v,停止/v,生长/v,。/w,但/c,这个/r,可能/v,会/v,产生/v,过/u,拟合/nz,，/w,因此/c,我们/r,没有/v,必要/a,让/v,它/r,100%/mq,生长/v,，/w,所以/c,在/p,这/r,之前/f,，/w,设定/v,一些/m,终止/v,条件/n,来/v,提前/v,终止/v,它/r,。/w,这/r,就/d,叫/v,预/d,剪枝/vn,，/w,这个/r,过程/n,发生/v,在/p,决策/n,树/v,生成/vn,之