摘要 使用 logistic 回归 来 预测 某个人 的 入学 申请 
是否 会 被 接受 声明 本文 的 内容 非 原创 
但 经过 本人 翻译 和 总结 而来 转载 请 注明 
出处 本文 内容 来源 https / / www . dataquest 
. io / mission / 59 / logistic regression 原始数据 
展示 这 是 一份 美国 入学 申请 的 录取 记录表 
admit – 是否 录取 1 代表 录取 0 代表 否定 
gpa – gpa 成绩 gre – 绩点 import pandas admissions 
= pandas . read _ csv admissions . csv 在 
之前 已经 介绍 过了 线性 回归 现在 同样 使用 线性 
回归 来 进行 预测 from sklearn . linear _ model 
import LinearRegression model = LinearRegression # 训练 模型 model . 
fit admissions gre gpa admissions admit admit _ prediction = 
model . predict admissions gre gpa plt . xlabel gpa 
plt . ylabel admit _ prediction plt . scatter admissions 
gpa admit _ prediction plt . show 在上 图中 可见 
有些 预测 结果 小于 0 而这 明显 是 不对 的 
因为 预测 结果 应该 只 能为 0 或者 1 我们 
现在 需要 获取 一个 介于 0 和1/nr 之间 的 概率 
然后 通过 之前 的 文章 中 介绍 过 的 分类 
算法 机器学习 简易 入门 二 分类 来 确定 录取 一个人 
的 概率 的 阀值 来 决定 录取 结果 最终/d 生成/v 
只有/c 0/m 和1的/nr 结果/n logistic/w 回归/v 函数/n logistic/w 回归/v 产生/n 
的/uj 输出/v 都/d 位于/v 0/m 和1/nr 之间/f 通常用 来 产生 
预测 某个 事件 的 发生 概率 该 函数 的 格式 
为 其中 的 e 是 一个 无理数 常量 该 函数 
有 一个 很 漂亮 的 形状 # logistic 回归 函数 
def logit x return np . exp x / 1 
+ np . exp x # 在 6 到 6 
之间 等差 产生 50 个数 t = np . linspace 
6 6 50 dtype = float ylogit = logit t 
# 作图 plt . plot t ylogit label = logistic 
plt . ylabel Probability plt . xlabel t plt . 
title Logistic Function plt . show logistic 回归 在 线性 
回归方程 中 可以 将该 方程 产生 的 结果 y 放入 
到 logistic 回归方程 从而 将 线性方程 产生 的 结果 转换 
为 一个 概率 对于 本文 来说 这个 logistic 回归方程 为 
现在 根据 这个 logistic 回归方程 就能 产生 一个 录取 概率 
类似于 之前 使用 scikit learn 库 中的 线性 回归 现在 
也 可以 直接 使用 该 库 中的 logistic 回归 from 
sklearn . linear _ model import L o g i 
s t i c R e g r e s 
s i o n # 对 数据 集 进行 随机 
重 排序 admissions = admissions . loc np . random 
. permutation admissions . index # 将 随机 排序 后的前/nr 
700条 数据 作为 训练 集 后面 的 作为 测试 集 
num _ train = 700 data _ train = admissions 
num _ train data _ test = admissions num _ 
train logistic _ model = L o g i s 
t i c R e g r e s s 
i o n logistic _ model . fit data _ 
train gpa gre data _ train admit # 进行 测试 
fitted _ test = logistic _ model . predict _ 
proba data _ test gpa gre 1 # 因为 predict 
_ proba 返回 的 是 一个 两列 的 矩阵 矩阵 
的 每 一行 代表 的 是 对 一个 事件 的 
预测 结果 第一列 代表 该 事件 不会 发生 的 概率 
第二列 代表 的 是 该 事件 会 发生 的 概率 
而 这里 需要 的 是 第二列 的 数据 plt . 
scatter data _ test gre fitted _ test plt . 
xlabel gre plt . ylabel probability plt . show 评估 
模型 准确率 现在 假设 只要 录取 概率 大于 0.5 的 
就能 录取 计算 一下 这个 模型 的 准确性 # predict 
函数 会 自动 把 阀值 设置 为 0.5 predicted = 
logistic _ model . predict data _ train gpa gre 
# 计算 在 训练 集中 正确 预测 的 准确率 accuracy 
_ train = predicted = = data _ train admit 
. mean # 计算 在 测试 集中 正确 预测 的 
准确率 predicted = logistic _ model . predict data _ 
test gpa gre accuracy _ test = predicted = = 
data _ test admit . mean ROC/w 曲线/n 分别/d 计算/v 
训练/vn 集/q 和/c 测试/vn 集/q 的/uj ROC/w 曲线/n 和/c AUCfrom/w 
sklearn . metrics import roc _ curve roc _ auc 
_ score train _ probs = logistic _ model . 
predict _ proba data _ train gpa gre 1 test 
_ probs = logistic _ model . predict _ proba 
data _ test gpa gre 1 # 计算 AUC auc 
_ train = roc _ auc _ score data _ 
train admit train _ probs auc _ test = roc 
_ auc _ score data _ test admit test _ 
probs print Auc _ train { } . format auc 
_ train print Auc _ test { } . format 
auc _ test # 计算 ROC 曲线 roc _ train 
= roc _ curve data _ train admit train _ 
probs roc _ test = roc _ curve data _ 
test admit test _ probs # 作图 plt . plot 
roc _ train 0 roc _ train 1 plt . 
plot roc _ test 0 roc _ test 1 