http/en,:/w,//w,//w,www/en,-/w,personal/en,./w,umich/en,./w,edu/en,//w,~/w,jizhu/en,//w,jizhu/en,//w,wuke/en,//w,friedman/en,-/w,aos/en,01/m,./w,pdfhttps/en,:/w,//w,//w,www/en,./w,cnblogs/en,./w,com/en,//w,bentuwuying/en,//w,p/en,//w,6667267/m,./w,htmlhttps/en,:/w,//w,//w,www/en,./w,cnblogs/en,./w,com/en,//w,modifyrong/en,//w,p/en,//w,7744987/m,./w,htmlhttps/en,:/w,//w,//w,www/en,./w,cnblogs/en,./w,com/en,//w,bentuwuying/en,//w,p/en,//w,6264004/m,./w,html/en,1/m,./w,简介/n,gbdt/en,全称/n,梯度/n,下降/v,树/v,，/w,在/p,传统/n,机器/n,学习/v,算法/n,里面/f,是/v,对/p,真实/a,分布/v,拟合/nz,的/u,最/d,好/a,的/u,几/m,种/q,算法/n,之一/r,，/w,在/p,前/f,几/m,年/q,深度/n,学习/v,还/d,没有/v,大行其道/l,之前/f,，/w,gbdt/en,在/p,各种/r,竞赛/vn,是/v,大放异彩/i,。/w,原因/n,大概/d,有/v,几/m,个/q,，/w,一/m,是/v,效果/n,确实/ad,挺/d,不错/a,。/w,二/m,是/v,即/v,可以/v,用于/v,分类/vn,也/d,可以/v,用于/v,回归/v,。/w,三/m,是/v,可以/v,筛选/v,特征/n,。/w,这/r,三点/mq,实在/d,是/v,太/d,吸引/v,人/n,了/u,，/w,导致/v,在/p,面试/v,的/u,时候/n,大家/r,也/d,非常/d,喜欢/v,问/v,这个/r,算法/n,。/w, ,gbdt/en,的/u,面试/v,考核点/nw,，/w,大致/d,有/v,下面/f,几/m,个/q,:/w,gbdt/en, ,的/u,算法/n,的/u,流程/n,？/w,gbdt/en, ,如何/r,选择/v,特征/n, ,？/w,gbdt/en, ,如何/r,构建/v,特征/n, ,？/w,gbdt/en, ,如何/r,用于/v,分类/vn,？/w,gbdt/en, ,通过/p,什么/r,方式/n,减少/v,误差/n, ,？/w,gbdt/en,的/u,效果/n,相比/v,于/p,传统/n,的/u,lr/en,，/w,svm/en,效果/n,为什么/r,好/a,一些/m, ,？/w,gbdt/en, ,如何/r,加速/v,训练/vn,？/w,gbdt/en,的/u,参数/n,有/v,哪些/r,，/w,如何/r,调/v,参/j, ,？/w,gbdt/en, ,实战/n,当中/f,遇到/v,的/u,一些/m,问题/n, ,？/w,gbdt/en,的/u,优缺点/n, ,？/w,2/m,./w, ,正式/ad,介绍/v,首先/d,gbdt/en, ,是/v,通过/p,采用/v,加法/n,模型/n,（/w,即/v,基/ng,函数/n,的/u,线性/n,组合/v,）/w,，/w,以及/c,不断/d,减/v,小/a,训练/vn,过程/n,产生/v,的/u,残差/nw,来/v,达到/v,将/d,数据/n,分类/vn,或者/c,回归/v,的/u,算法/n,。/w,gbdt/en,的/u,训练/vn,过程/n,我们/r,通过/p,一张/mq,图片/n,，/w,图片/n,来源/n,来/v,说明/v,gbdt/en,的/u,训练/vn,过程/n,:/w,图/n, ,1/m,：/w,gbdt/en, ,的/u,训练/vn,过程/n,gbdt/en,通过/p,多/a,轮/q,迭代/vn,,/w,每/r,轮/q,迭代/vn,产生/v,一个/m,弱分类器/nw,，/w,每个/r,分类器/nw,在/p,上/f,一轮/mq,分类器/nw,的/u,残差/nw,基础/n,上/f,进行/v,训练/vn,。/w,对/p,弱分类器/nw,的/u,要求/v,一般/a,是/v,足够/v,简单/a,，/w,并且/c,是/v,低方/nw,差/a,和/c,高/a,偏差/n,的/u,。/w,因为/c,训练/vn,的/u,过程/n,是/v,通过/p,降低/v,偏差/n,来/v,不断/d,提高/v,最终/d,分类器/nw,的/u,精度/n,，/w,（/w,此处/s,是/v,可以/v,证明/v,的/u,）/w,。/w,弱分类器/nw,一般/a,会/v,选择/v,为/p,cart/en, ,tree/en,（/w,也/d,就/d,是/v,分类/vn,回归/v,树/v,）/w,。/w,由于/c,上述/b,高/a,偏差/n,和/c,简单/a,的/u,要求/v, ,每个/r,分类/vn,回归/v,树/v,的/u,深度/n,不/d,会/v,很/d,深/a,。/w,最终/d,的/u,总/b,分类器/nw, ,是/v,将/d,每/r,轮/q,训练/vn,得到/v,的/u,弱分类器/nw,加权/v,求/v,和/c,得到/v,的/u,（/w,也/d,就/d,是/v,加法/n,模型/n,）/w,。/w,模型/n,最终/d,可以/v,描述/v,为/p,：/w,fm/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mt/en,(/w,x/en,;/w,θ,m/en,)/w,fm/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mt/en,(/w,x/en,;/w,θ,m/en,)/w,模型/n,一共/d,训练/vn,m/en,轮/q,，/w,每/r,轮/q,产生/v,一个/m,弱/a,分类器/nw, ,t/en,(/w,x/en,;/w,θ,m/en,)/w,t/en,(/w,x/en,;/w,θ,m/en,)/w,。/w,弱分类器/nw,的/u,损失/n,函数/n,θ,^,m/en,=/w,argmin/en,θ,m/en,∑/w,i/en,=/w,1/m,nl/en,(/w,yi/en,,/w,fm/en,−,1/m,(/w,xi/en,)/w,+/w,t/en,(/w,xi/en,;/w,θ,m/en,)/w,)/w,θ,^,m/en,=/w,arg/en,⁡,min/en,θ,m/en,⁡,∑/w,i/en,=/w,1/m,nl/en,(/w,yi/en,,/w,fm/en,−,1/m,(/w,xi/en,)/w,+/w,t/en,(/w,xi/en,;/w,θ,m/en,)/w,)/w,fm/en,−,1/m,(/w,x/en,)/w,fm/en,−,1/m,(/w,x/en,)/w, ,为/p,当前/t,的/u,模型/n,，/w,gbdt/en, ,通过/p,经验/n,风险/n,极/d,小化/nr,来/v,确定/v,下/f,一个/m,弱分类器/nw,的/u,参数/n,。/w,具体/a,到/v,损失/n,函数/n,本身/r,的/u,选择/v,也/d,就/d,是/v,l/en,的/u,选择/v,，/w,有/v,平方/q,损失/n,函数/n,，/w,0/m,-/w,1/m,损失/n,函数/n,，/w,对/p,数/m,损失/n,函数/n,等等/u,。/w,如果/c,我们/r,选择/v,平方/q,损失/n,函数/n,，/w,那么/r,这个/r,差值/n,其实/d,就是/d,我们/r,平常/a,所/u,说/v,的/u,残差/nw,。/w,但是/c,其实/d,我们/r,真正/d,关注/v,的/u,，/w,1/m,./w,是/v,希望/v,损失/n,函数/n,能够/v,不断/d,的/u,减小/v,，/w,2/m,./w,是/v,希望/v,损失/n,函数/n,能够/v,尽可能/d,快/a,的/u,减小/v,。/w,所以/c,如何/r,尽可能/d,快/a,的/u,减小/v,呢/y,？/w,让/v,损失/n,函数/n,沿着/p,梯度/n,方向/n,的/u,下降/v,。/w,这个/r,就/d,是/v,gbdt/en, ,的/u, ,gb/en,的/u,核心/n,了/u,。/w, ,利用/v,损失/n,函数/n,的/u,负/v,梯度/n,在/p,当前/t,模型/n,的/u,值/n,作为/v,回归/v,问题/n,提升/v,树/v,算法/n,中/f,的/u,残差/nw,的/u,近似/a,值/n,去/v,拟合/nz,一个/m,回归/v,树/v,。/w,gbdt/en, ,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,都/d,去/v,拟合/nz,损失/n,函数/n,在/p,当前/t,模型/n,下/f,的/u,负/v,梯度/n,。/w,这样/r,每/r,轮/q,训练/vn,的/u,时候/n,都/d,能够/v,让/v,损失/n,函数/n,尽可能/d,快/a,的/u,减小/v,，/w,尽快/d,的/u,收敛/vn,达到/v,局部/n,最/d,优解/nw,或者/c,全局/n,最/d,优解/nw,。/w,gbdt/en,如何/r,选择/v,特征/n,？/w,gbdt/en,选择/v,特征/n,的/u,细节/n,其实/d,是/v,想/v,问/v,你/r,cart/en, ,tree/en,生成/vn,的/u,过程/n,。/w,这里/r,有/v,一个/m,前提/n,，/w,gbdt/en,的/u,弱分类器/nw,默认/v,选择/v,的/u,是/v,cart/en, ,tree/en,。/w,其实/d,也/d,可以/v,选择/v,其他/r,弱分类器/nw,的/u,，/w,选择/v,的/u,前提/n,是/v,低方/nw,差/a,和/c,高/a,偏差/n,。/w,框架/n,服从/v,boosting/en, ,框架/n,即可/v,。/w,下面/f,我们/r,具体来说/nw,cart/en, ,tree/en,(/w,是/v,一种/mq,二/m,叉/v,树/v,)/w, ,如何/r,生成/vn,。/w,cart/en, ,tree/en, ,生成/vn,的/u,过程/n,其实/d,就/d,是/v,一个/m,选择/v,特征/n,的/u,过程/n,。/w,假设/v,我们/r,目前/t,总共/d,有/v, ,m/en, ,个/q,特征/n,。/w,第一/m,步/q,我们/r,需要/v,从中/d,选择/v,出/v,一个/m,特征/n, ,j/en,，/w,做/v,为/p,二/m,叉/v,树/v,的/u,第一/m,个/q,节点/n,。/w,然后/c,对/p,特征/n, ,j/en, ,的/u,值/n,选择/v,一个/m,切分点/nw, ,m/en,./w, ,一个/m, ,样本/n,的/u,特征/n,j/en,的/u,值/n, ,如果/c,小于/v,m/en,，/w,则/d,分为/v,一类/mq,，/w,如果/c,大于/v,m/en,,/w,则/d,分为/v,另外/c,一类/b,。/w,如此/r,便/d,构建/v,了/u,cart/en, ,树/v,的/u,一个/m,节点/n,。/w,其他/r,节点/n,的/u,生成/vn,过程/n,和/c,这个/r,是/v,一样/u,的/u,。/w,现在/t,的/u,问题/n,是/v,在/p,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,如何/r,选择/v,这个/r,特征/n, ,j/en,,/w,以及/c,如何/r,选择/v,特征/n, ,j/en, ,的/u,切分点/nw, ,m/en,:/w,原始/a,的/u,gbdt/en,的/u,做法/n,非常/d,的/u,暴力/n,，/w,首先/d,遍历/nw,每个/r,特征/n,，/w,然后/c,对/p,每个/r,特征/n,遍历/nw,它/r,所有/b,可能/v,的/u,切分点/nw,，/w,找到/v,最/d,优/ag,特征/n, ,m/en, ,的/u,最/d,优切分点/nt, ,j/en,。/w,如何/r,衡量/v,我们/r,找到/v,的/u,特征/n, ,m/en,和/c,切分点/nw, ,j/en, ,是/v,最/d,优/ag,的/u,呢/y,？/w, ,我们/r,用/p,定义/n,一个/m,函数/n, ,findlossandsplit/en, ,来/v,展示/v,一下/m,求解/v,过程/n,：/w,1/m, ,def/en, ,findlossandsplit/en,(/w,x/en,,/w,y/en,)/w,:/w, ,2/m, ,#, ,我们/r,用/p, ,x/en, ,来/v,表示/v,训练/vn,数据/n, ,3/m, ,#, ,我们/r,用/p, ,y/en, ,来/v,表示/v,训练/vn,数据/n,的/u,label/en, ,4/m, ,#, ,x/en,[/w,i/en,]/w,表示/v,训练/vn,数据/n,的/u,第/m,i/en,个/q,特征/n, ,5/m, ,#, ,x/en,_,i/en, ,表示/v,第/m,i/en,个/q,训练/vn,样本/n, ,6/m, ,7/m, ,#, ,minloss/en, ,表示/v,最小/a,的/u,损失/n, ,8/m, ,minloss/en, ,=/w, ,integet/en,./w,max/en,_,value/en, ,9/m, ,#, ,feature/en, ,表示/v,是/v,训练/vn,的/u,数据/n,第几纬度/nw,的/u,特征/n, ,10/m, ,feature/en, ,=/w, ,0/m, ,11/m, ,#, ,split/en, ,表示/v,切分点/nw,的/u,个数/n, ,12/m, ,split/en, ,=/w, ,0/m, ,13/m, ,14/m, ,#, ,m/en, ,表示/v, ,样本/n,x/en,的/u,特征/n,个/q,数/m, ,15/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,0/m,,/w,m/en,)/w,:/w, ,16/m, ,#, ,该维/nw,特征/n,下/f,，/w,特征值/n,的/u,每个/r,切分点/nw,，/w,这里/r,具体/a,的/u,切分/v,方式/n,可以/v,自己/r,定义/n, ,17/m, ,for/en, ,c/en, ,in/en, ,range/en,(/w,0/m,,/w,x/en,[/w,j/en,]/w,)/w,:/w, ,18/m, ,l/en, ,=/w, ,0/m, ,19/m, ,#, ,第一/m,类/q, ,20/m, ,r/en,1/m, ,=/w, ,{/w,x/en,|/w,x/en,[/w,j/en,]/w, ,</w,=/w, ,c/en,}/w, ,21/m, ,#, ,第二/m,类/q, ,22/m, ,r/en,2/m, ,=/w, ,{/w,x/en,|/w,x/en,[/w,j/en,]/w, ,>, ,c/en,}/w, ,23/m, ,#, ,属于/v,第一/m,类/q,样本/n,的/u,y/en,值/n,的/u,平均值/n, ,24/m, ,y/en,1/m, ,=/w, ,ave/en,{/w,y/en,|/w,x/en, ,属于/v, ,r/en,1/m,}/w, ,25/m, ,#, ,属于/v,第二/m,类/q,样本/n,的/u,y/en,值/n,的/u,平均值/n, ,26/m, ,y/en,2/m, ,=/w, ,ave/en,{/w,y/en,|/w, ,x/en, ,属于/v, ,r/en,2/m,}/w, ,27/m, ,#, ,遍历/nw,所有/b,的/u,样本/n,，/w,找到/v, ,loss/en, ,funtion/en, ,的/u,值/n, ,28/m, ,for/en, ,x/en,_,1/m, ,in/en, ,all/en, ,x/en, ,29/m, ,if/en, ,x/en,_,1/m, ,属于/v, ,r/en,1/m,：/w, ,30/m, ,l/en, ,+/w,=/w, ,(/w,y/en,_,1/m, ,-/w, ,y/en,1/m,)/w,^,2/m, ,31/m, ,else/en,:/w, ,32/m, ,l/en, ,+/w,=/w, ,(/w,y/en,_,1/m, ,-/w, ,y/en,2/m,)/w,^,2/m, ,33/m, ,if/en, ,l/en, ,</w, ,minloss/en,:/w, ,34/m, ,minloss/en, ,=/w, ,l/en, ,35/m, ,feature/en, ,=/w, ,i/en, ,36/m, ,split/en, ,=/w, ,c/en, ,37/m, ,return/en, ,minloss/en,,/w,feature/en, ,,/w,split/en,如果/c,对/p,这/r,段/q,代码/n,不/d,是/v,很/d,了解/v,的/u,，/w,可以/v,先/d,去/v,看看/v,李航第五/nr,章/q,中/f,对/p,cart/en, ,tree/en, ,算法/n,的/u,叙述/v,。/w,在/p,这里/r,，/w,我们/r,先/d,遍历/nw,训练/vn,样本/n,的/u,所有/b,的/u,特征/n,，/w,对于/p,特征/n, ,j/en,，/w,我们/r,遍历/nw,特征/n, ,j/en, ,所有/b,特征值/n,的/u,切分点/nw, ,c/en,。/w,找到/v,可以/v,让/v,下面/f,这个/r,式子/n,最小/a,的/u,特征/n, ,j/en, ,以及/c,切分点/nw,c/en,./w,gbdt/en, ,如何/r,构建/v,特征/n, ,?/w,其实/d,说/v,gbdt/en, ,能够/v,构建/v,特征/n,并非/v,很/d,准确/a,，/w,gbdt/en, ,本身/r,是/v,不能/v,产生/v,特征/n,的/u,，/w,但是/c,我们/r,可以/v,利用/v,gbdt/en,去/v,产生/v,特征/n,的/u,组合/v,。/w,在/p,ctr/en,预估/v,中/f,，/w,工业界/n,一般/a,会/v,采用/v,逻辑/n,回归/v,去/v,进行/v,处理/v,,/w,在/p,我/r,的/u,上/f,一篇/mq,博文/nz,当中/f,已经/d,说/v,过/u,，/w,逻辑/n,回归/v,本身/r,是/v,适合/v,处理/v,线性/n,可/v,分/q,的/u,数据/n,，/w,如果/c,我们/r,想/v,让/v,逻辑/n,回归/v,处理/v,非线性/b,的/u,数据/n,，/w,其中/r,一种/mq,方式/n,便是/v,组合/v,不同/a,特征/n,，/w,增强/v,逻辑/n,回归/v,对/p,非线性/b,分布/v,的/u,拟合/nz,能力/n,。/w,长久/a,以来/f,，/w,我们/r,都/d,是/v,通过/p,人工/n,的/u,先验/n,知识/n,或者/c,实验/vn,来/v,获得/v,有效/a,的/u,组合/v,特征/n,，/w,但是/c,很多/m,时候/n,，/w,使用/v,人工/n,经验/n,知识/n,来/v,组合/v,特征/n,过于/d,耗费/v,人力/n,，/w,造成/v,了/u,机器/n,学习/v,当中/f,一个/m,很/d,奇特/nz,的/u,现象/n,：/w,有/v,多少/r,人工/n,就/d,有/v,多少/r,智能/n,。/w,关键/n,是/v,这样/r,通过/p,人工/n,去/v,组合/v,特征/n,并/c,不/d,一定/d,能够/v,提升/v,模型/n,的/u,效果/n,。/w,所以/c,我们/r,的/u,从业者/n,或者/c,学界/n,一直/d,都/d,有/v,一个/m,趋势/n,便是/v,通过/p,算法/n,自动/d,，/w,高效/b,的/u,寻找/v,到/v,有效/a,的/u,特征/n,组合/v,。/w,facebook/en, ,在/p,2014年/t, ,发表/v,的/u,一篇/mq,论文/n,便是/v,这种/r,尝试/vn,下/f,的/u,产物/n,，/w,利用/v,gbdt/en,去/v,产生/v,有效/a,的/u,特征/n,组合/v,，/w,以便/d,用于/v,逻辑/n,回归/v,的/u,训练/vn,，/w,提升/v,模型/n,最终/d,的/u,效果/n,。/w,图/n, ,2/m,：/w,用/p,gbdt/en, ,构造/v,特征/n,如/v,图/n, ,2/m,所示/nz,，/w,我们/r, ,使用/v, ,gbdt/en, ,生成/vn,了/u,两棵/mq,树/v,，/w,两颗/mq,树/v,一共/d,有/v,五个/m,叶子/n,节点/n,。/w,我们/r,将/d,样本/n, ,x/en, ,输入/v,到/v,两颗/mq,树/v,当中/f,去/v,，/w,样本/n,x/en, ,落/v,在/p,了/u,第一/m,棵/q,树/v,的/u,第二/m,个/q,叶子/n,节点/n,，/w,第二/m,颗/q,树/v,的/u,第一/m,个/q,叶子/n,节点/n,，/w,于是/c,我们/r,便/d,可以/v,依次/d,构建/v,一个/m,五纬/nw,的/u,特征/n,向量/n,，/w,每/r,一个/m,纬度/n,代表/n,了/u,一个/m,叶子/n,节点/n,，/w,样本/n,落/v,在/p,这个/r,叶子/n,节点/n,上面/f,的/u,话/n,那么/r,值/n,为/p,1/m,，/w,没有/v,落/v,在/p,该/r,叶子/n,节点/n,的话/u,，/w,那么/r,值/n,为/p, ,0/m,./w,于是/c,对于/p,该/r,样本/n,，/w,我们/r,可以/v,得到/v,一个/m,向量/n,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,]/w, ,作为/v,该/r,样本/n,的/u,组合/v,特征/n,，/w,和/c,原来/d,的/u,特征/n,一起/s,输入/v,到/v,逻辑/n,回归/v,当中/f,进行/v,训练/vn,。/w,实验/vn,证明/v,这样/r,会/v,得到/v,比较/d,显著/a,的/u,效果/n,提升/v,。/w,gbdt/en, ,如何/r,用于/v,分类/vn, ,？/w,首先/d,明确/ad,一点/m,，/w,gbdt/en, ,无论/c,用于/v,分类/vn,还是/c,回归/v,一直/d,都/d,是/v,使用/v,的/u,cart/en, ,回归/v,树/v,。/w,不/d,会/v,因为/c,我们/r,所/u,选择/v,的/u,任务/n,是/v,分类/vn,任务/n,就/d,选用/v,分类/vn,树/v,，/w,这/r,里面/f,的/u,核心/n,是/v,因为/c,gbdt/en, ,每/r,轮/q,的/u,训练/vn,是/v,在/p,上/f,一轮/mq,的/u,训练/vn,的/u,残差/nw,基础/n,之上/f,进行/v,训练/vn,的/u,。/w,这里/r,的/u,残差/nw,就/d,是/v,当前/t,模型/n,的/u,负/v,梯度/n,值/n, ,。/w,这个/r,要求/v,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,弱分类器/nw,的/u,输出/v,的/u,结果/n,相减/nw,是/v,有/v,意义/n,的/u,。/w,残差/nw,相减/nw,是/v,有/v,意义/n,的/u,。/w,如果/c,选用/v,的/u,弱分类器/nw,是/v,分类/vn,树/v,，/w,类别/n,相减/nw,是/v,没有/v,意义/n,的/u,。/w,上/f,一轮/mq,输出/v,的/u,是/v,样本/n, ,x/en, ,属于/v, ,a/en,类/q,，/w,本/r,一轮/mq,训练/vn,输出/v,的/u,是/v,样本/n, ,x/en, ,属于/v, ,b/en,类/q,。/w, ,a/en, ,和/c, ,b/en, ,很多/m,时候/n,甚至/d,都/d,没有/v,比较/d,的/u,意义/n,，/w,a/en, ,类/q,-/w, ,b/en,类/q,是/v,没有/v,意义/n,的/u,。/w,我们/r,具体/a,到/v,分类/vn,这个/r,任务/n,上面/f,来/v,，/w,我们/r,假设/v,样本/n, ,x/en, ,总共/d,有/v, ,k/en,类/q,。/w,来/v,了/u,一个/m,样本/n, ,x/en,，/w,我们/r,需要/v,使用/v,gbdt/en,来/v,判断/v, ,x/en, ,属于/v,样本/n,的/u,哪/r,一类/mq,。/w,图/n,三/m, ,gbdt/en, ,多/a,分类/vn,算法/n,流程/n,第一/m,步/q, ,我们/r,在/p,训练/vn,的/u,时候/n,，/w,是/v,针对/p,样本/n, ,x/en, ,每个/r,可能/v,的/u,类/q,都/d,训练/vn,一个/m,分类/vn,回归/v,树/v,。/w,举例/v,说明/v,，/w,目前/t,样本/n,有/v,三类/mq,，/w,也/d,就/d,是/v, ,k/en, ,=/w, ,3/m,。/w,样本/n, ,x/en, ,属于/v, ,第二/m,类/q,。/w,那么/r,针对/p,该/r,样本/n, ,x/en, ,的/u,分类/vn,结果/n,，/w,其实/d,我们/r,可以/v,用/p,一个/m, ,三维/nz,向/p,量/n, ,[/w,0/m,,/w,1/m,,/w,0/m,]/w, ,来/v,表示/v,。/w,0/m,表示/v,样本/n,不/d,属于/v,该类/r,，/w,1/m,表示/v,样本/n,属于/v,该类/r,。/w,由于/c,样本/n,已经/d,属于/v,第二/m,类/q,了/u,，/w,所以/c,第二/m,类/q,对应/v,的/u,向量/n,维度/n,为/p,1/m,，/w,其他/r,位置/n,为/p,0/m,。/w,针对/p,样本/n,有/v, ,三类/mq,的/u,情况/n,，/w,我们/r,实质/n,上/f,是/v,在/p,每/r,轮/q,的/u,训练/vn,的/u,时候/n,是/v,同时/c,训练/vn,三颗/mq,树/v,。/w,第一/m,颗/q,树/v,针对/p,样本/n,x/en,的/u,第一/m,类/q,，/w,输入/v,为/p,（/w,x/en,,/w,0/m,）/w,（/w,x/en,,/w,0/m,）/w,。/w,第二/m,颗/q,树/v,输入/v,针对/p, ,样本/n,x/en, ,的/u,第二/m,类/q,，/w,输入/v,为/p,（/w,x/en,,/w,1/m,）/w,（/w,x/en,,/w,1/m,）/w,。/w,第三/nw,颗/q,树/v,针对/p,样本/n,x/en, ,的/u,第三/nw,类/q,，/w,输入/v,为/p,（/w,x/en,，/w,0/m,）/w,（/w,x/en,，/w,0/m,）/w,在/p,这里/r,每/r,颗/q,树/v,的/u,训练/vn,过程/n,其实/d,就是/d,就/d,是/v,我们/r,之前/f,已经/d,提到/v,过/u,的/u,catr/en, ,tree/en, ,的/u,生成/vn,过程/n,。/w,在/p,此处/s,我们/r,参照/v,之前/f,的/u,生成/vn,树/v,的/u,程序/n, ,即/v,可以/v,就/d,解/v,出/v,三颗/mq,树/v,，/w,以及/c,三颗/mq,树/v,对/p,x/en, ,类别/n,的/u,预测值/n,f/en,1/m,(/w,x/en,)/w,,/w,f/en,2/m,(/w,x/en,)/w,,/w,f/en,3/m,(/w,x/en,)/w,f/en,1/m,(/w,x/en,)/w,,/w,f/en,2/m,(/w,x/en,)/w,,/w,f/en,3/m,(/w,x/en,)/w,。/w,那么/r,在/p,此类/r,训练/vn,中/f,，/w,我们/r,仿照/v,多/a,分类/vn,的/u,逻辑/n,回归/v, ,，/w,使用/v,softmax/en, ,来/v,产生/v,概率/n,，/w,则/d,属于/v,类别/n, ,1/m, ,的/u,概率/n,p/en,1/m,=/w,exp/en,(/w,f/en,1/m,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,p/en,1/m,=/w,exp/en,(/w,f/en,1/m,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,并且/c,我们/r,我们/r,可以/v,针对/p,类别/n,1/m, ,求/v,出/v, ,残差/nw,y/en,11/m,(/w,x/en,)/w,=/w,0/m,−,p/en,1/m,(/w,x/en,)/w,y/en,11/m,(/w,x/en,)/w,=/w,0/m,−,p/en,1/m,(/w,x/en,)/w,;/w,类别/n,2/m, ,求/v,出/v,残差/nw,y/en,22/m,(/w,x/en,)/w,=/w,1/m,−,p/en,2/m,(/w,x/en,)/w,y/en,22/m,(/w,x/en,)/w,=/w,1/m,−,p/en,2/m,(/w,x/en,)/w,;/w,类别/n,3/m, ,求/v,出/v,残差/nw,y/en,33/m,(/w,x/en,)/w,=/w,0/m,−,p/en,3/m,(/w,x/en,)/w,y/en,33/m,(/w,x/en,)/w,=/w,0/m,−,p/en,3/m,(/w,x/en,)/w,./w,然后/c,开始/v,第二/m,轮/q,训练/vn, ,针对/p,第一/m,类/q, ,输入/v,为/p,（/w,x/en,,/w,y/en,11/m,(/w,x/en,)/w,y/en,11/m,(/w,x/en,)/w,）/w,,/w, ,针对/p,第二/m,类/q,输入/v,为/p,（/w,x/en,,/w,y/en,22/m,(/w,x/en,)/w,)/w,y/en,22/m,(/w,x/en,)/w,)/w,,/w, ,针对/p, ,第三/nw,类/q,输入/v,为/p, ,(/w,x/en,,/w,y/en,33/m,(/w,x/en,)/w,y/en,33/m,(/w,x/en,)/w,)/w,./w,继续/v,训练/vn,出/v,三颗/mq,树/v,。/w,一直/d,迭代/vn,m/en,轮/q,。/w,每/r,轮/q,构建/v, ,3颗/mq,树/v,。/w,所以/c,当/p,k/en, ,=/w,3/m,。/w,我们/r,其实/d,应该/v,有/v,三个/m,式子/n,f/en,1/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,1/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,1/m,m/en,)/w,f/en,1/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,1/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,1/m,m/en,)/w,f/en,2/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,2/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,2/m,m/en,)/w,f/en,2/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,2/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,2/m,m/en,)/w,f/en,3/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,3/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,3/m,m/en,)/w,f/en,3/m,m/en,(/w,x/en,)/w,=/w,∑/w,m/en,=/w,1/m,mc/en,3/m,m/en,^,i/en,(/w,x/en,ϵ,r/en,3/m,m/en,)/w,当/p,训练/vn,完毕/v,以后/f,，/w,新/a,来/v,一个/m,样本/n, ,x/en,1/m, ,，/w,我们/r,需要/v,预测/v,该/r,样本/n,的/u,类别/n,的/u,时候/n,，/w,便/d,可以/v,有/v,这/r,三个/m,式子/n,产生/v,三个/m,值/n,，/w,f/en,1/m,(/w,x/en,)/w,,/w,f/en,2/m,(/w,x/en,)/w,,/w,f/en,3/m,(/w,x/en,)/w,f/en,1/m,(/w,x/en,)/w,,/w,f/en,2/m,(/w,x/en,)/w,,/w,f/en,3/m,(/w,x/en,)/w,。/w,样本/n,属于/v, ,某个/r,类别/n,c/en,的/u,概率/n,为/p,pc/en,=/w,exp/en,(/w,fc/en,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,pc/en,=/w,exp/en,(/w,fc/en,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,gbdt/en, ,多/a,分类/vn,举例/v,说明/v,上面/f,的/u,理论/n,阐述/v,可能/v,仍旧/d,过于/d,难懂/a,，/w,我们/r,下面/f,将/d,拿/v,iris/en, ,数据/n,集中/v,的/u,六个/m,数据/n,作为/v,例子/n,，/w,来/v,展示/v,gbdt/en, ,多/a,分类/vn,的/u,过程/n,。/w,样本/n,编号/v,花萼/n,长度/n,(/w,cm/en,)/w,花萼/n,宽度/n,(/w,cm/en,)/w,花瓣/n,长度/n,(/w,cm/en,)/w,花瓣/n,宽度/n,花/v,的/u,种类/n,15/m,./w,13/m,./w,51/m,./w,40/m,./w,2/m,山/n,鸢尾/nw,24/m,./w,93/m,./w,01/m,./w,40/m,./w,2/m,山/n,鸢尾/nw,37/m,./w,03/m,./w,24/m,./w,71/m,./w,4/m,杂色/n,鸢尾/nw,46/m,./w,43/m,./w,24/m,./w,51/m,./w,5/m,杂色/n,鸢尾/nw,56/m,./w,33/m,./w,36/m,./w,02/m,./w,5/m,维吉尼亚/nrf,鸢尾/nw,65/m,./w,82/m,./w,75/m,./w,11/m,./w,9/m,维吉尼亚/nrf,鸢尾/nw,图/n,四/m, ,iris/en, ,数据集/nw,这/r,是/v,一个/m,有/v,6个/m,样本/n,的/u,三/m,分类/vn,问题/n,。/w,我们/r,需要/v,根据/p,这个/r,花/v,的/u,花萼/n,长度/n,，/w,花萼/n,宽度/n,，/w,花瓣/n,长度/n,，/w,花瓣/n,宽度/n,来/v,判断/v,这个/r,花/v,属于/v,山鸢/nw,尾/q,，/w,杂色/n,鸢尾/nw,，/w,还是/c,维吉尼亚/nrf,鸢尾/nw,。/w,具体/a,应用/vn,到/v,gbdt/en,多/a,分类/vn,算法/n,上面/f,。/w,我们/r,用/p,一个/m,三维/nz,向/p,量/n,来/v,标志/n,样本/n,的/u,label/en,。/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w, ,表示/v,样本/n,属于/v,山鸢/nw,尾/q,，/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w, ,表示/v,样本/n,属于/v,杂色/n,鸢尾/nw,，/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w, ,表示/v,属于/v,维吉尼亚/nrf,鸢尾/nw,。/w,gbdt/en, ,的/u,多/a,分类/vn,是/v,针对/p,每个/r,类/q,都/d,独立/v,训练/vn,一个/m, ,cart/en, ,tree/en,。/w,所以/c,这里/r,，/w,我们/r,将/d,针对/p,山鸢/nw,尾/q,类别/n,训练/vn,一个/m, ,cart/en, ,tree/en, ,1/m,。/w,杂色/n,鸢尾/nw,训练/vn,一个/m, ,cart/en, ,tree/en, ,2/m, ,。/w,维吉尼亚/nrf,鸢尾/nw,训练/vn,一个/m,cart/en, ,tree/en, ,3/m,，/w,这/r,三个树/mq,相互/d,独立/v,。/w,我们/r,以/p,样本/n, ,1/m, ,为/p,例/n,。/w,针对/p, ,cart/en, ,tree/en,1/m, ,的/u,训练/vn,样本/n,是/v,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,，/w,label/en, ,是/v, ,1/m,，/w,最终/d,输入/v,到/v,模型/n,当中/f,的/u,为/p,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,1/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,1/m,]/w,。/w,针对/p, ,cart/en, ,tree/en,2/m, ,的/u,训练/vn,样本/n,也/d,是/v,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,但是/c,label/en, ,为/p, ,0/m,,/w,最终/d,输入/v,模型/n,的/u,为/p,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,0/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,0/m,]/w,./w, ,针对/p, ,cart/en, ,tree/en, ,3/m,的/u,训练/vn,样本/n,也/d,是/v,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,label/en, ,也/d,为/p,0/m,,/w,最终/d,输入/v,模型/n,当中/f,的/u,为/p,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,0/m,]/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,,/w,0/m,]/w,./w,下面/f,我们/r,来/v,看/v, ,cart/en, ,tree/en,1/m, ,是/v,如何/r,生成/vn,的/u,，/w,其他/r,树/v, ,cart/en, ,tree/en,2/m, ,,/w, ,cart/en, ,tree/en, ,3/m,的/u,生成/vn,方式/n,是/v,一样/u,的/u,。/w,cart/en, ,tree/en,的/u,生成/vn,过程/n,是/v,从/p,这/r,四个/m,特征/n,中/f,找/v,一个/m,特征/n,做/v,为/p,cart/en, ,tree/en,1/m, ,的/u,节点/n,。/w,比如/v,花萼/n,长度/n,做/v,为/p,节点/n,。/w,6个/m,样本/n,当中/f,花萼/n,长度/n, ,大于/v,5.1/m, ,cm/en,的/u,就/d,是/v, ,a/en,类/q,，/w,小于/v,等于/v, ,5.1/m, ,cm/en, ,的/u,是/v,b/en,类/q,。/w,生成/vn,的/u,过程/n,其实/d,非常/d,简单/a,，/w,问题/n, ,1/m,./w,是/v,哪个/r,特征/n,最/d,合适/a,？/w, ,2/m,./w,是/v,这个/r,特征/n,的/u,什么/r,特征值/n,作为/v,切分点/nw,？/w, ,即使/c,我们/r,已经/d,确定/v,了/u,花萼/n,长度/n,做/v,为/p,节点/n,。/w,花萼/n,长度/n,本身/r,也/d,有/v,很多/m,值/n,。/w,在/p,这里/r,我们/r,的/u,方式/n,是/v,遍历/nw,所有/b,的/u,可能性/n,，/w,找到/v,一个/m,最/d,好/a,的/u,特征/n,和/c,它/r,对应/v,的/u,最优/ad,特征值/n,可以/v,让/v,当前/t,式子/n,的/u,值/n,最/d,小/a,。/w,我们/r,以/p,第一/m,个/q,特征/n,的/u,第一/m,个/q,特征值/n,为/p,例/n,。/w,r/en,1/m, ,为/p,所有/b,样本/n,中/f,花萼/n,长度/n,小于/v, ,5.1/m, ,cm/en, ,的/u,样本/n,集合/v,，/w,r/en,2/m, ,为/p,所有/b,样本/n,当中/f,花萼/n,长度/n,大于/v,等于/v, ,5.1/m,cm/en, ,的/u,样本/n,集合/v,。/w,所以/c, ,r/en,1/m,=/w,{/w,2/m,}/w,r/en,1/m,=/w,{/w,2/m,}/w,，/w,r/en,2/m,=/w,{/w,1/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,r/en,2/m,=/w,{/w,1/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,./w,图/n, ,5/m, ,节点/n,分裂/v,示意图/n,y/en,1/m, ,为/p, ,r/en,1/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,1/m,//w,1/m,=/w,11/m,//w,1/m,=/w,1/m,。/w,y/en,2/m, ,为/p, ,r/en,2/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,(/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w,//w,5/m,=/w,0.2/m,(/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w,//w,5/m,=/w,0.2/m,。/w,下面/f,便/d,开始/v,针对/p,所有/b,的/u,样本/n,计算/v,这个/r,式子/n,的/u,值/n,。/w,样本/n,1/m, ,属于/v, ,r/en,2/m, ,计算/v,的/u,值/n,为/p,(/w,1/m,−,0.2/m,)/w,2/m,(/w,1/m,−,0.2/m,)/w,2/m,,/w, ,样本/n,2/m, ,属于/v,r/en,1/m, ,计算/v,的/u,值/n,为/p,(/w,1/m,−,1/m,)/w,2/m,(/w,1/m,−,1/m,)/w,2/m,,/w, ,样本/n, ,3/m,，/w,4/m,，/w,5/m,，/w,6/m,同/p,理/n,都/d,是/v, ,属于/v, ,r/en,2/m,的/u, ,所以/c,值/n,是/v,(/w,0/m,−,0.2/m,)/w,2/m,(/w,0/m,−,0.2/m,)/w,2/m,./w, ,把/p,这/r,六个/m,值/n,加/v,起来/v,，/w,便是/v, ,山/n,鸢尾/nw,类型/n,在/p,特征/n,1/m, ,的/u,第一/m,个/q,特征值/n,的/u,损失值/nw,。/w,这里/r,算/v,出来/v,(/w,1/m,-/w,0.2/m,)/w,^,2/m,+/w, ,(/w,1/m,-/w,1/m,)/w,^,2/m, ,+/w, ,(/w,0/m,-/w,0.2/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m, ,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m,=/w, ,0.84/m,接着/c,我们/r,计算/v,第一/m,个/q,特征/n,的/u,第二/m,个/q,特征值/n,，/w,计算/v,方式/n,同/p,上/f,，/w,r/en,1/m, ,为/p,所有/b,样本/n,中/f, ,花萼/n,长度/n,小于/v, ,4.9/m, ,cm/en, ,的/u,样本/n,集合/v,，/w,r/en,2/m, ,为/p,所有/b,样本/n,当中/f, ,花萼/n,长度/n,大于/v,等于/v, ,4.9/m, ,cm/en, ,的/u,样本/n,集合/v,./w,所以/c, ,r/en,1/m,=/w,{/w,}/w,r/en,1/m,=/w,{/w,}/w,，/w,r/en,1/m,=/w,{/w,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,r/en,1/m,=/w,{/w,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,./w, ,y/en,1/m, ,为/p, ,r/en,1/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,=/w, ,0/m,。/w,y/en,2/m, ,为/p, ,r/en,2/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,(/w,1/m,+/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w,//w,6/m,=/w,0.3333/m,(/w,1/m,+/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w,//w,6/m,=/w,0.3333/m,。/w,图/n, ,6/m, ,第一/m,个/q,特征/n,的/u,第二/m,个/q,特/d,侦值/nw,的/u,节点/n,分裂/v,情况/n,我们/r,需要/v,针对/p,所有/b,的/u,样本/n,,/w,样本/n,1/m, ,属于/v, ,r/en,2/m,,/w, ,计算/v,的/u,值/n,为/p,(/w,1/m,−,0.333/m,)/w,2/m,(/w,1/m,−,0.333/m,)/w,2/m,,/w, ,样本/n,2/m, ,属于/v,r/en,2/m, ,,/w,计算/v,的/u,值/n,为/p,(/w,1/m,−,0.333/m,)/w,2/m,(/w,1/m,−,0.333/m,)/w,2/m,,/w, ,样本/n, ,3/m,，/w,4/m,，/w,5/m,，/w,6/m,同/p,理/n,都/d,是/v, ,属于/v, ,r/en,2/m,的/u,,/w, ,所以/c,值/n,是/v,(/w,0/m,−,0.333/m,)/w,2/m,(/w,0/m,−,0.333/m,)/w,2/m,./w, ,把/p,这/r,六个/m,值/n,加/v,起来/v,山鸢/nw,尾/q,类型/n,在/p,特征/n,1/m, ,的/u,第二/m,个/q,特征值/n,的/u,损失值/nw,。/w,这里/r,算/v,出来/v, ,(/w,1/m,-/w,0.333/m,)/w,^,2/m,+/w, ,(/w,1/m,-/w,0.333/m,)/w,^,2/m, ,+/w, ,(/w,0/m,-/w,0.333/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m, ,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m, ,=/w, ,2/m,./w,244189/m,./w, ,这里/r,的/u,损失值/nw,大于/v, ,特征/n,一/m,的/u,第一/m,个/q,特征值/n,的/u,损失值/nw,，/w,所以/c,我们/r,不/d,取/v,这个/r,特征/n,的/u,特征值/n,。/w,图/n, ,7/m, ,所有/b,情况/n,说明/v,这样/r,我们/r,可以/v,遍历/nw,所有/b,特征/n,的/u,所有/b,特征值/n,，/w,找到/v,让/v,这个/r,式子/n,最小/a,的/u,特征/n,以及/c,其/r,对应/v,的/u,特征值/n,，/w,一共/d,有/v,24种/mq,情况/n,,/w,4个/m,特征/n,*/w,每个/r,特征/n,有/v,6个/m,特征值/n,。/w,在/p,这里/r,我们/r,算/v,出来/v,让/v,这个/r,式子/n,最小/a,的/u,特征/n,花萼/n,长度/n,,/w,特征值/n,为/p,5.1/m, ,cm/en,。/w,这个/r,时候/n,损失/n,函数/n,最/d,小/a,为/p, ,0.8/m,。/w,于是/c,我们/r,的/u,预测/v,函数/n,此时/r,也/d,可以/v,得到/v,:/w,f/en,(/w,x/en,)/w,=/w,∑/w,x/en,ϵ,r/en,1/m,y/en,1/m,∗,i/en,(/w,x/en,ϵ,r/en,1/m,)/w,+/w,∑/w,x/en,ϵ,r/en,2/m,y/en,2/m,∗,i/en,(/w,x/en,ϵ,r/en,2/m,)/w,f/en,(/w,x/en,)/w,=/w,∑/w,x/en,ϵ,r/en,1/m,y/en,1/m,∗,i/en,(/w,x/en,ϵ,r/en,1/m,)/w,+/w,∑/w,x/en,ϵ,r/en,2/m,y/en,2/m,∗,i/en,(/w,x/en,ϵ,r/en,2/m,)/w,此处/s, ,r/en,1/m, ,=/w, ,{/w,2/m,}/w,,/w,r/en,2/m, ,=/w, ,{/w,1/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,，/w,y/en,1/m, ,=/w, ,1/m,,/w,y/en,2/m, ,=/w, ,0.2/m,。/w,训练/vn,完/v,以后/f,的/u,最终/d,式子/n,为/p,f/en,1/m,(/w,x/en,)/w,=/w,∑/w,x/en,ϵ,r/en,11/m,∗,i/en,(/w,x/en,ϵ,r/en,1/m,)/w,+/w,∑/w,x/en,ϵ,r/en,20.2/m,∗,i/en,(/w,x/en,ϵ,r/en,2/m,)/w,f/en,1/m,(/w,x/en,)/w,=/w,∑/w,x/en,ϵ,r/en,11/m,∗,i/en,(/w,x/en,ϵ,r/en,1/m,)/w,+/w,∑/w,x/en,ϵ,r/en,20.2/m,∗,i/en,(/w,x/en,ϵ,r/en,2/m,)/w,借/v,由/p,这个/r,式子/n,，/w,我们/r,得到/v,对/p,样本/n,属于/v,类别/n,1/m, ,的/u,预测值/n, ,f/en,1/m,(/w,x/en,)/w,=/w,1/m,+/w,0.2/m,∗,5/m,=/w,2/m,f/en,1/m,(/w,x/en,)/w,=/w,1/m,+/w,0.2/m,∗,5/m,=/w,2/m,。/w,同理/v,我们/r,可以/v,得到/v,对/p,样本/n,属于/v,类别/n,2/m,,/w,3/m,的/u,预测值/n,f/en,2/m,(/w,x/en,)/w,f/en,2/m,(/w,x/en,)/w,,/w,f/en,3/m,(/w,x/en,)/w,f/en,3/m,(/w,x/en,)/w,./w,样本/n,属于/v,类别/n,1/m,的/u,概率/n, ,即/v,为/p,p/en,1/m,=/w,exp/en,(/w,f/en,1/m,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,p/en,1/m,=/w,exp/en,(/w,f/en,1/m,(/w,x/en,)/w,)/w,//w,∑/w,k/en,=/w,13/m,exp/en,(/w,fk/en,(/w,x/en,)/w,)/w,下面/f,我们/r,用/p,代码/n,来/v,实现/v,整个/b,找/v,特征/n,的/u,过程/n,，/w,大家/r,可以/v,自己/r,再/d,对照/v,代码/n,看看/v,。/w,1/m, ,#, ,定义/n,训练/vn,数据/n, ,2/m, ,train/en,_,data/en, ,=/w, ,[/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,[/w,4.9/m,,/w,3.0/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,[/w,7.0/m,,/w,3.2/m,,/w,4.7/m,,/w,1.4/m,]/w,,/w,[/w,6.4/m,,/w,3.2/m,,/w,4.5/m,,/w,1.5/m,]/w,,/w,[/w,6.3/m,,/w,3.3/m,,/w,6.0/m,,/w,2.5/m,]/w,,/w,[/w,5.8/m,,/w,2.7/m,,/w,5.1/m,,/w,1.9/m,]/w,]/w, ,3/m, ,4/m, ,#, ,定义/n,label/en, ,5/m, ,label/en,_,data/en, ,=/w, ,[/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w,,/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w,,/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w,]/w, ,6/m, ,#, ,index/en, ,表示/v,的/u,第几/nw,类/q, ,7/m, ,def/en, ,findbestlossandsplit/en,(/w,train/en,_,data/en,,/w,label/en,_,data/en,,/w,index/en,)/w,:/w, ,8/m, ,sample/en,_,numbers/en, ,=/w, ,len/en,(/w,label/en,_,data/en,)/w, ,9/m, ,feature/en,_,numbers/en, ,=/w, ,len/en,(/w,train/en,_,data/en,[/w,0/m,]/w,)/w, ,10/m, ,current/en,_,label/en, ,=/w, ,[/w,]/w, ,11/m, ,12/m, ,#, ,define/en, ,the/en, ,minloss/en, ,13/m, ,minloss/en, ,=/w, ,10000000/m, ,14/m, ,15/m, ,#, ,feature/en, ,represents/en, ,the/en, ,dimensions/en, ,of/en, ,the/en, ,feature/en, ,16/m, ,feature/en, ,=/w, ,0/m, ,17/m, ,18/m, ,#, ,split/en, ,represents/en, ,the/en, ,detail/en, ,split/en, ,value/en, ,19/m, ,split/en, ,=/w, ,0/m, ,20/m, ,21/m, ,#, ,get/en, ,current/en, ,label/en, ,22/m, ,for/en, ,label/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,label/en,_,data/en,)/w,)/w,:/w, ,23/m, ,current/en,_,label/en,./w,append/en,(/w,label/en,_,data/en,[/w,label/en,_,index/en,]/w,[/w,index/en,]/w,)/w, ,24/m, ,25/m, ,#, ,trans/en, ,all/en, ,features/en, ,26/m, ,for/en, ,feature/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,feature/en,_,numbers/en,)/w,:/w, ,27/m, ,#,#, ,current/en, ,feature/en, ,value/en, ,28/m, ,current/en,_,value/en, ,=/w, ,[/w,]/w, ,29/m, ,30/m, ,for/en, ,sample/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,sample/en,_,numbers/en,)/w,:/w, ,31/m, ,current/en,_,value/en,./w,append/en,(/w,train/en,_,data/en,[/w,sample/en,_,index/en,]/w,[/w,feature/en,_,index/en,]/w,)/w, ,32/m, ,l/en, ,=/w, ,0/m, ,33/m, ,#,#, ,different/en, ,split/en, ,value/en, ,34/m, ,print/en, ,current/en,_,value/en, ,35/m, ,for/en, ,index/en, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,current/en,_,value/en,)/w,)/w,:/w, ,36/m, ,r/en,1/m, ,=/w, ,[/w,]/w, ,37/m, ,r/en,2/m, ,=/w, ,[/w,]/w, ,38/m, ,y/en,1/m, ,=/w, ,0/m, ,39/m, ,y/en,2/m, ,=/w, ,0/m, ,40/m, ,41/m, ,for/en, ,index/en,_,1/m, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,current/en,_,value/en,)/w,)/w,:/w, ,42/m, ,if/en, ,current/en,_,value/en,[/w,index/en,_,1/m,]/w, ,</w, ,current/en,_,value/en,[/w,index/en,]/w,:/w, ,43/m, ,r/en,1/m,./w,append/en,(/w,index/en,_,1/m,)/w, ,44/m, ,else/en,:/w, ,45/m, ,r/en,2/m,./w,append/en,(/w,index/en,_,1/m,)/w, ,46/m, ,47/m, ,#,#, ,calculate/en, ,the/en, ,samples/en, ,for/en, ,first/en, ,class/en, ,48/m, ,sum/en,_,y/en, ,=/w, ,0/m, ,49/m, ,for/en, ,index/en,_,r/en,1/m, ,in/en, ,r/en,1/m,:/w, ,50/m, ,sum/en,_,y/en, ,+/w,=/w, ,current/en,_,label/en,[/w,index/en,_,r/en,1/m,]/w, ,51/m, ,if/en, ,len/en,(/w,r/en,1/m,)/w, ,!/w,=/w, ,0/m,:/w, ,52/m, ,y/en,1/m, ,=/w, ,float/en,(/w,sum/en,_,y/en,)/w, ,//w, ,float/en,(/w,len/en,(/w,r/en,1/m,)/w,)/w, ,53/m, ,else/en,:/w, ,54/m, ,y/en,1/m, ,=/w, ,0/m, ,55/m, ,56/m, ,#,#, ,calculate/en, ,the/en, ,samples/en, ,for/en, ,second/en, ,class/en, ,57/m, ,sum/en,_,y/en, ,=/w, ,0/m, ,58/m, ,for/en, ,index/en,_,r/en,2/m, ,in/en, ,r/en,2/m,:/w, ,59/m, ,sum/en,_,y/en, ,+/w,=/w, ,current/en,_,label/en,[/w,index/en,_,r/en,2/m,]/w, ,60/m, ,if/en, ,len/en,(/w,r/en,2/m,)/w, ,!/w,=/w, ,0/m,:/w, ,61/m, ,y/en,2/m, ,=/w, ,float/en,(/w,sum/en,_,y/en,)/w, ,//w, ,float/en,(/w,len/en,(/w,r/en,2/m,)/w,)/w, ,62/m, ,else/en,:/w, ,63/m, ,y/en,2/m, ,=/w, ,0/m, ,64/m, ,65/m, ,#,#, ,trans/en, ,all/en, ,samples/en, ,to/en, ,find/en, ,minium/en, ,loss/en, ,and/en, ,best/en, ,split/en, ,66/m, ,for/en, ,index/en,_,2/m, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,current/en,_,value/en,)/w,)/w,:/w, ,67/m, ,if/en, ,index/en,_,2/m, ,in/en, ,r/en,1/m,:/w, ,68/m, ,l/en, ,+/w,=/w, ,float/en,(/w,(/w,current/en,_,label/en,[/w,index/en,_,2/m,]/w,-/w,y/en,1/m,)/w,)/w,*/w,float/en,(/w,(/w,current/en,_,label/en,[/w,index/en,_,2/m,]/w,-/w,y/en,1/m,)/w,)/w, ,69/m, ,else/en,:/w, ,70/m, ,l/en, ,+/w,=/w, ,float/en,(/w,(/w,current/en,_,label/en,[/w,index/en,_,2/m,]/w,-/w,y/en,2/m,)/w,)/w,*/w,float/en,(/w,(/w,current/en,_,label/en,[/w,index/en,_,2/m,]/w,-/w,y/en,2/m,)/w,)/w, ,71/m, ,72/m, ,if/en, ,l/en, ,</w, ,minloss/en,:/w, ,73/m, ,feature/en, ,=/w, ,feature/en,_,index/en, ,74/m, ,split/en, ,=/w, ,current/en,_,value/en,[/w,index/en,]/w, ,75/m, ,minloss/en, ,=/w, ,l/en, ,76/m, ,print/en, ,"/w,minloss/en,"/w, ,77/m, ,print/en, ,minloss/en, ,78/m, ,print/en, ,"/w,split/en,"/w, ,79/m, ,print/en, ,split/en, ,80/m, ,print/en, ,"/w,feature/en,"/w, ,81/m, ,print/en, ,feature/en, ,82/m, ,return/en, ,minloss/en,,/w,split/en,,/w,feature/en, ,83/m, ,84/m, ,findbestlossandsplit/en,(/w,train/en,_,data/en,,/w,label/en,_,data/en,,/w,0/m,)/w,3/m, ,总结/v,目前/t,，/w,我们/r,总结/v,了/u, ,gbdt/en, ,的/u,算法/n,的/u,流程/n,，/w,gbdt/en,如何/r,选择/v,特征/n,，/w,如何/r,产生/v,特征/n,的/u,组合/v,，/w,以及/c,gbdt/en, ,如何/r,用于/v,分类/vn,，/w,这个/r,目前/t,可以/v,认为/v,是/v,gbdt/en, ,最/d,经常/d,问/v,到/v,的/u,四个/m,部分/n,。/w,至于/p,剩余/vn,的/u,问题/n,，/w,因为/c,篇幅/n,的/u,问题/n,，/w,我们/r,准备/v,再/d,开/v,一个/m,篇幅/n,来/v,进行/v,总结/v,。/w,./w,practical/en, ,lessons/en, ,from/en, ,predicting/en, ,clicks/en, ,on/en, ,ads/en, ,at/en, ,facebookabstract/en,这/r,篇/q,paper/en,中/f,作者/n,结合/v,gbdt/en,和/c,lr/en,，/w,取得/v,了/u,很/d,好/a,的/u,效果/n,，/w,比/p,单个/b,模型/n,的/u,效果/n,高/a,出/v,3%/mq,。/w,随后/d,作者/n,研究/vn,了/u,对/p,整体/n,预测/v,系统/n,产生/v,影响/vn,的/u,几/m,个/q,因素/n,，/w,发现/v,feature/en,（/w,能/v,挖掘/v,出/v,用户/n,和/c,广告/n,的/u,历史/n,信息/n,）/w,+/w,model/en,（/w,gbdt/en,+/w,lr/en,）/w,的/u,贡献/n,程度/n,最/d,大/a,，/w,而/c,其他/r,因素/n,（/w,数据/n,实时性/nw,，/w,模型/n,学习/v,速率/n,，/w,数据/n,采样/v,）/w,的/u,影响/vn,则/d,较/d,小/a,。/w,1/m,./w, ,introduction/en,介绍/v,了/u,先前/t,的/u,一些/m,相关/v,paper/en,。/w,包括/v,google/en,，/w,yahoo/en,，/w,ms/en,的/u,关于/p,ctr/en, ,model/en,方面/n,的/u,paper/en,。/w,而/c,在/p,facebook/en,，/w,广告/n,系统/n,是/v,由/p,级联/n,型/k,的/u,分类器/nw,（/w,a/en, ,cascade/en, ,of/en, ,classifiers/en,）/w,组成/v,，/w,而/c,本/r,篇/q,paper/en,讨论/v,的/u,ctr/en, ,model/en,则/d,是/v,这个/r,cascade/en, ,classifiers/en,的/u,最后/f,一/m,环节/n,。/w,2/m,./w, ,experimental/en, ,setup/en,作者/n,介绍/v,了/u,如何/r,构建/v,training/en, ,data/en,和/c,testing/en, ,data/en,，/w,以及/c,evaluation/en, ,metrics/en,。/w,包括/v,normalized/en, ,entropy/en,和/c,calibration/en,。/w,normalized/en, ,entropy/en,的/u,定义/n,为/p,每次/r,展现/v,时/ng,预测/v,得到/v,的/u,log/en, ,loss/en,的/u,平均值/n,，/w,除/p,以/p,对/p,整个/b,数据集/nw,的/u,平均/a,log/en, ,loss/en,值/n,。/w,之所以/c,需要/v,除/p,以/p,整个/b,数据集/nw,的/u,平均/a,log/en, ,loss/en,值/n,，/w,是因为/c,backgroud/en, ,ctr/en,越/d,接近/v,于/p,0/m,或/c,1/m,，/w,则/d,越/d,容易/a,预测/v,取得/v,较/d,好/a,的/u,log/en, ,loss/en,值/n,，/w,而/c,做/v,了/u,normalization/en,后/f,，/w,ne/en,便/d,会/v,对/p,backgroud/en, ,ctr/en,不/d,敏感/a,了/u,。/w,这个/r,normalized/en, ,entropy/en,值越/nw,低/a,，/w,则/d,说明/v,预测/v,的/u,效果/n,越/d,好/a,。/w,下面/f,列出/v,表达/v,式/k,：/w,calibration/en,的/u,定义/n,为/p,预估/v,ctr/en,除/p,以/p,真实/a,ctr/en,，/w,即/v,预测/v,的/u,点击/v,数/m,除/p,以/p,真实/a,观察/v,到/v,的/u,点击数/n,。/w,这个/r,值越/nw,接近/v,1/m,，/w,则/d,表明/v,预测/v,效果/n,越/d,好/a,。/w,3/m,./w, ,prediction/en, ,model/en, ,structure/en,作者/n,介绍/v,了/u,两种/mq,online/en, ,learning/en,的/u,方法/n,。/w,包括/v,stochastic/en, ,gradient/en, ,descent/en,（/w,sgd/en,）/w,-/w,based/en, ,lr/en,：/w,和/c,bayesian/en, ,online/en, ,learning/en, ,scheme/en, ,for/en, ,probit/en, ,regression/en,（/w,bopr/en,）/w,：/w,bopr/en,每/r,轮/q,迭代/vn,时/ng,的/u,更新/v,公式/n,为/p,：/w,3.1/m, ,decision/en, ,tree/en, ,feature/en, ,transformslinear/en, ,model/en,的/u,表达/v,能力/n,不够/a,，/w,需要/v,feature/en, ,transformation/en,。/w,第一/m,种/q,方法/n,是/v,对/p,连续/a,feature/en,进行/v,分段/vn,处理/v,（/w,怎样/r,分段/vn,，/w,以及/c,分段/vn,的/u,分界点/nw,是/v,很/d,重要/a,的/u,）/w,；/w,第二/m,种/q,方法/n,是/v,进行/v,特征/n,组合/v,，/w,包括/v,对/p,离散/vn,feature/en,做笛/nw,卡尔积/nr,，/w,或者/c,对/p,连续/a,feature/en,使用/v,联合/v,分段/vn,（/w,joint/en, ,binning/en,）/w,，/w,比如/v,使用/v,k/en,-/w,d/en, ,tree/en,。/w,而/c,使用/v,gbdt/en,能/v,作为/v,一种/mq,很/d,好/a,的/u,feature/en, ,transformation/en,的/u,工具/n,，/w,我们/r,可以/v,把/p,gbdt/en,中/f,的/u,每/r,棵/q,树/v,作为/v,一种/mq,类别/n,的/u,feature/en,，/w,把/p,一个/m,instance/en,经过/p,gbdt/en,的/u,流程/n,（/w,即/v,从/p,根/q,节点/n,一直/d,往/p,下/f,分叉/n,到/v,一个/m,特定/b,的/u,叶子/n,节点/n,）/w,作为/v,一个/m,instance/en,的/u,特征/n,组合/v,的/u,过程/n,。/w,这里/r,gbdt/en,采用/v,的/u,是/v,gradient/en, ,boosting/en, ,machine/en, ,+/w, ,l/en,2/m,-/w,treeboost/en,算法/n,。/w,这里/r,是/v,本篇/r,paper/en,的/u,重点/n,部分/n,，/w,放/v,一张/mq,经典/n,的/u,原图/nz,：/w,3.2/m, ,data/en, ,freshnessctr/en,预估/v,系统/n,是/v,在/p,一个/m,动态/n,的/u,环境/n,中/f,，/w,数据/n,的/u,分布/v,随时/d,在/p,变化/vn,，/w,所以/c,本文/r,探讨/v,了/u,data/en, ,freshness/en,对/p,预测/v,效果/n,的/u,影响/vn,，/w,表明/v,training/en, ,data/en,的/u,日期/n,越/d,靠近/v,，/w,效果/n,越/d,好/a,。/w,3.3/m, ,online/en, ,linear/en, ,classifier/en,探讨/v,了/u,对/p,sgd/en,-/w,based/en, ,lr/en,中/f,learning/en, ,rate/en,的/u,选择/v,。/w,最/d,好/a,的/u,选择/v,为/p,：/w,1/m,）/w,global/en,效果/n,差/a,的/u,原因/n,：/w,每个/r,维度/n,上/f,训练/vn,样本/n,的/u,不/d,平衡/a,，/w,每个/r,训练/vn,样本/n,拥有/v,不同/a,的/u,feature/en,。/w,那些/r,拥有/v,样本/n,数/m,较/d,少/a,的/u,维度/n,的/u,learning/en, ,rate/en,下降/v,过/u,快/a,，/w,导致/v,无法/v,收敛/vn,到/v,最优/ad,值/n,。/w,2/m,）/w,per/en, ,weight/en,差/a,的/u,原因/n,：/w,虽然/c,对于/p,各个/r,维度/n,有所/v,区分/v,，/w,但是/c,其/r,对于/p,各个/r,维度/n,的/u,learning/en, ,rate/en,下降/v,速度/n,都/d,太/d,快/a,了/u,，/w,训练/vn,过早/d,结束/v,，/w,无法/v,收敛/vn,到/v,最优/ad,值/n,。/w,sgd/en,-/w,based/en, ,lr/en, ,vs/en, ,bopr/en,1/m,）/w,sgd/en,-/w,based/en, ,lr/en,对比/v,bopr/en,的/u,优势/n,：/w,1/m,-/w,1/m,）/w,模型/n,参数/n,少/a,，/w,内存/n,占用/v,少/a,。/w,sgd/en,-/w,based/en, ,lr/en,每个/r,维度/n,只/d,有/v,一个/m,weight/en,值/n,，/w,而/c,bopr/en,每个/r,维度/n,有/v,1个/m,均值/n, ,+/w, ,1个/m,方差值/nw,。/w,1/m,-/w,2/m,）/w,计算/v,速度/n,快/a,。/w,sgd/en,-/w,lr/en,只/d,需/v,1次/mq,内/f,积/v,计算/v,，/w,bopr/en,需要/v,2次/mq,内/f,积/v,计算/v,。/w,2/m,）/w,bopr/en,对比/v,sgd/en,-/w,based/en, ,lr/en,的/u,优势/n,：/w,2/m,-/w,1/m,）/w,bopr/en,可以/v,得到/v,完整/a,的/u,预测/v,点击/v,概率/n,分布/v,。/w,4/m, ,online/en, ,data/en, ,joineronline/en, ,data/en, ,joiner/en,主要/b,是/v,用于/v,在线/vn,的/u,将/d,label/en,与/p,相应/v,的/u,features/en,进行/v,join/en,。/w,同时/c,作者/n,也/d,介绍/v,了/u,正负/n,样本/n,的/u,选取/v,方式/n,，/w,以及/c,选取/v,负/v,样本/n,时候/n,的/u,waiting/en, ,time/en, ,window/en,的/u,选择/v,。/w,5/m, ,containing/en, ,memory/en, ,and/en, ,latency/en,作者/n,探讨/v,了/u,gbdt/en,中/f,tree/en,的/u,个数/n,，/w,各种/r,类型/n,的/u,features/en,（/w,包括/v,contextual/en, ,features/en,和/c,historical/en, ,features/en,）/w,，/w,对/p,预测/v,效果/n,的/u,影响/vn,。/w,结论/n,如下/v,：/w,1/m,）/w,ne/en,的/u,下降/v,基本/a,来自/v,于/p,前/f,500棵/mq,树/v,。/w,2/m,）/w,最后/f,1000棵/mq,树/v,对/p,ne/en,的/u,降低/v,贡献/n,低于/v,0.1%/mq,。/w,3/m,）/w,submodel/en, ,2/m, ,过/u,拟合/nz,，/w,数据量/n,较/d,少/a,，/w,只有/c,其余/r,2个/m,模型/n,的/u,约/d,四分之一/nw,。/w,4/m,）/w,importance/en,为/p,feature/en,带来/v,的/u,累积/vn,信息/n,增益/v, ,//w, ,平方差/n,的/u,减少/v,5/m,）/w,top/en, ,10/m, ,features/en,贡献/n,了/u,将近/d,一半/m,的/u,importance/en,6/m,）/w,最后/f,的/u,300个/m,features/en,的/u,贡献/n,不足/a,1%/mq,6/m, ,copying/en, ,with/en, ,massive/en, ,traning/en, ,data/en,作者/n,探讨/v,了/u,如何/r,进行/v,样本/n,采样/v,的/u,过程/n,，/w,包括/v,了/u,均匀/ad,采样/v,（/w,uniform/en, ,subsampling/en,）/w,，/w,和/c,负/v,样本/n,降/v,采样/v,（/w,negative/en, ,down/en, ,sampling/en,）/w,，/w,以及/c,对/p,预测/v,效果/n,的/u,影响/vn,。/w,一/m,./w, ,gbdt/en,的/u,经典/n,paper/en,：/w,《/w,greedy/en, ,function/en, ,approximation/en,：/w,a/en, ,gradient/en, ,boosting/en, ,machine/en,》/w,abstractfunction/en, ,approximation/en,是从/v,function/en, ,space/en,方面/n,进行/v,numerical/en, ,optimization/en,，/w,其将/nt,stagewise/en, ,additive/en, ,expansions/en,和/c,steepest/en,-/w,descent/en, ,minimization/en,结合/v,起来/v,。/w,而/c,由此/d,而/c,来/v,的/u,gradient/en, ,boosting/en, ,decision/en, ,tree/en,（/w,gbdt/en,）/w,可以/v,适用/v,于/p,regression/en,和/c,classification/en,，/w,都/d,具有/v,完整/a,的/u,，/w,鲁棒性/nz,高/a,，/w,解释性/n,好/a,的/u,优点/n,。/w,1/m,./w, ,function/en, ,estimation/en,在/p,机器/n,学习/v,的/u,任务/n,中/f,，/w,我们/r,一般/a,面对/v,的/u,问题/n,是/v,构造/v,loss/en, ,function/en,，/w,并/c,求解/v,其/r,最小值/nz,。/w,可以/v,写/v,成/v,如下/v,形式/n,：/w,通常/d,的/u,loss/en, ,function/en,有/v,：/w,1/m,./w, ,regression/en,：/w,均方/nw,误差/n,(/w,y/en,-/w,f/en,)/w,2/m,，/w,绝对/d,误差/n,|/w,y/en,-/w,f/en,|/w,2/m,./w, ,classification/en,：/w,negative/en, ,binomial/en, ,log/en,-/w,likelihood/en, ,log/en,(/w,1/m,+/w,e/en,-/w,2/m,yf/en,)/w,一般/a,情况/n,下/f,，/w,我们/r,会/v,把/p,f/en,(/w,x/en,)/w,看做/v,是/v,一系列/mq,带/v,参数/n,的/u,函数/n,集合/v, ,f/en,(/w,x/en,;/w,p/en,)/w,，/w,于是/c,进一步/d,将/d,其/r,表示/v,为/p,“/w,additive/en,”/w,的/u,形式/n,：/w,1.1/m, ,numerical/en, ,optimizatin/en,我们/r,可以/v,通过/p,选取/v,一个/m,参数/n,模型/n,f/en,(/w,x/en,;/w,p/en,)/w,，/w,来/v,将/d,function/en, ,optimization/en,问题/n,转化/v,为/p,一个/m,parameter/en, ,optimization/en,问题/n,：/w,进一步/d,，/w,我们/r,可以/v,把/p,要/v,优化/v,的/u,参数/n,也/d,表示/v,为/p,“/w,additive/en,”/w,的/u,形式/n,：/w,1.2/m, ,steepest/en,-/w,descent/en,梯度/n,下降/v,是/v,最/d,简单/a,，/w,最/d,常用/a,的/u,numerical/en, ,optimization/en, ,method/en,之一/r,。/w,首先/d,，/w,计算/v,出/v,当前/t,的/u,梯度/n,：/w,where/en,而/c,梯度/n,下降/v,的/u,步长/nz,为/p,：/w,where/en, ,，/w,称为/v,“/w,line/en, ,search/en,”/w,。/w,2/m,./w, ,numerical/en, ,optimization/en, ,in/en, ,function/en, ,space/en,现在/t,，/w,我们/r,考虑/v,“/w,无/v,参数/n,”/w,模型/n,，/w,转而/c,考虑/v,直接/ad,在/p,function/en, ,space/en, ,进行/v,numerical/en, ,optimization/en,。/w,这时候/r,，/w,我们/r,将/d,在/p,每个/r,数据点/nw,x/en,处/n,的/u,函数/n,值/n,f/en,(/w,x/en,)/w,看做/v,是/v,一个/m,“/w,参数/n,”/w,，/w,仍然/d,是/v,来/v,对/p,loss/en, ,funtion/en,求解/v,最小值/nz,。/w,在/p,function/en, ,space/en,，/w,为了/p,表示/v,一个/m,函数/n,f/en,(/w,x/en,)/w,，/w,理想/n,状况/n,下/f,有/v,无数/m,个/q,点/q,，/w,但/c,在/p,现实/n,中/f,，/w,我们/r,用/p,有限/a,个/q,(/w,n/en,个/q,）/w,离散/vn,点/q,来/v,表示/v,它/r,：/w,。/w,按照/p,之前/f,的/u,numerical/en, ,optimization/en,的/u,方式/n,，/w,我们/r,需要/v,求解/v,：/w,使用/v,steepest/en,-/w,descent/en,，/w,有/v,：/w,where/en, ,，/w,and/en,3/m,./w, ,finite/en, ,data/en,当/p,我们/r,面对/v,的/u,情况/n,为/p,：/w,用/p,有限/a,的/u,数据集/nw,表示/v,x/en,，/w,y/en,的/u,联合/v,分布/v,的/u,时候/n,，/w,上述/b,的/u,方法/n,就/d,有点/d,行不通/v,了/u,。/w,我们/r,可以/v,试试/v,“/w,greedy/en,-/w,stagewise/en,”/w,的/u,方法/n,：/w,但是/c,对于/p,一般/a,的/u,loss/en, ,function/en,和/c,base/en, ,learner/en,来说/u,，/w,（/w,9/m,）/w,式/k,是/v,很/d,难/a,求解/v,的/u,。/w,给/p,定/v,了/u,m/en,次/q,迭代/vn,后/f,的/u,当前/t,近似/a,函数/n,fm/en,-/w,1/m,(/w,x/en,)/w,，/w,当/p,步长/nz,的/u,direction/en,是/v,指数/n,函数/n,集合/v,当中/f,的/u,一员/mq,时/ng,，/w,可以/v,看做/v,是/v,在/p,求解/v,最/d,优值/nw,上/f,的/u,greedy/en, ,step/en,，/w,同样/d,，/w,它/r,也/d,可以/v,被/p,看做/v,是/v,相同/a,限制/v,下/f,的/u,steepest/en,-/w,descent/en, ,step/en,。/w,作为/v,比较/d,，/w,给/p,出/v,了/u,在/p,无/v,限制/v,条件/n,下/f,，/w,在/p,fm/en,-/w,1/m,(/w,x/en,)/w,处/n,的/u,steepest/en,-/w,descent/en, ,step/en, ,direction/en,。/w,一种/mq,行之有效/i,的/u,方法/n,就/d,是/v,在/p,求解/v,的/u,时候/n,，/w,把/p,它/r,取/v,为/p,无/v,限制/v,条件/n,下/f,的/u,负/v,梯度/n,方向/n,：/w,where/en,这/r,就/d,把/p,（/w,9/m,）/w,式/k,中/f,较/d,难/a,求解/v,的/u,优化/v,问题/n,转化/v,为了/p,一个/m,基于/p,均方/nw,误差/n,的/u,拟合/nz,问题/n,。/w,gradient/en, ,boosting/en,的/u,通用/vn,解法/n,如下/v,：/w,二/m,./w, ,对于/p,gbdt/en,的/u,一些/m,理解/v,1/m,./w, ,boostinggbdt/en,的/u,全称/n,是/v,gradient/en, ,boosting/en, ,decision/en, ,tree/en,，/w,gradient/en, ,boosting/en,和/c,decision/en, ,tree/en,是/v,两个/m,独立/v,的/u,概念/n,。/w,因此/c,我们/r,先/d,说说/v,boosting/en,。/w,boosting/en,的/u,概念/n,很/d,好/a,理解/v,，/w,意思/n,是/v,用/p,一些/m,弱分类器/nw,的/u,组合/v,来/v,构造/v,一个/m,强分类器/nw,。/w,因此/c,，/w,它/r,不/d,是/v,某个/r,具体/a,的/u,算法/n,，/w,它/r,说/v,的/u,是/v,一种/mq,理念/n,。/w,和/c,这个/r,理念/n,相/d,对应/v,的/u,是/v,一次性/d,构造/v,一个/m,强分类器/nw,。/w,像/v,支持/v,向量/n,机/ng,，/w,逻辑/n,回归/v,等/u,都/d,属于/v,后者/r,。/w,通常/d,，/w,我们/r,通过/p,相加/v,来/v,组合/v,分类器/nw,，/w,形式/n,如下/v,：/w,2/m,./w, ,gradient/en, ,boosting/en, ,modeling/en,（/w,gbm/en,）/w,给/p,定/v,一个/m,问题/n,，/w,我们/r,如何/r,构造/v,这些/r,弱分类器/nw,呢/y,?/w,gradient/en, ,boosting/en, ,modeling/en, ,(/w,gbm/en,)/w, ,就/d,是/v,构造/v, ,这些/r,弱/a,分类/vn,的/u,一种/mq,方法/n,。/w,同样/d,，/w,它/r,指/v,的/u,不/d,是/v,某个/r,具体/a,的/u,算法/n,，/w,仍然/d,只/d,是/v,一个/m,理念/n,。/w,在/p,理解/v, ,gradient/en, ,boosting/en, ,modeling/en, ,之前/f,，/w,我们/r,先/d,看看/v,一个/m,典型/n,的/u,优化/v,问题/n,:/w,针对/p,这种/r,优化/v,问题/n,，/w,有/v,一个/m,经典/n,的/u,算法/n,叫/v, ,steepest/en, ,gradient/en, ,descent/en,，/w,也/d,就/d,是/v,最深/d,梯度/n,下降/v,法/j,。/w, ,这个/r,算法/n,的/u,过程/n,大致/d,如下/v,:/w,以上/f,迭代/vn,过程/n,可以/v,这么/r,理解/v,:/w,整个/b,寻优/nw,的/u,过程/n,就/d,是/v,个/q,小/a,步/q,快/a,跑/v,的/u,过程/n,，/w,每/r,跑/v,一/m,小/a,步/q,，/w,都/d,往/p,函数/n,当前/t,下降/v,最/d,快/a,的/u,那个/r,方向/n,走/v,一点/m,。/w,这样/r,寻优/nw,得到/v,的/u,结果/n,可以/v,表示/v,成加/nr,和/c,形式/n,，/w,即/v,:/w,这个/r,形式/n,和/c,以上/f,fm/en,(/w,x/en,)/w,是/v,不/d,是/v,非常/d,相似/a,?/w, ,gradient/en, ,boosting/en, ,正是/v,由此/d,启发/v,而/c,来/v,。/w, ,构造/v,fm/en,(/w,x/en,)/w,本身/r,也/d,是/v,一个/m,寻优/nw,的/u,过程/n,，/w,只不过/d,我们/r,寻找/v,的/u,不/d,是/v,一个/m,最/d,优点/n,，/w,而是/c,一个/m,最/d,优/ag,的/u,函数/n,。/w,优化/v,的/u,目标/n,通常/d,都/d,是/v,通过/p,一个/m,损失/n,函数/n,来/v,定义/n,，/w,即/v,:/w,其中/r,loss/en,(/w,f/en,(/w,xi/en,)/w,,/w, ,yi/en,)/w,表示/v,损失/n,函数/n,loss/en,在/p,第/m,i/en,个/q,样本/n,上/f,的/u,损失值/nw,，/w,xi/en,和/c,yi/en,分别/d,表示/v,第/m, ,i/en, ,个/q,样本/n,的/u,特征/n,和/c,目标值/n,。/w,常见/a,的/u,损失/n,函数/n,如/v,平方差函数/nw,:/w,类似/v,最/d,深/a,梯度/n,下降/v,法/j,，/w,我们/r,可以/v,通过/p,梯度/n,下降/v,法/j,来/v,构造/v,弱分类器/nw,f/en,1/m,,/w, ,f/en,2/m,,/w, ,./w,./w,./w, ,,/w, ,fm/en,，/w,只不过/d,每次/r,迭代/vn,时/ng,，/w,令/v,即/v,对/p,损失/n,函数/n,l/en,，/w,以/p, ,f/en, ,为/p,参考/v,求/v,取/v,梯度/n,。/w,这里/r,有/v,个/q,小/a,问题/n,，/w,一个/m,函数/n,对/p,函数/n,的/u,求导/nw,不好/a,理解/v,，/w,而且/c,通常/d,都/d,无法/v,通过/p,上述/b,公式/n,直接/ad,求解/v, ,到/v,梯度/n,函数/n,gi/en,。/w,为此/l,，/w,采取/v,一个/m,近似/a,的/u,方法/n,，/w,把/p,函数/n,fi/en,−,1/m,理解/v,成/v,在/p,所有/b,样本/n,上/f,的/u,离散/vn,的/u,函数/n,值/n,，/w,即/v,:/w,不难/d,理解/v,，/w,这/r,是/v,一个/m, ,n/en, ,维/q,向量/n,，/w,然后/c,计算/v,这/r,是/v,一个/m,函数/n,对/p,向量/n,的/u,求导/nw,，/w,得到/v,的/u,也/d,是/v,一个/m,梯度/n,向量/n,。/w,注意/v,，/w,这里/r,求导/nw,时/ng,的/u,变量/n,还是/c,函数/n,f/en,，/w,不/d,是/v,样本/n,xk/en,。/w,严格/ad,来说/u, ,g/en,̂,i/en,(/w,xk/en,)/w, ,for/en, ,k/en, ,=/w, ,1/m,,/w,2/m,,/w, ,./w,./w,./w, ,,/w, ,n/en, ,只是/d,描述/v,了/u,gi/en,在/p,某些/r,个别/a,点/q,上/f,的/u,值/n,，/w,并/c,不/d,足以/d,表达/v,gi/en,，/w,但/c,我们/r,可以/v,通过/p,函数/n,拟合/nz,的/u,方法/n,从/p,g/en,̂,i/en,(/w,xk/en,)/w, ,for/en, ,k/en, ,=/w, ,1/m,,/w,2/m,,/w, ,./w,./w,./w, ,,/w, ,n/en, ,构造/v,gi/en,，/w,这样/r,我们/r,就/d,通过/p,近似/a,的/u,方法/n,得到/v,了/u,函数/n,对/p,函数/n,的/u,梯度/n,求导/nw,。/w,因此/c, ,gbm/en, ,的/u,过程/n,可以/v,总结/v,为/p,如下/v,:/w,常量/n,函数/n,f/en,0/m,通常/d,取/v,样本/n,目标值/n,的/u,均值/n,，/w,即/v,3/m,./w, ,gradient/en, ,boosting/en, ,decision/en, ,tree/en,以上/f, ,gradient/en, ,boosting/en, ,modeling/en, ,的/u,过程/n,中/f,，/w,还/d,没有/v,说/v,清楚/a,如何/r,通过/p,离散/vn,值/n, ,g/en,̂,i/en,−,1/m,(/w,xj/en,)/w, ,for/en, ,j/en, ,=/w, ,1/m,,/w,2/m,,/w,3/m,,/w,./w,./w,./w,n/en, ,构造/v,拟合/nz,函数/n,gi/en,−,1/m,。/w,函数/n,拟合/nz,是/v,个/q,比较/d,熟知/v,的/u,概念/n,，/w,有/v,很多/m,现成/b,的/u,方法/n,，/w,不过/c,有/v,一种/mq,拟合/nz,方法/n,广为/d,应用/vn,，/w,那/r,就/d,是/v,决策/n,树/v, ,decision/en, ,tree/en,，/w,有关/vn,决策/n,树/v,的/u,概念/n,，/w,理解/v,gbdt/en,重点/n,首先/d,是/v,gradient/en, ,boosting/en,，/w,其次/c,才/d,是/v, ,decision/en, ,tree/en,。/w,gbdt/en, ,是/v, ,gradient/en, ,boosting/en, ,的/u,一种/mq,具体/a,实例/n,，/w,只不过/d,这里/r,的/u,弱分类器/nw,是/v,决策/n,树/v,。/w,如果/c,你/r,改用/v,其他/r,弱/a,分类器/nw, ,xyz/en,，/w,你/r,也/d,可以/v,称之为/v, ,gradient/en, ,boosting/en, ,xyz/en,。/w,只不过/d, ,decision/en, ,tree/en, ,很/d,好/a,用/p,，/w,gbdt/en, ,才/d,如此/r,引人注目/i,。/w,4/m,./w,