0/m,./w, ,前言/n,1/m,./w, ,损失/n,函数/n,2/m,./w, ,margin/en,3/m,./w, ,cross/en,-/w,entropy/en, ,vs/en,./w, ,squared/en, ,error/en,总结/v,参考/v,资料/n,0/m,./w, ,前言/n,“/w,尽管/c,新/a,技术/n,新/a,算法/n,层出不穷/i,，/w,但是/c,掌握/v,好/a,基础/n,算法/n,就/d,能/v,解决/v,手头/n, ,90%/mq, ,的/u,机器/n,学习/v,问题/n,。/w,”/w,本/r,系列/q,参考书/n, ,"/w,hands/en,-/w,on/en, ,machine/en, ,learning/en, ,with/en, ,scikit/en,-/w,learn/en, ,and/en, ,tensorflow/en,"/w,以及/c,kaggle/en,相关/v,资料/n,，/w,但是/c,这/r,篇/q,文章/n,没有/v,参考/v,，/w,🤣/nw,“/w,观察/v,到/v,的/u,一个/m,有意思/l,的/u,细节/n,：/w,一些/m,喜好/v,机器/n,学习/v,或者/c,数据/n,科学/n,的/u,初学/v,工程师/n,和/c,有/v,机器/n,学习/v,或者/c,数据/n,科学/n,背景/n,的/u,科学家/n,，/w,在/p,工作/vn,上/f,的/u,主要/b,区别/n,在于/v,如何/r,对待/v,负面/b,的/u,实验/vn,（/w,包括/v,线/n,下/f,和/c,线/n,上/f,）/w,结果/n,。/w,初/f,学者/n,往往/d,就/d,开始/v,琢磨/v,如何/r,改/v,模型/n,，/w,加/v,feature/en,，/w,调/v,参数/n,；/w,思考/v,如何/r,从/p,简单/a,模型/n,转换/v,到/v,复杂/a,模型/n,。/w,有/v,经验/n,的/u,人/n,往往/d,更加/d,去/v,了解/v,实验/vn,的/u,设置/v,有/v,没有/v,问题/n,；/w,实验/vn,的/u,metrics/en,的/u,comparison/en,是/v,到底/d,怎么/r,计算/v,的/u,；/w,到/v,真/d,需要/v,去/v,思考/v,模型/n,的/u,问题/n,的/u,时候/n,，/w,有/v,经验/n,的/u,人/n,往往/d,会/v,先/d,反思/v,训练/vn,数据/n,的/u,收集/v,情况/n,，/w,测试/vn,数据/n,和/c,测试/vn,评测/vn,的/u,真实度/nw,问题/n,。/w,初/f,学者/n,有点/d,类似/v,程咬金/nr,的/u,三板/mq,斧/ng,，/w,有/v,那么/r,几/m,个/q,技能/n,，/w,用/p,完/v,了/u,，/w,要是/c,还/d,没有/v,效果/n,，/w,也/d,就/d,完/v,了/u,。/w,而/c,有/v,经验/n,的/u,数据科学家/nw,，/w,往往/d,是/v,从/p,问题/n,出发/v,，/w,去/v,看/v,是/v,不/d,是/v,对/p,问题/n,本质/n,的/u,把握/v,（/w,比如/v,优化/v,的/u,目标/n,是/v,不/d,是/v,对/p,；/w,有/v,没/d,有/v,counterfactual/en,的/u,情况/n,）/w,出现/v,了/u,偏差/n,，/w,最后/f,再/d,讨论/v,模型/n,。/w,”/w,——/w, ,by/en, ,@/w,洪亮/a,劼,1/m,./w, ,损失/n,函数/n,前面/f,一篇/mq,讨论/v,了/u,prc/en,、/w,roc/en,、/w,auc/en,等/u,评测/vn,模型/n,的/u,不同/a,侧重点/n,，/w,另外/c,一方面/c,，/w,模型/n,损失/n,函数/n,（/w,目标/n,函数/n,）/w,是/v,机器/n,学习/v,里/f,另外/c,一个/m,较为/d,本质/n,的/u,问题/n,，/w,由于/c,机器/n,学习/v,的/u,损失/n,函数/n,根据/p,任务/n,、/w,模型/n,的/u,不同/a,，/w,演化/vn,出/v,各种/r,形式/n,，/w,下面/f,只/d,谈谈/v,分类/vn,模型/n,里/f,常见/a,的/u,情形/n,。/w,假设/v,一个/m,二/m,分类/vn,问题/n,，/w,样本/n,空间/n,是/v, ,y/en,=/w,{/w,-/w,1/m,,/w,1/m,}/w,，/w,一个/m,分类/vn,模型/n,对/p,其/r,进行/v,预测/v,，/w,输出/v,值/n,是/v,f/en,(/w,x/en,)/w,，/w,f/en, ,>, ,0/m, ,判定/v,为/p,1/m,，/w,f/en, ,</w, ,0/m,判定/v,为/p, ,-/w,1/m,。/w,计算/v,模型/n,预测/v,准确率/n,的/u,时候/n,，/w,样本/n,真实/a,分类/vn, ,y/en, ,如果/c,和/c, ,f/en, ,符号/n,相同/a,，/w,则/d,表示/v,分类/vn,正确/a,，/w,符号/n,相反/v,，/w,则/d,模型/n,分类/vn,错误/n,。/w,表示/v,成/v,分类/vn,误差/n,，/w,可/v,记/v,为/p, ,if/en, ,y/en, ,*/w, ,f/en,(/w,x/en,)/w, ,>, ,0/m, ,then/en, ,error/en, ,=/w, ,0/m, ,else/en, ,error/en, ,=/w, ,1/m,。/w,实际/n,情况/n,中/f,，/w,极少/d,看到/v,直接/ad,用/p,分类/vn,误差/n,作为/v,模型/n,的/u,目标/n,函数/n,，/w,原因/n,主要/b,有/v,几/m,点/q,，/w,其一/r,，/w,loss/en, ,=/w, ,0/m, ,or/en, ,1/m, ,是/v,平行/vn,于/p, ,x/en, ,轴/q,的/u,射线/n,，/w,求导/nw,为/p, ,0/m,（/w,原点/n,除外/v,）/w,，/w,没法/v,用/p,梯度/n,下降/v,法/j,来/v,优化/v,模型/n,，/w,而/c,实际上/d,这/r,是/v,个/q,np/en,-/w,hard/en,离散/vn,的/u,非凸优化/nw,问题/n,。/w,其二/r,，/w,要/v,训练/vn,一个/m,好/a,的/u,模型/n,还要/v,让/v,模型/n,感知/v,到/v,，/w,某个/r,样本/n,尽管/c,分类/vn,正确/a,了/u,，/w,但是/c,到底/d,有/v,多/a,“/w,正确/a,”/w,，/w,如果/c,确信度/nw,低/a,了/u,还/d,需要/v,继续/v,优化/v,。/w,举/v,个/q,例子/n,：/w,有/v,三种/mq,水果/n,，/w,两种/mq,模型/n,都/d,进行/v,了/u,训练/vn,，/w,在/p,测试/vn,集/vg,上/f,概率/n,分布/v,表现/v,如下/v,：/w,模型/n,a/en,：/w,预测/v,概率/n,真实/a,概率/n,分类/vn,误差/n,0.3/m, ,0.3/m, ,0.40/m, ,0/m, ,1/m, ,(/w,苹果/n,)/w,00.3/m, ,0.4/m, ,0.30/m, ,1/m, ,0/m, ,(/w,梨子/n,)/w,00.1/m, ,0.2/m, ,0.71/m, ,0/m, ,0/m, ,(/w,桃子/n,)/w,1/m,模型/n,b/en,：/w,预测/v,概率/n,真实/a,概率/n,分类/vn,误差/n,0.1/m, ,0.2/m, ,0.70/m, ,0/m, ,1/m, ,(/w,苹果/n,)/w,00.1/m, ,0.8/m, ,0.10/m, ,1/m, ,0/m, ,(/w,梨子/n,)/w,00.4/m, ,0.5/m, ,0.11/m, ,0/m, ,0/m, ,(/w,桃子/n,)/w,1目/mq,测/v,可以/v,看出/v,，/w,模型/n,a/en,和/c,模型/n,b/en,分类/vn,误差/n,都/d,是/v,0.333/m,，/w,但是/c,模型/n,b/en,更/d,“/w,靠谱/nw,”/w,一些/m,。/w,问题/n,来/v,了/u,，/w,这个/r,“/w,靠谱/nw,”/w,如何/r,衡量/v,？/w,2/m,./w, ,marginmargin/en, ,是/v,衡量/v,某次/r,预测/v,到底/d,有/v,多/a,“/w,准确/a,”/w,的/u,一个/m,指标/n,，/w,定义/n,为/p, ,y/en,*/w,f/en,(/w,x/en,)/w,。/w,简单/a,说/v,，/w,希望/v,正/d,样本/n,预测/v,值/n,为/p,正/d,尽量/d,大/a,，/w,负/v,样本/n,预测/v,值/n,为/p,负/v,尽量/d,小/a,，/w,就/d,需要/v,模型/n, ,max/en, ,margin/en,。/w,以/p,margin/en,作为/v,横轴/nw,，/w,黑色/n,表示/v,分类/vn,loss/en,，/w,红色/n,表示/v,log/en, ,loss/en,，/w,蓝色/n,表示/v, ,hinge/en, ,loss/en,，/w,绿色/n,表示/v, ,square/en, ,error/en,，/w,可以/v,看到/v,随着/p, ,margin/en, ,变/v,大/a,，/w,loss/en, ,总体/n,是/v,单调/a,递减/vn,的/u,，/w,但是/c, ,squared/en, ,error/en, ,超过/v,1/m,后/f,会/v,递增/v,：/w,从/p,上图/n,可以/v,看到/v,，/w,hinge/en, ,loss/en, ,在/p,margin/en,达到/v,一定/d,阈值/n,后/f,（/w,很/d,确信/v,分类/vn,正确/a,的/u,样本/n,）/w,，/w,loss/en,降/v,为/p,0/m,，/w,对/p,整个/b,模型/n,训练/vn,其实/d,已经/d,没有/v,影响/vn,了/u,。/w,log/en, ,loss/en, ,不管/c,margin/en,多大/nrf,，/w,loss/en,永远/d,不/d,会/v,降/v,为/p,0/m,，/w,会/v,一直/d,对/p,模型/n,有/v,影响/vn,。/w,squared/en, ,error/en, ,里/f,，/w,如果/c,f/en,(/w,x/en,)/w, ,输出/v,绝对值/n,可以/v,大于/v,1/m,，/w,那么/r,margin/en,太/d,大/a,的/u,点/q,，/w,对/p,模型/n,反而/d,有/v,不好/a,的/u,影响/vn,：/w,中场/s,休息/v,时间/n,。/w,。/w,。/w,喝口/nw,茶/n,~/w, ,欢迎/v,关注/v,公众/n,号/q,：/w,kaggle/en,实战/n,，/w,或/c,博客/n,：/w,http/en,:/w,//w,//w,www/en,./w,cnblogs/en,./w,com/en,//w,daniel/en,-/w,d/en,//w,3/m,./w, ,cross/en,-/w,entropy/en, ,vs/en,./w, ,squared/en, ,errorcross/en,-/w,entropy/en, ,可以/v,简单/a,理解/v,为/p,上面/f,的/u, ,log/en, ,loss/en,，/w,在/p,深度/n,学习/v,里面/f,，/w,最后/f,一层/mq,往往/d,是/v,通过/p, ,softmax/en, ,计算/v,出/v,概率/n,分布/v,margin/en,区间/n,为/p,[/w,0/m,,/w,1/m,]/w,。/w,squared/en, ,error/en, ,并/c,不/d,存在/v,上述/b, ,margin/en, ,太/d,大/a,的/u,点/q,对/p,模型/n,反而/d,有/v,负面/b,影响/vn,的/u,情况/n,，/w,这时候/r,该/r,采用/v, ,cross/en,-/w,entropy/en, ,or/en, ,squared/en, ,error/en,?/w,结论/n,是/v,如果/c,你/r,使用/v,的/u,是/v,神经/n,网络/n,的/u,分类/vn,模型/n,，/w,建议/n,使用/v, ,cross/en,-/w,entropy/en,。/w,做/v,分类/vn,任务/n,的/u,深度/n,神经/n,网络/n,，/w,最后/f,一层/mq,一般/a,为/p,softmax/en,，/w,softmax/en, ,计算/v,公式/n,如下/v,：/w,一般/a,采用/v,反向/f,传播/vn,的/u,梯度/n,下降/v,方法/n,优化/v,，/w,下面/f,先/d,把/p, ,softmax/en, ,的/u,计算/v,过程/n,逐步/d,剖析/vn,开来/v,：/w,（/w,纠正/v,图/n,中/f,一个/m,错误/n,：/w,p/en,=/w,a/en, ,*/w, ,v/en,）/w,上图/n,中/f,o/en,1/m,，/w,o/en,2/m,，/w,o/en,3/m, ,表示/v,softmax/en,的/u,输入/v,节点/n,，/w,每个/r,节点/n,先/d,经过/p,指数/n,化/v,得到/v, ,a/en,，/w,然后/c,求/v,和/c,得到/v, ,s/en, ,即/v,分/q,母/b,，/w,倒数/v,得到/v, ,v/en,，/w,再/d,各自/r,和/c,指数/n,相乘/v,，/w,得到/v,该/r,节点/n,输出/v,的/u,概率/n, ,p/en,。/w,为了/p,图片/n,结构/n,稍微/d,美/j,观点/n,，/w,这里/r, ,p/en,2/m, ,就/d,没/d,画/v,出来/v,了/u,。/w,对于/p,上图/n,的/u, ,o/en,1/m, ,来说/u,，/w,导数/n,来源于/v,虚线/n,的/u,链路/n,，/w,箭头/n,上/f,的/u,文字/n,表示/v,局部/n,导数/n,，/w,它/r,的/u,导数/n,实际/n,来自/v,两/m,部分/n,，/w,一/m,是/v,直接/ad,相连/v,的/u, ,p/en,1/m,，/w,以及/c,无/v,直接/ad,链接/n,的/u,p/en,2/m,、/w,p/en,3/m,……/w,对应/v,输入层/nw,的/u,某个/r,节点/n, ,o/en,1/m, ,应用/vn,链式/nw,法则/n,，/w,p/en,1/m, ,节点/n,对/p,其/r,偏导/nw,如下/v,如果/c, ,i/en, ,=/w, ,j/en,，/w,即/v,图/n,中/f, ,o/en,1/m, ,到/v, ,p/en,1/m,，/w,导数/n,由/p,两条/mq,链路/n,组成/v,：/w,如果/c, ,i/en, ,≠/w, ,j/en,，/w,即/v,图/n,中/f, ,o/en,1/m, ,到/v, ,p/en,3/m,，/w,导数/n,由/p,一条/mq,链路/n,组成/v,：/w,如果/c,模型/n,训练/vn,得/u,很/d,好/a,，/w,pj/en, ,和/c,pi/en,都/d,接近/v,0/m,或者/c,其中/r,一个/m,接近/v,于/p,1/m,，/w,可以/v,看到/v,两种/mq,情况/n,梯度/n,都/d,是/v,接近/v,于/p,0/m,，/w,符合/v,预期/vn,；/w,如果/c,模型/n,很/d,差/a,，/w,把/p,某个/r,错误/n,的/u,类别/n,的/u,概率/n,也/d,计算/v,成/v,1/m,，/w,那么/r, ,pj/en, ,和/c, ,pi/en, ,都/d,接近/v,0/m,者/k,其中/r,一个/m,接近/v,于/p,1/m,，/w,梯度/n,也/d,很/d,小/a,，/w,不/d,太/d,符合/v,预期/vn,，/w,看看/v, ,cross/en,-/w,entropy/en, ,是/v,如何/r,解决/v,这个/r,问题/n,的/u,。/w,对于/p,cross/en,-/w,entropy/en,（/w,logloss/en,）/w,误差/n,，/w,计算/v,公式/n,为/p,：/w,可以/v,看到/v, ,cross/en,-/w,entropy/en, ,只/d,关注/v,正确/a,label/en,上/f,的/u,概率/n,大小/n,，/w,上图/n,中/f, ,，/w,只有/c,连/u,到/v,到/v, ,p/en,1/m, ,的/u,链路/n,才/d,是/v,对/p,梯度/n,计算/v,有效/a,的/u,，/w,对/p, ,i/en, ,=/w, ,j/en, ,也/d,就/d,是/v,上图/n,中/f,的/u, ,o/en,1/m, ,来说/u,：/w,对/p, ,i/en, ,≠/w, ,j/en, ,也/d,就/d,是/v, ,o/en,2/m, ,到/v, ,l/en,1/m, ,链路/n,来说/u,：/w,--/nrf,备注/n,：/w,x/en, ,应该/v,是/v, ,-/w, ,1/m,//w,p/en,_,i/en,，/w,上面/f,梯度/n,应该/v,多/a,个/q,负号/n,，/w,截图/vn,太/d,累/a,如果/c,模型/n,很/d,差/a,，/w,正确/a, ,label/en, ,上/f,的/u,概率/n, ,pi/en, ,接近/v,0/m,，/w,实际上/d,不/d,会/v,影响/vn,梯度/n,大小/n,。/w,但是/c,如果/c,是/v, ,squared/en, ,error/en,，/w,上图/n, ,p/en, ,到/v, ,l/en, ,连接/v,上/f,的/u, ,x/en, ,并/c,不/d,包含/v, ,logloss/en, ,的/u,倒数/v,形式/n,。/w,由于/c,正确/a,类别/n,和/c,错误/n,类别/n,的/u,损失/n,函数/n,都/d,会/v,影响/vn, ,oi/en, ,的/u,偏导/nw,，/w,整体/n,公式/n,比较/d,复杂/a,，/w,这里/r,就/d,不/d,做/v,详细/ad,的/u,推导/vn,了/u,，/w,但是/c,整体/n,上/f,是/v,先/d,相/d,乘/v,，/w,然后/c,求和/vn,，/w,梯度/n,会/v,很/d,小/a,，/w,给/p,优化/v,带来/v,阻碍/v,。/w,总结/v,softmax/en,部分/n,在/p,完全/ad,分类/vn,正确/a,或者/c,分类/vn,完全/ad,错误/n,的/u,情况/n,下/f,，/w,该/r,部分/n,偏导/nw,都/d,接近/v,于/p,0/m,logloss/en, ,偏导/nw,中/f,有/v,倒数/v,，/w,可以/v,“/w,中和/v,”/w,softmax/en,这个/r,缺点/n,，/w,squared/en, ,error/en, ,如果/c,初始化/v,不好/a,很/d,难/a,克服/v,这个/r,问题/n,，/w,使用/v,softmax/en,分类/vn,模型/n,的/u, ,