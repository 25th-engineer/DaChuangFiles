一/m,、/w,概念/n,xgboost/en,全/a,名叫/v,（/w,extreme/en, ,gradient/en, ,boosting/en,）/w,极端/n,梯度/n,提升/v,，/w,经常/d,被/p,用/p,在/p,一些/m,比赛/vn,中/f,，/w,其/r,效果/n,显著/a,。/w,它/r,是/v,大规模/b,并行/v,boosted/en, ,tree/en,的/u,工具/n,，/w,它/r,是/v,目前/t,最快/d,最/d,好/a,的/u,开源/v,boosted/en, ,tree/en,工具包/n,。/w,xgboost/en, ,所/u,应用/vn,的/u,算法/n,就/d,是/v, ,gbdt/en,（/w,gradient/en, ,boosting/en, ,decision/en, ,tree/en,）/w,的/u,改进/v,，/w,既/c,可以/v,用于/v,分类/vn,也/d,可以/v,用于/v,回归/v,问题/n,中/f,。/w,1/m,、/w,回归/v,树/v,与/p,决策/n,树/v,事实上/l,，/w,分类/vn,与/p,回归/v,是/v,一个/m,型号/n,的/u,东西/n,，/w,只不过/d,分类/vn,的/u,结果/n,是/v,离散/vn,值/n,，/w,回归/v,是/v,连续/a,的/u,，/w,本质/n,是/v,一样/u,的/u,，/w,都/d,是/v,特征/n,（/w,feature/en,）/w,到/v,结果/n,//w,标签/n,（/w,label/en,）/w,之间/f,的/u,映射/v,。/w,说说/v,决策/n,树/v,和/c,回归/v,树/v,，/w,在/p,上面/f,决策树/nz,的/u,讲解/v,中/f,相信/v,决策/n,树/v,分类/vn,已经/d,很/d,好/a,理解/v,了/u,。/w,分类/vn,树/v,的/u,样本/n,输出/v,（/w,即/v,响应值/nw,）/w,是/v,类/q,的/u,形式/n,，/w,如/v,判断/v,蘑菇/n,是/v,有毒/vn,还是/c,无毒/v,，/w,周末/t,去/v,看/v,电影/n,还是/c,不/d,去/v,。/w,而/c,回归/v,树/v,的/u,样本/n,输出/v,是/v,数值/n,的/u,形式/n,，/w,比如/v,给/p,某人/r,发放/v,房屋/n,贷款/n,的/u,数额/n,就/d,是/v,具体/a,的/u,数值/n,，/w,可以/v,是/v,0/m,到/v,120万元/mq,之间/f,的/u,任意值/nw,。/w,那么/r,，/w,这时候/r,你/r,就/d,没法/v,用/p,上述/b,的/u,信息/n,增益/v,、/w,信息/n,增益率/nw,、/w,基尼/nr,系数/n,来/v,判定/v,树/v,的/u,节点/n,分裂/v,了/u,，/w,你/r,就/d,会/v,采用/v,新/a,的/u,方式/n,，/w,预测/v,误差/n,，/w,常用/a,的/u,有/v,均方/nw,误差/n,、/w,对数/n,误差/n,等/u,。/w,而且/c,节点/n,不再/d,是/v,类别/n,，/w,是/v,数值/n,（/w,预测值/n,）/w,，/w,那么/r,怎么/r,确定/v,呢/y,，/w,有的/r,是/v,节点/n,内/f,样本/n,均值/n,，/w,有的/r,是/v,最/d,优化/v,算/v,出来/v,的/u,比如/v,xgboost/en,。/w,2/m,、/w,boosting/en,集成/vn,学习/v,boosting/en,集成/vn,学习/v,，/w,由/p,多/a,个/q,相/d,关联/vn,的/u,决策/n,树/v,联合/v,决策/n,，/w,什么/r,叫/v,相/d,关联/vn,，/w,举/v,个/q,例子/n,，/w,有/v,一个/m,样本/n,[/w,数据/n,-/w,>,标签/n,]/w,是/v,[/w,(/w,2/m,，/w,4/m,，/w,5/m,)/w,-/w,>, ,4/m,]/w,，/w,第一/m,棵/q,决策/n,树用/nw,这个/r,样本/n,训练/vn,得/u,预测/v,为/p,3.3/m,，/w,那么/r,第二/m,棵/q,决策/n,树/v,训练/vn,时/ng,的/u,输入/v,，/w,这个/r,样本/n,就/d,变成/v,了/u,[/w,(/w,2/m,，/w,4/m,，/w,5/m,)/w,-/w,>, ,0.7/m,]/w,，/w,也就是说/l,，/w,下/f,一棵/mq,决策/n,树/v,输入/v,样本/n,会/v,与/p,前面/f,决策树/nz,的/u,训练/vn,和/c,预测/v,相关/v,。/w,与/p,之/u,对比/v,的/u,是/v,random/en, ,foreast/en,（/w,随机/d,森林/n,）/w,算法/n,，/w,各个/r,决策/n,树/v,是/v,独立/v,的/u,、/w,每个/r,决策/n,树/v,在/p,样本堆/nw,里/f,随机/d,选/v,一批/mq,样本/n,，/w,随机/d,选/v,一批/mq,特征/n,进行/v,独立/v,训练/vn,，/w,各个/r,决策/n,树/v,之间/f,没有/v,啥/r,毛线/n,关系/n,。/w,所以/c,首先/d,xgboost/en,首先/d,是/v,一个/m,boosting/en,的/u,集成/vn,学习/v,，/w,这样/r,应该/v,很/d,通俗/a,了/u,3/m,、/w,这个/r,时候/n,大家/r,就/d,能/v,感觉/n,到/v,一个/m,回归/v,树/v,形成/v,的/u,关键点/n,：/w,（/w,1/m,）/w,分裂点/nw,依据/n,什么/r,来/v,划分/v,（/w,如/v,前面/f,说/v,的/u,均方/nw,误差/n,最/d,小/a,，/w,loss/en,）/w,；/w,（/w,2/m,）/w,分类/vn,后/f,的/u,节点/n,预测值/n,是/v,多少/r,（/w,如/v,前面/f,说/v,，/w,有/v,一种/mq,是/v,将/d,叶子/n,节点/n,下/f,各/r,样本/n,实际/n,值得/v,均值/n,作为/v,叶子/n,节点/n,预测/v,误差/n,，/w,或者/c,计算所得/nw,）/w,二/m,、/w,集成/vn,思想/n,在/p,学习/v,xgboost/en,之前/f,，/w,我们/r,得/u,需要/v,先/d,明白/v,集成/vn,思想/n,。/w,集成/vn,学习/v,方法/n,是/v,指/v,将/d,多/a,个/q,学习/v,模型/n,组合/v,，/w,以/p,获得/v,更/d,好/a,的/u,效果/n,，/w,使/v,组合/v,后/f,的/u,模型/n,具有/v,更/d,强/a,的/u,泛化/nw,能力/n,。/w,另外/c,xgboost/en,是/v,以/p,分类/vn,回归/v,树/v,(/w,cart/en,树/v,)/w,进行/v,组合/v,。/w,故/c,在/p,此/r,之前/f,，/w,我们/r,先/d,看/v,下/f,cart/en,树/v,(/w,cart/en,树/v,具体/a,原理/n,请/v,自行/d,复习/vn,，/w,或者/c,可以/v,留言/v,)/w,。/w,如下/v,，/w,通过/p,输入/v,用户/n,年龄/n,、/w,性别/n,进行/v,判断/v,用户/n,是否/v,喜欢/v,玩/v,游戏/n,的/u,得分值/nw,。/w,由此/d,得到/v,一颗/mq,cart/en,树/v,模型/n,。/w,我们/r,知道/v,对于/p,单个/b,的/u,决策/n,树/v,模型/n,容易/a,出现/v,过/u,拟合/nz,，/w,并且/c,不/d,能/v,在/p,实际/n,中/f,有效/a,应用/vn,。/w,所以/c,出现/v,了/u,集成/vn,学习/v,方法/n,。/w,如/v,下/f,图/n,，/w,通过/p,两棵/mq,树/v,组合/v,进行/v,玩游戏/n,得分值/nw,预测/v,。/w,其中/r,tree/en,1/m,中/f,对/p,小/a,男生/n,的/u,预测/v,分值/n,为/p,2/m,，/w,tree/en,2对/mq,小/a,男生/n,的/u,预测/v,分值/n,为/p,0.9/m,。/w,则/d,该/r,小/a,男生/n,的/u,最后/f,得分值/nw,为/p,2.9/m,。/w,将/d,上面/f,集成/vn,学习/v,方法/n,推广/v,到/v,一般/a,情况/n,，/w,可知/v,其/r,预测/v,模型/n,为/p,：/w,其中/r,为/p,树/v,的/u,总/b,个/q,数/m,，/w,表示/v,第颗/nw,树/v,，/w,表示/v,样本/n,的/u,预测/v,结果/n,。/w,损失/n,函数/n,为/p,：/w,三/m,、/w,分析/vn,xgboost/en,思路/n,首先/d,明确/ad,下/f,我们/r,的/u,目标/n,，/w,希望/v,建立/v,k/en,个/q,回归/v,树/v,，/w,使得/v,树群/nr,的/u,预测/v,值/n,尽量/d,接近/v,真实/a,值/n,（/w,准确率/n,）/w,而且/c,有/v,尽量/d,大/a,的/u,泛化/nw,能力/n,（/w,更为/d,本质/n,的/u,东西/n,）/w,，/w,从/p,数学/n,角度/n,看/v,这/r,是/v,一个/m,泛函/nw,最优化/nz,，/w,多/a,目标/n,，/w,看/v,下/f,目标/n,函数/n,：/w,其中/r,i/en,表示/v,第/m,i/en,个/q,样本/n,，/w,表示/v,第/m,i/en,个/q,样本/n,的/u,预测/v,误差/n,，/w,误差/n,越/d,小/a,越/d,好/a,，/w,不然/c,你/r,算/v,得/u,上/f,预测/v,么/y,？/w,后面/f,表示/v,树/v,的/u,复杂/a,度/q,的/u,函数/n,，/w,越/d,小/a,复杂/a,度/q,越/d,低/a,，/w,泛化/nw,能力/n,越/d,强/a,，/w,这/r,意味/n,着/u,啥/r,不/d,用/p,我/r,多/a,说/v,。/w,表达/v,式/k,为/p,t/en,表示/v,叶子/n,节点/n,的/u,个数/n,，/w,w/en,表示/v,节点/n,的/u,数值/n,（/w,这/r,是/v,回归/v,树/v,的/u,东西/n,，/w,分类/vn,树/v,对应/v,的/u,是/v,类别/n,）/w,直观/a,上/f,看/v,，/w,目标/n,要求/v,预测/v,误差/n,尽量/d,小/a,，/w,叶子/n,节点/n,尽量/d,少/a,，/w,节点/n,数值/n,尽量/d,不/d,极端/n,（/w,这个/r,怎么/r,看/v,，/w,如果/c,某个/r,样本/n,label/en,数值/n,为/p,4/m,，/w,那么/r,第一/m,个/q,回归/v,树/v,预测/v,3/m,，/w,第二/m,个/q,预测/v,为/p,1/m,；/w,另外/c,一组/mq,回归/v,树/v,，/w,一个/m,预测/v,2/m,，/w,一个/m,预测/v,2/m,，/w,那么/r,倾向/n,后/f,一种/mq,，/w,为什么/r,呢/y,？/w,前/f,一种/mq,情况/n,，/w,第一/m,棵/q,树学/nw,的/u,太多/ad,，/w,太/d,接近/v,4/m,，/w,也/d,就/d,意味/n,着/u,有/v,较/d,大/a,的/u,过/u,拟合/nz,的/u,风险/n,）/w,ok/en,，/w,听/v,起来/v,很/d,美好/a,，/w,可是/c,怎么/r,实现/v,呢/y,，/w,上面/f,这个/r,目标/n,函数/n,跟/p,实际/n,的/u,参数/n,怎么/r,联系/v,起来/v,，/w,记得/v,我们/r,说/v,过/u,，/w,回归/v,树/v,的/u,参数/n,:/w,（/w,1/m,）/w,选取/v,哪个/r,feature/en,分裂/v,节点/n,呢/y,；/w,（/w,2/m,）/w,节点/n,的/u,预测值/n,（/w,总/b,不/d,能/v,靠/v,取/v,平均值/n,这么/r,粗暴/ad,不/d,讲/v,道理/n,的/u,方式/n,吧/y,，/w,好歹/n,高级/a,一点/m,）/w,。/w,上述/b,形而上/l,的/u,公式/n,并/c,没有/v,“/w,直接/ad,”/w,解决/v,这/r,两个/m,，/w,那么/r,是/v,如何/r,间接/b,解决/v,的/u,呢/y,？/w,先/d,说/v,答案/n,：/w,贪心/v,策略/n,+/w,最优化/nz,（/w,二次/mq,最/d,优化/v,）/w,通俗/a,解释/v,贪心/v,策略/n,：/w,就/d,是/v,决策/n,时刻/n,按照/p,当前/t,目标/n,最/d,优化/v,决定/v,，/w,说白了/nw,就/d,是/v,眼前/t,利益/n,最大化/v,决定/v,，/w,“/w,目光短浅/i,”/w,策略/n,，/w,他/r,的/u,优缺点/n,细节/n,大家/r,自己/r,去/v,了解/v,，/w,经典/n,背包/n,问题/n,等等/u,。/w,这里/r,是/v,怎么/r,用/p,贪心/v,策略/n,的/u,呢/y,，/w,刚/d,开始/v,你/r,有/v,一群/mq,样本/n,，/w,放在/v,第一/m,个/q,节点/n,，/w,这时候/r,t/en,=/w,1/m,t/en,=/w,1/m,，/w,ww/en,多少/r,呢/y,，/w,不/d,知道/v,，/w,是/v,求/v,出来/v,的/u,，/w,这时候/r,所有/b,样本/n,的/u,预测值/n,都/d,是/v,ww/en,（/w,这个/r,地方/n,自己/r,好好/d,理解/v,，/w,决策树/nz,的/u,节点/n,表示/v,类别/n,，/w,回归/v,树/v,的/u,节点/n,表示/v,预测值/n,）/w,,/w,带入/v,样本/n,的/u,label/en,数值/n,，/w,此时/r,loss/en, ,function/en,变为/v,如果/c,这里/r,的/u,l/en,(/w,w/en,−,yi/en,)/w,误差/n,表示/v,用/p,的/u,是/v,平方/q,误差/n,，/w,那么/r,上述/b,函数/n,就/d,是/v,一个/m,关于/p,w/en,的/u,二次/mq,函数/n,求/v,最小值/nz,，/w,取/v,最小值/nz,的/u,点/q,就/d,是/v,这个/r,节点/n,的/u,预测值/n,，/w,最/d,小/a,的/u,函数/n,值/n,为/p,最小/a,损失/n,函数/n,。/w,这里/r,处理/v,的/u,就/d,是/v,二次/mq,函数/n,最/d,优化/v,！/w,要是/c,损失/n,函数/n,不/d,是/v,二次/mq,函数/n,咋/r,办/v,，/w,哦/e,，/w,泰勒/nr,展开式/nw,会/v,否/vg,？/w,，/w,不/d,是/v,二次/mq,的/u,想/v,办法/n,近似/a,为/p,二次/mq,。/w,接着/c,来/v,，/w,接下来/l,要/v,选/v,个/q,feature/en,分裂/v,成/v,两个/m,节点/n,，/w,变成/v,一棵/mq,弱小/a,的/u,树苗/n,，/w,那么/r,需要/v,：/w,（/w,1/m,）/w,确定/v,分裂/v,用/p,的/u,feature/en,，/w,how/en,？/w,最/d,简单/a,的/u,是/v,粗暴/ad,的/u,枚举/nr,，/w,选择/v,loss/en, ,function/en,效果/n,最/d,好/a,的/u,那个/r,（/w,关于/p,粗暴枚举/nw,，/w,xgboost/en,的/u,改良/v,并行/v,方式/n,咱们/r,后面/f,看/v,）/w,；/w,（/w,2/m,）/w,如何/r,确立/v,节点/n,的/u,ww/en,以及/c,最/d,小/a,的/u,loss/en, ,function/en,，/w,大声/d,告诉/v,我/r,怎么/r,做/v,？/w,对/p,，/w,二次/mq,函数/n,的/u,求/v,最/d,值/n,（/w,细节/n,的/u,会/v,注意/v,到/v,，/w,计算/v,二次/mq,最/d,值/n,是/v,不/d,是/v,有/v,固定/a,套路/n,，/w,导数/n,=/w,0/m,的/u,点/q,，/w,ok/en,）/w,那么/r,节奏/n,是/v,，/w,选择/v,一个/m,feature/en,分裂/v,，/w,计算/v,loss/en, ,function/en,最小值/nz,，/w,然后/c,再/d,选/v,一个/m,feature/en,分裂/v,，/w,又/d,得到/v,一个/m,loss/en, ,function/en,最小值/nz,…/w,你/r,枚举/nr,完/v,，/w,找/v,一个/m,效果/n,最/d,好/a,的/u,，/w,把/p,树/v,给/p,分裂/v,，/w,就/d,得到/v,了/u,小/a,树苗/n,。/w,在/p,分裂/v,的/u,时候/n,，/w,你/r,可以/v,注意/v,到/v,，/w,每次/r,节点/n,分裂/v,，/w,loss/en, ,function/en,被/p,影响/vn,的/u,只有/c,这个/r,节点/n,的/u,样本/n,，/w,因而/c,每次/r,分裂/v,，/w,计算/v,分裂/v,的/u,增益/v,（/w,loss/en, ,function/en,的/u,降低量/nw,）/w,只/d,需要/v,关注/v,打算/v,分裂/v,的/u,那个/r,节点/n,的/u,样本/n,。/w,接下来/l,，/w,继续/v,分裂/v,，/w,按照/p,上述/b,的/u,方式/n,，/w,形成/v,一棵/mq,树/v,，/w,再/d,形成/v,一棵/mq,树/v,，/w,每次/r,在/p,上/f,一次/mq,的/u,预测/v,基础/n,上/f,取/v,最/d,优/ag,进一步/d,分裂/v,//w,建树/n,，/w,是不是/v,贪心/v,策略/n,？/w,！/w,凡是/d,这种/r,循环/vn,迭代/vn,的/u,方式/n,必定/d,有/v,停止/v,条件/n,，/w,什么/r,时候/n,停止/v,呢/y,：/w,（/w,1/m,）/w,当/p,引入/v,的/u,分裂/v,带来/v,的/u,增益/v,小于/v,一个/m,阀值/nz,的/u,时候/n,，/w,我们/r,可以/v,剪掉/v,这个/r,分裂/v,，/w,所以/c,并/c,不/d,是/v,每/r,一次/mq,分裂/v,loss/en, ,function/en,整体/n,都/d,会/v,增加/v,的/u,，/w,有点/d,预剪/nw,枝/q,的/u,意思/n,，/w,阈值/n,参数/n,为/p, ,γ, ,正/d,则/d,项/q,里/f,叶子/n,节点/n,数/m, ,t/en, ,的/u,系数/n,；/w,（/w,2/m,）/w,当树/nw,达到/v,最/d,大/a,深度/n,时/ng,则/d,停止/v,建立/v,决策/n,树/v,，/w,设置/v,一个/m,超/v,参数/n,max/en,_,depth/en,，/w,这个/r,好/a,理解/v,吧/y,，/w,树/v,太/d,深/a,很/d,容易/a,出现/v,的/u,情况/n,学习/v,局部/n,样本/n,，/w,过/u,拟合/nz,；/w,（/w,3/m,）/w,当/p,样本/n,权重/nz,和/c,小于/v,设定/v,阈值/n,时/ng,则/d,停止/v,建树/n,，/w,这个/r,解释/v,一下/m,，/w,涉及/v,到/v,一个/m,超/v,参数/n,-/w,最/d,小/a,的/u,样本/n,权重/nz,和/c,min/en,_,child/en,_,weight/en,，/w,和/c,gbm/en,的/u, ,min/en,_,child/en,_,leaf/en, ,参数/n,类似/v,，/w,但/c,不/d,完全/ad,一样/u,，/w,大意/n,就/d,是/v,一个/m,叶子/n,节点/n,样本/n,太/d,少/a,了/u,，/w,也/d,终止/v,同样/d,是/v,过/u,拟合/nz,；/w,（/w,4/m,）/w,貌似/v,看到/v,过/u,有/v,树/v,的/u,最/d,大/a,数量/n,的/u,…/w,这个/r,不/d,确定/v,那/r,节点/n,分裂/v,的/u,时候/n,是/v,按照/p,哪个/r,顺序/n,来/v,的/u,，/w,比如/v,第一/m,次/q,分裂/v,后/f,有/v,两个/m,叶子/n,节点/n,，/w,先/d,裂/v,哪/r,一个/m,？/w,答/v,：/w,同一/b,层/q,级/q,的/u,（/w,多机/nw,）/w,并行/v,，/w,确立/v,如何/r,分裂/v,或者/c,不/d,分裂/v,成为/v,叶子节点四/nw,、/w,原理/n,推导/vn,上面/f,一部分/m,我们/r,知道/v,了/u,集成/vn,学习/v,方法/n,的/u,预测/v,模型/n,，/w,因为/c,xgboost/en,也/d,是/v,集成/vn,学习/v,方法/n,的/u,一种/mq,。/w,对于/p,xgboost/en,的/u,预测/v,模型/n,同样/d,可以/v,表示/v,为/p,：/w,其中/r,为/p,树/v,的/u,总/b,个/q,数/m,，/w,表示/v,第颗/nw,树/v,，/w,表示/v,样本/n,的/u,预测/v,结果/n,。/w,其中/r,损失/n,函数/n,也/d,同样/d,表示/v,为/p,：/w,其中/r,为/p,样本/n,的/u,训练/vn,误差/n,，/w,表示/v,第棵/nw,树/v,的/u,正/d,则/d,项/q,。/w,看到/v,了/u,这里/r,，/w,我们/r,可能/v,会/v,想到/v,，/w,现在/t,知道/v,了/u,模型/n,预测/v,函数/n,和/c,损失/n,函数/n,，/w,那/r,我们/r,是/v,不/d,是/v,直接/ad,就/d,能/v,求/v,出/v,其/r,预测/v,模型/n,了/u,呢/y,？/w,答案/n,肯定/v,不/d,是/v,，/w,我们/r,首先/d,需要/v,明确/ad,知道/v,优化/v,和/c,求解/v,的/u,参数/n,是/v,什么/r,呢/y,？/w,由/p,上面/f,的/u,预测/v,模型/n,中/f,，/w,我们/r,可以/v,看到/v,对于/p,每/r,棵/q,树/v,的/u,预测值/n,是/v,如何/r,计算/v,的/u,？/w,想到/v,这里/r,，/w,你/r,就/d,已经/d,知道/v,了/u,需要/v,做/v,的/u,事/n,了/u,，/w,我/r,需要/v,求解/v,和/c,优化/v,的/u,就/d,是/v,每个/r,叶子/n,节点/n,的/u,得分值/nw,，/w,也/d,就是/d,的/u,值/n,。/w,另外/c,我们/r,知道/v,xgboost/en,是/v,以/p,cart/en,树/v,中/f,的/u,回归/v,树/v,作为/v,基分类器/nw,，/w,在/p,给/p,定/v,训练/vn,数据/n,后/f,，/w,其/r,单个/b,树/v,的/u,结构/n,(/w,叶子/n,节点/n,个数/n,、/w,树/v,深度/n,等等/u,)/w,基本/a,可以/v,确定/v,了/u,。/w,但/c,xgboost/en,并/c,不是/v,简单/a,重复/v,的/u,将/d,几/m,个/q,cart/en,树/v,进行/v,组合/v,。/w,它/r,是/v,一种/mq,加法/n,模型/n,，/w,将/d,模型/n,上次/t,预测/v,(/w,由/p,t/en,-/w,1棵/mq,树/v,组合/v,而/c,成/v,的/u,模型/n,)/w,产生/v,的/u,误差/n,作为/v,参考/v,进行/v,下/f,一棵/mq,树/v,(/w,第/m,t/en,棵/q,树/v,)/w,的/u,建立/v,。/w,以此/d,，/w,每/r,加入/v,一棵/mq,树/v,，/w,将/d,其/r,损失/n,函数/n,不断/d,降低/v,。/w,如/v,下/f,图/n,就/d,为/p,加法/n,模型/n,案例/n,，/w,它/r,将/d,模型/n,预测/v,值/n,与/p,实际/n,值/n,残差/nw,作为/v,下/f,一颗/mq,树/v,的/u,输入/v,数据/n,。/w,对于/p,加法/n,策略/n,可以/v,表示/v,如下/v,：/w,初始化/v,(/w,模型/n,中/f,没有/v,树/v,时/ng,，/w,其/r,预测/v,结果/n,为/p,0/m,)/w,：/w,往/p,模型/n,中/f,加入/v,第一/m,棵/q,树/v,：/w,往/p,模型/n,中/f,加入/v,第二/m,棵/q,树/v,：/w,…/w,往/p,模型/n,中/f,加入/v,第/m,t/en,棵/q,树/v,：/w,其中/r,表示/v,第棵/nw,树/v,，/w,表示/v,组合/v,棵/q,树/v,模型/n,对/p,样本/n,的/u,预测/v,结果/n,。/w,我们/r,知道/v,，/w,每次/r,往/p,模型/n,中/f,加入/v,一棵/mq,树/v,，/w,其/r,损失/n,函数/n,便/d,会/v,发生/v,变化/vn,。/w,另外/c,在/p,加入/v,第/m,t/en,棵/q,树/v,时/ng,，/w,则/d,前面/f,第/m,t/en,-/w,1棵/mq,树/v,已经/d,训练/vn,完成/v,，/w,此时/r,前面/f,t/en,-/w,1棵/mq,树/v,的/u,正/d,则/d,项/q,和/c,训练/vn,误差/n,都/d,成/v,已知/nz,常数/n,项/q,。/w,对于/p,每/r,棵/q,树/v,的/u,正/d,则/d,项/q,部分/n,，/w,我们/r,将/d,在/p,后面/f,再/d,细说/v,。/w,如果/c,损失/n,函数/n,采用/v,均方/nw,误差/n,时/ng,，/w,其/r,目标/n,损失/n,函数/n,变为/v,：/w,另外/c,对于/p,目标/n,损失/n,函数/n,中/f,的/u,正/d,则/d,项/q,(/w,复杂/a,度/q,)/w,部分/n,，/w,我们/r,从/p,单一/a,的/u,树/v,来/v,考虑/v,。/w,对于/p,其中/r,每/r,一棵/mq,回归/v,树/v,，/w,其/r,模型/n,可以/v,写/v,成/v,：/w,其中/r,为/p,叶子/n,节点/n,的/u,得分值/nw,，/w,表示/v,样本/n,对应/v,的/u,叶子/n,节点/n,。/w,为/p,该/r,树/v,的/u,叶子/n,节点/n,个/q,数/m,。/w,因此/c,，/w,在/p,这里/r,。/w,我们/r,将/d,该/r,树/v,的/u,复杂/a,度/q,写/v,成/v,：/w,复杂/a,度/q,计算/v,例子/n,如下/v,：/w,此时/r,，/w,对于/p,xgboost/en,的/u,目标/n,函数/n,我们/r,可以/v,写/v,为/p,：/w,现在/t,我们/r,只/d,需要/v,找到/v,f/en,(/w,t/en,)/w,来/v,优化/v,上式/nw,目标/n,。/w,在/p,推导/vn,之前/f,，/w,我们/r,先/d,介绍/v,下/f,泰勒/nr,展开式/nw,：/w,这里/r,我们/r,用/p,泰勒/nr,展开式/nw,来/v,近似/a,原来/d,的/u,目标/n,函数/n,，/w,将/d,看作/v,。/w,则/d,原/b,目标/n,函数/n,可以/v,写/v,成/v,：/w,令/v,，/w,，/w,同时/c,对于/p,第/m,t/en,棵/q,树/v,时/ng,，/w,为/p,常数/n,。/w,同时/c,去除/v,所有/b,常数/n,项/q,。/w,故/c,目标/n,损失/n,函数/n,可以/v,写/v,成/v,：/w,由/p,上面/f,介绍/v,书/n,的/u,复杂/a,度/q,时/ng,，/w,我们/r,知道/v,：/w,，/w,同时/c,我们/r,将/d,目标/n,函数/n,全部/m,转换/v,成/v,在/p,第/m,t/en,棵/q,树/v,叶子/n,节点/n,的/u,形式/n,。/w,因为/c,目前/t,对于/p,可以/v,看做/v,是/v,每个/r,样本/n,在/p,第/m,t/en,棵/q,树/v,的/u,叶子/n,节点/n,得分值/nw,相关/v,函数/n,的/u,结果/n,之和/n,，/w,所以/c,我们/r,也/d,能/v,从/p,第/m,t/en,棵/q,树/v,的/u,叶子/n,节点/n,上/f,来/v,表示/v,。/w,上式/nw,中/f,，/w,前/f,两行/mq, ,i/en,=/w,1/m,~/w,n/en, ,求/v,和/c,为/p,在/p,样本/n,中/f,遍历/nw,，/w,后/f,两行/mq, ,j/en, ,=/w, ,1/m,~/w,t/en,求/v,和/c,为/p,在/p,叶子/n,节点/n,上/f,遍历/nw,，/w,其中/r,为/p,第/m,t/en,棵/q,树/v,中/f,总/b,叶子/n,节点/n,的/u,个数/n,，/w,表示/v,在/p,第个/nw,叶子/n,节点/n,上/f,的/u,样本/n,，/w,为/p,第个/nw,叶子/n,节点/n,的/u,得分值/nw,。/w,在/p,这里/r,，/w,令/v,，/w,。/w,则/d,：/w,对/p,求/v,偏导/nw,，/w,并/c,使/v,其/r,导/j,函数/n,等于/v,0/m,，/w,则/d,有/v,：/w,求解/v,得/u,：/w,其/r,目标/n,函数/n,可以/v,为/p,：/w,根据/p,目标/n,函数/n,，/w,如何/r,分裂/v,样本/n,数据/n,呢五/nw,、/w,总结/v,1/m,、/w,xgboost/en,的/u,一些/m,重点/n,w/en,是/v,最/d,优化/v,求/v,出来/v,的/u,，/w,不/d,是/v,啥/r,平均值/n,或/c,规则/n,指定/v,的/u,，/w,这个/r,算是/v,一个/m,思路/n,上/f,的/u,新颖/a,吧/y,；/w,正则化/nw,防止/v,过/u,拟合/nz,的/u,技术/n,，/w,上述/b,看到/v,了/u,，/w,直接/ad,loss/en, ,function/en,里面/f,就/d,有/v,；/w,支持/v,自/p,定义/n,loss/en, ,function/en,，/w,只要/c,能/v,泰勒/nrf,展开/v,（/w,能/v,求/v,一/m,阶导/nw,和/c,二/m,阶导/nw,）/w,就/d,行/v,；/w,支持/v,并行化/nw,，/w,这个/r,地方/n,有/v,必要/a,说明/v,下/f,，/w,因为/c,这/r,是/v,xgboost/en,的/u,闪光点/n,，/w,直接/ad,的/u,效果/n,是/v,训练/vn,速度/n,快/a,，/w,boosting/en,技术/n,中/f,下/f,一棵/mq,树/v,依赖/v,上述/b,树/v,的/u,训练/vn,和/c,预测/v,，/w,所以/c,树/v,与/p,树/v,之间/f,应该/v,是/v,只能/v,串行/b,！/w,那么/r,大家/r,想想/v,，/w,哪里/r,可以/v,并行/v,？/w,！/w, ,没错/v,，/w,在/p,选择/v,最佳/z,分裂点/nw,，/w,进行/v,枚举/nr,的/u,时候/n,并行/v,！/w,（/w,据说/v,恰好/d,这个/r,也/d,是/v,树/v,形成/v,最/d,耗/v,时/ng,的/u,阶段/n,）/w,attention/en,：/w,同/p,层级/n,节点/n,可/v,并行/v,。/w,具体/a,的/u,对于/p,某个/r,节点/n,，/w,节点/n,内/f,选择/v,最佳/z,分裂点/nw,，/w,候选/b,分裂点/nw,计算/v,增益/v,用/p,多/a,线程/n,并行/v,。/w,—/w,–,较/d,少/a,的/u,离/v,散值/nw,作为/v,分割点/nw,倒是/d,很/d,简单/a,，/w,比如/v,“/w,是否/v,是/v,单身/n,”/w,来/v,分裂/v,节点/n,计算/v,增益/v,是/v,很/d,easy/en,，/w,但是/c,“/w,月/q,收入/n,”/w,这种/r,feature/en,，/w,取值/v,很/d,多/a,，/w,从/p,5/m,k/en,~/w,50/m,k/en,都/d,有/v,，/w,总/b,不/d,可能/v,每个/r,分割点/nw,都/d,来/v,试/v,一下/m,计算/v,分裂/v,增益/v,吧/y,？/w,（/w,比如/v,月/q,收入/n,feature/en,有/v,1000个/m,取值/v,，/w,难道/d,你/r,把/p,这/r,1000个/m,用作/v,分割/v,候选/b,？/w,缺点/n,1/m,：/w,计算量/nw,，/w,缺点/n,2/m,：/w,出现/v,叶子/n,节点/n,样本/n,过/u,少/a,，/w,过/u,拟合/nz,）/w,我们/r,常用/a,的/u,习惯/n,就/d,是/v,划分/v,区间/n,，/w,那么/r,问题/n,来/v,了/u,，/w,这个/r,区间/n,分割点/nw,如何/r,确定/v,（/w,难道/d,平均/a,分割/v,）/w,，/w,作者/n,是/v,这么/r,做/v,的/u,：/w,方法/n,名字/n,：/w,weighted/en, ,quantile/en, ,sketch/en,大家/r,还/d,记得/v,每个/r,样本/n,在/p,节点/n,（/w,将要/d,分裂/v,的/u,节点/n,）/w,处/n,的/u,loss/en, ,function/en,一/m,阶导/nw,数/m,gi/en,和/c,二阶/nr,导数/n,hi/en,，/w,衡量/v,预测/v,值/n,变化/vn,带来/v,的/u,loss/en, ,function/en,变化/vn,，/w,举例来说/l,，/w,将/d,样本/n,“/w,月/q,收入/n,”/w,进行/v,升序/n,排列/v,，/w,5/m,k/en,、/w,5.2/m,k/en,、/w,5.3/m,k/en,、/w,…/w,、/w,52/m,k/en,，/w,分割线/nw,为/p,“/w,收入/n,1/m,”/w,、/w,“/w,收入/n,2/m,”/w,、/w,…/w,、/w,“/w,收入/n,j/en,”/w,，/w,满足/v,(/w,每个/r,间隔/n,的/u,样本/n,的/u,hi/en,之和/n,//w,总/b,样本/n,的/u,hi/en,之和/n,）/w,为/p,某个/r,百分比ϵ/nw,（/w,我/r,这个/r,是/v,近似/a,的/u,说法/n,）/w,，/w,那么/r,可以/v,一共/d,分成/v,大约/d,1/m,//w,ϵ,个/q,分裂点/nw,。/w,xgboost/en,还/d,特别/d,设计/vn,了/u,针对/p,稀疏/a,数据/n,的/u,算法/n,假设/v,样本/n,的/u,第/m,i/en,个/q,特征/n,缺/v,失/v,时/ng,，/w,无法/v,利用/v,该/r,特征/n,对/p,样本/n,进行/v,划分/v,，/w,这里/r,的/u,做法/n,是/v,将/d,该/r,样本/n,默认/v,地/u,分/q,到/v,指定/v,的/u,子/ng,节点/n,，/w,至于/p,具体/a,地/u,分/q,到/v,哪个/r,节点/n,还/d,需要/v,某/r,算法/n,来/v,计算/v,，/w,算法/n,的/u,主要/b,思想/n,是/v,，/w,分别/d,假设/v,特征/n,缺失/n,的/u,样本/n,属于/v,右子/nw,树/v,和/c,左子树/nr,，/w,而且/c,只/d,在/p,不/d,缺/v,失/v,的/u,样本/n,上/f,迭代/vn,，/w,分别/d,计算/v,缺失/n,样本/n,属于/v,右子/nw,树/v,和/c,左子树/nr,的/u,增益/v,，/w,选择/v,增益/v,最/d,大/a,的/u,方向/n,为/p,缺/v,失/v,数据/n,的/u,默认/v,方向/n,（/w,咋/r,一/m,看/v,如果/c,缺/v,失/v,情况/n,为/p,3个/m,样本/n,，/w,那么/r,划分/v,的/u,组合/v,方式/n,岂不/nw,是/v,有/v,8种/mq,？/w,指数/n,级/q,可能性/n,啊/y,，/w,仔细/ad,一/m,看/v,，/w,应该/v,是/v,在/p,不/d,缺/v,失/v,样本/n,情况/n,下/f,分裂/v,后/f,，/w,把/p,第一/m,个/q,缺失/n,样本/n,放/v,左边/f,计算/v,下/f,loss/en, ,function/en,和/c,放/v,右边/f,进行/v,比较/d,，/w,同样/d,对付/v,第二/m,个/q,、/w,第三/nw,个/q,…/w,缺失/n,样本/n,，/w,这么/r,看来/v,又/d,是/v,可以/v,并行/v,的/u,？/w,？/w,）/w,（/w,答/v,：/w,论文/n,中/f,“/w,枚举/nr,”/w,指/v,的/u,不/d,是/v,枚举/nr,每个/r,缺失/n,样本/n,在/p,左边/f,还是/c,在/p,右边/f,，/w,而是/c,枚举/nr,缺失/n,样本/n,整体/n,在/p,左边/f,，/w,还是/c,在/p,右边/f,两种/mq,情况/n,。/w, ,分裂点/nw,还是/c,只/d,评估/vn,特征/n,不/d,缺/v,失/v,的/u,样本/n,。/w,）/w,；/w,可/v,实现/v,后/f,剪枝/vn,交叉/vn,验证/vn,，/w,方便/a,选择/v,最/d,好/a,的/u,参数/n,，/w,early/en, ,stop/en,，/w,比如/v,你/r,发现/v,30棵/mq,树/v,预测/v,已经/d,很/d,好/a,了/u,，/w,不用/d,进一步/d,学习/v,残差/nw,了/u,，/w,那么/r,停止/v,建树/n,。/w,行/v,采样/v,、/w,列/v,采样/v,，/w,随机/d,森林/n,的/u,套路/n,（/w,防止/v,过/u,拟合/nz,）/w,shrinkage/en,，/w,你/r,可以/v,是/v,几/m,个/q,回归/v,树/v,的/u,叶子/n,节点/n,之和/n,为/p,预测值/n,，/w,也/d,可以/v,是/v,加权/v,，/w,比如/v,第一/m,棵/q,树/v,预测/v,值/n,为/p,3.3/m,，/w,label/en,为/p,4.0/m,，/w,第二/m,棵/q,树/v,才学/n,0.7/m,，/w,…/w,./w,再/d,后面/f,的/u,树/v,还/d,学/v,个/q,鬼