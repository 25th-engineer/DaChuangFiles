写/v,这个/r,系列/q,是/v,因为/c,最近/t,公司/n,在/p,搞/v,技术/n,分享/v,，/w,学习/v,spark/en,，/w,我/r,的/u,任务/n,是/v,讲/v,pyspark/en,的/u,应用/vn,，/w,因为/c,我/r,主要/b,用/p,python/en,，/w,结合/v,spark/en,，/w,就/d,讲/v,pyspark/en,了/u,。/w,然而/c,我/r,在/p,学习/v,的/u,过程/n,中/f,发现/v,，/w,pyspark/en,很/d,鸡肋/n,（/w,至少/d,现在/t,我/r,觉得/v,我/r,不/d,会/v,拿/v,pyspark/en,做/v,开发/v,）/w,。/w,为什么/r,呢/y,？/w,原因/n,如下/v,：/w,1/m,./w,pyspark/en,支持/v,的/u,算法/n,太/d,少/a,了/u,。/w,我们/r,看/v,一下/m,pyspark/en,支持/v,的/u,算法/n,:/w,(/w,参考/v,官方/n,文档/n,)/w,前面/f,两个/m,pyspark/en,./w,sql/en,和/c,pyspark/en,./w,streaming/en,是/v,对/p,sql/en,和/c,streaming/en,的/u,支持/v,。/w,主要/b,是/v,读/v,取/v,数据/n,，/w,和/c,streaming/en,处理/v,这种/r,方式/n,（/w,当然/d,这/r,是/v,spark/en,的/u,优势/n,，/w,要是/c,这/r,也/d,不/d,支持/v,真是/d,见鬼/v,了/u,）/w,。/w,pyspark/en,./w,ml/en,和/c,pyspark/en,./w,mllib/en,分别/d,是/v,ml/en,的/u,api/en,和/c,mllib/en,的/u,api/en,，/w,ml/en,的/u,算法/n,真心/d,少/a,啊/y,，/w,而且/c,支持/v,的/u,功能/n,很/d,有限/a,，/w,譬如/v,lr/en,（/w,逻辑/n,回归/v,）/w,和/c,gbt/en,目前/t,只/d,支持/v,二/m,分类/vn,，/w,不/d,支持/v,多/a,分类/vn,。/w,mllib/en,相对/d,好/a,点/q,，/w,支持/v,的/u,算法/n,也/d,多/a,点/q,，/w,虽然/c,昨天/t,发/v,的/u,博文/nz,讲/v,mlllib/en,的/u,时候/n,说/v,过/u,有的/r,算法/n,不/d,支持/v,分布式/b,，/w,所以/c,才/d,会/v,有限/a,，/w,但是/c,我/r,在/p,想/v,，/w,如果/c,我/r,需要/v,用/p,到/v,a/en,算法/n,，/w,而/c,ml/en,和/c,mllib/en,的/u,包/v,里面/f,都/d,没有/v,，/w,这样/r,是/v,不/d,是/v,意味/n,着/u,要/v,自己/r,开发/v,分布式/b,算法/n,呢/y,？/w,代价/n,有点/d,大诶/nw,，/w,感觉/n,写/v,这个/r,的/u,时间/n,不如/v,多/a,找/v,找/v,有用/a,的/u,特征/n,，/w,然后/c,上/f,lr/en,，/w,这样/r,效果/n,说不定/l,更/d,好/a,。/w,因为/c,目前/t,还/d,没有/v,在/p,实际/n,中/f,用/p,过/u,，/w,所以/c,以上/f,只/d,是/v,我/r,的/u,想法/n,。/w,下面/f,把/p,ml/en,和/c,mllib/en,的/u,所有/b,api/en,列/v,出来/v,，/w,这样/r,看/v,的/u,更/d,清楚/a,。/w,图/n,一/m, ,pyspark/en,./w,ml/en,的/u,api/en,图/n,二/m, ,pyspark/en,./w,mllib/en,的/u,api/en,从/p,上面/f,两张/mq,图/n,可以/v,看到/v,，/w,mllib/en,的/u,功能/n,比/p,ml/en,强大/a,的/u,不/d,是/v,一点半点/nt,啊/y,，/w,那/r,ml/en,这个/r,包/v,的/u,存在/v,还有/v,什么/r,意义/n,呢/y,？/w,不/d,懂/v,（/w,如果/c,有/v,了解/v,的/u,欢迎/v,留言/v,）/w,。/w,虽然/c,有/v,这么/r,多/a,疑问/n,，/w,但是/c,我/r,还是/c,跟/p,大家/r,讲/v,了/u,，/w,用/p,的/u,数据/n,依然/d,是/v,iris/en,（/w,其实/d,我/r,真心/d,想/v,换/v,个/q,数据集/nw,啊/y, ,=/w,=/w, ,，/w,下次/t,换/v,）/w,。/w,上/f,代码/n,：/w,1/m, ,from/en, ,pyspark/en,./w,sql/en, ,import/en, ,sqlcontext/en, ,2/m, ,sqlcontext/en, ,=/w, ,sqlcontext/en,(/w,sc/en,)/w, ,3/m, ,df/en, ,=/w, ,sqlcontext/en,./w,read/en,./w,format/en,(/w,'/w,com/en,./w,databricks/en,./w,spark/en,./w,csv/en,'/w,)/w,./w,options/en,(/w,header/en,=/w,'/w,true/en,'/w,,/w, ,inferschema/en,=/w,'/w,true/en,'/w,)/w,./w,load/en,(/w,'/w,iris/en,./w,csv/en,'/w,)/w, ,4/m, ,#, ,displays/en, ,the/en, ,content/en, ,of/en, ,the/en, ,dataframe/en, ,to/en, ,stdout/en, ,5/m, ,df/en,./w,show/en,(/w,)/w, ,6/m, ,7/m, ,8/m, ,from/en, ,pyspark/en,./w,ml/en,./w,feature/en, ,import/en, ,stringindexer/en, ,9/m, ,indexer/en, ,=/w, ,stringindexer/en,(/w,inputcol/en,=/w,"/w,species/en,"/w,,/w, ,outputcol/en,=/w,"/w,labelindex/en,"/w,)/w, ,10/m, ,indexed/en, ,=/w, ,indexer/en,./w,fit/en,(/w,df/en,)/w,./w,transform/en,(/w,df/en,)/w, ,11/m, ,indexed/en,./w,show/en,(/w,)/w, ,12/m, ,13/m, ,from/en, ,pyspark/en,./w,sql/en, ,import/en, ,row/en, ,14/m, ,from/en, ,pyspark/en,./w,mllib/en,./w,linalg/en, ,import/en, ,vectors/en, ,15/m, ,from/en, ,pyspark/en,./w,ml/en,./w,classification/en, ,import/en, ,naivebayes/en, ,16/m, ,17/m, ,#, ,load/en, ,and/en, ,parse/en, ,the/en, ,data/en, ,18/m, ,def/en, ,parserow/en,(/w,row/en,)/w,:/w, ,19/m, ,return/en, ,row/en,(/w,label/en,=/w,row/en,[/w,"/w,labelindex/en,"/w,]/w,,/w, ,20/m, ,features/en,=/w,vectors/en,./w,dense/en,(/w,[/w,row/en,[/w,"/w,sepal/en,./w,length/en,"/w,]/w,,/w, ,21/m, ,row/en,[/w,"/w,sepal/en,./w,width/en,"/w,]/w,,/w, ,22/m, ,row/en,[/w,"/w,petal/en,./w,length/en,"/w,]/w,,/w, ,23/m, ,row/en,[/w,"/w,petal/en,./w,width/en,"/w,]/w,]/w,)/w,)/w, ,24/m, ,25/m, ,#,#, ,must/en, ,convert/en, ,to/en, ,dataframe/en, ,after/en, ,mapping/en, ,26/m, ,parseddata/en, ,=/w, ,indexed/en,./w,map/en,(/w,parserow/en,)/w,./w,todf/en,(/w,)/w, ,27/m, ,labeled/en, ,=/w, ,stringindexer/en,(/w,inputcol/en,=/w,"/w,label/en,"/w,,/w, ,outputcol/en,=/w,"/w,labelpoint/en,"/w,)/w, ,28/m, ,data/en, ,=/w, ,labeled/en,./w,fit/en,(/w,parseddata/en,)/w,./w,transform/en,(/w,parseddata/en,)/w, ,29/m, ,data/en,./w,show/en,(/w,)/w, ,30/m, ,31/m, ,#,#, ,训练/vn,模型/n, ,32/m, ,#,naive/en, ,bayes/en, ,33/m, ,nb/en, ,=/w, ,naivebayes/en,(/w,smoothing/en,=/w,1.0/m,,/w, ,modeltype/en,=/w,"/w,multinomial/en,"/w,)/w, ,34/m, ,model/en,_,nb/en, ,=/w, ,nb/en,./w,fit/en,(/w,data/en,)/w, ,35/m, ,predict/en,_,data/en,=/w, ,model/en,_,nb/en,./w,transform/en,(/w,data/en,)/w, ,36/m, ,traing/en,_,err/en, ,=/w, ,predict/en,_,data/en,./w,filter/en,(/w,predict/en,_,data/en,[/w,'/w,label/en,'/w,]/w, ,!/w,=/w, ,predict/en,_,data/en,[/w,'/w,prediction/en,'/w,]/w,)/w,./w,count/en,(/w,)/w, ,37/m, ,total/en, ,=/w, ,predict/en,_,data/en,./w,count/en,(/w,)/w, ,38/m, ,nb/en,_,scores/en, ,=/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,39/m, ,print/en, ,traing/en,_,err/en,,/w, ,total/en,,/w, ,nb/en,_,scores/en, ,40/m, ,#,7/m, ,150/m, ,0.0466666666667/m, ,41/m, ,42/m, ,43/m, ,#,logistic/en, ,regression/en,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#, ,44/m, ,#, ,logistic/en, ,regression/en,./w, ,currently/en,,/w, ,this/en, ,class/en, ,only/en, ,supports/en, ,binary/en, ,classification/en,./w, ,45/m, ,from/en, ,pyspark/en,./w,ml/en,./w,classification/en, ,import/en, ,logisticregression/en, ,46/m, ,lr/en, ,=/w, ,logisticregression/en,(/w,maxiter/en,=/w,5/m,,/w, ,regparam/en,=/w,0.01/m,)/w, ,47/m, ,model/en,_,lr/en, ,=/w, ,lr/en,./w,fit/en,(/w,data/en,)/w, ,48/m, ,predict/en,_,data/en,=/w, ,model/en,_,lr/en,./w,transform/en,(/w,data/en,)/w, ,49/m, ,traing/en,_,err/en, ,=/w, ,predict/en,_,data/en,./w,filter/en,(/w,predict/en,_,data/en,[/w,'/w,label/en,'/w,]/w, ,!/w,=/w, ,predict/en,_,data/en,[/w,'/w,prediction/en,'/w,]/w,)/w,./w,count/en,(/w,)/w, ,50/m, ,total/en, ,=/w, ,predict/en,_,data/en,./w,count/en,(/w,)/w, ,51/m, ,lr/en,_,scores/en, ,=/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,52/m, ,print/en, ,traing/en,_,err/en,,/w, ,total/en,,/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,53/m, ,54/m, ,55/m, ,#,decision/en, ,tree/en, ,56/m, ,from/en, ,pyspark/en,./w,ml/en,./w,classification/en, ,import/en, ,decisiontreeclassifier/en, ,57/m, ,dt/en, ,=/w, ,decisiontreeclassifier/en,(/w,maxdepth/en,=/w,2/m,,/w,labelcol/en, ,=/w, ,'/w,labelpoint/en,'/w,)/w, ,58/m, ,model/en,_,dt/en,=/w, ,dt/en,./w,fit/en,(/w,data/en,)/w, ,59/m, ,predict/en,_,data/en,=/w, ,model/en,_,dt/en,./w,transform/en,(/w,data/en,)/w, ,60/m, ,traing/en,_,err/en, ,=/w, ,predict/en,_,data/en,./w,filter/en,(/w,predict/en,_,data/en,[/w,'/w,label/en,'/w,]/w, ,!/w,=/w, ,predict/en,_,data/en,[/w,'/w,prediction/en,'/w,]/w,)/w,./w,count/en,(/w,)/w, ,61/m, ,total/en, ,=/w, ,predict/en,_,data/en,./w,count/en,(/w,)/w, ,62/m, ,dt/en,_,scores/en, ,=/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,63/m, ,print/en, ,traing/en,_,err/en,,/w, ,total/en,,/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,64/m, ,65/m, ,66/m, ,#,gbt/en,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#, ,67/m, ,#,#, ,gbt/en,./w, ,currently/en,,/w, ,this/en, ,class/en, ,only/en, ,supports/en, ,binary/en, ,classification/en,./w, ,68/m, ,from/en, ,pyspark/en,./w,ml/en,./w,classification/en, ,import/en, ,gbtclassifier/en, ,69/m, ,gbt/en, ,=/w, ,gbtclassifier/en,(/w,maxiter/en,=/w,5/m,,/w, ,maxdepth/en,=/w,2/m,,/w,labelcol/en,=/w,"/w,labelpoint/en,"/w,)/w, ,70/m, ,model/en,_,gbt/en, ,=/w, ,gbt/en,./w,fit/en,(/w,data/en,)/w, ,71/m, ,predict/en,_,data/en,=/w, ,model/en,_,gbt/en,./w,transform/en,(/w,data/en,)/w, ,72/m, ,traing/en,_,err/en, ,=/w, ,predict/en,_,data/en,./w,filter/en,(/w,predict/en,_,data/en,[/w,'/w,label/en,'/w,]/w, ,!/w,=/w, ,predict/en,_,data/en,[/w,'/w,prediction/en,'/w,]/w,)/w,./w,count/en,(/w,)/w, ,73/m, ,total/en, ,=/w, ,predict/en,_,data/en,./w,count/en,(/w,)/w, ,74/m, ,dt/en,_,scores/en, ,=/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,75/m, ,print/en, ,traing/en,_,err/en,,/w, ,total/en,,/w, ,float/en,(/w,traing/en,_,err/en,)/w,//w,total/en, ,76/m, ,77/m, ,78/m, ,#,random/en, ,forest/en, ,79/m, ,from/en, ,pyspark/en,./w,ml/en,./w