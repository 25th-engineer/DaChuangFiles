快速/d,寻找/v,最/d,优解/nw, ,-/w,基础/n,知识/n,通过/p,上文/n,,/w, , ,我们/r,知道/v,了/u,,/w, ,如果/c,盲目/ad,使用/v,随机/d,算法/n,或者/c,遍历/nw,算法/n,寻找/v,最/d,优解/nw,的话/u,,/w, , ,需要/v,计算/v,的/u,空间/n,将/d,会/v,太大/d,./w, ,为了/p,能够/v,让/v,大家/r,直观/a,的/u,感受/v,一下/m,实际/n,应用/vn,的/u,计算量/nw,,/w, ,我/r,这里/r,再/d,举/v,个/q,例子/n,,/w, ,1997年/t,5月/t,11日/t, ,ibm/en,的/u,深蓝/b,ai/en,战胜/v,卡国际象棋/nw,名家/n,斯帕罗夫/nrf,./w, ,我们/r,知道/v, ,围棋/n,的/u,棋盘/n,是/v,19路/mq,总共/d,361/m,格/j,,/w, ,如果/c,计算机/n,需要/v,计算/v,10步/mq,则/d,需要/v,计算/v,的/u,状态/n,数量/n,为/p,361/m,^,10/m, ,=/w, ,37589973457545958193355601/m, ,个/q,,/w, , ,而/c,前文/n,我们/r,提到/v,的/u,当/p,步长/nz,为/p,0.01时/t,需要/v,计算/v,的/u,状态/n,数量/n,为/p,160000/m,,/w, ,耗时/v,约/d,5秒/t,,/w, ,而/c,刚才/t,提到/v,的/u,10步/mq,需要/v,的/u,计算量/nw,约/d,为/p,上文/n,160000/m,的/u, ,234937334109662238708倍/mq,./w,不难/d,看/v,出/v,,/w, ,如果/c,不/d,使用/v,一定/d,的/u,优化/v,技巧/n,,/w, ,使用/v,暴力/n,穷举/v,来/v,计算/v,实际/n,任务/n,,/w, ,性能/n,上将/n,很/d,容量/n,成为/v,瓶颈/n,./w,相对/d,遍历/nw,或者/c,穷举/v,的/u,方法/n,，/w, ,梯度/n,下降/v,法/j,（/w,gradient/en, ,descent/en, ,)/w, ,就/d,是/v,这样/r,一种/mq,又/d,快/a,又/d,准/a,原理/n,简单/a,又/d,容易/a,实现/v,的/u,优化/v,算法/n,所谓/v,的/u,梯度/n,下降/v,法/j,就/d,是/v,让/v,数学/n,模型/n,的/u,参数/n,(/w,coefficient/en,)/w,沿着/p,梯度/n,的/u,负/v,方向/n,进行/v,快速/d,迭代/vn,下降/v,的/u,过程/n,，/w, ,该/r,过程/n,会/v,一直/d,迭代/vn,下去/v,直到/v,误差/n,的/u,范围/n,符合/v,用户/n,的/u,要求/v,（/w,成功/a,创建/v,模型/n,）/w,或者/c,迭代/vn,次数/n,达到/v,上限/n,时/ng,（/w,失败/v,）/w,。/w,在/p,正式/ad,介绍/v,梯度/n,下降/v,算法/n,之前/f,，/w, ,本章/r,先/d,梳理/v,一下/m,梯度/n,下降/v,法会/n,涉及/v,到/v,的/u,基本/a,概念/n,导数/n,通常/d,描述/v,的/u,是/v,在/p,只/d,有/v,一个/m,自/p,变量/n,（/w,一维/nw,）/w,的/u,函数/n,空间/n,内/f,的/u,某/r,一点/m,随着/p,函数/n,自/p,变量/n,变化/vn,时/ng,，/w,函数/n,本身/r,的/u,变化率/n,（/w,敏感/a,程度/n,）/w,。/w,导数/n,的/u,计算/v,结果/n,为/p,一个/m,标量/n,（/w,也/d,就/d,是/v,一个/m,数值/n,）/w,，/w, ,值/n,越/d,大/a,，/w, ,单位/n,长度/n,的/u,自/p,变量/n,变化/vn,带来/v,的/u,影响/vn,越/d,大/a,。/w,直观/a,的/u,几何意思/nw,是/v,函数/n,在/p,某/r,一点/m,的/u,斜率/n,。/w,当/p,函数/n,有/v,多/a,个/q,自/p,变量/n,时/ng,（/w,多元/b,函数/n,也/d,叫/v,多/a,维/q,函数/n,）/w,，/w, ,由于/c,求导/nw,可以/v,针对/p,不同/a,的/u,自/p,变量/n,进行/v,，/w, ,所以/c,针对/p,只有/c,某个/r,自/p,变量/n,进行/v,变化/vn,的/u,情况/n,下/f,求解/v,的/u,导数/n,被/p,称为/v,偏导/nw,数/m,。/w,偏导/nw,数/m,描述/v,的/u,是/v,函数/n,仅/d,沿着/p,坐标轴/n,的/u,某个/r,方向/n,进行/v,变化/vn,时/ng,的/u,函数/n,变化率/n,。/w,既然/c,函数/n,可以/v,沿着/p,坐标轴/n,的/u,某个/r,方向/n,进行/v,求导/nw,，/w, ,那么/r,自然/d,也/d,可以/v,对/p,沿着/p,其它/r,方向/n,变化/vn,的/u,函数/n,进行/v,求导/nw,（/w,比如/v,沿着/p,与/p,x/en,轴/q,成/v,45度/mq,夹角/n,的/u,方向/n,）/w,，/w, ,在/p,这个/r,情况/n,下/f,求/v,出来/v,的/u,导数/n,我们/r,称之为/v,方向/n,导数/n,。/w, ,也就是说/l,方向/n,导数/n,为/p,多元多项式/nw,中/f,（/w,比如/v,二元/mq,二次/mq,函数/n,）/w,某个/r,点/q,沿着/p,某个/r,向量/n,方向/n,进行/v,求导/nw,后/f,得到/v,的/u,值/n,。/w,（/w,二元/b,函数/n,的/u,自/p,变量/n,可以/v,沿着/p,[/w,x/en,,/w,y/en,]/w,方向/n,变化/vn,，/w, ,三元/mq,函数/n,则/d,可以/v,沿/p,[/w,x/en,,/w,y/en,,/w,z/en,]/w,方向/n,进行/v,求导/nw,）/w,梯度/n,为/p,多元/b,函数/n,的/u,偏导/nw,数/m,组成/v,的/u,一个/m,向量/n,，/w, ,是/v,一/m,维导/nr,数/m,在/p,高维/nr,空间/n,的/u,推广/v,（/w,generalization/en,)/w,。/w, ,同样/d,描述/v,的/u,是/v,函数/n,随着/p,自/p,变量/n,进行/v,变化/vn,时/ng,的/u,变化率/n,，/w, ,只是/d,这个/r,时候/n,的/u,自/p,变量/n,由/p,一维/nw,（/w,一个/m,）/w,变成/v,了/u,多维/nr,（/w,多/a,个/q,自/p,变量/n,）/w,。/w, ,沿着/p,梯度/n,方向/n,进行/v,求导/nw,时/ng,，/w, ,导数/n,值/n,最大/a,，/w, ,也就是说/l,函数/n,在/p,某个/r,点/q,沿着/p,梯度/n,方向/n,变化/vn,时/ng,，/w, ,函数/n,的/u,值/n,变化/vn,最/d,快/a,。/w,如/v,下/f,图/n,所/u,示/vg,，/w, ,左边/f,的/u,山/n,是/v,由/p,函数/n,f/en,(/w,x/en,,/w,y/en,)/w, ,代表/n,高度/d,的/u,情况/n,下/f,绘制/v,出来/v,的/u,，/w, ,右边/f,是/v,这/r,座/q,山/n,在/p,二维/nr,平面/n,的/u,投影/vn,形成/v,的/u,等高线图/nw,。/w, ,右图/n,中/f,的/u,红点/nz,可以/v,沿着/p,任意/d,方向/n,前进/v,，/w, ,但是/c,我们/r,可以/v,发现/v,不同/a,方向/n,的/u,高度/d,变化/vn,是/v,不/d,一样/u,的/u,。/w, ,红点/nz,的/u,箭头/n,方向/n,是/v,梯度/n,方向/n,，/w, ,也/d,是/v,高度/d,变化/vn,最/d,剧烈/a,的/u,方向/n,。/w,再/d,如/v,下/f,图/n,为/p,一个/m,二元/b,二次/mq,函数/n, ,f/en,(/w,x/en,,/w,y/en,)/w, ,=/w, ,−,(/w,cos/en,2/m,x/en, ,+/w, ,cos/en,2/m,y/en,)/w,2/m,图/n,中/f,的/u,x/en,，/w,y/en,轴/q,组成/v,的/u,平面/n,上/f,的/u,红色/n,箭头/n,的/u,方向/n, ,就/d,是/v,梯度/n,的/u,方向/n,，/w, ,箭头/n,的/u,长度/n,由/p,函数/n,在/p,这个/r,点/q,上/f,沿/p,梯度/n,方向/n,求导/nw,计算/v,出来/v,的/u,。/w,总结/v,一下/m,：/w,导数/n,是/v,一个/m,数值/n,，/w, ,代表/n,了/u,函数/n,在/p,某个/r,点/q,的/u,变化率/n,。/w,梯度/n,一个/m,特殊/a,的/u,方向/n,，/w,因为/c,它/r,的/u,方向/n,是/v,由/p,函数/n,在/p,某个/r,点/q,的/u,偏导/nw,数/m,决定/v,的/u,知道/v,了/u,梯度/n,的/u,相关/v,概念/n,，/w, ,我们/r,就/d,直接/ad,来说/u,说/v,简单/a,版/n,的/u,梯度/n,下降/v,算法/n,（/w,也/d,叫/v, ,最/d,速/ng,下降/v,法/j, ,gradient/en, ,descent/en,）/w,(/w,1/m,)/w,首先/d,对于/p,任意/d,一个/m,函数/n,，/w, ,我们/r,都/d,可以/v,随机/d,选择/v,一个/m,点/q,作为/v,我们/r,的/u,起始点/nw,x/en,_,0/m,(/w,2/m,)/w,为了/p,保证/v,函数/n,f/en,（/w,x/en,）/w,在/p,朝/p,某个/r,方向/n,移动/vn, ,（/w,单位/n,步长/nz,）/w,距离/n,时/ng, ,，/w,使/v,函数/n,值变/nw,的/u,尽可能/d,的/u,小/a,，/w, ,我们/r,需要/v,沿着/p,梯度/n,负/v,方向/n,的/u,进行/v,移动/vn,./w, , ,沿着/p,梯度/n,方向/n,移动/vn,了/u,一定/d,长度/n,后/f,，/w, ,我们/r,得到/v,了/u,点/q,x/en,_,1/m,与/p,f/en,(/w,x/en,_,1/m,)/w,./w,注意/v,：/w,只有/c,在/p,移动/vn,的/u,距离/n,足够/v,小时/n,，/w, ,我们/r,才能/v,保证/v,移动/vn,后/f,的/u,点/q,x/en,_,1/m,的/u,函数/n,值/n,f/en,(/w,x/en,_,1/m,)/w, ,小于/v,f/en,(/w,x/en,_,0/m,)/w,./w, , ,因为/c,导数/n,针对/p,的/u,是/v,某个/r,点/q,来/v,计算/v,的/u,,/w, ,不同点/n,的/u,导数/n,不/d,一样/u,,/w, ,所以/c,步长/nz,不宜/v,设/v,的/u,太长/n,。/w,(/w,3/m,)/w, ,计算/v,f/en,(/w,x/en,_,1/m,)/w,与/p,f/en,(/w,x/en,_,0/m,)/w,的/u,差值/n,，/w, ,判断/v,单位/n,步长/nz,的/u,移动/vn,带来/v,的/u,函数/n,值/n,的/u,变化/vn,是否/v,已经/d,小于/v,一个/m,我们/r,预设/v,的/u,，/w, ,非常/d,小/a,的/u,一个/m,值/n,。/w,如果/c,小于/v,的话/u,，/w, ,那/r,就/d,不/d,需要/v,再/d,移动/vn,了/u,，/w, ,因为/c,继续/v,移动/vn,的/u,话/n,函数/n,值/n,f/en,（/w,x/en,）/w,的/u,变化/vn,也/d,只/d,会/v,是/v,非常/d,小/a,的/u,。/w,如果/c,本次/r,移动/vn,带来/v,的/u,函数/n,值/n,变化/vn,非常/d,大/a,，/w, ,则/d,说明/v,算法/n,还有/v,进一步/d,迭代/vn,的/u,必要/a,。/w,则/d,重复/v,第二/m,步/q,，/w, ,和/c,第三/nw,步/q,接着/c,我们/r,来说/u,说/v,一个/m,实例/n,因为/c,例子/n,比较/d,简单/a,,/w, ,我们/r,在/p,应用/vn,梯度/n,算法/n,之前/f,先/d,使用/v,在/p,高中/n,学/v,过/u,的/u,令/v,导数/n,等于/v,0/m,计算/v,驻/v,点/q,（/w,极值/nz,点/q,）/w,的/u,方法/n,求/v,$/w,$/w, ,f/en,(/w,x/en,)/w, ,=/w, ,x/en,^,4/m,-/w,3/m,x/en,^,3/m,+/w,2/m, ,$/w,$/w,的/u,最小值/nz,$/w,$/w,f/en,'/w,(/w,x/en,)/w, ,=/w, ,4/m,x/en,^,3/m,-/w,9/m,x/en,^,2/m, ,=/w,x/en,^,2/m,(/w,4/m,x/en,-/w,9/m,)/w,$/w,$/w,令/v,f/en,'/w,(/w,x/en,)/w,=/w,0/m, ,可/v,得/u,驻/v,点/q, ,$/w,$/w,x/en,_,1/m,=/w,0/m,,/w, ,x/en,_,2/m,=/w,2.25/m,$/w,$/w,将/d,驻/v,点/q,代/q,回/v,方程/n, ,可得/v, ,最大值/nz,2/m, ,与/p,最小值/nz, ,-/w,6.54296875/m,将/d,刚才/t,说/v,的/u,算法/n,写/v,成/v,python/en,脚本/n,#, ,-/w,*/w,-/w, ,coding/en,:/w, ,cp/en,936/m, ,-/w,*/w,-/w, ,xold/en, ,=/w, ,0/m, ,xnew/en, ,=/w, ,1/m, ,#, ,the/en, ,algorithm/en, ,starts/en, ,at/en, ,x/en,=/w,6/m, ,movedistance/en, ,=/w, ,0.01/m, ,#, ,step/en, ,size/en, ,precision/en, ,=/w, ,0.00001/m, ,def/en, ,evaluateequation/en,(/w,x/en,)/w,:/w, ,"/w,"/w,"/w,计算/v,原/b,函数/n,在/p,自/p,变量/n,为/p,x/en,时/ng,的/u,值/n,"/w,"/w,"/w, ,return/en, ,x/en,*/w,*/w,4/m,-/w,3/m,*/w,x/en,*/w,*/w,3/m,+/w,2/m, ,def/en, ,evaluategradient/en,(/w,x/en,)/w,:/w, ,"/w,"/w,"/w,计算/v,梯度/n,向/p,量/n,"/w,"/w,"/w, ,return/en, ,4/m, ,*/w, ,x/en,*/w,*/w,3/m, ,-/w, ,9/m, ,*/w, ,x/en,*/w,*/w,2/m, ,step/en,=/w,0/m, ,while/en, ,abs/en,(/w,evaluateequation/en,(/w,xnew/en,)/w, ,-/w, ,evaluateequation/en,(/w,xold/en,)/w,)/w, ,>, ,precision/en,:/w, ,step/en,+/w,=/w,1/m, ,xold/en, ,=/w, ,xnew/en, ,xnew/en, ,=/w, ,xold/en, ,-/w, ,movedistance/en, ,*/w, ,evaluategradient/en,(/w,xnew/en,)/w, ,print/en, ,"/w,step/en,"/w,,/w,step/en,,/w,"/w,xold/en,=/w,"/w,,/w,xold/en,,/w, ,"/w,xnew/en,=/w,"/w,,/w,xnew/en, ,print/en,(/w,"/w,local/en, ,minimum/en, ,occurs/en, ,at/en, ,"/w,,/w, ,xnew/en,,/w, ,"/w,with/en, ,minimum/en, ,value/en,"/w,,/w,evaluateequation/en,(/w,xnew/en,)/w,)/w, ,print/en, ,"/w,step/en,"/w,,/w,step/en,运行/vn,后/f,得到/v,>,>,>, ,step/en, ,1/m, ,xold/en,=/w, ,1/m, ,xnew/en,=/w, ,1.05/m, ,step/en, ,2/m, ,xold/en,=/w, ,1.05/m, ,xnew/en,=/w, ,1.10292/m, ,step/en, ,3/m, ,xold/en,=/w, ,1.10292/m, ,xnew/en,=/w, ,1.1587338169/m, ,step/en, ,4/m, ,xold/en,=/w, ,1.1587338169/m, ,xnew/en,=/w, ,1.21734197218/m, ,step/en, ,5/m, ,xold/en,=/w, ,1.21734197218/m, ,xnew/en,=/w, ,1.27855469659/m, ,step/en, ,6/m, ,xold/en,=/w, ,1.27855469659/m, ,xnew/en,=/w, ,1.34207564416/m, ,step/en, ,7/m, ,xold/en,=/w, ,1.34207564416/m, ,xnew/en,=/w, ,1.40748858095/m, ,step/en, ,8/m, ,xold/en,=/w, ,1.40748858095/m, ,xnew/en,=/w, ,1.47424999816/m, ,step/en, ,9/m, ,xold/en,=/w, ,1.47424999816/m, ,xnew/en,=/w, ,1.54169100548/m, ,step/en, ,10/m, ,xold/en,=/w, ,1.54169100548/m, ,xnew/en,=/w, ,1.60903167429/m, ,step/en, ,11/m, ,xold/en,=/w, ,1.60903167429/m, ,xnew/en,=/w, ,1.67540991642/m, ,step/en, ,12/m, ,xold/en,=/w, ,1.67540991642/m, ,xnew/en,=/w, ,1.73992485396/m, ,step/en, ,13/m, ,xold/en,=/w, ,1.73992485396/m, ,xnew/en,=/w, ,1.80169165901/m, ,step/en, ,14/m, ,xold/en,=/w, 