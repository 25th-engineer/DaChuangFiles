常见/a,分类/vn,模型/n,与/p,算法/n,距离/n,判别法/nw,，/w,即/v,最近/t,邻算法/nw,knn/en,；/w,贝叶斯分类器/nw,；/w,线性/n,判别法/nw,，/w,即/v,逻辑/n,回归/v,算法/n,；/w,决策树/nz,；/w,支持/v,向/p,量机/nw,；/w,神经/n,网络/n,；/w,1/m,./w, ,knn/en,分类/vn,算法/n,原理/n,及/c,应用/vn,1.1/m, ,knn/en,概述/v,k/en,最/d,近邻/n,（/w,k/en,-/w,nearest/en, ,neighbor/en,，/w,knn/en,）/w,分类/vn,算法/n,是/v,最/d,简单/a,的/u,机器/n,学习/v,算法/n,。/w,knn/en,算法/n,的/u,指导/vn,思想/n,是/v,“/w,近朱者赤/nr,，/w,近墨者黑/i,”/w,，/w,由/p,你/r,的/u,邻居/n,来/v,推断/vn,你/r,的/u,类型/n,。/w,本质/n,上/f,，/w,knn/en,算法/n,就/d,是/v,用/p,距离/n,来/v,衡量/v,样本/n,之间/f,的/u,相似/a,度/q,。/w,1.2/m, ,算法/n,图示/v,从/p,训练/vn,集中/v,找到/v,和/c,新/a,数据/n,最/d,接近/v,的/u,k/en,条/q,记录/v,，/w,然后/c,根据/p,多数/m,类/q,来/v,决定/v,新/a,数据/n,类别/n,算法/n,涉及/v,3个/m,主要/b,因素/n,1/m,)/w, ,训练/vn,数据集/nw,2/m,)/w, ,距离/n,或/c,相似/a,度/q,的/u,计算/v,衡量/v,3/m,)/w, ,k/en,的/u,大小/n,算法/n,描述/v,1/m,)/w, ,已知/nz,两类/mq,“/w,先验/n,”/w,数据/n,，/w,分别/d,是/v,蓝/a,方块/n,和/c,红三角/nw,，/w,他们/r,分布/v,在/p,一个/m,二维/nr,空间/n,中/f,；/w,2/m,)/w, ,有/v,一个/m,未知/vn,类别/n,的/u,数据/n,(/w,绿点/nw,)/w,，/w,需要/v,判断/v,它/r,是/v,属于/v,“/w,蓝方/nz,块/q,”/w,还是/c,“/w,红三角/nw,”/w,类/q,；/w,3/m,)/w, ,考察/v,离/v,绿点/nw,最近/t,的/u,3个/m,(/w,或/c,k/en,个/q,)/w,数据点/nw,的/u,类别/n,，/w,占/v,多数/m,的/u,类别/n,即/v,为/p,绿点/nw,判定/v,类别/n,；/w,1.3/m, ,算法/n,要点/n,1/m,./w,3/m,./w,1/m, ,计算/v,步骤/n,计算/v,步骤/n,如下/v,：/w,1/m,)/w, ,算/v,距离/n,：/w,给/p,定/v,测试/vn,对象/n,，/w,计算/v,它/r,与/p,训练/vn,集中/v,的/u,每个/r,对象/n,的/u,距离/n,；/w,2/m,)/w, ,找/v,邻居/n,：/w,圈定/v,距离/n,最近/t,的/u,k/en,个/q,训练/vn,对象/n,，/w,作为/v,测试/vn,对象/n,的/u,近邻/n,；/w,3/m,)/w, ,做/v,分类/vn,：/w,根据/p,这/r,k/en,个/q,近邻/n,归属/vn,的/u,主要/b,类别/n,，/w,来/v,对/p,测试/vn,对象/n,分类/vn,；/w,1/m,./w,3/m,./w,2/m, ,相似/a,度/q,的/u,衡量/v,距离/n,越/d,近/a,应该/v,意味/n,着/u,这/r,两个点/mq,属于/v,一个/m,分类/vn,的/u,可能性/n,越/d,大/a,，/w,但/c,，/w,距离/n,不/d,能/v,代表/n,一切/r,，/w,有些/r,数据/n,的/u,相似/a,度/q,衡量/v,并不/d,适合/v,用/p,距离/n,；/w,相似/a,度/q,衡量/v,方法/n,：/w,包括/v,欧式/b,距离/n,、/w,夹角/n,余弦/n,等/u,。/w,（/w,简单/a,应用/vn,中/f,，/w,一般/a,使用/v,欧式/b,距离/n,，/w,但/c,对于/p,文本/n,分类/vn,来说/u,，/w,使用/v,余弦/n,来/v,计算/v,相似/a,度/q,就/d,比/p,欧式/b,距离/n,更/d,合适/a,）/w,1/m,./w,3/m,./w,3/m, ,类别/n,的/u,判定/v,简单/a,投票法/nw,：/w,少数/m,服从/v,多数/m,，/w,近邻/n,中/f,哪个/r,类别/n,的/u,点/q,最/d,多/a,就/d,分为/v,该类/r,加权/v,投票法/nw,：/w,根据/p,距离/n,的/u,远近/n,，/w,对/p,近邻/n,的/u,投票/v,进行/v,加权/v,，/w,距离/n,越/d,近/a,则/d,权/n,重/a,越/d,大/a,（/w,权重/nz,为/p,距离/n,平方/q,的/u,倒数/v,）/w,1.4/m, ,算法/n,不足/a,之/u,处/n,1/m,./w, ,样本/n,不/d,平衡/a,容易/a,导致/v,结果/n,错误/n,如/v,一个/m,类/q,的/u,样本/n,容量/n,很/d,大/a,，/w,而/c,其他/r,类/q,样本/n,容量/n,很/d,小时/n,，/w,有/v,可能/v,导致/v,当/p,输入/v,一个/m,新/a,样本/n,时/ng,，/w,该/r,样本/n,的/u,k/en,个/q,邻居/n,中大/nz,容量/n,类/q,的/u,样本/n,占/v,多数/m,。/w,改善/v,方法/n,：/w,对/p,此/r,可以/v,采用/v,权值/nw,的/u,方法/n,（/w,和/c,该/r,样本/n,距离/n,小/a,的/u,邻居/n,权值/nw,大/a,）/w,来/v,改进/v,。/w,2/m,./w, ,计算量/nw,较/d,大/a,因为/c,对/p,每/r,一个/m,待/v,分类/vn,的/u,文本/n,都/d,要/v,计算/v,它/r,到/v,全体/n,已知/nz,样本/n,的/u,距离/n,，/w,才/d,能/v,求得/v,它/r,的/u,k/en,个/q,最/d,近邻/n,点/q,。/w,改善/v,方法/n,：/w,实现/v,对/p,已知/nz,样本点/nw,进行/v,剪辑/vn,，/w,事先/d,去除/v,对/p,分类/vn,作用/n,不/d,大/a,的/u,样本/n,。/w,注/v,：/w,该/r,方法/n,比较/d,适用/v,于/p,样本/n,容量/n,比较/d,大/a,的/u,类域/nw,的/u,类域/nw,的/u,分类/vn,，/w,而/c,那些/r,样本/n,容量/n,较/d,小/a,的/u,类域/nw,采用/v,这种/r,算法/n,比较/d,容易/a,产生/v,误/v,分/q,。/w,1.5/m, ,knn/en,分类/vn,算法/n,python/en,实战/n,——/w,knn/en,简单/a,数据/n,分类/vn,实践/v,1/m,./w,5/m,./w,1/m, ,需求/n,计算/v,地理/n,位置/n,的/u,相似/a,度/q,有/v,以下/f,先验/n,数据/n,，/w,使用/v,knn/en,算法/n,对/p,未知/vn,类别/n,数据/n,分类/vn,属性/n,1/m,属性/n,2/m,类别/n,1/m,./w,00/m,./w,9/m,a/en,1/m,./w,01/m,./w,0/m,a/en,0/m,./w,10/m,./w,2/m,b/en,0/m,./w,00/m,./w,1/m,b/en,未知/vn,类别/n,数据/n,属性/n,1/m,属性/n,2/m,类别/n,1/m,./w,21/m,./w,0/m,?/w,0/m,./w,10/m,./w,3/m,?/w,1/m,./w,5/m,./w,2/m, ,python/en,实现/v,首先/d,，/w,我们/r,新建/v,一个/m,knn/en,./w,py/en,脚本/n,文件/n,，/w,文件/n,里面/f,包含/v,两个/m,函数/n,，/w,一个/m,用/p,来/v,生成/vn,小数据集/nw,，/w,一个/m,实现/v,knn/en,分类/vn,算法/n,。/w,代码/n,如下/v,：/w,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#, ,#, ,knn/en,:/w, ,k/en, ,nearest/en, ,neighbors/en, ,#,输入/v,：/w,newinput/en,:/w, ,(/w,1/m,xn/en,)/w,的/u,待/v,分类/vn,向/p,量/n, ,#, ,dataset/en,:/w, ,(/w,nxm/en,)/w,的/u,训练/vn,数据集/nw, ,#, ,labels/en,:/w, ,训练/vn,数据集/nw,的/u,类别/n,标签/n,向/p,量/n, ,#, ,k/en,:/w, ,近邻/n,数/m, ,#, ,输出/v,：/w,可能性/n,最/d,大/a,的/u,分类/vn,标签/n, ,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#,#, ,from/en, ,numpy/en, ,import/en, ,import/en, ,operator/en, ,#,创建/v,一个/m,数据集/nw,，/w,包含/v,2个/m,类别/n,共/d,4个/m,样本/n, ,def/en, ,createdataset/en,(/w,)/w,:/w, ,#, ,生成/vn,一个/m,矩阵/n,，/w,每/r,行/v,表示/v,一个/m,样本/n, ,group/en, ,=/w, ,array/en,(/w,[/w,[/w,1.0/m,,/w,0.9/m,]/w,,/w,[/w,1.0/m,,/w,1.0/m,]/w,,/w,[/w,0.1/m,,/w,0.2/m,]/w,,/w,[/w,0.0/m,,/w,0.1/m,]/w,]/w,)/w, ,#, ,4个/m,样本/n,分别/d,所/u,属/v,的/u,类别/n, ,labels/en, ,=/w, ,[/w,'/w,a/en,'/w,,/w, ,'/w,a/en,'/w,,/w, ,'/w,b/en,'/w,,/w, ,'/w,b/en,'/w,]/w, ,return/en, ,group/en,,/w, ,labels/en, ,#, ,knn/en,分类/vn,算法/n,函数/n,定义/n, ,def/en, ,knnclassify/en,(/w,newinput/en,,/w, ,dataset/en,,/w, ,labels/en,,/w, ,k/en,)/w,：/w, ,numsamples/en, ,=/w, ,dataset/en,./w,shape/en,[/w,0/m,]/w, ,#,shape/en,[/w,0/m,]/w,表示/v,行数/n, ,#,#, ,step/en,1/m,：/w,计算/v,距离/n, ,#, ,tile/en,(/w,a/en,,/w, ,reps/en,)/w,：/w,构造/v,一个/m,矩阵/n,，/w,通过/p,a/en,重复/v,reps/en,次/q,得到/v, ,#, ,the/en, ,following/en, ,copy/en, ,numsamples/en, ,rows/en, ,for/en, ,dataset/en, ,diff/en, ,=/w, ,tile/en,(/w,newinput/en,,/w, ,(/w,numsamples/en,,/w, ,1/m,)/w,)/w, ,-/w,dataset/en, ,#,按/p,元素/n,求/v,差值/n, ,squarediff/en, ,=/w, ,diff/en, ,*/w,*/w, ,2/m, ,#,将/d,差值/n,平方/q, ,squaredist/en, ,=/w, ,sum/en,(/w,squareddiff/en,,/w, ,axis/en, ,=/w, ,1/m,)/w, ,#, ,按/p,行/v,累加/v, ,#,#,step/en,2/m,：/w,对/p,距离/n,排序/vn, ,#, ,argsort/en,(/w,)/w, ,返回/v,排序/vn,后/f,的/u,索引/n,值/n, ,sorteddistindices/en, ,=/w, ,argsort/en,(/w,distance/en,)/w, ,classcount/en, ,=/w, ,{/w,}/w, ,#, ,define/en, ,a/en, ,dictionary/en, ,(/w,can/en, ,be/en, ,append/en, ,element/en,)/w, ,for/en, ,i/en, ,in/en, ,xrange/en,(/w,k/en,)/w,:/w, ,#,#,step/en, ,3/m,:/w, ,选择/v,k/en,个/q,最近/t,邻/vg, ,votelabel/en, ,=/w, ,labels/en,[/w,sorteddistindices/en,[/w,i/en,]/w,]/w, ,#,#, ,step/en, ,4/m,:/w,计算/v,k/en,个/q,最近/t,邻/vg,中/f,各/r,类别/n,出现/v,的/u,次数/n, ,#, ,when/en, ,the/en, ,key/en, ,votelabel/en, ,is/en, ,not/en, ,in/en, ,dictionary/en, ,classcount/en,，/w,get/en,(/w,)/w, ,#, ,will/en, ,return/en, ,0/m, ,classcount/en,[/w,votelabel/en,]/w, ,=/w, ,classcount/en,./w,get/en,(/w,votelabel/en,,/w, ,0/m,)/w, ,+/w, ,1/m, ,#,#,step/en, ,5/m,：/w,返回/v,出现/v,次数/n,最/d,多/a,的/u,类别/n,标签/n, ,maxcount/en, ,=/w, ,0/m, ,for/en, ,key/en,,/w, ,value/en, ,in/en, ,classcount/en,./w,items/en,(/w,)/w,:/w, ,if/en, ,value/en, ,>, ,maxcount/en,:/w, ,maxcount/en, ,=/w, ,value/en, ,maxindex/en, ,=/w, ,key/en, ,return/en, ,maxindex/en,然后/c,调用/v,算法/n,进行/v,测试/vn,import/en, ,knn/en, ,from/en, ,numpy/en, ,import/en, ,*/w, ,#,生成/vn,数据集/nw,和/c,类别/n,标签/n, ,dataset/en,,/w,labels/en, ,=/w, ,knn/en,./w,createdataset/en,(/w,)/w, ,#,定义/n,一个/m,未知/vn,类别/n,的/u,数据/n, ,testx/en, ,=/w, ,array/en,(/w,[/w,1.2/m,,/w, ,1.0/m,]/w,)/w, ,k/en,=/w,3/m, ,#,调用/v,分类/vn,函数/n,对/p,未知/vn,数据/n,分类/vn, ,outputlabel/en, ,=/w, ,knn/en,./w,knnclassify/en,(/w,testx/en,,/w, ,dataset/en,,/w, ,labels/en,,/w, ,3/m,)/w, ,print/en, ,"/w,your/en, ,input/en, ,is/en,:/w,"/w,,/w, ,testx/en,,/w, ,"/w, ,and/en, ,classified/en, ,to/en, ,class/en,:/w,"/w,,/w, ,outputlabel/en, ,testx/en, ,=/w, ,array/en,(/w,[/w,0.1/m,,/w, ,0.3/m,]/w,)/w, ,outputlabel/en, ,=/w, ,knn/en,./w,knnclassify/en,(/w,testx/en,,/w,dataset/en,,/w, ,labels/en,,/w, ,3/m,)/w, ,print/en, ,"/w,your/en, ,input/en, ,is/en,:/w,"/w,,/w, ,testx/en,,/w, ,"/w,and/en, ,classified/en, ,to/en, ,class/en,:/w,"/w,,/w, ,outputlabel/en,这时候/r,会/v,输出/v,：/w,your/en, ,input/en, ,is/en,:/w, ,[/w,1.2/m, ,1.0/m,]/w, ,and/en, ,classified/en, ,to/en, ,class/en,:/w, ,a/en, ,your/en, ,input/en, ,is/en,:/w, ,[/w,0.1/m, ,0.3/m,]/w, ,and/en, ,classified/en, ,to/en, ,class/en,:/w, ,b/en,2/m,./w, ,朴素/a,贝叶斯/nr,分类/vn,算法/n,原理/n,2.1/m, ,概述/v,贝叶斯/nr,分类/vn,算法/n,时/ng,一/m,大/a,类/q,分类/vn,算法/n,的/u,总称/n,。/w,贝叶斯/nr,分类/vn,算法/n,以/p,样本/n,可能/v,属于/v,某/r,类/q,的/u,概率/n,来/v,作为/v,分类/vn,依据/n,。/w,朴素/a,贝叶斯/nr,分类/vn,算法/n,时/ng,贝叶斯/nr,分类/vn,算法/n,中/f,最/d,简单/a,的/u,一种/mq,。/w,注/v,：/w,朴素/a,的/u,意思/n,时/ng,条件/n,概率/n,独立性/n,2.2/m, ,算法/n,思想/n,朴素/a,贝叶斯/nr,的/u,思想/n,是/v,这样/r,的/u,：/w,如果/c,一个/m,事物/n,在/p,一些/m,属性/n,条件/n,发生/v,的/u,情况/n,下/f,，/w,事物/n,属于/v,a/en,的/u,概率/n,>,属于/v,b/en,的/u,概率/n,，/w,则/d,判定/v,事物/n,属于/v,a/en,。/w,通俗/a,来说/u,比如/v,，/w,在/p,某/r,条/q,大街/n,上/f,，/w,有/v,100人/mq,，/w,其中/r,有/v,50个/m,美国/ns,人/n,，/w,50个/m,非洲/ns,人/n,，/w,看到/v,一个/m,讲/v,英语/nz,的/u,黑人/n,，/w,那么/r,我们/r,是/v,怎么/r,去/v,判断/v,他/r,来自/v,哪里/r,？/w,提取/v,特征/n,：/w,肤色/n,：/w,黑/a,，/w,语言/n,：/w,英语/nz,先验/n,知识/n,：/w,p/en,(/w,黑色/n,|/w,非洲/ns,人/n,)/w, ,=/w, ,0.8/m,p/en,(/w,讲/v,英语/nz,|/w,非洲/ns,人/n,)/w,=/w,0.1/m,p/en,(/w,黑色/n,|/w,美国/ns,人/n,)/w,=/w, ,0.2/m,p/en,(/w,讲/v,英语/nz,|/w,美国/ns,人/n,)/w,=/w,0.9/m,要/v,判断/v,的/u,概率/n,是/v,：/w,p/en,(/w,非洲/ns,人/n,|/w,(/w,讲/v,英语/nz,，/w,黑色/n,)/w, ,)/w,p/en,(/w,美国/ns,人/n,|/w,(/w,讲/v,英语/nz,，/w,黑色/n,)/w, ,)/w,思考/v,过程/n,：/w,p/en,(/w,非洲/ns,人/n,|/w,(/w,讲/v,英语/nz,，/w,黑色/n,)/w, ,)/w, , , ,的/u, ,分子/n,=/w, ,0.1/m, ,*/w, ,0.8/m, ,*/w,0.5/m, ,=/w,0.04/m,p/en,(/w,美国/ns,人/n,|/w,(/w,讲/v,英语/nz,，/w,黑色/n,)/w, ,)/w, , , ,的/u, ,分子/n,=/w, ,0.9/m, ,*/w,0.2/m, ,*/w, ,0.5/m, ,=/w, ,0.09/m,从而/c,比较/d,这/r,两个/m,概率/n,的/u,大小/n,就/d,等价/vn,于/p,比较/d,这/r,两个/m,分子/n,的/u,值/n,，/w,可以/v,得出/v,结论/n,，/w,此人/r,应该/v,是/v,：/w,美国/ns,人/n,。/w,其/r,蕴含/v,的/u,数学/n,原理/n,如下/v,：/w,p/en,(/w,a/en,|/w,xy/en,)/w,=/w,p/en,(/w,axy/en,)/w,//w,p/en,(/w,xy/en,)/w,=/w,p/en,(/w,axy/en,)/w,//w,p/en,(/w,x/en,)/w,p/en,(/w,y/en,)/w,=/w,p/en,(/w,a/en,)/w,//w,p/en,(/w,x/en,)/w,*/w,p/en,(/w,a/en,)/w,//w,p/en,(/w,y/en,)/w,*/w, ,p/en,(/w,xy/en,)/w,//w,p/en,(/w,xy/en,)/w,=/w,p/en,(/w,a/en,|/w,x/en,)/w,p/en,(/w,a/en,|/w,y/en,)/w,朴素/a,贝叶斯/nr,分类器/nw,讲/v,了/u,上面/f,的/u,小/a,故事/n,，/w,我们/r,来/v,朴素/a,贝叶斯分类器/nw,的/u,表示/v,形式/n,：/w,当/p,特征/n,为/p,为/p,x/en,时/ng,，/w,计算/v,所有/b,类别/n,的/u,条件/n,概率/n,，/w,选取/v,条件/n,概率/n,最/d,大/a,的/u,类别/n,作为/v,待/v,分类/vn,的/u,类别/n,。/w,由于/c,上/f,公式/n,的/u,分母/n,对/p,每个/r,类别/n,都/d,是/v,一样/u,的/u,，/w,因此/c,计算/v,时/ng,可以/v,不/d,考虑/v,分母/n,，/w,即/v,朴素/a,贝叶斯/nr,的/u,朴素/a,体现/v,在/p,其/r,对/p,各个/r,条件/n,的/u,独立性/n,假设/v,上/f,，/w,加上/v,独立/v,假设/v,后/f,，/w,大大/d,减少/v,了/u,参数/n,假设/v,空间/n,。/w,2.3/m, ,算法/n,要点/n,2/m,./w,3/m,./w,1/m, ,算法/n,步骤/n,1/m,./w, ,分解/v,各类/r,先验/n,样本/n,数据/n,中/f,的/u,特征/n,；/w,2/m,./w, ,计算/v,各类/r,数据/n,中/f,，/w,各/r,特征/n,的/u,条件/n,概率/n,；/w,(/w,比如/v,：/w,特征/n,1/m,出现/v,的/u,情况/n,下/f,，/w,属于/v,a/en,类/q,的/u,概率/n,p/en,(/w,a/en,|/w,特征/n,1/m,)/w,，/w,属于/v,b/en,类/q,的/u,概率/n,p/en,(/w,b/en,|/w,特征/n,1/m,)/w,，/w,属于/v,c/en,类/q,的/u,概率/n,p/en,(/w,c/en,|/w,特征/n,1/m,)/w,./w,./w,./w,./w,./w,./w,)/w,3/m,./w, ,分解/v,待/v,分类/vn,数据/n,中/f,的/u,特征/n,(/w,特征/n,1/m,、/w,特征/n,2/m,、/w,特征/n,3/m,、/w,特征/n,4/m,./w,./w,./w,./w,./w,./w,)/w,4/m,./w, ,计算/v,各/r,特征/n,的/u,各/r,条件/n,概率/n,的/u,乘积/n,，/w,如下/v,所/u,示/vg,：/w,判断/v,为/p,a/en,类/q,的/u,概率/n,：/w,p/en,(/w,a/en,|/w,特征/n,1/m,)/w, ,*/w, ,p/en,(/w,a/en,|/w,特征/n,2/m,)/w, ,*/w, ,p/en,(/w,a/en,|/w,特征/n,3/m,)/w, ,*/w, ,p/en,(/w,a/en,|/w,特征/n,4/m,)/w,./w,./w,./w,./w,./w,./w,判断/v,为/p,b/en,类/q,的/u,概率/n,：/w,p/en,(/w,b/en,|/w,特征/n,1/m,)/w, ,*/w, ,p/en,(/w,b/en,|/w,特征/n,2/m,)/w, ,*/w, ,p/en,(/w,b/en,|/w,特征/n,3/m,)/w, ,*/w, ,p/en,(/w,b/en,|/w,特征/n,4/m,)/w,./w,./w,./w,./w,./w,./w,判断/v,为/p,c/en,类/q,的/u,概率/n,：/w,p/en,(/w,c/en,|/w,特征/n,1/m,)/w, ,*/w, ,p/en,(/w,c/en,|/w,特征/n,2/m,)/w, ,*/w, ,p/en,(/w,c/en,|/w,特征/n,3/m,)/w, ,*/w, ,p/en,(/w,c/en,|/w,特征/n,4/m,)/w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,./w,5/m,./w, ,结果/n,中/f,的/u,最大值/nz,就/d,是/v,该/r,样本/n,所/u,属/v,的/u,类别/n,2/m,./w,3/m,./w,2/m, ,算法/n,应用/vn,举例/v,大众/n,点评/v,、/w,淘宝/n,等/u,电商/nz,上/f,都/d,会/v,有/v,大量/m,的/u,用户/n,评论/n,，/w,比如/v,：/w,1/m,、/w,衣服/n,质量/n,太/d,差/a,了/u,！/w,！/w,！/w,！/w,颜色/n,根本/a,不/d,纯/a,！/w,！/w,！/w,2/m,、/w,我/r,有/v,一/m,有/v,种/q,上当/v,受骗/v,的/u,感觉/n,！/w,！/w,！/w,！/w,3/m,、/w,质量/n,太/d,差/a,，/w,衣服/n,拿/v,到/v,手/n,感觉/n,像/v,旧货/n,！/w,！/w,！/w,4/m,、/w,上身/s,漂亮/a,，/w,合身/a,，/w,很/d,帅/vg,，/w,给/p,卖/v,家/q,点/q,赞/vg,5/m,、/w,穿/v,上/f,衣服/n,帅/vg,呆/v,了/u,，/w,给/p,点一万/nw,个/q,赞/vg,6/m,、/w,我/r,在/p,他家/r,买/v,了/u,三件/mq,衣服/n,！/w,！/w,！/w,！/w,质量/n,都/d,很/d,差/a,！/w,000110/m,其中/r,1/m,//w,2/m,//w,3/m,//w,6/m,是/v,差评/nw,，/w,4/m,//w,5/m,是/v,好评/n,现在/t,需要/v,使用/v,朴素/a,贝叶斯/nr,分类/vn,算法/n,来/v,自动/d,分类/vn,其他/r,的/u,评论/n,，/w,比如/v,：/w,a/en,、/w,这么/r,差/a,的/u,衣服/n,以后/f,再也/d,不/d,买/v,了/u,b/en,、/w,帅/vg,，/w,有/v,逼格/nw,……/w,2/m,./w,3/m,./w,3/m, ,算法/n,应用/vn,流程/n,1/m,./w, ,分解/v,出/v,先验/n,数据/n,中/f,的/u,各/r,特征/n,(/w,即/v,分词/v,，/w,比如/v,“/w,衣服/n,”/w,，/w,“/w,质量/n,太/d,差/a,”/w,，/w,“/w,差/a,”/w,，/w,“/w,不/d,纯/a,”/w,，/w,“/w,帅/vg,”/w,，/w,“/w,漂亮/a,”/w,，/w,“/w,赞/vg,”/w, ,./w,./w,./w,./w,./w,./w,)/w,2/m,./w, ,计算/v,各/r,类别/n,（/w,好评/n,、/w,差评/nw,）/w,中/f,，/w,各/r,特征/n,的/u,条件/n,概率/n,(/w,比如/v, ,p/en,(/w,“/w,衣服/n,”/w, ,|/w, ,差评/nw,)/w,、/w,p/en,(/w,“/w,衣服/n,”/w, ,|/w, ,好评/n,)/w,、/w,p/en,(/w,“/w,差/a,”/w,|/w,好评/n,)/w,、/w,p/en,(/w,“/w,差/a,”/w,|/w, ,差评/nw,)/w, ,./w,./w,./w,./w,./w,./w,)/w,3/m,./w, ,计算/v,类别/n,概率/n,p/en,(/w,好评/n,|/w,(/w,c/en,1/m,,/w,c/en,2/m,,/w,c/en,5/m,,/w,c/en,8/m,)/w,)/w,的/u,分子/n,=/w,p/en,(/w,c/en,1/m,|/w,好评/n,)/w, ,*/w, ,p/en,(/w,c/en,2/m,|/w,好评/n,)/w, ,*/w, ,p/en,(/w,c/en,3/m,|/w,好评/n,)/w, ,*/w,./w,./w,./w,./w,./w,./w,p/en,(/w,好评/n,)/w,p/en,(/w,差评/nw,|/w,(/w,c/en,1/m,,/w,c/en,2/m,,/w,c/en,5/m,,/w,c/en,8/m,)/w,)/w,的/u,分子/n,=/w,p/en,(/w,c/en,1/m,|/w,差评/nw,)/w, ,*/w, ,p/en,(/w,c/en,2/m,|/w,差评/nw,)/w, ,*/w, ,p/en,(/w,c/en,3/m,|/w,差评/nw,)/w, ,*/w,./w,./w,./w,./w,./w,./w,p/en,(/w,差评/nw,)/w,4/m,./w, ,显然/ad,p/en,(/w,差评/nw,)/w,的/u,结果/n,值/n,更/d,大/a,，/w,因此/c,a/en,被/p,判别/vn,为/p,"/w,差评/nw,"/w,2.4/m, ,朴素/a,贝叶斯/nr,分类/vn,算法/n,案例/n,2/m,./w,4/m,./w,1/m, ,需求/n,利用/v,大量/m,邮件/n,先验/n,数据/n,，/w,使用/v,朴素/a,贝叶斯/nr,分类/vn,算法/n,来/v,自动/d,识别/v,垃圾/n,邮件/n,2/m,./w,4/m,./w,2/m, ,python/en,实现/v,#,过滤/v,垃圾/n,邮件/n, ,def/en, ,textparse/en,(/w,bigstring/en,)/w,:/w, ,#,正/d,则/d,表达/v,式/k,进行/v,文本/n,解析/v, ,import/en, ,re/en, ,listoftokens/en, ,=/w, ,re/en,./w,split/en,(/w,r/en,'/w,\/w,w/en,*/w,'/w,,/w, ,bigstring/en,)/w, ,return/en, ,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>, ,2/m,]/w, ,def/en, ,spamtest/en,(/w,)/w, ,doclist/en, ,=/w, ,[/w,]/w,;/w, ,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1/m,,/w,26/m,)/w,:/w, ,#,导入/v,并/c,解析/v,文本文件/n, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,spam/en,//w,%/w,d/en,./w,txt/en,'/w,%/w,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,ham/en,//w,%/w,d/en,./w,txt/en,'/w,%/w,i/en,)/w,./w,read/en,(/w,)/w,)/w, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,classlist/en,./w,append/en,(/w,0/m,)/w, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w, ,trainingset/en, ,=/w, ,range/en,(/w,50/m,)/w,;/w,testset/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,#,随/v,机构/n,建/v,训练/vn,集/vg, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w, ,len/en,(/w,trainingset/en,)/w,)/w,)/w, ,testset/en,./w,append/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,#,随机/d,挑选/v,一个/m,文档/n,索引号/nw,放/v,入/v,测试/vn,集/vg, ,del/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,#,将/d,该/r,文档/n,索引号/nw,从/p,训练/vn,集中/v,剔除/v, ,trainmat/en, ,=/w, ,[/w,]/w,;/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,for/en, ,docindex/en, ,in/en, ,trainingset/en,:/w, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w,)/w, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en,]/w,)/w, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en, ,=/w, ,trainnbo/en,(/w,array/en,(/w,trainmat/en,)/w,,/w, ,array/en,(/w,trainclasses/en,)/w,)/w, ,errorcount/en, ,=/w, ,0/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,#,对/p,测试/vn,集/vg,进行/v,分类/vn, ,wordvector/en, ,=/w, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en, ,!/w,=/w, ,classlist/en,[/w,docindex/en,]/w,:/w, ,errorcount/en, ,+/w,=/w,1/m, ,print/en, ,'/w,the/en, ,error/en, ,rate/en, ,is/en,:/w,'/w,,/w, ,float/en,(/w,errorcount/en,)/w,//w,len/en,(/w,testset/en,)/w,3/m,./w, ,logistic/en,逻辑/n,回归/v,分类/vn,算法/n,及/c,应用/vn,3.1/m, ,概述/v,lineage/en,逻辑/n,回归/v,是/v,一种/mq,简单/a,而/c,又/d,效果/n,不错/a,的/u,分类/vn,算法/n,。/w,什么/r,是/v,回归/v,：/w,比如说/l,我们/r,有/v,两类/mq,数据/n,，/w,各/r,有/v,50个点/mq,组成/v,，/w,当/p,我们/r,把/p,这些/r,点/q,画/v,出来/v,，/w,会/v,有/v,一条/mq,线/n,区分/v,这/r,两组/mq,数据/n,，/w,我们/r,拟合/nz,出/v,这个/r,曲线/n,（/w,因为/c,很/d,有/v,可能/v,是非线性/nw,的/u,）/w,，/w,就/d,是/v,回归/v,。/w,我们/r,通过/p,大量/m,的/u,数据/n,找/v,出/v,这/r,条/q,线/n,，/w,并/c,拟合/nz,出/v,这/r,条/q,线/n,的/u,表达式/n,，/w,再/d,有/v,新/a,数据/n,，/w,我们/r,就/d,以/p,这/r,条/q,线/n,为/p,区分/v,来/v,实现/v,分类/vn,。/w,下/f,图/n,是/v,一个/m,数据集/nw,的/u,两组/mq,数据/n,，/w,中间/f,有/v,一条/mq,区分/v,两组/mq,数据/n,的/u,线/n,。/w,显然/ad,，/w,只有/c,这种/r,线性/n,可/v,分/q,的/u,数据/n,分布/v,才/d,适合/v,用/p,线性/n,逻辑/n,回归/v,3.2/m, ,算法/n,思想/n,lineage/en,回归/v,分类/vn,算法/n,就/d,是/v,将/d,线性/n,回归/v,应用/vn,在/p,分类/vn,场景/n,中/f,在/p,该/r,场景/n,中/f,，/w,计算/v,结果/n,是/v,要/v,得到/v,对/p,样本/n,数据/n,的/u,分类/vn,标签/n,，/w,而/c,不/d,是/v,得到/v,那/r,条/q,回归/v,直线/n,3/m,./w,2/m,./w,1/m, ,算法/n,图示/v,1/m,)/w, ,算法/n,目标/n,(/w,)/w,？/w,大白话/n,：/w,计算/v,各/r,点/q,的/u,y/en,值/n,到/v,拟合/nz,线/n,的/u,垂直/v,距离/n,，/w,如果/c,距离/n,>,0/m,，/w,分为/v,类/q,a/en,；/w,距离/n,</w,0/m,，/w,分为/v,类/q,b/en,。/w,2/m,)/w, ,如何/r,得到/v,拟合/nz,线呢/n,？/w,大白话/n,：/w,只能/v,先/d,假设/v,，/w,因为/c,线/n,或/c,面/q,的/u,函数/n,都/d,可以/v,表/n,达成/v,y/en,(/w,拟合/nz,)/w,=/w,w/en,1/m, ,*/w, ,x/en,1/m, ,+/w, ,w/en,2/m, ,*/w, ,x/en,2/m, ,+/w, ,w/en,3/m, ,*/w, ,x/en,3/m, ,+/w, ,./w,./w,./w, ,，/w,其中/r,的/u,w/en,是/v,待定/v,参数/n,，/w,而/c,x/en,是/v,数据/n,的/u,各/r,维度/n,特征/n,值/n,，/w,因而/c,上述/b,问题/n,就/d,变成/v,了/u,样本/n,y/en,(/w,x/en,)/w, ,-/w, ,y/en,(/w,拟合/nz,)/w, ,>, ,0/m,?/w, ,a/en,：/w,b/en,3/m,)/w, ,如何/r,求解/v,出/v,一套/mq,最/d,优/ag,的/u,w/en,参数/n,呢/y,?/w,基本/a,思路/n,：/w,代入/n,”/w,先验/n,数据/n,“/w,来/v,逆/vg,推/v,求解/v,，/w,但/c,针对/p,不等/v,式/k,求解/v,参数/n,极其/d,困难/an,，/w,通用/vn,的/u,解决/v,方法/n,，/w,将/d,对/p,不等式/n,的/u,求解/v,做/v,一个/m,转换/v,：/w,a/en,./w,将/d,”/w,样本/n,y/en,(/w,x/en,)/w, ,-/w, ,y/en,(/w,拟合/nz,)/w,“/w,的/u,差值/n,压缩/v,到/v,一个/m,0/m,~/w,1/m,的/u,小/a,区间/n,；/w,b/en,./w,然后/c,代入/n,大量/m,的/u,样本/n,特征/n,值/n,，/w,从而/c,得到/v,一系列/mq,的/u,输出/v,结果/n,；/w,c/en,./w,再/d,将/d,这些/r,输出/v,结果/n,跟/p,样本/n,的/u,先验/n,类别/n,比较/d,，/w,并/c,根据/p,比较/d,情况/n,来/v,调整/vn,拟合/nz,线/n,的/u,参数/n,值/n,，/w,从而/c,是/v,拟合/nz,线/n,的/u,参数/n,逼近/v,最/d,优/ag,。/w,从而/c,将/d,问题/n,转化/v,为/p,逼近/v,求解/v,的/u,典型/n,数学/n,问题/n,。/w,3/m,./w,2/m,./w,2/m, ,sigmoid/en,函数/n,上述/b,算法/n,思路/n,中/f,，/w,通常/d,使用/v,sigmoid/en,函数/n,作为/v,转换/v,函数/n,函数/n,表达/v,式/k,：/w,，/w,注/v,：/w,此处/s,的/u,x/en,是/v,向/p,量/n,函数/n,曲线/n,：/w,之所以/c,使用/v,sigmoid/en,函数/n,，/w,就/d,是/v,让/v,样板/n,点/q,经过/p,运算/vn,后/f,得到/v,的/u,结果/n,限制/v,在/p,0/m,~/w,1/m,之间/f,，/w,压缩/v,数据/n,的/u,巨幅/b,震荡/vn,，/w,从而/c,方便/a,得到/v,样本点/nw,的/u,分类/vn,标签/n,(/w,分类/vn,以/p,sigmoid/en,函数/n,的/u,计算/v,结果/n,是否/v,大于/v,0.5/m,为/p,依据/n,)/w,3.3/m, ,算法/n,实现/v,分析/vn,1/m,./w,3/m,./w,1/m, ,实现/v,思路/n,算法/n,思想/n,的/u,数学/n,表述/vn,把/p,数据集/nw,的/u,特征/n,值/n,设/v,为/p,x/en,1/m,，/w,x/en,2/m,，/w,x/en,3/m,./w,./w,./w,./w,./w,./w,，/w,求/v,出/v,它们/r,的/u,回归/v,系数/n,wj/en,，/w,设/v,z/en,=/w,w/en,1/m, ,*/w, ,x/en,1/m, ,+/w, ,w/en,2/m, ,*/w, ,x/en,2/m,./w,./w,./w,./w,./w,./w,，/w,然后/c,将/d,z/en,值/n,代入/n,sigmoid/en,函数/n,并/c,判断/v,结果/n,，/w,即可/v,得到/v,分类/vn,标签/n,问题/n,在于/v,如何/r,得到/v,一组/mq,合适/a,的/u,参数/n,wj/en,？/w,通过/p,解析/v,的/u,途径/n,很/d,难/a,求解/v,，/w,而/c,通过/p,迭代/vn,的/u,方法/n,可以/v,比较/d,便捷/a,地/u,找到/v,最/d,优解/nw,。/w,简单/a,来说/u,，/w,就/d,是/v,不断/d,用/p,样本/n,特征/n,值代/nw,入算式/nw,，/w,计算/v,出/v,结果/n,后/f,跟/p,其/r,实际/n,标签/n,进行/v,比较/d,，/w,根据/p,差值/n,来/v,修正/v,参数/n,，/w,然后/c,再/d,代/q,入/v,新/a,的/u,样本/n,值/n,计算/v,，/w,循环往复/l,，/w,直到/v,无需/v,修正/v,或/c,已/d,到达/v,预设/v,的/u,迭代/vn,次数/n,。/w,注/v,：/w,此/r,过程/n,用/p,梯度/n,上升/v,来/v,实现/v,。/w,1/m,./w,3/m,./w,2/m, ,梯度/n,上升/v,算法/n,梯度/n,上升/v,是/v,指/v,找到/v,函数/n,增长/v,的/u,方向/n,。/w,在/p,具体/a,实现/v,的/u,过程/n,中/f,，/w,不停/v,地/u,迭代/vn,运算/vn,直到/v,w/en,的/u,值/n,几乎/d,不再/d,变化/vn,为止/u,。/w,如/v,图/n,所/u,示/vg,：/w,3.4/m, ,lineage/en,逻辑/n,回归/v,分类/vn,python/en,实战/n,3/m,./w,4/m,./w,1/m, ,需求/n,对/p,给/p,定/v,的/u,先验/n,数据集/nw,，/w,使用/v,logistic/en,回归/v,算法/n,对/p,新/a,数据/n,分类/vn,3/m,./w,4/m,./w,2/m, ,python/en,实现/v,3/m,./w,4/m,./w,2/m,./w,1/m, ,定义/n,sigmoid/en,函数/n,def/en, ,loaddataset/en,(/w,)/w,:/w, ,datamat/en, ,=/w, ,[/w,]/w,;/w, ,labelmat/en, ,=/w, ,[/w,]/w, ,fr/en, ,=/w, ,open/en,(/w,'/w,d/en,:/w,//w,testset/en,./w,txt/en,'/w,)/w, ,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w, ,linearr/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w, ,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w, ,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w, ,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w, ,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w, ,return/en, ,datamat/en,,/w, ,labelmat/en, ,def/en, ,sigmoid/en,(/w,inx/en,)/w,:/w, ,return/en, ,1.0/m,//w,(/w,1/m,+/w,exp/en,(/w,-/w,inx/en,)/w,)/w,3/m,./w,4/m,./w,2/m,./w,2/m, ,返回/v,回归/v,系数/n,对应/v,于/p,每个/r,特征/n,值/n,，/w,for/en,循环/vn,实现/v,了/u,递/v,归/v,梯度/n,上升/v,算法/n,。/w,def/en, ,gradascent/en,(/w,datamatln/en,,/w, ,classlabels/en,)/w,:/w, ,datamatrix/en, ,=/w, ,mat/en,(/w,datamatln/en,)/w, ,#, ,将/d,先验/n,数据集/nw,转换/v,为/p,numpy/en,矩阵/n, ,labelmat/en, ,=/w, ,mat/en,(/w,classlabels/en,)/w,./w,transpose/en,(/w,)/w, ,#,将/d,先验/n,数据/n,的/u,类/q,标签/n,转换/v,为/p,numpy/en,矩阵/n, ,m/en,,/w,n/en, ,=/w, ,shape/en,(/w,datamatrix/en,)/w, ,alpha/en, ,=/w, ,0.001/m, ,#,设置/v,逼近/v,步长/nz,调整/vn,系数/n, ,maxcycles/en, ,=/w, ,500/m, ,#,设置/v,最/d,大/a,迭代/vn,次数/n,为/p,500/m, ,weights/en, ,=/w, ,ones/en,(/w,(/w,n/en,,/w,1/m,)/w,)/w, ,#,weights/en,即/v,为/p,需要/v,迭代/vn,求解/v,的/u,参数/n,向/p,量/n, ,for/en, ,k/en, ,in/en, ,range/en,(/w,maxcycles/en,)/w,:/w, ,#,heavy/en, ,on/en, ,matrix/en, ,operations/en, ,h/en, ,=/w, ,sigmoid/en,(/w,datamatrix/en, ,*/w, ,weights/en,)/w, ,#,代入/n,样本/n,向量/n,求得/v,“/w,样本/n,y/en,”/w, ,sigmoid/en,转换/v,值/n, ,error/en, ,=/w, ,(/w,labelmat/en, ,-/w, ,h/en,)/w, ,#,求/v,差/a, ,weights/en, ,=/w, ,weights/en, ,+/w, ,alpha/en, ,*/w, ,datamatrix/en,./w,transpose/en,(/w,)/w, ,*/w, ,error/en, ,#,根据/p,差值/n,调整/vn,参数/n,向/p,量/n, ,return/en, ,weights/en,我们/r,的/u,数据集/nw,有/v,两个/m,特征/n,值/n,分别/d,是/v,x/en,1/m,,/w,x/en,2/m,。/w,在/p,代码/n,中/f,又/d,增设/v,了/u,x/en,0/m,变量/n,。/w,结果/n,，/w,返回/v,了/u,特征/n,值/n,的/u,回归/v,系数/n,：/w,[/w,[/w,4.12414349/m,]/w,[/w,0.48007329/m,]/w,[/w,-/w,0.6168482/m,]/w,]/w,我们/r,得出/v,x/en,1/m,和/c,x/en,2/m,的/u,关系/n,(/w,设/v,x/en,0/m, ,=/w, ,1/m,)/w,，/w,0/m,=/w,4.12414349/m,+/w,0.48007329/m,*/w,x/en,1/m, ,-/w, ,0.6168482/m,*/w,x/en,23/m,./w,4/m,./w,2/m,./w,3/m, ,线性/n,拟/v,合线/nw,画/v,出/v,x/en,1/m,与/p,x/en,2/m,的/u,关系/n,图/n,——/w,线性/n,拟/v,合线/nw,4/m,./w,决策树/nz,（/w,decision/en, ,tree/en,）/w,分类/vn,算法/n,原理/n,及/c,应用/vn,4.1/m, ,概述/v,决策树/nz,——/w,是/v,一种/mq,被/p,广泛/a,使用/v,的/u,分类/vn,算法/n,。/w,相比/v,贝叶斯算法/nw,，/w,决策树/nz,的/u,优势/n,在于/v,构造/v,过程/n,不/d,需要/v,任何/r,领域/n,知识/n,或/c,参数/n,设置/v,。/w,在/p,实际/n,应用/vn,中/f,，/w,对于/p,探测/vn,式/k,的/u,知识/n,发现/v,，/w,决策树/nz,更加/d,适用/v,。/w,决策树/nz,通常/d,有/v,三个/m,步骤/n,：/w,特征/n,选择/v,、/w,决策树/nz,的/u,生成/vn,、/w,决策树/nz,的/u,修剪/vn,。/w,4.2/m, ,算法/n,思想/n,通俗/a,来说/u,，/w,决策树/nz,分类/vn,的/u,思想/n,类似/v,于/p,找/v,对象/n,。/w,现/tg,想象/v,一个/m,女孩/n,的/u,母亲/n,要/v,给/p,这个/r,女孩/n,介绍/v,男朋友/n,，/w,于是/c,有/v,了/u,下面/f,的/u,对话/vn,：/w,女儿/n,：/w,多/a,大/a,年纪/n,了/u,？/w,母亲/n,：/w,26/m,女儿/n,：/w,长/a,的/u,帅/vg,不/d,帅/vg,？/w,母亲/n,：/w,挺/d,帅/vg,的/u,。/w,女儿/n,：/w,收入/n,高/a,不/d,？/w,母亲/n,：/w,不/d,算/v,很/d,高/a,，/w,中等/b,情况/n,。/w,女儿/n,：/w,是/v,公务员/n,吗/y,？/w,母亲/n,：/w,是/v,，/w,公务员/n,，/w,在/p,税务局/n,上班/v,呢/y,。/w,女儿/n,：/w,那/r,好/a,，/w,我/r,去/v,见见/v,。/w,这个/r,女孩/n,的/u,决策/n,过程/n,就/d,是/v,典型/n,的/u,分类/vn,树/v,决策/n,。/w,实质/n,：/w,通过/p,年龄/n,、/w,长相/n,、/w,收入/n,和/c,是否/v,公务员/n,将/d,男人/n,分为/v,两个/m,类别/n,：/w,见/v,和/c,不见/v,假设/v,这个/r,女孩/n,对/p,男人/n,的/u,要求/v,是/v,：/w,30岁/mq,以下/f,、/w,长相/n,中等/b,以上/f,并且/c,是/v,高收入者/n,或/c,中等/b,以上/f,收入/n,的/u,公务员/n,，/w,那么/r,这个/r,可以/v,用/p,下/f,图/n,表示/v,女孩/n,的/u,决策/n,逻辑/n,。/w,上图/n,完整/a,表达/v,了/u,这个/r,女孩/n,决定/v,是否/v,见/v,一个/m,约会/vn,对象/n,的/u,策略/n,，/w,其中/r,：/w,绿色/n,节点/n,表示/v,判断/v,条件/n,橙色/n,节点/n,表示/v,决策/n,结果/n,箭头/n,表示/v,在/p,一个/m,判断/v,条件/n,在/p,不同/a,情况/n,下/f,的/u,决策/n,路径/n,图/n,中/f,红色/n,箭头/n,表示/v,了/u,上面/f,例子/n,中/f,女孩/n,的/u,决策/n,过程/n,。/w,这/r,幅/q,图/n,基本/a,可以/v,算是/v,一颗/mq,决策树/nz,，/w,说/v,它/r,”/w,基本/a,可以/v,算/v,“/w,是/v,因为/c,图/n,中/f,的/u,判定/v,条件/n,没有/v,量化/v,，/w,如/v,收入/n,高中低/nw,等等/u,，/w,还/d,不能/v,算是/v,严格/ad,意义/n,上/f,的/u,决策树/nz,，/w,如果/c,将/d,所有/b,条件/n,量化/v,，/w,则/d,就/d,变成/v,真正/d,的/u,决策树/nz,了/u,。/w,决策树/nz,分类/vn,算法/n,的/u,关键/n,就/d,是/v,根据/p,”/w,先验/n,数据/n,“/w,构造/v,一棵/mq,最佳/z,的/u,决策树/nz,，/w,用以/d,预测/v,未知/vn,数据/n,的/u,类别/n,决策树/nz,：/w,是/v,一个/m,树/v,结构/n,(/w,可以/v,是/v,二叉树/nz,或/c,非/h,二叉树/nz,)/w,。/w,其/r,每个/r,非叶节点/nt,表示/v,一个/m,特征/n,属性/n,上/f,的/u,测试/vn,，/w,每个/r,分支/n,代表/n,这个/r,特征/n,属性/n,在/p,某个/r,值域/n,上/f,的/u,输出/v,，/w,而/c,每个/r,叶节点/nr,存放/v,一个/m,类别/n,。/w,使用/v,决策树/nz,进行/v,决策/n,的/u,过程/n,就/d,是/v,从/p,根/q,节点/n,开始/v,，/w,测试/vn,待/v,分类/vn,项/q,中/f,相应/v,的/u,特征/n,属性/n,，/w,并/c,按照/p,其/r,值/n,选择/v,输出/v,分支/n,，/w,直到/v,到达/v,叶子/n,节点/n,，/w,将/d,叶子/n,节点/n,存放/v,的/u,类别/n,作为/v,决策/n,结果/n,。/w,4.3/m, ,决策树/nz,构造/v,4/m,./w,3/m,./w,1/m, ,决策树/nz,构造/v,样例/nw,假如/c,有/v,以下/f,判断/v,苹果/n,好坏/n,的/u,数据/n,样本/n,：/w,样本/n, , , , ,红/a, , , , , ,大/a, , , , , , ,好/a,苹果/n,0/m, , , , , , , ,1/m, , , , , , ,1/m, , , , , , , , , ,11/m, , , , , , , ,1/m, , , , , , ,0/m, , , , , , , , , ,12/m, , , , , , , ,0/m, , , , , , ,1/m, , , , , , , , , ,03/m, , , , , , , ,0/m, , , , , , ,0/m, , , , , , , , , ,0/m,样本/n,中/f,有/v,2个/m,属性/n,，/w,a/en,0/m,表示/v,是否/v,红/a,苹果/n,。/w,a/en,1/m,表示/v,是否/v,大于/v,苹果/n,。/w,假如/c,要/v,根据/p,这个/r,数据/n,样本/n,构建/v,一棵/mq,自动/d,判断/v,苹果/n,好坏/n,的/u,决策树/nz,。/w,由于/c,本例/nw,中/f,的/u,数据/n,只/d,有/v,2个/m,属性/n,，/w,因此/c,，/w,我们/r,可以/v,穷举/v,所有/b,可能/v,构造/v,出来/v,的/u,决策树/nz,，/w,就/d,2课/mq,树/v,，/w,如/v,下/f,图/n,所/u,示/vg,：/w,显然/ad,左边/f,先/d,使用/v,a/en,0/m,(/w,红色/n,)/w,做/v,划分/v,依据/n,的/u,决策树/nz,要/v,优于/v,右边/f,用/p,a/en,1/m,(/w,大小/n,)/w,做/v,划分/v,依据/n,的/u,决策树/nz,。/w,当然/d,这/r,是/v,直觉/n,的/u,认知/vn,。/w,而/c,直觉/n,显然/ad,不/d,适合/v,转化/v,成/v,程序/n,的/u,实现/v,，/w,所以/c,需要/v,有/v,一种/mq,定量/v,的/u,考察/v,来/v,评价/v,这/r,两棵/mq,树/v,的/u,性能/n,好坏/n,。/w,决策树/nz,的/u,评价/v,所/u,用/p,的/u,定量/v,考察/v,方法/n,为/p,计算/v,每/r,种/q,划分/v,情况/n,的/u,信息/n,熵/g,增益/v,：/w,如果/c,经过/p,某个/r,选定/v,的/u,属性/n,进行/v,数据/n,划分/v,后/f,的/u,信息/n,熵/g,下降/v,最/d,多/a,，/w,则/d,这个/r,划分/v,属性/n,是/v,最/d,优/ag,选择/v,。/w,4/m,./w,3/m,./w,2/m, ,属性/n,划分/v,选择/v,(/w,即/v,构造/v,决策树/nz,)/w,的/u,依据/n,熵/g,：/w,信息论/n,的/u,奠基人/n,香农/nr,定义/n,的/u,用/p,来信息量/nw,的/u,单位/n,。/w,简单/a,来说/u,，/w,熵/g,就/d,是/v,“/w,无序/b,，/w,混乱/a,”/w,的/u,程度/n,。/w,公式/n,：/w,h/en,(/w,x/en,)/w,=/w,-/w, ,Σ, ,pi/en, ,*/w, ,logpi/en,,/w, ,i/en,=/w,1/m,,/w,2/m,,/w, ,./w,./w,./w, ,,/w, ,n/en,，/w,pi/en,为/p,一个/m,特征/n,的/u,概率/n,通过/p,计算/v,来/v,理解/v,：/w,1/m,、/w,原始/a,样本/n,数据/n,的/u,熵/g,：/w,样例/nw,总数/n,：/w,4/m,好/a,苹果/n,：/w,2/m,坏/a,苹果/n,：/w,2/m,熵/g,：/w,-/w,(/w,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w, ,+/w, ,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w,)/w, ,=/w,1/m,信息/n,熵/g,为/p,1/m,表示/v,当前/t,处于/v,最/d,混乱/a,，/w,最/d,无序/b,的/u,状态/n,2/m,、/w,两颗/mq,决策树/nz,的/u,划分/v,结果/n,熵/g,增益/v,计算/v,树/v,1/m,先/d,选/v,a/en,0/m,作/v,划分/v,，/w,各子/nw,节点/n,信息/n,熵/g,计算/v,如下/v,：/w,0/m,,/w,1/m,叶子/n,节点/n,有/v,2个/m,正例/nw,，/w,0个/m,负例/nw,。/w,信息/n,熵/g,为/p,：/w,e/en,1/m, ,=/w, ,-/w,(/w,2/m,//w,2/m, ,*/w, ,log/en,(/w,2/m,//w,2/m,)/w, ,+/w, ,0/m,//w,2/m, ,*/w, ,log/en,(/w,0/m,//w,2/m,)/w,)/w, ,=/w,0/m,。/w,2/m,,/w,3/m,叶子/n,节点/n,有/v,0个/m,正例/nw,，/w,2个/m,负例/nw,。/w,信息/n,熵/g,为/p,：/w,e/en,2/m, ,=/w, ,-/w,(/w,0/m,//w,2/m, ,*/w, ,log/en,(/w,0/m,//w,2/m,)/w, ,+/w, ,2/m,//w,2/m, ,*/w, ,log/en,(/w,2/m,//w,2/m,)/w,)/w, ,=/w,0/m,。/w,因此/c,选择/v,a/en,0/m,划分/v,后/f,的/u,信息/n,熵/g,为/p,每个/r,子/ng,节点/n,的/u,信息/n,熵/g,所/u,占/v,比重/n,的/u,加权/v,和/c,：/w,e/en, ,=/w, ,e/en,1/m, ,*/w, ,2/m,//w,4/m, ,+/w, ,e/en,2/m, ,*/w, ,2/m,//w,4/m, ,=/w, ,0/m,。/w,选择/v,a/en,0/m,做/v,划分/v,的/u,信息/n,熵/g,增益/v,g/en,(/w,s/en,，/w,a/en,0/m,)/w, ,=/w, ,s/en, ,-/w, ,e/en, ,=/w, ,1/m, ,-/w, ,0/m, ,=/w,1/m,。/w,事实上/l,，/w,决策树/nz,叶子/n,节点/n,表示/v,已经/d,都/d,属于/v,相同/a,类别/n,，/w,因此/c,信息/n,熵/g,一定/d,为/p,0/m,。/w,树/v,2/m,先/d,选/v,a/en,1/m,作/v,划分/v,，/w,各子/nw,节点/n,信息/n,熵/g,计算/v,如下/v,：/w,0/m,,/w,2子/mq,节点/n,有/v,1个/m,正例/nw,，/w,1个/m,负例/nw,。/w,信息/n,熵/g,为/p,：/w,e/en,1/m, ,=/w, ,-/w,(/w,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w, ,+/w, ,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w,)/w, ,=/w, ,1/m,。/w,1/m,,/w,3子/mq,节点/n,有/v,1个/m,正例/nw,，/w,1个/m,负例/nw,。/w,信息/n,熵/g,为/p,：/w,e/en,2/m, ,=/w, ,-/w,(/w,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w, ,+/w, ,1/m,//w,2/m, ,*/w, ,log/en,(/w,1/m,//w,2/m,)/w,)/w, ,=/w, ,1/m,。/w,因此/c,选择/v,a/en,1/m,划分/v,后/f,的/u,信息/n,熵/g,为/p,每个/r,子/ng,节点/n,的/u,信息/n,熵/g,所/u,占/v,比重/n,的/u,加权/v,和/c,：/w,e/en, ,=/w, ,e/en,1/m, ,*/w, ,2/m,//w,4/m, ,+/w, ,e/en,2/m, ,*/w, ,2/m,//w,4/m, ,=/w, ,1/m,。/w,也就是说/l,分/q,了/u,跟/p,没/d,分/q,一样/u,！/w,选择/v,a/en,1/m,做/v,划分/v,的/u,信息/n,熵/g,增益/v,g/en,(/w,s/en,，/w,a/en,1/m,)/w, ,=/w, ,s/en, ,-/w, ,e/en, ,=/w, ,1/m, ,-/w, ,1/m, ,=/w, ,0/m,。/w,因此/c,，/w,每次/r,划分/v,之前/f,，/w,我们/r,只/d,需要/v,计算/v,出/v,信息/n,熵/g,增益/v,最/d,大/a,的/u,那种/r,划分/v,即可/v,。/w,4.4/m, ,算法/n,要点/n,4/m,./w,4/m,./w,1/m, ,指导/vn,思想/n,经过/p,决策/n,属性/n,的/u,划分/v,后/f,，/w,数据/n,的/u,无序度/nw,越来越/d,低/a,，/w,也/d,就/d,是/v,信息/n,熵/g,越来越/d,小/a,4/m,./w,4/m,./w,2/m, ,算法/n,实现/v,梳理/v,出/v,数据/n,中/f,的/u,属性/n,，/w,比较/d,按照/p,某/r,特定/b,属性/n,划分/v,后/f,的/u,数据/n,的/u,信息/n,熵/g,增益/v,，/w,选择/v,信息/n,熵/g,增益/v,最/d,大/a,的/u,那个/r,属性/n,作为/v,第一/m,划分/v,依据/n,，/w,然后/c,继续/v,选择/v,第二/m,属性/n,，/w,以此类推/l,。/w,4.5/m, ,决策树/nz,分类/vn,算法/n,python/en,实战/n,4/m,./w,5/m,./w,1/m, ,案例/n,需求/n,我们/r,的/u,任务/n,就/d,是/v,训练/vn,一个/m,决策树/nz,分类器/nw,，/w,输入/v,身高/n,和/c,体重/n,，/w,分类器/nw,能/v,给/p,出/v,这个/r,人/n,是/v,胖子/n,还是/c,瘦子/n,。/w,所/u,用/p,的/u,训练/vn,数据/n,如下/v,，/w,这个/r,数据/n,一共/d,有/v,8个/m,样本/n,，/w,每个/r,样本/n,有/v,2个/m,属性/n,，/w,分别/d,为/p,头发/n,和/c,声音/n,，/w,第三/nw,列为/v,性别/n,标签/n,，/w,表示/v,“/w,男/b,”/w,或/c,“/w,女/b,”/w,。/w,该/r,数据/n,保存/v,在/p,1/m,./w,txt/en,中/f,。/w,头发/n,声音/n,性别/n,长/a,粗/a,男/b,短/a,粗/a,男/b,短/a,粗/a,男/b,长/a,细女/nw,短细/nw,女/b,短/a,粗女/nw,长/a,粗女/nw,长/a,粗女/nw,4/m,./w,5/m,./w,2/m, ,模型/n,分析/vn,决策树/nz,对于/p,“/w,是非/n,”/w,的/u,二值/nw,逻辑/n,的/u,分枝/n,相当/d,自然/d,。/w,本例/nw,决策树/nz,的/u,任务/n,是/v,找到/v,头发/n,、/w,声音/n,将/d,其/r,样本/n,两两/m,分类/vn,，/w,自顶向下/l,构建/v,决策树/nz,。/w,在/p,这里/r,，/w,我们/r,列出/v,两种/mq,方案/n,：/w,①,先/d,根据/p,头发/n,判断/v,，/w,若/c,判断/v,不/d,出/v,，/w,再/d,根据/p,声音/n,判断/v,，/w,于是/c,画/v,了/u,一幅/mq,图/n,，/w,如下/v,：/w,于是/c,，/w,一个/m,简单/a,、/w,直观/a,的/u,决策树/nz,就/d,这么/r,出来/v,了/u,。/w,头发/n,长/a,、/w,声音/n,粗/a,就/d,是/v,男生/n,；/w,头发/n,长/a,、/w,声音/n,细/a,就/d,是/v,女生/n,；/w,头发/n,短/a,、/w,声音/n,粗/a,是/v,男生/n,；/w,头发/n,短/a,、/w,声音/n,细/a,是/v,女生/n,。/w,②, ,先/d,根据/p,声音/n,判断/v,，/w,然后/c,再/d,根据/p,头发/n,来/v,判断/v,，/w,决策树/nz,如下/v,：/w,那么/r,问题/n,来/v,了/u,：/w,方案/n,①,和/c,方案/n,②,哪个/r,的/u,决策树/nz,好些/m,？/w,计算机/n,做/v,决策树/nz,的/u,时候/n,，/w,面对/v,多/a,个/q,特征/n,，/w,该/r,如何/r,选/v,哪个/r,特征/n,为/p,最佳/z,多/a,得/u,划分/v,特征/n,？/w,划分/v,数据集/nw,的/u,大/a,原则/n,是/v,：/w,将/d,无序/b,的/u,数据/n,变/v,得/u,更加/d,有序/a,。/w,我们/r,可以/v,使用/v,多种/m,方法/n,划分/v,数据集/nw,，/w,但是/c,每/r,种/q,方法/n,都/d,有/v,各自/r,的/u,优缺点/n,。/w,于是/c,我们/r,这么/r,想/v,，/w,如果/c,我们/r,能/v,测量/vn,数据/n,的/u,复杂/a,度/q,，/w,对比/v,按/p,不同/a,特征/n,分类/vn,后/f,的/u,数据/n,复杂/a,度/q,，/w,若/c,按/p,某/r,一/m,特征/n,分类/vn,后/f,复杂/a,度/q,减少/v,的/u,更多/ad,，/w,那么/r,这个/r,特征/n,即/v,为/p,最佳/z,分类/vn,特征/n,。/w,为此/l,，/w,claude/en, ,shannon/en,定义/n,了/u,熵/g,和/c,信息/n,增益/v,，/w,用/p,熵/g,来/v,表示/v,信息/n,的/u,复杂/a,度/q,，/w,熵/g,越/d,大/a,，/w,则/d,信息/n,越/d,复杂/a,。/w,信息/n,增益/v,表示/v,两个/m,信息/n,熵/g,的/u,差值/n,。/w,首先/d,计算/v,未/d,分类/vn,前/f,的/u,熵/g,，/w,总共/d,有/v,8位/mq,同学/n,，/w,男生/n,3位/mq,，/w,女生/n,5位/mq,熵/g,（/w,总/b,）/w,=/w, ,-/w,3/m,//w,8/m,*/w,log/en,2/m,(/w,3/m,//w,8/m,)/w,-/w,5/m,//w,8/m,*/w,log/en,2/m,(/w,5/m,//w,8/m,)/w,=/w,0.9544/m,接着/c,分别/d,计算/v,方案/n,①,和/c,方案/n,②,分类/vn,后/f,信息/n,熵/g,。/w,方案/n,①,首先/d,按/p,头发/n,分类/vn,，/w,分类/vn,后/f,的/u,结果/n,为/p,：/w,长/a,头发/n,中/f,有/v,1/m,男/b,3/m,女/b,。/w,短/a,头发/n,中/f,有/v,2/m,男/b,2/m,女/b,。/w,熵/g,（/w,长发/n,）/w,=/w, ,-/w,1/m,//w,4/m,*/w,log/en,2/m,(/w,1/m,//w,4/m,)/w,-/w,3/m,//w,4/m,*/w,log/en,2/m,(/w,3/m,//w,4/m,)/w,=/w,0.8113/m,熵/g,（/w,短发/n,）/w,=/w, ,-/w,2/m,//w,4/m,*/w,log/en,2/m,(/w,2/m,//w,4/m,)/w,-/w,2/m,//w,4/m,*/w,log/en,2/m,(/w,2/m,//w,4/m,)/w,=/w,1/m,熵/g,（/w,方案/n,①,）/w,=/w, ,4/m,//w,8/m,*/w,0.8113/m,+/w,4/m,//w,8/m,*/w,1/m,=/w,0.9057/m, ,（/w,4/m,//w,8/m,为/p,长/a,头发/n,有/v,4人/mq,，/w,短/a,头发/n,有/v,4人/mq,）/w,信息/n,增益/v,（/w,方案/n,①,）/w,=/w, ,熵/g,（/w,总/b,）/w,-/w, ,熵/g,（/w,方案/n,①,）/w,=/w, ,0.9544/m, ,-/w, ,0.9057/m, ,=/w, ,0.0487/m,同理/v,，/w,按/p,方案/n,②,的/u,方法/n,，/w,首先/d,按/p,声音/n,特征/n,来/v,分/q,，/w,分类/vn,后/f,的/u,结果/n,为/p,：/w,声音/n,粗/a,中/f,有/v,3/m,男/b,3/m,女/b,。/w,声音/n,细/a,中/f,有/v,0/m,男/b,2/m,女/b,。/w,熵/g,（/w,声音/n,粗/a,）/w,=/w, ,-/w,3/m,//w,6/m,*/w,log/en,2/m,(/w,3/m,//w,6/m,)/w,-/w,3/m,//w,6/m,*/w,log/en,2/m,(/w,3/m,//w,6/m,)/w,=/w,1/m,熵/g,（/w,声音/n,细/a,）/w,=/w, ,-/w,2/m,//w,2/m,*/w,log/en,2/m,(/w,2/m,//w,2/m,)/w,=/w,0/m,熵/g,（/w,方案/n,②,）/w,=/w, ,6/m,//w,8/m,*/w,1/m,+/w,2/m,//w,8/m,*/w,0/m,=/w,0.75/m, ,（/w,6/m,//w,8/m,为/p,声音/n,粗/a,有/v,6人/mq,，/w,2/m,//w,8/m,为/p,声音/n,细/a,有/v,2人/mq,）/w,信息/n,增益/v,（/w,方案/n,②,）/w,=/w, ,熵/g,（/w,总/b,）/w,-/w, ,熵/g,（/w,方案/n,②,）/w,=/w, ,0.9544/m, ,-/w, ,0.75/m, ,=/w, ,0.2087/m,按照/p,方案/n,②,的/u,方法/n,，/w,先/d,按/p,声音/n,特征/n,分类/vn,，/w,信息/n,增益/v,更/d,大/a,，/w,区分/v,样本/n,的/u,能力/n,更/d,强/a,，/w,更/d,具有/v,代表性/n,。/w,以上/f,就/d,是/v,决策树/nz,id/en,3/m,算法/n,的/u,核心/n,思想/n,。/w,4/m,./w,5/m,./w,3/m, ,python/en,实现/v,id/en,3/m,算法/n,from/en, ,math/en, ,import/en, ,log/en, ,import/en, ,operator/en, ,def/en, ,calcshannonent/en,(/w,dataset/en,)/w,:/w, ,#, ,计算/v,数据/n,的/u,熵/g,(/w,entropy/en,)/w, ,numentries/en,=/w,len/en,(/w,dataset/en,)/w, ,#, ,数据/n,条数/nw, ,labelcounts/en,=/w,{/w,}/w, ,for/en, ,featvec/en, ,in/en, ,dataset/en,:/w, ,currentlabel/en,=/w,featvec/en,[/w,-/w,1/m,]/w, ,#, ,每/r,行/v,数据/n,的/u,最后/f,一个/m,字/n,（/w,类别/n,）/w, ,if/en, ,currentlabel/en, ,not/en, ,in/en, ,labelcounts/en,./w,keys/en,(/w,)/w,:/w, ,labelcounts/en,[/w,currentlabel/en,]/w,=/w,0/m, ,labelcounts/en,[/w,currentlabel/en