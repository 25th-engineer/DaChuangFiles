---------------------------------------------------------------------------------------本/nrf,系列/q,文章/n,为/p,《/w,机器/n,学习/v,实战/n,》/w,学习/v,笔记/n,，/w,内容/n,整理/v,自/p,书本/n,，/w,网络/n,以及/c,自己/r,的/u,理解/v,，/w,如/v,有/v,错误/n,欢迎/v,指正/v,。/w,源码/nw,在/p,python/en,3.5/m,上/f,测试/vn,均/d,通过/p,，/w,代码/n,及/c,数据/n, ,--/nrf,>, ,https/en,:/w,//w,//w,github/en,./w,com/en,//w,wellat/en,//w,mlaction/en,---------------------------------------------------------------------------------------/nrf,1/m,、/w,算法/n,概述/v,1.1/m, ,朴素/a,贝叶斯朴素贝叶斯/nw,是/v,使用/v,概率/n,论/v,来/v,分类/vn,的/u,算法/n,。/w,其中/r,朴素/a,：/w,各/r,特征/n,条件/n,独立/v,；/w,贝叶斯/nr,：/w,根据/p,贝叶斯/nr,定理/n,。/w,根据/p,贝叶斯/nr,定理/n,，/w,对/p,一个/m,分类/vn,问题/n,，/w,给/p,定/v,样本/n,特征/n,x/en,，/w,样本/n,属于/v,类别/n,y/en,的/u,概率/n,是/v,：/w,-------/nrf,（/w,1/m,）/w,在/p,这里/r,，/w,x/en, ,是/v,一个/m,特征/n,向量/n,，/w,设/v, ,x/en, ,维度/n,为/p, ,m/en,。/w,因为/c,朴素/a,的/u,假设/v,，/w,即/v,特征/n,条件/n,独立/v,，/w,根据/p,全/a,概率/n,公式/n,展开/v,，/w,上式/nw,可以/v,表达/v,为/p,：/w,这里/r,，/w,只要/c,分别/d,估计/v,出/v,，/w,特征/n, ,Χ,i/en, ,在/p,每/r,一类/mq,的/u,条件/n,概率/n,就/d,可以/v,了/u,。/w,类别/n, ,y/en, ,的/u,先验/n,概率/n,可以/v,通过/p,训练/vn,集/vg,算出/v,，/w,同样/d,通过/p,训练/vn,集/vg,上/f,的/u,统计/v,，/w,可以/v,得出/v,对应/v,每/r,一类/mq,上/f,的/u,，/w,条件/n,独立/v,的/u,特征/n,对应/v,的/u,条件/n,概率/n,向量/n,。/w,1.2/m, ,算法/n,特点/n,优点/n,：/w,在/p,数据/n,较/d,少/a,的/u,情况/n,下/f,仍然/d,有效/a,，/w,可以/v,处理/v,多/a,类别/n,问题/n,。/w,缺点/n,：/w,对于/p,输入/v,数据/n,的/u,准备/v,方式/n,较为/d,敏感/a,。/w,适用/v,数据/n,类型/n,：/w,标称型/nw,数据/n,。/w,2/m,、/w,使用/v,python/en,进行/v,文本/n,分类/vn,要/v,从/p,文本/n,中/f,获取/v,特征/n,，/w,需要/v,先/d,拆/v,分/q,文本/n,。/w,可以/v,把/p,词条/n,想象/v,为/p,单词/n,，/w,也/d,可以/v,使用/v,非/h,单词/n,词条/n,，/w,如/v,url/en,、/w,ip/en,地址/n,或者/c,任意/d,其他/r,字符/n,串/v,。/w,然后/c,将/d,每/r,一个/m,文本/n,片段/n,表示/v,为/p,一个/m,词条/n,向量/n,，/w,其中/r,值/n,为/p,1/m,表示/v,词条/n,出现/v,在/p,文档/n,中/f,，/w,0/m,表示/v,词条/n,未/d,出现/v,。/w,2.1/m, ,准备/v,数据/n,：/w,从/p,文本/n,中/f,构建/v,词向量/nw,1/m, ,from/en, ,numpy/en, ,import/en, ,*/w, ,2/m, ,3/m, ,def/en, ,loaddataset/en,(/w,)/w,:/w, ,4/m, ,'/w,'/w,'/w, ,5/m, ,postinglist/en,:/w, ,进行/v,词条/n,切分/v,后/f,的/u,文档/n,集合/v, ,6/m, ,classvec/en,:/w,类别/n,标签/n, ,7/m, ,'/w,'/w,'/w, ,8/m, ,postinglist/en,=/w,[/w,[/w,'/w,my/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,please/en,'/w,]/w,,/w, ,9/m, ,[/w,'/w,maybe/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,,/w, ,10/m, ,[/w,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,cute/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,11/m, ,[/w,'/w,stop/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w,,/w, ,12/m, ,[/w,'/w,mr/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,him/en,'/w,]/w,,/w, ,13/m, ,[/w,'/w,quit/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,stupid/en,'/w,]/w,]/w, ,14/m, ,classvec/en, ,=/w, ,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,]/w, ,#,1/m,代表/n,侮辱性/n,文字/n,，/w,0/m,代表/n,正常/a,言论/n, ,15/m, ,return/en, ,postinglist/en,,/w,classvec/en, ,16/m, ,17/m, ,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w, ,18/m, ,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w,#,使用/v,set/en,创建/v,不/d,重复/v,词表/n,库/n, ,19/m, ,for/en, ,document/en, ,in/en, ,dataset/en,:/w, ,20/m, ,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#,创建/v,两个/m,集合/v,的/u,并/c,集/vg, ,21/m, ,return/en, ,list/en,(/w,vocabset/en,)/w, ,22/m, ,23/m, ,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,24/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w,#,创建/v,一个/m,所/u,包含/v,元素/n,都/d,为/p,0/m,的/u,向量/n, ,25/m, ,#,遍历/nw,文档/n,中/f,的/u,所有/b,单词/n,，/w,如果/c,出现/v,了/u,词汇表/n,中/f,的/u,单词/n,，/w,则/d,将/d,输出/v,的/u,文档/n,向/p,量/n,中/f,的/u,对应/v,值设/nw,为/p,1/m, ,26/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,27/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,28/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m, ,29/m, ,else/en,:/w, ,print/en,(/w,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,word/en,)/w, ,30/m, ,return/en, ,returnvec/en, ,31/m, ,'/w,'/w,'/w, ,32/m, ,我们/r,将/d,每个/r,词/n,的/u,出现/v,与否/u,作为/v,一个/m,特征/n,，/w,这/r,可以/v,被/p,描述/v,为/p,词集/nw,模型/n,(/w,set/en,-/w,of/en,-/w,words/en, ,model/en,)/w,。/w, ,33/m, ,如果/c,一个/m,词/n,在/p,文档/n,中/f,出现/v,不/d,止/v,一次/mq,，/w,这/r,可能/v,意味/n,着/u,包含/v,该词/nw,是否/v,出现/v,在/p,文档/n,中/f,所/u,不/d,能/v,表达/v,的/u,某种/r,信息/n,,/w, ,34/m, ,这种/r,方法/n,被/p,称为/v,词袋/nw,模型/n,(/w,bag/en,-/w,of/en,-/w,words/en, ,model/en,)/w,。/w, ,35/m, ,在/p,词袋/nw,中/f,，/w,每个/r,单词/n,可以/v,出现/v,多次/m,，/w,而/c,在/p,词/n,集中/v,，/w,每个/r,词/n,只能/v,出现/v,一次/mq,。/w, ,36/m, ,为/p,适应/v,词袋/nw,模型/n,，/w,需要/v,对/p,函数/n,setofwords/en,2/m,vec/en,稍加/v,修改/v,，/w,修改/v,后/f,的/u,函数/n,称为/v,bagofwords/en,2/m,vecmn/en, ,37/m, ,'/w,'/w,'/w, ,38/m, ,def/en, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w, ,39/m, ,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w, ,40/m, ,for/en, ,word/en, ,in/en, ,inputset/en,:/w, ,41/m, ,if/en, ,word/en, ,in/en, ,vocablist/en,:/w, ,42/m, ,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,+/w,=/w, ,1/m, ,43/m, ,return/en, ,returnvec/en,2.2/m, ,训练/vn,算法/n,：/w,从/p,词向量/nw,计算/v,概率/n,计算/v,每个/r,类别/n,的/u,条件/n,概率/n,，/w,伪代码/nw,：/w,1/m, ,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w, ,2/m, ,'/w,'/w,'/w, ,3/m, ,朴素/a,贝叶斯分类器/nw,训练/vn,函数/n,(/w,此处/s,仅/d,处理/v,两类/mq,分类/vn,问题/n,)/w, ,4/m, ,trainmatrix/en,:/w,文档/n,矩/ng,阵/ng, ,5/m, ,traincategory/en,:/w,每/r,篇/q,文档/n,类别/n,标签/n, ,6/m, ,'/w,'/w,'/w, ,7/m, ,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w, ,8/m, ,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w, ,9/m, ,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w, ,10/m, ,#,初始化/v,所有/b,词/n,出现/v,数/m,为/p,1/m,，/w,并/c,将/d,分/q,母/b,初/f,始/vg,化为/v,2/m,，/w,避免/v,某/r,一个/m,概率/n,值/n,为/p,0/m, ,11/m, ,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,#, ,12/m, ,p/en,0/m,denom/en, ,=/w, ,2.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, ,#, ,13/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w, ,14/m, ,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,15/m, ,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,16/m, ,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,17/m, ,else/en,:/w, ,18/m, ,p/en,0/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w, ,19/m, ,p/en,0/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w, ,20/m, ,#,将/d,结果/n,取/v,自然/d,对数/n,，/w,避免/v,下/f,溢/v,出/v,，/w,即/v,太/d,多/a,很/d,小/a,的/u,数/m,相/d,乘/v,造成/v,的/u,影响/vn, ,21/m, ,p/en,1/m,vect/en, ,=/w, ,log/en,(/w,p/en,1/m,num/en,//w,p/en,1/m,denom/en,)/w,#,change/en, ,to/en, ,log/en,(/w,)/w, ,22/m, ,p/en,0/m,vect/en, ,=/w, ,log/en,(/w,p/en,0/m,num/en,//w,p/en,0/m,denom/en,)/w,#,change/en, ,to/en, ,log/en,(/w,)/w, ,23/m, ,return/en, ,p/en,0/m,vect/en,,/w,p/en,1/m,vect/en,,/w,pabusive/en,2.3/m, ,测试/vn,算法/n,分类/vn,函数/n,：/w,1/m, ,def/en, ,classifynb/en,(/w,vec/en,2/m,classify/en,,/w, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,)/w,:/w, ,2/m, ,'/w,'/w,'/w, ,3/m, ,分类/vn,函数/n, ,4/m, ,vec/en,2/m,classify/en,:/w,要/v,分类/vn,的/u,向量/n, ,5/m, ,p/en,0/m,vec/en,,/w, ,p/en,1/m,vec/en,,/w, ,pclass/en,1/m,:/w,分别/d,对应/v,trainnb/en,0/m,计算/v,得到/v,的/u,3个/m,概率/n, ,6/m, ,'/w,'/w,'/w, ,7/m, ,p/en,1/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,1/m,vec/en,)/w, ,+/w, ,log/en,(/w,pclass/en,1/m,)/w, ,8/m, ,p/en,0/m, ,=/w, ,sum/en,(/w,vec/en,2/m,classify/en, ,*/w, ,p/en,0/m,vec/en,)/w, ,+/w, ,log/en,(/w,1.0/m, ,-/w, ,pclass/en,1/m,)/w, ,9/m, ,if/en, ,p/en,1/m, ,>, ,p/en,0/m,:/w, ,10/m, ,return/en, ,1/m, ,11/m, ,else/en,:/w, ,12/m, ,return/en, ,0/m,测试/vn,：/w,1/m, ,def/en, ,testingnb/en,(/w,)/w,:/w, ,2/m, ,listoposts/en,,/w,listclasses/en, ,=/w, ,loaddataset/en,(/w,)/w, ,3/m, ,myvocablist/en, ,=/w, ,createvocablist/en,(/w,listoposts/en,)/w, ,4/m, ,trainmat/en,=/w,[/w,]/w, ,5/m, ,for/en, ,postindoc/en, ,in/en, ,listoposts/en,:/w, ,6/m, ,trainmat/en,./w,append/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,postindoc/en,)/w,)/w, ,7/m, ,#,训练/vn,模型/n,，/w,注意/v,此处/s,使用/v,array/en, ,8/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,listclasses/en,)/w,)/w, ,9/m, ,testentry/en, ,=/w, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w, ,10/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,11/m, ,print/en,(/w,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w,)/w, ,12/m, ,testentry/en, ,=/w, ,[/w,'/w,stupid/en,'/w,,/w, ,'/w,garbage/en,'/w,]/w, ,13/m, ,thisdoc/en, ,=/w, ,array/en,(/w,setofwords/en,2/m,vec/en,(/w,myvocablist/en,,/w, ,testentry/en,)/w,)/w, ,14/m, ,print/en,(/w,testentry/en,,/w,'/w,classified/en, ,as/en,:/w, ,'/w,,/w,classifynb/en,(/w,thisdoc/en,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pab/en,)/w,)/w,3/m,、/w,实例/n,：/w,使用/v,朴素/a,贝叶斯/nr,过滤/v,垃圾/n,邮件/n,一般/a,流程/n,：/w,3.1/m, ,切分/v,文本/n,将/d,长/a,字符/n,串切/nw,分成/v,词表/n,，/w,包括/v,将/d,大写字符/nw,转换/v,成/v,小写/n,，/w,并/c,过滤/v,字符/n,长度/n,小于/v,3/m,的/u,字符/n,。/w,1/m, ,def/en, ,textparse/en,(/w,bigstring/en,)/w,:/w,#, ,2/m, ,'/w,'/w,'/w, ,3/m, ,文本/n,切分/v, ,4/m, ,输入/v,文本/n,字符/n,串/v,，/w,输出/v,词表/n, ,5/m, ,'/w,'/w,'/w, ,6/m, ,import/en, ,re/en, ,7/m, ,listoftokens/en, ,=/w, ,re/en,./w,split/en,(/w,r/en,'/w,\/w,w/en,*/w,'/w,,/w, ,bigstring/en,)/w, ,8/m, ,return/en, ,[/w,tok/en,./w,lower/en,(/w,)/w, ,for/en, ,tok/en, ,in/en, ,listoftokens/en, ,if/en, ,len/en,(/w,tok/en,)/w, ,>, ,2/m,]/w, ,93.2/m, ,使用/v,朴素/a,贝叶斯/nr,进行/v,垃圾/n,邮件/n,分类/vn,1/m, ,def/en, ,spamtest/en,(/w,)/w,:/w, ,2/m, ,'/w,'/w,'/w, ,3/m, ,垃圾/n,邮件/n,测试/vn,函数/n, ,4/m, ,'/w,'/w,'/w, ,5/m, ,doclist/en,=/w,[/w,]/w,;/w, ,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w,[/w,]/w, ,6/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1/m,,/w,26/m,)/w,:/w, ,7/m, ,#,读/v,取/v,垃圾/n,邮件/n, ,8/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,spam/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,,/w,'/w,r/en,'/w,,/w,encoding/en,=/w, ,'/w,utf/en,-/w,8/m,'/w,)/w,./w,read/en,(/w,)/w,)/w, ,9/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,10/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,11/m, ,#,设置/v,垃圾/n,邮件/n,类/q,标签/n,为/p,1/m, ,12/m, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,13/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,open/en,(/w,'/w,email/en,//w,ham/en,//w,%/w,d/en,./w,txt/en,'/w, ,%/w, ,i/en,,/w,'/w,r/en,'/w,,/w,encoding/en,=/w, ,'/w,utf/en,-/w,8/m,'/w,)/w,./w,read/en,(/w,)/w,)/w, ,14/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,15/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,16/m, ,classlist/en,./w,append/en,(/w,0/m,)/w, ,17/m, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w,#,生成/vn,次/q,表/n,库/n, ,18/m, ,trainingset/en, ,=/w, ,list/en,(/w,range/en,(/w,50/m,)/w,)/w, ,19/m, ,testset/en,=/w,[/w,]/w, ,#, ,20/m, ,#,随/v,机选/nw,10组/mq,做/v,测试/vn,集/vg, ,21/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,22/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en,)/w,)/w,)/w, ,23/m, ,testset/en,./w,append/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,24/m, ,del/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,25/m, ,trainmat/en,=/w,[/w,]/w,;/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,26/m, ,for/en, ,docindex/en, ,in/en, ,trainingset/en,:/w,#,生成/vn,训练/vn,矩阵/n,及/c,标签/n, ,27/m, ,trainmat/en,./w,append/en,(/w,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w,)/w, ,28/m, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en,]/w,)/w, ,29/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,trainclasses/en,)/w,)/w, ,30/m, ,errorcount/en, ,=/w, ,0/m, ,31/m, ,#,测试/vn,并/c,计算/v,错误/n,率/v, ,32/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,33/m, ,wordvector/en, ,=/w, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w, ,34/m, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en,)/w, ,!/w,=/w, ,classlist/en,[/w,docindex/en,]/w,:/w, ,35/m, ,errorcount/en, ,+/w,=/w, ,1/m, ,36/m, ,print/en,(/w,"/w,classification/en, ,error/en,"/w,,/w,doclist/en,[/w,docindex/en,]/w,)/w, ,37/m, ,print/en,(/w,'/w,the/en, ,error/en, ,rate/en, ,is/en,:/w, ,'/w,,/w,float/en,(/w,errorcount/en,)/w,//w,len/en,(/w,testset/en,)/w,)/w, ,38/m, ,#,return/en, ,vocablist/en,,/w,fulltext/en,4/m,、/w,实例/n,：/w,使用/v,朴素/a,贝叶斯分类器/nw,从/p,个人/n,广告/n,中/f,获取/v,区域/n,倾向/n,一般/a,流程/n,：/w,在/p,这个/r,中/f,，/w,我们/r,将/d,分别/d,从/p,美国/ns,的/u,两个/m,城市/n,中/f,选取/v,一些/m,人/n,，/w,通过/p,分析/vn,这些/r,人/n,发布/v,的/u,征婚/vn,广告/n,信息/n,，/w,来/v,比较/d,这/r,两个/m,城市/n,的/u,人们/n,在/p,广告/n,用/p,词/n,上/f,是否/v,不同/a, ,。/w,4.1/m, ,实现/v,代码/n,1/m, ,'/w,'/w,'/w, ,2/m, ,函数/n,localwords/en,(/w,)/w,与/p,程序/n,清单/n,中/f,的/u,spamtest/en,(/w,)/w,函数/n,几乎/d,相同/a,，/w,区别/n,在于/v,这里/r,访问/v,的/u,是/v, ,3/m, ,rss/en,源/ng,而/c,不/d,是/v,文件/n,。/w,然后/c,调用/v,函数/n,calcmostfreq/en,(/w,)/w,来/v,获得/v,排序/vn,最/d,高/a,的/u,30个/m,单词/n,并/c,随后/d,将/d,它们/r,移/v,除/p, ,4/m, ,'/w,'/w,'/w, ,5/m, ,def/en, ,localwords/en,(/w,feed/en,1/m,,/w,feed/en,0/m,)/w,:/w, ,6/m, ,import/en, ,feedparser/en, ,7/m, ,doclist/en,=/w,[/w,]/w,;/w, ,classlist/en, ,=/w, ,[/w,]/w,;/w, ,fulltext/en, ,=/w,[/w,]/w, ,8/m, ,minlen/en, ,=/w, ,min/en,(/w,len/en,(/w,feed/en,1/m,[/w,'/w,entries/en,'/w,]/w,)/w,,/w,len/en,(/w,feed/en,0/m,[/w,'/w,entries/en,'/w,]/w,)/w,)/w, ,9/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,minlen/en,)/w,:/w, ,10/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,feed/en,1/m,[/w,'/w,entries/en,'/w,]/w,[/w,i/en,]/w,[/w,'/w,summary/en,'/w,]/w,)/w, ,11/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,12/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,13/m, ,classlist/en,./w,append/en,(/w,1/m,)/w, ,#,ny/en, ,is/en, ,class/en, ,1/m, ,14/m, ,wordlist/en, ,=/w, ,textparse/en,(/w,feed/en,0/m,[/w,'/w,entries/en,'/w,]/w,[/w,i/en,]/w,[/w,'/w,summary/en,'/w,]/w,)/w, ,15/m, ,doclist/en,./w,append/en,(/w,wordlist/en,)/w, ,16/m, ,fulltext/en,./w,extend/en,(/w,wordlist/en,)/w, ,17/m, ,classlist/en,./w,append/en,(/w,0/m,)/w, ,18/m, ,vocablist/en, ,=/w, ,createvocablist/en,(/w,doclist/en,)/w,#,create/en, ,vocabulary/en, ,19/m, ,top/en,30/m,words/en, ,=/w, ,calcmostfreq/en,(/w,vocablist/en,,/w,fulltext/en,)/w, ,#,remove/en, ,top/en, ,30/m, ,words/en, ,20/m, ,for/en, ,pairw/en, ,in/en, ,top/en,30/m,words/en,:/w, ,21/m, ,if/en, ,pairw/en,[/w,0/m,]/w, ,in/en, ,vocablist/en,:/w, ,vocablist/en,./w,remove/en,(/w,pairw/en,[/w,0/m,]/w,)/w, ,22/m, ,trainingset/en, ,=/w, ,list/en,(/w,range/en,(/w,2/m,*/w,minlen/en,)/w,)/w,;/w, ,testset/en,=/w,[/w,]/w, ,#,create/en, ,test/en, ,set/en, ,23/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,10/m,)/w,:/w, ,24/m, ,randindex/en, ,=/w, ,int/en,(/w,random/en,./w,uniform/en,(/w,0/m,,/w,len/en,(/w,trainingset/en,)/w,)/w,)/w, ,25/m, ,testset/en,./w,append/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,26/m, ,del/en,(/w,trainingset/en,[/w,randindex/en,]/w,)/w, ,27/m, ,trainmat/en,=/w,[/w,]/w,;/w, ,trainclasses/en, ,=/w, ,[/w,]/w, ,28/m, ,for/en, ,docindex/en, ,in/en, ,trainingset/en,:/w,#,train/en, ,the/en, ,classifier/en, ,(/w,get/en, ,probs/en,)/w, ,trainnb/en,0/m, ,29/m, ,trainmat/en,./w,append/en,(/w,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w,)/w, ,30/m, ,trainclasses/en,./w,append/en,(/w,classlist/en,[/w,docindex/en,]/w,)/w, ,31/m, ,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en, ,=/w, ,trainnb/en,0/m,(/w,array/en,(/w,trainmat/en,)/w,,/w,array/en,(/w,trainclasses/en,)/w,)/w, ,32/m, ,errorcount/en, ,=/w, ,0/m, ,33/m, ,for/en, ,docindex/en, ,in/en, ,testset/en,:/w, ,#,classify/en, ,the/en, ,remaining/en, ,items/en, ,34/m, ,wordvector/en, ,=/w, ,bagofwords/en,2/m,vecmn/en,(/w,vocablist/en,,/w, ,doclist/en,[/w,docindex/en,]/w,)/w, ,35/m, ,if/en, ,classifynb/en,(/w,array/en,(/w,wordvector/en,)/w,,/w,p/en,0/m,v/en,,/w,p/en,1/m,v/en,,/w,pspam/en,)/w, ,!/w,=/w, ,classlist/en,[/w,docindex/en,]/w,:/w, ,36/m, ,errorcount/en, ,+/w,=/w, ,1/m, ,3