svd/en,奇异值/nw,分解/v,：/w,svd/en,是/v,一种/mq,可靠/a,的/u,正交/nw,矩阵/n,分解法/nw,。/w,可以/v,把/p,a/en,矩阵/n,分解/v,成/v,u/en,，/w,∑/w,，/w,vt/en,三个/m,矩阵/n,相乘/v,的/u,形式/n,。/w,（/w,svd/en,(/w,a/en,)/w,=/w,[/w,u/en,*/w,∑/w,*/w,vt/en,]/w,，/w,a/en,不必/d,是/v,方阵/n,，/w,u/en,，/w,vt/en,必定/d,是/v,正/d,交阵/nw,，/w,s/en,是/v,对/p,角阵/nw,</w,以/p,奇异值/nw,为/p,对角线/n,,/w,其他/r,全/a,为/p,0/m,>,）/w,用途/n,：/w,信息/n,检索/v,(/w,lsa/en,:/w,隐性/b,语义/n,索引/n,，/w,lsa/en,:/w,隐性/b,语义/n,分析/vn,)/w,，/w,分解/v,后/f,的/u,奇异值/nw,代表/n,了/u,文章/n,的/u,主题/n,或者/c,概念/n,，/w,信息/n,检索/v,的/u,时候/n,同义词/n,，/w,或者说/nw,同一/b,主题/n,下/f,的/u,词会/nw,映射/v,为/p,同一/b,主题/n,，/w,这样/r,就/d,可以/v,提高/v,搜索/vn,效率/n,数据/n,压缩/v,：/w,通过/p,奇异值/nw,分解/v,，/w,选择/v,能量/n,较/d,大/a,的/u,前/f,n/en,个/q,奇异值/nw,来/v,代替/v,所有/b,的/u,数据/n,信息/n,，/w,这样/r,可以/v,降低/v,噪声/n,，/w,节省/v,空间/n,。/w,推荐/v,系统/n,：/w,主要/b,是/v,降噪/v,，/w,矩阵/n,变换/v,至/p,低维/nw,空间/n,，/w,方便/a,计算/v,（/w,目前/t,没有/v,意识/n,到/v,它/r,对/p,推荐/v,精确度/n,的/u,提升/v,有/v,什么/r,具体/a,作用/n,）/w,。/w,原理/n,：/w,矩阵/n,分解/v,，/w,矩阵/n,变换/v,，/w,数据/n,降维/nw,基于/p,协同/v,过滤/v,的/u,推荐/v,系统/n,（/w,相关/v,知识/n,）/w,：/w,相似/a,度/q,计算/v,：/w,a/en,(/w,a/en,1/m,,/w,a/en,2/m,,/w,a/en,3/m,)/w,,/w,b/en,(/w,b/en,1/m,,/w,b/en,2/m,,/w,b/en,3/m,)/w,1/m,./w,欧氏/nr,距离/n,相似/a,度/q,：/w,点/q,到/v,点/q,的/u,距离/n,在/p,多/a,维/q,空间/n,的/u,推广/v, ,，/w,|/w,|/w,a/en,-/w,b/en,|/w,|/w,表示/v,a/en,-/w,b/en,的/u,2/m,范数/nr,。/w,，/w,2/m,./w,皮尔逊/nr,相关/v,系数/n,：/w,3/m,./w,余玄相似度/nw,：/w,svd/en,的/u,矩阵/n,空间/n,变换/v,：/w,1/m,./w,奇异值/nw,分解/v,2/m,./w,奇异值/nw,选择/v,，/w,数据/n,矩阵/n,重构/v,：/w,协同/v,过滤算法/nw,，/w,就是/d,在/p,重构/v,后/f,的/u,矩阵/n,空间/n,上/f,做/v,相似/a,度/q,计算/v,。/w,下面/f,就/d,《/w,机器/n,学习/v,实战/n,》/w,来/v,看/v,一下/m,具体/a,矩阵/n,分解/v,和/c,奇异值/nw,选择/v,的/u,操作/v,（/w,后面/f,会/v,附上/v,具体/a,的/u,代码/n,，/w,大家/r,一/m,看/v,就/d,懂/v,，/w,很多/m,东西/n,都/d,被/p,python/en,封/q,装/v,好/a,了/u,，/w,直接/ad,调用/v,）/w,：/w,原始/a,数据/n,data/en,1/m,：/w,每/r,一列/mq,代表/n,一种/mq,商品/n,，/w,每/r,一行/n,代表/n,一个/m,用户/n,，/w,数据/n,是/v,用户/n,对/p,商品/n,的/u,评价/v,data/en,:/w,(/w,m/en,*/w,n/en,)/w,7/m,*/w,5/m,奇异值/nw,分解/v,：/w,u/en,:/w,(/w,m/en,*/w,m/en,)/w,7/m,*/w,7/m,∑/w,:/w,(/w,m/en,*/w,n/en,对角/n,矩阵/n,，/w,前/f,n/en,*/w,n/en,是/v,对角/n,矩阵/n,，/w,对角线/n,时/ng,奇异值/nw,，/w,后/f,m/en,-/w,n/en,是/v,0/m,)/w,7/m,*/w,5/m,vt/en,:/w,(/w,n/en,*/w,n/en,)/w,5/m,*/w,5/m,奇异值/nw,选择/v,:/w,∑/w,=/w,（/w,e/en,1/m,,/w,e/en,2/m,,/w,e/en,3/m,./w,./w,./w,em/en,）/w,从/p,上图/n, ,分解/v,后/f,的/u,∑/w,可以/v,看出/v,前/f,2个/m,奇异值之/nw,和/c,远/a,大于/nrf,后面/f,的/u,奇异值/nw,，/w,所以/c,说/v,，/w,前/f,两个/m,奇异值/nw,中/f,代表/n,的/u,信息/n,足以/d,描述/v,整个/b,数据/n,。/w,我们/r,可以/v,计算/v,前/f,x/en,个/q,奇异/a,值得/v,平方/q,和/c,占/v,所有/b,奇异值/nw,的/u,平方和/n,的/u,比例/n,，/w,如果/c,大于/v,90%/mq,，/w,我们/r,就/d,选/v,这/r,x/en,个/q,奇异值/nw,重构/v,矩阵/n,（/w,剩余/vn,的/u,数据/n,代表/n,的/u,可能/v,是/v,噪声/n,，/w,无用/v,数据/n,）/w,我们/r,通过/p,矩阵/n,重构/v,来/v,看/v,一下/m,理论/n,是否/v,正确/a,矩阵/n,重构/v,:/w,u/en,：/w,（/w,m/en,*/w,x/en,）/w,7/m,*/w,2/m,∑/w,:/w,(/w,x/en,*/w,x/en,)/w,2/m,*/w,2/m,,/w,以前/f,x/en,个/q,奇异值/nw,构建/v,对/p,角矩/nw,阵/ng,vt/en,:/w,(/w,x/en,*/w,n/en,)/w,2/m,*/w,5/m,a/en,’/w,：/w,重构/v,后/f,的/u,u/en,*/w,∑/w,*/w,vt/en,可以/v,发现/v,原始/a,数据/n,中/f,非/h,零/m,的/u,部分/n,都/d,完整/a,的/u,保存/v,了/u,下来/v,，/w,说明/v,选择/v,的/u,奇异值/nw,几乎/d,完整/a,地/u,保存/v,了/u,所有/b,有用/a,信息/n,。/w,其他/r,部分/n,都/d,是/v,近似/a,为/p,零/m,的/u,小数/n,，/w,将/d,他们/r,损失/n,精度/n,，/w,强转/nw,成/v,整形/v,后/f,就/d,是/v,0/m,强转/nw,之后/f,如下/v,图/n,：/w,原始/a,数据/n,data/en,:/w,可以/v,看到/v,相/d,比较/d,于/p,原始/a,数据/n,出现/v,了/u,部分/n,损失/n,，/w,这/r,是/v,由于/c,强转/nw,后/f,将/d,损失/n,信息/n,放大/v,所/u,致/v,，/w,在/p,浮点数/nz,情况/n,下/f,这些/r,微小/a,的/u,损失/n,被/p,忽略/v,掉/v,了/u,（/w,个人/n,理解/v,）/w,。/w,基于/p,以下/f,数据/n,data/en,2/m,做/v,商品/n,推荐/v,：/w,行/v,：/w,用户/n,，/w,列/v,：/w,商品/n,（/w,由于/c,上/f,一个/m,数据集/nw,维数/nr,较/d,低/a,已经/d,用于/v,展示/v,了/u,这个/r,步骤/n,中/f,的/u,操作/v,，/w,下面/f,就/d,直接/ad,放/v,代码/n,实现/v,）/w,步骤/n,:/w,1/m,./w,进行/v,矩阵/n,奇异值/nw,分解/v,2/m,./w,矩阵/n,进行/v,低维/nw,空间/n,的/u,映射/v, ,降维/nw,后/f,的/u,数据/n,a/en,’/w,3/m,./w,在/p,低维/nw,空间/n,做/v,相似/a,度/q,计算/v,，/w,并/c,进行/v,估计/v,评分/vn,贴/v,代码/n,：/w,(/w,没有/v,代码/n,说/v,个/q,卵/n,呀/y,！/w,，/w,最后/f,会/v,放/v,上/f,源码/nw,)/w,python/en,(/w,才/d,开始/v,用/p,可能/v,风格/n,有点/d,怪异/an,)/w,，/w,代码/n,是/v,机器/n,学习/v,实战/n,的/u,内容/n,，/w,注释/vn,也/d,很多/m,，/w,不/d,做/v,多/a,说/v,了/u,exp/en,:/w, ,用户/n,a/en,，/w,评价/v,了/u,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,这/r,5个/m,商品/n,中/f,的/u,1/m,,/w,2/m,,/w,3/m,用户/n,b/en,，/w,评价/v,了/u,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,这/r,5个/m,商品/n,中/f,的/u,1/m,,/w,3/m,,/w,4/m,现在/t,要/v,给/p,a/en,做/v,推荐/v,4/m,,/w,5号/mq,商品/n,(/w,未/d,评价/v,过/u,的/u,才/d,需要/v,推荐/v,)/w,，/w,首先/d,我们/r,遍历/nw,a/en,评价/v,过/u,得/u,商品/n,的/u,每/r,一列/mq,(/w,在/p,矩阵/n,中/f,代表/n,其他/r,用户/n,对/p,这个/r,商品/n,的/u,评价/v,)/w,，/w,然后/c,和/c,指定/v,的/u,4号/mq,商品/n,所在/n,的/u,列/v,做/v,相似/a,度/q,计算/v,。/w,在/p,这里/r,就/d,是/v,1/m,,/w,2/m,,/w,3/m,，/w,列/v,分别/d,于/p,第四/nw,列/v,做/v,相似/a,度/q,计算/v,给/p,出/v,一个/m,评分/vn,。/w,然后/c,1/m,,/w,2/m,,/w,3列/mq,再/d,与/p,第/m,5列/mq,做/v,相似/a,度/q,评分/vn,。/w,最终/d,我们/r,比较/d,4/m,,/w,5/m,的/u,估计/v,评/v,分值/n,，/w,谁/r,大/a,，/w,我们/r,就/d,说/v,，/w,喜欢/v,1/m,,/w,2/m,,/w,3号/mq,商品/n,的/u,用户/n,可能/v,也/d,喜欢/v,4号/mq,。/w,就/d,以上/f,的/u,说明/v,并/c,没有/v,用/p,到/v,svd/en,,/w,我们/r,再/d,取/v,数据/n,的/u,列/v,的/u,时候/n,并/c,不/d,是/v,从/p,原/b,矩阵/n,中/f,去/v,取/v,，/w,而是/c,从/p,利用/v,svd/en,降维/nw,后/f,的/u,矩阵/n,中/f,去/v,取/v,(/w,这/r,是/v,唯一/b,用/p,到/v,svd/en,的/u,部分/n,)/w,。/w,根据/p,评分/vn,推荐/v,：/w,遍历/nw,所有/b,未/d,评分/vn,的/u,商品/n,，/w,进行/v,评分/vn,，/w,然后/c,排序/vn,取/v,topn/en,(/w,这里/r,选/v,三个/m,)/w,,/w,输出/v,的/u,结果/n,就/d,是/v,给/p,这个/r,用户/n,推荐/v,的/u,商品/n,。/w,基于/p,svd/en,实现/v,的/u,数据/n,压缩/v,：/w,svd/en,数据/n,压缩/v,说/v,白/a,了/u,就/d,是/v,奇异值/nw,分解/v,后/f,，/w,a/en,可以/v,近似/a,的/u,用/p,u/en,’/w,*/w,∑/w,’/w,*/w,vt/en,’/w,表示/v,a/en,,/w,原始/a,的/u,a/en,需要/v,m/en,*/w,n/en,个/q,存储/vn,空间/n,，/w,我们/r,现在/t,只/d,需要/v,存储/vn,u/en,’/w,，/w,∑/w,’/w,，/w,vt/en,’/w,三个/m,矩阵/n,在/p,使用/v,的/u,时候/n,做/v,乘积/n,就/d,可以/v,得到/v,a/en,，/w,而且/c,u/en,’/w,,/w,∑/w,’/w,,/w,vt/en,’/w,需要/v,的/u,空间/n,m/en,*/w,x/en,+/w,x/en,*/w,x/en,+/w,x/en,*/w,n/en,远/a,小于/v,m/en,*/w,n/en,，/w,这/r,就/d,实现/v,了/u,数据/n,压缩/v,。/w,从/p,m/en,*/w,n/en,压缩/v,到/v,了/u,m/en,*/w,x/en,+/w,x/en,*/w,x/en,+/w,x/en,*/w,nexp/en,:/w,对/p,一个/m,图像/n,数据/n,进行/v,压缩/v,：/w,32/m,*/w,32/m,的/u,图像/n,数据/n, ,总/b,空间/n,需要/v,：/w,32/m,*/w,32/m,=/w,1024/m,压缩/v,前/f,：/w,压缩/v,后/f,还原/v,：/w,可以/v,发现/v,有/v,微小/a,的/u,差异/n,压缩/v,后/f,的/u,三个/m,矩阵/n,：/w,sigma/en,(/w,2/m,)/w,,/w,vt/en,(/w,2/m,*/w,32/m,)/w,,/w,u/en,(/w,32/m,*/w,2/m,)/w,总/b,空间/n,=/w,130/m,相比/v,1024/m,极/d,大/a,缩小/v,了/u,占有/v,空间/n,源代码/n,:/w,(/w,py/en,2.7/m,可/v,直接/ad,运行/vn,)/w,1/m, ,#, ,-/w,*/w,-/w, ,coding/en,:/w,utf/en,-/w,8/m, ,-/w,*/w,-/w, ,2/m, ,#, ,filename/en,:/w, ,svd/en,./w,py/en, ,3/m, ,#, ,author/en,：/w,ljcx/en, ,4/m, ,5/m, ,6/m, ,from/en, ,numpy/en, ,import/en,*/w, ,7/m, ,8/m, ,9/m, ,class/en, ,svd/en,(/w,object/en,)/w,:/w, ,10/m, ,11/m, ,def/en, ,loadexdata/en,(/w,self/en,)/w,:/w, ,12/m, ,data/en, ,=/w, ,[/w,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,2/m,,/w, ,2/m,]/w,,/w, ,13/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,3/m,,/w, ,3/m,]/w,,/w, ,14/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,1/m,]/w,,/w, ,15/m, ,[/w,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,16/m, ,[/w,2/m,,/w, ,2/m,,/w, ,2/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,17/m, ,[/w,5/m,,/w, ,5/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,18/m, ,[/w,1/m,,/w, ,1/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,]/w,]/w, ,19/m, ,return/en, ,data/en, ,20/m, ,21/m, ,def/en, ,loadexdata/en,2/m,(/w,self/en,)/w,:/w, ,22/m, ,"/w,"/w,"/w, ,23/m, ,列/v,表示/v,商品/n,，/w,行/v,表示/v,用户/n,的/u,评分/vn, ,24/m, ,"/w,"/w,"/w, ,25/m, ,return/en,[/w,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,]/w,,/w, ,26/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,3/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,3/m,]/w,,/w, ,27/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,]/w,,/w, ,28/m, ,[/w,3/m,,/w, ,3/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,2/m,,/w, ,2/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,29/m, ,[/w,5/m,,/w, ,4/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,]/w,,/w, ,30/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,,/w, ,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,]/w,,/w, ,31/m, ,[/w,4/m,,/w, ,3/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,5/m,,/w, ,0/m,,/w, ,1/m,]/w,,/w, ,32/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,]/w,,/w, ,33/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,2/m,,/w, ,0/m,,/w, ,2/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,2/m,]/w,,/w, ,34/m, ,[/w,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,5/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,4/m,,/w, ,0/m,]/w,,/w, ,35/m, ,[/w,1/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,0/m,,/w, ,0/m,]/w,]/w, ,36/m, ,37/m, ,#, ,相似/a,度/q,计算/v,:/w,ina/en,,/w,inb/en,为/p,列向量/nw,还是/c,行向量/nw,，/w,基于/p,我们/r,需要/v,计算/v,相似/a,的/u,维度/n, ,38/m, ,def/en, ,ecludsim/en,(/w,self/en,,/w, ,ina/en,,/w, ,inb/en,)/w,:/w, ,39/m, ,"/w,"/w,"/w,norm/en,(/w,)/w,求/v,范数/nr, ,40/m, ,范数/nr,表示/v,数值/n,平方/q,开方/v,，/w,ina/en,-/w,inb/en,的/u,范数/nr, ,=/w, ,ina/en,和/c,inb/en,的/u,欧氏/nr,距离/n, ,41/m, ,"/w,"/w,"/w, ,42/m, ,return/en, ,1.0/m, ,//w, ,(/w,1.0/m, ,+/w, ,linalg/en,./w,norm/en,(/w,ina/en, ,-/w, ,inb/en,)/w,)/w, ,43/m, ,44/m, ,def/en, ,pearssim/en,(/w,self/en,,/w, ,ina/en,,/w, ,inb/en,)/w,:/w, ,45/m, ,"/w,"/w,"/w,corrcoef/en,(/w,)/w,求/v,皮尔逊/nr,相关/v,系数/n, ,[/w,-/w,1/m,,/w,1/m,]/w, ,46/m, ,皮尔逊/nr,相关/v,系数/n,：/w,0.5/m,+/w,0.5/m,*/w,corrcoef/en,(/w,)/w,规范化/vn,到/v,[/w,0/m,,/w,1/m,]/w, ,47/m, ,"/w,"/w,"/w, ,48/m, ,if/en, ,len/en,(/w,ina/en,)/w, ,</w, ,3/m,:/w, ,49/m, ,return/en, ,1.0/m, ,50/m, ,return/en, ,0.5/m, ,+/w, ,0.5/m, ,*/w, ,corrcoef/en,(/w,ina/en,,/w, ,inb/en,,/w, ,rowvar/en,=/w,0/m,)/w,[/w,0/m,]/w,[/w,1/m,]/w, ,51/m, ,52/m, ,def/en, ,cossim/en,(/w,self/en,,/w, ,ina/en,,/w, ,inb/en,)/w,:/w, ,53/m, ,"/w,"/w,"/w, ,54/m, ,余玄相似度/nw,：/w,即/v,两个/m,向量/n,的/u,余玄夹角值/nw,[/w,-/w,1/m,,/w,1/m,]/w, ,55/m, ,"/w,"/w,"/w, ,56/m, ,num/en, ,=/w, ,float/en,(/w,ina/en,./w,t/en, ,*/w, ,inb/en,)/w, ,57/m, ,denom/en, ,=/w, ,linalg/en,./w,norm/en,(/w,ina/en,)/w, ,*/w, ,linalg/en,./w,norm/en,(/w,inb/en,)/w, ,58/m, ,return/en, ,0.5/m, ,+/w, ,0.5/m, ,*/w, ,(/w,num/en, ,//w, ,denom/en,)/w, ,59/m, ,60/m, ,#, ,奇异值/nw,分解/v,=/w,=/w,》/w,矩阵/n,重构/v,:/w,可/v,用于/v,图像/n,压缩/v, ,61/m, ,def/en, ,svdmt/en,(/w,self/en,,/w, ,data/en,)/w,:/w, ,62/m, ,"/w,"/w,"/w, ,63/m, ,奇异值/nw,分解/v,矩阵/n,data/en, ,=/w, ,u/en, ,*/w, ,sigma/en, ,*/w,vt/en, ,(/w,用/p,分解/v,后/f,的/u,矩阵/n,可以/v,近似/a,地/u,表示/v,原/b,矩阵/n, ,64/m, ,节省/v,空间/n,，/w, ,65/m, ,sigma/en,是/v,个/q,奇异值/nw,方阵/n,)/w, ,66/m, ,"/w,"/w,"/w, ,67/m, ,u/en,,/w, ,sigma/en,,/w, ,vt/en, ,=/w, ,linalg/en,./w,svd/en,(/w,data/en,)/w, ,68/m, ,"/w,"/w,"/w, ,前/f,两个/m,奇异值/nw,已经/d,几乎/d,包含/v,了/u,所有/b,的/u,信息/n,远/a,大于/nrf,后/f,三个/m,数据/n,，/w,所以/c,忽略/v,掉/v,后/f,三个/m, ,69/m, ,数据/n, ,70/m, ,启发式/nw,搜索/vn,：/w,选择/v,奇异/a,之/u,平方/q,和/c,大于/v,总/b,平方/q,和/c,90%/mq,为/p,标准/n, ,71/m, ,"/w,"/w,"/w, ,72/m, ,num/en, ,=/w, ,0/m, ,#, ,需要/v,保存/v,的/u,奇异值/nw,个/q,数/m, ,73/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,sigma/en,)/w,)/w,:/w, ,74/m, ,if/en, ,(/w,linalg/en,./w,norm/en,(/w,sigma/en,[/w,:/w,i/en, ,+/w, ,1/m,]/w,)/w, ,//w, ,linalg/en,./w,norm/en,(/w,sigma/en,)/w,)/w, ,>, ,0.9/m,:/w, ,75/m, ,num/en, ,=/w, ,i/en, ,+/w, ,1/m, ,76/m, ,break/en, ,77/m, ,#, ,构建/v,对/p,角矩/nw,阵/ng, ,78/m, ,sig/en,3/m, ,=/w, ,mat/en,(/w,eye/en,(/w,num/en,)/w, ,*/w, ,sigma/en,[/w,:/w,num/en,]/w,)/w, ,79/m, ,"/w,"/w,"/w,选取/v,前/f,num/en,个/q,奇异值/nw,重构/v,数据集/nw, ,80/m, ,"/w,"/w,"/w, ,81/m, ,newdata/en, ,=/w, ,u/en,[/w,:/w,,/w, ,:/w,num/en,]/w, ,*/w, ,mat/en,(/w,sig/en,3/m,)/w, ,*/w, ,vt/en,[/w,:/w,num/en,,/w, ,:/w,]/w, ,82/m, ,print/en, ,newdata/en, ,83/m, ,print/en, ,newdata/en,./w,astype/en,(/w,int/en,)/w, ,84/m, ,return/en, ,u/en,,/w, ,sigma/en,,/w, ,vt/en,,/w, ,num/en,,/w, ,newdata/en, ,85/m, ,86/m, ,"/w,"/w,"/w, ,87/m, ,基于/p,相似/a,度/q,的/u,推荐/v,引擎/n,:/w, ,88/m, ,只/d,需要/v,对/p,用户/n,所/u,购/vg,商品/n,和/c,其他/r,商品/n,做/v,相似/a,度/q,计算/v,，/w,选取/v,topn/en,个/q,作为/v,推荐/v, ,89/m, ,基于/p,svd/en,的/u,推荐/v,引擎/n,：/w, ,90/m, ,先/d,进行/v,奇异值/nw,分解/v,，/w,选取/v,前/f,n/en,个/q,奇异值/nw,(/w,能量/n,之/u,和/c,大于/v,90%/mq,，/w,奇异/a,之/u,平方/q,和/c,大于/v,总/b,平方/q,和/c, ,91/m, ,90%/mq,为/p,标准/n,)/w,,/w,作为/v,需要/v,降维/nw,的/u,维数/nr,，/w,原/b,数据/n,往/p,低维/nw,空间/n,投影/vn,。/w,data/en,./w,t/en,*/w,u/en,[/w,:/w,,/w,:/w,n/en,]/w,*/w,sigma/en,[/w,:/w,,/w,:/w,4/m,]/w, ,92/m, ,寻找/v,指定/v,一个/m,商品/n,的/u,所有/b,评分/vn,x/en,[/w,,/w,,/w,,/w,]/w,和/c,每/r,一个/m,商品/n,的/u,所有/b,评分/vn,做/v,相似/a,度/q,计算/v,，/w,相似/a,度/q,求/v,和/c, ,93/m, ,"/w,"/w,"/w, ,94/m, ,95/m, ,#, ,相似/a,度/q,推荐/v, ,96/m, ,def/en, ,standest/en,(/w,self/en,)/w,:/w, ,97/m, ,pass/en, ,98/m, ,99/m, ,def/en, ,svdest/en,(/w,self/en,,/w, ,datamat/en,,/w, ,xformeditems/en,,/w, ,user/en,,/w, ,simmeas/en,,/w, ,item/en,)/w,:/w, ,100/m, ,"/w,"/w,"/w,计算/v,相似/a,度/q,并/c,计算/v,评分/vn, ,101/m, ,#, ,datamat/en,:/w,原始/a,数据/n, ,102/m, ,#, ,user/en,:/w,用户/n,编号/v, ,103/m, ,#, ,simmeas/en,:/w,相似/a,度/q,计算/v,方法/n, ,104/m, ,#, ,item/en,：/w,商品/n,编号/v, ,105/m, ,#, ,xformeditems/en,:/w,降维/nw,后/f,的/u,数据/n, ,106/m, ,"/w,"/w,"/w, ,107/m, ,n/en, ,=/w, ,shape/en,(/w,datamat/en,)/w,[/w,1/m,]/w, ,#, ,获取/v,列/v,，/w,多少/r,个/q,商品/n, ,108/m, ,simtotal/en, ,=/w, ,0.0/m, ,109/m, ,ratsimtotal/en, ,=/w, ,0.0/m, ,110/m, ,#, ,计算/v,指定/v,用户/n,评价/v,过/u,的/u,商品/n,与/p,其他/r,所有/b,用户/n,的/u,评价/v,过/u,的/u,商品/n,做/v,相似/a,度/q,计算/v,，/w,来/v,估计/v, ,111/m, ,#, ,指定/v,的/u,未/d,评价/v,商品/n,item/en,的/u,评分/vn, ,112/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,113/m, ,userrating/en, ,=/w, ,datamat/en,[/w,user/en,,/w, ,j/en,]/w, ,114/m, ,if/en, ,userrating/en, ,=/w,=/w, ,0/m, ,or/en, ,j/en, ,=/w,=/w, ,item/en,:/w, ,115/m, ,continue/en, ,116/m, ,similarity/en, ,=/w, ,simmeas/en,(/w,xformeditems/en,[/w,item/en,,/w, ,:/w,]/w,./w,t/en,,/w, ,xformeditems/en,[/w,j/en,,/w, ,:/w,]/w,./w,t/en,)/w, ,117/m, ,print/en, ,'/w,the/en, ,%/w,d/en, ,and/en, ,%/w,d/en, ,similarity/en, ,is/en,:/w, ,%/w,f/en,'/w, ,%/w, ,(/w,item/en,,/w, ,j/en,,/w, ,similarity/en,)/w, ,118/m, ,simtotal/en, ,+/w,=/w, ,similarity/en, ,#, ,相似/a,度/q,求/v,和/c, ,119/m, ,ratsimtotal/en, ,+/w,=/w, ,similarity/en, ,*/w, ,userrating/en, ,#, ,相似/a,度/q,乘/v,以/p,评分/vn,在/p,求/v,和/c, ,120/m, ,if/en, ,simtotal/en, ,=/w,=/w, ,0/m,:/w, ,121/m, ,return/en, ,0/m, ,122/m, ,else/en,:/w, ,123/m, ,return/en, ,ratsimtotal/en, ,//w, ,simtotal/en, ,#, ,根据/p,相似/a,度/q,对/p,一个/m,指定/v,商品/n,给/p,一个/m,评分/vn, ,124/m, ,125/m, ,def/en, ,recommend/en,(/w,self/en,,/w, ,datamat/en,,/w, ,user/en,,/w, ,n/en,=/w,3/m,,/w, ,simmeas/en,=/w,cossim/en,,/w, ,estmethod/en,=/w,svdest/en,)/w,:/w, ,126/m, ,"/w,"/w,"/w, ,127/m, ,#, ,根据/p,svd/en,空间/n,评分/vn,推荐/v,：/w,寻找/v,所有/b,该/r,用户/n,未/d,评分/vn,的/u,商品/n,，/w,对/p,每个/r,商品/n,进行/v,评分/vn,估计/v,(/w,)/w, ,128/m, ,"/w,"/w,"/w, ,129/m, ,unrateditems/en, ,=/w, ,nonzero/en,(/w,datamat/en,[/w,user/en,,/w, ,:/w,]/w,./w,a/en, ,=/w,=/w, ,0/m,)/w,[/w,1/m,]/w, ,#, ,findunrated/en, ,items/en, ,130/m, ,if/en, ,len/en,(/w,unrateditems/en,)/w, ,=/w,=/w, ,0/m,:/w, ,131/m, ,return/en, ,'/w,you/en, ,rated/en, ,everything/en,'/w, ,132/m, ,u/en,,/w, ,sigma/en,,/w, ,vt/en,,/w, ,num/en,,/w, ,newdata/en, ,=/w, ,self/en,./w,svdmt/en,(/w,datamat/en,)/w, ,133/m, ,sig/en, ,=/w, ,mat/en,(/w,eye/en,(/w,num/en,)/w, ,*/w, ,sigma/en,[/w,:/w,num/en,]/w,)/w, ,#, ,构建/v,对/p,角矩/nw,阵/ng, ,134/m, ,xformeditems/en, ,=/w, ,datamat/en,./w,t/en, ,*/w, ,u/en,[/w,:/w,,/w, ,:/w,num/en,]/w, ,*/w, ,sig/en,./w,i/en, ,#, ,数据/n,投影/vn,降维/nw, ,135/m, ,print/en, ,"/w,----/nrf,xform/en,---/nrf,"/w, ,136/m, ,print/en, ,xformeditems/en, ,137/m, ,itemscores/en, ,=/w, ,[/w,]/w, ,138/m, ,for/en, ,item/en, ,in/en, ,unrateditems/en,:/w, ,139/m, ,estimatedscore/en, ,=/w, ,estmethod/en,(/w, ,140/m, ,datamat/en,,/w, ,xformeditems/en,,/w, ,user/en,,/w, ,simmeas/en,,/w, ,item/en,)/w, ,#, ,评分/vn, ,141/m, ,itemscores/en,./w,append/en,(/w,(/w,item/en,,/w, ,estimatedscore/en,)/w,)/w, ,142/m, ,return/en, ,sorted/en,(/w,itemscores/en,,/w, ,key/en,=/w,lambda/en, ,jj/en,:/w, ,jj/en,[/w,1/m,]/w,,/w, ,reverse/en,=/w,true/en,)/w,[/w,:/w,n/en,]/w, ,143/m, ,144/m, ,def/en, ,loadimagedata/en,(/w,self/en,)/w,:/w, ,145/m, ,"/w,"/w,"/w, ,146/m, ,加/v,载/v,图像/n,数据/n, ,147/m, ,"/w,"/w,"/w, ,148/m, ,fp/en, ,=/w, ,open/en,(/w,"/w,image/en,./w,txt/en,"/w,,/w, ,"/w,r/en,"/w,)/w, ,149/m, ,imagedata/en, ,=/w, ,[/w,]/w, ,150/m, ,for/en, ,line/en, ,in/en, ,fp/en,./w,readlines/en,(/w,)/w,:/w, ,151/m, ,linedata/en, ,=/w, ,[/w,]/w, ,152/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,line/en,)/w, ,-/w, ,1/m,)/w,:/w, ,153/m, ,linedata/en,./w,append/en,(/w,int/en,(/w,line/en,[/w,i/en,]/w,)/w,)/w, ,154/m, ,imagedata/en,./w,append/en,(/w,linedata/en,)/w, ,155/m, ,return/en, ,mat/en,(/w,imagedata/en,)/w, ,156/m, ,157/m, ,def/en, ,imagecompress/en,(/w,self/en,)/w,:/w, ,158/m, ,"/w,"/w,"/w,svd/en,图像/n,压缩/v, ,=/w,=/w, ,分解/v,矩阵/n,之后/f, ,选择/v,几/m,个/q,重要/a,的/u,奇异值