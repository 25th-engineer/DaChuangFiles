注/v,：/w,在/p,吴恩达/nr,老师/n,讲/v,的/u,【/w,机器/n,学习/v,】/w,课程/n,中/f,，/w,最/d,开始/v,介绍/v,神经/n,网络/n,的/u,应用/vn,时/ng,就/d,介绍/v,了/u,含有/v,一个/m,隐藏层/nw,的/u,神经/n,网络/n,可以/v,解决/v,异或/nw,问题/n,，/w,而/c,这/r,是/v,单层/nw,神经/n,网络/n,（/w,也/d,叫/v,感知机/nw,）/w,做/v,不/d,到/v,了/u,，/w,当时/t,就/d,觉得/v,非常/d,神奇/a,，/w,之后/f,就/d,一直/d,打算/v,自己/r,实现/v,一下/m,，/w,一直/d,到/v,一周/mq,前/f,才/d,开始/v,动手/v,实现/v,。/w,自己/r,参考/v,【/w,机器/n,学习/v,】/w,课程/n,中/f,数字/n,识别/v,的/u,作业/vn,题写/v,了/u,代码/n,，/w,对于/p,作业/vn,题/n,中/f,给/p,的/u,数字/n,图片/n,可以/v,达到/v,95%/mq,左右/m,的/u,识别/v,准确度/n,。/w,但是/c,改/v,成/v,训练/vn,异或/nw,的/u,网络/n,时/ng,，/w,怎么/r,也/d,无法/v,得到/v,正确/a,的/u,结果/n,。/w,后来/t,查/v,了/u,一些/m,资料/n,才/d,发现/v,是/v,因为/c,自己/r,有/v,一个/m,参数/n,设置/v,的/u,有/v,问题/n,，/w,而且/c,学习/v,率/v,过/u,小/a,，/w,迭代/vn,的/u,次数/n,也/d,不够/a,。/w,总之/c,，/w,异或/nw,逻辑/n,的/u,实现/v,不仅/c,对于/p,人工/n,神经/n,网络/n,这/r,一/m,算法/n,是/v,一/m,大/a,突破/vn,，/w,对于/p,我/r,自己/r,对/p,误差/n,反向/f,传播/vn,算法/n,（/w,error/en, ,back/en, ,propagation/en,,/w, ,bp/en,）/w,的/u,理解/v,也/d,是/v,非常/d,重要/a,的/u,过程/n,，/w,因此/c,记录/v,于/p,此/r,。/w,什么/r,是/v,异或/nw,在/p,数字/n,逻辑/n,中/f,，/w,异或/nw,是/v,对/p,两个/m,运算/vn,元/q,的/u,一种/mq,逻辑/n,分析/vn,类型/n,，/w,符号/n,为/p,xor/en,或/c,eor/en,或/c,⊕,。/w,与/p,一般/a,的/u,或/c,（/w,or/en,）/w,不同/a,，/w,当/p,两两/m,数值/n,相/d,同时/c,为/p,否/vg,，/w,而/c,数值/n,不/d,同时/c,为/p,真/d,。/w,异或/nw,的/u,真值/nw,表/n,如下/v,：/w,xor/en, ,truth/en, ,tableinputoutputab/en,0000111011100/m,,/w, ,false/en,1/m,,/w, ,true/en,据说/v,在/p,人工/n,神经/n,网络/n,（/w,artificial/en, ,neural/en, ,network/en,,/w, ,ann/en,）/w,发展/vn,初期/f,，/w,由于/c,无法/v,实现/v,对/p,多/a,层/q,神经/n,网络/n,（/w,包括/v,异或/nw,逻辑/n,）/w,的/u,训练/vn,而/c,造成/v,了/u,一场/mq,ann/en,危机/n,，/w,到/v,最后/f,bp/en,算法/n,的/u,出现/v,，/w,才/d,让/v,训练/vn,带有/v,隐藏层/nw,的/u,多/a,层/q,神经/n,网络/n,成为/v,可能/v,。/w,因此/c,异或/nw,的/u,实现/v,在/p,ann/en,的/u,发展史/n,是/v,也/d,是/v,具有/v,里程碑/n,意义/n,的/u,。/w,异或/nw,之所以/c,重要/a,，/w,是/v,因为/c,它/r,相对于/nw,其他/r,逻辑/n,关系/n,，/w,例如/v,与/p,（/w,and/en,）/w,,/w, ,或/c,（/w,or/en,）/w,等/u,，/w,异或/nw,是/v,线性/n,不/d,可/v,分/q,的/u,。/w,如/v,下/f,图/n,：/w,在/p,实际/n,应用/vn,中/f,，/w,异或/nw,门/n,（/w,exclusive/en,-/w,or/en, ,gate/en,,/w, ,xor/en, ,gate/en,）/w,是/v,数字/n,逻辑/n,中/f,实现/v,逻辑/n,异或/nw,的/u,逻辑门/nw,，/w,这/r,一/m,函数/n,能/v,实现/v,模/ng,为/p,2/m,的/u,加法/n,。/w,因此/c,，/w,异或/nw,门/n,可以/v,实现/v,计算机/n,中/f,的/u,二进制加法/nw,。/w,异或/nw,的/u,神经/n,网络结构/l,在/p,【/w,机器/n,学习/v,】/w,课程/n,中/f,，/w,使用/v,了/u,and/en,（/w,与/p,）/w,，/w,nor/en,（/w,或非/c,）/w,和/c,or/en,（/w,或/c,）/w,的/u,组合/v,实现/v,了/u,xnor/en,（/w,同/p,或/c,）/w,，/w,与/p,我们/r,要/v,实现/v,的/u,异或/nw,（/w,xor/en,）/w,正好/z,相反/v,。/w,因此/c,还是/c,可以/v,采用/v,课程/n,中/f,的/u,神经/n,网络结构/l,，/w,如/v,下/f,图/n,：/w,如果/c,算/v,上/f,输入层/nw,我们/r,的/u,网络/n,共有/v,三层/mq,，/w,如/v,下/f,图/n,所/u,示/vg,，/w,其中/r,第/m,1层/mq,和/c,第/m,2层/mq,中/f,的/u,1/m,分别/d,是/v,这/r,两层/mq,的/u,偏置/nw,单元/n,。/w,连/u,线/n,上/f,是/v,连接/v,前后/f,层/q,的/u,参数/n,。/w,输入/v,：/w,我们/r,一共/d,有/v,四个/m,训练/vn,样本/n,，/w,每个/r,样本/n,有/v,两个/m,特征/n,，/w,分别/d,是/v,(/w,0/m,,/w, ,0/m,)/w,,/w, ,(/w,1/m,,/w, ,0/m,)/w,,/w, ,(/w,0/m,,/w, ,1/m,)/w,,/w, ,(/w,1/m,,/w, ,1/m,)/w,;/w,理想/n,输出/v,：/w,参考/v,上面/f,的/u,真值/nw,表/n,，/w,样本/n,中/f,两个/m,特征/n,相/d,同时/c,为/p,0/m,，/w,相异/nw,为/p,1/m,参数/n,：/w,随机/d,初始化/v,，/w,范围/n,为/p,(/w,-/w,1/m,,/w, ,1/m,)/w,关于/p,神经/n,网络/n,的/u,基础/n,知识/n,以及/c,前/f,向/p,传播/vn,、/w,反向/f,传播/vn,的/u,实现/v,请/v,参考/v,下面/f,两/m,篇文章/n,，/w,写/v,的/u,非常/d,精彩/a,：/w,机器/n,学习/v,公开课/n,笔记/n,(/w,4/m,)/w,：/w,神经/n,网络/n,(/w,neural/en, ,network/en,)/w,——/w,表示/v,机器/n,学习/v,公开课/n,笔记/n,(/w,5/m,)/w,：/w,神经/n,网络/n,(/w,neural/en, ,network/en,)/w,——/w,学习/v,代码/n,原/b,生态/n,的/u,代码/n,：/w,下面/f,的/u,实现/v,是/v,完全/ad,根据/p,自己/r,的/u,理解/v,和/c,对/p,【/w,机器/n,学习/v,】/w,课程/n,中/f,作业/vn,题/n,的/u,模仿/v,而/c,写/v,成/v,的/u,，/w,虽然/c,代码/n,质量/n,不/d,是/v,非常/d,高/a,，/w,但是/c,算法/n,的/u,所有/b,细节/n,都/d,展示/v,出来/v,了/u,。/w,在/p,66/m,,/w, ,69/m,,/w, ,70行/mq,的/u,注释/vn,是/v,我/r,之前/f,没有/v,得到/v,正确/a,结果/n,的/u,三个/m,原因/n,，/w,其中/r,epsilon/en,确定/v,的/u,是/v,随机/d,初始化/v,参数/n,的/u,范围/n,，/w,例如/v,epsilon/en,=/w,1/m,，/w,参数/n,范围/n,就/d,是/v,(/w,-/w,1/m,,/w, ,1/m,)/w,1/m, ,#, ,-/w,*/w,-/w, ,coding/en,:/w, ,utf/en,-/w,8/m, ,-/w,*/w,-/w, ,2/m, ,"/w,"/w,"/w, ,3/m, ,created/en, ,on/en, ,tue/en, ,apr/en, ,4/m, ,10/m,:/w,47/m,:/w,51/m, ,2017/m, ,4/m, ,5/m, ,@/w,author/en,:/w, ,xin/en, ,6/m, ,"/w,"/w,"/w, ,7/m, ,#, ,neural/en, ,network/en, ,for/en, ,xor/en, ,8/m, ,import/en, ,numpy/en, ,as/en, ,np/en, ,9/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,10/m, ,11/m, ,hidden/en,_,layer/en,_,size/en, ,=/w, ,2/m, ,12/m, ,input/en,_,layer/en, ,=/w, ,2/m, ,#, ,input/en, ,feature/en, ,13/m, ,num/en,_,labels/en, ,=/w, ,1/m, ,#, ,output/en, ,class/en, ,number/en, ,14/m, ,x/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,,/w, ,0/m,]/w,,/w, ,[/w,0/m,,/w, ,1/m,]/w,,/w, ,[/w,1/m,,/w, ,0/m,]/w,,/w, ,[/w,1/m,,/w, ,1/m,]/w,]/w,)/w, ,15/m, ,y/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,0/m,]/w,,/w, ,[/w,1/m,]/w,,/w, ,[/w,1/m,]/w,,/w, ,[/w,0/m,]/w,]/w,)/w, ,16/m, ,17/m, ,18/m, ,def/en, ,rand/en,_,initialize/en,_,weights/en,(/w,l/en,_,in/en,,/w, ,l/en,_,out/en,,/w, ,epsilon/en,)/w,:/w, ,19/m, ,"/w,"/w,"/w, ,20/m, ,randomly/en, ,initialize/en, ,the/en, ,weights/en, ,of/en, ,a/en, ,layer/en, ,with/en, ,l/en,_,in/en, ,21/m, ,incoming/en, ,connections/en, ,and/en, ,l/en,_,out/en, ,outgoing/en, ,connections/en,;/w, ,22/m, ,23/m, ,note/en, ,that/en, ,w/en, ,should/en, ,be/en, ,set/en, ,to/en, ,a/en, ,matrix/en, ,of/en, ,size/en,(/w,l/en,_,out/en,,/w, ,1/m, ,+/w, ,l/en,_,in/en,)/w, ,as/en, ,24/m, ,the/en, ,first/en, ,column/en, ,of/en, ,w/en, ,handles/en, ,the/en, ,"/w,bias/en,"/w, ,terms/en, ,25/m, ,"/w,"/w,"/w, ,26/m, ,epsilon/en,_,init/en, ,=/w, ,epsilon/en, ,27/m, ,w/en, ,=/w, ,np/en,./w,random/en,./w,rand/en,(/w,l/en,_,out/en,,/w, ,1/m, ,+/w, ,l/en,_,in/en,)/w, ,*/w, ,2/m, ,*/w, ,epsilon/en,_,init/en, ,-/w, ,epsilon/en,_,init/en, ,28/m, ,return/en, ,w/en, ,29/m, ,30/m, ,31/m, ,def/en, ,sigmoid/en,(/w,x/en,)/w,:/w, ,32/m, ,return/en, ,1.0/m, ,//w, ,(/w,1.0/m, ,+/w, ,np/en,./w,exp/en,(/w,-/w,x/en,)/w,)/w, ,33/m, ,34/m, ,35/m, ,def/en, ,sigmoid/en,_,gradient/en,(/w,z/en,)/w,:/w, ,36/m, ,g/en, ,=/w, ,np/en,./w,multiply/en,(/w,sigmoid/en,(/w,z/en,)/w,,/w, ,(/w,1/m, ,-/w, ,sigmoid/en,(/w,z/en,)/w,)/w,)/w, ,37/m, ,return/en, ,g/en, ,38/m, ,39/m, ,40/m, ,def/en, ,nn/en,_,cost/en,_,function/en,(/w,theta/en,1/m,,/w, ,theta/en,2/m,,/w, ,x/en,,/w, ,y/en,)/w,:/w, ,41/m, ,m/en, ,=/w, ,x/en,./w,shape/en,[/w,0/m,]/w, ,#, ,m/en,=/w,4/m, ,42/m, ,#, ,计算/v,所有/b,参数/n,的/u,偏导/nw,数/m,（/w,梯度/n,）/w, ,43/m, ,d/en,_,1/m, ,=/w, ,np/en,./w,zeros/en,(/w,theta/en,1/m,./w,shape/en,)/w, ,#, ,Δ,_,1/m, ,44/m, ,d/en,_,2/m, ,=/w, ,np/en,./w,zeros/en,(/w,theta/en,2/m,./w,shape/en,)/w, ,#, ,Δ,_,2/m, ,45/m, ,h/en,_,total/en, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,m/en,,/w, ,1/m,)/w,)/w, ,#, ,所有/b,样本/n,的/u,预测值/n,,/w, ,m/en,*/w,1/m,,/w, ,probability/en, ,46/m, ,for/en, ,t/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,47/m, ,a/en,_,1/m, ,=/w, ,np/en,./w,vstack/en,(/w,(/w,np/en,./w,array/en,(/w,[/w,[/w,1/m,]/w,]/w,)/w,,/w, ,x/en,[/w,t/en,:/w,t/en, ,+/w, ,1/m,,/w, ,:/w,]/w,./w,t/en,)/w,)/w, ,#, ,列/v,向量/n,,/w, ,3/m,*/w,1/m, ,48/m, ,z/en,_,2/m, ,=/w, ,np/en,./w,dot/en,(/w,theta/en,1/m,,/w, ,a/en,_,1/m,)/w, ,#, ,2/m,*/w,1/m, ,49/m, ,a/en,_,2/m, ,=/w, ,np/en,./w,vstack/en,(/w,(/w,np/en,./w,array/en,(/w,[/w,[/w,1/m,]/w,]/w,)/w,,/w, ,sigmoid/en,(/w,z/en,_,2/m,)/w,)/w,)/w, ,#, ,3/m,*/w,1/m, ,50/m, ,z/en,_,3/m, ,=/w, ,np/en,./w,dot/en,(/w,theta/en,2/m,,/w, ,a/en,_,2/m,)/w, ,#, ,1/m,*/w,1/m, ,51/m, ,a/en,_,3/m, ,=/w, ,sigmoid/en,(/w,z/en,_,3/m,)/w, ,52/m, ,h/en, ,=/w, ,a/en,_,3/m, ,#, ,预测值/n,h/en,就/d,等于/v,a/en,_,3/m,,/w, ,1/m,*/w,1/m, ,53/m, ,h/en,_,total/en,[/w,t/en,,/w,0/m,]/w, ,=/w, ,h/en, ,54/m, ,delta/en,_,3/m, ,=/w, ,h/en, ,-/w, ,y/en,[/w,t/en,:/w,t/en, ,+/w, ,1/m,,/w, ,:/w,]/w,./w,t/en, ,#, ,最后/f,一层/mq,每/r,一个/m,单元/n,的/u,误差/n,,/w, ,δ,_,3/m,,/w, ,1/m,*/w,1/m, ,55/m, ,delta/en,_,2/m, ,=/w, ,np/en,./w,multiply/en,(/w,np/en,./w,dot/en,(/w,theta/en,2/m,[/w,:/w,,/w, ,1/m,:/w,]/w,./w,t/en,,/w, ,delta/en,_,3/m,)/w,,/w, ,sigmoid/en,_,gradient/en,(/w,z/en,_,2/m,)/w,)/w, ,#, ,第二/m,层/q,每/r,一个/m,单元/n,的/u,误差/n,（/w,不/d,包括/v,偏置/nw,单元/n,）/w,,/w, ,δ,_,2/m,,/w, ,2/m,*/w,1/m, ,56/m, ,d/en,_,2/m, ,=/w, ,d/en,_,2/m, ,+/w, ,np/en,./w,dot/en,(/w,delta/en,_,3/m,,/w, ,a/en,_,2/m,./w,t/en,)/w, ,#, ,第二/m,层/q,所有/b,参数/n,的/u,误差/n,,/w, ,1/m,*/w,3/m, ,57/m, ,d/en,_,1/m, ,=/w, ,d/en,_,1/m, ,+/w, ,np/en,./w,dot/en,(/w,delta/en,_,2/m,,/w, ,a/en,_,1/m,./w,t/en,)/w, ,#, ,第一/m,层/q,所有/b,参数/n,的/u,误差/n,,/w, ,2/m,*/w,3/m, ,58/m, ,theta/en,1/m,_,grad/en, ,=/w, ,(/w,1.0/m, ,//w, ,m/en,)/w, ,*/w, ,d/en,_,1/m, ,#, ,第一/m,层/q,参数/n,的/u,偏导/nw,数/m,，/w,取/v,所有/b,样本/n,中/f,参数/n,的/u,均值/n,，/w,没有/v,加正/nr,则/d,项/q, ,59/m, ,theta/en,2/m,_,grad/en, ,=/w, ,(/w,1.0/m, ,//w, ,m/en,)/w, ,*/w, ,d/en,_,2/m, ,60/m, ,j/en, ,=/w, ,(/w,1.0/m, ,//w, ,m/en,)/w, ,*/w, ,np/en,./w,sum/en,(/w,-/w,y/en, ,*/w, ,np/en,./w,log/en,(/w,h/en,_,total/en,)/w, ,-/w, ,(/w,np/en,./w,array/en,(/w,[/w,[/w,1/m,]/w,]/w,)/w, ,-/w, ,y/en,)/w, ,*/w, ,np/en,./w,log/en,(/w,1/m, ,-/w, ,h/en,_,total/en,)/w,)/w, ,61/m, ,return/en, ,{/w,'/w,theta/en,1/m,_,grad/en,'/w,:/w, ,theta/en,1/m,_,grad/en,,/w, ,62/m, ,'/w,theta/en,2/m,_,grad/en,'/w,:/w, ,theta/en,2/m,_,grad/en,,/w, ,63/m, ,'/w,j/en,'/w,:/w, ,j/en,,/w, ,'/w,h/en,'/w,:/w, ,h/en,_,total/en,}/w, ,64/m, ,65/m, ,66/m, ,theta/en,1/m, ,=/w, ,rand/en,_,initialize/en,_,weights/en,(/w,input/en,_,layer/en,,/w, ,hidden/en,_,layer/en,_,size/en,,/w, ,epsilon/en,=/w,1/m,)/w, ,#, ,之前/f,的/u,问题/n,之一/r,，/w,epsilon/en,的/u,值/n,设置/v,的/u,太/d,小/a, ,67/m, ,theta/en,2/m, ,=/w, ,rand/en,_,initialize/en,_,weights/en,(/w,hidden/en,_,layer/en,_,size/en,,/w, ,num/en,_,labels/en,,/w, ,epsilon/en,=/w,1/m,)/w, ,68/m, ,69/m, ,iter/en,_,times/en, ,=/w, ,10000/m, ,#, ,之前/f,的/u,问题/n,之二/r,，/w,迭代/vn,次数/n,太/d,少/a, ,70/m, ,alpha/en, ,=/w, ,0.5/m, ,#, ,之前/f,的/u,问题/n,之三/r,，/w,学习/v,率/v,太/d,小/a, ,71/m, ,result/en, ,=/w, ,{/w,'/w,j/en,'/w,:/w, ,[/w,]/w,,/w, ,'/w,h/en,'/w,:/w, ,[/w,]/w,}/w, ,72/m, ,theta/en,_,s/en, ,=/w, ,{/w,}/w, ,73/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,iter/en,_,times/en,)/w,:/w, ,74/m, ,cost/en,_,fun/en,_,result/en, ,=/w, ,nn/en,_,cost/en,_,function/en,(/w,theta/en,1/m,=/w,theta/en,1/m,,/w, ,theta/en,2/m,=/w,theta/en,2/m,,/w, ,x/en,=/w,x/en,,/w, ,y/en,=/w,y/en,)/w, ,75/m, ,theta/en,1/m,_,g/en, ,=/w, ,cost/en,_,fun/en,_,result/en,./w,get/en,(/w,'/w,theta/en,1/m,_,grad/en,'/w,)/w, ,76/m, ,theta/en,2/m,_,g/en, ,=/w, ,cost/en,_,fun/en,_,result/en,./w,get/en,(/w,'/w,theta/en,2/m,_,grad/en,'/w,)/w, ,77/m, ,j/en, ,=/w, ,cost/en,_,fun/en,_,result/en,./w,get/en,(/w,'/w,j/en,'/w,)/w, ,78/m, ,h/en,_,current/en, ,=/w, ,cost/en,_,fun/en,_,result/en,./w,get/en,(/w,'/w,h/en,'/w,)/w, ,79/m, ,theta/en,1/m, ,-/w,=/w, ,alpha/en, ,*/w, ,theta/en,1/m,_,g/en, ,80/m, ,theta/en,2/m, ,-/w,=/w, ,alpha/en, ,*/w, ,theta/en,2/m,_,g/en, ,81/m, ,result/en,[/w,'/w,j/en,'/w,]/w,./w,append/en,(/w,j/en,)/w, ,82/m, ,result/en,[/w,'/w,h/en,'/w,]/w,./w,append/en,(/w,h/en,_,current/en,)/w, ,83/m, ,#, ,print/en,(/w,i/en,,/w, ,j/en,,/w, ,h/en,_,current/en,)/w, ,84/m, ,if/en, ,i/en,=/w,=/w,0/m, ,or/en, ,i/en,=/w,=/w,(/w,iter/en,_,times/en,-/w,1/m,)/w,:/w, ,85/m, ,print/en,(/w,'/w,theta/en,1/m,'/w,,/w, ,theta/en,1/m,)/w, ,86/m, ,print/en,(/w,'/w,theta/en,2/m,'/w,,/w, ,theta/en,2/m,)/w, ,87/m, ,theta/en,_,s/en,[/w,'/w,theta/en,1/m,_,'/w,+/w,str/en,(/w,i/en,)/w,]/w, ,=/w, ,theta/en,1/m,./w,copy/en,(/w,)/w, ,88/m, ,theta/en,_,s/en,[/w,'/w,theta/en,2/m,_,'/w,+/w,str/en,(/w,i/en,)/w,]/w, ,=/w, ,theta/en,2/m,./w,copy/en,(/w,)/w, ,89/m, ,90/m, ,plt/en,./w,plot/en,(/w,result/en,./w,get/en,(/w,'/w,j/en,'/w,)/w,)/w, ,91/m, ,plt/en,./w,show/en,(/w,)/w, ,92/m, ,print/en,(/w,theta/en,_,s/en,)/w, ,93/m, ,print/en,(/w,result/en,./w,get/en,(/w,'/w,h/en,'/w,)/w,[/w,0/m,]/w,,/w, ,result/en,./w,get/en,(/w,'/w,h/en,'/w,)/w,[/w,-/w,1/m,]/w,)/w,下面/f,是/v,输出/v,结果/n,：/w,#, ,随机/d,初始化/v,得到/v,的/u,参数/n,(/w,'/w,theta/en,1/m,'/w,,/w, ,array/en,(/w,[/w,[/w, ,0.18589823/m,,/w, ,-/w,0.77059558/m,,/w, ,0.62571502/m,]/w,,/w, ,[/w,-/w,0.79844165/m,,/w, ,0.56069914/m,,/w, ,0.21090703/m,]/w,]/w,)/w,)/w, ,(/w,'/w,theta/en,2/m,'/w,,/w, ,array/en,(/w,[/w,[/w, ,0.1327994/m, ,,/w, ,0.59513332/m,,/w, ,0.34334931/m,]/w,]/w,)/w,)/w,#, ,训练/vn,后/f,得到/v,的/u,参数/n, ,(/w,'/w,theta/en,1/m,'/w,,/w, ,array/en,(/w,[/w,[/w,-/w,3.90903729/m,,/w, ,-/w,7.44497437/m,,/w, ,7.20130773/m,]/w,,/w, ,[/w,-/w,3.76429211/m,,/w, ,6.93482723/m,,/w, ,-/w,7.21857912/m,]/w,]/w,)/w,)/w, ,(/w,'/w,theta/en,2/m,'/w,,/w, ,array/en,(/w,[/w,[/w, ,-/w,6.5739346/m, ,,/w, ,13.33011993/m,,/w, ,13.3891608/m, ,]/w,]/w,)/w,)/w,#, ,同/p,上/f,，/w,第一/m,次/q,迭代/vn,和/c,最后/f,一次/mq,迭代/vn,得到/v,的/u,参数/n, ,{/w,'/w,theta/en,1/m,_,0/m,'/w,:/w, ,array/en,(/w,[/w,[/w, ,0.18589823/m,,/w, ,-/w,0.77059558/m,,/w, ,0.62571502/m,]/w,,/w, ,[/w,-/w,0.79844165/m,,/w, ,0.56069914/m,,/w, ,0.21090703/m,]/w,]/w,)/w,,/w, ,'/w,theta/en,2/m,_,9999/m,'/w,:/w, ,array/en,(/w,[/w,[/w, ,-/w,6.5739346/m, ,,/w, ,13.33011993/m,,/w, ,13.3891608/m, ,]/w,]/w,)/w,,/w, ,'/w,theta/en,1/m,_,9999/m,'/w,:/w, ,array/en,(/w,[/w,[/w,-/w,3.90903729/m,,/w, ,-/w,7.44497437/m,,/w, ,7.20130773/m,]/w,,/w, ,[/w,-/w,3.76429211/m,,/w, ,6.93482723/m,,/w, ,-/w,7.21857912/m,]/w,]/w,)/w,,/w, ,'/w,theta/en,2/m,_,0/m,'/w,:/w, ,array/en,(/w,[/w,[/w, ,0.1327994/m, ,,/w, ,0.59513332/m,,/w, ,0.34334931/m,]/w,]/w,)/w,}/w,#, ,预测值/n,h/en,:/w, ,第/m,1个/m,array/en,里/f,是/v,初始/b,参数/n,预测/v,出来/v,的/u,值/n,，/w,第/m,2个/m,array/en,中/f,是/v,最后/f,一次/mq,得到/v,的/u,参数/n,预测/v,出来/v,的/u,值/n,(/w,array/en,(/w,[/w,[/w, ,0.66576877/m,]/w,,/w, ,[/w, ,0.69036552/m,]/w,,/w, ,[/w, ,0.64994307/m,]/w,,/w, ,[/w, ,0.67666546/m,]/w,]/w,)/w,,/w, ,array/en,(/w,[/w,[/w, ,0.00245224/m,]/w,,/w, ,[/w, ,0.99812746/m,]/w,,/w, ,[/w, ,0.99812229/m,]/w,,/w, ,[/w, ,0.00215507/m,]/w,]/w,)/w,)/w,下面/f,是/v,随着/p,迭代/vn,次数/n,的/u,增加/v,，/w,代价/n,函数/n,值/n,j/en,(/w,θ,)/w,的/u,变化/vn,情况/n,：/w,更加/d,精炼/a,的/u,代码/n,下面/f,这/r,段/q,代码/n,是/v,我/r,在/p,排除/v,之前/f,自己/r,的/u,代码/n,中/f,的/u,问题/n,时/ng,，/w,在/p,stack/en, ,overflow/en,上/f,发现/v,的/u,，/w,发帖/v,的/u,人/n,也/d,碰到/v,了/u,同样/d,的/u,问题/n,，/w,但/c,原因/n,不/d,一样/u,。/w,他/r,的/u,代码/n,里/f,有/v,一点/m,小/a,问题/n,，/w,已经/d,修正/v,。/w,这/r,段/q,代码/n,，/w,相对于/nw,我/r,自己/r,的/u,原生态/n,代码/n,，/w,有/v,了/u,非常/d,大/a,的/u,改进/v,，/w,没有/v,限定/v,层/q,数/m,和/c,每/r,层/q,的/u,单元/n,数/m,，/w,代码/n,本身/r,也/d,比较/d,简洁/a,。/w,说明/v,：/w,由于/c,第/m,44行/mq,，/w,传/v,的/u,参数/n,是/v,该层/nw,的/u,a/en,值/n,，/w,而/c,不/d,是/v,z/en,值/n,，/w,所以/c,第/m,11行/mq,需要/v,做出/v,一点/m,修改/v,，/w,其实/d,直接/ad,传递/v,a/en,值/n,是/v,一种/mq,更/d,方便/a,的/u,做法/n,。/w,1/m, ,#, ,-/w,*/w,-/w, ,coding/en,:/w, ,utf/en,-/w,8/m, ,-/w,*/w,-/w, ,2/m, ,3/m, ,import/en, ,numpy/en, ,as/en, ,np/en, ,4/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,5/m, ,6/m, ,7/m, ,def/en, ,sigmoid/en,(/w,x/en,)/w,:/w, ,8/m, ,return/en, ,1/m,//w,(/w,1/m,+/w,np/en,./w,exp/en,(/w,-/w,x/en,)/w,)/w, ,9/m, ,10/m, ,def/en, ,s/en,_,prime/en,(/w,z/en,)/w,:/w, ,11/m, ,return/en, ,np/en,./w,multiply/en,(/w,z/en,,/w, ,1.0/m,-/w,z/en,)/w, ,#, ,修改/v,的/u,地方/n, ,12/m, ,13/m, ,def/en, ,init/en,_,weights/en,(/w,layers/en,,/w, ,epsilon/en,)/w,:/w, ,14/m, ,weights/en, ,=/w, ,[/w,]/w, ,15/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,layers/en,)/w,-/w,1/m,)/w,:/w, ,16/m, ,w/en, ,=/w, ,np/en,./w,random/en,./w,rand/en,(/w,layers/en,[/w,i/en,+/w,1/m,]/w,,/w, ,layers/en,[/w,i/en,]/w,+/w,1/m,)/w, ,17/m, ,w/en, ,=/w, ,w/en, ,*/w, ,2/m,*/w,epsilon/en, ,-/w, ,epsilon/en, ,18/m, ,weights/en,./w,append/en,(/w,np/en,./w,mat/en,(/w,w/en,)/w,)/w, ,19/m, ,return/en, ,weights/en, ,20/m, ,21/m, ,def/en, ,fit/en,(/w,x/en,,/w, ,y/en,,/w, ,w/en,)/w,:/w, ,22/m, ,#, ,now/en, ,each/en, ,para/en, ,has/en, ,a/en, ,grad/en, ,equals/en, ,to/en, ,0/m, ,23/m, ,w/en,_,grad/en, ,=/w, ,(/w,[/w,np/en,./w,mat/en,(/w,np/en,./w,zeros/en,(/w,np/en,./w,shape/en,(/w,w/en,[/w,i/en,]/w,)/w,)/w,)/w, ,24/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,w/en,)/w,)/w,]/w,)/w, ,#, ,len/en,(/w,w/en,)/w, ,equals/en, ,the/en, ,layer/en, ,number/en, ,25/m, ,m/en,,/w, ,n/en, ,=/w, ,x/en,./w,shape/en, ,26/m, ,h/en,_,total/en, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,m/en,,/w, ,1/m,)/w,)/w, ,#, ,所有/b,样本/n,的/u,预测值/n,,/w, ,m/en,*/w,1/m,,/w, ,probability/en, ,27/m, ,for/en, ,i/en, ,in/en, ,range/en,(/w,m/en,)/w,:/w, ,28/m, ,x/en, ,=/w, ,x/en,[/w,i/en,]/w, ,29/m, ,y/en, ,=/w, ,y/en,[/w,0/m,,/w,i/en,]/w, ,30/m, ,#, ,forward/en, ,propagate/en, ,31/m, ,a/en, ,=/w, ,x/en, ,32/m, ,a/en,_,s/en, ,=/w, ,[/w,]/w, ,33/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,len/en,(/w,w/en,)/w,)/w,:/w, ,34/m, ,a/en, ,=/w, ,np/en,./w,mat/en,(/w,np/en,./w,append/en,(/w,1/m,,/w, ,a/en,)/w,)/w,./w,t/en, ,35/m, ,a/en,_,s/en,./w,append/en,(/w,a/en,)/w, ,#, ,这里/r,保存/v,了/u,前/f,l/en,-/w,1层/mq,的/u,a/en,值/n, ,36/m, ,z/en, ,=/w, ,w/en,[/w,j/en,]/w, ,*/w, ,a/en, ,37/m, ,a/en, ,=/w, ,sigmoid/en,(/w,z/en,)/w, ,38/m, ,h/en,_,total/en,[/w,i/en,,/w, ,0/m,]/w, ,=/w, ,a/en, ,39/m, ,#, ,back/en, ,propagate/en, ,40/m, ,d