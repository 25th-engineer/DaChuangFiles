机器/n,学习/v,简易/a,入门/v,（/w,二/m,）/w, ,-/w, ,分类/vn,摘要/n,：/w,本文/r,简单/a,叙述/v,了/u,如何/r,通过/p,分类/vn,算法/n,来/v,评估/vn,银行/n,发放/v,贷款/n,的/u,模型/n,声明/n,：/w,（/w,本文/r,的/u,内容/n,非/h,原创/b,，/w,但/c,经过/p,本人/r,翻译/v,和/c,总结/v,而/c,来/v,，/w,转载/v,请/v,注明/v,出处/n,）/w,本文/r,内容/n,来源/n,：/w,https/en,:/w,//w,//w,www/en,./w,dataquest/en,./w,io/en,//w,mission/en,//w,57/m,//w,classification/en,-/w,basics/en,在/p,你/r,向/p,银行/n,申请/v,信用卡/n,或者/c,贷款/n,时/ng,，/w,银行/n,会/v,使用/v,根据/p,过往/vn,的/u,数据/n,所/u,建立/v,的/u,模型/n,，/w,再/d,根据/p,你/r,的/u,实际/n,情况/n,来/v,决定/v,是否/v,接受/v,你/r,的/u,申请/v,。/w,原始/a,数据/n,展现/v,银行/n,在/p,以往/t,的/u,某/r,段/q,时间/n,为了/p,训练/vn,这个/r,评分/vn,模型/n,，/w,向/p,所有/b,申请者/n,都/d,发放/v,了/u,贷款/n,，/w,然后/c,记录/v,全部/m,人/n,是否/v,有/v,还款/v,以及/c,他们/r,的/u,评分/vn,情况/n,，/w,paid/en,字/n,段/q,表明/v,该/r,申请人/n,是否/v,有/v,如实/v,还款/v,，/w,1/m,是/v,正常/a,还款/v,，/w,0/m,是/v,违约/v,。/w,model/en,_,score/en,字/n,段/q,表明/v,该/r,申请人/n,在/p,获得/v,贷款/n,前/f,在/p,评分/vn,模型/n,中/f,的/u,得分/n,import/en, ,pandas/en, ,credit/en, ,=/w, ,pandas/en,./w,read/en,_,csv/en,(/w,"/w,credit/en,./w,csv/en,"/w,)/w,评估/vn,模型/n,根据/p,上面/f,的/u,历史/n,数据/n,，/w,找到/v,适合/v,的/u,阀值/nz,（/w,model/en,_,score/en,究竟/d,为/p,多少/r,分/q,时/ng,才/d,接受/v,贷款/n,申请/v,）/w,，/w,然后/c,获取/v,最/d,大/a,的/u,利润/n,准确率/n,我们/r,通过/p,设置/v,一个/m,model/en,_,score/en,的/u,阀值/nz,来/v,决定/v,是否/v,接受/v,贷款/n,申请/v,，/w,如果/c,该/r,申请者/n,的/u,model/en,_,score/en,大于/v,该/r,阀值/nz,就/d,接受/v,，/w,反之亦然/l,，/w,通过/p,控制/v,这个/r,阀值/nz,来/v,控制/v,新/a,客户量/nw,。/w,衡量/v,一个/m,模型/n,的/u,准确性/n,是/v,通过/p,公示/n,：/w,准确率/n, ,=/w, ,正确/a,预测/v,数/m, ,//w, ,样本/n,总量/n,#, ,设置/v,阀值/nz,为/p,0.5/m,，/w,计算/v,这个/r,模型/n,的/u,准确率/n,（/w,评分/vn,大于/v,0.5/m,，/w,且/c,如实/v,还款/v,）/w, ,pred/en, ,=/w, ,credit/en,[/w,"/w,model/en,_,score/en,"/w,]/w, ,>, ,0.5/m, ,accuracy/en, ,=/w, ,sum/en,(/w,pred/en, ,=/w,=/w, ,credit/en,[/w,"/w,paid/en,"/w,]/w,)/w, ,//w, ,len/en,(/w,pred/en,)/w, ,#, ,paid/en,字/n,段/q,为/p,1/m,，/w,且/c,model/en,_,score/en,大于/v,0.5/m,这个/r,结果/n,表明/v,如果/c,只/d,向/p,model/en,_,score/en,大于/v,0.5/m,的/u,申请者/n,发放/v,贷款/n,，/w,大概/d,会/v,有/v,86%/mq,的/u,人/n,还款/v,混淆矩阵/nw,下/f,表/n,描述/v,二元/mq,分类/vn,问题/n,的/u,混淆矩阵/nw,，/w,表/n,中/f,每个/r,表项/nw,fij/en,表示/v,实际/n,类/q,标号/n,为/p,i/en,但/c,被/p,预测/v,为/p,类/q,j/en,的/u,记录数/nw,，/w,例如/v,，/w,f/en,01/m,代表/n,原本/d,属于/v,类/q,0/m,但/c,被/p,误/v,分为/v,类/q,1/m,的/u,记录数/nw,，/w,按照/p,混淆矩阵/nw,中/f,的/u,表项/nw,，/w,被/p,分类/vn,模型/n,正确/a,预测/v,的/u,样本/n,总数/n,是/v,（/w,f/en,11/m, ,+/w, ,f/en,00/m,）/w,，/w,而/c,被/p,错误/n,预测/v,的/u,样本/n,总数/n,是/v,（/w,f/en,10/m, ,+/w, ,f/en,01/m,）/w,预测/v,的/u,类/q,类/q,=/w, ,1类/mq,=/w, ,0/m,实际/n,的/u,类/q,类/q,=/w, ,1/m,f/en,11/m,f/en,10类/mq,=/w, ,0/m,f/en,01/m,f/en,00/m,在/p,本文/r,中/f,的/u,混淆矩阵/nw,是/v,这样/r,的/u,实际上/d,会/v,还款/v,实际上/d,不会/v,还款/v,预测会/nw,还款/v,tpfp/en,预测/v,不/d,会/v,还款/v,fntn/en,真正/d,（/w,true/en, ,positive/en, ,,/w, ,tp/en,）/w,被/p,模型/n,预测/v,为/p,正/d,的/u,正/d,样本/n,；/w,假负/nw,（/w,false/en, ,negative/en, ,,/w, ,fn/en,）/w,被/p,模型/n,预测/v,为/p,负/v,的/u,正/d,样本/n,；/w,假正/nw,（/w,false/en, ,positive/en, ,,/w, ,fp/en,）/w,被/p,模型/n,预测/v,为/p,正/d,的/u,负/v,样本/n,；/w,真负/nw,（/w,true/en, ,negative/en, ,,/w, ,tn/en,）/w,被/p,模型/n,预测/v,为/p,负/v,的/u,负/v,样本/n,真正/d,率/v,（/w,true/en, ,positive/en, ,rate/en, ,,/w, ,tpr/en,）/w,或/c,灵敏度/n,（/w,sensitivity/en,）/w,：/w,tpr/en, ,=/w, ,tp/en, ,//w,（/w,tp/en, ,+/w, ,fn/en,）/w, ,（/w,正/d,样本/n,预测/v,结果/n,数/m, ,//w, ,正/d,样本/n,实际/n,数/m,）/w,假负率/nw,（/w,false/en, ,negative/en, ,rate/en, ,,/w, ,fnr/en,）/w,：/w,fnr/en, ,=/w, ,fn/en, ,//w,（/w,tp/en, ,+/w, ,fn/en,）/w, ,（/w,被/p,预测/v,为/p,负/v,的/u,正/d,样本/n,结果/n,数/m, ,//w, ,正/d,样本/n,实际/n,数/m, ,）/w,假正率/nw,（/w,false/en, ,positive/en, ,rate/en, ,,/w, ,fpr/en,）/w,：/w,fpr/en, ,=/w, ,fp/en, ,//w,（/w,fp/en, ,+/w, ,tn/en,）/w, ,（/w,被/p,预测/v,为/p,正/d,的/u,负/v,样本/n,结果/n,数/m, ,//w,负/v,样本/n,实际/n,数/m,）/w,真负率/nw,（/w,true/en, ,negative/en, ,rate/en, ,,/w, ,tnr/en,）/w,或/c,特/d,指度/nw,（/w,specificity/en,）/w,：/w,tnr/en, ,=/w, ,tn/en, ,//w,（/w,tn/en, ,+/w, ,fp/en,）/w, ,（/w,负/v,样本/n,预测/v,结果/n,数/m, ,//w, ,负/v,样本/n,实际/n,数/m,）/w,#, ,把/p,阀值/nz,设置/v,为/p,0.5/m,，/w,分别/d,计算/v,上面/f,的/u,混淆矩阵/nw, ,tp/en, ,=/w, ,sum/en,(/w,(/w,(/w,credit/en,[/w,'/w,model/en,_,score/en,'/w,]/w, ,>, ,0.5/m,)/w, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,credit/en,[/w,'/w,paid/en,'/w,]/w, ,=/w,=/w, ,1/m,)/w,)/w, ,fn/en, ,=/w, ,sum/en,(/w,(/w,(/w,credit/en,[/w,'/w,model/en,_,score/en,'/w,]/w, ,</w,=/w, ,0.5/m,)/w, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,credit/en,[/w,'/w,paid/en,'/w,]/w, ,=/w,=/w, ,1/m,)/w,)/w, ,fp/en, ,=/w, ,sum/en,(/w,(/w,(/w,credit/en,[/w,'/w,model/en,_,score/en,'/w,]/w, ,>, ,0.5/m,)/w, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,credit/en,[/w,'/w,paid/en,'/w,]/w, ,=/w,=/w, ,0/m,)/w,)/w, ,tn/en, ,=/w, ,sum/en,(/w,(/w,(/w,credit/en,[/w,'/w,model/en,_,score/en,'/w,]/w, ,</w,=/w, ,0.5/m,)/w, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,credit/en,[/w,'/w,paid/en,'/w,]/w, ,=/w,=/w, ,0/m,)/w,)/w,只要/c,我们/r,的/u,模型/n,中/f,真正/d,率/v,（/w,tpr/en,）/w,大于/v,假正率/nw,（/w,fpr/en,）/w,，/w,就/d,能/v,保证/v,还款/v,的/u,人/n,要/v,比/p,违约/v,的/u,人/n,多/a,，/w,从而/c,保证/v,银行/n,不/d,会/v,亏本/v,计算/v,roc/en,曲线/n,roc/en,曲线/n,（/w,receiver/en, ,operating/en, ,characteristic/en, ,curve/en,）/w,，/w,又/d,称为/v,感受性/nw,曲线/n,（/w,sensitivity/en, ,curve/en,）/w,。/w,得/u,此名/nw,的/u,原因/n,在于/v,曲线/n,上/f,各/r,点/q,反映/v,着/u,相同/a,的/u,感受性/nw,，/w,它们/r,都/d,是/v,对/p,同一/b,信号/n,刺激/v,的/u,反应/vn,，/w,只不过/d,是/v,在/p,几/m,种/q,不同/a,的/u,判定/v,标准/n,下/f,所得/n,的/u,结果/n,而已/y,。/w,接受/v,者/k,操作/v,特性/n,曲线/n,就/d,是/v,以/p,虚惊概率/nw,为/p,横轴/nw,，/w,击中/v,概率/n,为/p,纵轴/n,所/u,组成/v,的/u,坐标图/nw,，/w,和/c,被/p,试/v,在/p,特定/b,刺激/v,条件/n,下/f,由于/c,采用/v,不同/a,的/u,判断/v,标准/n,得出/v,的/u,不同/a,结果/n,画/v,出/v,的/u,曲线/n,根据/p,上文/n,所/u,述/vg,，/w,现在/t,要/v,寻找/v,一个/m,阀值/nz,，/w,使得/v,真正/d,率/v,大于/v,假正率/nw,import/en, ,numpy/en, ,def/en, ,roc/en,_,curve/en,(/w,observed/en,,/w, ,probs/en,)/w,:/w, ,#, ,将/d,阀值/nz,由/p,1/m,到/v,0/m,，/w,分成/v,100个/m,小/a,数/m, ,thresholds/en, ,=/w, ,numpy/en,./w,asarray/en,(/w,[/w,(/w,100/m,-/w,j/en,)/w,//w,100/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,100/m,)/w,]/w,)/w, ,#, ,初始化/v,为/p,全/a,0/m, ,fprs/en, ,=/w, ,numpy/en,./w,asarray/en,(/w,[/w,0/m,./w, ,for/en, ,j/en, ,in/en, ,range/en,(/w,100/m,)/w,]/w,)/w, ,tprs/en, ,=/w, ,numpy/en,./w,asarray/en,(/w,[/w,0/m,./w, ,for/en, ,j/en, ,in/en, ,range/en,(/w,100/m,)/w,]/w,)/w, ,#, ,对/p,每个/r,阀值/nz,进行/v,循环/vn, ,for/en, ,j/en,,/w, ,thres/en, ,in/en, ,enumerate/en,(/w,thresholds/en,)/w,:/w, ,pred/en, ,=/w, ,probs/en, ,>, ,thres/en, ,fp/en, ,=/w, ,sum/en,(/w,(/w,observed/en, ,=/w,=/w, ,0/m,)/w, ,&/w, ,(/w,pred/en, ,=/w,=/w, ,1/m,)/w,)/w, ,tn/en, ,=/w, ,sum/en,(/w,(/w,observed/en, ,=/w,=/w, ,0/m,)/w, ,&/w, ,(/w,pred/en, ,=/w,=/w, ,0/m,)/w,)/w, ,fpr/en, ,=/w, ,float/en,(/w,fp/en, ,//w, ,(/w,fp/en, ,+/w, ,tn/en,)/w,)/w, ,tp/en, ,=/w, ,sum/en,(/w,(/w,observed/en, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,pred/en, ,=/w,=/w, ,1/m,)/w,)/w, ,fn/en, ,=/w, ,sum/en,(/w,(/w,observed/en, ,=/w,=/w, ,1/m,)/w, ,&/w, ,(/w,pred/en, ,=/w,=/w, ,0/m,)/w,)/w, ,tpr/en, ,=/w, ,float/en,(/w,tp/en, ,//w, ,(/w,tp/en, ,+/w, ,fn/en,)/w,)/w, ,fprs/en,[/w,j/en,]/w, ,=/w, ,fpr/en, ,tprs/en,[/w,j/en,]/w, ,=/w, ,tpr/en, ,return/en, ,fprs/en,,/w, ,tprs/en,,/w, ,thresholds/en, ,fpr/en,,/w, ,tpr/en,,/w, ,thres/en, ,=/w, ,roc/en,_,curve/en,(/w,credit/en,[/w,"/w,paid/en,"/w,]/w,,/w, ,credit/en,[/w,"/w,model/en,_,score/en,"/w,]/w,)/w, ,idx/en, ,=/w, ,numpy/en,./w,where/en,(/w,fpr/en,>,0.20/m,)/w,[/w,0/m,]/w,[/w,0/m,]/w, ,#, ,选择/v,假正率/nw,为/p,0.2/m,的/u,阀值/nz,，/w,理由/n,在/p,下面/f, ,print/en,(/w,'/w,fpr/en,:/w, ,0.2/m,'/w,)/w, ,print/en,(/w,'/w,tpr/en,:/w, ,{/w,}/w,'/w,./w,format/en,(/w,tpr/en,[/w,idx/en,]/w,)/w,)/w, ,print/en,(/w,'/w,threashold/en,:/w, ,{/w,}/w,'/w,./w,format/en,(/w,thres/en,[/w,idx/en,]/w,)/w,)/w, ,#, ,以假正率/nw,做/v,x/en,轴/q,，/w,真正/d,率/v,做/v,y/en,轴/q,作/v,图/n, ,plt/en,./w,plot/en,(/w,fpr/en,,/w, ,tpr/en,)/w, ,plt/en,./w,xlabel/en,(/w,'/w,fpr/en,'/w,)/w, ,plt/en,./w,ylabel/en,(/w,'/w,tpr/en,'/w,)/w, ,plt/en,./w,show/en,(/w,)/w,说明/v,了/u,当/p,阀值/nz,设置/v,为/p,0.38时/t,，/w,fpr/en, ,=/w, ,0.2/m,，/w,tpr/en, ,=/w, ,0.93/m,在/p,上图/n,中/f,可见/v,，/w,当/p,fpr/en,（/w,假正率/nw,）/w,达到/v,了/u,0.2/m,之后/f,，/w,整条/nw,曲线/n,都/d,变/v,平/v,了/u,，/w,也就是说/l,当/p,fpr/en,大于/v,0.2/m,之后/f,，/w,违约/v,的/u,人数/n,增加/v,了/u,，/w,不/d,违约/v,的/u,人数/n,却/d,没有/v,增加/v,多少/r,。/w,计算/v,auc/en,如果/c,用/p,两个/m,模型/n,分别/d,作出/v,了/u,不同/a,的/u,roc/en,曲线/n,，/w,那么/r,要/v,怎样/r,对比/v,这/r,两条/mq,roc/en,曲线/n,的/u,优异/a,程度/n,呢/y,？/w,可以/v,使用/v,auc/en,，/w,auc/en,通过/p,测量/vn,roc/en,曲线/n,下面/f,的/u,面积/n,来/v,获得/v,。/w,如果/c,一个/m,模型/n,是/v,完美/a,的/u,，/w,那么/r,他/r,的/u,tpr/en,就/d,会/v,是/v,1/m,，/w,所以/c,auc/en,也/d,是/v,1/m,，/w,而/c,如果/c,一个/m,模型/n,的/u,tpr/en,是/