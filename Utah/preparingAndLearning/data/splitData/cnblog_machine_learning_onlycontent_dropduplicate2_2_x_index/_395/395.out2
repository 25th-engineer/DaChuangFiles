原文/n,来自/v,csdn/en,，/w,公众/n,号/q,id/en,：/w,csdnnews/en,，/w,对/p,其/r,结构/n,略/d,作/v,改动/v,。/w,1/m,./w, ,写/v,在/p,前面/f,2018/m, ,年/q, ,fifa/en, ,世界杯/n,即将/d,拉开/v,帷幕/n,，/w,全世界/n,的/u,球迷/n,都/d,热切/ad,地/u,想/v,要/v,知道/v,：/w,谁/r,将/d,获得/v,那/r,梦寐以求/i,的/u,大力神杯/nw,？/w,如果/c,你/r,不仅/c,是/v,个/q,足球迷/n,，/w,而且/c,也/d,是/v,高/a,科技/n,人员/n,的话/u,，/w,我/r,猜/v,你/r,肯定/v,知道/v,机器/n,学习/v,和/c,人工智能/n,也/d,是/v,目前/t,的/u,流行词/nw,。/w,让/v,我们/r,结合/v,两者/r,来/v,预测/v,一下/m,本届/r,俄罗斯/ns, ,fifa/en, ,世界杯/n,哪个/r,国家/n,将/d,夺冠/v,。/w,作者/n,：/w,gerald/en, ,muriuki/en,，/w,经济/n,、/w,数据/n,科学/n,专家/n,译者/n,：/w,弯月/nw,，/w,责编/n,：/w,郭芮点击/nr,此处/s,获取/v,完整/a,的/u,代码/n,：/w,https/en,:/w,//w,//w,github/en,./w,com/en,//w,itsmuriuki/en,//w,fifa/en,-/w,2018/m,-/w,world/en,-/w,cup/en,-/w,predictions/en,2/m,./w, ,译文/n,足球/n,比赛/vn,涉及/v,的/u,因素/n,非常/d,繁多/a,，/w,我/r,无法/v,将/d,所有/b,因素/n,都/d,融入/v,机器/n,学习/v,模型/n,中/f,。/w,本文/r,只是/d,一个/m,黑客/n,想/v,用/p,数据/n,尝试/vn,一些/m,很/d,酷/d,的/u,东西/n,。/w,本文/r,的/u,目标/n,是/v,：/w,用/p,机器/n,学习/v,来/v,预测/v,谁/r,将/d,赢得/v,2018/m, ,fifa/en,世界杯/n,的/u,冠军/n,；/w,预测/v,整个/b,比赛/vn,的/u,小组赛/nw,结果/n,；/w,模拟/b,四分之一/nw,决赛/vn,、/w,半决赛/n,以及/c,决赛/vn,。/w,这些/r,目标/n,代表/n,了/u,独一无二/i,的/u,现实/n,世界/n,里/f,机器/n,学习/v,的/u,预测/v,问题/n,，/w,并/c,将/d,解决/v,机器/n,学习/v,中/f,的/u,各种/r,任务/n,：/w,数据/n,集成/vn,、/w,特征/n,建模/vn,和/c,结果/n,预测/v,。/w,2.1/m, ,数据/n,：/w,我/r,采用/v,了/u,两个/m,来自/v, ,kaggle/en, ,的/u,数据集/nw,，/w,我们/r,将/d,使用/v,自/p, ,1930/m, ,年/q,第一/m,届/q,世界杯/n,以来/f,所有/b,参赛队/n,的/u,历史/n,赛事/n,结果/n,。/w,fifa/en, ,排名/v,是/v,于/p, ,90/m, ,年代/n,创建/v,的/u,，/w,因此/c,这里/r,缺失/n,很/d,大/a,一部分/m,数据/n,，/w,所以/c,我们/r,使用/v,历史/n,比赛/vn,记录/v,。/w,点击/v,以下/f,链接/n,获取/v,所有/b,数据/n, ,：/w,https/en,:/w,//w,//w,www/en,./w,kaggle/en,./w,com/en,//w,martj/en,42/m,//w,international/en,-/w,football/en,-/w,results/en,-/w,from/en,-/w,1872/m,-/w,to/en,-/w,2017/m,//w,data/en,；/w,本文/r,中/f,主要/b,使用/v,的/u,环境/n,和/c,工具/n,有/v,：/w,jupyter/en, ,notebook/en,、/w,numpy/en,、/w,pandas/en,、/w,seaborn/en,、/w,matplotlib/en, ,和/c, ,scikit/en,-/w,learn/en,。/w,首先/d,，/w,我们/r,要/v,针对/p,两个/m,数据集/nw,做/v,探索性/n,分析/vn,，/w,然后/c,经过/p,特征/n,工程/n,来/v,选择/v,与/p,预测/v,关联性/nw,最强/ad,的/u,特征/n,，/w,还有/v,数据/n,处理/v,，/w,再/d,选择/v,一个/m,机器/n,学习/v,模型/n,，/w,最后/f,将/d,模型/n,配置/vn,到/v,数据集/nw,上/f,。/w,2.2/m, ,让/v,我们/r,开始/v,动手/v,吧/y,：/w,首先/d,，/w,导入/v,所/u,需/v,的/u,代码库/nw,，/w,并/c,将/d,数据集/nw,加载/v,到/v,数据框/nw,中/f,：/w,1/m, ,import/en, ,pandas/en, ,as/en, ,pd/en, ,2/m, ,import/en, ,numpy/en, ,as/en, ,np/en, ,3/m, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,4/m, ,import/en, ,seaborn/en, ,as/en, ,sns/en, ,5/m, ,import/en, ,matplotlib/en,./w,ticker/en, ,as/en, ,ticker/en, ,6/m, ,import/en, ,matplotlib/en,./w,ticker/en, ,as/en, ,plticker/en, ,7/m, ,from/en, ,sklearn/en,./w,model/en,_,selection/en, ,import/en, ,train/en,_,test/en,_,split/en, ,8/m, ,from/en, ,sklearn/en,./w,linear/en,_,model/en, ,import/en, ,logisticregression/en,导入/v,数据集/nw,：/w,1/m, ,#,load/en, ,data/en, ,2/m, ,world/en,_,cup/en, ,=/w, ,pd/en,./w,read/en,_,csv/en,(/w,'/w,c/en,:/w,\/w,coding/en,\/w,fifa/en,2018/m,-/w,world/en,-/w,cup/en,\/w,datasets/en,\/w,world/en, ,cup/en, ,2018/m, ,dataset/en,./w,csv/en,'/w,)/w, ,3/m, ,results/en, ,=/w, ,pd/en,./w,read/en,_,csv/en,(/w,'/w,c/en,:/w,//w,coding/en,//w,fifa/en,2018/m,-/w,world/en,-/w,cup/en,//w,datasets/en,//w,results/en,./w,csv/en,'/w,)/w,下/f,一步/mq,是/v,加载/v,数据集/nw,。/w,通过/p,调用/v, ,world/en,_,cup/en,./w,head/en,(/w,)/w, ,和/c, ,results/en,./w,head/en,(/w,)/w, ,，/w,务必/d,将/d,两个/m,数据集/nw,都/d,加/v,载/v,到/v,数据框/nw,中/f,，/w,如下/v,所/u,示/vg,：/w,2.3/m, ,探索性/n,分析/vn,：/w,在/p,分析/vn,了/u,两组/mq,数据集/nw,后/f,，/w,所得/n,的/u,数据集/nw,包含/v,了/u,以往/t,赛事/n,的/u,数据/n,——/w,这个/r,新/a,的/u,（/w,所得/n,的/u,）/w,数据集/nw,对于/p,分析/vn,和/c,预测/v,将来/t,的/u,赛事/n,非常/d,有/v,帮助/v,。/w,探索性/n,分析/vn,和/c,特征/n,工程/n,：/w,需要/v,建立/v,与/p,机器/n,学习/v,模型/n,相关/v,的/u,特征/n,，/w,在/p,任何/r,数据/n,科学/n,的/u,项目/n,中/f,，/w,这/r,部分/n,工作/vn,都/d,是/v,最/d,耗/v,时/ng,的/u,。/w,现在/t,我们/r,把/p,目标/n,差异/n,和/c,结果/n,列/v,添加/vn,到/v,结果/n,数据集/nw,：/w,1/m, ,#,adding/en, ,goal/en, ,difference/en, ,and/en, ,establishing/en, ,who/en, ,is/en, ,the/en, ,winner/en, ,2/m, ,winner/en, ,=/w, ,[/w,]/w, ,3/m, ,for/en, ,i/en, ,in/en, ,range/en, ,(/w,len/en,(/w,results/en,[/w,'/w,home/en,_,team/en,'/w,]/w,)/w,)/w,:/w, ,4/m, ,if/en, ,results/en, ,[/w,'/w,home/en,_,score/en,'/w,]/w,[/w,i/en,]/w, ,>, ,results/en,[/w,'/w,away/en,_,score/en,'/w,]/w,[/w,i/en,]/w,:/w, ,5/m, ,winner/en,./w,append/en,(/w,results/en,[/w,'/w,home/en,_,team/en,'/w,]/w,[/w,i/en,]/w,)/w, ,6/m, ,elif/en, ,results/en,[/w,'/w,home/en,_,score/en,'/w,]/w,[/w,i/en,]/w, ,</w, ,results/en, ,[/w,'/w,away/en,_,score/en,'/w,]/w,[/w,i/en,]/w,:/w, ,7/m, ,winner/en,./w,append/en,(/w,results/en,[/w,'/w,away/en,_,team/en,'/w,]/w,[/w,i/en,]/w,)/w, ,8/m, ,else/en,:/w, ,9/m, ,winner/en,./w,append/en,(/w,'/w,draw/en,'/w,)/w, ,10/m, ,results/en,[/w,'/w,winning/en,_,team/en,'/w,]/w, ,=/w, ,winner/en, ,11/m, ,12/m, ,#,adding/en, ,goal/en, ,difference/en, ,column/en, ,13/m, ,results/en,[/w,'/w,goal/en,_,difference/en,'/w,]/w, ,=/w, ,np/en,./w,absolute/en,(/w,results/en,[/w,'/w,home/en,_,score/en,'/w,]/w, ,-/w, ,results/en,[/w,'/w,away/en,_,score/en,'/w,]/w,)/w, ,14/m, ,15/m, ,results/en,./w,head/en,(/w,)/w,检查/vn,一下/m,新/a,的/u,结果/n,数据框/nw,：/w,然后/c,我们/r,着手/v,处理/v,仅/d,包含/v,尼日利亚/ns,参加/v,比赛/vn,的/u,一组/mq,数据/n,（/w,这/r,可以/v,帮助/v,我们/r,集中/v,找/v,出/v,哪些/r,特征/n,对/p,一个/m,国家/n,有效/a,，/w,随后/d,再/d,扩展/v,到/v,参与/v,世界杯/n,的/u,所有/b,国家/n,）/w,：/w,1/m, ,#,lets/en, ,work/en, ,with/en, ,a/en, ,subset/en, ,of/en, ,the/en, ,data/en, ,one/en, ,that/en, ,includes/en, ,games/en, ,played/en, ,by/en, ,nigeria/en, ,in/en, ,a/en, ,nigeria/en, ,dataframe/en, ,2/m, ,df/en, ,=/w, ,results/en,[/w,(/w,results/en,[/w,'/w,home/en,_,team/en,'/w,]/w, ,=/w,=/w, ,'/w,nigeria/en,'/w,)/w, ,|/w, ,(/w,results/en,[/w,'/w,away/en,_,team/en,'/w,]/w, ,=/w,=/w, ,'/w,nigeria/en,'/w,)/w,]/w, ,3/m, ,nigeria/en, ,=/w, ,df/en,./w,iloc/en,[/w,:/w,]/w, ,4/m, ,nigeria/en,./w,head/en,(/w,)/w,第一/m,届/q,世界杯/n,于/p, ,1930/m, ,年/q,举行/v,。/w,我们/r,为/p,年份/n,创建/v,一列/mq,，/w,并/c,选择/v,所有/b, ,1930/m, ,年/q,之后/f,举行/v,的/u,比赛/vn,：/w,1/m, ,#,creating/en, ,a/en, ,column/en, ,for/en, ,year/en, ,and/en, ,the/en, ,first/en, ,world/en, ,cup/en, ,was/en, ,held/en, ,in/en, ,1930/m, ,2/m, ,year/en, ,=/w, ,[/w,]/w, ,3/m, ,for/en, ,row/en, ,in/en, ,nigeria/en,[/w,'/w,date/en,'/w,]/w,:/w, ,4/m, ,year/en,./w,append/en,(/w,int/en,(/w,row/en,[/w,:/w,4/m,]/w,)/w,)/w, ,5/m, ,nigeria/en, ,[/w,'/w,match/en,_,year/en,'/w,]/w,=/w, ,year/en, ,6/m, ,nigeria/en,_,1930/m, ,=/w, ,nigeria/en,[/w,nigeria/en,./w,match/en,_,year/en, ,>,=/w, ,1930/m,]/w, ,7/m, ,nigeria/en,_,1930/m,./w,count/en,(/w,)/w,现在/t,我们/r,可以/v,用/p,图形/n,表示/v,这些/r,年/q,来/v,尼日利亚队/nt,最/d,普遍/ad,的/u,比赛/vn,结果/n,：/w,#,what/en, ,is/en, ,the/en, ,common/en, ,game/en, ,outcome/en, ,for/en, ,nigeria/en, ,visualisation/en, ,wins/en, ,=/w, ,[/w,]/w, ,for/en, ,row/en, ,in/en, ,nigeria/en,_,1930/m,[/w,'/w,winning/en,_,team/en,'/w,]/w,:/w, ,if/en, ,row/en, ,!/w,=/w, ,'/w,nigeria/en,'/w, ,and/en, ,row/en, ,!/w,=/w, ,'/w,draw/en,'/w,:/w, ,wins/en,./w,append/en,(/w,'/w,loss/en,'/w,)/w, ,else/en,:/w, ,wins/en,./w,append/en,(/w,row/en,)/w, ,winsdf/en,=/w, ,pd/en,./w,dataframe/en,(/w,wins/en,,/w, ,columns/en,=/w,[/w, ,'/w,nigeria/en,_,results/en,'/w,]/w,)/w, ,#,plotting/en, ,fig/en,,/w, ,ax/en, ,=/w, ,plt/en,./w,subplots/en,(/w,1/m,)/w, ,fig/en,./w,set/en,_,size/en,_,inches/en,(/w,10.7/m,,/w, ,6.27/m,)/w, ,sns/en,./w,set/en,(/w,style/en,=/w,'/w,darkgrid/en,'/w,)/w, ,sns/en,./w,countplot/en,(/w,x/en,=/w,'/w,nigeria/en,_,results/en,'/w,,/w, ,data/en,=/w,winsdf/en,)/w,每个/r,参加/v,世界杯/n,的/u,国家/n,的/u,胜率/nz,是/v,非常/d,有/v,帮助性/nw,的/u,指标/n,，/w,我们/r,可以/v,用/p,它/r,来/v,预测/v,此次/r,比赛/vn,最/d,可能/v,的/u,结果/n,。/w,2.4/m, ,锁定/v,参加/v,世界杯/n,的/u,队伍/n,：/w,我们/r,为/p,2018/m,世界杯/n,所有/b,参赛/v,队伍/n,创建/v,一个/m,数据框/nw,，/w,然后/c,从/p,该/r,数据框/nw,中/f,进一步/d,筛选/v,出/v,从/p, ,1930/m, ,年/q,起/v,参加/v,世界杯/n,的/u,队伍/n,，/w,并/c,去掉/v,重复/v,的/u,队伍/n,：/w,1/m, ,#,narrowing/en, ,to/en, ,team/en, ,patcipating/en, ,in/en, ,the/en, ,world/en, ,cup/en, ,2/m, ,worldcup/en,_,teams/en, ,=/w, ,[/w,'/w,australia/en,'/w,,/w, ,'/w, ,iran/en,'/w,,/w, ,'/w,japan/en,'/w,,/w, ,'/w,korea/en, ,republic/en,'/w,,/w, ,3/m, ,'/w,saudi/en, ,arabia/en,'/w,,/w, ,'/w,egypt/en,'/w,,/w, ,'/w,morocco/en,'/w,,/w, ,'/w,nigeria/en,'/w,,/w, ,4/m, ,'/w,senegal/en,'/w,,/w, ,'/w,tunisia/en,'/w,,/w, ,'/w,costa/en, ,rica/en,'/w,,/w, ,'/w,mexico/en,'/w,,/w, ,5/m, ,'/w,panama/en,'/w,,/w, ,'/w,argentina/en,'/w,,/w, ,'/w,brazil/en,'/w,,/w, ,'/w,colombia/en,'/w,,/w, ,6/m, ,'/w,peru/en,'/w,,/w, ,'/w,uruguay/en,'/w,,/w, ,'/w,belgium/en,'/w,,/w, ,'/w,croatia/en,'/w,,/w, ,7/m, ,'/w,denmark/en,'/w,,/w, ,'/w,england/en,'/w,,/w, ,'/w,france/en,'/w,,/w, ,'/w,germany/en,'/w,,/w, ,8/m, ,'/w,iceland/en,'/w,,/w, ,'/w,poland/en,'/w,,/w, ,'/w,portugal/en,'/w,,/w, ,'/w,russia/en,'/w,,/w, ,9/m, ,'/w,serbia/en,'/w,,/w, ,'/w,spain/en,'/w,,/w, ,'/w,sweden/en,'/w,,/w, ,'/w,switzerland/en,'/w,]/w, ,10/m, ,df/en,_,teams/en,_,home/en, ,=/w, ,results/en,[/w,results/en,[/w,'/w,home/en,_,team/en,'/w,]/w,./w,isin/en,(/w,worldcup/en,_,teams/en,)/w,]/w, ,11/m, ,df/en,_,teams/en,_,away/en, ,=/w, ,results/en,[/w,results/en,[/w,'/w,away/en,_,team/en,'/w,]/w,./w,isin/en,(/w,worldcup/en,_,teams/en,)/w,]/w, ,12/m, ,df/en,_,teams/en, ,=/w, ,pd/en,./w,concat/en,(/w,(/w,df/en,_,teams/en,_,home/en,,/w, ,df/en,_,teams/en,_,away/en,)/w,)/w, ,13/m, ,df/en,_,teams/en,./w,drop/en,_,duplicates/en,(/w,)/w, ,14/m, ,df/en,_,teams/en,./w,count/en,(/w,)/w,为/p,年份/n,创建/v,一列/mq,，/w,去掉/v, ,1930/m, ,年/q,之前/f,的/u,比赛/vn,，/w,并/c,去掉/v,不/d,会/v,影响/vn,到/v,比赛/vn,结果/n,的/u,数据列/nw,，/w,比如/v, ,date/en,（/w,日期/n,）/w,、/w,home/en,_,score/en,（/w,主场/n,得分/n,）/w,、/w,away/en,_,score/en,（/w,客场/n,得分/n,）/w,、/w,tournament/en,（/w,锦标赛/n,）/w,、/w,city/en,（/w,城市/n,）/w,、/w,country/en,（/w,国家/n,）/w,、/w,goal/en,_,difference/en,（/w,目标/n,差异/n,）/w,和/c, ,match/en,_,year/en,（/w,比赛/vn,年份/n,）/w,：/w,#,create/en, ,an/en, ,year/en, ,column/en, ,to/en, ,drop/en, ,games/en, ,before/en, ,1930/m, ,year/en, ,=/w, ,[/w,]/w, ,for/en, ,row/en, ,in/en, ,df/en,_,teams/en,[/w,'/w,date/en,'/w,]/w,:/w, ,year/en,./w,append/en,(/w,int/en,(/w,row/en,[/w,:/w,4/m,]/w,)/w,)/w, ,df/en,_,teams/en,[/w,'/w,match/en,_,year/en,'/w,]/w, ,=/w, ,year/en, ,df/en,_,teams/en,_,1930/m, ,=/w, ,df/en,_,teams/en,[/w,df/en,_,teams/en,./w,match/en,_,year/en, ,>,=/w, ,1930/m,]/w, ,df/en,_,teams/en,_,1930/m,./w,head/en,(/w,)/w, ,#,dropping/en, ,columns/en, ,that/en, ,wll/en, ,not/en, ,affect/en, ,matchoutcomes/en, ,df/en,_,teams/en,_,1930/m, ,=/w, ,df/en,_,teams/en,./w,drop/en,(/w,[/w,'/w,date/en,'/w,,/w, ,'/w,home/en,_,score/en,'/w,,/w, ,'/w,away/en,_,score/en,'/w,,/w, ,'/w,tournament/en,'/w,,/w, ,'/w,city/en,'/w,,/w, ,'/w,country/en,'/w,,/w, ,'/w,goal/en,_,difference/en,'/w,,/w, ,'/w,match/en,_,year/en,'/w,]/w,,/w, ,axis/en,=/w,1/m,)/w, ,df/en,_,teams/en,_,1930/m,./w,head/en,(/w,)/w,为了/p,简化/v,模型/n,的/u,处理/v,，/w,我们/r,修改/v,一下/m,预测/v,标签/n,。/w,如果/c,主场/n,队伍/n,获胜/v,，/w,那么/r, ,winning/en,_,team/en,（/w,获胜/v,队伍/n,）/w,一列/mq,显示/v,“/w,2/m,”/w,，/w,如果/c,平局/n,则/d,显示/v,“/w,1/m,”/w,，/w,如果/c,是/v,客场/n,队伍/n,获胜/v,则/d,显示/v,“/w,0/m,”/w,：/w,1/m, ,#,building/en, ,the/en, ,model/en, ,2/m, ,#,the/en, ,prediction/en, ,label/en,:/w, ,the/en, ,winning/en,_,team/en, ,column/en, ,will/en, ,show/en, ,"/w,2/m,"/w, ,if/en, ,the/en, ,home/en, ,team/en, ,has/en, ,won/en,,/w, ,"/w,1/m,"/w, ,if/en, ,it/en, ,was/en, ,a/en, ,tie/en,,/w, ,and/en, ,"/w,0/m,"/w, ,if/en, ,the/en, ,away/en, ,team/en, ,has/en, ,won/en,./w, ,3/m, ,4/m, ,df/en,_,teams/en,_,1930/m, ,=/w, ,df/en,_,teams/en,_,1930/m,./w,reset/en,_,index/en,(/w,drop/en,=/w,true/en,)/w, ,5/m, ,df/en,_,teams/en,_,1930/m,./w,loc/en,[/w,df/en,_,teams/en,_,1930/m,./w,winning/en,_,team/en, ,=/w,=/w, ,df/en,_,teams/en,_,1930/m,./w,home/en,_,team/en,,/w,'/w,winning/en,_,team/en,'/w,]/w,=/w,2/m, ,6/m, ,df/en,_,teams/en,_,1930/m,./w,loc/en,[/w,df/en,_,teams/en,_,1930/m,./w,winning/en,_,team/en, ,=/w,=/w, ,'/w,draw/en,'/w,,/w, ,'/w,winning/en,_,team/en,'/w,]/w,=/w,1/m, ,7/m, ,df/en,_,teams/en,_,1930/m,./w,loc/en,[/w,df/en,_,teams/en,_,1930/m,./w,winning/en,_,team/en, ,=/w,=/w, ,df/en,_,teams/en,_,1930/m,./w,away/en,_,team/en,,/w, ,'/w,winning/en,_,team/en,'/w,]/w,=/w,0/m, ,8/m, ,9/m, ,df/en,_,teams/en,_,1930/m,./w,head/en,(/w,)/w,通过/p,设置/v,哑变量/nw,（/w,dummy/en, ,variables/en,）/w,，/w,我们/r,将/d, ,home/en,_,team/en,（/w,主场/n,队伍/n,）/w,和/c,away/en, ,_,team/en,（/w,客场/n,队伍/n,）/w,从/p,分类/vn,变量/n,转换/v,成/v,连续/a,的/u,输入/v,。/w,这时/r,可以/v,使用/v, ,pandas/en, ,的/u, ,get/en,_,dummies/en,(/w,)/w, ,函数/n,，/w,它/r,会/v,将/d,分类/vn,列/v,替换/v,成/v,一位/mq,有效值/n,（/w,one/en,-/w,hot/en,，/w,由/p,数字/n,‘/w,1/m,’/w,和/c,‘/w,0/m,’/w,组成/v,）/w,，/w,以便/d,将/d,它们/r,加载/v,到/v, ,scikit/en,-/w,learn/en, ,模型/n,中/f,。/w,接下来/l,，/w,我们/r,将/d,数据/n,按照/p, ,70%/mq, ,的/u,训练/vn,数据集/nw,和/c, ,30%/mq, ,的/u,测试/vn,数据集/nw,分成/v, ,x/en, ,集/vg,和/c, ,y/en, ,集/vg,：/w,1/m, ,#,convert/en, ,home/en, ,team/en, ,and/en, ,away/en, ,team/en, ,from/en, ,categorical/en, ,variables/en, ,to/en, ,continous/en, ,inputs/en, ,2/m, ,#, ,get/en, ,dummy/en, ,variables/en, ,3/m, ,final/en, ,=/w, ,pd/en,./w,get/en,_,dummies/en,(/w,df/en,_,teams/en,_,1930/m,,/w, ,prefix/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,,/w, ,columns/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,)/w, ,4/m, ,5/m, ,#, ,separate/en, ,x/en, ,and/en, ,y/en, ,sets/en, ,6/m, ,x/en, ,=/w, ,final/en,./w,drop/en,(/w,[/w,'/w,winning/en,_,team/en,'/w,]/w,,/w, ,axis/en,=/w,1/m,)/w, ,7/m, ,y/en, ,=/w, ,final/en,[/w,"/w,winning/en,_,team/en,"/w,]/w, ,8/m, ,y/en, ,=/w, ,y/en,./w,astype/en,(/w,'/w,int/en,'/w,)/w, ,9/m, ,10/m, ,#, ,separate/en, ,train/en, ,and/en, ,test/en, ,sets/en, ,11/m, ,x/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,train/en,,/w, ,y/en,_,test/en, ,=/w, ,train/en,_,test/en,_,split/en,(/w,x/en,,/w, ,y/en,,/w, ,test/en,_,size/en,=/w,0.30/m,,/w, ,random/en,_,state/en,=/w,42/m,)/w,这里/r,我们/r,将/d,使用/v,分类/vn,算法/n,：/w,逻辑/n,回归/v,。/w,这个/r,算法/n,的/u,工作/vn,原理/n,是/v,什么/r,？/w,该/r,算法/n,利用/v,逻辑/n,函数/n,来/v,预测/v,概率/n,，/w,从而/c,可以/v,测量/vn,出/v,分类/vn,因/p,变量/n,与/p,一个/m,或/c,多/a,个/q,自/p,变量/n,之间/f,的/u,关系/n,。/w,具体来说/nw,就是/d,累积/vn,的/u,逻辑/n,分布/v,。/w,换句话说/c,，/w,逻辑/n,回归/v,可以/v,针对/p,一组/mq,可以/v,影响/vn,到/v,结果/n,的/u,既定/b,数据集/nw,（/w,统计值/nw,）/w,尝试/vn,预测/v,结果/n,（/w,赢/v,或/c,输/v,）/w,。/w,在/p,实践/v,中/f,这种/r,方法/n,的/u,工作/vn,原理/n,是/v,：/w,使用/v,上述/b,的/u,两套/mq,“/w,数据集/nw,”/w,和/c,比赛/vn,的/u,实际/n,结果/n,，/w,一次/mq,输入/v,一场/mq,比赛/vn,到/v,算法/n,中/f,。/w,然后/c,模型/n,就/d,会/v,学习/v,输入/v,的/u,每/r,条/q,数据/n,对/p,比赛/vn,结果/n,产生/v,了/u,积极/ad,的/u,效果/n,还是/c,消极/a,的/u,效果/n,，/w,以及/c,影响/vn,的/u,程度/n,。/w,经过/p,充分/ad,的/u,（/w,好/a,）/w,数据/n,的/u,训练/vn,后/f,，/w,就/d,可以/v,得到/v,能够/v,预测/v,未来/t,结果/n,的/u,模型/n,，/w,而/c,模型/n,的/u,好坏/n,程度/n,取决于/v,输入/v,的/u,数据/n,。/w,之后/f,我们/r,将/d,这些/r,数据/n,传递/v,到/v,算法/n,中/f,：/w,logreg/en, ,=/w, ,logisticregression/en,(/w,)/w, ,logreg/en,./w,fit/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,score/en, ,=/w, ,logreg/en,./w,score/en,(/w,x/en,_,train/en,,/w, ,y/en,_,train/en,)/w, ,score/en,2/m, ,=/w, ,logreg/en,./w,score/en,(/w,x/en,_,test/en,,/w, ,y/en,_,test/en,)/w, ,print/en,(/w,"/w,training/en, ,set/en, ,accuracy/en,:/w, ,"/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,score/en,)/w,)/w, ,print/en,(/w,"/w,test/en, ,set/en, ,accuracy/en,:/w, ,"/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,score/en,2/m,)/w,)/w,training/en, ,set/en, ,accuracy/en,:/w, ,0.573/m, ,test/en, ,set/en, ,accuracy/en,:/w, ,0.551/m,我们/r,的/u,模型子/nw,训练/vn,数据集/nw,的/u,正确率/n,为/p, ,57%/mq,，/w,在/p,测试/vn,数据集/nw,上/f,的/u,正确率/n,为/p, ,55%/mq,。/w,虽然/c,结果/n,不/d,是/v,很/d,好/a,，/w,但是/c,我们/r,先/d,继续/v,下/f,一步/mq,。/w,接下来/l,我们/r,建立/v,需要/v,配置/vn,到/v,模型/n,的/u,数据框/nw,。/w,首先/d,我们/r,加/v,载/v, ,2018/m, ,年/q, ,4/m, ,月/q, ,fifa/en, ,排名/v,数据/n,和/c,小组赛/nw,分组/vn,状况/n,的/u,数据集/nw,。/w,由于/c,世界杯/n,比赛/vn,中/f,没有/v,“/w,主场/n,”/w,和/c,“/w,客场/n,”/w,，/w,所以/c,我们/r,把/p, ,fifa/en, ,排名/v,靠/v,前/f,的/u,队伍/n,作为/v,“/w,喜爱/v,”/w,的/u,比赛/vn,队伍/n,，/w,将/d,他们/r,放/v,到/v,“/w,home/en,_,teams/en,”/w,（/w,主场/n,队伍/n,）/w,一列/mq,。/w,然后/c,我们/r,根据/p,每个/r,队伍/n,的/u,排名/v,将/d,他们/r,加入/v,到/v,新/a,的/u,预测/v,数据/n,集中/v,。/w,下/f,一步/mq,是/v,创建/v,默认/v,变量/n,，/w,并/c,部署/v,机器/n,学习/v,模型/n,。/w,2018/m, ,年/q, ,4/m, ,月/q, ,fifa/en, ,排名/v,数据/n,：/w,https/en,:/w,//w,//w,us/en,./w,soccerway/en,./w,com/en,//w,teams/en,//w,rankings/en,//w,fifa/en,//w,?/w,icid/en,=/w,tn/en,_,03/m,_,05/m,_,01/m,小组赛/nw,分组/vn,状况/n,的/u,数据集/nw,：/w,https/en,:/w,//w,//w,fixturedownload/en,./w,com/en,//w,results/en,//w,fifa/en,-/w,world/en,-/w,cup/en,-/w,2018/m,#,adding/en, ,fifa/en, ,rankings/en, ,#,the/en, ,team/en, ,which/en, ,is/en, ,positioned/en, ,higher/en, ,on/en, ,the/en, ,fifa/en, ,ranking/en, ,will/en, ,be/en, ,considered/en, ,"/w,favourite/en,"/w, ,for/en, ,the/en, ,match/en, ,#,and/en, ,therefore/en,,/w, ,will/en, ,be/en, ,positioned/en, ,under/en, ,the/en, ,"/w,home/en,_,teams/en,"/w, ,column/en, ,#,since/en, ,there/en, ,are/en, ,no/en, ,"/w,home/en,"/w, ,or/en, ,"/w,away/en,"/w, ,teams/en, ,in/en, ,world/en, ,cup/en, ,games/en,./w, ,#, ,loading/en, ,new/en, ,datasets/en, ,ranking/en, ,=/w, ,pd/en,./w,read/en,_,csv/en,(/w,'/w,c/en,:/w,//w,coding/en,//w,fifa/en,2018/m,-/w,world/en,-/w,cup/en,//w,datasets/en,//w,fifa/en,_,rankings/en,./w,csv/en,'/w,)/w, ,fixtures/en, ,=/w, ,pd/en,./w,read/en,_,csv/en,(/w,'/w,c/en,:/w,//w,coding/en,//w,fifa/en,2018/m,-/w,world/en,-/w,cup/en,//w,datasets/en,//w,fixtures/en,./w,csv/en,'/w,)/w, ,#, ,list/en, ,for/en, ,storing/en, ,the/en, ,group/en, ,stage/en, ,games/en, ,pred/en,_,set/en, ,=/w, ,[/w,]/w, ,#, ,create/en, ,new/en, ,columns/en, ,with/en, ,ranking/en, ,position/en, ,of/en, ,each/en, ,team/en, ,fixtures/en,./w,insert/en,(/w,1/m,,/w, ,'/w,first/en,_,position/en,'/w,,/w, ,fixtures/en,[/w,'/w,home/en, ,team/en,'/w,]/w,./w,map/en,(/w,ranking/en,./w,set/en,_,index/en,(/w,'/w,team/en,'/w,)/w,[/w,'/w,position/en,'/w,]/w,)/w,)/w, ,fixtures/en,./w,insert/en,(/w,2/m,,/w, ,'/w,second/en,_,position/en,'/w,,/w, ,fixtures/en,[/w,'/w,away/en, ,team/en,'/w,]/w,./w,map/en,(/w,ranking/en,./w,set/en,_,index/en,(/w,'/w,team/en,'/w,)/w,[/w,'/w,position/en,'/w,]/w,)/w,)/w, ,#, ,we/en, ,only/en, ,need/en, ,the/en, ,group/en, ,stage/en, ,games/en,,/w, ,so/en, ,we/en, ,have/en, ,to/en, ,slice/en, ,the/en, ,dataset/en, ,fixtures/en, ,=/w, ,fixtures/en,./w,iloc/en,[/w,:/w,48/m,,/w, ,:/w,]/w, ,#, ,loop/en, ,to/en, ,add/en, ,teams/en, ,to/en, ,new/en, ,prediction/en, ,dataset/en, ,based/en, ,on/en, ,the/en, ,ranking/en, ,position/en, ,of/en, ,each/en, ,team/en, ,for/en, ,index/en,,/w, ,row/en, ,in/en, ,fixtures/en,./w,iterrows/en,(/w,)/w,:/w, ,if/en, ,row/en,[/w,'/w,first/en,_,position/en,'/w,]/w, ,</w, ,row/en,[/w,'/w,second/en,_,position/en,'/w,]/w,:/w, ,pred/en,_,set/en,./w,append/en,(/w,{/w,'/w,home/en,_,team/en,'/w,:/w, ,row/en,[/w,'/w,home/en, ,team/en,'/w,]/w,,/w, ,'/w,away/en,_,team/en,'/w,:/w, ,row/en,[/w,'/w,away/en, ,team/en,'/w,]/w,,/w, ,'/w,winning/en,_,team/en,'/w,:/w, ,none/en,}/w,)/w, ,else/en,:/w, ,pred/en,_,set/en,./w,append/en,(/w,{/w,'/w,home/en,_,team/en,'/w,:/w, ,row/en,[/w,'/w,away/en, ,team/en,'/w,]/w,,/w, ,'/w,away/en,_,team/en,'/w,:/w, ,row/en,[/w,'/w,home/en, ,team/en,'/w,]/w,,/w, ,'/w,winning/en,_,team/en,'/w,:/w, ,none/en,}/w,)/w, ,pred/en,_,set/en, ,=/w, ,pd/en,./w,dataframe/en,(/w,pred/en,_,set/en,)/w, ,backup/en,_,pred/en,_,set/en, ,=/w, ,pred/en,_,set/en, ,#, ,get/en, ,dummy/en, ,variables/en, ,and/en, ,drop/en, ,winning/en,_,team/en, ,column/en, ,pred/en,_,set/en, ,=/w, ,pd/en,./w,get/en,_,dummies/en,(/w,pred/en,_,set/en,,/w, ,prefix/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,,/w, ,columns/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,)/w, ,#, ,add/en, ,missing/en, ,columns/en, ,compared/en, ,to/en, ,the/en, ,model/en,'/w,s/en, ,training/en, ,dataset/en, ,missing/en,_,cols/en, ,=/w, ,set/en,(/w,final/en,./w,columns/en,)/w, ,-/w, ,set/en,(/w,pred/en,_,set/en,./w,columns/en,)/w, ,for/en, ,c/en, ,in/en, ,missing/en,_,cols/en,:/w, ,pred/en,_,set/en,[/w,c/en,]/w, ,=/w, ,0/m, ,pred/en,_,set/en, ,=/w, ,pred/en,_,set/en,[/w,final/en,./w,columns/en,]/w, ,#, ,remove/en, ,winning/en, ,team/en, ,column/en, ,pred/en,_,set/en, ,=/w, ,pred/en,_,set/en,./w,drop/en,(/w,[/w,'/w,winning/en,_,team/en,'/w,]/w,,/w, ,axis/en,=/w,1/m,)/w, ,pred/en,_,set/en,./w,head/en,(/w,)/w,2.5/m, ,比赛/vn,结果/n,预测/v,：/w,首先/d,，/w,我们/r,将/d,模型/n,部署/v,到/v,小组赛/nw,中/f,：/w,#,group/en, ,matches/en, ,predictions/en, ,=/w, ,logreg/en,./w,predict/en,(/w,pred/en,_,set/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,fixtures/en,./w,shape/en,[/w,0/m,]/w,)/w,:/w, ,print/en,(/w,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w, ,+/w, ,"/w, ,and/en, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w,)/w, ,if/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,2/m,:/w, ,print/en,(/w,"/w,winner/en,:/w, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w,)/w, ,elif/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w, ,print/en,(/w,"/w,draw/en,"/w,)/w, ,elif/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,0/m,:/w, ,print/en,(/w,"/w,winner/en,:/w, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w,)/w, ,print/en,(/w,'/w,probability/en, ,of/en, ,'/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w, ,+/w, ,'/w, ,winning/en,:/w, ,'/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,2/m,]/w,)/w,)/w, ,print/en,(/w,'/w,probability/en, ,of/en, ,draw/en,:/w, ,'/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,1/m,]/w,)/w,)/w, ,print/en,(/w,'/w,probability/en, ,of/en, ,'/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w, ,+/w, ,'/w, ,winning/en,:/w, ,'/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,0/m,]/w,)/w,)/w, ,print/en,(/w,"/w,"/w,)/w,russia/en, ,and/en, ,saudi/en, ,arabia/en, ,winner/en,:/w, ,russia/en, ,probability/en, ,of/en, ,russia/en, ,winning/en,:/w, ,0.667/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.223/m, ,probability/en, ,of/en, ,saudi/en, ,arabia/en, ,winning/en,:/w, ,0.111/m, ,uruguay/en, ,and/en, ,egypt/en, ,winner/en,:/w, ,uruguay/en, ,probability/en, ,of/en, ,uruguay/en, ,winning/en,:/w, ,0.583/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.352/m, ,probability/en, ,of/en, ,egypt/en, ,winning/en,:/w, ,0.065/m, ,iran/en, ,and/en, ,morocco/en, ,draw/en, ,probability/en, ,of/en, ,iran/en, ,winning/en,:/w, ,0.217/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.407/m, ,probability/en, ,of/en, ,morocco/en, ,winning/en,:/w, ,0.376/m, ,portugal/en, ,and/en, ,spain/en, ,winner/en,:/w, ,spain/en, ,probability/en, ,of/en, ,portugal/en, ,winning/en,:/w, ,0.302/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.344/m, ,probability/en, ,of/en, ,spain/en, ,winning/en,:/w, ,0.354/m, ,france/en, ,and/en, ,australia/en, ,winner/en,:/w, ,france/en, ,probability/en, ,of/en, ,france/en, ,winning/en,:/w, ,0.628/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.227/m, ,probability/en, ,of/en, ,australia/en, ,winning/en,:/w, ,0.145/m, ,argentina/en, ,and/en, ,iceland/en, ,winner/en,:/w, ,argentina/en, ,probability/en, ,of/en, ,argentina/en, ,winning/en,:/w, ,0.803/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.161/m, ,probability/en, ,of/en, ,iceland/en, ,winning/en,:/w, ,0.036/m, ,peru/en, ,and/en, ,denmark/en, ,winner/en,:/w, ,peru/en, ,probability/en, ,of/en, ,peru/en, ,winning/en,:/w, ,0.439/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.171/m, ,probability/en, ,of/en, ,denmark/en, ,winning/en,:/w, ,0.391/m, ,croatia/en, ,and/en, ,nigeria/en, ,winner/en,:/w, ,croatia/en, ,probability/en, ,of/en, ,croatia/en, ,winning/en,:/w, ,0.590/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.258/m, ,probability/en, ,of/en, ,nigeria/en, ,winning/en,:/w, ,0.152/m, ,costa/en, ,rica/en, ,and/en, ,serbia/en, ,winner/en,:/w, ,serbia/en, ,probability/en, ,of/en, ,costa/en, ,rica/en, ,winning/en,:/w, ,0.315/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.324/m, ,probability/en, ,of/en, ,serbia/en, ,winning/en,:/w, ,0.361/m, ,germany/en, ,and/en, ,mexico/en, ,winner/en,:/w, ,germany/en, ,probability/en, ,of/en, ,germany/en, ,winning/en,:/w, ,0.567/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.282/m, ,probability/en, ,of/en, ,mexico/en, ,winning/en,:/w, ,0.150/m, ,brazil/en, ,and/en, ,switzerland/en, ,winner/en,:/w, ,brazil/en, ,probability/en, ,of/en, ,brazil/en, ,winning/en,:/w, ,0.775/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.138/m, ,probability/en, ,of/en, ,switzerland/en, ,winning/en,:/w, ,0.087/m, ,sweden/en, ,and/en, ,korea/en, ,republic/en, ,winner/en,:/w, ,sweden/en, ,probability/en, ,of/en, ,sweden/en, ,winning/en,:/w, ,0.503/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.329/m, ,probability/en, ,of/en, ,korea/en, ,republic/en, ,winning/en,:/w, ,0.168/m, ,belgium/en, ,and/en, ,panama/en, ,winner/en,:/w, ,belgium/en, ,probability/en, ,of/en, ,belgium/en, ,winning/en,:/w, ,0.765/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.145/m, ,probability/en, ,of/en, ,panama/en, ,winning/en,:/w, ,0.090/m, ,england/en, ,and/en, ,tunisia/en, ,winner/en,:/w, ,england/en, ,probability/en, ,of/en, ,england/en, ,winning/en,:/w, ,0.649/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.292/m, ,probability/en, ,of/en, ,tunisia/en, ,winning/en,:/w, ,0.059/m, ,colombia/en, ,and/en, ,japan/en, ,winner/en,:/w, ,colombia/en, ,probability/en, ,of/en, ,colombia/en, ,winning/en,:/w, ,0.511/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.210/m, ,probability/en, ,of/en, ,japan/en, ,winning/en,:/w, ,0.280/m, ,poland/en, ,and/en, ,senegal/en, ,winner/en,:/w, ,poland/en, ,probability/en, ,of/en, ,poland/en, ,winning/en,:/w, ,0.612/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.223/m, ,probability/en, ,of/en, ,senegal/en, ,winning/en,:/w, ,0.165/m, ,egypt/en, ,and/en, ,russia/en, ,winner/en,:/w, ,russia/en, ,probability/en, ,of/en, ,egypt/en, ,winning/en,:/w, ,0.225/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.297/m, ,probability/en, ,of/en, ,russia/en, ,winning/en,:/w, ,0.478/m, ,portugal/en, ,and/en, ,morocco/en, ,winner/en,:/w, ,portugal/en, ,probability/en, ,of/en, ,portugal/en, ,winning/en,:/w, ,0.486/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.377/m, ,probability/en, ,of/en, ,morocco/en, ,winning/en,:/w, ,0.138/m, ,uruguay/en, ,and/en, ,saudi/en, ,arabia/en, ,winner/en,:/w, ,uruguay/en, ,probability/en, ,of/en, ,uruguay/en, ,winning/en,:/w, ,0.668/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.259/m, ,probability/en, ,of/en, ,saudi/en, ,arabia/en, ,winning/en,:/w, ,0.073/m, ,spain/en, ,and/en, ,iran/en, ,winner/en,:/w, ,spain/en, ,probability/en, ,of/en, ,spain/en, ,winning/en,:/w, ,0.695/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.247/m, ,probability/en, ,of/en, ,iran/en, ,winning/en,:/w, ,0.058/m, ,denmark/en, ,and/en, ,australia/en, ,winner/en,:/w, ,denmark/en, ,probability/en, ,of/en, ,denmark/en, ,winning/en,:/w, ,0.551/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.241/m, ,probability/en, ,of/en, ,australia/en, ,winning/en,:/w, ,0.207/m, ,france/en, ,and/en, ,peru/en, ,winner/en,:/w, ,france/en, ,probability/en, ,of/en, ,france/en, ,winning/en,:/w, ,0.635/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.215/m, ,probability/en, ,of/en, ,peru/en, ,winning/en,:/w, ,0.150/m, ,argentina/en, ,and/en, ,croatia/en, ,winner/en,:/w, ,argentina/en, ,probability/en, ,of/en, ,argentina/en, ,winning/en,:/w, ,0.599/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.255/m, ,probability/en, ,of/en, ,croatia/en, ,winning/en,:/w, ,0.146/m, ,brazil/en, ,and/en, ,costa/en, ,rica/en, ,winner/en,:/w, ,brazil/en, ,probability/en, ,of/en, ,brazil/en, ,winning/en,:/w, ,0.800/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.147/m, ,probability/en, ,of/en, ,costa/en, ,rica/en, ,winning/en,:/w, ,0.053/m, ,iceland/en, ,and/en, ,nigeria/en, ,winner/en,:/w, ,nigeria/en, ,probability/en, ,of/en, ,iceland/en, ,winning/en,:/w, ,0.278/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.248/m, ,probability/en, ,of/en, ,nigeria/en, ,winning/en,:/w, ,0.474/m, ,switzerland/en, ,and/en, ,serbia/en, ,winner/en,:/w, ,switzerland/en, ,probability/en, ,of/en, ,switzerland/en, ,winning/en,:/w, ,0.402/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.228/m, ,probability/en, ,of/en, ,serbia/en, ,winning/en,:/w, ,0.370/m, ,belgium/en, ,and/en, ,tunisia/en, ,winner/en,:/w, ,belgium/en, ,probability/en, ,of/en, ,belgium/en, ,winning/en,:/w, ,0.619/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.253/m, ,probability/en, ,of/en, ,tunisia/en, ,winning/en,:/w, ,0.128/m, ,mexico/en, ,and/en, ,korea/en, ,republic/en, ,winner/en,:/w, ,mexico/en, ,probability/en, ,of/en, ,mexico/en, ,winning/en,:/w, ,0.504/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.327/m, ,probability/en, ,of/en, ,korea/en, ,republic/en, ,winning/en,:/w, ,0.169/m, ,germany/en, ,and/en, ,sweden/en, ,winner/en,:/w, ,germany/en, ,probability/en, ,of/en, ,germany/en, ,winning/en,:/w, ,0.571/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.228/m, ,probability/en, ,of/en, ,sweden/en, ,winning/en,:/w, ,0.201/m, ,england/en, ,and/en, ,panama/en, ,winner/en,:/w, ,england/en, ,probability/en, ,of/en, ,england/en, ,winning/en,:/w, ,0.781/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.178/m, ,probability/en, ,of/en, ,panama/en, ,winning/en,:/w, ,0.041/m, ,senegal/en, ,and/en, ,japan/en, ,winner/en,:/w, ,senegal/en, ,probability/en, ,of/en, ,senegal/en, ,winning/en,:/w, ,0.397/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.278/m, ,probability/en, ,of/en, ,japan/en, ,winning/en,:/w, ,0.325/m, ,poland/en, ,and/en, ,colombia/en, ,draw/en, ,probability/en, ,of/en, ,poland/en, ,winning/en,:/w, ,0.379/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.391/m, ,probability/en, ,of/en, ,colombia/en, ,winning/en,:/w, ,0.230/m, ,uruguay/en, ,and/en, ,russia/en, ,winner/en,:/w, ,uruguay/en, ,probability/en, ,of/en, ,uruguay/en, ,winning/en,:/w, ,0.403/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.388/m, ,probability/en, ,of/en, ,russia/en, ,winning/en,:/w, ,0.209/m, ,egypt/en, ,and/en, ,saudi/en, ,arabia/en, ,winner/en,:/w, ,egypt/en, ,probability/en, ,of/en, ,egypt/en, ,winning/en,:/w, ,0.544/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.216/m, ,probability/en, ,of/en, ,saudi/en, ,arabia/en, ,winning/en,:/w, ,0.240/m, ,portugal/en, ,and/en, ,iran/en, ,winner/en,:/w, ,portugal/en, ,probability/en, ,of/en, ,portugal/en, ,winning/en,:/w, ,0.548/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.353/m, ,probability/en, ,of/en, ,iran/en, ,winning/en,:/w, ,0.099/m, ,spain/en, ,and/en, ,morocco/en, ,winner/en,:/w, ,spain/en, ,probability/en, ,of/en, ,spain/en, ,winning/en,:/w, ,0.650/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.267/m, ,probability/en, ,of/en, ,morocco/en, ,winning/en,:/w, ,0.083/m, ,france/en, ,and/en, ,denmark/en, ,winner/en,:/w, ,france/en, ,probability/en, ,of/en, ,france/en, ,winning/en,:/w, ,0.621/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.159/m, ,probability/en, ,of/en, ,denmark/en, ,winning/en,:/w, ,0.220/m, ,peru/en, ,and/en, ,australia/en, ,winner/en,:/w, ,peru/en, ,probability/en, ,of/en, ,peru/en, ,winning/en,:/w, ,0.463/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.250/m, ,probability/en, ,of/en, ,australia/en, ,winning/en,:/w, ,0.288/m, ,argentina/en, ,and/en, ,nigeria/en, ,winner/en,:/w, ,argentina/en, ,probability/en, ,of/en, ,argentina/en, ,winning/en,:/w, ,0.708/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.222/m, ,probability/en, ,of/en, ,nigeria/en, ,winning/en,:/w, ,0.070/m, ,croatia/en, ,and/en, ,iceland/en, ,winner/en,:/w, ,croatia/en, ,probability/en, ,of/en, ,croatia/en, ,winning/en,:/w, ,0.734/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.185/m, ,probability/en, ,of/en, ,iceland/en, ,winning/en,:/w, ,0.080/m, ,mexico/en, ,and/en, ,sweden/en, ,winner/en,:/w, ,mexico/en, ,probability/en, ,of/en, ,mexico/en, ,winning/en,:/w, ,0.465/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.264/m, ,probability/en, ,of/en, ,sweden/en, ,winning/en,:/w, ,0.271/m, ,germany/en, ,and/en, ,korea/en, ,republic/en, ,winner/en,:/w, ,germany/en, ,probability/en, ,of/en, ,germany/en, ,winning/en,:/w, ,0.598/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.282/m, ,probability/en, ,of/en, ,korea/en, ,republic/en, ,winning/en,:/w, ,0.120/m, ,brazil/en, ,and/en, ,serbia/en, ,winner/en,:/w, ,brazil/en, ,probability/en, ,of/en, ,brazil/en, ,winning/en,:/w, ,0.714/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.165/m, ,probability/en, ,of/en, ,serbia/en, ,winning/en,:/w, ,0.120/m, ,switzerland/en, ,and/en, ,costa/en, ,rica/en, ,winner/en,:/w, ,switzerland/en, ,probability/en, ,of/en, ,switzerland/en, ,winning/en,:/w, ,0.587/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.213/m, ,probability/en, ,of/en, ,costa/en, ,rica/en, ,winning/en,:/w, ,0.200/m, ,poland/en, ,and/en, ,japan/en, ,winner/en,:/w, ,poland/en, ,probability/en, ,of/en, ,poland/en, ,winning/en,:/w, ,0.551/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.242/m, ,probability/en, ,of/en, ,japan/en, ,winning/en,:/w, ,0.206/m, ,colombia/en, ,and/en, ,senegal/en, ,winner/en,:/w, ,colombia/en, ,probability/en, ,of/en, ,colombia/en, ,winning/en,:/w, ,0.577/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.194/m, ,probability/en, ,of/en, ,senegal/en, ,winning/en,:/w, ,0.229/m, ,tunisia/en, ,and/en, ,panama/en, ,winner/en,:/w, ,tunisia/en, ,probability/en, ,of/en, ,tunisia/en, ,winning/en,:/w, ,0.631/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.257/m, ,probability/en, ,of/en, ,panama/en, ,winning/en,:/w, ,0.113/m, ,belgium/en, ,and/en, ,england/en, ,winner/en,:/w, ,england/en, ,probability/en, ,of/en, ,belgium/en, ,winning/en,:/w, ,0.273/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.235/m, ,probability/en, ,of/en, ,england/en, ,winning/en,:/w, ,0.492/m,之后/f,进行/v,16/m,强/a,的/u,模拟/b,：/w,#, ,list/en, ,of/en, ,tuples/en, ,before/en, ,group/en,_,16/m, ,=/w, ,[/w,(/w,'/w,uruguay/en,'/w,,/w, ,'/w,portugal/en,'/w,)/w,,/w, ,(/w,'/w,france/en,'/w,,/w, ,'/w,croatia/en,'/w,)/w,,/w, ,(/w,'/w,brazil/en,'/w,,/w, ,'/w,mexico/en,'/w,)/w,,/w, ,(/w,'/w,england/en,'/w,,/w, ,'/w,colombia/en,'/w,)/w,,/w, ,(/w,'/w,spain/en,'/w,,/w, ,'/w,russia/en,'/w,)/w,,/w, ,(/w,'/w,argentina/en,'/w,,/w, ,'/w,peru/en,'/w,)/w,,/w, ,(/w,'/w,germany/en,'/w,,/w, ,'/w,switzerland/en,'/w,)/w,,/w, ,(/w,'/w,poland/en,'/w,,/w, ,'/w,belgium/en,'/w,)/w,]/w,def/en, ,clean/en,_,and/en,_,predict/en,(/w,matches/en,,/w, ,ranking/en,,/w, ,final/en,,/w, ,logreg/en,)/w,:/w,#, ,initialization/en, ,of/en, ,auxiliary/en, ,list/en, ,for/en, ,data/en, ,cleaningpositions/en, ,=/w, ,[/w,]/w,#, ,loop/en, ,to/en, ,retrieve/en, ,each/en, ,team/en,'/w,s/en, ,position/en, ,according/en, ,to/en, ,fifa/en, ,rankingfor/en, ,match/en, ,in/en, ,matches/en,:/w,positions/en,./w,append/en,(/w,ranking/en,./w,loc/en,[/w,ranking/en,[/w,'/w,team/en,'/w,]/w, ,=/w,=/w, ,match/en,[/w,0/m,]/w,,/w,'/w,position/en,'/w,]/w,./w,iloc/en,[/w,0/m,]/w,)/w,positions/en,./w,append/en,(/w,ranking/en,./w,loc/en,[/w,ranking/en,[/w,'/w,team/en,'/w,]/w, ,=/w,=/w, ,match/en,[/w,1/m,]/w,,/w,'/w,position/en,'/w,]/w,./w,iloc/en,[/w,0/m,]/w,)/w,#, ,creating/en, ,the/en, ,dataframe/en, ,for/en, ,predictionpred/en,_,set/en, ,=/w, ,[/w,]/w,#, ,initializing/en, ,iterators/en, ,for/en, ,while/en, ,loopi/en, ,=/w, ,0/m,j/en, ,=/w, ,0/m,#, ,'/w,i/en,'/w, ,will/en, ,be/en, ,the/en, ,iterator/en, ,for/en, ,the/en, ,'/w,positions/en,'/w, ,list/en,,/w, ,and/en, ,'/w,j/en,'/w, ,for/en, ,the/en, ,list/en, ,of/en, ,matches/en, ,(/w,list/en, ,of/en, ,tuples/en,)/w,while/en, ,i/en, ,</w, ,len/en,(/w,positions/en,)/w,:/w,dict/en,1/m, ,=/w, ,{/w,}/w,#, ,if/en, ,position/en, ,of/en, ,first/en, ,team/en, ,is/en, ,better/en,,/w, ,he/en, ,will/en, ,be/en, ,the/en, ,'/w,home/en,'/w, ,team/en,,/w, ,and/en, ,vice/en,-/w,versaif/en, ,positions/en,[/w,i/en,]/w, ,</w, ,positions/en,[/w,i/en, ,+/w, ,1/m,]/w,:/w,dict/en,1/m,./w,update/en,(/w,{/w,'/w,home/en,_,team/en,'/w,:/w, ,matches/en,[/w,j/en,]/w,[/w,0/m,]/w,,/w, ,'/w,away/en,_,team/en,'/w,:/w, ,matches/en,[/w,j/en,]/w,[/w,1/m,]/w,}/w,)/w,else/en,:/w,dict/en,1/m,./w,update/en,(/w,{/w,'/w,home/en,_,team/en,'/w,:/w, ,matches/en,[/w,j/en,]/w,[/w,1/m,]/w,,/w, ,'/w,away/en,_,team/en,'/w,:/w, ,matches/en,[/w,j/en,]/w,[/w,0/m,]/w,}/w,)/w,#, ,append/en, ,updated/en, ,dictionary/en, ,to/en, ,the/en, ,list/en,,/w, ,that/en, ,will/en, ,later/en, ,be/en, ,converted/en, ,into/en, ,a/en, ,dataframepred/en,_,set/en,./w,append/en,(/w,dict/en,1/m,)/w,i/en, ,+/w,=/w, ,2/m,j/en, ,+/w,=/w, ,1/m,#, ,convert/en, ,list/en, ,into/en, ,dataframepred/en,_,set/en, ,=/w, ,pd/en,./w,dataframe/en,(/w,pred/en,_,set/en,)/w,backup/en,_,pred/en,_,set/en, ,=/w, ,pred/en,_,set/en,#, ,get/en, ,dummy/en, ,variables/en, ,and/en, ,drop/en, ,winning/en,_,team/en, ,columnpred/en,_,set/en, ,=/w, ,pd/en,./w,get/en,_,dummies/en,(/w,pred/en,_,set/en,,/w, ,prefix/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,,/w, ,columns/en,=/w,[/w,'/w,home/en,_,team/en,'/w,,/w, ,'/w,away/en,_,team/en,'/w,]/w,)/w,#, ,add/en, ,missing/en, ,columns/en, ,compared/en, ,to/en, ,the/en, ,model/en,'/w,s/en, ,training/en, ,datasetmissing/en,_,cols/en,2/m, ,=/w, ,set/en,(/w,final/en,./w,columns/en,)/w, ,-/w, ,set/en,(/w,pred/en,_,set/en,./w,columns/en,)/w,for/en, ,c/en, ,in/en, ,missing/en,_,cols/en,2/m,:/w,pred/en,_,set/en,[/w,c/en,]/w, ,=/w, ,0/m,pred/en,_,set/en, ,=/w, ,pred/en,_,set/en,[/w,final/en,./w,columns/en,]/w,#, ,remove/en, ,winning/en, ,team/en, ,columnpred/en,_,set/en, ,=/w, ,pred/en,_,set/en,./w,drop/en,(/w,[/w,'/w,winning/en,_,team/en,'/w,]/w,,/w, ,axis/en,=/w,1/m,)/w,#, ,predict/en,!/w,predictions/en, ,=/w, ,logreg/en,./w,predict/en,(/w,pred/en,_,set/en,)/w,for/en, ,i/en, ,in/en, ,range/en,(/w,len/en,(/w,pred/en,_,set/en,)/w,)/w,:/w,print/en,(/w,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w, ,+/w, ,"/w, ,and/en, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w,)/w,if/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,2/m,:/w,print/en,(/w,"/w,winner/en,:/w, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w,)/w,elif/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w,print/en,(/w,"/w,draw/en,"/w,)/w,elif/en, ,predictions/en,[/w,i/en,]/w, ,=/w,=/w, ,0/m,:/w,print/en,(/w,"/w,winner/en,:/w, ,"/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w,)/w,print/en,(/w,'/w,probability/en, ,of/en, ,'/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,1/m,]/w, ,+/w, ,'/w, ,winning/en,:/w, ,'/w, ,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,2/m,]/w,)/w,)/w,print/en,(/w,'/w,probability/en, ,of/en, ,draw/en,:/w, ,'/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,1/m,]/w,)/w,)/w,print/en,(/w,'/w,probability/en, ,of/en, ,'/w, ,+/w, ,backup/en,_,pred/en,_,set/en,./w,iloc/en,[/w,i/en,,/w, ,0/m,]/w, ,+/w, ,'/w, ,winning/en,:/w, ,'/w,,/w, ,'/w,%/w,./w,3/m,f/en,'/w,%/w,(/w,logreg/en,./w,predict/en,_,proba/en,(/w,pred/en,_,set/en,)/w,[/w,i/en,]/w,[/w,0/m,]/w,)/w,)/w,print/en,(/w,"/w,"/w,)/w,clean/en,_,and/en,_,predict/en,(/w,group/en,_,16/m,,/w, ,ranking/en,,/w, ,final/en,,/w, ,logreg/en,)/w,portugal/en, ,and/en, ,uruguay/en, ,winner/en,:/w, ,portugal/en, ,probability/en, ,of/en, ,portugal/en, ,winning/en,:/w, ,0.428/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.285/m, ,probability/en, ,of/en, ,uruguay/en, ,winning/en,:/w, ,0.287/m, ,france/en, ,and/en, ,croatia/en, ,winner/en,:/w, ,france/en, ,probability/en, ,of/en, ,france/en, ,winning/en,:/w, ,0.481/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.252/m, ,probability/en, ,of/en, ,croatia/en, ,winning/en,:/w, ,0.267/m, ,brazil/en, ,and/en, ,mexico/en, ,winner/en,:/w, ,brazil/en, ,probability/en, ,of/en, ,brazil/en, ,winning/en,:/w, ,0.695/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.209/m, ,probability/en, ,of/en, ,mexico/en, ,winning/en,:/w, ,0.096/m, ,england/en, ,and/en, ,colombia/en, ,winner/en,:/w, ,england/en, ,probability/en, ,of/en, ,england/en, ,winning/en,:/w, ,0.516/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.368/m, ,probability/en, ,of/en, ,colombia/en, ,winning/en,:/w, ,0.116/m, ,spain/en, ,and/en, ,russia/en, ,winner/en,:/w, ,spain/en, ,probability/en, ,of/en, ,spain/en, ,winning/en,:/w, ,0.529/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.280/m, ,probability/en, ,of/en, ,russia/en, ,winning/en,:/w, ,0.191/m, ,argentina/en, ,and/en, ,peru/en, ,winner/en,:/w, ,argentina/en, ,probability/en, ,of/en, ,argentina/en, ,winning/en,:/w, ,0.713/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.212/m, ,probability/en, ,of/en, ,peru/en, ,winning/en,:/w, ,0.075/m, ,germany/en, ,and/en, ,switzerland/en, ,winner/en,:/w, ,germany/en, ,probability/en, ,of/en, ,germany/en, ,winning/en,:/w, ,0.672/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.192/m, ,probability/en, ,of/en, ,switzerland/en, ,winning/en,:/w, ,0.137/m, ,belgium/en, ,and/en, ,poland/en, ,winner/en,:/w, ,belgium/en, ,probability/en, ,of/en, ,belgium/en, ,winning/en,:/w, ,0.513/m, ,probability/en, ,of/en, ,draw/en,:/w, ,0.202/m, ,probability/en, ,of/en, ,poland/en, ,winning/en,:/w, ,0.285/m,之后/f,依次/d,进行/v,四分之一/nw,、/w,半决赛/n,、/w,决赛/vn,的/u,模拟/b,：/w,四分之一/nw,：/w,#, ,list/en, ,of/en, ,matches/en, ,quarters/en, ,=/w, ,[/w,(/w,'/w,portugal/en,'/w,,/w, ,'/w,france/en,'/w,)/w,,/w, ,(/w,'/w,spain/en,'/w,,/w, ,'/w,argentina/en,'/w,)/w,,/w, ,(/w,'/w,brazil/en,'/w,,/w, ,'/w,england/en,'/w,)/w,,/