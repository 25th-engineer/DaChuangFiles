1/m,./w,简介/n,gbdt/en,全称/n,梯度/n,提升/v,决策/n,树/v,，/w,在/p,传统/n,机器/n,学习/v,算法/n,里面/f,是/v,对/p,真实/a,分布/v,拟合/nz,的/u,最/d,好/a,的/u,几/m,种/q,算法/n,之一/r,，/w,在/p,前/f,几/m,年/q,深度/n,学习/v,还/d,没有/v,大行其道/l,之前/f,，/w,gbdt/en,在/p,各种/r,竞赛/vn,是/v,大放异彩/i,。/w,原因/n,大概/d,有/v,几/m,个/q,，/w,一/m,是/v,效果/n,确实/ad,挺/d,不错/a,。/w,二/m,是/v,即/v,可以/v,用于/v,分类/vn,也/d,可以/v,用于/v,回归/v,。/w,三/m,是/v,可以/v,筛选/v,特征/n,。/w,这/r,三点/mq,实在/d,是/v,太/d,吸引/v,人/n,了/u,，/w,导致/v,在/p,面试/v,的/u,时候/n,大家/r,也/d,非常/d,喜欢/v,问/v,这个/r,算法/n,。/w, ,gbdt/en,的/u,面试/v,考核点/nw,，/w,大致/d,有/v,下面/f,几/m,个/q,:/w,gbdt/en, ,的/u,算法/n,的/u,流程/n,？/w,gbdt/en, ,如何/r,选择/v,特征/n, ,？/w,gbdt/en, ,如何/r,构建/v,特征/n, ,？/w,gbdt/en, ,如何/r,用于/v,分类/vn,？/w,gbdt/en, ,通过/p,什么/r,方式/n,减少/v,误差/n, ,？/w,gbdt/en,的/u,效果/n,相比/v,于/p,传统/n,的/u,lr/en,，/w,svm/en,效果/n,为什么/r,好/a,一些/m, ,？/w,gbdt/en, ,如何/r,加速/v,训练/vn,？/w,gbdt/en,的/u,参数/n,有/v,哪些/r,，/w,如何/r,调/v,参/j, ,？/w,gbdt/en, ,实战/n,当中/f,遇到/v,的/u,一些/m,问题/n, ,？/w,gbdt/en,的/u,优缺点/n, ,？/w,2/m,./w, ,正式/ad,介绍/v,首先/d,gbdt/en, ,是/v,通过/p,采用/v,加法/n,模型/n,（/w,即/v,基/ng,函数/n,的/u,线性/n,组合/v,）/w,，/w,以及/c,不断/d,减/v,小/a,训练/vn,过程/n,产生/v,的/u,残差/nw,来/v,达到/v,将/d,数据/n,分类/vn,或者/c,回归/v,的/u,算法/n,。/w,gbdt/en,的/u,训练/vn,过程/n,我们/r,通过/p,一张/mq,图片/n,，/w,图片/n,来源/n,来/v,说明/v,gbdt/en,的/u,训练/vn,过程/n,:/w,图/n, ,1/m,：/w,gbdt/en, ,的/u,训练/vn,过程/n,gbdt/en,通过/p,多/a,轮/q,迭代/vn,,/w,每/r,轮/q,迭代/vn,产生/v,一个/m,弱分类器/nw,，/w,每个/r,分类器/nw,在/p,上/f,一轮/mq,分类器/nw,的/u,残差/nw,基础/n,上/f,进行/v,训练/vn,。/w,对/p,弱分类器/nw,的/u,要求/v,一般/a,是/v,足够/v,简单/a,，/w,并且/c,是/v,低方/nw,差/a,和/c,高/a,偏差/n,的/u,。/w,因为/c,训练/vn,的/u,过程/n,是/v,通过/p,降低/v,偏差/n,来/v,不断/d,提高/v,最终/d,分类器/nw,的/u,精度/n,，/w,（/w,此处/s,是/v,可以/v,证明/v,的/u,）/w,。/w,弱分类器/nw,一般/a,会/v,选择/v,为/p,cart/en, ,tree/en,（/w,也/d,就/d,是/v,分类/vn,回归/v,树/v,）/w,。/w,由于/c,上述/b,高/a,偏差/n,和/c,简单/a,的/u,要求/v, ,每个/r,分类/vn,回归/v,树/v,的/u,深度/n,不/d,会/v,很/d,深/a,。/w,最终/d,的/u,总/b,分类器/nw, ,是/v,将/d,每/r,轮/q,训练/vn,得到/v,的/u,弱分类器/nw,加权/v,求/v,和/c,得到/v,的/u,（/w,也/d,就/d,是/v,加法/n,模型/n,）/w,。/w,模型/n,最终/d,可以/v,描述/v,为/p,：/w,$/w,$/w,f/en,_,{/w,m/en,}/w,(/w,x/en,)/w, ,=/w, ,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,m/en,}/w,t/en,\/w,left/en, ,(/w, ,x/en,;/w,\/w,theta/en, ,_,m/en, ,\/w,right/en, ,)/w,$/w,$/w,模型/n,一共/d,训练/vn,m/en,轮/q,，/w,每/r,轮/q,产生/v,一个/m,弱/a,分类器/nw, ,$/w,t/en,\/w,left/en, ,(/w, ,x/en,;/w,\/w,theta/en, ,_,m/en, ,\/w,right/en, ,)/w,$/w,。/w,弱分类器/nw,的/u,损失/n,函数/n,$/w,$/w,\/w,hat/en,\/w,theta/en,_,{/w,m/en,}/w, ,=/w, ,\/w,mathop/en,{/w,\/w,arg/en,\/w,min/en,}/w,_,{/w,\/w,theta/en,_,{/w,m/en,}/w,}/w, ,\/w,sum/en,_,{/w,i/en,=/w,1/m,}/w,^,{/w,n/en,}/w,l/en,\/w,left/en, ,(/w, ,y/en,_,{/w,i/en,}/w,,/w,f/en,_,{/w,m/en,-/w,1/m,}/w,(/w,x/en,_,{/w,i/en,}/w,)/w,+/w,t/en,(/w,x/en,_,{/w,i/en,}/w,;/w,\/w,theta/en,_,{/w,m/en,}/w, ,)/w, ,\/w,right/en, ,)/w,$/w,$/w,$/w,f/en,_,{/w,m/en,-/w,1/m,}/w,(/w,x/en,)/w,$/w, ,为/p,当前/t,的/u,模型/n,，/w,gbdt/en, ,通过/p,经验/n,风险/n,极/d,小化/nr,来/v,确定/v,下/f,一个/m,弱分类器/nw,的/u,参数/n,。/w,具体/a,到/v,损失/n,函数/n,本身/r,的/u,选择/v,也/d,就/d,是/v,l/en,的/u,选择/v,，/w,有/v,平方/q,损失/n,函数/n,，/w,0/m,-/w,1/m,损失/n,函数/n,，/w,对/p,数/m,损失/n,函数/n,等等/u,。/w,如果/c,我们/r,选择/v,平方/q,损失/n,函数/n,，/w,那么/r,这个/r,差值/n,其实/d,就是/d,我们/r,平常/a,所/u,说/v,的/u,残差/nw,。/w,但是/c,其实/d,我们/r,真正/d,关注/v,的/u,，/w,1/m,./w,是/v,希望/v,损失/n,函数/n,能够/v,不断/d,的/u,减小/v,，/w,2/m,./w,是/v,希望/v,损失/n,函数/n,能够/v,尽可能/d,快/a,的/u,减小/v,。/w,所以/c,如何/r,尽可能/d,快/a,的/u,减小/v,呢/y,？/w,让/v,损失/n,函数/n,沿着/p,梯度/n,方向/n,的/u,下降/v,。/w,这个/r,就/d,是/v,gbdt/en, ,的/u, ,gb/en,的/u,核心/n,了/u,。/w, ,利用/v,损失/n,函数/n,的/u,负/v,梯度/n,在/p,当前/t,模型/n,的/u,值/n,作为/v,回归/v,问题/n,提升/v,树/v,算法/n,中/f,的/u,残差/nw,的/u,近似/a,值/n,去/v,拟合/nz,一个/m,回归/v,树/v,。/w,gbdt/en, ,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,都/d,去/v,拟合/nz,损失/n,函数/n,在/p,当前/t,模型/n,下/f,的/u,负/v,梯度/n,。/w,这样/r,每/r,轮/q,训练/vn,的/u,时候/n,都/d,能够/v,让/v,损失/n,函数/n,尽可能/d,快/a,的/u,减小/v,，/w,尽快/d,的/u,收敛/vn,达到/v,局部/n,最/d,优解/nw,或者/c,全局/n,最/d,优解/nw,。/w,gbdt/en,如何/r,选择/v,特征/n,？/w,gbdt/en,选择/v,特征/n,的/u,细节/n,其实/d,是/v,想/v,问/v,你/r,cart/en, ,tree/en,生成/vn,的/u,过程/n,。/w,这里/r,有/v,一个/m,前提/n,，/w,gbdt/en,的/u,弱分类器/nw,默认/v,选择/v,的/u,是/v,cart/en, ,tree/en,。/w,其实/d,也/d,可以/v,选择/v,其他/r,弱分类器/nw,的/u,，/w,选择/v,的/u,前提/n,是/v,低方/nw,差/a,和/c,高/a,偏差/n,。/w,框架/n,服从/v,boosting/en, ,框架/n,即可/v,。/w,下面/f,我们/r,具体来说/nw,cart/en, ,tree/en,(/w,是/v,一种/mq,二/m,叉/v,树/v,)/w, ,如何/r,生成/vn,。/w,cart/en, ,tree/en, ,生成/vn,的/u,过程/n,其实/d,就/d,是/v,一个/m,选择/v,特征/n,的/u,过程/n,。/w,假设/v,我们/r,目前/t,总共/d,有/v, ,m/en, ,个/q,特征/n,。/w,第一/m,步/q,我们/r,需要/v,从中/d,选择/v,出/v,一个/m,特征/n, ,j/en,，/w,做/v,为/p,二/m,叉/v,树/v,的/u,第一/m,个/q,节点/n,。/w,然后/c,对/p,特征/n, ,j/en, ,的/u,值/n,选择/v,一个/m,切分点/nw, ,m/en,./w, ,一个/m, ,样本/n,的/u,特征/n,j/en,的/u,值/n, ,如果/c,小于/v,m/en,，/w,则/d,分为/v,一类/mq,，/w,如果/c,大于/v,m/en,,/w,则/d,分为/v,另外/c,一类/b,。/w,如此/r,便/d,构建/v,了/u,cart/en, ,树/v,的/u,一个/m,节点/n,。/w,其他/r,节点/n,的/u,生成/vn,过程/n,和/c,这个/r,是/v,一样/u,的/u,。/w,现在/t,的/u,问题/n,是/v,在/p,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,如何/r,选择/v,这个/r,特征/n, ,j/en,,/w,以及/c,如何/r,选择/v,特征/n, ,j/en, ,的/u,切分点/nw, ,m/en,:/w,原始/a,的/u,gbdt/en,的/u,做法/n,非常/d,的/u,暴力/n,，/w,首先/d,遍历/nw,每个/r,特征/n,，/w,然后/c,对/p,每个/r,特征/n,遍历/nw,它/r,所有/b,可能/v,的/u,切分点/nw,，/w,找到/v,最/d,优/ag,特征/n, ,m/en, ,的/u,最/d,优切分点/nt, ,j/en,。/w,如何/r,衡量/v,我们/r,找到/v,的/u,特征/n, ,m/en,和/c,切分点/nw, ,j/en, ,是/v,最/d,优/ag,的/u,呢/y,？/w, ,我们/r,用/p,定义/n,一个/m,函数/n, ,findlossandsplit/en, ,来/v,展示/v,一下/m,求解/v,过程/n,：/w,1/m, ,def/en, ,findlossandsplit/en,(/w,x/en,,/w,y/en,)/w,:/w, ,2/m, ,#, ,我们/r,用/p, ,x/en, ,来/v,表示/v,训练/vn,数据/n, ,3/m, ,#, ,我们/r,用/p, ,y/en, ,来/v,表示/v,训练/vn,数据/n,的/u,label/en, ,4/m, ,#, ,x/en,[/w,i/en,]/w,表示/v,训练/vn,数据/n,的/u,第/m,i/en,个/q,特征/n, ,5/m, ,#, ,x/en,_,i/en, ,表示/v,第/m,i/en,个/q,训练/vn,样本/n, ,6/m, ,7/m, ,#, ,minloss/en, ,表示/v,最小/a,的/u,损失/n, ,8/m, ,minloss/en, ,=/w, ,integet/en,./w,max/en,_,value/en, ,9/m, ,#, ,feature/en, ,表示/v,是/v,训练/vn,的/u,数据/n,第几纬度/nw,的/u,特征/n, ,10/m, ,feature/en, ,=/w, ,0/m, ,11/m, ,#, ,split/en, ,表示/v,切分点/nw,的/u,个数/n, ,12/m, ,split/en, ,=/w, ,0/m, ,13/m, ,14/m, ,#, ,m/en, ,表示/v, ,样本/n,x/en,的/u,特征/n,个/q,数/m, ,15/m, ,for/en, ,j/en, ,in/en, ,range/en,(/w,0/m,,/w,m/en,)/w,:/w, ,16/m, ,#, ,该维/nw,特征/n,下/f,，/w,特征值/n,的/u,每个/r,切分点/nw,，/w,这里/r,具体/a,的/u,切分/v,方式/n,可以/v,自己/r,定义/n, ,17/m, ,for/en, ,c/en, ,in/en, ,range/en,(/w,0/m,,/w,x/en,[/w,j/en,]/w,)/w,:/w, ,18/m, ,l/en, ,=/w, ,0/m, ,19/m, ,#, ,第一/m,类/q, ,20/m, ,r/en,1/m, ,=/w, ,{/w,x/en,|/w,x/en,[/w,j/en,]/w, ,</w,=/w, ,c/en,}/w, ,21/m, ,#, ,第二/m,类/q, ,22/m, ,r/en,2/m, ,=/w, ,{/w,x/en,|/w,x/en,[/w,j/en,]/w, ,>, ,c/en,}/w, ,23/m, ,#, ,属于/v,第一/m,类/q,样本/n,的/u,y/en,值/n,的/u,平均值/n, ,24/m, ,y/en,1/m, ,=/w, ,ave/en,{/w,y/en,|/w,x/en, ,属于/v, ,r/en,1/m,}/w, ,25/m, ,#, ,属于/v,第二/m,类/q,样本/n,的/u,y/en,值/n,的/u,平均值/n, ,26/m, ,y/en,2/m, ,=/w, ,ave/en,{/w,y/en,|/w, ,x/en, ,属于/v, ,r/en,2/m,}/w, ,27/m, ,#, ,遍历/nw,所有/b,的/u,样本/n,，/w,找到/v, ,loss/en, ,funtion/en, ,的/u,值/n, ,28/m, ,for/en, ,x/en,_,1/m, ,in/en, ,all/en, ,x/en, ,29/m, ,if/en, ,x/en,_,1/m, ,属于/v, ,r/en,1/m,：/w, ,30/m, ,l/en, ,+/w,=/w, ,(/w,y/en,_,1/m, ,-/w, ,y/en,1/m,)/w,^,2/m, ,31/m, ,else/en,:/w, ,32/m, ,l/en, ,+/w,=/w, ,(/w,y/en,_,1/m, ,-/w, ,y/en,2/m,)/w,^,2/m, ,33/m, ,if/en, ,l/en, ,</w, ,minloss/en,:/w, ,34/m, ,minloss/en, ,=/w, ,l/en, ,35/m, ,feature/en, ,=/w, ,i/en, ,36/m, ,split/en, ,=/w, ,c/en, ,37/m, ,return/en, ,minloss/en,,/w,feature/en, ,,/w,split/en,如果/c,对/p,这/r,段/q,代码/n,不/d,是/v,很/d,了解/v,的/u,，/w,可以/v,先/d,去/v,看看/v,李航第五/nr,章/q,中/f,对/p,cart/en, ,tree/en, ,算法/n,的/u,叙述/v,。/w,在/p,这里/r,，/w,我们/r,先/d,遍历/nw,训练/vn,样本/n,的/u,所有/b,的/u,特征/n,，/w,对于/p,特征/n, ,j/en,，/w,我们/r,遍历/nw,特征/n, ,j/en, ,所有/b,特征值/n,的/u,切分点/nw, ,c/en,。/w,找到/v,可以/v,让/v,下面/f,这个/r,式子/n,最小/a,的/u,特征/n, ,j/en, ,以及/c,切分点/nw,c/en,./w,gbdt/en, ,如何/r,构建/v,特征/n, ,?/w,其实/d,说/v,gbdt/en, ,能够/v,构建/v,特征/n,并非/v,很/d,准确/a,，/w,gbdt/en, ,本身/r,是/v,不能/v,产生/v,特征/n,的/u,，/w,但是/c,我们/r,可以/v,利用/v,gbdt/en,去/v,产生/v,特征/n,的/u,组合/v,。/w,在/p,ctr/en,预估/v,中/f,，/w,工业界/n,一般/a,会/v,采用/v,逻辑/n,回归/v,去/v,进行/v,处理/v,,/w,在/p,我/r,的/u,上/f,一篇/mq,博文/nz,当中/f,已经/d,说/v,过/u,，/w,逻辑/n,回归/v,本身/r,是/v,适合/v,处理/v,线性/n,可/v,分/q,的/u,数据/n,，/w,如果/c,我们/r,想/v,让/v,逻辑/n,回归/v,处理/v,非线性/b,的/u,数据/n,，/w,其中/r,一种/mq,方式/n,便是/v,组合/v,不同/a,特征/n,，/w,增强/v,逻辑/n,回归/v,对/p,非线性/b,分布/v,的/u,拟合/nz,能力/n,。/w,长久/a,以来/f,，/w,我们/r,都/d,是/v,通过/p,人工/n,的/u,先验/n,知识/n,或者/c,实验/vn,来/v,获得/v,有效/a,的/u,组合/v,特征/n,，/w,但是/c,很多/m,时候/n,，/w,使用/v,人工/n,经验/n,知识/n,来/v,组合/v,特征/n,过于/d,耗费/v,人力/n,，/w,造成/v,了/u,机器/n,学习/v,当中/f,一个/m,很/d,奇特/nz,的/u,现象/n,：/w,有/v,多少/r,人工/n,就/d,有/v,多少/r,智能/n,。/w,关键/n,是/v,这样/r,通过/p,人工/n,去/v,组合/v,特征/n,并/c,不/d,一定/d,能够/v,提升/v,模型/n,的/u,效果/n,。/w,所以/c,我们/r,的/u,从业者/n,或者/c,学界/n,一直/d,都/d,有/v,一个/m,趋势/n,便是/v,通过/p,算法/n,自动/d,，/w,高效/b,的/u,寻找/v,到/v,有效/a,的/u,特征/n,组合/v,。/w,facebook/en, ,在/p,2014年/t, ,发表/v,的/u,一篇/mq,论文/n,便是/v,这种/r,尝试/vn,下/f,的/u,产物/n,，/w,利用/v,gbdt/en,去/v,产生/v,有效/a,的/u,特征/n,组合/v,，/w,以便/d,用于/v,逻辑/n,回归/v,的/u,训练/vn,，/w,提升/v,模型/n,最终/d,的/u,效果/n,。/w,图/n, ,2/m,：/w,用/p,gbdt/en, ,构造/v,特征/n,如/v,图/n, ,2/m,所示/nz,，/w,我们/r, ,使用/v, ,gbdt/en, ,生成/vn,了/u,两棵/mq,树/v,，/w,两颗/mq,树/v,一共/d,有/v,五个/m,叶子/n,节点/n,。/w,我们/r,将/d,样本/n, ,x/en, ,输入/v,到/v,两颗/mq,树/v,当中/f,去/v,，/w,样本/n,x/en, ,落/v,在/p,了/u,第一/m,棵/q,树/v,的/u,第二/m,个/q,叶子/n,节点/n,，/w,第二/m,颗/q,树/v,的/u,第一/m,个/q,叶子/n,节点/n,，/w,于是/c,我们/r,便/d,可以/v,依次/d,构建/v,一个/m,五纬/nw,的/u,特征/n,向量/n,，/w,每/r,一个/m,纬度/n,代表/n,了/u,一个/m,叶子/n,节点/n,，/w,样本/n,落/v,在/p,这个/r,叶子/n,节点/n,上面/f,的/u,话/n,那么/r,值/n,为/p,1/m,，/w,没有/v,落/v,在/p,该/r,叶子/n,节点/n,的话/u,，/w,那么/r,值/n,为/p, ,0/m,./w,于是/c,对于/p,该/r,样本/n,，/w,我们/r,可以/v,得到/v,一个/m,向量/n,[/w,0/m,,/w,1/m,,/w,0/m,,/w,1/m,,/w,0/m,]/w, ,作为/v,该/r,样本/n,的/u,组合/v,特征/n,，/w,和/c,原来/d,的/u,特征/n,一起/s,输入/v,到/v,逻辑/n,回归/v,当中/f,进行/v,训练/vn,。/w,实验/vn,证明/v,这样/r,会/v,得到/v,比较/d,显著/a,的/u,效果/n,提升/v,。/w,gbdt/en, ,如何/r,用于/v,分类/vn, ,？/w,首先/d,明确/ad,一点/m,，/w,gbdt/en, ,无论/c,用于/v,分类/vn,还是/c,回归/v,一直/d,都/d,是/v,使用/v,的/u,cart/en, ,回归/v,树/v,。/w,不/d,会/v,因为/c,我们/r,所/u,选择/v,的/u,任务/n,是/v,分类/vn,任务/n,就/d,选用/v,分类/vn,树/v,，/w,这/r,里面/f,的/u,核心/n,是/v,因为/c,gbdt/en, ,每/r,轮/q,的/u,训练/vn,是/v,在/p,上/f,一轮/mq,的/u,训练/vn,的/u,残差/nw,基础/n,之上/f,进行/v,训练/vn,的/u,。/w,这里/r,的/u,残差/nw,就/d,是/v,当前/t,模型/n,的/u,负/v,梯度/n,值/n, ,。/w,这个/r,要求/v,每/r,轮/q,迭代/vn,的/u,时候/n,，/w,弱分类器/nw,的/u,输出/v,的/u,结果/n,相减/nw,是/v,有/v,意义/n,的/u,。/w,残差/nw,相减/nw,是/v,有/v,意义/n,的/u,。/w,如果/c,选用/v,的/u,弱分类器/nw,是/v,分类/vn,树/v,，/w,类别/n,相减/nw,是/v,没有/v,意义/n,的/u,。/w,上/f,一轮/mq,输出/v,的/u,是/v,样本/n, ,x/en, ,属于/v, ,a/en,类/q,，/w,本/r,一轮/mq,训练/vn,输出/v,的/u,是/v,样本/n, ,x/en, ,属于/v, ,b/en,类/q,。/w, ,a/en, ,和/c, ,b/en, ,很多/m,时候/n,甚至/d,都/d,没有/v,比较/d,的/u,意义/n,，/w,a/en, ,类/q,-/w, ,b/en,类/q,是/v,没有/v,意义/n,的/u,。/w,我们/r,具体/a,到/v,分类/vn,这个/r,任务/n,上面/f,来/v,，/w,我们/r,假设/v,样本/n, ,x/en, ,总共/d,有/v, ,k/en,类/q,。/w,来/v,了/u,一个/m,样本/n, ,x/en,，/w,我们/r,需要/v,使用/v,gbdt/en,来/v,判断/v, ,x/en, ,属于/v,样本/n,的/u,哪/r,一类/mq,。/w,图/n,三/m, ,gbdt/en, ,多/a,分类/vn,算法/n,流程/n,第一/m,步/q, ,我们/r,在/p,训练/vn,的/u,时候/n,，/w,是/v,针对/p,样本/n, ,x/en, ,每个/r,可能/v,的/u,类/q,都/d,训练/vn,一个/m,分类/vn,回归/v,树/v,。/w,举例/v,说明/v,，/w,目前/t,样本/n,有/v,三类/mq,，/w,也/d,就/d,是/v, ,k/en, ,=/w, ,3/m,。/w,样本/n, ,x/en, ,属于/v, ,第二/m,类/q,。/w,那么/r,针对/p,该/r,样本/n, ,x/en, ,的/u,分类/vn,结果/n,，/w,其实/d,我们/r,可以/v,用/p,一个/m, ,三维/nz,向/p,量/n, ,[/w,0/m,,/w,1/m,,/w,0/m,]/w, ,来/v,表示/v,。/w,0/m,表示/v,样本/n,不/d,属于/v,该类/r,，/w,1/m,表示/v,样本/n,属于/v,该类/r,。/w,由于/c,样本/n,已经/d,属于/v,第二/m,类/q,了/u,，/w,所以/c,第二/m,类/q,对应/v,的/u,向量/n,维度/n,为/p,1/m,，/w,其他/r,位置/n,为/p,0/m,。/w,针对/p,样本/n,有/v, ,三类/mq,的/u,情况/n,，/w,我们/r,实质/n,上/f,是/v,在/p,每/r,轮/q,的/u,训练/vn,的/u,时候/n,是/v,同时/c,训练/vn,三颗/mq,树/v,。/w,第一/m,颗/q,树/v,针对/p,样本/n,x/en,的/u,第一/m,类/q,，/w,输入/v,为/p,$/w,（/w,x/en,,/w,0/m,）/w,$/w,。/w,第二/m,颗/q,树/v,输入/v,针对/p, ,样本/n,x/en, ,的/u,第二/m,类/q,，/w,输入/v,为/p,$/w,（/w,x/en,,/w,1/m,）/w,$/w,。/w,第三/nw,颗/q,树/v,针对/p,样本/n,x/en, ,的/u,第三/nw,类/q,，/w,输入/v,为/p,$/w,（/w,x/en,，/w,0/m,）/w,$/w,在/p,这里/r,每/r,颗/q,树/v,的/u,训练/vn,过程/n,其实/d,就是/d,就/d,是/v,我们/r,之前/f,已经/d,提到/v,过/u,的/u,catr/en, ,tree/en, ,的/u,生成/vn,过程/n,。/w,在/p,此处/s,我们/r,参照/v,之前/f,的/u,生成/vn,树/v,的/u,程序/n, ,即/v,可以/v,就/d,解/v,出/v,三颗/mq,树/v,，/w,以及/c,三颗/mq,树/v,对/p,x/en, ,类别/n,的/u,预测值/n,$/w,f/en,_,{/w,1/m,}/w,(/w,x/en,)/w,,/w,f/en,_,{/w,2/m,}/w,(/w,x/en,)/w,,/w,f/en,_,{/w,3/m,}/w,(/w,x/en,)/w,$/w,。/w,那么/r,在/p,此类/r,训练/vn,中/f,，/w,我们/r,仿照/v,多/a,分类/vn,的/u,逻辑/n,回归/v, ,，/w,使用/v,softmax/en, ,来/v,产生/v,概率/n,，/w,则/d,属于/v,类别/n, ,1/m, ,的/u,概率/n,$/w,$/w,p/en,_,{/w,1/m,}/w,=/w,exp/en,(/w,f/en,_,{/w,1/m,}/w,{/w,(/w,x/en,)/w,}/w,)/w,//w,\/w,sum/en,_,{/w,k/en,=/w, ,1/m,}/w,^,{/w,3/m,}/w,exp/en,(/w,f/en,_,{/w,k/en,}/w,{/w,(/w,x/en,)/w,}/w,)/w,$/w,$/w,并且/c,我们/r,我们/r,可以/v,针对/p,类别/n,1/m, ,求/v,出/v, ,残差/nw,$/w,y/en,_,{/w,11/m,}/w,(/w,x/en,)/w, ,=/w, ,0/m,-/w,p/en,_,{/w,1/m,}/w,(/w,x/en,)/w,$/w,;/w,类别/n,2/m, ,求/v,出/v,残差/nw,$/w,y/en,_,{/w,22/m,}/w,(/w,x/en,)/w,=/w, ,1/m,-/w,p/en,_,2/m,(/w,x/en,)/w,$/w,;/w,类别/n,3/m, ,求/v,出/v,残差/nw,$/w,y/en,_,{/w,33/m,}/w,(/w,x/en,)/w,=/w, ,0/m,-/w,p/en,_,{/w,3/m,}/w,(/w,x/en,)/w,$/w,./w,然后/c,开始/v,第二/m,轮/q,训练/vn, ,针对/p,第一/m,类/q, ,输入/v,为/p,（/w,x/en,,/w,$/w,y/en,_,{/w,11/m,}/w,(/w,x/en,)/w,$/w,）/w,,/w, ,针对/p,第二/m,类/q,输入/v,为/p,（/w,x/en,,/w,$/w,y/en,_,{/w,22/m,}/w,(/w,x/en,)/w,)/w,$/w,,/w, ,针对/p, ,第三/nw,类/q,输入/v,为/p, ,(/w,x/en,,/w,$/w,y/en,_,{/w,33/m,}/w,(/w,x/en,)/w,$/w,)/w,./w,继续/v,训练/vn,出/v,三颗/mq,树/v,。/w,一直/d,迭代/vn,m/en,轮/q,。/w,每/r,轮/q,构建/v, ,3颗/mq,树/v,。/w,所以/c,当/p,k/en, ,=/w,3/m,。/w,我们/r,其实/d,应该/v,有/v,三个/m,式子/n, ,$/w,$/w,f/en,_,{/w,1/m,m/en,}/w,{/w,(/w,x/en,)/w,}/w,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,\/w,hat/en,{/w,c/en,_,{/w,1/m,m/en,}/w,}/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,1/m,m/en,}/w,)/w,}/w,$/w,$/w, ,$/w,$/w,f/en,_,{/w,2/m,m/en,}/w,{/w,(/w,x/en,)/w,}/w,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,\/w,hat/en,{/w,c/en,_,{/w,2/m,m/en,}/w,}/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,2/m,m/en,}/w,)/w,}/w,$/w,$/w, ,$/w,$/w,f/en,_,{/w,3/m,m/en,}/w,{/w,(/w,x/en,)/w,}/w,=/w,\/w,sum/en,_,{/w,m/en,=/w,1/m,}/w,^,{/w,m/en,}/w,{/w,\/w,hat/en,{/w,c/en,_,{/w,3/m,m/en,}/w,}/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,3/m,m/en,}/w,)/w,}/w,$/w,$/w,当/p,训练/vn,完毕/v,以后/f,，/w,新/a,来/v,一个/m,样本/n, ,x/en,1/m, ,，/w,我们/r,需要/v,预测/v,该/r,样本/n,的/u,类别/n,的/u,时候/n,，/w,便/d,可以/v,有/v,这/r,三个/m,式子/n,产生/v,三个/m,值/n,，/w,$/w,f/en,_,{/w,1/m,}/w,(/w,x/en,)/w,,/w,f/en,_,{/w,2/m,}/w,(/w,x/en,)/w,,/w,f/en,_,{/w,3/m,}/w,(/w,x/en,)/w,$/w,。/w,样本/n,属于/v, ,某个/r,类别/n,c/en,的/u,概率/n,为/p, ,$/w,$/w,p/en,_,{/w,c/en,}/w,=/w,exp/en,(/w,f/en,_,{/w,c/en,}/w,{/w,(/w,x/en,)/w,}/w,)/w,//w,\/w,sum/en,_,{/w,k/en,=/w, ,1/m,}/w,^,{/w,3/m,}/w,exp/en,(/w,f/en,_,{/w,k/en,}/w,{/w,(/w,x/en,)/w,}/w,)/w,$/w,$/w,gbdt/en, ,多/a,分类/vn,举例/v,说明/v,上面/f,的/u,理论/n,阐述/v,可能/v,仍旧/d,过于/d,难懂/a,，/w,我们/r,下面/f,将/d,拿/v,iris/en, ,数据/n,集中/v,的/u,六个/m,数据/n,作为/v,例子/n,，/w,来/v,展示/v,gbdt/en, ,多/a,分类/vn,的/u,过程/n,。/w,样本/n,编号/v,花萼/n,长度/n,(/w,cm/en,)/w,花萼/n,宽度/n,(/w,cm/en,)/w,花瓣/n,长度/n,(/w,cm/en,)/w,花瓣/n,宽度/n,花/v,的/u,种类/n,15/m,./w,13/m,./w,51/m,./w,40/m,./w,2/m,山/n,鸢尾/nw,24/m,./w,93/m,./w,01/m,./w,40/m,./w,2/m,山/n,鸢尾/nw,37/m,./w,03/m,./w,24/m,./w,71/m,./w,4/m,杂色/n,鸢尾/nw,46/m,./w,43/m,./w,24/m,./w,51/m,./w,5/m,杂色/n,鸢尾/nw,56/m,./w,33/m,./w,36/m,./w,02/m,./w,5/m,维吉尼亚/nrf,鸢尾/nw,65/m,./w,82/m,./w,75/m,./w,11/m,./w,9/m,维吉尼亚/nrf,鸢尾/nw,图/n,四/m, ,iris/en, ,数据/n,集/vg,这/r,是/v,一个/m,有/v,6个/m,样本/n,的/u,三/m,分类/vn,问题/n,。/w,我们/r,需要/v,根据/p,这个/r,花/v,的/u,花萼/n,长度/n,，/w,花萼/n,宽度/n,，/w,花瓣/n,长度/n,，/w,花瓣/n,宽度/n,来/v,判断/v,这个/r,花/v,属于/v,山鸢/nw,尾/q,，/w,杂色/n,鸢尾/nw,，/w,还是/c,维吉尼亚/nrf,鸢尾/nw,。/w,具体/a,应用/vn,到/v,gbdt/en,多/a,分类/vn,算法/n,上面/f,。/w,我们/r,用/p,一个/m,三维/nz,向/p,量/n,来/v,标志/n,样本/n,的/u,label/en,。/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w, ,表示/v,样本/n,属于/v,山鸢/nw,尾/q,，/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w, ,表示/v,样本/n,属于/v,杂色/n,鸢尾/nw,，/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w, ,表示/v,属于/v,维吉尼亚/nrf,鸢尾/nw,。/w,gbdt/en, ,的/u,多/a,分类/vn,是/v,针对/p,每个/r,类/q,都/d,独立/v,训练/vn,一个/m, ,cart/en, ,tree/en,。/w,所以/c,这里/r,，/w,我们/r,将/d,针对/p,山鸢/nw,尾/q,类别/n,训练/vn,一个/m, ,cart/en, ,tree/en, ,1/m,。/w,杂色/n,鸢尾/nw,训练/vn,一个/m, ,cart/en, ,tree/en, ,2/m, ,。/w,维吉尼亚/nrf,鸢尾/nw,训练/vn,一个/m,cart/en, ,tree/en, ,3/m,，/w,这/r,三个树/mq,相互/d,独立/v,。/w,我们/r,以/p,样本/n, ,1/m, ,为/p,例/n,。/w,针对/p, ,cart/en, ,tree/en,1/m, ,的/u,训练/vn,样本/n,是/v,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,]/w,$/w,，/w,label/en, ,是/v, ,1/m,，/w,最终/d,输入/v,到/v,模型/n,当中/f,的/u,为/p,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,,/w, ,1/m,]/w,$/w,。/w,针对/p, ,cart/en, ,tree/en,2/m, ,的/u,训练/vn,样本/n,也/d,是/v,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,]/w,$/w,,/w,但是/c,label/en, ,为/p, ,0/m,,/w,最终/d,输入/v,模型/n,的/u,为/p,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,,/w, ,0/m,]/w,$/w,./w, ,针对/p, ,cart/en, ,tree/en, ,3/m,的/u,训练/vn,样本/n,也/d,是/v,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,]/w, ,$/w,,/w,label/en, ,也/d,为/p,0/m,,/w,最终/d,输入/v,模型/n,当中/f,的/u,为/p,$/w,[/w,5.1/m,,/w, ,3.5/m, ,,/w, ,1.4/m,,/w, ,0.2/m,,/w, ,0/m,]/w,$/w,./w,下面/f,我们/r,来/v,看/v, ,cart/en, ,tree/en,1/m, ,是/v,如何/r,生成/vn,的/u,，/w,其他/r,树/v, ,cart/en, ,tree/en,2/m, ,,/w, ,cart/en, ,tree/en, ,3/m,的/u,生成/vn,方式/n,是/v,一样/u,的/u,。/w,cart/en, ,tree/en,的/u,生成/vn,过程/n,是/v,从/p,这/r,四个/m,特征/n,中/f,找/v,一个/m,特征/n,做/v,为/p,cart/en, ,tree/en,1/m, ,的/u,节点/n,。/w,比如/v,花萼/n,长度/n,做/v,为/p,节点/n,。/w,6个/m,样本/n,当中/f,花萼/n,长度/n, ,大于/v,5.1/m, ,cm/en,的/u,就/d,是/v, ,a/en,类/q,，/w,小于/v,等于/v, ,5.1/m, ,cm/en, ,的/u,是/v,b/en,类/q,。/w,生成/vn,的/u,过程/n,其实/d,非常/d,简单/a,，/w,问题/n, ,1/m,./w,是/v,哪个/r,特征/n,最/d,合适/a,？/w, ,2/m,./w,是/v,这个/r,特征/n,的/u,什么/r,特征值/n,作为/v,切分点/nw,？/w, ,即使/c,我们/r,已经/d,确定/v,了/u,花萼/n,长度/n,做/v,为/p,节点/n,。/w,花萼/n,长度/n,本身/r,也/d,有/v,很多/m,值/n,。/w,在/p,这里/r,我们/r,的/u,方式/n,是/v,遍历/nw,所有/b,的/u,可能性/n,，/w,找到/v,一个/m,最/d,好/a,的/u,特征/n,和/c,它/r,对应/v,的/u,最优/ad,特征值/n,可以/v,让/v,当前/t,式子/n,的/u,值/n,最/d,小/a,。/w,我们/r,以/p,第一/m,个/q,特征/n,的/u,第一/m,个/q,特征值/n,为/p,例/n,。/w,r/en,1/m, ,为/p,所有/b,样本/n,中/f,花萼/n,长度/n,小于/v, ,5.1/m, ,cm/en, ,的/u,样本/n,集合/v,，/w,r/en,2/m, ,为/p,所有/b,样本/n,当中/f,花萼/n,长度/n,大于/v,等于/v, ,5.1/m,cm/en, ,的/u,样本/n,集合/v,。/w,所以/c, ,$/w,r/en,1/m, ,=/w, ,\/w,left/en, ,\/w,{/w, , ,2/m,\/w,right/en, ,\/w,}/w,$/w,，/w,$/w,r/en,2/m, ,=/w, ,\/w,left/en, ,\/w,{/w, ,1/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m, ,\/w,right/en, ,\/w,}/w,$/w,./w,图/n, ,5/m, ,节点/n,分裂/v,示意图/n,y/en,1/m, ,为/p, ,r/en,1/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,$/w,1/m,//w,1/m, ,=/w, ,1/m,$/w,。/w,y/en,2/m, ,为/p, ,r/en,2/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,$/w,(/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w, ,//w,5/m, ,=/w, ,0.2/m,$/w,。/w,下面/f,便/d,开始/v,针对/p,所有/b,的/u,样本/n,计算/v,这个/r,式子/n,的/u,值/n,。/w,样本/n,1/m, ,属于/v, ,r/en,2/m, ,计算/v,的/u,值/n,为/p,$/w,(/w, ,1/m, ,-/w, ,0.2/m,)/w,^,2/m,$/w,,/w, ,样本/n,2/m, ,属于/v,r/en,1/m, ,计算/v,的/u,值/n,为/p,$/w,(/w, ,1/m, ,-/w,1/m, ,)/w,^,2/m,$/w,,/w, ,样本/n, ,3/m,，/w,4/m,，/w,5/m,，/w,6/m,同/p,理/n,都/d,是/v, ,属于/v, ,r/en,2/m,的/u, ,所以/c,值/n,是/v,$/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m,$/w,./w, ,把/p,这/r,六个/m,值/n,加/v,起来/v,，/w,便是/v, ,山/n,鸢尾/nw,类型/n,在/p,特征/n,1/m, ,的/u,第一/m,个/q,特征值/n,的/u,损失值/nw,。/w,这里/r,算/v,出来/v,(/w,1/m,-/w,0.2/m,)/w,^,2/m,+/w, ,(/w,1/m,-/w,1/m,)/w,^,2/m, ,+/w, ,(/w,0/m,-/w,0.2/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m, ,+/w,(/w,0/m,-/w,0.2/m,)/w,^,2/m,=/w, ,0.84/m,接着/c,我们/r,计算/v,第一/m,个/q,特征/n,的/u,第二/m,个/q,特征值/n,，/w,计算/v,方式/n,同/p,上/f,，/w,r/en,1/m, ,为/p,所有/b,样本/n,中/f, ,花萼/n,长度/n,小于/v, ,4.9/m, ,cm/en, ,的/u,样本/n,集合/v,，/w,r/en,2/m, ,为/p,所有/b,样本/n,当中/f, ,花萼/n,长度/n,大于/v,等于/v, ,4.9/m, ,cm/en, ,的/u,样本/n,集合/v,./w,所以/c, ,$/w,r/en,1/m, ,=/w, ,\/w,left/en, ,\/w,{/w, , ,\/w,right/en, ,\/w,}/w,$/w,，/w,$/w,r/en,1/m, ,=/w, ,\/w,left/en, ,\/w,{/w, ,1/m,,/w,2/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m, ,\/w,right/en, ,\/w,}/w,$/w,./w, ,y/en,1/m, ,为/p, ,r/en,1/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,=/w, ,0/m,。/w,y/en,2/m, ,为/p, ,r/en,2/m, ,所有/b,样本/n,的/u,label/en, ,的/u,均值/n, ,$/w,(/w,1/m,+/w,1/m,+/w,0/m,+/w,0/m,+/w,0/m,+/w,0/m,)/w, ,//w,6/m, ,=/w, ,0.3333/m,$/w,。/w,图/n, ,6/m, ,第一/m,个/q,特征/n,的/u,第二/m,个/q,特/d,侦值/nw,的/u,节点/n,分裂/v,情况/n,我们/r,需要/v,针对/p,所有/b,的/u,样本/n,,/w,样本/n,1/m, ,属于/v, ,r/en,2/m,,/w, ,计算/v,的/u,值/n,为/p,$/w,(/w, ,1/m, ,-/w, ,0.333/m, ,)/w,^,2/m,$/w,,/w, ,样本/n,2/m, ,属于/v,r/en,2/m, ,,/w,计算/v,的/u,值/n,为/p,$/w,(/w, ,1/m, ,-/w,0.333/m, ,)/w,^,2/m,$/w,,/w, ,样本/n, ,3/m,，/w,4/m,，/w,5/m,，/w,6/m,同/p,理/n,都/d,是/v, ,属于/v, ,r/en,2/m,的/u,,/w, ,所以/c,值/n,是/v,$/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m,$/w,./w, ,把/p,这/r,六个/m,值/n,加/v,起来/v,山鸢/nw,尾/q,类型/n,在/p,特征/n,1/m, ,的/u,第二/m,个/q,特征值/n,的/u,损失值/nw,。/w,这里/r,算/v,出来/v, ,(/w,1/m,-/w,0.333/m,)/w,^,2/m,+/w, ,(/w,1/m,-/w,0.333/m,)/w,^,2/m, ,+/w, ,(/w,0/m,-/w,0.333/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m, ,+/w,(/w,0/m,-/w,0.333/m,)/w,^,2/m, ,=/w, ,2/m,./w,244189/m,./w, ,这里/r,的/u,损失值/nw,大于/v, ,特征/n,一/m,的/u,第一/m,个/q,特征值/n,的/u,损失值/nw,，/w,所以/c,我们/r,不/d,取/v,这个/r,特征/n,的/u,特征值/n,。/w,图/n, ,7/m, ,所有/b,情况/n,说明/v,这样/r,我们/r,可以/v,遍历/nw,所有/b,特征/n,的/u,所有/b,特征值/n,，/w,找到/v,让/v,这个/r,式子/n,最小/a,的/u,特征/n,以及/c,其/r,对应/v,的/u,特征值/n,，/w,一共/d,有/v,24种/mq,情况/n,,/w,4个/m,特征/n,*/w,每个/r,特征/n,有/v,6个/m,特征值/n,。/w,在/p,这里/r,我们/r,算/v,出来/v,让/v,这个/r,式子/n,最小/a,的/u,特征/n,花萼/n,长度/n,,/w,特征值/n,为/p,5.1/m, ,cm/en,。/w,这个/r,时候/n,损失/n,函数/n,最/d,小/a,为/p, ,0.8/m,。/w,于是/c,我们/r,的/u,预测/v,函数/n,此时/r,也/d,可以/v,得到/v,:/w, ,$/w,$/w,f/en,(/w,x/en,)/w, ,=/w, ,\/w,sum/en,_,{/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,1/m,}/w,}/w, ,y/en,_,{/w,1/m,}/w,*/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,1/m,}/w,)/w,+/w,\/w,sum/en,_,{/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,2/m,}/w,}/w, ,y/en,_,{/w,2/m,}/w,*/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,2/m,}/w,)/w,$/w,$/w,此处/s, ,r/en,1/m, ,=/w, ,{/w,2/m,}/w,,/w,r/en,2/m, ,=/w, ,{/w,1/m,,/w,3/m,,/w,4/m,,/w,5/m,,/w,6/m,}/w,，/w,y/en,1/m, ,=/w, ,1/m,,/w,y/en,2/m, ,=/w, ,0.2/m,。/w,训练/vn,完/v,以后/f,的/u,最终/d,式子/n,为/p, ,$/w,$/w,f/en,_,{/w,1/m,}/w,(/w,x/en,)/w, ,=/w, ,\/w,sum/en,_,{/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,1/m,}/w,}/w, ,1/m,*/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,1/m,}/w,)/w,+/w,\/w,sum/en,_,{/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,2/m,}/w,}/w, ,0.2/m,*/w,i/en,(/w,x/en,\/w,epsilon/en, ,r/en,_,{/w,2/m,}/w,)/w,$/w,$/w,借/v,由/p,这个/r,式子/n,，/w,我们/r,得到/v,对/p,样本/n,属于/v,类别/n,1/m, ,的/u,预测值/n, ,$/w,f/en,_,{/w,1/m,}/w,(/w,x/en,)/w, ,=/w, ,1/m, ,+/w, ,0.2/m, ,*/w, ,5/m, , ,=/w, ,2/m,$/w,。/w,同理/v,我们/r,可以/v,得到/v,对/p,样本/n,属于/v,类别/n,2/m,,/w,3/m,的/u,预测值/n,$/w,f/en,_,{/w,2/m,}/w,(/w,x/en,)/w,$/w,,/w,$/w,f/en,_,{/w,3/m,}/w,(/w,x/en,)/w,$/w,./w,样本/n,属于/v,类别/n,1/m,的/u,概率/n, ,即/v,为/p, ,$/w,$/w,p/en,_,{/w,1/m,}/w,=/w,exp/en,(/w,f/en,_,{/w,1/m,}/w,{/w,(/w,x/en,)/w,}/w,)/w,//w,\/w,sum/en,_,{/w,k/en,=/w, ,1/m,}/w,^,{/w,3/m,}/w,exp/en,(/w,f/en,_,{/w,k/en,}/w,{/w,(/w,x/en,)/w,}/w,)/w,$/w,$/w,下面/f,我们/r,用/p,代码/n,来/v,实现/v,整个/b,找/v,特征/n,的/u,过程/n,，/w,大家/r,可以/v,自己/r,再/d,对照/v,代码/n,看看/v,。/w,1/m, ,#, ,定义/n,训练/vn,数据/n, ,2/m, ,train/en,_,data/en, ,=/w, ,[/w,[/w,5.1/m,,/w,3.5/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,[/w,4.9/m,,/w,3.0/m,,/w,1.4/m,,/w,0.2/m,]/w,,/w,[/w,7.0/m,,/w,3.2/m,,/w,4.7/m,,/w,1.4/m,]/w,,/w,[/w,6.4/m,,/w,3.2/m,,/w,4.5/m,,/w,1.5/m,]/w,,/w,[/w,6.3/m,,/w,3.3/m,,/w,6.0/m,,/w,2.5/m,]/w,,/w,[/w,5.8/m,,/w,2.7/m,,/w,5.1/m,,/w,1.9/m,]/w,]/w, ,3/m, ,4/m, ,#, ,定义/n,label/en, ,5/m, ,label/en,_,data/en, ,=/w, ,[/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w,,/w,[/w,1/m,,/w,0/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,1/m,,/w,0/m,]/w,,/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w,,/w,[/w,0/m,,/w,0/m,,/w,1/m,]/w,]/w, ,6/m, ,#, ,index/en, ,表示/v,的/u,第几/nw,类/q, ,7/m, ,def/en, ,findbestlossandsplit/en,(/w,train/en,_,data/en,,/w,label/en,_,data/en,,/w,index/en,)/w,:/w, ,8/m, ,sample/en,_,numbers/en, ,=/w, ,len/en,(/w,label/en,_,data/en,)/w, ,9/m, ,feature/en,_,numbers/en, ,=/w, ,len/en,(/w,train/en,_,data/en,[/w,0/m,]/w,)/w, ,10/m, ,current/en,_,label/en, ,=/w, ,[/w,]/w, ,11/m, ,12/m, ,#, ,define/en, ,the/en, ,minloss/en, ,13/m, ,minloss/en, ,=/w, ,10000000/m, ,14/m, ,15/m, ,#, ,feature/en, ,represents/en, ,the/en, ,dimensions/en, ,of/en, ,the/en, ,feature/en, ,16/m, ,feature/en, ,=/w, ,0/m, ,17/m, ,18/m, ,#, ,split/en, ,represents/en, ,the/en, ,detail/en, ,split/en, ,value/en, ,19/m, ,split/en, ,=/w, ,0/m, ,20/m, ,21/m, ,#, ,get/en, ,current/en, ,label/en, ,22/m, ,for/en, ,label/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,label/en,_,data/en,)/w,)/w,:/w, ,23/m, ,current/en,_,label/en,./w,append/en,(/w,label/en,_,data/en,[/w,label/en,_,index/en,]/w,[/w,index/en,]/w,)/w, ,24/m, ,25/m, ,#, ,trans/en, ,all/en, ,features/en, ,26/m, ,for/en, ,feature/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,feature/en,_,numbers/en,)/w,:/w, ,27/m, ,#,#, ,current/en, ,feature/en, ,value/en, ,28/m, ,current/en,_,value/en, ,=/w, ,[/w,]/w, ,29/m, ,30/m, ,for/en, ,sample/en,_,index/en, ,in/en, ,range/en,(/w,0/m,,/w,sample/en,_,numbers/en,)/w,:/w, ,31/m, ,current/en,_,value/en,./w,append/en,(/w,train/en,_,data/en,[/w,sample/en,_,index/en,]/w,[/w,feature/en,_,index/en,]/w,)/w, ,32/m, ,l/en, ,=/w, ,0/m, ,33/m, ,#,#, ,different/en, ,split/en, ,value/en, ,34/m, ,print/en, ,current/en,_,value/en, ,35/m, ,for/en, ,index/en, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,current/en,_,value/en,)/w,)/w,:/w, ,36/m, ,r/en,1/m, ,=/w, ,[/w,]/w, ,37/m, ,r/en,2/m, ,=/w, ,[/w,]/w, ,38/m, ,y/en,1/m, ,=/w, ,0/m, ,39/m, ,y/en,2/m, ,=/w, ,0/m, ,40/m, ,41/m, ,for/en, ,index/en,_,1/m, ,in/en, ,range/en,(/w,0/m,,/w,len/en,(/w,current/en,_,value/en,)/w,)/w,:/w, ,42/m, ,if/en, ,current/en,_,value/en,[/w,index/en,_,1/m,]/w, ,</w, ,current/en,_,value/en,[/w,index/en,]/w,:/w, ,43/m, ,r/en,1/m,./w,append/en,(/w,index/en,_,1/m,)/w, ,44/m, ,else/en,:/w, ,45/m, ,r/en,2/m,./w,append/en,(/w,index/en,_,1/m,)/w, ,46/m, ,47/m, ,#,#, ,calculate/en, ,the/en, ,samples/en, ,for/en, ,first/en, ,class/en, ,48/m, ,sum/en,_,y/en, ,=/w, ,0/m, ,49/m, ,for/en, ,index/en,_,r/e