boosting/en,方法/n,实际上/d,是/v,采用/v,加法/n,模型/n,与/p,前/f,向/p,分布/v,算法/n,。/w,在/p,上/f,一篇/mq,提到/v,的/u,adaboost/en,算法/n,也/d,可以/v,用/p,加法/n,模型/n,和/c,前/f,向/p,分布/v,算法/n,来/v,表示/v,。/w,以/p,决策/n,树/v,为/p,基学习器/nw,的/u,提升/v,方法/n,称为/v,提升/v,树/v,（/w,boosting/en, ,tree/en,）/w,。/w,对/p,分类/vn,问题/n,决策/n,树/v,是/v,cart/en,分类/vn,树/v,，/w,对/p,回归/v,问题/n,决策/n,树/v,是/v,cart/en,回归/v,树/v,。/w,1/m,、/w,前/f,向/p,分布/v,算法/n,引入/v,加法/n,模型/n,在/p,给/p,定/v,了/u,训练/vn,数据/n,和/c,损失/n,函数/n,$/w,l/en,(/w,y/en,,/w, ,f/en,(/w,x/en,)/w,)/w,$/w, ,的/u,条件/n,下/f,，/w,可以/v,通过/p,损失/n,函数/n,最小化/nw,来/v,学习/v,加法/n,模型/n,然而/c,对于/p,这个/r,问题/n,是/v,个/q,很/d,复杂/a,的/u,优化/v,问题/n,，/w,而且/c,要/v,训练/vn,的/u,参数/n,非常/d,的/u,多/a,，/w,前/f,向/p,分布/v,算法/n,的/u,提出/v,就是/d,为了/p,解决/v,模型/n,的/u,优化/v,问题/n,，/w,其/r,核心/n,思想/n,是/v,因为/c,加法/n,模型/n,是/v,由/p,多/a,各/r,模型/n,相加/v,在/p,一起/s,的/u,，/w,而且/c,在/p,boosting/en,中/f,模型/n,之间/f,又/d,是/v,有/v,先后/d,顺序/n,的/u,，/w,因此/c,可以/v,在/p,执行/v,每/r,一步/mq,加法/n,的/u,时候/n,对/p,模型/n,进行/v,优化/v,，/w,那么/r,每/r,一步/mq,只/d,需要/v,学习/v,一个/m,模型/n,和/c,一个/m,参数/n,，/w,通过/p,这种/r,方式/n,来/v,逐步/d,逼近/v,全局/n,最/d,优/ag,，/w,每/r,一步/mq,优化/v,的/u,损失/n,函数/n,：/w,具体/a,算法/n,流程/n,如下/v,：/w,1/m,）/w,初始化/v,$/w,f/en,_,0/m,(/w,x/en,)/w, ,=/w, ,0/m,$/w,；/w,2/m,）/w,第/m,m/en,次/q,迭代/vn,时/ng,，/w,极/d,小化/nr,损失/n,函数/n,3/m,）/w,更新/v,模型/n,，/w,则/d,$/w,f/en,_,m/en, ,(/w,x/en,)/w,$/w,：/w,4/m,）/w,得到/v,最终/d,的/u,加法/n,模型/n,adaboost/en,算法/n,也/d,可以/v,用/p,前/f,向/p,分布/v,算法/n,来/v,描述/v,，/w,在/p,这里/r,输入/v,的/u,数据集/nw,是/v,带/v,有/v,权/n,重/a,分布/v,的/u,数据集/nw,，/w,损失/n,函数/n,是/v,指数/n,损失/n,函数/n,。/w,2/m,、/w,gbdt/en,算法/n,gbdt/en,是/v,梯度/n,提升/v,决策/n,树/v,（/w,gradient/en, ,boosting/en, ,decision/en, ,tree/en,）/w,的/u,简称/v,，/w,gbdt/en,可以/v,说/v,是/v,最/d,好/a,的/u,机器/n,学习/v,算法/n,之一/r,。/w,gbdt/en,分类/vn,和/c,回归/v,时/ng,的/u,基学习器/nw,都/d,是/v,cart/en,回归/v,树/v,，/w,因为/c,是/v,拟合/nz,残差/nw,的/u,。/w,gbdt/en,和/c,adaboost/en,一样/u,可以/v,用/p,前/f,向/p,分布/v,算法/n,来/v,描述/v,，/w,不同/a,之/u,处/n,在于/v,adaboost/en,算法/n,每次/r,拟/v,合基/nw,学习器/nw,时/ng,，/w,输入/v,的/u,样本/n,数据/n,是/v,不/d,一样/u,的/u,（/w,每/r,一轮/mq,迭代/vn,时/ng,的/u,样本/n,权/n,重/a,不/d,一致/a,）/w,，/w,因为/c,adaboost/en,旨在/v,重点/n,关注/v,上/f,一轮/mq,分类/vn,错误/n,的/u,样本/n,，/w,gbdt/en,算法/n,在/p,每/r,一步/mq,迭代/vn,时/ng,是/v,输出/v,的/u,值/n,不/d,一样/u,，/w,本轮/r,要/v,拟合/nz,的/u,输出值/nw,是/v,之前/f,的/u,加法/n,模型/n,的/u,预测值/n,和/c,真实/a,值/n,的/u,差值/n,（/w,模型/n,的/u,残差/nw,，/w,也/d,称为/v,损失/n,）/w,。/w,用于/v,一个/m,简单/a,的/u,例子/n,来/v,说明/v,gbdt/en,，/w,假如/c,某人/r,的/u,年龄/n,为/p,30岁/mq,，/w,第一/m,次/q,用/p,20岁/mq,去/v,拟合/nz,，/w,发现/v,损失/n,还有/v,10岁/mq,，/w,第二/m,次/q,用/p,6岁/mq,去/v,拟合/nz,10岁/mq,，/w,发现/v,损失/n,还有/v,4岁/mq,，/w,第三/nw,次/q,用/p,3岁/mq,去/v,拟合/nz,4岁/mq,，/w,依次/d,下去/v,直到/v,损失/n,在/p,我们/r,可/v,接受/v,范围/n,内/f,。/w,以/p,平方/q,误差/n,损失/n,函数/n,的/u,回归/v,问题/n,为/p,例/n,，/w,来/v,看看/v,以/p,损失/n,来/v,拟合/nz,是/v,个/q,什么/r,样子/n,，/w,采用/v,前/f,向/p,分布/v,算法/n,：/w,在/p,第/m,$/w,m/en,$/w,次/q,迭代/vn,时/ng,，/w,我们/r,要/v,优化/v,的/u,损失/n,函数/n,：/w,此时/r,我们/r,采用/v,平方/q,误差/n,损失/n,函数/n,为/p,例/n,：/w,则/d,上面/f,损失/n,函数/n,变为/v,：/w,问题/n,就/d,成/v,了/u,对/p,残差/nw,r/en,的/u,拟合/nz,了/u,然而/c,对于/p,大多数/m,损失/n,函数/n,，/w,却/d,没/d,那么/r,容易/a,直接/ad,获得/v,模型/n,的/u,残差/nw,，/w,针对/p,该/r,问题/n,，/w,大神/nz,freidman/en,提出/v,了/u,用/p,损失/n,函数/n,的/u,负/v,梯度/n,来/v,拟合/nz,本轮/r,损失/n,的/u,近似值/n,，/w,拟合/nz,一个/m,回归/v,树/v,关于/p,gbdt/en,一般/a,损失/n,函数/n,的/u,具体/a,算法/n,流程/n,如下/v,：/w,1/m,）/w,初始化/v,$/w,f/en,_,0/m,(/w,x/en,)/w,$/w,：/w,2/m,）/w,第/m,$/w,m/en,$/w,次/q,迭代/vn,时/ng,，/w,计算/v,当前/t,要/v,拟合/nz,的/u,残差/nw,$/w,r/en,_,{/w,mi/en,}/w,$/w,：/w,以/p,$/w,r/en,_,{/w,mi/en,}/w,$/w,为/p,输出值/nw,，/w,对/p,$/w,r/en,_,{/w,mi/en,}/w,$/w,拟合/nz,一个/m,回归/v,树/v,（/w,此时/r,只是/d,确定/v,了/u,树/v,的/u,结构/n,，/w,但是/c,还/d,未/d,确定/v,叶子/n,节点/n,中/f,的/u,输出值/nw,）/w,，/w,然后/c,通过/p,最小化/nw,当前/t,的/u,损失/n,函数/n,，/w,并/c,求得/v,每个/r,叶子/n,节点/n,中/f,的/u,输出值/nw,$/w,c/en,_,{/w,mj/en,}/w,$/w,，/w,$/w,j/en,$/w,表示/v,第/m,$/w,j/en,$/w,个/q,叶子/n,节点/n,更新/v,当前/t,的/u,模型/n,$/w,f/en,_,m/en,(/w,x/en,)/w,$/w,为/p,：/w,3/m,）/w,依次/d,迭代/vn,到/v,我们/r,设定/v,的/u,基学习器/nw,的/u,个数/n,$/w,m/en,$/w,，/w,得到/v,最终/d,的/u,模型/n,，/w,其中/r,$/w,m/en,$/w,表示/v,基学习器/nw,的/u,个数/n,，/w,$/w,j/en,$/w,表示/v,叶子/n,节点/n,的/u,个数/n,gbdt/en,算法/n,提供/v,了/u,众多/m,的/u,可/v,选择/v,的/u,损失/n,函数/n,，/w,通过/p,选择/v,不同/a,的/u,损失/n,函数/n,可以/v,用/p,来/v,处理/v,分类/vn,、/w,回归/v,问题/n,，/w,比如/v,用/p,对数/n,似然/nw,损失/n,函数/n,就/d,可以/v,处理/v,分类/vn,问题/n,。/w,大概/d,的/u,总结/v,下/f,常用/a,的/u,损失/n,函数/n,：/w,1/m,）/w,对于/p,分类/vn,问题/n,可以/v,选用/v,指数/n,损失/n,函数/n,、/w,对数/n,损失/n,函数/n,。/w,2/m,）/w,对于/p,回归/v,问题/n,可以/v,选用/v,均/d,方差/nr,损失/n,函数/n,、/w,绝对/d,损失/n,函数/n,。/w,3/m,）/w,另外/c,还有/v,huber/en,损失/n,函数/n,和/c,分位/nw,数/m,损失/n,函数/n,，/w,也/d,是/v,用于/v,回归/v,问题/n,，/w,可以/v,增加/v,回归/v,问题/n,的/u,健壮性/nw,，/w,可以/v,减少/v,异常/a,点/q,对/p,损失/n,函数/n,的/u,影响/vn,。/w,3/m,、/w,gbdt/en,的/u,正则化/nw,在/p,adaboost/en,中/f,我们/r,会/v,对/p,每个/r,模型/n,乘/v,上/f,一个/m,弱化/v,系数/n,（/w,正则化/nw,系数/n,）/w,，/w,减小/v,每个/r,模型/n,对/p,提升/v,的/u,贡献/n,（/w,注意/v,：/w,这个/r,系数/n,和/c,模型/n,的/u,权重/nz,不/d,一样/u,，/w,是/v,在/p,权/n,重/a,上/f,又/d,乘/v,以/p,一个/m,0/m,,/w,1/m,之间/f,的/u,小数/n,）/w,，/w,在/p,gbdt/en,中/f,我们/r,采用/v,同样/d,的/u,策略/n,，/w,对于/p,每个/r,模型/n,乘/v,以/p,一个/m,系数/n,λ, ,(/w,0/m, ,</w, ,λ, ,≤/w, ,1/m,)/w,，/w,降低/v,每个/r,模型/n,对/p,拟合/nz,损失/n,的/u,贡献/n,，/w,这种/r,方法/n,也/d,意味/n,着/u,我们/r,需要/v,更/d,多/a,的/u,基学习器/nw,。/w,第二/m,种/q,是/v,每次/r,通过/p,按/p,比例/n,（/w,推荐/v,[/w,0.5/m,,/w, ,0.8/m,]/w, ,之间/f,）/w,随机/d,抽取/vn,部分/n,样/q,本来/d,训练/vn,模型/n,，/w,这种/r,方法/n,有点/d,类似/v,bagging/en,，/w,可以/v,减小/v,方差/nr,，/w,但/c,同样/d,会/v,增加/v,模型/n,的/u,偏差/n,，/w,可/v,采用/v,交叉/vn,验证/vn,选取/v,，/w,这种/r,方式/n,称为/v,子/ng,采样/v,。/w,采用/v,子/ng,采样/v,的/u,gbdt/en,有时/d,也/d,称为/v,随机/d,梯度/n,提升/v,树/v,（/w,sgbt/en,）/w,。/w,第三/nw,种/q,就/d,是/v,控制/v,基学习器/nw,cart/en,树/v,的/u,复杂度/nw,，/w,可以/v,采用/v,剪枝正则化/nw,。/w,4/m,、/w,gbdt/en,的/u,优缺点/n,gbdt/en,的/u,主要/b,优点/n,：/w,1/m,）/w,可以/v,灵活/a,的/u,处理/v,各种/r,类型/n,的/u,数据/n,2/m,）/w,预测/v,的/u,准确率/n,高/a,3/m,）/w,使用/v,了/u,一些/m,健壮/a,的/u,损失/n,函数/n,，/w,如/v,huber/en,，/w,可以/v,很/d,好/a,的/u,处理/v,异常/a,值/n,gbdt/en,的/u,缺点/n,：/w,1/m,）/w,由于/c,基学习器/nw,之间/f,的/u,依赖/v,关系/n,，/w,难以/d,并/c,行化/nw,处理/v,，/w,不过/c,可以/v,通过/p,子/ng,采样/v,的/u,sgbt/en,来/v,实现/v,部分/n,并行/v,。/w,5/m,、/w,xgboost/en,算法/n,事实上/l,对于/p,树/v,模型/n,为/p,基学习器/nw,的/u,集成/vn,方法/n,在/p,建模/vn,过程/n,中/f,可以/v,分为/v,两个/m,步骤/n,：/w,一/m,是/v,确定/v,树/v,模型/n,的/u,结构/n,，/w,二/m,是/v,确定/v,树/v,模型/n,的/u,叶子/n,节点/n,中/f,的/u,输出值/nw,。/w,5.1/m, ,定义/n,树/v,的/u,复杂度/nw,首先/d,把/p,树/v,拆/v,分/q,成/v,结构/n,部分/n,$/w,q/en,$/w,和/c,叶子/n,节点/n,输出值/nw,$/w,w/en,$/w,，/w,在/p,这里/r,$/w,w/en,$/w,是/v,一个/m,向量/n,，/w,表示/v,各/r,叶子/n,节点/n,中/f,的/u,输出值/nw,。/w,在/p,这里/r,就/d,囊括/v,了/u,上面/f,提到/v,的/u,两点/mq,，/w,确定/v,树/v,结构/n,$/w,q/en,$/w,和/c,叶子结点/nt,的/u,输出值/nw,$/w,w/en,$/w,。/w,从/p,下/f,图/n,中/f,可以/v,看出/v,，/w,$/w,q/en,(/w,x/en,)/w,$/w,实际上/d,是/v,确定/v,输入值/nw,最终/d,会/v,落/v,到/v,哪个/r,叶子/n,节点/n,上/f,，/w,而/c,$/w,w/en,$/w,将/d,会/v,给/p,出/v,相应/v,的/u,输出值/nw,。/w,具体/a,表现/v,示例/n,如下/v,，/w,引入/v,正则化/nw,项/q, ,$/w,\/w,omega/en, ,(/w,f/en,_,t/en,)/w,$/w,来/v,控制/v,树/v,的/u,复杂度/nw,，/w,从而/c,实现/v,有效/a,的/u,控制/v,模型/n,的/u,过/u,拟合/nz,，/w,这/r,是/v,xgboost/en,中/f,的/u,第一/m,个/q,重要/a,点/q,。/w,式子/n,中/f,的/u,$/w,t/en,$/w,为/p,叶子/n,节点/n,数/m,5.2/m, ,xgboost/en,中/f,的/u,boosting/en, ,tree/en,模型/n,和/c,gbdt/en,方法/n,一样/u,，/w,xgboost/en,的/u,提升/v,模型/n,也/d,是/v,采用/v,残差/nw,，/w,不同/a,的/u,是/v,分裂/v,结点/nw,选取/v,的/u,时候/n,不/d,一定/d,是/v,最/d,小/a,平方/q,损失/n,，/w,其/r,损失/n,函数/n,如下/v,，/w,较/d,gbdt/en,其/r,根据/p,树/v,模型/n,的/u,复杂度/nw,加入/v,了/u,一项/mq,正则化/nw,项/q,：/w,5.3/m, ,对/p,目标/n,函数/n,进行/v,改写/v,上面/f,的/u,式子/n,是/v,通过/p,泰勒/nr,展开式/nw,将/d,损失/n,函数/n,展开/v,为/p,具有/v,二/m,阶导/nw,的/u,平方函数/nw,。/w,在/p,gbdt/en,中/f,我们/r,通过/p,求/v,损失/n,函数/n,的/u,负/v,梯度/n,（/w,一/m,阶导/nw,数/m,）/w,，/w,利用/v,负/v,梯度/n,替代/v,残差/nw,来/v,拟合/nz,树/v,模型/n,。/w,在/p,xgboost/en,中/f,直接/ad,用/p,泰勒/nr,展开式/nw,将/d,损失/n,函数/n,展开/v,成/v,二项/mq,式/k,函数/n,（/w,前提/n,是/v,损失/n,函数/n,一阶/nw,、/w,二阶/nr,都/d,连续/a,可导/nw,，/w,而且/c,在/p,这里/r,计算/v,一/m,阶导/nw,和/c,二/m,阶导/nw,时/ng,可以/v,并行/v,计算/v,）/w,，/w,假设/v,此时/r,我们/r,定义/n,好/a,了/u,树/v,的/u,结构/n,（/w,在/p,后面/f,介绍/v,，/w,和/c,gbdt/en,中/f,直接/ad,用/p,残差/nw,拟合/nz,不同/a,）/w,，/w,假设/v,我们/r,的/u,叶节点/nr,区域/n,为/p,：/w,上面/f,式子/n,中/f,$/w,i/en,$/w,代表/n,样本/n,$/w,i/en,$/w,，/w,$/w,j/en,$/w,代表/n,叶子/n,节点/n,$/w,j/en,$/w,。/w,则/d,我们/r,的/u,目标/n,优化/v,函数/n,可以/v,转换/v,成/v,（/w,因为/c,$/w,l/en,(/w,y/en,_,i/en,,/w, ,y/en,_,i/en,^,{/w,t/en,-/w,1/m,}/w,)/w,$/w,是/v,个/q,已经/d,确定/v,的/u,常数/n,，/w,可以/v,舍/v,去/v,）/w,：/w,上面/f,式子/n,把/p,样本/n,都/d,合并/v,到/v,叶子/n,节点/n,中/f,了/u,。/w,此时/r,我们/r,对/p,$/w,w/en,_,j/en,$/w,求导/nw,并/c,令/v,导数/n,为/p,0/m,，/w,可得/v,：/w,其中/r, ,$/w, ,g/en,_,j/en, ,=/w, ,\/w,sum/en,_,{/w,i/en, ,\/w,in/en, ,i/en,_,j/en,}/w, ,g/en,_,i/en,,/w, , ,h/en,_,j/en, ,=/w, ,\/w,sum/en,_,{/w,i/en, ,\/w,in/en, ,t/en,_,j/en,}/w, ,h/en,_,j/en, ,$/w,。/w,5.4/m, ,树结构/n,的/u,打分/v,函数/n,上面/f,的/u,obj/en,值/n,代表/n,当/p,指定/v,一个/m,树/v