一/m, ,引言/n,本/r,程序/n,是/v,一个/m,完整/a,的/u,机器/n,学习/v,过程/n,，/w,先/d,编写/v,基于/p,python/en,的/u,爬虫/n,脚本/n,，/w,爬/v,取/v,目标/n,论坛/n,网站/n,的/u,评论/n,到/v,本地/r,存储/vn,，/w,然后/c,使用/v,贝叶斯/nr,分类/vn,模型/n,对/p,评论/n,进行/v,分类/vn,，/w,预测/v,新/a, ,的/u,评论/n,是否/v,为/p,垃圾/n,评论/n,。/w,如果/c,遇到/v,大数据量/nw,的/u,问题/n,，/w,可以/v,把/p,贝叶斯算法/nw,写/v,成/v,mapreduce/en,模式/n,，/w,map/en,负责/v,把/p,数据集/nw,划分/v,成/v,键值/nr,对/p,格式/n,，/w,类/q,序号/n,为/p,key/en,，/w,属/v, ,性/ng,向量/n,为/p,value/en,，/w,reduce/en,进行/v,汇总/v,每/r,类/q,的/u,先验/n,概率/n,和/c,条件/n,概率/n,，/w,主/n,server/en,汇总/v,所有/b,类/q,的/u,统计量/nw,。/w,二/m, ,爬虫/n,脚本/n,1/m, ,编写/v,爬虫/n,脚本/n,，/w,爬/v,取/v,目标/n,论坛/n,的/u,评论/n,。/w,其中/r,，/w,headers/en,是/v,必须/d,的/u,，/w,因为/c,我们/r,需要/v,伪装/v,成/v,浏览器/n,在/p,访问/v,论坛/n,的/u,服务器/n,。/w,使用/v,requests/en,包/v,获取/v,指定/v,url/en,的/u,数据流/n,。/w,mport/en, ,requests/en, ,from/en, ,bs/en,4/m, ,import/en, ,beautifulsoup/en, ,import/en, ,re/en, ,import/en, ,json/en, ,import/en, ,time/en, ,headers/en, ,=/w, ,{/w, ,'/w,accept/en,'/w,:/w, ,'/w,text/en,//w,html/en,,/w,application/en,//w,xhtml/en,+/w,xml/en,,/w,application/en,//w,xml/en,;/w,q/en,=/w,0.9/m,,/w,*/w,//w,*/w,;/w,q/en,=/w,0.8/m,'/w,,/w, ,'/w,accept/en,-/w,language/en,'/w,:/w, ,'/w,zh/en,-/w,cn/en,,/w,zh/en,;/w,q/en,=/w,0.8/m,,/w,en/en,-/w,us/en,;/w,q/en,=/w,0.5/m,,/w,en/en,;/w,q/en,=/w,0.3/m,'/w,,/w, ,'/w,accept/en,-/w,encoding/en,'/w,:/w, ,'/w,gzip/en,,/w, ,deflate/en,,/w, ,br/en,'/w,,/w, ,'/w,connection/en,'/w,:/w, ,'/w,keep/en,-/w,alive/en,'/w,,/w, ,'/w,cookie/en,'/w,:/w, ,'/w,_,_,cfduid/en,=/w,d/en,653/m,bf/en,931/m,cbde/en,10/m,f/en,9243/m,b/en,63/m,e/en,991/m,f/en,70/m,dc/en,41466778585/m,;/w, ,loid/en,=/w,a/en,5/m,wunhrhllekl/en,9/m,ossr/en,;/w, ,loidcreated/en,=/w,2016/m,-/w,06/m,-/w,24/m,t/en,14%/mq,3/m,a/en,29%/mq,3/m,a/en,45.413/m,z/en,;/w, ,_,recent/en,_,srs/en,=/w,t/en,5/m,_,2/m,qu/en,49/m,;/w, ,_,ga/en,=/w,ga/en,1/m,./w,2/m,./w,54465388/m,./w,1466778724/m,;/w, ,pc/en,=/w,ne/en,;/w, ,_,_,utma/en,=/w,55650728/m,./w,54465388/m,./w,1466778724/m,./w,1466778728/m,./w,1466843492/m,./w,2/m,;/w, ,_,_,utmz/en,=/w,55650728/m,./w,1466778728/m,./w,1/m,./w,1/m,./w,utmcsr/en,=/w,(/w,direct/en,)/w,|/w,utmccn/en,=/w,(/w,direct/en,)/w,|/w,utmcmd/en,=/w,(/w,none/en,)/w,;/w, ,_,_,utmb/en,=/w,55650728/m,./w,0/m,./w,10/m,./w,1466843492/m,;/w, ,_,_,utmc/en,=/w,55650728/m,'/w,,/w, ,'/w,host/en,'/w,:/w, ,'/w,www/en,./w,reddit/en,./w,com/en,'/w,,/w, ,'/w,user/en,-/w,agent/en,'/w,:/w, ,'/w,mozilla/en,//w,5.0/m, ,(/w,windows/en, ,nt/en, ,10.0/m,;/w, ,wow/en,64/m,;/w, ,rv/en,:/w,47.0/m,)/w, ,gecko/en,//w,20100101/m, ,firefox/en,//w,47.0/m,'/w,,/w, ,}/w, ,url/en, ,=/w, ,'/w,https/en,:/w,//w,//w,www/en,./w,reddit/en,./w,com/en,//w,r/en,//w,askreddit/en,//w,comments/en,//w,4/m,qfh/en,01/m,//w,what/en,_,are/en,_,some/en,_,classes/en,_,you/en,_,must/en,_,take/en,_,in/en,//w,'/w, ,r/en, ,=/w, ,requests/en,./w,get/en,(/w,url/en,,/w,headers/en,=/w,headers/en,)/w, ,r/en,./w,encoding/en, ,=/w, ,r/en,./w,apparent/en,_,encoding/en,2/m, ,使用/v,beautifulsoup/en,解析/v,爬/v,去/v,的/u,html/en,文件/n,，/w,css/en,定位/vn,我们/r,需要/v,的/u,字段/n,，/w,输出/v,到/v,本地/r,文件/n,comments/en,./w,txt/en,保存/v,即可/v,。/w,soup/en, ,=/w, ,beautifulsoup/en,(/w,r/en,./w,text/en,)/w, ,res/en, ,=/w, ,soup/en,./w,select/en,(/w,"/w,div/en,./w,md/en,"/w,)/w, ,comments/en, ,=/w, ,[/w,]/w, ,for/en, ,item/en,1/m, ,in/en, ,res/en,[/w,1/m,:/w,]/w,:/w, ,comments/en,./w,append/en,(/w,item/en,1/m,./w,contents/en,)/w, ,print/en, ,comments/en, ,fd/en, ,=/w, ,open/en,(/w,'/w,comments/en,./w,txt/en,'/w,,/w,'/w,w/en,+/w,'/w,)/w, ,p/en,_,soup/en, ,=/w, ,beautifulsoup/en,(/w,str/en,(/w,comments/en,)/w,)/w, ,res/en,2/m, ,=/w, ,p/en,_,soup/en,./w,findall/en,(/w,'/w,p/en,'/w,)/w, ,for/en, ,item/en,2/m, ,in/en, ,res/en,2/m,:/w, ,ct/en, ,=/w, ,str/en,(/w,item/en,2/m,./w,contents/en,)/w,./w,encode/en,(/w,'/w,utf/en,-/w,8/m,'/w,)/w, ,print/en, ,ct/en,[/w,3/m,:/w,-/w,2/m,]/w, ,fd/en,./w,write/en,(/w,ct/en,[/w,3/m,:/w,-/w,2/m,]/w, ,+/w, ,'/w,\/w,n/en,'/w,)/w, ,fd/en,./w,close/en,(/w,)/w,三/m, ,实战/n,1/m, ,-/w,文本/n,分类/vn,（/w,应用/vn,过滤/v,恶意/n,留言/v,等/u,）/w,下面/f,是/v,二/m,分类/vn,问题/n,，/w,文档/n,只能/v,属于/v,0/m,和/c,1两/mq,个/q,类别/n,，/w,1/m, ,载入/v,数据集/nw,：/w,本地/r,读/v,取/v,文件/n,comments/en,./w,txt/en,中/f,爬/v,虫/n,爬/v,取/v,的/u,评论/n,。/w,from/en, ,numpy/en, ,import/en, ,*/w,def/en, ,loaddataset/en,(/w,)/w,:/w,fd/en, ,=/w, ,open/en,(/w,'/w,comments/en,./w,txt/en,'/w,)/w,postinglist/en, ,=/w, ,[/w,]/w,classvec/en, ,=/w, ,[/w,]/w,for/en, ,line/en, ,in/en, ,fd/en,./w,readlines/en,(/w,)/w,:/w,tmp/en, ,=/w, ,line/en,./w,split/en,(/w,)/w,postinglist/en,./w,append/en,(/w,tmp/en,[/w,1/m,:/w,]/w,)/w,classvec/en,./w,append/en,(/w,int/en,(/w,tmp/en,[/w,0/m,]/w,)/w,)/w,return/en, ,postinglist/en,,/w,classvec/en,2/m, ,创建/v,词汇表/n,：/w,利用/v,集合/v,结构/n,内/f,元素/n,的/u,唯一性/n,，/w,创建/v,一个/m,包含/v,所有/b,词汇/n,的/u,词表/n,。/w,def/en, ,createvocablist/en,(/w,dataset/en,)/w,:/w,vocabset/en, ,=/w, ,set/en,(/w,[/w,]/w,)/w, , ,#,create/en, ,empty/en, ,setfor/en, ,document/en, ,in/en, ,dataset/en,:/w,vocabset/en, ,=/w, ,vocabset/en, ,|/w, ,set/en,(/w,document/en,)/w, ,#,union/en, ,of/en, ,the/en, ,two/en, ,setsreturn/en, ,list/en,(/w,vocabset/en,)/w,3/m, ,把/p,输入/v,文本/n,根据/p,词表/n,转化/v,为/p,计算机/n,可/v,处理/v,的/u,01/m,向/p,量/n,形式/n,：/w,eq/en,，/w,测试/vn,文本/n,1/m,：/w, ,[/w,'/w,love/en,'/w,,/w, ,'/w,my/en,'/w,,/w, ,'/w,dalmation/en,'/w,]/w,词汇表/n,：/w,[/w,'/w,cute/en,'/w,,/w, ,'/w,love/en,'/w,,/w, ,'/w,help/en,'/w,,/w, ,'/w,garbage/en,'/w,,/w, ,'/w,quit/en,'/w,,/w, ,'/w,i/en,'/w,,/w, ,'/w,problems/en,'/w,,/w, ,'/w,is/en,'/w,,/w, ,'/w,park/en,'/w,,/w, ,'/w,stop/en,'/w,,/w, ,'/w,flea/en,'/w,,/w, ,'/w,dalmation/en,'/w,,/w, ,'/w,licks/en,'/w,,/w, ,'/w,food/en,'/w,,/w, ,'/w,not/en,'/w,,/w, ,'/w,him/en,'/w,,/w, ,'/w,buying/en,'/w,,/w, ,'/w,posting/en,'/w,,/w, ,'/w,has/en,'/w,,/w, ,'/w,worthless/en,'/w,,/w, ,'/w,ate/en,'/w,,/w, ,'/w,to/en,'/w,,/w, ,'/w,maybe/en,'/w,,/w, ,'/w,please/en,'/w,,/w, ,'/w,dog/en,'/w,,/w, ,'/w,how/en,'/w,,/w, ,'/w,stupid/en,'/w,,/w, ,'/w,so/en,'/w,,/w, ,'/w,take/en,'/w,,/w, ,'/w,mr/en,'/w,,/w, ,'/w,steak/en,'/w,,/w, ,'/w,my/en,'/w,]/w,向/p,量化/v,结果/n,：/w,[/w,0/m, ,1/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,1/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,0/m, ,1/m,]/w,def/en, ,setofwords/en,2/m,vec/en,(/w,vocablist/en,,/w, ,inputset/en,)/w,:/w,returnvec/en, ,=/w, ,[/w,0/m,]/w,*/w,len/en,(/w,vocablist/en,)/w,for/en, ,word/en, ,in/en, ,inputset/en,:/w,if/en, ,word/en, ,in/en, ,vocablist/en,:/w,returnvec/en,[/w,vocablist/en,./w,index/en,(/w,word/en,)/w,]/w, ,=/w, ,1/m,else/en,:/w, ,print/en, ,"/w,the/en, ,word/en,:/w, ,%/w,s/en, ,is/en, ,not/en, ,in/en, ,my/en, ,vocabulary/en,!/w,"/w, ,%/w, ,wordreturn/en, ,returnvec/en,4/m,训练/vn,模型/n,：/w,在/p,训练/vn,样本/n,中/f,计算/v,先验/n,概率/n, ,p/en,(/w,ci/en,)/w, ,和/c, ,条件/n,概率/n, ,p/en,(/w,x/en,,/w,y/en, ,|/w, ,ci/en,)/w,，/w,本/r,实例/n,有/v,0/m,和/c,1两/mq,个/q,类别/n,，/w,所以/c,返回/v,p/en,(/w,x/en,,/w,y/en, ,|/w, ,0/m,)/w,，/w,p/en,(/w,x/en,,/w,y/en, ,|/w, ,1/m,)/w,和/c,p/en,(/w,ci/en,)/w,。/w,此处/s,有/v,两个/m,改进/v,的/u,地方/n,：/w,（/w,1/m,）/w,若/c,有/v,的/u,类别/n,没有/v,出现/v,，/w,其/r,概率/n,就/d,是/v,0/m,，/w,会/v,十分/d,影响/vn,分类器/nw,的/u,性能/n,。/w,所以/c,采取/v,各/r,类别/n,默认/v,1次/mq,累加/v,，/w,总/b,类别/n,（/w,两类/mq,）/w,次数/n,2/m,，/w,这样/r,不/d,影响/vn,相对/d,大小/n,。/w,（/w,2/m,）/w,若/c,很/d,小/a,是/v,数字/n,相乘/v,，/w,则/d,结果/n,会/v,更/d,小/a,，/w,再/d,四舍/mq,五/m,入/v,存在/v,误差/n,，/w,而且/c,会/v,造成/v,下/f,溢/v,出/v,。/w,采取/v,取/v,log/en,，/w,乘法/n,变为/v,加法/n,，/w,并且/c,相对/d,大小/n,趋势/n,不/d,变/v,。/w,def/en, ,trainnb/en,0/m,(/w,trainmatrix/en,,/w,traincategory/en,)/w,:/w,numtraindocs/en, ,=/w, ,len/en,(/w,trainmatrix/en,)/w,numwords/en, ,=/w, ,len/en,(/w,trainmatrix/en,[/w,0/m,]/w,)/w,pabusive/en, ,=/w, ,sum/en,(/w,traincategory/en,)/w,//w,float/en,(/w,numtraindocs/en,)/w,p/en,0/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w,;/w, ,p/en,1/m,num/en, ,=/w, ,ones/en,(/w,numwords/en,)/w, , , , , , ,#,change/en, ,to/en, ,ones/en,(/w,)/w,p/en,0/m,denom/en, ,=/w, ,2.0/m,;/w, ,p/en,1/m,denom/en, ,=/w, ,2.0/m, , , , , , , , , , , , , , , , , , , , , , , , ,#,change/en, ,to/en, ,2.0/m,for/en, ,i/en, ,in/en, ,range/en,(/w,numtraindocs/en,)/w,:/w,if/en, ,traincategory/en,[/w,i/en,]/w, ,=/w,=/w, ,1/m,:/w,p/en,1/m,num/en, ,+/w,=/w, ,trainmatrix/en,[/w,i/en,]/w,p/en,1/m,denom/en, ,+/w,=/w, ,sum/en,(/w,trainmatrix/en,[/w,i/en,]/w,)/w,else/en,