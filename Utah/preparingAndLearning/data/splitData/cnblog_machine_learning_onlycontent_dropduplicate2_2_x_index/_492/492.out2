引言/n,之前/f,学习/v,了/u,逻辑/n,回归/v,，/w,主要/b,是/v,从/p,三/m,方面/n,学习/v,的/u,，/w,一个/m,是/v,coursera/en,上/f,台/q,大/a,林轩田/nr,老师/n,机器/n,学习/v,公开课/n,的/u,逻辑/n,回归/v,部分/n,，/w,一个/m,是/v,斯坦福/nr,andrew/en, ,ng/en,老师/n,机器/n,学习/v,公开课/n,的/u,逻辑/n,回归/v,部分/n,，/w,另/r,一个/m,是/v,《/w,机器/n,学习/v,实战/n,》/w,逻辑/n,回归/v,部分/n,前/f,两者/r,主要/b,是/v,对/p,逻辑/n,回归/v,理论/n,的/u,学习/v,，/w,后者/r,主要/b,是/v,实践/v,的/u,学习/v,，/w,现在/t,对/p,其/r,进行/v,整理/v,，/w,也/d,便于/v,自己/r,思考/v,。/w,本文/r,主要/b,内容/n,本文/r,主要/b,分为/v,以下/f,内容/n,：/w,首先/d,大致/d,介绍/v,了/u,逻辑/n,回归/v,的/u,分类/vn,过程/n,，/w,包括/v,常规/n,分类/vn,过程/n,中/f,的/u,计算权/nw,重/a,与/p,样本/n,特征/n,之间/f,乘积/n,得到/v,分数/n,，/w,利用/v,sigmod/en,函数/n,将/d,分数/n,转换/v,到/v,0/m,到/v,1/m,之间/f,的/u,值/n,，/w,然后/c,利用/v,这个/r,值/n,进行/v,分类/vn,然后/c,对/p,损失/n,函数/n,进行/v,了/u,分析/vn,，/w,包括/v,如何/r,利用/v,极大/a,似然/nw,得到/v,最佳/z,的/u,权重/nz,向/p,量值/nw,，/w,以及/c,梯度/n,下降/v,法/j,时/ng,权重/nz,的/u,更新/v,公式/n,再/d,然后/c,对/p,解决/v,过/u,拟合/nz,的/u,一般/a,方式/n,进行/v,了/u,一定/d,的/u,说明/v,，/w,包括/v,正规化/vn,，/w,减少/v,特征/n,最后/f,是/v,机器/n,学习/v,实战/n,的/u,代码/n,和/c,仿真/vn,实验/vn,的/u,结果/n,逻辑/n,回归/v,的/u,分类/vn,过程/n,跟/p,一般/a,的/u,分类/vn,模型/n,一样/u,，/w,分类/vn,的/u,话/n,需要/v,找/v,一个/m,合适/a,的/u,分类/vn,函数/n,，/w,台/q,大/a,机器/n,学习/v,中/f,称之为/v,h/en,函数/n,（/w,hypothesis/en,函数/n,）/w,台/q,大/a,机器/n,学习/v,课程/n,中/f,对/p,h/en,得到/v,的/u,过程/n,是/v,这样/r,讲解/v,的/u,权重/nz,w/en,与/p,样本/n,特征/n,值/n,的/u,乘积/n,得到/v,分数/n,样本/n,x/en,是/v,有/v,n/en,维/q,的/u,，/w,每/r,一维/mq,代表/n,样本/n,的/u,一个/m,特征/n,，/w,每/r,一/m,特征/n,在/p,判断/v,x/en,属于/v,哪/r,一类/mq,时/ng,所/u,占/v,的/u,权重/nz,不/d,一样/u,，/w,所以/c,首先/d,需要/v,对/p,x/en,的/u,各个/r,维度/n,(/w,即/v,特征/n,向量/n,的/u,每/r,一维/mq,)/w,加/v,权值/nw,w/en,(/w,这里/r,的/u,w/en,未知/vn,，/w,我们/r,逻辑/n,回归/v,的/u,目的/n,就/d,是/v,求/v,出/v,这个/r,w/en,权重/nz,向/p,量/n,，/w,表示/v,对/p,特征/n,向/p,量/n,每/r,一维/mq,所/u,占/v,的/u,权重/nz,)/w,算出/v,一个/m,作为/v,判断/v,分类/vn,的/u,一个/m,分数/n,s/en,,/w,s/en,的/u,计算/v,方式/n,如下/v,逻辑/n,函数/n,将/d,分数/n,转换/v,为/p,类别/n,然后/c,有/v,了/u,分数/n,s/en,，/w,就/d,需要/v,利用/v,一个/m,逻辑/n,函数/n,将/d,s/en,转换/v,为/p,0/m,到/v,1/m,的/u,值/n,，/w,0/m,,/w,1/m,也/d,就/d,是/v,分类/vn,的/u,结果/n,，/w,0/m,代表/n,负类/nw,，/w,1/m,代表/n,正/d,类/q,逻辑/n,回归/v,中/f,在/p,这/r,一步/mq,与/p,其他/r,不同/a,的/u,是/v,它/r,含/v,增加/v,了/u,一个/m,sigmod/en,函数/n,，/w,将/d,分数/n,转换/v,到/v,0/m,到/v,1/m,之间/f,的/u,一个/m,值得/v,到/v,这个/r,0/m,到/v,1/m,之间/f,的/u,值/n,θ,(/w,s/en,)/w,，/w,再/d,将/d,其/r,与/p,一个/m,阈值/n,做/v,比较/d,，/w,一般/a,是/v,0.5/m,，/w,大于/v,阈值/n,的/u,为/p,正/d,类/q,1/m,，/w,小于/v,阈值/n,的/u,为/p,负类/nw,0/m,最终/d,得到/v,分类/vn,模型/n,与/p,样本/n,特征/n,向量/n,的/u,关系/n,公式/n,如下/v,应用/vn,分类/vn,函数/n,进行/v,类别/n,判断/v,得到/v,分类/vn,模型/n,(/w,函数/n,)/w,之后/f,，/w,如果/c,想/v,知道/v,某/r,一/m,样本/n,的/u,分类/vn,结果/n,，/w,常见/a,的/u,场景/n,应用/vn,是/v,将/d,这个/r,样本/n,的/u,特征/n,向/p,量/n,作为/v,x/en,输入/v,到/v,这个/r,函数/n,，/w,得到/v,一个/m,y/en,值/n,，/w,将/d,y/en,值/n,与/p,阈值/n,做/v,比较/d,，/w,大于/v,阈值/n,的/u,为/p,正/d,，/w,小于/v,阈值/n,的/u,为/p,负/v,。/w,对/p,分类/vn,函数/n,(/w,模型/n,)/w,的/u,选取/v,需要/v,对/p,数据/n,有/v,一定/d,的/u,了解/v,或/c,分析/vn,，/w,知道/v,或者/c,猜测/vn,预测/v,函数/n,的/u,"/w,大概/d,"/w,形式/n,，/w,比如/v,是/v,线性/n,函数/n,还是/c,非线性/b,函数/n,。/w,损失/n,函数/n,要/v,怎样/r,去/v,衡量/v,输出/v,的/u,类别/n,与/p,实际/n,的/u,类别/n,之间/f,的/u,差值/n,呢/y,，/w,这/r,就/d,需要/v,构造/v,一个/m,损失/n,函数/n,，/w,该/r,函数/n,表示/v,预测/v,的/u,输出/v,（/w,h/en,）/w,与/p,训练/vn,数据/n,类别/n,（/w,y/en,）/w,之间/f,的/u,偏差/n,，/w,可以/v,是/v,二者/r,之间/f,的/u,差/a,（/w,h/en,-/w,y/en,）/w,（/w,机器/n,学习/v,实战/n,中/f,选取/v,这种/r,形式/n,）/w,，/w,也/d,可以/v,是/v,其他/r,的/u,形式/n,。/w,综合/vn,考虑/v,所有/b,训练/vn,数据/n,的/u,"/w,损失/n,"/w,，/w,将/d,cost/en,求/v,和/c,或者/c,求/v,平均/a,，/w,记/v,为/p,j/en,(/w,θ,)/w,函数/n,，/w,表示/v,所有/b,训练/vn,数据/n,预测/v,值/n,与/p,实际/n,类别/n,的/u,偏差/n,。/w,显然/ad,，/w,j/en,(/w,θ,)/w,函数/n,的/u,值/n,越/d,小/a,表示/v,预测/v,函数/n,越/d,准确/a,（/w,即/v,h/en,函数/n,越/d,准确/a,）/w,，/w,所以/c,这/r,一步/mq,需要/v,做/v,的/u,是/v,找到/v,j/en,(/w,θ,)/w,函数/n,的/u,最小值/nz,。/w,找/v,函数/n,的/u,最小值/nz,有/v,不同/a,的/u,方法/n,，/w,logistic/en, ,regression/en,实现/v,时有/d,的/u,是/v,梯度/n,下降/v,法/j,（/w,机器/n,学习/v,实战/n,中/f,用/p,了/u,梯度/n,下降/v,法/j,和/c,随机/d,梯度/n,下降/v,法/j,）/w,。/w,构造/v,损失/n,函数/n,其实/d,前面/f,的/u,分类/vn,函数/n,h/en,(/w,x/en,)/w,还有/v,一个/m,深/a,层次/n,的/u,含义/n,，/w,它/r,代表/n,了/u,样本/n,x/en,属于/v,类别/n,1/m,的/u,概率/n,andrew/en, ,ng/en,在/p,课程/n,中/f,直接/ad,给/p,出/v,了/u,cost/en,函数/n,及/c,j/en,(/w,θ,)/w,函数/n,的/u,公式/n,，/w,但是/c,并/c,没有/v,给/p,出/v,具体/a,的/u,解释/v,，/w,只是/d,说明/v,了/u,这个/r,函数/n,来/v,衡量/v,h/en,函数/n,预测/v,的/u,好坏/n,是/v,合理/a,的/u,。/w,台大/nz,林轩田/nr,老师/n,倒是/d,从/p,原理/n,上/f,推导/vn,了/u,整个/b,过程/n,，/w,但/c,个人/n,感觉/n,这/r,部分/n,只是/d,为了/p,得到/v,衡量/v,分类/vn,结果/n,的/u,一个/m,指标值/nw,，/w,在/p,此/r,只/d,写/v,出/v,部分/n,推导/vn,过程/n,，/w,包括/v,极/d,大/a,似然/nw,估计/v,和/c,梯度/n,下降/v,法/j,的/u,推导/vn,，/w,其余/r,的/u,有/v,兴趣/n,的/u,可以/v,去/v,看台/n,大/a,机器/n,学习/v,相关/v,部分/n,，/w,讲/v,的/u,很/d,清楚/a,。/w,极大/a,似然/nw,推导/vn,对于/p,之前/f,的/u,关于/p,分类/vn,函数/n,h/en,代表/n,样本/n,属于/v,类别/n,1/m,的/u,概率/n,问题/n,将/d,此式/nw,综合/vn,起来/v,，/w,即/v,综合/vn,y/en,=/w,1/m,和/c,y/en,=/w,0/m,的/u,情况/n,此式/nw,稍加/v,观察/v,可以/v,发现/v,和/c,上面/f,的/u,式子/n,代表/n,的/u,含义/n,是/v,一样/u,的/u,，/w,y/en,=/w,1时/t,，/w,1/m,-/w,h/en,(/w,x/en,)/w,部分/n,就/d,没有/v,了/u,，/w,y/en,=/w,0时/t,，/w,h/en,(/w,x/en,)/w,部门/n,就/d,没有/v,了/u,取/v,似然/nw,函数/n,为/p,对数/n,似然/nw,函数/n,为/p,最大/a,似然/nw,估计/v,就/d,是/v,求/v,使/v,l/en,(/w,θ,)/w,取/v,最大值/nz,时/ng,的/u,θ,，/w,其实/d,这里/r,可以/v,使用/v,梯度/n,上升法/nw,求解/v,(/w,机器/n,学习/v,实战书/nw,中/f,即/v,是/v,用/p,的/u,梯度/n,上升法/nw,)/w,，/w,求得/v,的/u,θ,就是/d,要求/v,的/u,最佳/z,参数/n,。/w,但是/c,，/w,在/p,andrew/en, ,ng/en,的/u,课程/n,中/f,将/d,j/en,(/w,θ,)/w,取/v,为/p,下式/nw,，/w,即/v,：/w,因为/c,乘/v,了/u,一个/m,负/v,的/u,系数/n,-/w,1/m,//w,m/en,，/w,所以/c,取/v,j/en,(/w,θ,)/w,最小值/nz,时/ng,的/u,θ,为/p,要求/v,的/u,最佳/z,参数/n,，/w,求/v,最/d,大/a,值/n,就/d,变为/v,了求/nw,最小值/nz,，/w,梯度/n,上升法/nw,就/d,变为/v,了/u,梯度/n,下降/v,法θ/nw,更新/v,过程/n,可以/v,写/v,成/v,：/w,过/u,拟合/nz,问题/n,对于/p,线性/n,回归/v,或/c,逻辑/n,回归/v,的/u,损失/n,函数/n,构成/v,的/u,模型/n,，/w,可能/v,会/v,有些/r,权重/nz,很/d,大/a,，/w,有些/r,权重/nz,很/d,小/a,，/w,导致/v,过/u,拟合/nz,（/w,就/d,是/v,过分/ad,拟合/nz,了/u,训练/vn,数据/n,）/w,，/w,使得/v,模型/n,的/u,复杂/a,度提高/n,，/w,泛化/nw,能力/n,较/d,差/a,（/w,对/p,未知/vn,数据/n,的/u,预测/v,能力/n,）/w,。/w,问题/n,的/u,主因/n,过/u,拟合/nz,问题/n,往往/d,源自/v,过多/d,的/u,特征/n,。/w,解决/v,方法/n,1/m,）/w,减少/v,特征/n,数量/n,（/w,减少/v,特征/n,会/v,失去/v,一些/m,信息/n,，/w,即使/c,特征/n,选/v,的/u,很/d,好/a,）/w,可用/v,人工/n,选择/v,要/v,保留/v,的/u,特征/n,；/w,特征/n,选择/v,算法/n,；/w,2/m,）/w,正则化/nw,（/w,特征/n,较/d,多/a,时/ng,比较/d,有效/a,）/w,保留/v,所有/b,特征/n,，/w,但/c,减少/v,θ,的/u,大小/n,正规化/vn,解决/v,过/u,拟合/nz,实例/n,首先/d,多/a,说/v,一句/mq,，/w,正/d,则/d,项/q,可以/v,取/v,不同/a,的/u,形式/n,在/p,回归/v,问题/n,中/f,取/v,平方/q,损失/n,，/w,就/d,是/v,参数/n,的/u,l/en,2/m,范数/nr,，/w,也/d,可以/v,取/v,l/en,1/m,范数/nr,。/w,取/v,平方/q,损失/n,时/ng,，/w,模型/n,的/u,损失/n,函数/n,变为/v,：/w,其中/r,lambda/en,是/v,正/d,则/d,项/q,系数/n,：/w,如果/c,它/r,的/u,值/n,很/d,大/a,，/w,说明/v,对/p,模型/n,的/u,复杂度/nw,惩罚/vn,大/a,，/w,对/p,拟合/nz,数据/n,的/u,损失/n,惩罚/vn,小/a,，/w,这样/r,它/r,就/d,不/d,会/v,过分/ad,拟合/nz,数据/n,，/w,在/p,训练/vn,数据/n,上/f,的/u,偏差/n,较/d,大/a,，/w,在/p,未知/vn,数据/n,上/f,的/u,方差/nr,较/d,小/a,，/w,但是/c,可能/v,出现/v,欠/v,拟合/nz,的/u,现象/n,；/w,如果/c,它/r,的/u,值/n,很/d,小/a,，/w,说明/v,比较/d,注重/v,对/p,训练/vn,数据/n,的/u,拟合/nz,，/w,在/p,训练/vn,数据/n,上/f,的/u,偏差/n,会/v,小/a,，/w,但是/c,可能/v,会/v,导致/v,过/u,拟合/nz,。/w,接下来/l,我们/r,看/v,斯坦福/nr,机器/n,学习/v,公开课/n,中/f,的/u,一个/m,房价/n,问题/n,用/p,正规化/vn,解决/v,过/u,拟合/nz,的/u,例子/n,左图/n,是/v,适当/a,拟合/nz,，/w,右图/n,是/v,过/u,拟合/nz,。/w,分析/vn,得到/v,，/w,过/u,拟合/nz,是/v,由于/c,其中/r,x/en,三次/mq,方/q,四次/mq,方/q,项/q,的/u,存在/v,引起/v,的/u,，/w,造成/v,模型/n,过于/d,复杂/a,，/w,直观/a,上/f,看/v,也/d,就/d,是/v,曲线/n,过于/d,弯曲/v,如果/c,我们/r,想/v,解决/v,这个/r,例子/n,中/f,的/u,过/u,拟合/nz,问题/n,，/w,最好/d,能/v,将/d,x/en,的/u,三次/mq,方/q,四次/mq,方/q,项/q,的/u,影响/vn,消除/v,，/w,也/d,就/d,是/v,让/v,θ,3/m,和/c,θ,4/m,尽可能/d,的/u,等于/v,0/m,；/w,假设/v,我们/r,想/v,这样/r,做/v,的话/u,，/w,一个/m,简单/a,的/u,办法/n,就/d,是/v,给/p,原有/v,的/u,cost/en,函数/n,的/u,相应/v,项/q,加上/v,两个/m,略/d,大/a,惩罚/vn,项/q,系数/n,，/w,例如/v,：/w,这样/r,在/p,最小化/nw,cost/en,函数/n,的/u,时候/n,正则化/nw,后/f,的/u,梯度/n,下降/v,算/v,法θ/nw,的/u,更新/v,变为/v,：/w,逻辑/n,回归/v,实战/n,这/r,部分/n,主要/b,是/v,以/p,机器/n,学习/v,实战/n,中/f,的/u,例子/n,为/p,主导/n,，/w,自己/r,也/d,编写/v,了/u,整个/b,算法/n,的/u,过程/n,首先/d,是/v,加载/v,数据/n,部分/n,def/en, ,loaddataset/en,(/w,)/w,:/w,datamat/en, ,=/w, ,[/w,]/w,;/w, ,labelmat/en, ,=/w, ,[/w,]/w,fr/en, ,=/w, ,open/en,(/w,'/w,testset/en,./w,txt/en,'/w,)/w,for/en, ,line/en, ,in/en, ,fr/en,./w,readlines/en,(/w,)/w,:/w,linearr/en, ,=/w, ,line/en,./w,strip/en,(/w,)/w,./w,split/en,(/w,)/w,datamat/en,./w,append/en,(/w,[/w,1.0/m,,/w, ,float/en,(/w,linearr/en,[/w,0/m,]/w,)/w,,/w, ,float/en,(/w,linearr/en,[/w,1/m,]/w,)/w,]/w,)/w,labelmat/en,./w,append/en,(/w,int/en,(/w,linearr/en,[/w,2/m,]/w,)/w,)/w,return/en, ,datamat/en,,/w,labelmat/en,定义/n,了/u,两个/m,数组/n,用于/v,存放/v,数据/n,和/c,类别/n,加载/v,后/f,即/v,基于/p,数据/n,和/c,真实/a,类别/n,进行/v,梯度/n,下降/v,法/j,求取/nw,最佳/z,的/u,权重/nz,向/p,量/n,def/en, ,gradascent/en,(/w,datamatin/en,,/w, ,classlabels/en,)/w,:/w,datamatrix/en, ,=/w, ,mat/en,(/w,datamatin/en,)/w, ,#,convert/en, ,to/en, 