本节 进入 机器 学习 的 核心 内容 机器学习 算法 篇 
我会 用 实例 演示 一些 常用 的 机器学习 算法 下面 
演示 第一个 机器学习 算法 决策树 决策树 与 其他 算法 相比 
有 很多 优点 其中 最 主要 的 一个 优点 是 
机器 和 人都 能看懂 我们 使用 机器 学习 的 模型 
就 能 完成 预测 任务 在 代码 演示 之前 需要 
安装 一个 树 型 结构 的 显示 工具 graphviz 在 
Mac 系统 中 使用 如 下 命令 进行 安装 $ 
brew install graphviz 案例 背景 描述 小文 女 芳龄 28 
苗条 淑女 一枚 人见人爱 花见 花开 型 的 可能 是 
自己 的 条件 比较 优越 再 加上 人际 圈 比较 
广 对 选择 男朋友 的 标准 也 比较 多 按 
她 的话 说 眼睛 都 挑花 了 后面 都挑/nr 麻木 
了 作为 小文 的 老朋友 她 也 知道 我 是 
搞 数据分析 决策 方面 的 工作 不帮 她 确实 有点 
不 厚道 啊 经过 跟 小文 沟通 她 也 积极 
配合 根据 她 之前 约会 的 一些 经验 共同 整理 
了 一份 数据表 约会对象 年龄 长相 身高 收入 家庭 背景 
职业 进展 情况 结果 张三/nr 较大/a 一般/a 较/zg 矮/a 较高/i 
一般/a 稳定/a 发展/vn 一般/a 李四/nr 同龄/n 一般/a 同高/i 凑合/v 较好/i 
潜力/n 发展/vn 一般/a 王五/nr 较小/i 较/zg 帅/nr 较高/i 较低/i 较好/i 
不好/d 没有/v 发展/vn 赵六/i 较大/a 较/zg 丑/a 同高/i 较高/i 一般/a 
稳定/a 发展/vn 一般/a 陈七/i 较大/a 一般/a 较高/i 较高/i 一般/a 稳定/a 
发展/vn 迅速/ad 高八/nr 同龄/n 一般/a 较/zg 矮/a 凑合/v 较差/a 潜力/n 
没有/v 发展/vn 罗九/nr 较大/a 较/zg 帅/nr 较高/i 凑合/v 较差/a 潜力/n 
发展迅速/i 以上/f 数据/n 似乎/d 少了/i 些/q 实际 数据 至少 需要 
20条 有了 以上 数据 后 我们 开始 下面 的 代码 
from sklearn . feature _ extraction import DictVectorizer import numpy 
as np featureList = { 年龄 较大 长相 一般 身高 
较 矮 收入 较高 家庭 背景 一般 职业 稳定 } 
{ 年龄 同龄 长相 一般 身高 同高 收入 凑合 家庭 
背景 较好 职业 潜力 } { 年龄 较小 长相 较 
帅 身高 较高 收入 较低 家庭 背景 较好 职业 不好 
} { 年龄 较大 长相 较 丑 身高 同高 收入 
较高 家庭 背景 一般 职业 稳定 } { 年龄 较大 
长相 一般 身高 较高 收入 较高 家庭 背景 一般 职业 
稳定 } { 年龄 同龄 长相 一般 身高 较 矮 
收入 凑合 家庭 背景 较差 职业 潜力 } { 年龄 
较大 长相 较 帅 身高 较高 收入 凑合 家庭 背景 
较差 职业 潜力 } vec = DictVectorizer dummyX = vec 
. fit _ transform featureList . toarray print X 样本数据 
print dummyX labelList = 发展 一般 发展 一般 没有 发展 
发展 一般 发展迅速 没有 发展 发展迅速 lb = preprocessing . 
LabelBinarizer dummyY = lb . fit _ transform labelList print 
Y 样本数据 print dummyY clf = tree . D e 
c i s i o n T r e e 
C l a s s i f i e r 
criterion = entropy clf = clf . fit dummyX dummyY 
# Visualize model with open . / love . dot 
w as f f = tree . export _ graphviz 
clf feature _ names = vec . get _ feature 
_ names out _ file = f # 假如 我们 
要 预测 { 年龄 较大 长相 一般 身高 同高 收入 
凑合 家庭 背景 一般 职业 潜力 } newRowX = np 
. array 1 . 0 . 0 . 0 . 
1 . 0 . 1 . 0 . 0 . 
0 . 1 . 0 . 1 . 0 . 
0 . 1 . 0 . 0 print newRowX print 
预测 X 数据 + str newRowX predictedY = clf . 
predict newRowX print 预测 Y 结果 + str predictedY # 
预测 本次 交往 结果 是 发展 一般 运行 结果 如下 
X 样本数据 1 . 0 . 0 . 0 . 
1 . 0 . 0 . 0 . 1 . 
0 . 0 . 1 . 0 . 1 . 
0 . 1 . 0 . 0 . 0 . 
1 . 0 . 1 . 0 . 0 . 
1 . 0 . 0 . 0 . 1 . 
0 . 1 . 0 . 0 . 1 . 
0 . 0 . 0 . 1 . 0 . 
0 . 0 . 1 . 0 . 1 . 
0 . 1 . 0 . 0 . 0 . 
0 . 1 . 0 . 0 . 1 . 
1 . 0 . 0 . 0 . 1 . 
0 . 0 . 0 . 1 . 0 . 
0 . 1 . 1 . 0 . 0 . 
0 . 1 . 0 . 1 . 0 . 
0 . 0 . 1 . 0 . 0 . 
0 . 1 . 0 . 0 . 1 . 
0 . 0 . 1 . 1 . 0 . 
0 . 0 . 0 . 1 . 1 . 
0 . 0 . 1 . 0 . 0 . 
0 . 1 . 0 . 0 . 1 . 
0 . 1 . 0 . 0 . 0 . 
0 . 1 . 0 . 1 . 0 . 
1 . 0 . 0 . 0 . 1 . 
0 . 0 . 0 . 1 . 0 . 
0 . 1 . Y 样本数据 1 0 0 1 
0 0 0 0 1 1 0 0 0 1 
0 0 0 1 0 1 0 1 . 0 
. 0 . 0 . 1 . 0 . 1 
. 0 . 0 . 0 . 1 . 0 
. 1 . 0 . 0 . 1 . 0 
. 0 . 预测 X 数据 1 . 0 . 
0 . 0 . 1 . 0 . 1 . 
0 . 0 . 0 . 1 . 0 . 
1 . 0 . 0 . 1 . 0 . 
0 . 预测 Y 结果 1 . 0 . 0 
. 因为 样本 调用函数 后 顺序 有所 改变 经过 整理 
如下 featureList = { 家庭 背景 一般 年龄 较大 收入 
较高 职业 稳定 身高 较 矮 长相 一般 } { 
家庭 背景 较好 年龄 同龄 收入 凑合 职业 潜力 身高 
同高 长相 一般 } { 家庭 背景 较好 年龄 较小 
收入 较低 职业 不好 身高 较高 长相 较 帅 } 
{ 家庭 背景 一般 年龄 较大 收入 较高 职业 稳定 
身高 同高 长相 较 丑 } { 家庭 背景 一般 
年龄 较大 收入 较高 职业 稳定 身高 较高 长相 一般 
} { 家庭 背景 较差 年龄 同龄 收入 凑合 职业 
潜力 身高 较 矮 长相 一般 } { 家庭 背景 
较差 年龄 较大 收入 凑合 职业 潜力 身高 较高 长相 
较 帅 } 这里 我们 用 0 和1来/nr 表示 数据 
家庭 背景 100 一般 010 较好 001 较差 年龄 100 
同龄 010 较大 001 较小 收入 100 凑合 010 较低 
001 较高 职业 100 不好 010 潜力 001 稳定 身高 
100 同高 010 较 矮 001 较高 长相 100 一般 
010 较 丑 001 较 帅 现在 提出 如下 疑问 
小文 下次 想要 见面 约会 的 人 的 基本 资料 
如下 我们 来 预测 一下 他们 后面 的 发展 到底 
如何 呢 约会对象 柯南 年龄 较大 长相 一般 身高 同高 
收入 凑合 家庭 背景 一般 职业 潜力 样 本用 0 
和1/nr 表示 调整 列名 顺序 后 输入 值 如下   
100 010 100 010 100 100 1 . 0 . 
0 . 0 . 1 . 0 . 1 . 
0 . 0 . 0 . 1 . 0 . 
1 . 0 . 0 . 1 . 0 . 
0 预测 结果 如下 预测 Y 结果 1 . 0 
. 0 . 经过 分析 用 符号 表示 结果 如下 
100 发展 一般 001 没有 发展 010 发展迅速 因为 经过 
算法 计算 后的/nr 结果 是 100 所以 小文 本次 与 
柯南 相处 我们 预测 他们 发展 一般 至于 后面 的 
事情 让 小文 自己 好好 考虑 吧 毕竟 是 终身大事 
此外 graphviz 安装 完成 后 打开 终端 用 命令 定位 
到 love . dot 文件 的 目录 位置 后 执行 
下面 的 语句 生成 一张 png 的 树 型 结构图 
$ dot Tpng love . dot o love . png 
图片 内容 显示 如下 OK 本 讲 到此结束 后续 更多 
精彩 内容 请 持续 关注 我 的 博客 本 博文 
为 原创 文章 请 珍惜 博主 的 劳动 成果 转载 
请 注明 出处 本文 地址 http / / www . 
cnblogs . com / robin201711 / p / 7989370 . 
html 