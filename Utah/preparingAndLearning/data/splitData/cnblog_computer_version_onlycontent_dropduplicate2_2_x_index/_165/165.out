一/m,、/w,detect/en,和/c,build/en,前面/f,多节/nw,中/f,我们/r,花/v,了/u,大量/m,笔墨/n,介绍/v,build/en,方法/n,的/u,inference/en,分支/n,，/w,这/r,节/n,我们/r,看看/v,它/r,是/v,如何/r,被/p,调用/v,的/u,。/w,在/p,dimo/en,./w,ipynb/en,中/f,，/w,涉及/v,model/en,的/u,操作/v,我们/r,简单/a,进行/v,一下/m,汇总/v,，/w,首先/d,创建/v,图/n,并/c,载入/v,预训练权/nw,重/a,，/w,然后/c,规范/v,了/u,类别/n,序列/n,，/w,实际/n,开始/v,检测/vn,的/u,代码/n,块/q,如下/v,，/w,经由/p,model/en,./w,detect/en,方法/n,，/w,调用/v,model/en,./w,build/en,方法/n,（/w,也/d,就是/d,我们/r,前面/f,多节/nw,在/p,讲解/v,的/u,方法/n,）/w,构建/v,图/n,，/w,实施/v,预测/v,。/w,二/m,、/w,detect/en,方法/n,首先/d,看看/v,detect/en,方法/n,的/u,前/f,几/m,行/v,（/w,和/c,build/en,一样/u,，/w,同/p,见/v,model/en,./w,py/en,）/w,，/w,def/en, ,detect/en,(/w,self/en,,/w, ,images/en,,/w, ,verbose/en,=/w,0/m,)/w,:/w, ,"/w,"/w,"/w,runs/en, ,the/en, ,detection/en, ,pipeline/en,./w, ,images/en,:/w, ,list/en, ,of/en, ,images/en,,/w, ,potentially/en, ,of/en, ,different/en, ,sizes/en,./w, ,returns/en, ,a/en, ,list/en, ,of/en, ,dicts/en,,/w, ,one/en, ,dict/en, ,per/en, ,image/en,./w, ,the/en, ,dict/en, ,contains/en,:/w, ,rois/en,:/w, ,[/w,n/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w, ,detection/en, ,bounding/en, ,boxes/en, ,class/en,_,ids/en,:/w, ,[/w,n/en,]/w, ,int/en, ,class/en, ,ids/en, ,scores/en,:/w, ,[/w,n/en,]/w, ,float/en, ,probability/en, ,scores/en, ,for/en, ,the/en, ,class/en, ,ids/en, ,masks/en,:/w, ,[/w,h/en,,/w, ,w/en,,/w, ,n/en,]/w, ,instance/en, ,binary/en, ,masks/en, ,"/w,"/w,"/w, ,assert/en, ,self/en,./w,mode/en, ,=/w,=/w, ,"/w,inference/en,"/w,,/w, ,"/w,create/en, ,model/en, ,in/en, ,inference/en, ,mode/en,./w,"/w, ,assert/en, ,len/en,(/w, ,images/en,)/w, ,=/w,=/w, ,self/en,./w,config/en,./w,batch/en,_,size/en,,/w, ,"/w,len/en,(/w,images/en,)/w, ,must/en, ,be/en, ,equal/en, ,to/en, ,batch/en,_,size/en,"/w, ,#, ,日志/n,记录/v, ,if/en, ,verbose/en,:/w, ,log/en,(/w,"/w,processing/en, ,{/w,}/w, ,images/en,"/w,./w,format/en,(/w,len/en,(/w,images/en,)/w,)/w,)/w, ,for/en, ,image/en, ,in/en, ,images/en,:/w, ,log/en,(/w,"/w,image/en,"/w,,/w, ,image/en,)/w,1/m,、/w,待/v,检测/vn,图像/n,预/d,处理/v,#, ,mold/en, ,inputs/en, ,to/en, ,format/en, ,expected/en, ,by/en, ,the/en, ,neural/en, ,network/en, ,molded/en,_,images/en,,/w, ,image/en,_,metas/en,,/w, ,windows/en, ,=/w, ,self/en,./w,mold/en,_,inputs/en,(/w,images/en,)/w, ,#, ,validate/en, ,image/en, ,sizes/en, ,#, ,all/en, ,images/en, ,in/en, ,a/en, ,batch/en, ,must/en, ,be/en, ,of/en, ,the/en, ,same/en, ,size/en, ,image/en,_,shape/en, ,=/w, ,molded/en,_,images/en,[/w,0/m,]/w,./w,shape/en, ,for/en, ,g/en, ,in/en, ,molded/en,_,images/en,[/w,1/m,:/w,]/w,:/w, ,assert/en, ,g/en,./w,shape/en, ,=/w,=/w, ,image/en,_,shape/en,,/w,\/w, ,"/w,after/en, ,resizing/en,,/w, ,all/en, ,images/en, ,must/en, ,have/en, ,the/en, ,same/en, ,size/en,./w, ,check/en, ,image/en,_,resize/en,_,mode/en, ,and/en, ,image/en, ,sizes/en,./w,"/w,简单/a,的/u,纠错/vn,和/c,日志/n,控制/v,之后/f,，/w,即/v,调用/v,mold/en,_,input/en,函数/n,对/p,输入/v,图片/n,进行/v,调整/vn,，/w,并/c,记录/v,图片/n,信息/n,。/w,self/en,./w,mold/en,_,inputs/en,方法/n,如下/v,，/w,def/en, ,mold/en,_,inputs/en,(/w,self/en,,/w, ,images/en,)/w,:/w, ,"/w,"/w,"/w,takes/en, ,a/en, ,list/en, ,of/en, ,images/en, ,and/en, ,modifies/en, ,them/en, ,to/en, ,the/en, ,format/en, ,expected/en, ,as/en, ,an/en, ,input/en, ,to/en, ,the/en, ,neural/en, ,network/en,./w, ,images/en,:/w, ,list/en, ,of/en, ,image/en, ,matrices/en, ,[/w,height/en,,/w,width/en,,/w,depth/en,]/w,./w, ,images/en, ,can/en, ,have/en, ,different/en, ,sizes/en,./w, ,returns/en, ,3/m, ,numpy/en, ,matrices/en,:/w, ,molded/en,_,images/en,:/w, ,[/w,n/en,,/w, ,h/en,,/w, ,w/en,,/w, ,3/m,]/w,./w, ,images/en, ,resized/en, ,and/en, ,normalized/en,./w, ,image/en,_,metas/en,:/w, ,[/w,n/en,,/w, ,length/en, ,of/en, ,meta/en, ,data/en,]/w,./w, ,details/en, ,about/en, ,each/en, ,image/en,./w, ,windows/en,:/w, ,[/w,n/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w,./w, ,the/en, ,portion/en, ,of/en, ,the/en, ,image/en, ,that/en, ,has/en, ,the/en, ,original/en, ,image/en, ,(/w,padding/en, ,excluded/en,)/w,./w, ,"/w,"/w,"/w, ,molded/en,_,images/en, ,=/w, ,[/w,]/w, ,image/en,_,metas/en, ,=/w, ,[/w,]/w, ,windows/en, ,=/w, ,[/w,]/w, ,for/en, ,image/en, ,in/en, ,images/en,:/w, ,#, ,resize/en, ,image/en, ,#, ,todo/en,:/w, ,move/en, ,resizing/en, ,to/en, ,mold/en,_,image/en,(/w,)/w, ,molded/en,_,image/en,,/w, ,window/en,,/w, ,scale/en,,/w, ,padding/en,,/w, ,crop/en, ,=/w, ,utils/en,./w,resize/en,_,image/en,(/w, ,image/en,,/w, ,min/en,_,dim/en,=/w,self/en,./w,config/en,./w,image/en,_,min/en,_,dim/en,,/w, ,#, ,800/m, ,min/en,_,scale/en,=/w,self/en,./w,config/en,./w,image/en,_,min/en,_,scale/en,,/w, ,#, ,0/m, ,max/en,_,dim/en,=/w,self/en,./w,config/en,./w,image/en,_,max/en,_,dim/en,,/w, ,#, ,1024/m, ,mode/en,=/w,self/en,./w,config/en,./w,image/en,_,resize/en,_,mode/en,)/w, ,#, ,square/en, ,molded/en,_,image/en, ,=/w, ,mold/en,_,image/en,(/w,molded/en,_,image/en,,/w, ,self/en,./w,config/en,)/w, ,#, ,减/v,平均/a,像素/n, ,#, ,build/en, ,image/en,_,meta/en, ,形式/n,为/p,np/en,数组/n, ,image/en,_,meta/en, ,=/w, ,compose/en,_,image/en,_,meta/en,(/w, ,0/m,,/w, ,image/en,./w,shape/en,,/w, ,molded/en,_,image/en,./w,shape/en,,/w, ,window/en,,/w, ,scale/en,,/w, ,np/en,./w,zeros/en,(/w,[/w,self/en,./w,config/en,./w,num/en,_,classes/en,]/w,,/w, ,dtype/en,=/w,np/en,./w,int/en,32/m,)/w,)/w, ,#, ,append/en, ,molded/en,_,images/en,./w,append/en,(/w,molded/en,_,image/en,)/w, ,windows/en,./w,append/en,(/w,window/en,)/w, ,image/en,_,metas/en,./w,append/en,(/w,image/en,_,meta/en,)/w, ,#, ,pack/en, ,into/en, ,arrays/en, ,molded/en,_,images/en, ,=/w, ,np/en,./w,stack/en,(/w,molded/en,_,images/en,)/w, ,image/en,_,metas/en, ,=/w, ,np/en,./w,stack/en,(/w,image/en,_,metas/en,)/w, ,windows/en, ,=/w, ,np/en,./w,stack/en,(/w,windows/en,)/w, ,return/en, ,molded/en,_,images/en,,/w, ,image/en,_,metas/en,,/w, ,windowsutils/en,./w,resize/en,_,image/en,函数/n,用于/v,缩放/v,原/b,图像/n,，/w,它/r,生成/vn,一个/m,scale/en,，/w,返回/v,图像/n,大小/n,等于/v,输入/v,图像/n,大小/n,*/w,scale/en,并/c,保证/v,最/d,短边/nw,等于/v,输入/v,min/en,_,dim/en,，/w,最/d,长边/nw,不/d,大于/v,max/en,_,dim/en,如果/c,最/d,长边/nw,超过/v,了/u,max/en,_,dim/en,则/d,保证/v,最/d,长边/nw,等于/v,max/en,_,dim/en,，/w,最/d,短边/nw,不再/d,限制/v,最后/f,，/w,将/d,图片/n,padding/en,到/v,max/en,_,dim/en,*/w,max/en,_,dim/en,大小/n,（/w,即/v,molded/en,_,images/en,大/a,小/a,其实/d,是/v,固定/a,的/u,）/w,，/w,其/r,返回/v,值/n,如下/v,：/w,image/en,./w,astype/en,(/w,image/en,_,dtype/en,)/w,,/w, ,window/en,,/w, ,scale/en,,/w, ,padding/en,,/w, ,crop/en,表示/v,：/w,resize/en,后/f,图片/n,，/w,原/b,图/n,相对/d,resize/en,后/f,图片/n,的/u,位置/n,信息/n,（/w,详见/nz,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,五/m,：/w,目标/n,检测/vn,结果/n,精炼/a,）/w,，/w,放缩/nw,倍数/n,，/w,padding/en,信息/n,（/w,四个/m,整数/n,）/w,，/w,crop/en,信息/n,（/w,四个/m,整数/n,或者/c,none/en,）/w,。/w,mold/en,_,image/en,函数/n,更为/d,简单/a,，/w,就是/d,把/p,图片/n,像素/n,减去/v,了/u,个/q,平均值/n,，/w,mean/en,_,pixel/en,=/w,[/w,123.7/m, ,116.8/m, ,103.9/m,]/w,。/w,compose/en,_,image/en,_,meta/en,记录/v,了/u,全部/m,的/u,原始/a,信息/n,，/w,可以/v,看到/v,，/w,crop/en,并未/d,收录/v,在内/u,，/w,def/en, ,compose/en,_,image/en,_,meta/en,(/w,image/en,_,id/en,,/w, ,original/en,_,image/en,_,shape/en,,/w, ,image/en,_,shape/en,,/w, ,window/en,,/w, ,scale/en,,/w, ,active/en,_,class/en,_,ids/en,)/w,:/w, ,"/w,"/w,"/w,takes/en, ,attributes/en, ,of/en, ,an/en, ,image/en, ,and/en, ,puts/en, ,them/en, ,in/en, ,one/en, ,1/m,d/en, ,array/en,./w, ,image/en,_,id/en,:/w, ,an/en, ,int/en, ,id/en, ,of/en, ,the/en, ,image/en,./w, ,useful/en, ,for/en, ,debugging/en,./w, ,original/en,_,image/en,_,shape/en,:/w, ,[/w,h/en,,/w, ,w/en,,/w, ,c/en,]/w, ,before/en, ,resizing/en, ,or/en, ,padding/en,./w, ,image/en,_,shape/en,:/w, ,[/w,h/en,,/w, ,w/en,,/w, ,c/en,]/w, ,after/en, ,resizing/en, ,and/en, ,padding/en, ,window/en,:/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w, ,in/en, ,pixels/en,./w, ,the/en, ,area/en, ,of/en, ,the/en, ,image/en, ,where/en, ,the/en, ,real/en, ,image/en, ,is/en, ,(/w,excluding/en, ,the/en, ,padding/en,)/w, ,scale/en,:/w, ,the/en, ,scaling/en, ,factor/en, ,applied/en, ,to/en, ,the/en, ,original/en, ,image/en, ,(/w,float/en,32/m,)/w, ,active/en,_,class/en,_,ids/en,:/w, ,list/en, ,of/en, ,class/en,_,ids/en, ,available/en, ,in/en, ,the/en, ,dataset/en, ,from/en, ,which/en, ,the/en, ,image/en, ,came/en,./w, ,useful/en, ,if/en, ,training/en, ,on/en, ,images/en, ,from/en, ,multiple/en, ,datasets/en, ,where/en, ,not/en, ,all/en, ,classes/en, ,are/en, ,present/en, ,in/en, ,all/en, ,datasets/en,./w, ,"/w,"/w,"/w, ,meta/en, ,=/w, ,np/en,./w,array/en,(/w, ,[/w,image/en,_,id/en,]/w, ,+/w, ,#, ,size/en,=/w,1/m, ,list/en,(/w,original/en,_,image/en,_,shape/en,)/w, ,+/w, ,#, ,size/en,=/w,3/m, ,list/en,(/w,image/en,_,shape/en,)/w, ,+/w, ,#, ,size/en,=/w,3/m, ,list/en,(/w,window/en,)/w, ,+/w, ,#, ,size/en,=/w,4/m, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w, ,in/en, ,image/en, ,cooredinates/en, ,[/w,scale/en,]/w, ,+/w, ,#, ,size/en,=/w,1/m, ,list/en,(/w,active/en,_,class/en,_,ids/en,)/w, ,#, ,size/en,=/w,num/en,_,classes/en, ,)/w, ,return/en, ,meta/en,最后/f,拼接/vn,返回/v,。/w,2/m,、/w,anchors/en,生成/vn,首先/d,调用/v,方法/n,get/en,_,anchors/en,生成/vn,锚框/nw,（/w,见/v,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,锚框/nw,生成/vn,）/w,，/w,shape/en,为/p,[/w,anchor/en,_,count/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w,，/w,#, ,anchors/en, ,anchors/en, ,=/w, ,self/en,./w,get/en,_,anchors/en,(/w,image/en,_,shape/en,)/w, ,#, ,duplicate/en, ,across/en, ,the/en, ,batch/en, ,dimension/en, ,because/en, ,keras/en, ,requires/en, ,it/en, ,#, ,todo/en,:/w, ,can/en, ,this/en, ,be/en, ,optimized/en, ,to/en, ,avoid/en, ,duplicating/en, ,the/en, ,anchors/en,?/w, ,#, ,[/w,anchor/en,_,count/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w, ,--/nrf,>, ,[/w,batch/en,,/w, ,anchor/en,_,count/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w, ,anchors/en, ,=/w, ,np/en,./w,broadcast/en,_,to/en,(/w,anchors/en,,/w, ,(/w,self/en,./w,config/en,./w,batch/en,_,size/en,,/w,)/w, ,+/w, ,anchors/en,./w,shape/en,)/w,然后/c,为/p,之/u,添加/vn,batch/en,维度/n,，/w,最终/d,[/w,batch/en,,/w, ,anchor/en,_,count/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w,。/w,3/m,、/w,inference/en,网络/n,预测/v,调用/v,keras/en,的/u,predict/en,方法/n,前/f,向/p,传播/vn,，/w,在/p,预测/v,任务/n,中/f,我们/r,仅仅/d,关注/v,detections/en,和/c,mrcnn/en,_,mask/en,两个/m,输出/v,。/w,#, ,run/en, ,object/en, ,detection/en, ,#, ,于/p,_,_,init/en,_,_,中/f,定义/n,：/w,self/en,./w,keras/en,_,model/en, ,=/w, ,self/en,./w,build/en,(/w,mode/en,=/w,mode/en,,/w, ,config/en,=/w,config/en,)/w, ,#, ,返回/v,list/en,：/w, ,[/w,detections/en,,/w, ,mrcnn/en,_,class/en,,/w, ,mrcnn/en,_,bbox/en,,/w, ,#, ,mrcnn/en,_,mask/en,,/w, ,rpn/en,_,rois/en,,/w, ,rpn/en,_,class/en,,/w, ,rpn/en,_,bbox/en,]/w, ,#, ,detections/en,,/w, ,[/w,batch/en,,/w, ,num/en,_,detections/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,,/w, ,class/en,_,id/en,,/w, ,score/en,)/w,]/w, ,#, ,mrcnn/en,_,mask/en,,/w, ,[/w,batch/en,,/w, ,num/en,_,detections/en,,/w, ,mask/en,_,pool/en,_,size/en,,/w, ,mask/en,_,pool/en,_,size/en,,/w, ,num/en,_,classes/en,]/w, ,detections/en,,/w, ,_,,/w, ,_,,/w, ,mrcnn/en,_,mask/en,,/w, ,_,,/w, ,_,,/w, ,_, ,=/w,\/w, ,self/en,./w,keras/en,_,model/en,./w,predict/en,(/w,[/w,molded/en,_,images/en,,/w, ,image/en,_,metas/en,,/w, ,anchors/en,]/w,,/w, ,verbose/en,=/w,0/m,)/w,4/m,、/w,坐标/n,框重/nw,映射/v,我们/r,对于/p,坐标/n,的/u,操作/v,都/d,是/v,基于/p,输入/v,图片/n,的/u,相对/d,位置/n,，/w,且/c,单位/n,长度/n,也/d,是/v,其/r,宽/a,高/a,，/w,在/p,最后/f,我们/r,需要/v,将/d,之/u,修正/v,回/v,像素/n,空间/n,坐标/n,。/w,令/v,输入/v,图片/n,list/en,不/d,需要/v,输入/v,图片/n,具有/v,相同/a,的/u,尺寸/n,，/w,所以/c,我们/r,在/p,恢复/v,时/ng,必须/d,注意/v,单/d,张/q,处理/v,之/u,。/w,#, ,process/en, ,detections/en, ,results/en, ,=/w, ,[/w,]/w, ,for/en, ,i/en,,/w, ,image/en, ,in/en, ,enumerate/en,(/w,images/en,)/w,:/w, ,#, ,需要/v,单张/nz,处理/v,，/w,因为/c,原始/a,图片/n,images/en,不/d,保证/v,每张/r,尺寸/n,一致/a, ,final/en,_,rois/en,,/w, ,final/en,_,class/en,_,ids/en,,/w, ,final/en,_,scores/en,,/w, ,final/en,_,masks/en, ,=/w,\/w, ,self/en,./w,unmold/en,_,detections/en,(/w,detections/en,[/w,i/en,]/w,,/w, ,mrcnn/en,_,mask/en,[/w,i/en,]/w,,/w, ,image/en,./w,shape/en,,/w, ,molded/en,_,images/en,[/w,i/en,]/w,./w,shape/en,,/w, ,windows/en,[/w,i/en,]/w,)/w,目标/n,检测/vn,框重/nw,映射/v,：/w,unmold/en,_,detections/en,函数/n,def/en, ,unmold/en,_,detections/en,(/w,self/en,,/w, ,detections/en,,/w, ,mrcnn/en,_,mask/en,,/w, ,original/en,_,image/en,_,shape/en,,/w, ,image/en,_,shape/en,,/w, ,window/en,)/w,:/w, ,"/w,"/w,"/w,reformats/en, ,the/en, ,detections/en, ,of/en, ,one/en, ,image/en, ,from/en, ,the/en, ,format/en, ,of/en, ,the/en, ,neural/en, ,network/en, ,output/en, ,to/en, ,a/en, ,format/en, ,suitable/en, ,for/en, ,use/en, ,in/en, ,the/en, ,rest/en, ,of/en, ,the/en, ,application/en,./w, ,detections/en,:/w, ,[/w,n/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,,/w, ,class/en,_,id/en,,/w, ,score/en,)/w,]/w, ,in/en, ,normalized/en, ,coordinates/en, ,mrcnn/en,_,mask/en,:/w, ,[/w,n/en,,/w, ,height/en,,/w, ,width/en,,/w, ,num/en,_,classes/en,]/w, ,original/en,_,image/en,_,shape/en,:/w, ,[/w,h/en,,/w, ,w/en,,/w, ,c/en,]/w, ,original/en, ,image/en, ,shape/en, ,before/en, ,resizing/en, ,image/en,_,shape/en,:/w, ,[/w,h/en,,/w, ,w/en,,/w, ,c/en,]/w, ,shape/en, ,of/en, ,the/en, ,image/en, ,after/en, ,resizing/en, ,and/en, ,padding/en, ,window/en,:/w, ,[/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,]/w, ,pixel/en, ,coordinates/en, ,of/en, ,box/en, ,in/en, ,the/en, ,image/en, ,where/en, ,the/en, ,real/en, ,image/en, ,is/en, ,excluding/en, ,the/en, ,padding/en,./w, ,returns/en,:/w, ,boxes/en,:/w, ,[/w,n/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w, ,bounding/en, ,boxes/en, ,in/en, ,pixels/en, ,class/en,_,ids/en,:/w, ,[/w,n/en,]/w, ,integer/en, ,class/en, ,ids/en, ,for/en, ,each/en, ,bounding/en, ,box/en, ,scores/en,:/w, ,[/w,n/en,]/w, ,float/en, ,probability/en, ,scores/en, ,of/en, ,the/en, ,class/en,_,id/en, ,masks/en,:/w, ,[/w,height/en,,/w, ,width/en,,/w, ,num/en,_,instances/en,]/w, ,instance/en, ,masks/en, ,"/w,"/w,"/w, ,#, ,how/en, ,many/en, ,detections/en, ,do/en, ,we/en, ,have/en,?/w, ,#, ,detections/en, ,array/en, ,is/en, ,padded/en, ,with/en, ,zeros/en,./w, ,find/en, ,the/en, ,first/en, ,class/en,_,id/en, ,=/w,=/w, ,0/m,./w, ,zero/en,_,ix/en, ,=/w, ,np/en,./w,where/en,(/w,detections/en,[/w,:/w,,/w, ,4/m,]/w, ,=/w,=/w, ,0/m,)/w,[/w,0/m,]/w, ,#, ,detectionlayer/en, ,末尾/n,对/p,结果/n,进行/v,了/u,全/a,0/m,填充/v, ,n/en, ,=/w, ,zero/en,_,ix/en,[/w,0/m,]/w, ,if/en, ,zero/en,_,ix/en,./w,shape/en,[/w,0/m,]/w, ,>, ,0/m, ,else/en, ,detections/en,./w,shape/en,[/w,0/m,]/w, ,#, ,有/v,意义/n,的/u,检测/vn,结果/n,数/m,n/en, ,#, ,extract/en, ,boxes/en,,/w, ,class/en,_,ids/en,,/w, ,scores/en,,/w, ,and/en, ,class/en,-/w,specific/en, ,masks/en, ,boxes/en, ,=/w, ,detections/en,[/w,:/w,n/en,,/w, ,:/w,4/m,]/w, ,#, ,[/w,n/en,,/w, ,(/w,y/en,1/m,,/w, ,x/en,1/m,,/w, ,y/en,2/m,,/w, ,x/en,2/m,)/w,]/w, ,class/en,_,ids/en, ,=/w, ,detections/en,[/w,:/w,n/en,,/w, ,4/m,]/w,./w,astype/en,(/w,np/en,./w,int/en,32/m,)/w, ,#, ,[/w,n/en,,/w, ,class/en,_,id/en,]/w, ,scores/en, ,=/w, ,detections/en,[/w,:/w,n/en,,/w, ,5/m,]/w, ,#, ,[/w,n/en,,/w, ,score/en,]/w, ,masks/en, ,=/w, ,mrcnn/en,_,mask/en,[/w,np/en,./w,arange/en,(/w,n/en,)/w,,/w, ,:/w,,/w, ,:/w,,/w, ,class/en,_,ids/en,]/w, ,#, ,[/w,n/en,,/w, ,height/en,,/w, ,width/en,,/w, ,num/en,_,classes/en,]/w, ,#, ,translate/en, ,normalized/en, ,coordinates/en, ,in/en, ,the/en, ,resized/en, ,image/en, ,to/en, ,pixel/en, ,#, ,coordinates/en, ,in/en, ,the/en, ,original/en, ,image/en, ,before/en, ,resizing/en, ,window/en, ,=/w, ,utils/en,./w,norm/en,_,boxes/en,(/w,window/en,,/w, ,image/en,_,shape/en,[/w,:/w,2/m,]/w,)/w, ,#, ,window/en,相对/d,输入/v,图片/n,规范化/vn, ,wy/en,1/m,,/w, ,wx/en,1/m,,/w, ,wy/en,2/m,,/w, ,wx/en,2/m, ,=/w, ,window/en, ,shift/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,wy/en,1/m,,/w, ,wx/en,1/m,,/w, ,wy/en,1/m,,/w, ,wx/en,1/m,]/w,)/w, ,wh/en, ,=/w, ,wy/en,2/m, ,-/w, ,wy/en,1/m, ,#, ,window/en, ,height/en, ,ww/en, ,=/w, ,wx/en,2/m, ,-/w, ,wx/en,1/m, ,#, ,window/en, ,width/en, ,scale/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,wh/en,,/w, ,ww/en,,/w, ,wh/en,,/w, ,ww/en,]/w,)/w, ,#, ,convert/en, ,boxes/en, ,to/en, ,normalized/en, ,coordinates/en, ,on/en, ,the/en, ,window/en, ,boxes/en, ,=/w, ,np/en,./w,divide/en,(/w,boxes/en, ,-/w, ,shift/en,,/w, ,scale/en,)/w, ,#, ,box/en,相对/d,window/en,坐标/n,规范化/vn, ,#, ,convert/en, ,boxes/en, ,to/en, ,pixel/en, ,coordinates/en, ,on/en, ,the/en, ,original/en, ,image/en, ,boxes/en, ,=/w, ,utils/en,./w,denorm/en,_,b