转 自 http / / www . cnblogs . com 
/ xrwang / archive / 2010 / 03/27 / B 
a c k g r o u n d G 
e n e r a t i o n A 
n d F o r e g r o u 
n d D e t e c t i o 
n P h a s e 2 . html 作者 
王先荣/nr 本文/r 尝试/vn 对/p 学习 OpenCV 中 推荐 的 论文 
Nonparametric Background Generation 进行 翻译 由于 我 的 英文 水平 
很差 断断续续 搞了 好 几天 才 勉强 完成 里面 肯定 
会 有 诸多 错误 欢迎 大家 指正 并请 多多 包涵 
翻译 本文 的 目的 在于 学习 研究 如果 需要 用于 
商业 目的 请与 原文 作者 联系 非 参数 背景 生成 
刘亚洲 姚 鸿勋 高文 陈熙 霖 赵德 斌 哈尔滨工业大学 中国科学院计算所 
摘要 本文 介绍 了 一种 新颖 的 背景 生成 方法 
该 方法 基于 非 参数 背景 模型 可 用于 背景 
减除 我们 介绍 一种 新的 名为 影响 因素 描述 effect 
components description ECD 的 模型 用于 描述 背景 的 变动 
在此 基础 上 我们 可以 用 潜在 分布 的 局部 
极值 推导 出 最 可靠 背景 状态 most reliable background 
mode MRBM 该 方法 的 基本 计算 过程 采用 Mean 
Shift 这一 经典 的 模式识别 过程 Mean Shift 通过 迭代计算 
能够 在 数据 的 密度 分布 中找到 最近 位置 的 
点 译者 注 即 找到 数据 最 密集 的 点 
这种 方法 有 三个 优点 1 能从 包含 混乱 运动 
对象 的 视频 中 提取 出 背景 2 背景 非常 
清晰 3 对 噪声 和小/nr 幅度 的 摄像机 振动 具有 
鲁棒性 广泛 的 实验 结果 证明 了 上述 优点 关键词 
背景 减除 背景 生成 Mean Shift 影响 因素 描述 最 
可靠 背景 状态 视频 监视 1 引言 在 许多 计算机 
视觉 和 视频 分析 应用 中 运动 对象 的 分割 
是 一项 基本 任务 例如 视频 监视 多媒体 索引 人物 
检测 和 跟踪 有 知觉 的 人机接口 小精灵 视频编码 精确 
的 对象 分割 能 极大 的 提高 对象 跟踪 识别 
分类 和 动态 分析 的 性能 识别 运动 对象 的 
通用 方法 有 光 流 基于 时间差 异或 背景 减除 
的 方法 其中 背景 减除 最 常用 背景 模型 被 
计算 出 并 逐 帧 进化 然后 通过 比较 当前 
帧 和 背景 模型 间 的 差异 来 检测 运动 
对象 这种 方法 的 关键 之 处 在于 建立 并 
维持 背景 模型 尽管 文献 1 4 提出 了 很多 
有 前途 的 方法 但是 运动 对象 检测 的 精度 
这一 基本 问题 仍然 难以 解决 第一 个 问题 是 
背景 模型 必须 尽可能 精确 的 反映 真实 背景 这样 
系统 才能 精确 的 检测 运动 对象 的 外形 第二 
个 问题 是 背景 模型 必须 对 背景 场景 的 
改变 足够 灵敏 例如 对象 开始 运动 及 停止 运动 
如果 不能 适当 的 解决 上述 问题 背景 减除 会 
检测 出 虚假 对象 它们 通常 被 称为 幽灵 目前/t 
已经/d 有了/nr 许多/m 用于/v 背景/n 减除/v 的/uj 背景/n 建立/v 和/c 
维持/v 方法/n 按 背景 建模 的 步骤 来 分类 我们 
可以 将 其 分为 参数 化 的 和非/nr 参数 化 
的 方法 参数 化 的 背景 建模 方法 通常 假设 
单个 像素 的 潜在 概率密度函数 是 高斯 或者 高斯 混合 
函数 详情请 参看 文献 5 7 Stauffer 和 Grimson 在 
文献 8 中 提出 了 一种 自适应 的 背景 减除 
方法 用于 解决 运动 分割 问题 在 他们 的 工作 
成果 中 他们 为 每个 像素 建立 了 高斯 混合 
概率密度函数 然后 用 即时 的 近似值 更新 该 模型 文献 
9 10 提出 了 对 高斯 混合模型 的 一些 改进 
方法 Toyama 等人 在 文献 2 中 提出 了 一种 
三层 的 Wallflower 方案 该 方案 尝试 解决 背景 维持 
中 现存 的 许多 问题 例如 灯光 打开 关闭 前景 
孔穴 等等 Haritaoglu 等人 在 文献 1 中 提出 的 
W4 方法 该 方法 为 背景 建模 而对 每个 像素 
保留 了 三个 值 的 方法 包括 最大值 M 最小值 
N 和 最大 帧 间 绝对 差值 D Kim 等人 
在 文献 11 中 将 背景 值 量化 到 编码本 
编码本 描述 了 长 视频 中 背景 模型 的 压缩 
形式 另一类 经常 用到 的 背景 模型 方法 基于 非 
参数 化 的 技术 例如 文献 3 12 16 Elgammal 
等人 在 文献 3 中 通过 核 密度估计 建立 了 
一种 非 参数 化 的 背景 模型 对 每个 像素 
为了 估计 潜在 的 概率密度函数 而 保留 了 观测 强度 
值 而 新 强度 值 的 概率 能 通过 该 
函数 计算 得出 这种 模型 具有 鲁棒性 能够 适应 混乱 
及 不完全 静止 但 包含 小 扰动 场合 下 的 
背景 例如 摆动 的 树枝 和 灌木 与 参数 化 
的 背景 模型 方法 相比 非 参数 化 的 背景 
模型 方法 具有 以下 优点 不 需要 指定 潜在 的 
模型 不 需要 明确 的 估计 参数 14 因此 它们 
能 适应 任意 未知 的 数据分布 这个 特性 使 非 
参数 化 的 方法 成为 许多 计算机 视觉 应用 的 
有力 工具 在 许多 计算机 视觉 应用 中 许多问题 牵涉到 
多元 多种 形式 的 密度 数据 在 特征 空间 中 
没有 规则 的 形态 没有 遵循 标准 的 参数 形式 
但是 从/p 时间/n 和/c 空间/n 复杂度/n 这/r 一方面/mq 来看/u 非 
参数 化 的 方法 不如 参数 化 的 方法 有效 
参数 化 的 方法 产生 简洁 的 密度 描述 例如 
高斯 或 高斯 混合 得出 有效 的 估计 状态 相对 
的 非 参数 化 的 方法 在 学习 阶段 几乎 
不 需要 计算 然而 在 评估 阶段 需要 高 密度 
的 计算 因此 非 参数 化 方法 的 主要 缺陷 
是 它们 的 计算 量 不过 一些 革新 的 工作 
成果 已经 被 提出 它们 能 加快 非 参数 化 
方法 的 评估 速度 例如 文献 13 中 的 快速 
高斯 变换 FGT 文献 17 中的 新 ball tree 算法 
核 密度估计 和K/nr 近邻 KNN 分类 本文 专注 于非/nr 参数 
化 的 方法 跟 Elagammal 在 文献 3 中 提出 
的 方法 有 紧密 的 联系 但是 有 两点 本质上 
的 区别 从 基本 原理 上看 我们 用 影响 因素 
描述 ECD 来 为 背景 的 变化 建模 最 可靠 
背景 模型 MRBM 对 背景 场景 的 估计 具有 鲁棒性 
从 计算 过程 来看 通过 使用 Mean Shift 过程 我们 
避免了 对 每个 新 观测 强度 值 计算 概率 的 
核 密度估计 过程 节约 了 处理 时间 在 我们 的 
方法 中 仅用 帧 差 即 可决定 像素 的 属性 
因此/c 能/v 提高/v 背景/n 减除/v 的/uj 鲁棒性/nr 和/c 效率/n 本文 
余下 的 部分 按 以下 方式 来 组织 第二节 中 
提出 了 影响 因素 描述 用于 反映 背景 的 变化 
第三节 详细 解释 了 最 可靠 背景 模型 第四节 包含 
了 实验 结果 第五节 讨论 了 有待 扩充 的 部分 
2 影响 因素 描述 本节 讨论 影响 因素 描述 ECD 
我们 试图 通过 它 来 有效 的 模拟 背景 的 
变化 背景 减除 的 关键 因素 在于 怎样 建立 并 
维持 好 的 背景 模型 由于 在 不同 的 应用 
中 摄像机 类型 捕获 的 环境 和 对象 完全 不同 
背景 模型 需要 足够 的 自适应 能力 来 适应 不同 
的 情况 为了 有效 的 为 背景 建模 我们 从最/nr 
简单 的 理想 情况 开始 在 理想 情况下 对于 视频 
中 的 每个 空间 位置 沿 时间轴 的 强度 值 
为 常量 C 常量 C 表示 固定 摄像机 摄录 了 
固定 的 场景 没有 运动 对象 和 系统 噪声 我们 
将 这种 情况下 的 场景 称为 理想 背景 场景 但是 
在 实际 应用 中 很少 能 遇到 这种 理想 情况 
因此 背景 像素 可以 看成 是 理想 背景 场景 和 
其他 影响 部分 的 组合体 我们 将 这种 方法 定义 
为 背景 的 影响 成分 描述 包括 以下 方面 系统 
噪声 N sys 它 由 图像 传感器 和 其他 硬件 
设备 引起 如果 环境 不太 严密 系统 噪声 不会 从 
根本 上 影响 常量 C 仅仅 引起 适度 的 偏差 
运动 的 对象 M obj 它 由 实际 运动 的 
对象 及其 阴影 引起 大多数 时候 它 对 C 有 
极大 的 干扰 运动 的 背景 M bgd 它 由 
运动 的 背景 区域 引起 例如 户外 场景 中 随风 
摆动 的 树枝 或者 水中 的 波纹 光照 S illum 
它 表示 户外 随 太阳 位置 改变 而 渐变 的 
光照 或者 室内 灯光 的 关闭 和 打开 而 改变 
的 照明 摄像机 位移 D cam 它 表示 摄像机 的 
小幅度 位移 而 引起 的 像素 强度 变化 场景 的 
观测值 记为 V obsv 由 理想 背景 场景 C 和 
有效 成分 组成 如 公式 1 所示 V obsv = 
C + N sys + M obj + M bgd 
+ S illum + D cam       1 
在 这里 我们 用 符号 + 来 表示 影响 因素 
的 累积 效果 实际上 上述 影响 因素 能 进一步 分为 
表 1 所示 的 不同 属性 首先 需要 被 强调 
的 属性 是 过程 我们 可以 按 过程 将 影响 
因素 分为 长期 影响 和 短期 影响 我们 沿 时间轴 
将 视频流 分成 长度 相等 的 块 如 所示 长期 
表示 影响 因素 会 持续 数 块 或者 一直 存在 
例如 N sys S illum 和D/nr cam 而 M obj 
和M/nr bgd 仅仅 偶尔 发生 不会 长期 持续 因此 我们 
称之为 短期 影响 另一种 分类 的 标准 是 偏差 我们 
把 illum D cam M bgd 看作 时间 不变 的 
常驻 偏差 影响 在 较长 的 过程 中 这些 影响 
可以 看作 是 对 理想 背景 值 C 持久 的 
增加 减少 或者 替代 以 illum 为例 如果 处于 室内 
场景 并且 打开 照明 在 接下来 的 帧 中 illum 
可以 看成 是 对 C 持久 的 增加 而 N 
sys 和M/nr obj 在 不同 时 刻有 随机 的 值 
我们 称之为 随 时间 变化 的 随机 偏差 影响 上述 
分析 归纳 到了 表 1中 表 1 影响 因素 的 
分类 长期           短期 常驻 偏差 
      illum D cam       M 
bgd 随机 偏差       N sys     
                M obj 
在此 必须 阐明 以下 两点 1 上述 分类 并不 绝对 
取决于 我们 选择 的 块 长度 但是 它 不 影响 
我们 接下来 的 分析 2 也许 某人 会 指出 对 
illum 的 分类 不正确 例如 行驶 汽车 的 灯光 不是 
长期 影响 这种 情况下 的 光照 变化 属于 短期 影响 
跟 M obj 类似 因此 我们 不把 它 单独 列 
为 独立 的 影响 因素 由于 illum 和D/nr cam 对 
理想 背景 C 有 长期 持续 的 偏差 我们 将 
它们 合并 到 理想 背景 中 得到 C = C 
+ S illum + D cam 对 这种 合并 的 
直接 解释 是 如果 光照 发生变化 或者 摄像机 变动 位置 
我们 有 理由 假设 理想 背景 已经 改变 因此 将 
公式 1 表示 成 V obsv = C + N 
sys + M obj + M bgd       
2 到 目前 为止 观测值 V obsv 由 新的 理想 
背景 值 C 和 影响 因素 N sys M obj 
M bgd 组成 这些 影响 因素 对 C 有 不同 
的 影响 归纳 成 以下 两点 N sys 在整个 视频流 
中 存在 并对 C 有 些许 影响 因此 大部分 观测值 
都不会 偏离 C 太远 M obj 和M/nr bgd 仅仅 偶尔 
发生 但对 C 引起 很大 的 偏差 因此 仅仅 小部分 
观测值 显著 的 不同 于C/nr 得出 以 下结论 空间 位置 
的 像素 值 在 大部分 时间 内 保持 稳定 并 
伴随 些许 偏差 由于 长期 存在 的 随机 偏差 N 
sys 仅仅 当 运动 对象 通过 该 像素 时 引起 
显著 的 偏差 由于 短期 偏差 M obj 和M/nr bgd 
因此 一段 时间 内 少数 显著 偏差 形成 了 极值 
大 部分 时间 都 存在 这种 属性 不过 有时 也 
并非如此 在 中 显示 了 白色 圆心 处 像素 值 
随 时间 而 变化 的 图表 a c 节选自 一段 
长达 360 帧 的 视频 d 描绘 了 像素 强度 
的 变化 从 d 我们 可以 看出 由 系统 噪声 
引起 的 小幅度 偏差 占据 了 大部分 时间 仅 当 
有 运动 对象 及其 阴影 经过 时 引起 了 显著 
的 偏差 这与 影响 因素 描述 是 相符 的 我们 
的 任务 是 从 观测值 序列 { V obsv t 
} t = 1 . . . . T T 
指 时间 长度 中 找到 理想 背景 C 的 估计值 
C ^ 通过 上述 分析 我们 发现 C ^ 位于 
多数 观测值 的 中点 从 另一方面 来看 C ^ 处于 
潜在 分布 梯度 为 0 和最/nr 密集 的 地方 这个 
任务 可由 Mean Shift 过程 来 完成 我们 将 C 
^ 称为 最 可靠 背景 状态 3 用于 运动 对象 
检测 的 最 可靠 背景 状态 基于 第二节 所讲 的 
影响 因素 描述 我们 推知 大部分 观测值 所处 区域 的 
中心 是 背景 的 理想 估计 我们 将 这个 估计 
用 符号 C ^ 表示 并 称为 最 可靠 背景 
状态 MRBM 定位 MRBM 的 基本 计算 方式 是 Mean 
Shift 一方面 通过 使用 MRBM 我们 能够 为 混乱 运动 
对象 的 视频 生成 非常 清晰 的 背景 图像 另一方面 
Mean Shift 过程 能 发现 强度 分布 的 一些 局部 
极值 这种 信息 能从 真实 的 运动 对象 中 区别 
出 运动 的 背景 例如 户外 随风 摆动 的 树枝 
或者 水中 的 波纹 3.1 用于 MRBM 的 Mean ShiftMean 
Shift 是 定位 密度 极值 的 简明 方式 密度 极值 
处 的 梯度 为 0 . 该 理论 由 Fukunaga 
在 文献 18 中 提出 而 Mean Shift/w 的/uj 平滑/a 
性/n 和/c 收敛性/vn 由/p Comaniciu/w 和/c Meer/w 在/p 文献/n 19 
中 证实 近几年 它 已成为 计算机 视觉 应用 的 有力 
工具 并 报道 了 许多 有 前途 的 成果 例如 
基于 Mean Shift 的 图像 分割 19 21 和 跟踪 
22 26 在 我们 的 工作 成果 中 我们 用 
Mean Shift 来 定位 强度 分布 的 极值 注意 可能 
有 多个 局部 极值 我们 将 最大 密度 状态 定义 
为 MRBM 算法 的 要点 如 所示 包括 下列 步骤 
样本 选择 我们 为 每个 像素 选择 一组 样本 = 
{ xi } i = 1 . . . n 
其中 xis 是 像素 沿 时间轴 的 强度 值 n 
是 样本 数目 我们 直接 对 样本 进行 Mean Shift 
运算 以便 定位 密度 的 极值 典型 点 选择 为了 
减少 计算 量 我们 从中/nr 选择 或者 计算 出 一组 
典型 点 典型 点 数目 为 m m n 并将 
这组 典型 点 记为 P = { pi } i 
= 1 . . . m P 中的 典型 点 
可以 是 样本 的 抽样 结果 也 可以 是 原始 
样本点 的 局部 平均值 在 我们 的 实验 中 我们 
选择 局部 平均值 Mean Shift 过程 从P/nr 中的 典型 样本点 
开始 运用 Mean Shift 过程 我们 可以 得到 收敛 点 
m 值得 注意 的 是 Mean Shift 计算 仍然 基于 
整个 样本点 集 所以 梯度 密度估计 的 精度 并未 因为 
使用 典型 点 而 降低 提取 候选 背景 模型 由于 
一些 收敛 点 非常 接近 甚至 完全 一样 这些 收敛 
点 m 可以 被 聚 集为 q 组 q ≤ 
m 我们 能够 获取 q 带 权重 的 聚集 中心 
C = { { ci wi } } i = 
1 . . . . q 其中 ci 是 每个 
聚集 中心 的 强度 值 wi 是 聚集 中心 的 
权重 每组 的 点数 记为 li i = 1 . 
. . . q ∑ i = 1qli = m 
每组 中心 的 权重 定义 为 wi = li / 
m i = 1 . . . . q 获取 
最 可靠 背景 模型 C ^ = ci * 其中 
i * = argi max { wi } C ^ 
是 第二 节 提到 的 最 可靠 背景 模型 MRBM 
算法 的 要点 对于 每个 m 典型 点 第三步 中的 
Mean Shift 实现 过程 依照 以下 步骤 1 初始化 Mean 
Shift 过程 的 起点 y1 = pi 2 反复 运用 
Mean Shift 过程 yt + 1 = . . . 
. 直至 收敛 这里 我们 选用 跟 文献 19 一样 
的 Mean Shift 过程 函数 g x 是 核 函数 
G x 3 保存 收敛 点 yconv 用于 后续 分析 
在对 所有 像素 运用 上述 步骤 之后 我们 能用 MRBM 
生成 背景 场景 B 通过 上述 分析 我们 发现 背景 
生成 过程 的 时间 复杂度 为 O N m 空间 
复杂度 为 O N n 其中 N 是 视频 的 
长度 3.2 运动 对象 检测 与 背景 模型 维持 生成 
背景 模型 之后 我们 可以 将 其 用于 检测 场景 
中 的 运动 区域 为了 使 我们 的 背景 模型 
对 运动 背景 具有 鲁棒性 例如 户外 随风 摆动 的 
树枝 或者 水中 的 波纹 我们 将 k 个 聚集 
中心 选为 可能 的 背景 值 我们 将 这组 集合 
定义 为 Cb = { { ci wi } | 
wi ≥ θ } i = 1 . . . 
. k 其中 Cb ⊆ C θ 是 预定义 的 
阀值 对于 每个 新 的 观测 强度 值 x0 我们 
仅仅 计算 x0 与 Cb 中 元素 的 最小 差值 
d 其中 d = min { x0 ci | { 
ci wi } ∈ Cb } 如果 差值 d 大于 
预定义 的 阀值 t 我们 认为 新 的 观测 强度 
值 是 前景 否则 为 背景 背景 维持 能让/nr 我们 
的 背景 模型 适应 长期 的 背景 变化 例如 新 
停泊 的 汽车 或者 逐渐 改变 的 光照 当 我们 
观察 一个 新 像素 值 时 背景 模型 按 下列 
步骤 来 更新 1 对 每个 新 像素 值 我们 
视 其为 新 典型 样本点 因此 典型 样本点 的 数目 
变为 m = m + 1 2 如果 新 像素 
值 属于 背景 区域 假设 其 强度 值 与 聚集 
中心 { ci wi } 最近 我们 将 该 中心 
的 权重 更新 为 wi =   li + 1 
/ m 3 如果 新 像素 值 属于 前景 区域 
我们 从 这点 开始 运用 新的 Mean Shift 过程 这样 
可以 获取 到 新的 收敛 中心 { cnew wnew } 
其中 wnew 初始 化为 wnew = 1 / m 聚集 
中心 C 被 扩充 成 C = C ∪ { 
{ cnew wnew } } 背景 减除 的 时间 复杂度 
是 O N 背景 维持 的 时间 复杂度 是 O 
R 其中 N 是 视频 的 帧数 R 是 运动 
对象 的 数目 4 实验 我们 专注 于 两类 MRBM 
应用 背景 生成 和 背景 减除 我们 在 合成视频 和 
标准 PETS 数据库 上 比较 MRBM 与 其他 常用 的 
方法 源代码 用 C + + 实现 测试 用 电脑 
的 配置 如下 CPU 为 Pentium 1 . 6GHZ 内存 
512M 我们 自己 捕获 或者 合成 的 视频 尺寸 为 
320 × 240 像素 PETS 数据库 的 视频 尺寸 为 
384/360 × 288 像素 帧速率 均为 25fps 在 所有 的 
实验 中 我们 选择 YUV 4 4 4 色彩 空间 
作为 特征 空间 算法 实现 的 描述 见 第三 节 
我们 采用 了 Epanechnikov 核 K t = 3 / 
4 * 1 t2 理论上 更大 的 训练 集 能 
得到 更 稳定 的 背景 模型 但是 会 牺牲 适应性 
我们 的 实验 表明 当 n = 100时 能够使 背景 
图像 得到 最佳 的 可视 质量 和 适应性 典型 点数 
m 影响 训练 时间 及 背景 模型 的 可靠性 在 
我们 的 实验 中 我们 为 Mean Shift 过程 选择 
m = 10个 典型 点 这时 的 训练 时间 与 
高斯 混合模型 接近 阀值 θ 和t/nr 影响 检测 的 精度 
对/p 不同/a 的/uj 数据集/i 可能/v 有/v 不同/a 的/uj θ/i 和t/nr 
在 我们 的 实验 中 当 θ = 0.3 t 
= 10时 能够 得到 最大 的 准确率 和 最小 的 
错误率 如果 没有 特别 说明 所有 实验 使用 上述 设置 
4.1 背景 生成 在 许多 监控 和 跟踪 应用 中 
期望 生成 没有 运动 对象 的 背景 图像 它 能为 
更进一步 的 分析 提供 参考 信息 但是 很多 时候 并不 
容易 获得 没有 运动 对象 的 的 视频 我们 的 
算法 能从 包含 混乱 运动 对象 的 视频 中 提取 
非常 清晰 的 背景 图像 显示 了 一些 生成 的 
背景 视频 共有 360 帧 我们 将 前 100 帧 
用于 生成 背景 图中 显示 了 第 1 33 66 
99 帧 图像 的 底部 显示 了 算法 生成 的 
背景 以 c 为例 这段 视频 摄 自 校园 的 
上 下课时间 每 帧 中 都有 10名 步行 的 学生 
观察 c 最 下面 的 背景 图像 我们 发现 背景 
非常 清晰 所有 运动 对象 都被/nr 成功 的 抹 去了 
运动 对象 的 移动 速度 是 关键 因素 它 能 
显著 的 影响 背景 模型 包括 我们 的 背景 模型 
我们 用 一段 300 帧 的 视频 来 评估 算法 
该 视频 里 有 一位 缓慢 走动 的 女士 第 
1 30 60 90 120 帧 图像 分别 显示 在 
a e 中 用 不同 数目 的 样本 图像 生成 
的 背景 显示 于 f j 当 保持 100 帧 
样本 图像 时 生成 的 背景 中 有 一些 噪点 
但是 背景 的 整体 质量 得以 保证 噪点 区域 用 
白色 椭圆 标 出了 如 f 所示 当 我们 将 
样本 数目 增加 到 300时 背景 变得 非常 清晰 如 
j 所示 我们 也 对 我们 的 背景 生成 方法 
与 其它 基本 方法 做了 比较 例如 高斯 模型 具有 
多个 聚集 中心 的 高斯 混合模型 为了 区分 比较 结果 
我们 合成 了 一段 多 模态 背景 分布 视频 背景 
的 像素 由 高斯 混合 分布 生成 pbg x = 
∑ i = 12 α iG μ i σ i 
x 其中 参数 α 1 = α 2 = 0.5 
σ 1 = σ 2 = 6 μ 1 = 
128 μ 2 = 240 前景 对象 的 像素 由 
高斯分布 生成 pfg x = G μ σ x 其中 
参数 μ = 10 σ = 6 上述 两式 中 
G μ σ 代表 具有 均值 μ 和 标准偏差 σ 
的 高斯分布 背景 像素 及 前景 像素 的 强度 分布 
见 视频 共有 120 帧 我们 用 前 100 帧 
来 生成 背景 a e 显示 了 一些 选定 的 
帧 生成 的 背景 图像 显示 在 f i 中 
从 潜在 分布 生成 的 地面实况 样本 显示 于 j 
中 对于 高斯 模型 背景 像素 的 强度 值 被选为 
高斯 均值 生成 的 背景 图像 如 f 所示 对于 
高斯 混合模型 我们 选择 带 maxim 的 高斯 混合 均值 
为 背景 值 g 显示 了 2个 中心 的 高斯 
混合模型 h 显示 了 3个 中心 的 高斯 混合模型 实验 
所用 的 高斯 混合模型 使用 OpenCV 中的 实现 见 文献 
27 MRBM 方法 得到 的 结果 如 i 所示 比较 
地面实况 图像 和 生成 的 背景 图像 我们 发现 非 
参数 模型 MRBM 优于 其它 方法 凭直觉 在 处理 多模 
分布 时 MRBM 看起来 与 高斯 混合模型 类似 但是 关键 
的 不同 之 处 在于 高斯 模型 依赖 均值 和 
方差 它们 的 1 阶 和2阶/nr 统计 数据 对 外部 
点 outliers 远离 数据 峰值 的 点 非常 敏感 如果 
对象 的 运动 速度慢 存在 足够 的 前景 值 导致 
错误 的 均值 结果 得出 错误 的 背景 值 作为 
对照 MRBM 跟 分布 无关 仅仅 使用 极值 作为 可能 
的 背景 值 它 对外部 点 更 鲁棒 其他 参数 
方法 存在 类似 的 问题 当 预定义 的 模型 不能 
描述 数据分布 时 更加 明显 4.2 背景 减除 显示 了 
我们 算法 的 背景 减除 结果 a 显示 观测 到 
的 当前 帧 b 显示 用 MRBM 从 100 帧 
样本 生成 的 背景 图像 c 显示 了 背景 减除 
的 结果 图像 我们 发现 运动 对象 变得 很 突出 
我们 比较 了 MRBM 和 其它 常用 的 基本 方法 
例如 文献 1 中 的 最大 最小值 法 文献 28 
29 中的 中值 法 文献 8 6 中的 高斯 混合模型 
比较 结果 显示 于 由于 我们 不能 修改 这些 原始 
工作 成果 的 实现 方式 只能 按 以下 方式 来 
管理 基础 算法 1 对于 W4 我们 按 原始 成果 
中 的 建议 来 设置 参数 2 对于/p 中值/n 法和/nr 
高斯/nr 混合模型/i 我们 调整 参数 使其 达到 最好 的 检测 
精度 另外 为了 使 比较 尽量 公平 我们 只 做 
背景 减除 没有 进行 降噪 和 形态学 处理 最佳 的 
视频 序列 选自 PETS 数据库 30 32 选定 帧 如 
a 所示 对 所有 的 视频 序列 我们 用 100 
帧 来 生成 背景 用 第 40 帧 做 背景 
减除 这些 视频 序列 包含 两 种 主要 的 场景 
缓慢 运动 的 对象 如 PETS00 和 PETS06 多 模态 
背景 如 PETS01 中 摆动 的 树 这两种 场景 是 
背景 减除 中的 不同情况 对于 缓慢 运动 的 对象 高斯 
模型 的 结果 比较 差 因为 高斯 均值 对外部 点 
敏感 如 d 所示 而 MRBM 依赖于 背景 分布 的 
极值 外部 点 对其 影响 很小 同样 中值/n 法和/nr 最大/a 
最小值/l 法/l 不能/v 很好/i 的/uj 应对/v 多/m 模态/n 背景/n PETS01 
中 摆动 的 树 被 误认为 前景 跟 预期 一致 
MRBM 优于 其它 三 种方法 4.3 讨论 可能 的 欠缺 
尽管 MRBM 适用于 许多 应用 仍然 存在 一些 不 能 
应对 的 场合 就是 不能 应对 的 例子 在 这个 
实验 中 视频 共有 300 帧 我们 用 前 120 
帧 来 生成 背景 a g 分别 显示 了 第 
1 20 40 60 80 100 120 帧 背景 图像 
显示 在 h 中 前景 人物 的 很大 一部分 被 
误认为 背景 通常 前景/n 和/c 背景/n 的/uj 定义/n 从/p 自身/r 
来看/u 并不/i 明确/ad 它 包含 在 场景 的 语义 中 
在 不同 的 应用 中 可能 不 一致 在 我们 
的 应用 中 我们 将 运动 对象 定义 为 前景 
将 静止 或者 几乎 静止 的 东西 定义 为 背景 
这与 大多数 视频 监控 应用 的 定义 一致 通过 第二 
节 的 分析 我们 试图 用 ECD 模型 来 近似 
观测值 在 的 实验 中 人物 在 大部分 时间 保持 
静止 然后 突然 运动 这种 情况 下 大部分 观测 强度 
值 属于 人物 而非 背景 对于 人物 的 肩膀 部分 
尤其 明显 肩膀 部分 有 相似 的 颜色 以致于 检测 
不到 运动 因此 前景 人物 的 大部分 被 误认为 背景 
实际上 这个 例子 反映 了 背景 模型 的 根本 问题 
稳定性 与 适应性 理论上 如果 我们 增加 用于 训练 的 
背景 帧数 我们 能 得到 更 清晰 的 背景 图像 
但是 同时 会 极大 的 牺牲 背景 模型 的 适应性 
当 背景 改变 例如 新 停泊 的 汽车 或者 突然 
改变 的 光照 背景 模型 需要 很长 的 时间 才能 
适应 新 情况 将 产生 大量 的 错误 针对 该 
问题 一种 有效 的 解决 方案 是 将 现有 的 
基于 像素 的 方法 扩展 为 基于 区域 或者 基于 
帧 的 方法 通过 分割 图像 或者 完善 像素 级 
的 低级 分类 可以 实现 它 更进一步 可以 同时 使用 
低级 对象 分割 和 高级 信息 例如 跟踪 或者 事件 
描述 因此 我们/r 接下来/l 的/uj 工作/vn 将/d 专注/v 于/p 如何/r 
结合/v 空间/n 和/c 高级/b 信息/n 5 结论 本文 主要 有 
两点 贡献 1 我们 介绍 的 影响 因素 描述 可 
用于 对 变化 的 背景 进行 建模 2 基于 ECD 
我们 开发 了 一种 鲁棒 的 背景 生成 方法 最 
可靠 背景 模型 应用 MRBM 能从 包含 混乱 运动 对象 
的 视频 序列 中 生成 高质量 的 背景 图像 一些 
例子 显示 了 这种 方法 的 有效性 和 鲁棒性 然而 
仍然 存在 一些 有待 解决 的 问题 当前 的 工作 
中 仅仅 考虑 了 像素 的 时间 信息 怎么 结合 
空间 信息 来 提高 本 方法 的 鲁棒性 是 后续 
工作 的 重点 一种 直接 的 扩展 是 将 当前 
基于 像素 的 方法 修 改成 熔合 了 邻域 信息 
基于 区域 的 方法 另外 结合 使用 低级 分割 和 
高级 跟踪 信息 对 我们 的 工作 成果 也 将有 
极大 的 提高 6 致谢/v 在此/i 要/v 感谢/v 陈熙/i 霖/nr 
博士/n 和/c 山世光/nr 博士/n 他们 跟 作者 进行 了 很有帮助 
的 讨论 这项 研究 的 经费 由 以下 单位 赞助 
中国 自然科学 基金会 中国科学院 百名 人才 培养 计划 上海 银 
晨 智能 识别 科技 有限公司 参考文献 1 I . Haritaoglu 
D . Harwoodand L . . Davis W4 real time 
surveillance of people and their activities IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 809 – 830 
. 2 K . Toyama J . Krumm B . 
Brumitt B . Meyers . WallFlower Principles and Practice of 
background maintenance in IEEE International Conferenceon Computer Vision Corfu Greece 
1999 pp . 255 – 261 . 3 A . 
Elgammal D . Harwood L . Davis Non parametric model 
for background subtraction in European Conference on Computer Vision Dublin 
Ireland 2000 pp . 751 – 767 . 4 T 
. E . Boult R . J . Micheals X 
. Gao M . Eckmann Intothewoods visual Surveillance of noncooperative 
and camouflaged targets in complex outdoorsettings Proceedings of the IEEE 
89 2001 1382 – 1402 . 5 C . R 
. Wren A . Azarbayejani T . Darrell A . 
P . Pentland Pfinder Real time Tracking of the human 
body IEEE Transactions on Pattern Analysis andMachine Intelligence 19 7 
1998 780 – 785 . 6 C . Stauffer W 
. Grimson Adaptive background mixture models for real time tracking 
in IEEE Conference on Computer Vision and Pattern Recognition FortCollins 
USA 1999 pp . 246 – 252 . 7 . 
Rowe A . Blake Statistical background modelling for tracking with 
a virtual camera in British Machine Vision Conference Birmingham UK 
1995 pp . 423 – 432 . 8 C . 
Stauffer W . E . L . Grimson Learning patterns 
of activity using real time tracking IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 747 – 757 
. 9 L . Li W . Huang I . 
Y . Gu Q . Tian Foreground object detection in 
changing Background based on color co occurrence statistics in IEEE 
Workshop on Applications of Computer Vision Orlando Florida 2002 pp 
. 269 – 274 . 10 P . KaewTraKulPong R 
. Bowden An improved adaptive background mixture Model for real 
time tracking with shadow detection in European Workshop on Advanced 
Video Based Surveillance Systems Kluwer Academic 2001 . 11 K 
. Kim T . Chalidabhongse D . Harwood L . 
Davis Real time foreground Background segmentation using codebook model Real 
Time Imaging 11 3 2005 172 – 185 . 12 
A . Elgammal R . Duraiswami L . Davis Effcient 
non parametric adaptive color Modeling using fast gauss transform in 
IEEE Conference on Computer Vision And Pattern Recognition Vol . 
2 2001 pp . 563 – 570 . 13 A 
. M . Elgammal R . Duraiswami L . . 
Davis Effcient kernel density estimation Using the fast gauss transform 
with applications to color modeling and tracking . IEEE Transactions 
on Pattern Analysis and Machine Intelligence 25 11 2003 1499 
– 1504 . 14 A . Elgammal Effcient nonparametric kernel 
density estimation for realtime computer vision Ph . D . 
thesis Rutgers The State University of New Jersey 2002 . 
15 H . Askar X . Li Z . Li 
Background clutter suppression and dim moving point Targets detection using 
nonparametric method in International Conference on Communications Circuits and Systems 
and West Sino Expositions Vol . 2 2002 pp . 
982 – 986 . 16 D . Thirde G . 
Jones Hierarchical probabilistic models for video object Segmentation and tracking 
in International Conference on P a t t e r 
n R e c o g n i t i 
o n Vol . 1 2004 pp . 636 – 
639 . 17 T . Liu A . W . 
Moore A . Gray Effcient exact k nn and nonparametric 
Classification in high dimensions in Neural Information Processing Systems 2003 
pp . 265 – 272 . 18 K . Fukunaga 
L . Hostetler The estimation of the gradient of adensity 
function With applications in pattern recognition IEEE Transactions on Information 
Theory 21 1975 32 – 40 . 19 D . 
Comaniciu P . Meer Mean shift a robust approach toward 
feature space analysis IEEE Transactions on Pattern Analysis and Machine 
Intelligence 24 5 2002 603 – 619 . 20 I 
. Y . H . Gu V . Gui Colour 
image segmentation using adaptive mean shift filters in International Conference 
on Image Processing 2001 pp . 726 – 729 . 
21 L . Yang P . Meer D . J 
. Foran Unsupervised segmentation based on robust Estimation and color 
active contour models IEEE Transactions on Information Technology in Biomedicine 
9 3 2005 475 – 486 . 22 D . 
Comaniciu V . Ramesh P . Meer Kernel based object 
tracking IEEE Transactions on Pattern Analysis and Machine Intelligence 25 
5 2003 564 – 577 . 23 R . T 
. Collins Y . Liu On line selection of discrimin 
ative tracking features in International Conference on Computer Vision 2003 
pp . 346 – 352 . 24 R . Collins 
Y . Liu M . Leordeanu On line selection of 
discriminative tracking features IEEE Transactions on Pattern Analysis and Machine 
Intelligence 27 10 2005 1631 – 1643 . 25 O 
. Debeir P . V . Ham R . Kiss 
C . Decaestecker Tracking of migrating cells under phase contrast 
video microscopy with combined mean shift processes IEEE Transactions on 
Medical Imaging 24 6 2005 697 – 711 . 26 
C . Shen M . J . Brooks A . 
van den Hengel Fast global kernel density Mode seeking with 
application to localisation and tracking in I n t e 
r n a t i o n a l C 
o n f e r e n c e on 
Computer Vision 2005 pp . 1516 – 1523 . 27 
Intel open source computer vision library 2004 . URL http 
/ / www . intel . com / technology / 
computing / opencv / 28 B . Lo . Velastin 
Automatic congestion detection system for underground platforms in International Symposium 
on Intelligent Multimedia Video and Speech Processing Hong Kong China 
2001 pp . 158 – 161 . 29 R . 
Cucchiara C . Grana M . Piccardi A . Prati 
Detecting moving objects ghosts and shadows in video streams IEEE 
Transactions on Pattern Analysis and Machine Intelligence 25 10 2003 
1337 – 1342 . 30 IEEE international workshop on performance 
evaluation of tracking and surveillance 2000 . URL ftp / 
/ ftp . pets . rdg . ac . uk 
/ pub / PETS2000 / 31 IEEE international workshop on 
performance evaluation of tracking and surveillance 2001 . URL ftp 
/ / ftp . pets . rdg . ac . 
uk / pub / PETS2001 / 32 IEEE international workshop 
on performance evaluation of tracking and surveillance 2006 . URL 
http / / pets2006 . net / data . html 
写在 最后 的话 本文 所述 的 方法 可说是 像素 级 
背景 建模 方式 的 巅峰 之作 在 接下来 的 时间 
里 我 将 尝试 按照 我 自己 的 理解 来 
实现 文中 的 算法 对于 论文 中 没有 讲述 透彻 
的 部分 我 也 试图 完善 它 敬请期待 在 翻译 
文章 的 过程 中 得到 了 赵德 斌 博士 的 
指导 在此 表示 感谢 同时 也 感谢 您 耐心 看完 
希望 对 您 有所 帮助 欲 知 后事 如何 且听 
下回分解 转 自 http / / www . cnblogs . com 
/ xrwang / archive / 2010 / 03/27 / B 
a c k g r o u n d G 
e n e r a t i o n A 
n d F o r e g r o u 
n d D e t e c t i o 
n P h a s e 2 . html 作者 
王先荣/nr 本文/r 尝试/vn 对/p 学习 OpenCV 中 推荐 的 论文 
Nonparametric Background Generation 进行 翻译 由于 我 的 英文 水平 
很差 断断续续 搞了 好 几天 才 勉强 完成 里面 肯定 
会 有 诸多 错误 欢迎 大家 指正 并请 多多 包涵 
翻译 本文 的 目的 在于 学习 研究 如果 需要 用于 
商业 目的 请与 原文 作者 联系 非 参数 背景 生成 
刘亚洲 姚 鸿勋 高文 陈熙 霖 赵德 斌 哈尔滨工业大学 中国科学院计算所 
摘要 本文 介绍 了 一种 新颖 的 背景 生成 方法 
该 方法 基于 非 参数 背景 模型 可 用于 背景 
减除 我们 介绍 一种 新的 名为 影响 因素 描述 effect 
components description ECD 的 模型 用于 描述 背景 的 变动 
在此 基础 上 我们 可以 用 潜在 分布 的 局部 
极值 推导 出 最 可靠 背景 状态 most reliable background 
mode MRBM 该 方法 的 基本 计算 过程 采用 Mean 
Shift 这一 经典 的 模式识别 过程 Mean Shift 通过 迭代计算 
能够 在 数据 的 密度 分布 中找到 最近 位置 的 
点 译者 注 即 找到 数据 最 密集 的 点 
这种 方法 有 三个 优点 1 能从 包含 混乱 运动 
对象 的 视频 中 提取 出 背景 2 背景 非常 
清晰 3 对 噪声 和小/nr 幅度 的 摄像机 振动 具有 
鲁棒性 广泛 的 实验 结果 证明 了 上述 优点 关键词 
背景 减除 背景 生成 Mean Shift 影响 因素 描述 最 
可靠 背景 状态 视频 监视 1 引言 在 许多 计算机 
视觉 和 视频 分析 应用 中 运动 对象 的 分割 
是 一项 基本 任务 例如 视频 监视 多媒体 索引 人物 
检测 和 跟踪 有 知觉 的 人机接口 小精灵 视频编码 精确 
的 对象 分割 能 极大 的 提高 对象 跟踪 识别 
分类 和 动态 分析 的 性能 识别 运动 对象 的 
通用 方法 有 光 流 基于 时间差 异或 背景 减除 
的 方法 其中 背景 减除 最 常用 背景 模型 被 
计算 出 并 逐 帧 进化 然后 通过 比较 当前 
帧 和 背景 模型 间 的 差异 来 检测 运动 
对象 这种 方法 的 关键 之 处 在于 建立 并 
维持 背景 模型 尽管 文献 1 4 提出 了 很多 
有 前途 的 方法 但是 运动 对象 检测 的 精度 
这一 基本 问题 仍然 难以 解决 第一 个 问题 是 
背景 模型 必须 尽可能 精确 的 反映 真实 背景 这样 
系统 才能 精确 的 检测 运动 对象 的 外形 第二 
个 问题 是 背景 模型 必须 对 背景 场景 的 
改变 足够 灵敏 例如 对象 开始 运动 及 停止 运动 
如果 不能 适当 的 解决 上述 问题 背景 减除 会 
检测 出 虚假 对象 它们 通常 被 称为 幽灵 目前/t 
已经/d 有了/nr 许多/m 用于/v 背景/n 减除/v 的/uj 背景/n 建立/v 和/c 
维持/v 方法/n 按 背景 建模 的 步骤 来 分类 我们 
可以 将 其 分为 参数 化 的 和非/nr 参数 化 
的 方法 参数 化 的 背景 建模 方法 通常 假设 
单个 像素 的 潜在 概率密度函数 是 高斯 或者 高斯 混合 
函数 详情请 参看 文献 5 7 Stauffer 和 Grimson 在 
文献 8 中 提出 了 一种 自适应 的 背景 减除 
方法 用于 解决 运动 分割 问题 在 他们 的 工作 
成果 中 他们 为 每个 像素 建立 了 高斯 混合 
概率密度函数 然后 用 即时 的 近似值 更新 该 模型 文献 
9 10 提出 了 对 高斯 混合模型 的 一些 改进 
方法 Toyama 等人 在 文献 2 中 提出 了 一种 
三层 的 Wallflower 方案 该 方案 尝试 解决 背景 维持 
中 现存 的 许多 问题 例如 灯光 打开 关闭 前景 
孔穴 等等 Haritaoglu 等人 在 文献 1 中 提出 的 
W4 方法 该 方法 为 背景 建模 而对 每个 像素 
保留 了 三个 值 的 方法 包括 最大值 M 最小值 
N 和 最大 帧 间 绝对 差值 D Kim 等人 
在 文献 11 中 将 背景 值 量化 到 编码本 
编码本 描述 了 长 视频 中 背景 模型 的 压缩 
形式 另一类 经常 用到 的 背景 模型 方法 基于 非 
参数 化 的 技术 例如 文献 3 12 16 Elgammal 
等人 在 文献 3 中 通过 核 密度估计 建立 了 
一种 非 参数 化 的 背景 模型 对 每个 像素 
为了 估计 潜在 的 概率密度函数 而 保留 了 观测 强度 
值 而 新 强度 值 的 概率 能 通过 该 
函数 计算 得出 这种 模型 具有 鲁棒性 能够 适应 混乱 
及 不完全 静止 但 包含 小 扰动 场合 下 的 
背景 例如 摆动 的 树枝 和 灌木 与 参数 化 
的 背景 模型 方法 相比 非 参数 化 的 背景 
模型 方法 具有 以下 优点 不 需要 指定 潜在 的 
模型 不 需要 明确 的 估计 参数 14 因此 它们 
能 适应 任意 未知 的 数据分布 这个 特性 使 非 
参数 化 的 方法 成为 许多 计算机 视觉 应用 的 
有力 工具 在 许多 计算机 视觉 应用 中 许多问题 牵涉到 
多元 多种 形式 的 密度 数据 在 特征 空间 中 
没有 规则 的 形态 没有 遵循 标准 的 参数 形式 
但是 从/p 时间/n 和/c 空间/n 复杂度/n 这/r 一方面/mq 来看/u 非 
参数 化 的 方法 不如 参数 化 的 方法 有效 
参数 化 的 方法 产生 简洁 的 密度 描述 例如 
高斯 或 高斯 混合 得出 有效 的 估计 状态 相对 
的 非 参数 化 的 方法 在 学习 阶段 几乎 
不 需要 计算 然而 在 评估 阶段 需要 高 密度 
的 计算 因此 非 参数 化 方法 的 主要 缺陷 
是 它们 的 计算 量 不过 一些 革新 的 工作 
成果 已经 被 提出 它们 能 加快 非 参数 化 
方法 的 评估 速度 例如 文献 13 中 的 快速 
高斯 变换 FGT 文献 17 中的 新 ball tree 算法 
核 密度估计 和K/nr 近邻 KNN 分类 本文 专注 于非/nr 参数 
化 的 方法 跟 Elagammal 在 文献 3 中 提出 
的 方法 有 紧密 的 联系 但是 有 两点 本质上 
的 区别 从 基本 原理 上看 我们 用 影响 因素 
描述 ECD 来 为 背景 的 变化 建模 最 可靠 
背景 模型 MRBM 对 背景 场景 的 估计 具有 鲁棒性 
从 计算 过程 来看 通过 使用 Mean Shift 过程 我们 
避免了 对 每个 新 观测 强度 值 计算 概率 的 
核 密度估计 过程 节约 了 处理 时间 在 我们 的 
方法 中 仅用 帧 差 即 可决定 像素 的 属性 
因此/c 能/v 提高/v 背景/n 减除/v 的/uj 鲁棒性/nr 和/c 效率/n 本文 
余下 的 部分 按 以下 方式 来 组织 第二节 中 
提出 了 影响 因素 描述 用于 反映 背景 的 变化 
第三节 详细 解释 了 最 可靠 背景 模型 第四节 包含 
了 实验 结果 第五节 讨论 了 有待 扩充 的 部分 
2 影响 因素 描述 本节 讨论 影响 因素 描述 ECD 
我们 试图 通过 它 来 有效 的 模拟 背景 的 
变化 背景 减除 的 关键 因素 在于 怎样 建立 并 
维持 好 的 背景 模型 由于 在 不同 的 应用 
中 摄像机 类型 捕获 的 环境 和 对象 完全 不同 
背景 模型 需要 足够 的 自适应 能力 来 适应 不同 
的 情况 为了 有效 的 为 背景 建模 我们 从最/nr 
简单 的 理想 情况 开始 在 理想 情况下 对于 视频 
中 的 每个 空间 位置 沿 时间轴 的 强度 值 
为 常量 C 常量 C 表示 固定 摄像机 摄录 了 
固定 的 场景 没有 运动 对象 和 系统 噪声 我们 
将 这种 情况下 的 场景 称为 理想 背景 场景 但是 
在 实际 应用 中 很少 能 遇到 这种 理想 情况 
因此 背景 像素 可以 看成 是 理想 背景 场景 和 
其他 影响 部分 的 组合体 我们 将 这种 方法 定义 
为 背景 的 影响 成分 描述 包括 以下 方面 系统 
噪声 N sys 它 由 图像 传感器 和 其他 硬件 
设备 引起 如果 环境 不太 严密 系统 噪声 不会 从 
根本 上 影响 常量 C 仅仅 引起 适度 的 偏差 
运动 的 对象 M obj 它 由 实际 运动 的 
对象 及其 阴影 引起 大多数 时候 它 对 C 有 
极大 的 干扰 运动 的 背景 M bgd 它 由 
运动 的 背景 区域 引起 例如 户外 场景 中 随风 
摆动 的 树枝 或者 水中 的 波纹 光照 S illum 
它 表示 户外 随 太阳 位置 改变 而 渐变 的 
光照 或者 室内 灯光 的 关闭 和 打开 而 改变 
的 照明 摄像机 位移 D cam 它 表示 摄像机 的 
小幅度 位移 而 引起 的 像素 强度 变化 场景 的 
观测值 记为 V obsv 由 理想 背景 场景 C 和 
有效 成分 组成 如 公式 1 所示 V obsv = 
C + N sys + M obj + M bgd 
+ S illum + D cam       1 
在 这里 我们 用 符号 + 来 表示 影响 因素 
的 累积 效果 实际上 上述 影响 因素 能 进一步 分为 
表 1 所示 的 不同 属性 首先 需要 被 强调 
的 属性 是 过程 我们 可以 按 过程 将 影响 
因素 分为 长期 影响 和 短期 影响 我们 沿 时间轴 
将 视频流 分成 长度 相等 的 块 如 所示 长期 
表示 影响 因素 会 持续 数 块 或者 一直 存在 
例如 N sys S illum 和D/nr cam 而 M obj 
和M/nr bgd 仅仅 偶尔 发生 不会 长期 持续 因此 我们 
称之为 短期 影响 另一种 分类 的 标准 是 偏差 我们 
把 illum D cam M bgd 看作 时间 不变 的 
常驻 偏差 影响 在 较长 的 过程 中 这些 影响 
可以 看作 是 对 理想 背景 值 C 持久 的 
增加 减少 或者 替代 以 illum 为例 如果 处于 室内 
场景 并且 打开 照明 在 接下来 的 帧 中 illum 
可以 看成 是 对 C 持久 的 增加 而 N 
sys 和M/nr obj 在 不同 时 刻有 随机 的 值 
我们 称之为 随 时间 变化 的 随机 偏差 影响 上述 
分析 归纳 到了 表 1中 表 1 影响 因素 的 
分类 长期           短期 常驻 偏差 
      illum D cam       M 
bgd 随机 偏差       N sys     
                M obj 
在此 必须 阐明 以下 两点 1 上述 分类 并不 绝对 
取决于 我们 选择 的 块 长度 但是 它 不 影响 
我们 接下来 的 分析 2 也许 某人 会 指出 对 
illum 的 分类 不正确 例如 行驶 汽车 的 灯光 不是 
长期 影响 这种 情况下 的 光照 变化 属于 短期 影响 
跟 M obj 类似 因此 我们 不把 它 单独 列 
为 独立 的 影响 因素 由于 illum 和D/nr cam 对 
理想 背景 C 有 长期 持续 的 偏差 我们 将 
它们 合并 到 理想 背景 中 得到 C = C 
+ S illum + D cam 对 这种 合并 的 
直接 解释 是 如果 光照 发生变化 或者 摄像机 变动 位置 
我们 有 理由 假设 理想 背景 已经 改变 因此 将 
公式 1 表示 成 V obsv = C + N 
sys + M obj + M bgd       
2 到 目前 为止 观测值 V obsv 由 新的 理想 
背景 值 C 和 影响 因素 N sys M obj 
M bgd 组成 这些 影响 因素 对 C 有 不同 
的 影响 归纳 成 以下 两点 N sys 在整个 视频流 
中 存在 并对 C 有 些许 影响 因此 大部分 观测值 
都不会 偏离 C 太远 M obj 和M/nr bgd 仅仅 偶尔 
发生 但对 C 引起 很大 的 偏差 因此 仅仅 小部分 
观测值 显著 的 不同 于C/nr 得出 以 下结论 空间 位置 
的 像素 值 在 大部分 时间 内 保持 稳定 并 
伴随 些许 偏差 由于 长期 存在 的 随机 偏差 N 
sys 仅仅 当 运动 对象 通过 该 像素 时 引起 
显著 的 偏差 由于 短期 偏差 M obj 和M/nr bgd 
因此 一段 时间 内 少数 显著 偏差 形成 了 极值 
大 部分 时间 都 存在 这种 属性 不过 有时 也 
并非如此 在 中 显示 了 白色 圆心 处 像素 值 
随 时间 而 变化 的 图表 a c 节选自 一段 
长达 360 帧 的 视频 d 描绘 了 像素 强度 
的 变化 从 d 我们 可以 看出 由 系统 噪声 
引起 的 小幅度 偏差 占据 了 大部分 时间 仅 当 
有 运动 对象 及其 阴影 经过 时 引起 了 显著 
的 偏差 这与 影响 因素 描述 是 相符 的 我们 
的 任务 是 从 观测值 序列 { V obsv t 
} t = 1 . . . . T T 
指 时间 长度 中 找到 理想 背景 C 的 估计值 
C ^ 通过 上述 分析 我们 发现 C ^ 位于 
多数 观测值 的 中点 从 另一方面 来看 C ^ 处于 
潜在 分布 梯度 为 0 和最/nr 密集 的 地方 这个 
任务 可由 Mean Shift 过程 来 完成 我们 将 C 
^ 称为 最 可靠 背景 状态 3 用于 运动 对象 
检测 的 最 可靠 背景 状态 基于 第二节 所讲 的 
影响 因素 描述 我们 推知 大部分 观测值 所处 区域 的 
中心 是 背景 的 理想 估计 我们 将 这个 估计 
用 符号 C ^ 表示 并 称为 最 可靠 背景 
状态 MRBM 定位 MRBM 的 基本 计算 方式 是 Mean 
Shift 一方面 通过 使用 MRBM 我们 能够 为 混乱 运动 
对象 的 视频 生成 非常 清晰 的 背景 图像 另一方面 
Mean Shift 过程 能 发现 强度 分布 的 一些 局部 
极值 这种 信息 能从 真实 的 运动 对象 中 区别 
出 运动 的 背景 例如 户外 随风 摆动 的 树枝 
或者 水中 的 波纹 3.1 用于 MRBM 的 Mean ShiftMean 
Shift 是 定位 密度 极值 的 简明 方式 密度 极值 
处 的 梯度 为 0 . 该 理论 由 Fukunaga 
在 文献 18 中 提出 而 Mean Shift/w 的/uj 平滑/a 
性/n 和/c 收敛性/vn 由/p Comaniciu/w 和/c Meer/w 在/p 文献/n 19 
中 证实 近几年 它 已成为 计算机 视觉 应用 的 有力 
工具 并 报道 了 许多 有 前途 的 成果 例如 
基于 Mean Shift 的 图像 分割 19 21 和 跟踪 
22 26 在 我们 的 工作 成果 中 我们 用 
Mean Shift 来 定位 强度 分布 的 极值 注意 可能 
有 多个 局部 极值 我们 将 最大 密度 状态 定义 
为 MRBM 算法 的 要点 如 所示 包括 下列 步骤 
样本 选择 我们 为 每个 像素 选择 一组 样本 = 
{ xi } i = 1 . . . n 
其中 xis 是 像素 沿 时间轴 的 强度 值 n 
是 样本 数目 我们 直接 对 样本 进行 Mean Shift 
运算 以便 定位 密度 的 极值 典型 点 选择 为了 
减少 计算 量 我们 从中/nr 选择 或者 计算 出 一组 
典型 点 典型 点 数目 为 m m n 并将 
这组 典型 点 记为 P = { pi } i 
= 1 . . . m P 中的 典型 点 
可以 是 样本 的 抽样 结果 也 可以 是 原始 
样本点 的 局部 平均值 在 我们 的 实验 中 我们 
选择 局部 平均值 Mean Shift 过程 从P/nr 中的 典型 样本点 
开始 运用 Mean Shift 过程 我们 可以 得到 收敛 点 
m 值得 注意 的 是 Mean Shift 计算 仍然 基于 
整个 样本点 集 所以 梯度 密度估计 的 精度 并未 因为 
使用 典型 点 而 降低 提取 候选 背景 模型 由于 
一些 收敛 点 非常 接近 甚至 完全 一样 这些 收敛 
点 m 可以 被 聚 集为 q 组 q ≤ 
m 我们 能够 获取 q 带 权重 的 聚集 中心 
C = { { ci wi } } i = 
1 . . . . q 其中 ci 是 每个 
聚集 中心 的 强度 值 wi 是 聚集 中心 的 
权重 每组 的 点数 记为 li i = 1 . 
. . . q ∑ i = 1qli = m 
每组 中心 的 权重 定义 为 wi = li / 
m i = 1 . . . . q 获取 
最 可靠 背景 模型 C ^ = ci * 其中 
i * = argi max { wi } C ^ 
是 第二 节 提到 的 最 可靠 背景 模型 MRBM 
算法 的 要点 对于 每个 m 典型 点 第三步 中的 
Mean Shift 实现 过程 依照 以下 步骤 1 初始化 Mean 
Shift 过程 的 起点 y1 = pi 2 反复 运用 
Mean Shift 过程 yt + 1 = . . . 
. 直至 收敛 这里 我们 选用 跟 文献 19 一样 
的 Mean Shift 过程 函数 g x 是 核 函数 
G x 3 保存 收敛 点 yconv 用于 后续 分析 
在对 所有 像素 运用 上述 步骤 之后 我们 能用 MRBM 
生成 背景 场景 B 通过 上述 分析 我们 发现 背景 
生成 过程 的 时间 复杂度 为 O N m 空间 
复杂度 为 O N n 其中 N 是 视频 的 
长度 3.2 运动 对象 检测 与 背景 模型 维持 生成 
背景 模型 之后 我们 可以 将 其 用于 检测 场景 
中 的 运动 区域 为了 使 我们 的 背景 模型 
对 运动 背景 具有 鲁棒性 例如 户外 随风 摆动 的 
树枝 或者 水中 的 波纹 我们 将 k 个 聚集 
中心 选为 可能 的 背景 值 我们 将 这组 集合 
定义 为 Cb = { { ci wi } | 
wi ≥ θ } i = 1 . . . 
. k 其中 Cb ⊆ C θ 是 预定义 的 
阀值 对于 每个 新 的 观测 强度 值 x0 我们 
仅仅 计算 x0 与 Cb 中 元素 的 最小 差值 
d 其中 d = min { x0 ci | { 
ci wi } ∈ Cb } 如果 差值 d 大于 
预定义 的 阀值 t 我们 认为 新 的 观测 强度 
值 是 前景 否则 为 背景 背景 维持 能让/nr 我们 
的 背景 模型 适应 长期 的 背景 变化 例如 新 
停泊 的 汽车 或者 逐渐 改变 的 光照 当 我们 
观察 一个 新 像素 值 时 背景 模型 按 下列 
步骤 来 更新 1 对 每个 新 像素 值 我们 
视 其为 新 典型 样本点 因此 典型 样本点 的 数目 
变为 m = m + 1 2 如果 新 像素 
值 属于 背景 区域 假设 其 强度 值 与 聚集 
中心 { ci wi } 最近 我们 将 该 中心 
的 权重 更新 为 wi =   li + 1 
/ m 3 如果 新 像素 值 属于 前景 区域 
我们 从 这点 开始 运用 新的 Mean Shift 过程 这样 
可以 获取 到 新的 收敛 中心 { cnew wnew } 
其中 wnew 初始 化为 wnew = 1 / m 聚集 
中心 C 被 扩充 成 C = C ∪ { 
{ cnew wnew } } 背景 减除 的 时间 复杂度 
是 O N 背景 维持 的 时间 复杂度 是 O 
R 其中 N 是 视频 的 帧数 R 是 运动 
对象 的 数目 4 实验 我们 专注 于 两类 MRBM 
应用 背景 生成 和 背景 减除 我们 在 合成视频 和 
标准 PETS 数据库 上 比较 MRBM 与 其他 常用 的 
方法 源代码 用 C + + 实现 测试 用 电脑 
的 配置 如下 CPU 为 Pentium 1 . 6GHZ 内存 
512M 我们 自己 捕获 或者 合成 的 视频 尺寸 为 
320 × 240 像素 PETS 数据库 的 视频 尺寸 为 
384/360 × 288 像素 帧速率 均为 25fps 在 所有 的 
实验 中 我们 选择 YUV 4 4 4 色彩 空间 
作为 特征 空间 算法 实现 的 描述 见 第三 节 
我们 采用 了 Epanechnikov 核 K t = 3 / 
4 * 1 t2 理论上 更大 的 训练 集 能 
得到 更 稳定 的 背景 模型 但是 会 牺牲 适应性 
我们 的 实验 表明 当 n = 100时 能够使 背景 
图像 得到 最佳 的 可视 质量 和 适应性 典型 点数 
m 影响 训练 时间 及 背景 模型 的 可靠性 在 
我们 的 实验 中 我们 为 Mean Shift 过程 选择 
m = 10个 典型 点 这时 的 训练 时间 与 
高斯 混合模型 接近 阀值 θ 和t/nr 影响 检测 的 精度 
对/p 不同/a 的/uj 数据集/i 可能/v 有/v 不同/a 的/uj θ/i 和t/nr 
在 我们 的 实验 中 当 θ = 0.3 t 
= 10时 能够 得到 最大 的 准确率 和 最小 的 
错误率 如果 没有 特别 说明 所有 实验 使用 上述 设置 
4.1 背景 生成 在 许多 监控 和 跟踪 应用 中 
期望 生成 没有 运动 对象 的 背景 图像 它 能为 
更进一步 的 分析 提供 参考 信息 但是 很多 时候 并不 
容易 获得 没有 运动 对象 的 的 视频 我们 的 
算法 能从 包含 混乱 运动 对象 的 视频 中 提取 
非常 清晰 的 背景 图像 显示 了 一些 生成 的 
背景 视频 共有 360 帧 我们 将 前 100 帧 
用于 生成 背景 图中 显示 了 第 1 33 66 
99 帧 图像 的 底部 显示 了 算法 生成 的 
背景 以 c 为例 这段 视频 摄 自 校园 的 
上 下课时间 每 帧 中 都有 10名 步行 的 学生 
观察 c 最 下面 的 背景 图像 我们 发现 背景 
非常 清晰 所有 运动 对象 都被/nr 成功 的 抹 去了 
运动 对象 的 移动 速度 是 关键 因素 它 能 
显著 的 影响 背景 模型 包括 我们 的 背景 模型 
我们 用 一段 300 帧 的 视频 来 评估 算法 
该 视频 里 有 一位 缓慢 走动 的 女士 第 
1 30 60 90 120 帧 图像 分别 显示 在 
a e 中 用 不同 数目 的 样本 图像 生成 
的 背景 显示 于 f j 当 保持 100 帧 
样本 图像 时 生成 的 背景 中 有 一些 噪点 
但是 背景 的 整体 质量 得以 保证 噪点 区域 用 
白色 椭圆 标 出了 如 f 所示 当 我们 将 
样本 数目 增加 到 300时 背景 变得 非常 清晰 如 
j 所示 我们 也 对 我们 的 背景 生成 方法 
与 其它 基本 方法 做了 比较 例如 高斯 模型 具有 
多个 聚集 中心 的 高斯 混合模型 为了 区分 比较 结果 
我们 合成 了 一段 多 模态 背景 分布 视频 背景 
的 像素 由 高斯 混合 分布 生成 pbg x = 
∑ i = 12 α iG μ i σ i 
x 其中 参数 α 1 = α 2 = 0.5 
σ 1 = σ 2 = 6 μ 1 = 
128 μ 2 = 240 前景 对象 的 像素 由 
高斯分布 生成 pfg x = G μ σ x 其中 
参数 μ = 10 σ = 6 上述 两式 中 
G μ σ 代表 具有 均值 μ 和 标准偏差 σ 
的 高斯分布 背景 像素 及 前景 像素 的 强度 分布 
见 视频 共有 120 帧 我们 用 前 100 帧 
来 生成 背景 a e 显示 了 一些 选定 的 
帧 生成 的 背景 图像 显示 在 f i 中 
从 潜在 分布 生成 的 地面实况 样本 显示 于 j 
中 对于 高斯 模型 背景 像素 的 强度 值 被选为 
高斯 均值 生成 的 背景 图像 如 f 所示 对于 
高斯 混合模型 我们 选择 带 maxim 的 高斯 混合 均值 
为 背景 值 g 显示 了 2个 中心 的 高斯 
混合模型 h 显示 了 3个 中心 的 高斯 混合模型 实验 
所用 的 高斯 混合模型 使用 OpenCV 中的 实现 见 文献 
27 MRBM 方法 得到 的 结果 如 i 所示 比较 
地面实况 图像 和 生成 的 背景 图像 我们 发现 非 
参数 模型 MRBM 优于 其它 方法 凭直觉 在 处理 多模 
分布 时 MRBM 看起来 与 高斯 混合模型 类似 但是 关键 
的 不同 之 处 在于 高斯 模型 依赖 均值 和 
方差 它们 的 1 阶 和2阶/nr 统计 数据 对 外部 
点 outliers 远离 数据 峰值 的 点 非常 敏感 如果 
对象 的 运动 速度慢 存在 足够 的 前景 值 导致 
错误 的 均值 结果 得出 错误 的 背景 值 作为 
对照 MRBM 跟 分布 无关 仅仅 使用 极值 作为 可能 
的 背景 值 它 对外部 点 更 鲁棒 其他 参数 
方法 存在 类似 的 问题 当 预定义 的 模型 不能 
描述 数据分布 时 更加 明显 4.2 背景 减除 显示 了 
我们 算法 的 背景 减除 结果 a 显示 观测 到 
的 当前 帧 b 显示 用 MRBM 从 100 帧 
样本 生成 的 背景 图像 c 显示 了 背景 减除 
的 结果 图像 我们 发现 运动 对象 变得 很 突出 
我们 比较 了 MRBM 和 其它 常用 的 基本 方法 
例如 文献 1 中 的 最大 最小值 法 文献 28 
29 中的 中值 法 文献 8 6 中的 高斯 混合模型 
比较 结果 显示 于 由于 我们 不能 修改 这些 原始 
工作 成果 的 实现 方式 只能 按 以下 方式 来 
管理 基础 算法 1 对于 W4 我们 按 原始 成果 
中 的 建议 来 设置 参数 2 对于/p 中值/n 法和/nr 
高斯/nr 混合模型/i 我们 调整 参数 使其 达到 最好 的 检测 
精度 另外 为了 使 比较 尽量 公平 我们 只 做 
背景 减除 没有 进行 降噪 和 形态学 处理 最佳 的 
视频 序列 选自 PETS 数据库 30 32 选定 帧 如 
a 所示 对 所有 的 视频 序列 我们 用 100 
帧 来 生成 背景 用 第 40 帧 做 背景 
减除 这些 视频 序列 包含 两 种 主要 的 场景 
缓慢 运动 的 对象 如 PETS00 和 PETS06 多 模态 
背景 如 PETS01 中 摆动 的 树 这两种 场景 是 
背景 减除 中的 不同情况 对于 缓慢 运动 的 对象 高斯 
模型 的 结果 比较 差 因为 高斯 均值 对外部 点 
敏感 如 d 所示 而 MRBM 依赖于 背景 分布 的 
极值 外部 点 对其 影响 很小 同样 中值/n 法和/nr 最大/a 
最小值/l 法/l 不能/v 很好/i 的/uj 应对/v 多/m 模态/n 背景/n PETS01 
中 摆动 的 树 被 误认为 前景 跟 预期 一致 
MRBM 优于 其它 三 种方法 4.3 讨论 可能 的 欠缺 
尽管 MRBM 适用于 许多 应用 仍然 存在 一些 不 能 
应对 的 场合 就是 不能 应对 的 例子 在 这个 
实验 中 视频 共有 300 帧 我们 用 前 120 
帧 来 生成 背景 a g 分别 显示 了 第 
1 20 40 60 80 100 120 帧 背景 图像 
显示 在 h 中 前景 人物 的 很大 一部分 被 
误认为 背景 通常 前景/n 和/c 背景/n 的/uj 定义/n 从/p 自身/r 
来看/u 并不/i 明确/ad 它 包含 在 场景 的 语义 中 
在 不同 的 应用 中 可能 不 一致 在 我们 
的 应用 中 我们 将 运动 对象 定义 为 前景 
将 静止 或者 几乎 静止 的 东西 定义 为 背景 
这与 大多数 视频 监控 应用 的 定义 一致 通过 第二 
节 的 分析 我们 试图 用 ECD 模型 来 近似 
观测值 在 的 实验 中 人物 在 大部分 时间 保持 
静止 然后 突然 运动 这种 情况 下 大部分 观测 强度 
值 属于 人物 而非 背景 对于 人物 的 肩膀 部分 
尤其 明显 肩膀 部分 有 相似 的 颜色 以致于 检测 
不到 运动 因此 前景 人物 的 大部分 被 误认为 背景 
实际上 这个 例子 反映 了 背景 模型 的 根本 问题 
稳定性 与 适应性 理论上 如果 我们 增加 用于 训练 的 
背景 帧数 我们 能 得到 更 清晰 的 背景 图像 
但是 同时 会 极大 的 牺牲 背景 模型 的 适应性 
当 背景 改变 例如 新 停泊 的 汽车 或者 突然 
改变 的 光照 背景 模型 需要 很长 的 时间 才能 
适应 新 情况 将 产生 大量 的 错误 针对 该 
问题 一种 有效 的 解决 方案 是 将 现有 的 
基于 像素 的 方法 扩展 为 基于 区域 或者 基于 
帧 的 方法 通过 分割 图像 或者 完善 像素 级 
的 低级 分类 可以 实现 它 更进一步 可以 同时 使用 
低级 对象 分割 和 高级 信息 例如 跟踪 或者 事件 
描述 因此 我们/r 接下来/l 的/uj 工作/vn 将/d 专注/v 于/p 如何/r 
结合/v 空间/n 和/c 高级/b 信息/n 5 结论 本文 主要 有 
两点 贡献 1 我们 介绍 的 影响 因素 描述 可 
用于 对 变化 的 背景 进行 建模 2 基于 ECD 
我们 开发 了 一种 鲁棒 的 背景 生成 方法 最 
可靠 背景 模型 应用 MRBM 能从 包含 混乱 运动 对象 
的 视频 序列 中 生成 高质量 的 背景 图像 一些 
例子 显示 了 这种 方法 的 有效性 和 鲁棒性 然而 
仍然 存在 一些 有待 解决 的 问题 当前 的 工作 
中 仅仅 考虑 了 像素 的 时间 信息 怎么 结合 
空间 信息 来 提高 本 方法 的 鲁棒性 是 后续 
工作 的 重点 一种 直接 的 扩展 是 将 当前 
基于 像素 的 方法 修 改成 熔合 了 邻域 信息 
基于 区域 的 方法 另外 结合 使用 低级 分割 和 
高级 跟踪 信息 对 我们 的 工作 成果 也 将有 
极大 的 提高 6 致谢/v 在此/i 要/v 感谢/v 陈熙/i 霖/nr 
博士/n 和/c 山世光/nr 博士/n 他们 跟 作者 进行 了 很有帮助 
的 讨论 这项 研究 的 经费 由 以下 单位 赞助 
中国 自然科学 基金会 中国科学院 百名 人才 培养 计划 上海 银 
晨 智能 识别 科技 有限公司 参考文献 1 I . Haritaoglu 
D . Harwoodand L . . Davis W4 real time 
surveillance of people and their activities IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 809 – 830 
. 2 K . Toyama J . Krumm B . 
Brumitt B . Meyers . WallFlower Principles and Practice of 
background maintenance in IEEE International Conferenceon Computer Vision Corfu Greece 
1999 pp . 255 – 261 . 3 A . 
Elgammal D . Harwood L . Davis Non parametric model 
for background subtraction in European Conference on Computer Vision Dublin 
Ireland 2000 pp . 751 – 767 . 4 T 
. E . Boult R . J . Micheals X 
. Gao M . Eckmann Intothewoods visual Surveillance of noncooperative 
and camouflaged targets in complex outdoorsettings Proceedings of the IEEE 
89 2001 1382 – 1402 . 5 C . R 
. Wren A . Azarbayejani T . Darrell A . 
P . Pentland Pfinder Real time Tracking of the human 
body IEEE Transactions on Pattern Analysis andMachine Intelligence 19 7 
1998 780 – 785 . 6 C . Stauffer W 
. Grimson Adaptive background mixture models for real time tracking 
in IEEE Conference on Computer Vision and Pattern Recognition FortCollins 
USA 1999 pp . 246 – 252 . 7 . 
Rowe A . Blake Statistical background modelling for tracking with 
a virtual camera in British Machine Vision Conference Birmingham UK 
1995 pp . 423 – 432 . 8 C . 
Stauffer W . E . L . Grimson Learning patterns 
of activity using real time tracking IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 747 – 757 
. 9 L . Li W . Huang I . 
Y . Gu Q . Tian Foreground object detection in 
changing Background based on color co occurrence statistics in IEEE 
Workshop on Applications of Computer Vision Orlando Florida 2002 pp 
. 269 – 274 . 10 P . KaewTraKulPong R 
. Bowden An improved adaptive background mixture Model for real 
time tracking with shadow detection in European Workshop on Advanced 
Video Based Surveillance Systems Kluwer Academic 2001 . 11 K 
. Kim T . Chalidabhongse D . Harwood L . 
Davis Real time foreground Background segmentation using codebook model Real 
Time Imaging 11 3 2005 172 – 185 . 12 
A . Elgammal R . Duraiswami L . Davis Effcient 
non parametric adaptive color Modeling using fast gauss transform in 
IEEE Conference on Computer Vision And Pattern Recognition Vol . 
2 2001 pp . 563 – 570 . 13 A 
. M . Elgammal R . Duraiswami L . . 
Davis Effcient kernel density estimation Using the fast gauss transform 
with applications to color modeling and tracking . IEEE Transactions 
on Pattern Analysis and Machine Intelligence 25 11 2003 1499 
– 1504 . 14 A . Elgammal Effcient nonparametric kernel 
density estimation for realtime computer vision Ph . D . 
thesis Rutgers The State University of New Jersey 2002 . 
15 H . Askar X . Li Z . Li 
Background clutter suppression and dim moving point Targets detection using 
nonparametric method in International Conference on Communications Circuits and Systems 
and West Sino Expositions Vol . 2 2002 pp . 
982 – 986 . 16 D . Thirde G . 
Jones Hierarchical probabilistic models for video object Segmentation and tracking 
in International Conference on P a t t e r 
n R e c o g n i t i 
o n Vol . 1 2004 pp . 636 – 
639 . 17 T . Liu A . W . 
Moore A . Gray Effcient exact k nn and nonparametric 
Classification in high dimensions in Neural Information Processing Systems 2003 
pp . 265 – 272 . 18 K . Fukunaga 
L . Hostetler The estimation of the gradient of adensity 
function With applications in pattern recognition IEEE Transactions on Information 
Theory 21 1975 32 – 40 . 19 D . 
Comaniciu P . Meer Mean shift a robust approach toward 
feature space analysis IEEE Transactions on Pattern Analysis and Machine 
Intelligence 24 5 2002 603 – 619 . 20 I 
. Y . H . Gu V . Gui Colour 
image segmentation using adaptive mean shift filters in International Conference 
on Image Processing 2001 pp . 726 – 729 . 
21 L . Yang P . Meer D . J 
. Foran Unsupervised segmentation based on robust Estimation and color 
active contour models IEEE Transactions on Information Technology in Biomedicine 
9 3 2005 475 – 486 . 22 D . 
Comaniciu V . Ramesh P . Meer Kernel based object 
tracking IEEE Transactions on Pattern Analysis and Machine Intelligence 25 
5 2003 564 – 577 . 23 R . T 
. Collins Y . Liu On line selection of discrimin 
ative tracking features in International Conference on Computer Vision 2003 
pp . 346 – 352 . 24 R . Collins 
Y . Liu M . Leordeanu On line selection of 
discriminative tracking features IEEE Transactions on Pattern Analysis and Machine 
Intelligence 27 10 2005 1631 – 1643 . 25 O 
. Debeir P . V . Ham R . Kiss 
C . Decaestecker Tracking of migrating cells under phase contrast 
video microscopy with combined mean shift processes IEEE Transactions on 
Medical Imaging 24 6 2005 697 – 711 . 26 
C . Shen M . J . Brooks A . 
van den Hengel Fast global kernel density Mode seeking with 
application to localisation and tracking in I n t e 
r n a t i o n a l C 
o n f e r e n c e on 
Computer Vision 2005 pp . 1516 – 1523 . 27 
Intel open source computer vision library 2004 . URL http 
/ / www . intel . com / technology / 
computing / opencv / 28 B . Lo . Velastin 
Automatic congestion detection system for underground platforms in International Symposium 
on Intelligent Multimedia Video and Speech Processing Hong Kong China 
2001 pp . 158 – 161 . 29 R . 
Cucchiara C . Grana M . Piccardi A . Prati 
Detecting moving objects ghosts and shadows in video streams IEEE 
Transactions on Pattern Analysis and Machine Intelligence 25 10 2003 
1337 – 1342 . 30 IEEE international workshop on performance 
evaluation of tracking and surveillance 2000 . URL ftp / 
/ ftp . pets . rdg . ac . uk 
/ pub / PETS2000 / 31 IEEE international workshop on 
performance evaluation of tracking and surveillance 2001 . URL ftp 
/ / ftp . pets . rdg . ac . 
uk / pub / PETS2001 / 32 IEEE international workshop 
on performance evaluation of tracking and surveillance 2006 . URL 
http / / pets2006 . net / data . html 
写在 最后 的话 本文 所述 的 方法 可说是 像素 级 
背景 建模 方式 的 巅峰 之作 在 接下来 的 时间 
里 我 将 尝试 按照 我 自己 的 理解 来 
实现 文中 的 算法 对于 论文 中 没有 讲述 透彻 
的 部分 我 也 试图 完善 它 敬请期待 在 翻译 
文章 的 过程 中 得到 了 赵德 斌 博士 的 
指导 在此 表示 感谢 同时 也 感谢 您 耐心 看完 
希望 对 您 有所 帮助 欲 知 后事 如何 且听 
下回分解 转 自 http / / www . cnblogs . com 
/ xrwang / archive / 2010 / 03/27 / B 
a c k g r o u n d G 
e n e r a t i o n A 
n d F o r e g r o u 
n d D e t e c t i o 
n P h a s e 2 . html 作者 
王先荣/nr 本文/r 尝试/vn 对/p 学习 OpenCV 中 推荐 的 论文 
Nonparametric Background Generation 进行 翻译 由于 我 的 英文 水平 
很差 断断续续 搞了 好 几天 才 勉强 完成 里面 肯定 
会 有 诸多 错误 欢迎 大家 指正 并请 多多 包涵 
翻译 本文 的 目的 在于 学习 研究 如果 需要 用于 
商业 目的 请与 原文 作者 联系 非 参数 背景 生成 
刘亚洲 姚 鸿勋 高文 陈熙 霖 赵德 斌 哈尔滨工业大学 中国科学院计算所 
摘要 本文 介绍 了 一种 新颖 的 背景 生成 方法 
该 方法 基于 非 参数 背景 模型 可 用于 背景 
减除 我们 介绍 一种 新的 名为 影响 因素 描述 effect 
components description ECD 的 模型 用于 描述 背景 的 变动 
在此 基础 上 我们 可以 用 潜在 分布 的 局部 
极值 推导 出 最 可靠 背景 状态 most reliable background 
mode MRBM 该 方法 的 基本 计算 过程 采用 Mean 
Shift 这一 经典 的 模式识别 过程 Mean Shift 通过 迭代计算 
能够 在 数据 的 密度 分布 中找到 最近 位置 的 
点 译者 注 即 找到 数据 最 密集 的 点 
这种 方法 有 三个 优点 1 能从 包含 混乱 运动 
对象 的 视频 中 提取 出 背景 2 背景 非常 
清晰 3 对 噪声 和小/nr 幅度 的 摄像机 振动 具有 
鲁棒性 广泛 的 实验 结果 证明 了 上述 优点 关键词 
背景 减除 背景 生成 Mean Shift 影响 因素 描述 最 
可靠 背景 状态 视频 监视 1 引言 在 许多 计算机 
视觉 和 视频 分析 应用 中 运动 对象 的 分割 
是 一项 基本 任务 例如 视频 监视 多媒体 索引 人物 
检测 和 跟踪 有 知觉 的 人机接口 小精灵 视频编码 精确 
的 对象 分割 能 极大 的 提高 对象 跟踪 识别 
分类 和 动态 分析 的 性能 识别 运动 对象 的 
通用 方法 有 光 流 基于 时间差 异或 背景 减除 
的 方法 其中 背景 减除 最 常用 背景 模型 被 
计算 出 并 逐 帧 进化 然后 通过 比较 当前 
帧 和 背景 模型 间 的 差异 来 检测 运动 
对象 这种 方法 的 关键 之 处 在于 建立 并 
维持 背景 模型 尽管 文献 1 4 提出 了 很多 
有 前途 的 方法 但是 运动 对象 检测 的 精度 
这一 基本 问题 仍然 难以 解决 第一 个 问题 是 
背景 模型 必须 尽可能 精确 的 反映 真实 背景 这样 
系统 才能 精确 的 检测 运动 对象 的 外形 第二 
个 问题 是 背景 模型 必须 对 背景 场景 的 
改变 足够 灵敏 例如 对象 开始 运动 及 停止 运动 
如果 不能 适当 的 解决 上述 问题 背景 减除 会 
检测 出 虚假 对象 它们 通常 被 称为 幽灵 目前/t 
已经/d 有了/nr 许多/m 用于/v 背景/n 减除/v 的/uj 背景/n 建立/v 和/c 
维持/v 方法/n 按 背景 建模 的 步骤 来 分类 我们 
可以 将 其 分为 参数 化 的 和非/nr 参数 化 
的 方法 参数 化 的 背景 建模 方法 通常 假设 
单个 像素 的 潜在 概率密度函数 是 高斯 或者 高斯 混合 
函数 详情请 参看 文献 5 7 Stauffer 和 Grimson 在 
文献 8 中 提出 了 一种 自适应 的 背景 减除 
方法 用于 解决 运动 分割 问题 在 他们 的 工作 
成果 中 他们 为 每个 像素 建立 了 高斯 混合 
概率密度函数 然后 用 即时 的 近似值 更新 该 模型 文献 
9 10 提出 了 对 高斯 混合模型 的 一些 改进 
方法 Toyama 等人 在 文献 2 中 提出 了 一种 
三层 的 Wallflower 方案 该 方案 尝试 解决 背景 维持 
中 现存 的 许多 问题 例如 灯光 打开 关闭 前景 
孔穴 等等 Haritaoglu 等人 在 文献 1 中 提出 的 
W4 方法 该 方法 为 背景 建模 而对 每个 像素 
保留 了 三个 值 的 方法 包括 最大值 M 最小值 
N 和 最大 帧 间 绝对 差值 D Kim 等人 
在 文献 11 中 将 背景 值 量化 到 编码本 
编码本 描述 了 长 视频 中 背景 模型 的 压缩 
形式 另一类 经常 用到 的 背景 模型 方法 基于 非 
参数 化 的 技术 例如 文献 3 12 16 Elgammal 
等人 在 文献 3 中 通过 核 密度估计 建立 了 
一种 非 参数 化 的 背景 模型 对 每个 像素 
为了 估计 潜在 的 概率密度函数 而 保留 了 观测 强度 
值 而 新 强度 值 的 概率 能 通过 该 
函数 计算 得出 这种 模型 具有 鲁棒性 能够 适应 混乱 
及 不完全 静止 但 包含 小 扰动 场合 下 的 
背景 例如 摆动 的 树枝 和 灌木 与 参数 化 
的 背景 模型 方法 相比 非 参数 化 的 背景 
模型 方法 具有 以下 优点 不 需要 指定 潜在 的 
模型 不 需要 明确 的 估计 参数 14 因此 它们 
能 适应 任意 未知 的 数据分布 这个 特性 使 非 
参数 化 的 方法 成为 许多 计算机 视觉 应用 的 
有力 工具 在 许多 计算机 视觉 应用 中 许多问题 牵涉到 
多元 多种 形式 的 密度 数据 在 特征 空间 中 
没有 规则 的 形态 没有 遵循 标准 的 参数 形式 
但是 从/p 时间/n 和/c 空间/n 复杂度/n 这/r 一方面/mq 来看/u 非 
参数 化 的 方法 不如 参数 化 的 方法 有效 
参数 化 的 方法 产生 简洁 的 密度 描述 例如 
高斯 或 高斯 混合 得出 有效 的 估计 状态 相对 
的 非 参数 化 的 方法 在 学习 阶段 几乎 
不 需要 计算 然而 在 评估 阶段 需要 高 密度 
的 计算 因此 非 参数 化 方法 的 主要 缺陷 
是 它们 的 计算 量 不过 一些 革新 的 工作 
成果 已经 被 提出 它们 能 加快 非 参数 化 
方法 的 评估 速度 例如 文献 13 中 的 快速 
高斯 变换 FGT 文献 17 中的 新 ball tree 算法 
核 密度估计 和K/nr 近邻 KNN 分类 本文 专注 于非/nr 参数 
化 的 方法 跟 Elagammal 在 文献 3 中 提出 
的 方法 有 紧密 的 联系 但是 有 两点 本质上 
的 区别 从 基本 原理 上看 我们 用 影响 因素 
描述 ECD 来 为 背景 的 变化 建模 最 可靠 
背景 模型 MRBM 对 背景 场景 的 估计 具有 鲁棒性 
从 计算 过程 来看 通过 使用 Mean Shift 过程 我们 
避免了 对 每个 新 观测 强度 值 计算 概率 的 
核 密度估计 过程 节约 了 处理 时间 在 我们 的 
方法 中 仅用 帧 差 即 可决定 像素 的 属性 
因此/c 能/v 提高/v 背景/n 减除/v 的/uj 鲁棒性/nr 和/c 效率/n 本文 
余下 的 部分 按 以下 方式 来 组织 第二节 中 
提出 了 影响 因素 描述 用于 反映 背景 的 变化 
第三节 详细 解释 了 最 可靠 背景 模型 第四节 包含 
了 实验 结果 第五节 讨论 了 有待 扩充 的 部分 
2 影响 因素 描述 本节 讨论 影响 因素 描述 ECD 
我们 试图 通过 它 来 有效 的 模拟 背景 的 
变化 背景 减除 的 关键 因素 在于 怎样 建立 并 
维持 好 的 背景 模型 由于 在 不同 的 应用 
中 摄像机 类型 捕获 的 环境 和 对象 完全 不同 
背景 模型 需要 足够 的 自适应 能力 来 适应 不同 
的 情况 为了 有效 的 为 背景 建模 我们 从最/nr 
简单 的 理想 情况 开始 在 理想 情况下 对于 视频 
中 的 每个 空间 位置 沿 时间轴 的 强度 值 
为 常量 C 常量 C 表示 固定 摄像机 摄录 了 
固定 的 场景 没有 运动 对象 和 系统 噪声 我们 
将 这种 情况下 的 场景 称为 理想 背景 场景 但是 
在 实际 应用 中 很少 能 遇到 这种 理想 情况 
因此 背景 像素 可以 看成 是 理想 背景 场景 和 
其他 影响 部分 的 组合体 我们 将 这种 方法 定义 
为 背景 的 影响 成分 描述 包括 以下 方面 系统 
噪声 N sys 它 由 图像 传感器 和 其他 硬件 
设备 引起 如果 环境 不太 严密 系统 噪声 不会 从 
根本 上 影响 常量 C 仅仅 引起 适度 的 偏差 
运动 的 对象 M obj 它 由 实际 运动 的 
对象 及其 阴影 引起 大多数 时候 它 对 C 有 
极大 的 干扰 运动 的 背景 M bgd 它 由 
运动 的 背景 区域 引起 例如 户外 场景 中 随风 
摆动 的 树枝 或者 水中 的 波纹 光照 S illum 
它 表示 户外 随 太阳 位置 改变 而 渐变 的 
光照 或者 室内 灯光 的 关闭 和 打开 而 改变 
的 照明 摄像机 位移 D cam 它 表示 摄像机 的 
小幅度 位移 而 引起 的 像素 强度 变化 场景 的 
观测值 记为 V obsv 由 理想 背景 场景 C 和 
有效 成分 组成 如 公式 1 所示 V obsv = 
C + N sys + M obj + M bgd 
+ S illum + D cam       1 
在 这里 我们 用 符号 + 来 表示 影响 因素 
的 累积 效果 实际上 上述 影响 因素 能 进一步 分为 
表 1 所示 的 不同 属性 首先 需要 被 强调 
的 属性 是 过程 我们 可以 按 过程 将 影响 
因素 分为 长期 影响 和 短期 影响 我们 沿 时间轴 
将 视频流 分成 长度 相等 的 块 如 所示 长期 
表示 影响 因素 会 持续 数 块 或者 一直 存在 
例如 N sys S illum 和D/nr cam 而 M obj 
和M/nr bgd 仅仅 偶尔 发生 不会 长期 持续 因此 我们 
称之为 短期 影响 另一种 分类 的 标准 是 偏差 我们 
把 illum D cam M bgd 看作 时间 不变 的 
常驻 偏差 影响 在 较长 的 过程 中 这些 影响 
可以 看作 是 对 理想 背景 值 C 持久 的 
增加 减少 或者 替代 以 illum 为例 如果 处于 室内 
场景 并且 打开 照明 在 接下来 的 帧 中 illum 
可以 看成 是 对 C 持久 的 增加 而 N 
sys 和M/nr obj 在 不同 时 刻有 随机 的 值 
我们 称之为 随 时间 变化 的 随机 偏差 影响 上述 
分析 归纳 到了 表 1中 表 1 影响 因素 的 
分类 长期           短期 常驻 偏差 
      illum D cam       M 
bgd 随机 偏差       N sys     
                M obj 
在此 必须 阐明 以下 两点 1 上述 分类 并不 绝对 
取决于 我们 选择 的 块 长度 但是 它 不 影响 
我们 接下来 的 分析 2 也许 某人 会 指出 对 
illum 的 分类 不正确 例如 行驶 汽车 的 灯光 不是 
长期 影响 这种 情况下 的 光照 变化 属于 短期 影响 
跟 M obj 类似 因此 我们 不把 它 单独 列 
为 独立 的 影响 因素 由于 illum 和D/nr cam 对 
理想 背景 C 有 长期 持续 的 偏差 我们 将 
它们 合并 到 理想 背景 中 得到 C = C 
+ S illum + D cam 对 这种 合并 的 
直接 解释 是 如果 光照 发生变化 或者 摄像机 变动 位置 
我们 有 理由 假设 理想 背景 已经 改变 因此 将 
公式 1 表示 成 V obsv = C + N 
sys + M obj + M bgd       
2 到 目前 为止 观测值 V obsv 由 新的 理想 
背景 值 C 和 影响 因素 N sys M obj 
M bgd 组成 这些 影响 因素 对 C 有 不同 
的 影响 归纳 成 以下 两点 N sys 在整个 视频流 
中 存在 并对 C 有 些许 影响 因此 大部分 观测值 
都不会 偏离 C 太远 M obj 和M/nr bgd 仅仅 偶尔 
发生 但对 C 引起 很大 的 偏差 因此 仅仅 小部分 
观测值 显著 的 不同 于C/nr 得出 以 下结论 空间 位置 
的 像素 值 在 大部分 时间 内 保持 稳定 并 
伴随 些许 偏差 由于 长期 存在 的 随机 偏差 N 
sys 仅仅 当 运动 对象 通过 该 像素 时 引起 
显著 的 偏差 由于 短期 偏差 M obj 和M/nr bgd 
因此 一段 时间 内 少数 显著 偏差 形成 了 极值 
大 部分 时间 都 存在 这种 属性 不过 有时 也 
并非如此 在 中 显示 了 白色 圆心 处 像素 值 
随 时间 而 变化 的 图表 a c 节选自 一段 
长达 360 帧 的 视频 d 描绘 了 像素 强度 
的 变化 从 d 我们 可以 看出 由 系统 噪声 
引起 的 小幅度 偏差 占据 了 大部分 时间 仅 当 
有 运动 对象 及其 阴影 经过 时 引起 了 显著 
的 偏差 这与 影响 因素 描述 是 相符 的 我们 
的 任务 是 从 观测值 序列 { V obsv t 
} t = 1 . . . . T T 
指 时间 长度 中 找到 理想 背景 C 的 估计值 
C ^ 通过 上述 分析 我们 发现 C ^ 位于 
多数 观测值 的 中点 从 另一方面 来看 C ^ 处于 
潜在 分布 梯度 为 0 和最/nr 密集 的 地方 这个 
任务 可由 Mean Shift 过程 来 完成 我们 将 C 
^ 称为 最 可靠 背景 状态 3 用于 运动 对象 
检测 的 最 可靠 背景 状态 基于 第二节 所讲 的 
影响 因素 描述 我们 推知 大部分 观测值 所处 区域 的 
中心 是 背景 的 理想 估计 我们 将 这个 估计 
用 符号 C ^ 表示 并 称为 最 可靠 背景 
状态 MRBM 定位 MRBM 的 基本 计算 方式 是 Mean 
Shift 一方面 通过 使用 MRBM 我们 能够 为 混乱 运动 
对象 的 视频 生成 非常 清晰 的 背景 图像 另一方面 
Mean Shift 过程 能 发现 强度 分布 的 一些 局部 
极值 这种 信息 能从 真实 的 运动 对象 中 区别 
出 运动 的 背景 例如 户外 随风 摆动 的 树枝 
或者 水中 的 波纹 3.1 用于 MRBM 的 Mean ShiftMean 
Shift 是 定位 密度 极值 的 简明 方式 密度 极值 
处 的 梯度 为 0 . 该 理论 由 Fukunaga 
在 文献 18 中 提出 而 Mean Shift/w 的/uj 平滑/a 
性/n 和/c 收敛性/vn 由/p Comaniciu/w 和/c Meer/w 在/p 文献/n 19 
中 证实 近几年 它 已成为 计算机 视觉 应用 的 有力 
工具 并 报道 了 许多 有 前途 的 成果 例如 
基于 Mean Shift 的 图像 分割 19 21 和 跟踪 
22 26 在 我们 的 工作 成果 中 我们 用 
Mean Shift 来 定位 强度 分布 的 极值 注意 可能 
有 多个 局部 极值 我们 将 最大 密度 状态 定义 
为 MRBM 算法 的 要点 如 所示 包括 下列 步骤 
样本 选择 我们 为 每个 像素 选择 一组 样本 = 
{ xi } i = 1 . . . n 
其中 xis 是 像素 沿 时间轴 的 强度 值 n 
是 样本 数目 我们 直接 对 样本 进行 Mean Shift 
运算 以便 定位 密度 的 极值 典型 点 选择 为了 
减少 计算 量 我们 从中/nr 选择 或者 计算 出 一组 
典型 点 典型 点 数目 为 m m n 并将 
这组 典型 点 记为 P = { pi } i 
= 1 . . . m P 中的 典型 点 
可以 是 样本 的 抽样 结果 也 可以 是 原始 
样本点 的 局部 平均值 在 我们 的 实验 中 我们 
选择 局部 平均值 Mean Shift 过程 从P/nr 中的 典型 样本点 
开始 运用 Mean Shift 过程 我们 可以 得到 收敛 点 
m 值得 注意 的 是 Mean Shift 计算 仍然 基于 
整个 样本点 集 所以 梯度 密度估计 的 精度 并未 因为 
使用 典型 点 而 降低 提取 候选 背景 模型 由于 
一些 收敛 点 非常 接近 甚至 完全 一样 这些 收敛 
点 m 可以 被 聚 集为 q 组 q ≤ 
m 我们 能够 获取 q 带 权重 的 聚集 中心 
C = { { ci wi } } i = 
1 . . . . q 其中 ci 是 每个 
聚集 中心 的 强度 值 wi 是 聚集 中心 的 
权重 每组 的 点数 记为 li i = 1 . 
. . . q ∑ i = 1qli = m 
每组 中心 的 权重 定义 为 wi = li / 
m i = 1 . . . . q 获取 
最 可靠 背景 模型 C ^ = ci * 其中 
i * = argi max { wi } C ^ 
是 第二 节 提到 的 最 可靠 背景 模型 MRBM 
算法 的 要点 对于 每个 m 典型 点 第三步 中的 
Mean Shift 实现 过程 依照 以下 步骤 1 初始化 Mean 
Shift 过程 的 起点 y1 = pi 2 反复 运用 
Mean Shift 过程 yt + 1 = . . . 
. 直至 收敛 这里 我们 选用 跟 文献 19 一样 
的 Mean Shift 过程 函数 g x 是 核 函数 
G x 3 保存 收敛 点 yconv 用于 后续 分析 
在对 所有 像素 运用 上述 步骤 之后 我们 能用 MRBM 
生成 背景 场景 B 通过 上述 分析 我们 发现 背景 
生成 过程 的 时间 复杂度 为 O N m 空间 
复杂度 为 O N n 其中 N 是 视频 的 
长度 3.2 运动 对象 检测 与 背景 模型 维持 生成 
背景 模型 之后 我们 可以 将 其 用于 检测 场景 
中 的 运动 区域 为了 使 我们 的 背景 模型 
对 运动 背景 具有 鲁棒性 例如 户外 随风 摆动 的 
树枝 或者 水中 的 波纹 我们 将 k 个 聚集 
中心 选为 可能 的 背景 值 我们 将 这组 集合 
定义 为 Cb = { { ci wi } | 
wi ≥ θ } i = 1 . . . 
. k 其中 Cb ⊆ C θ 是 预定义 的 
阀值 对于 每个 新 的 观测 强度 值 x0 我们 
仅仅 计算 x0 与 Cb 中 元素 的 最小 差值 
d 其中 d = min { x0 ci | { 
ci wi } ∈ Cb } 如果 差值 d 大于 
预定义 的 阀值 t 我们 认为 新 的 观测 强度 
值 是 前景 否则 为 背景 背景 维持 能让/nr 我们 
的 背景 模型 适应 长期 的 背景 变化 例如 新 
停泊 的 汽车 或者 逐渐 改变 的 光照 当 我们 
观察 一个 新 像素 值 时 背景 模型 按 下列 
步骤 来 更新 1 对 每个 新 像素 值 我们 
视 其为 新 典型 样本点 因此 典型 样本点 的 数目 
变为 m = m + 1 2 如果 新 像素 
值 属于 背景 区域 假设 其 强度 值 与 聚集 
中心 { ci wi } 最近 我们 将 该 中心 
的 权重 更新 为 wi =   li + 1 
/ m 3 如果 新 像素 值 属于 前景 区域 
我们 从 这点 开始 运用 新的 Mean Shift 过程 这样 
可以 获取 到 新的 收敛 中心 { cnew wnew } 
其中 wnew 初始 化为 wnew = 1 / m 聚集 
中心 C 被 扩充 成 C = C ∪ { 
{ cnew wnew } } 背景 减除 的 时间 复杂度 
是 O N 背景 维持 的 时间 复杂度 是 O 
R 其中 N 是 视频 的 帧数 R 是 运动 
对象 的 数目 4 实验 我们 专注 于 两类 MRBM 
应用 背景 生成 和 背景 减除 我们 在 合成视频 和 
标准 PETS 数据库 上 比较 MRBM 与 其他 常用 的 
方法 源代码 用 C + + 实现 测试 用 电脑 
的 配置 如下 CPU 为 Pentium 1 . 6GHZ 内存 
512M 我们 自己 捕获 或者 合成 的 视频 尺寸 为 
320 × 240 像素 PETS 数据库 的 视频 尺寸 为 
384/360 × 288 像素 帧速率 均为 25fps 在 所有 的 
实验 中 我们 选择 YUV 4 4 4 色彩 空间 
作为 特征 空间 算法 实现 的 描述 见 第三 节 
我们 采用 了 Epanechnikov 核 K t = 3 / 
4 * 1 t2 理论上 更大 的 训练 集 能 
得到 更 稳定 的 背景 模型 但是 会 牺牲 适应性 
我们 的 实验 表明 当 n = 100时 能够使 背景 
图像 得到 最佳 的 可视 质量 和 适应性 典型 点数 
m 影响 训练 时间 及 背景 模型 的 可靠性 在 
我们 的 实验 中 我们 为 Mean Shift 过程 选择 
m = 10个 典型 点 这时 的 训练 时间 与 
高斯 混合模型 接近 阀值 θ 和t/nr 影响 检测 的 精度 
对/p 不同/a 的/uj 数据集/i 可能/v 有/v 不同/a 的/uj θ/i 和t/nr 
在 我们 的 实验 中 当 θ = 0.3 t 
= 10时 能够 得到 最大 的 准确率 和 最小 的 
错误率 如果 没有 特别 说明 所有 实验 使用 上述 设置 
4.1 背景 生成 在 许多 监控 和 跟踪 应用 中 
期望 生成 没有 运动 对象 的 背景 图像 它 能为 
更进一步 的 分析 提供 参考 信息 但是 很多 时候 并不 
容易 获得 没有 运动 对象 的 的 视频 我们 的 
算法 能从 包含 混乱 运动 对象 的 视频 中 提取 
非常 清晰 的 背景 图像 显示 了 一些 生成 的 
背景 视频 共有 360 帧 我们 将 前 100 帧 
用于 生成 背景 图中 显示 了 第 1 33 66 
99 帧 图像 的 底部 显示 了 算法 生成 的 
背景 以 c 为例 这段 视频 摄 自 校园 的 
上 下课时间 每 帧 中 都有 10名 步行 的 学生 
观察 c 最 下面 的 背景 图像 我们 发现 背景 
非常 清晰 所有 运动 对象 都被/nr 成功 的 抹 去了 
运动 对象 的 移动 速度 是 关键 因素 它 能 
显著 的 影响 背景 模型 包括 我们 的 背景 模型 
我们 用 一段 300 帧 的 视频 来 评估 算法 
该 视频 里 有 一位 缓慢 走动 的 女士 第 
1 30 60 90 120 帧 图像 分别 显示 在 
a e 中 用 不同 数目 的 样本 图像 生成 
的 背景 显示 于 f j 当 保持 100 帧 
样本 图像 时 生成 的 背景 中 有 一些 噪点 
但是 背景 的 整体 质量 得以 保证 噪点 区域 用 
白色 椭圆 标 出了 如 f 所示 当 我们 将 
样本 数目 增加 到 300时 背景 变得 非常 清晰 如 
j 所示 我们 也 对 我们 的 背景 生成 方法 
与 其它 基本 方法 做了 比较 例如 高斯 模型 具有 
多个 聚集 中心 的 高斯 混合模型 为了 区分 比较 结果 
我们 合成 了 一段 多 模态 背景 分布 视频 背景 
的 像素 由 高斯 混合 分布 生成 pbg x = 
∑ i = 12 α iG μ i σ i 
x 其中 参数 α 1 = α 2 = 0.5 
σ 1 = σ 2 = 6 μ 1 = 
128 μ 2 = 240 前景 对象 的 像素 由 
高斯分布 生成 pfg x = G μ σ x 其中 
参数 μ = 10 σ = 6 上述 两式 中 
G μ σ 代表 具有 均值 μ 和 标准偏差 σ 
的 高斯分布 背景 像素 及 前景 像素 的 强度 分布 
见 视频 共有 120 帧 我们 用 前 100 帧 
来 生成 背景 a e 显示 了 一些 选定 的 
帧 生成 的 背景 图像 显示 在 f i 中 
从 潜在 分布 生成 的 地面实况 样本 显示 于 j 
中 对于 高斯 模型 背景 像素 的 强度 值 被选为 
高斯 均值 生成 的 背景 图像 如 f 所示 对于 
高斯 混合模型 我们 选择 带 maxim 的 高斯 混合 均值 
为 背景 值 g 显示 了 2个 中心 的 高斯 
混合模型 h 显示 了 3个 中心 的 高斯 混合模型 实验 
所用 的 高斯 混合模型 使用 OpenCV 中的 实现 见 文献 
27 MRBM 方法 得到 的 结果 如 i 所示 比较 
地面实况 图像 和 生成 的 背景 图像 我们 发现 非 
参数 模型 MRBM 优于 其它 方法 凭直觉 在 处理 多模 
分布 时 MRBM 看起来 与 高斯 混合模型 类似 但是 关键 
的 不同 之 处 在于 高斯 模型 依赖 均值 和 
方差 它们 的 1 阶 和2阶/nr 统计 数据 对 外部 
点 outliers 远离 数据 峰值 的 点 非常 敏感 如果 
对象 的 运动 速度慢 存在 足够 的 前景 值 导致 
错误 的 均值 结果 得出 错误 的 背景 值 作为 
对照 MRBM 跟 分布 无关 仅仅 使用 极值 作为 可能 
的 背景 值 它 对外部 点 更 鲁棒 其他 参数 
方法 存在 类似 的 问题 当 预定义 的 模型 不能 
描述 数据分布 时 更加 明显 4.2 背景 减除 显示 了 
我们 算法 的 背景 减除 结果 a 显示 观测 到 
的 当前 帧 b 显示 用 MRBM 从 100 帧 
样本 生成 的 背景 图像 c 显示 了 背景 减除 
的 结果 图像 我们 发现 运动 对象 变得 很 突出 
我们 比较 了 MRBM 和 其它 常用 的 基本 方法 
例如 文献 1 中 的 最大 最小值 法 文献 28 
29 中的 中值 法 文献 8 6 中的 高斯 混合模型 
比较 结果 显示 于 由于 我们 不能 修改 这些 原始 
工作 成果 的 实现 方式 只能 按 以下 方式 来 
管理 基础 算法 1 对于 W4 我们 按 原始 成果 
中 的 建议 来 设置 参数 2 对于/p 中值/n 法和/nr 
高斯/nr 混合模型/i 我们 调整 参数 使其 达到 最好 的 检测 
精度 另外 为了 使 比较 尽量 公平 我们 只 做 
背景 减除 没有 进行 降噪 和 形态学 处理 最佳 的 
视频 序列 选自 PETS 数据库 30 32 选定 帧 如 
a 所示 对 所有 的 视频 序列 我们 用 100 
帧 来 生成 背景 用 第 40 帧 做 背景 
减除 这些 视频 序列 包含 两 种 主要 的 场景 
缓慢 运动 的 对象 如 PETS00 和 PETS06 多 模态 
背景 如 PETS01 中 摆动 的 树 这两种 场景 是 
背景 减除 中的 不同情况 对于 缓慢 运动 的 对象 高斯 
模型 的 结果 比较 差 因为 高斯 均值 对外部 点 
敏感 如 d 所示 而 MRBM 依赖于 背景 分布 的 
极值 外部 点 对其 影响 很小 同样 中值/n 法和/nr 最大/a 
最小值/l 法/l 不能/v 很好/i 的/uj 应对/v 多/m 模态/n 背景/n PETS01 
中 摆动 的 树 被 误认为 前景 跟 预期 一致 
MRBM 优于 其它 三 种方法 4.3 讨论 可能 的 欠缺 
尽管 MRBM 适用于 许多 应用 仍然 存在 一些 不 能 
应对 的 场合 就是 不能 应对 的 例子 在 这个 
实验 中 视频 共有 300 帧 我们 用 前 120 
帧 来 生成 背景 a g 分别 显示 了 第 
1 20 40 60 80 100 120 帧 背景 图像 
显示 在 h 中 前景 人物 的 很大 一部分 被 
误认为 背景 通常 前景/n 和/c 背景/n 的/uj 定义/n 从/p 自身/r 
来看/u 并不/i 明确/ad 它 包含 在 场景 的 语义 中 
在 不同 的 应用 中 可能 不 一致 在 我们 
的 应用 中 我们 将 运动 对象 定义 为 前景 
将 静止 或者 几乎 静止 的 东西 定义 为 背景 
这与 大多数 视频 监控 应用 的 定义 一致 通过 第二 
节 的 分析 我们 试图 用 ECD 模型 来 近似 
观测值 在 的 实验 中 人物 在 大部分 时间 保持 
静止 然后 突然 运动 这种 情况 下 大部分 观测 强度 
值 属于 人物 而非 背景 对于 人物 的 肩膀 部分 
尤其 明显 肩膀 部分 有 相似 的 颜色 以致于 检测 
不到 运动 因此 前景 人物 的 大部分 被 误认为 背景 
实际上 这个 例子 反映 了 背景 模型 的 根本 问题 
稳定性 与 适应性 理论上 如果 我们 增加 用于 训练 的 
背景 帧数 我们 能 得到 更 清晰 的 背景 图像 
但是 同时 会 极大 的 牺牲 背景 模型 的 适应性 
当 背景 改变 例如 新 停泊 的 汽车 或者 突然 
改变 的 光照 背景 模型 需要 很长 的 时间 才能 
适应 新 情况 将 产生 大量 的 错误 针对 该 
问题 一种 有效 的 解决 方案 是 将 现有 的 
基于 像素 的 方法 扩展 为 基于 区域 或者 基于 
帧 的 方法 通过 分割 图像 或者 完善 像素 级 
的 低级 分类 可以 实现 它 更进一步 可以 同时 使用 
低级 对象 分割 和 高级 信息 例如 跟踪 或者 事件 
描述 因此 我们/r 接下来/l 的/uj 工作/vn 将/d 专注/v 于/p 如何/r 
结合/v 空间/n 和/c 高级/b 信息/n 5 结论 本文 主要 有 
两点 贡献 1 我们 介绍 的 影响 因素 描述 可 
用于 对 变化 的 背景 进行 建模 2 基于 ECD 
我们 开发 了 一种 鲁棒 的 背景 生成 方法 最 
可靠 背景 模型 应用 MRBM 能从 包含 混乱 运动 对象 
的 视频 序列 中 生成 高质量 的 背景 图像 一些 
例子 显示 了 这种 方法 的 有效性 和 鲁棒性 然而 
仍然 存在 一些 有待 解决 的 问题 当前 的 工作 
中 仅仅 考虑 了 像素 的 时间 信息 怎么 结合 
空间 信息 来 提高 本 方法 的 鲁棒性 是 后续 
工作 的 重点 一种 直接 的 扩展 是 将 当前 
基于 像素 的 方法 修 改成 熔合 了 邻域 信息 
基于 区域 的 方法 另外 结合 使用 低级 分割 和 
高级 跟踪 信息 对 我们 的 工作 成果 也 将有 
极大 的 提高 6 致谢/v 在此/i 要/v 感谢/v 陈熙/i 霖/nr 
博士/n 和/c 山世光/nr 博士/n 他们 跟 作者 进行 了 很有帮助 
的 讨论 这项 研究 的 经费 由 以下 单位 赞助 
中国 自然科学 基金会 中国科学院 百名 人才 培养 计划 上海 银 
晨 智能 识别 科技 有限公司 参考文献 1 I . Haritaoglu 
D . Harwoodand L . . Davis W4 real time 
surveillance of people and their activities IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 809 – 830 
. 2 K . Toyama J . Krumm B . 
Brumitt B . Meyers . WallFlower Principles and Practice of 
background maintenance in IEEE International Conferenceon Computer Vision Corfu Greece 
1999 pp . 255 – 261 . 3 A . 
Elgammal D . Harwood L . Davis Non parametric model 
for background subtraction in European Conference on Computer Vision Dublin 
Ireland 2000 pp . 751 – 767 . 4 T 
. E . Boult R . J . Micheals X 
. Gao M . Eckmann Intothewoods visual Surveillance of noncooperative 
and camouflaged targets in complex outdoorsettings Proceedings of the IEEE 
89 2001 1382 – 1402 . 5 C . R 
. Wren A . Azarbayejani T . Darrell A . 
P . Pentland Pfinder Real time Tracking of the human 
body IEEE Transactions on Pattern Analysis andMachine Intelligence 19 7 
1998 780 – 785 . 6 C . Stauffer W 
. Grimson Adaptive background mixture models for real time tracking 
in IEEE Conference on Computer Vision and Pattern Recognition FortCollins 
USA 1999 pp . 246 – 252 . 7 . 
Rowe A . Blake Statistical background modelling for tracking with 
a virtual camera in British Machine Vision Conference Birmingham UK 
1995 pp . 423 – 432 . 8 C . 
Stauffer W . E . L . Grimson Learning patterns 
of activity using real time tracking IEEE Transactions on Pattern 
Analysis and Machine Intelligence 22 8 2000 747 – 757 
. 9 L . Li W . Huang I . 
Y . Gu Q . Tian Foreground object detection in 
changing Background based on color co occurrence statistics in IEEE 
Workshop on Applications of Computer Vision Orlando Florida 2002 pp 
. 269 – 274 . 10 P . KaewTraKulPong R 
. Bowden An improved adaptive background mixture Model for real 
time tracking with shadow detection in European Workshop on Advanced 
Video Based Surveillance Systems Kluwer Academic 2001 . 11 K 
. Kim T . Chalidabhongse D . Harwood L . 
Davis Real time foreground Background segmentation using codebook model Real 
Time Imaging 11 3 2005 172 – 185 . 12 
A . Elgammal R . Duraiswami L . Davis Effcient 
non parametric adaptive color Modeling using fast gauss transform in 
IEEE Conference on Computer Vision And Pattern Recognition Vol . 
2 2001 pp . 563 – 570 . 13 A 
. M . Elgammal R . Duraiswami L . . 
Davis Effcient kernel density estimation Using the fast gauss transform 
with applications to color modeling and tracking . IEEE Transactions 
on Pattern Analysis and Machine Intelligence 25 11 2003 1499 
– 1504 . 14 A . Elgammal Effcient nonparametric kernel 
density estimation for realtime computer vision Ph . D . 
thesis Rutgers The State University of New Jersey 2002 . 
15 H . Askar X . Li Z . Li 
Background clutter suppression and dim moving point Targets detection using 
nonparametric method in International Conference on Communications Circuits and Systems 
and West Sino Expositions Vol . 2 2002 pp . 
982 – 986 . 16 D . Thirde G . 
Jones Hierarchical probabilistic models for video object Segmentation and tracking 
in International Conference on P a t t e r 
n R e c o g n i t i 
o n Vol . 1 2004 pp . 636 – 
639 . 17 T . Liu A . W . 
Moore A . Gray Effcient exact k nn and nonparametric 
Classification in high dimensions in Neural Information Processing Systems 2003 
pp . 265 – 272 . 18 K . Fukunaga 
L . Hostetler The estimation of the gradient of adensity 
function With applications in pattern recognition IEEE Transactions on Information 
Theory 21 1975 32 – 40 . 19 D . 
Comaniciu P . Meer Mean shift a robust approach toward 
feature space analysis IEEE Transactions on Pattern Analysis and Machine 
Intelligence 24 5 2002 603 – 619 . 20 I 
. Y . H . Gu V . Gui Colour 
image segmentation using adaptive mean shift filters in International Conference 
on Image Processing 2001 pp . 726 – 729 . 
21 L . Yang P . Meer D . J 
. Foran Unsupervised segmentation based on robust Estimation and color 
active contour models IEEE Transactions on Information Technology in Biomedicine 
9 3 2005 475 – 486 . 22 D . 
Comaniciu V . Ramesh P . Meer Kernel based object 
tracking IEEE Transactions on Pattern Analysis and Machine Intelligence 25 
5 2003 564 – 577 . 23 R . T 
. Collins Y . Liu On line selection of discrimin 
ative tracking features in International Conference on Computer Vision 2003 
pp . 346 – 352 . 24 R . Collins 
Y . Liu M . Leordeanu On line selection of 
discriminative tracking features IEEE Transactions on Pattern Analysis and Machine 
Intelligence 27 10 2005 1631 – 1643 . 25 O 
. Debeir P . V . Ham R . Kiss 
C . Decaestecker Tracking of migrating cells under phase contrast 
video microscopy with combined mean shift processes IEEE Transactions on 
Medical Imaging 24 6 2005 697 – 711 . 26 
C . Shen M . J . Brooks A . 
van den Hengel Fast global kernel density Mode seeking with 
application to localisation and tracking in I n t e 
r n a t i o n a l C 
o n f e r e n c e on 
Computer Vision 2005 pp . 1516 – 1523 . 27 
Intel open source computer vision library 2004 . URL http 
/ / www . intel . com / technology / 
computing / opencv / 28 B . Lo . Velastin 
Automatic congestion detection system for underground platforms in International Symposium 
on Intelligent Multimedia Video and Speech Processing Hong Kong China 
2001 pp . 158 – 161 . 29 R . 
Cucchiara C . Grana M . Piccardi A . Prati 
Detecting moving objects ghosts and shadows in video streams IEEE 
Transactions on Pattern Analysis and Machine Intelligence 25 10 2003 
1337 – 1342 . 30 IEEE international workshop on performance 
evaluation of tracking and surveillance 2000 . URL ftp / 
/ ftp . pets . rdg . ac . uk 
/ pub / PETS2000 / 31 IEEE international workshop on 
performance evaluation of tracking and surveillance 2001 . URL ftp 
/ / ftp . pets . rdg . ac . 
uk / pub / PETS2001 / 32 IEEE international workshop 
on performance evaluation of tracking and surveillance 2006 . URL 
http / / pets2006 . net / data . html 
写在 最后 的话 本文 所述 的 方法 可说是 像素 级 
背景 建模 方式 的 巅峰 之作 在 接下来 的 时间 
里 我 将 尝试 按照 我 自己 的 理解 来 
实现 文中 的 算法 对于 论文 中 没有 讲述 透彻 
的 部分 我 也 试图 完善 它 敬请期待 在 翻译 
文章 的 过程 中 得到 了 赵德 斌 博士 的 
指导 在此 表示 感谢 同时 也 感谢 您 耐心 看完 
希望 对 您 有所 帮助 欲 知 后事 如何 且听 
下回分解 