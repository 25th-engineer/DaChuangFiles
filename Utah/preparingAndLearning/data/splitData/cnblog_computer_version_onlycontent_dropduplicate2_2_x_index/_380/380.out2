包括/v,：/w,理解/v,卷积/nw,神经/n,网络/n,使用/v,数据/n,增强/v,缓解/v,过/u,拟合/nz,使用/v,预训练/nw,卷积/nw,网络/n,做/v,特征/n,提取/v,微调/v,预训练/nw,网络/n,模型/n,可视化/nz,卷积/nw,网络/n,学习/v,结果/n,以及/c,分类/vn,决策/n,过程/n,介绍/v,卷积/nw,神经/n,网络/n,，/w,convnets/en,，/w,深度/n,学习/v,在/p,计算机/n,视觉/n,方面/n,广泛/a,应用/vn,的/u,一个/m,网络/n,模型/n,。/w,卷积/nw,网络/n,介绍/v,在/p,介绍/v,卷积/nw,神经/n,网络/n,理论/n,以及/c,神经/n,网络/n,在/p,计算机/n,视觉/n,方面/n,应用/vn,广泛/a,的/u,原因/n,之前/f,，/w,先/d,介绍/v,一个/m,卷积/nw,网络/n,的/u,实例/n,，/w,整体/n,了解/v,卷积/nw,网络/n,模型/n,。/w,用/p,卷积/nw,网络/n,识别/v,mnist/en,数据集/nw,。/w,from/en, ,keras/en, ,import/en, ,layers/en, ,from/en, ,keras/en, ,import/en, ,models/en, ,model/en, ,=/w, ,models/en,./w,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,32/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,,/w, ,input/en,_,shape/en,=/w,(/w,28/m,,/w, ,28/m,,/w, ,1/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,64/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,64/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w,卷积/nw,网络/n,接收/v,(/w,image/en,_,height/en,,/w,image/en,_,width/en,,/w,image/en,_,channels/en,)/w,形状/n,的/u,张量/nr,作为/v,输入/v,(/w,不/d,包括/v,batch/en, ,size/en,)/w,。/w,mnist/en,中/f,，/w,将/d,图片/n,转换/v,成/v,(/w,28/m,,/w,28/m,，/w,1/m,)/w,形状/n,，/w,然后/c,在/p,第一/m,层/q,传递/v,input/en,_,shape/en,参数/n,。/w,显示/v,网络/n,架构/n,model/en,./w,summary/en,(/w,)/w, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,conv/en,2/m,d/en,_,1/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,26/m,,/w, ,26/m,,/w, ,32/m,)/w, ,320/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,1/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,13/m,,/w, ,13/m,,/w, ,32/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,2/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,11/m,,/w, ,11/m,,/w, ,64/m,)/w, ,18496/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,2/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,5/m,,/w, ,5/m,,/w, ,64/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,3/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,3/m,,/w, ,3/m,,/w, ,64/m,)/w, ,36928/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,55/m,,/w,744/m, ,trainable/en, ,params/en,:/w, ,55/m,,/w,744/m, ,non/en,-/w,trainable/en, ,params/en,:/w, ,0/m,可以/v,看到/v,每个/r,conv/en,2/m,d/en,和/c,maxpooling/en,2/m,d/en,网络层/nz,输出/v,都/d,是/v,3/m,d/en,张量/nr,，/w,形状/n,为/p,(/w,height/en,,/w,width/en,,/w,channels/en,)/w,./w,随着/p,网络层/nz,的/u,加深/v,，/w,长度/n,和/c,宽度/n,逐渐/d,减小/v,；/w,通道/n,数/m,通过/p,conv/en,2/m,d/en,层/q,的/u,参数/n,控制/v,。/w,下/f,一步/mq,连接/v,dense/en,层/q,，/w,但/c,当前/t,输出/v,为/p,3/m,d/en,张量/nr,，/w,需要/v,将/d,3/m,d/en,张量平/nr,铺/v,成/v,1/m,d/en,，/w,然后/c,添加/vn,dense/en,层/q,。/w,model/en,./w,add/en,(/w,layers/en,./w,flatten/en,(/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,64/m,,/w,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,10/m,,/w,activation/en,=/w,'/w,softmax/en,'/w,)/w,)/w,因为/c,是/v,10/m,分类/vn,，/w,最后/f,一层/mq,为/p,10个/m,神经元/n,，/w,激活/vn,函数/n,为/p,softmax/en,。/w,最后/f,的/u,网络/n,架构/n,>,>,>, ,model/en,./w,summary/en,(/w,)/w, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,conv/en,2/m,d/en,_,1/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,26/m,,/w, ,26/m,,/w, ,32/m,)/w, ,320/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,1/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,13/m,,/w, ,13/m,,/w, ,32/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,2/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,11/m,,/w, ,11/m,,/w, ,64/m,)/w, ,18496/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,2/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,5/m,,/w, ,5/m,,/w, ,64/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,3/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,3/m,,/w, ,3/m,,/w, ,64/m,)/w, ,36928/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,flatten/en,_,1/m, ,(/w,flatten/en,)/w, ,(/w,none/en,,/w, ,576/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,1/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,64/m,)/w, ,36928/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,2/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,10/m,)/w, ,650/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,93/m,,/w,322/m, ,trainable/en, ,params/en,:/w, ,93/m,,/w,322/m, ,non/en,-/w,trainable/en, ,params/en,:/w, ,0/m,(/w,3/m,,/w,3/m,,/w,64/m,)/w,输出/v,平摊/v,成/v,(/w,576/m,,/w,)/w,向量/n,。/w,网络/n,训练/vn,from/en, ,keras/en,./w,datasets/en, ,import/en, ,mnist/en, ,from/en, ,keras/en,./w,utils/en, ,import/en, ,to/en,_,categorical/en, ,(/w,train/en,_,images/en,,/w, ,train/en,_,labels/en,)/w,,/w, ,(/w,test/en,_,images/en,,/w, ,test/en,_,labels/en,)/w, ,=/w, ,mnist/en,./w,load/en,_,data/en,(/w,)/w, ,train/en,_,images/en, ,=/w, ,train/en,_,images/en,./w,reshape/en,(/w,(/w,60000/m,,/w, ,28/m,,/w, ,28/m,,/w, ,1/m,)/w,)/w, ,train/en,_,images/en, ,=/w, ,train/en,_,images/en,./w,astype/en,(/w,'/w,float/en,32/m,'/w,)/w, ,//w, ,255/m, ,test/en,_,images/en, ,=/w, ,test/en,_,images/en,./w,reshape/en,(/w,(/w,10000/m,,/w, ,28/m,,/w, ,28/m,,/w, ,1/m,)/w,)/w, ,test/en,_,images/en, ,=/w, ,test/en,_,images/en,./w,astype/en,(/w,'/w,float/en,32/m,'/w,)/w, ,//w, ,255/m, ,train/en,_,labels/en, ,=/w, ,to/en,_,categorical/en,(/w,train/en,_,labels/en,)/w, ,test/en,_,labels/en, ,=/w, ,to/en,_,categorical/en,(/w,test/en,_,labels/en,)/w, ,model/en,./w,compile/en,(/w,optimizer/en,=/w,'/w,rmsprop/en,'/w,,/w,loss/en,=/w,'/w,categorical/en,_,crossentropy/en,'/w,,/w,metrics/en,=/w,[/w,'/w,accuracy/en,'/w,]/w,)/w, ,model/en,./w,fit/en,(/w,train/en,_,images/en,,/w, ,train/en,_,labels/en,,/w, ,epochs/en,=/w,5/m,,/w, ,batch/en,_,size/en,=/w,64/m,)/w,测试/vn,集/vg,上/f,模型/n,评估/vn,：/w,>,>,>, ,test/en,_,loss/en,,/w, ,test/en,_,acc/en, ,=/w, ,model/en,./w,evaluate/en,(/w,test/en,_,images/en,,/w, ,test/en,_,labels/en,)/w, ,>,>,>, ,test/en,_,acc/en, ,0.99080000000000001/m,在/p,dense/en,网络/n,上/f,准确率/n,为/p,97.8%/mq,，/w,基本/a,卷积/nw,网络/n,上/f,准确率/n,到/v,99%/mq,./w,为什么/r,简单/a,的/u,卷积/nw,网络/n,工作/vn,效果/n,这么/r,好/a,？/w,回答/v,之前/f,，/w,先/d,了解/v,conv/en,2/m,d/en,和/c,maxpooling/en,2/m,d/en,层/q,。/w,卷积/nw,操作/v,全/a,连接/v,网络/n,和/c,卷积/nw,网络/n,的/u,区别/n,在于/v,dense/en,全/a,连接/v,层/q,学习/v,输入/v,特征/n,空间/n,的/u,全局/n,模式/n,特征/n,，/w,而/c,卷积/nw,神经/n,网络/n,学习/v,输入/v,特征/n,空间/n,的/u,局部/n,模式/n,特征/n,。/w,卷积/nw,网络/n,的/u,两个/m,关键/n,特性/n,：/w,学习/v,具有/v,平移不变性/nw,的/u,模式/n,特征/n,：/w,一旦/d,学习/v,到/v,图片/n,左上角/nw,的/u,模式/n,特征/n,，/w,可以/v,在/p,任何/r,地方/n,识别/v,，/w,如/v,右下角/f,，/w,这种/r,特性/n,使得/v,图片/n,处理/v,更加/d,有效/a,，/w,需要/v,的/u,样本/n,相对/d,减少/v,(/w,实际/n,生活/vn,中/f,具有/v,平移不变性/nw,)/w,学习/v,模式/n,的/u,空间/n,层次/n,结构/n,：/w,第一/m,个/q,卷积层/nw,将/d,学习/v,小/a,的/u,局部/n,模式/n,，/w,如/v,边缘/n,，/w,第二/m,个/q,卷积层/nw,将/d,学习/v,由/p,第一/m,层/q,特征/n,构成/v,的/u,更/d,大/a,图案/n,，/w,等等/u,。/w,这/r,使得/v,卷积/nw,网络/n,能够/v,有效/a,地/u,学习/v,越来越/d,复杂/a,和/c,抽象/a,的/u,视觉/n,概念/n,。/w,(/w,现实/n,生活/vn,中/f,许多/m,都/d,是/v,分级/v,的/u,)/w,。/w,卷积/nw,在/p,3/m,d/en,张量/nr,上/f,运算/vn,，/w,称为/v,特征/n,映射/v,，/w,具有/v,两个/m,空间轴/nw,（/w,高度/d,和/c,宽度/n,）/w,以及/c,深度/n,轴/q,(/w,也/d,称为/v,通道/n,轴/q,)/w,./w,对/p,rgb/en,三/m,原色/n,图片/n,来说/u,，/w,通道/n,数/m,为/p,3/m,--/nrf,红/a,、/w,绿/a,、/w,蓝/a,；/w,mnist/en,数据/n,集中/v,图片/n,通道/n,数/m,为/p,1/m,--/nrf,灰度/n,图/n,。/w,卷积/nw,操作/v,在/p,输入/v,特征/n,图/n,上/f,小/a,分/q,片/q,上/f,，/w,然后/c,将/d,多/a,个/q,操作/v,结果/n,生成/vn,最后/f,的/u,特征/n,图/n,。/w,输出/v,的/u,特征/n,图/n,仍然/d,是/v,3/m,d/en,张量/nr,：/w,width/en,、/w,height/en,，/w,深度/n,可以/v,是/v,任意值/nw,，/w,因为/c,深度/n,是/v,网络层/nz,的/u,一个/m,参数/n,，/w,而且/c,深度/n,值/n,不再/d,代表/n,红/a,绿/a,蓝/a,颜色/n,通道/n,，/w,表示/v,过滤器/n,的/u,个数/n,。/w,过滤器/n,对/p,输入/v,数据/n,的/u,特定/b,方面/n,进行/v,编码/n,：/w,比如/v,在/p,高级别/n,，/w,单个/b,过滤器/n,可以/v,编码/n,“/w,输入/v,中/f,存在/v,面部/n,”/w,的/u,概念/n,。/w,卷积/nw,定义/n,的/u,两个/m,参数/n,：/w,卷积/nw,核/n,大小/n,：/w,通常/d,为/p,3/m,x/en,3/m,,/w,5/m,x/en,5/m,./w,卷积/nw,核/n,个数/n,：/w,卷积/nw,核/n,个数/n,等于/v,本层/nw,网络/n,输出/v,层/q,的/u,深度/n,。/w,keras/en,中/f,，/w,conv/en,2/m,d/en,网络层/nz,定义/n,:/w,conv/en,2/m,d/en,(/w,output/en,_,depth/en,,/w, ,(/w,window/en,_,height/en,,/w, ,window/en,_,width/en,)/w,)/w, ,./w,卷积/nw,：/w,卷/q,积核/nw,在/p,上/f,一层/mq,的/u,特征/n,图/n,的/u,全/a,通道/n,进行/v,滑动/vn,，/w,然后/c,抽取/vn,形状/n,为/p,(/w,window/en,_,height/en,,/w,window/en,_,width/en,,/w,input/en,_,depth/en,)/w,形状/n,的/u,3/m,d/en,片/q,特征/n,。/w,每个/r,3/m,d/en,片/q,特征/n,最后/f,转换/v,成/v,1/m,d/en,向量/n,(/w,卷/q,积运/nw,算/v,--/nrf,张量点/nr,积/v,)/w,，/w,形状/n,(/w,output/en,_,depth/en,,/w,)/w,，/w,所有/b,的/u,结果/n,向/p,量/n,整合/vn,形成/v,最后/f,的/u,3/m,d/en,特征/n,(/w,height/en,,/w,width/en,,/w,output/en,_,depth/en,)/w,./w,输出/v,结果/n,的/u,宽度/n,和/c,高度/d,可能/v,和/c,输入/v,宽度/n,高度/d,不同/a,，/w,由于/c,：/w,padding/en,项/q,；/w,strides/en, ,步长/nz,最/d,大/a,池化/nr, ,maxpooling/en,最大/a,池化/nr,层/q,的/u,作用/n,在于/v,对/p,特征/n,图/n,进行/v,下/f,采样/v,。/w,最大/a,池化/nr,在/p,特征/n,图中/nrf,选择/v,window/en,，/w,然后/c,每个/r,通道/n,的/u,在/p,窗口/s,内/f,求/v,最/d,大/a,值/n,。/w,概念/n,上/f,与/p,卷积/nw,操作/v,类似/v,，/w,卷积/nw,操作/v,在/p,小/a,patch/en, ,中/f,做/v,线性/n,转换/v,，/w,最大/a,池化/nr,是/v,求/v,最/d,大/a,值/n,，/w,通过/p,tensor/en,的/u,max/en,张量/nr,操作/v,。/w,最大/a,池化/nr,通常/d,采用/v,2/m,x/en,2/m,窗口/s,，/w,步长/nz,为/p,2/m,，/w,特征/n,图/n,减半/v,。/w,卷积/nw,通常/d,卷积/nw,核/n,大小/n,为/p,3/m,x/en,3/m,，/w,步长/nz,为/p,1/m,。/w,下/f,采样/v,的/u,目的/n,在于/v,减少/v,要/v,处理/v,特征/n,图/n,的/u,参/j,数量/n,，/w,通过/p,使/v,连续/a,的/u,卷积层/nw,看到/v,越来越/d,大/a,的/u,窗口/s,(/w,就/d,它们/r,所/u,涵盖/v,的/u,原始/a,输入/v,的/u,比例/n,而言/u,)/w,来/v,促使/v,空间滤波器/nw,层次/n,结构/n,。/w,最大/a,池化/nr,并/c,不/d,是/v,唯一/b,的/u,下/f,采样/v,方法/n,。/w,可以/v,使用/v,带/v,步长/nz,卷积/nw,、/w,或/c,平均/a,池化/nr,，/w,但是/c,最/d,大/a,池化/nr,的/u,工作/vn,效果/n,更/d,好/a,。/w,小数据集/nw,上/f,训练/vn,卷积/nw,网络/n,计算机/n,视觉/n,中/f,进场/v,会/v,遇到/v,使用/v,很/d,少/a,的/u,数据集/nw,去/v,训练/vn,一个/m,图像/n,分类/vn,模型/n,。/w,“/w,小/a,样本/n,”/w,意味/n,着/u,样本量/n,在/p,几百/nw,到/v,几万/nw,张/q,./w, ,比如/v,猫狗/nr,分类/vn,，/w,共/d,4000张/mq,图片/n,，/w,猫/n,2000张/mq,，/w,狗/n,2000张/mq,。/w,用/p,2000张/mq,图片/n,来/v,训练/vn,--/nrf,1000/m,张验证集/nw,，/w,1000张/mq,测试/vn,集/vg,。/w,首先/d,不/d,做/v,任何/r,正则化/nw,处理/v,，/w,直接/ad,训练/vn,，/w,得到/v,一个/m,baseline/en,模型/n,，/w,准确率/n,为/p,71%/mq,。/w,主要/b,问题/n,在于/v,模型/n,过/u,拟合/nz,。/w,之后/f,介绍/v,data/en, ,augmentation/en,数据/n,增强/v,，/w,减缓/v,过/u,拟合/nz,。/w,训练/vn,后/f,为/p,82%/mq,。/w,更/d,有效/a,的/u,方法/n,是/v,用/p,已/d,训练/vn,好/a,的/u,模型/n,最/d,特征/n,提取/v,---/nrf,准确率/n,90%/mq,～/w,96%/mq,，/w,或者/c,微调/v,已/d,训练/vn,好/a,的/u,网络/n,做/v,特征/n,提取/v,(/w,97%/mq,)/w,。/w,这/r,三种/mq,方法/n,有助于/v,在/p,小/a,数据集/nw,上/f,的/u,模型/n,训练/vn,。/w,深度/n,学习/v,与/p,小/a,数据/n,问题/n,的/u,相关性/n,可能/v,经常/d,听说/v,：/w,深度/n,学习/v,只能/v,工作/vn,在/p,大/a,数据集/nw,上/f,。/w,这种/r,说法/n,部分/n,正确/a,：/w,深度/n,学习/v,的/u,一个/m,重要/a,特性/n,在于/v,深度/n,学习/v,能/v,自己/r,在/p,训练/vn,数据/n,中/f,寻找/v,特征/n,，/w,而/c,不/d,需要/v,人工/n,干预/vn,，/w,而/c,这个/r,特性/n,只有/c,在/p,大/a,数据/n,样本量/n,上/f,才/d,有效/a,，/w,特别/d,是/v,输入/v,数据/n,维度/n,特别/d,高/a,时/ng,，/w,eg/en,图片/n,。/w,但是/c,，/w,对于/p,初/f,学者/n,来说/u,，/w,构成/v,大量/m,样本/n,的/u,内容/n,与/p,尝试/vn,训练/vn,的/u,网络/n,的/u,大小/n,和/c,深度/n,是/v,相对/d,的/u,。/w,用/p,几十/nw,张/q,图片/n,训练/vn,卷积/nw,网络/n,来/v,解决/v,一个/m,十分/d,复杂/a,的/u,问题/n,是/v,不/d,可能/v,的/u,，/w,但/c,如果/c,模型/n,比较/d,简单/a,经过/p,正则化/nw,处理/v,，/w,同时/c,任务/n,比较/d,简单/a,，/w,几百/nw,张/q,图片/n,也/d,能/v,解决/v,问题/n,。/w,因为/c,卷积/nw,网络/n,学习/v,局部/n,的/u,、/w,具有/v,平移不变性/nw,的/u,特征/n,，/w,它们/r,在/p,感知/v,问题/n,上/f,具有/v,很/d,高/a,的/u,数据/n,效率/n,。/w, ,尽管/c,相对/d,缺乏/v,数据/n,，/w,但/c,无需/v,额外/b,的/u,特征/n,工程/n,，/w,即使/c,在/p,非常/d,小/a,的/u,图像/n,数据集/nw,上/f,从头/d,开始/v,训练/vn,，/w,卷积/nw,网络/n,仍然/d,会/v,产生/v,合理/a,的/u,结果/n,。/w,更/d,重要/a,的/u,是/v,，/w,深度/n,学习/v,模型/n,本质/n,上/f,是/v,高度/d,可/v,再/d,利用/v,的/u,：/w,例如/v,，/w,可以/v,采用/v,在/p,大规模/b,数据集/nw,上/f,训练/vn,的/u,图像/n,分类/vn,或/c,语音/n,到/v,文本/n,模型/n,，/w,只/d,需/v,进行/v,微小/a,的/u,更改/v,,/w,就/d,可以/v,重新/d,用于/v,显著/a,不同/a,的/u,问题/n,上/f,。/w,具体而言/nw,，/w,以/p,计算机/n,视觉/n,为/p,例/n,，/w,许多/m,预先/d,训练/vn,好/a,的/u,模型/n,(/w,通常/d,在/p,imagenet/en,数据集/nw,上/f,训练/vn,)/w,提供/v,公开/ad,下载/v,，/w,当/p,样本量/n,少/a,时/ng,，/w,可以/v,用/p,在/p,模型/n,中/f,(/w,做/v,特征/n,提取/v,使用/v,)/w,提升/v,工作/vn,效果/n,。/w,数据/n,下载/v,keras/en,中/f,没有/v,包括/v,dogs/en, ,vs/en,./w, ,cats/en,数据集/nw,。/w,可以/v,在/p,kaggle/en,上/f,下载/v,。/w,图片/n,格式/n,为/p,jpegs/en,./w,数据集/nw,包含/v,25000张/mq,猫狗/nr,图片/n,(/w,一半/m,一半/m,)/w,。/w,下载/v,解/v,压缩/v,后/f,，/w,创建/v,一个/m,新/a,数据集/nw,包括/v,3个/m,文件夹/n,：/w,每/r,类/q,1000张/mq,的/u,训练集/nw,、/w,每/r,类/q,500张/mq,的/u,验证/vn,集/vg,和/c,每/r,类/q,500张/mq,的/u,测试/vn,集/vg,。/w,import/en, ,os/en,,/w,shutil/en, ,#,原始/a,数据/n, ,original/en,_,dataset/en,_,dir/en, ,=/w, ,'/w,//w,users/en,//w,fchollet/en,//w,downloads/en,//w,kaggle/en,_,original/en,_,data/en,'/w, ,#,新/a,数据集/nw,目录/n, ,base/en,_,dir/en, ,=/w, ,'/w,//w,users/en,//w,fchollet/en,//w,downloads/en,//w,cats/en,_,and/en,_,dogs/en,_,small/en,'/w, ,os/en,./w,mkdir/en,(/w,base/en,_,dir/en,)/w, ,#,创建/v,训练集/nw,、/w,验证/vn,集/vg,、/w,测试/vn,集/vg,目录/n, ,train/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,train/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,train/en,_,dir/en,)/w, ,validation/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,validation/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,validation/en,_,dir/en,)/w, ,test/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,test/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,test/en,_,dir/en,)/w, ,#,创建/v,对应/v,数据/n,集下/nw,不同/a,类别/n,的/u,目录/n, ,train/en,_,cats/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,train/en,_,dir/en,,/w, ,'/w,cats/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,train/en,_,cats/en,_,dir/en,)/w, ,train/en,_,dogs/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,train/en,_,dir/en,,/w, ,'/w,dogs/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,train/en,_,dogs/en,_,dir/en,)/w, ,validation/en,_,cats/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,validation/en,_,dir/en,,/w, ,'/w,cats/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,validation/en,_,cats/en,_,dir/en,)/w, ,validation/en,_,dogs/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,validation/en,_,dir/en,,/w, ,'/w,dogs/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,validation/en,_,dogs/en,_,dir/en,)/w, ,test/en,_,cats/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,test/en,_,dir/en,,/w, ,'/w,cats/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,test/en,_,cats/en,_,dir/en,)/w, ,test/en,_,dogs/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,test/en,_,dir/en,,/w, ,'/w,dogs/en,'/w,)/w, ,os/en,./w,mkdir/en,(/w,test/en,_,dogs/en,_,dir/en,)/w, ,fnames/en, ,=/w, ,[/w,'/w,cat/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1000/m,)/w,]/w,#,取/v,前/f,1000张/mq,猫/n,图片/n, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w,#,将/d,前/f,一/m,千张/n,猫/n,图片/n,复制/v,到/v,新/a,数据集/nw,目录/n,下/f, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,train/en,_,cats/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w, ,fnames/en, ,=/w, ,[/w,'/w,cat/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1000/m,,/w, ,1500/m,)/w,]/w,#,取/v,500张/mq,猫/n,图片/n, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w,#,500张/mq,猫/n,图片/n,复制/v,到/v,验证/vn,集/vg, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,validation/en,_,cats/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w, ,fnames/en, ,=/w, ,[/w,'/w,cat/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1500/m,,/w, ,2000/m,)/w,]/w,#,取/v,500张/mq,猫/n,图片/n, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w,#,500张/mq,猫/n,图片/n,做/v,测试/vn,集/vg, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,test/en,_,cats/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w, ,#,狗/n,图片/n, ,fnames/en, ,=/w, ,[/w,'/w,dog/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1000/m,)/w,]/w,#,1000张/mq,狗/n,图片/n,做/v,训练集/nw, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,train/en,_,dogs/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w, ,fnames/en, ,=/w, ,[/w,'/w,dog/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1000/m,,/w, ,1500/m,)/w,]/w, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w,#,500张/mq,狗/n,图片/n,做/v,验证/vn,集/vg, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,validation/en,_,dogs/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w, ,copies/en, ,the/en, ,next/en, ,500/m, ,fnames/en, ,=/w, ,[/w,'/w,dog/en,./w,{/w,}/w,./w,jpg/en,'/w,./w,format/en,(/w,i/en,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,1500/m,,/w, ,2000/m,)/w,]/w, ,for/en, ,fname/en, ,in/en, ,fnames/en,:/w,#,500张/mq,狗/n,图片/n,做/v,测试/vn,集/vg, ,src/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,original/en,_,dataset/en,_,dir/en,,/w, ,fname/en,)/w, ,dst/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,test/en,_,dogs/en,_,dir/en,,/w, ,fname/en,)/w, ,shutil/en,./w,copyfile/en,(/w,src/en,,/w, ,dst/en,)/w,构建/v,模型/n,from/en, ,keras/en, ,import/en, ,layers/en, ,from/en, ,keras/en, ,import/en, ,models/en, ,model/en, ,=/w, ,models/en,./w,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,32/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,,/w,input/en,_,shape/en,=/w,(/w,150/m,,/w, ,150/m,,/w, ,3/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,64/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,128/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,128/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,flatten/en,(/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,512/m,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,1/m,,/w, ,activation/en,=/w,'/w,sigmoid/en,'/w,)/w,)/w,模型/n,架构/n,：/w,>,>,>, ,model/en,./w,summary/en,(/w,)/w, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,conv/en,2/m,d/en,_,1/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,148/m,,/w, ,148/m,,/w, ,32/m,)/w, ,896/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,1/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,74/m,,/w, ,74/m,,/w, ,32/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,2/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,72/m,,/w, ,72/m,,/w, ,64/m,)/w, ,18496/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,2/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,36/m,,/w, ,36/m,,/w, ,64/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,3/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,34/m,,/w, ,34/m,,/w, ,128/m,)/w, ,73856/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,3/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,17/m,,/w, ,17/m,,/w, ,128/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,conv/en,2/m,d/en,_,4/m, ,(/w,conv/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,15/m,,/w, ,15/m,,/w, ,128/m,)/w, ,147584/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,maxpooling/en,2/m,d/en,_,4/m, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,7/m,,/w, ,7/m,,/w, ,128/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,flatten/en,_,1/m, ,(/w,flatten/en,)/w, ,(/w,none/en,,/w, ,6272/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,1/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,512/m,)/w, ,3211776/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,2/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,1/m,)/w, ,513/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,3/m,,/w,453/m,,/w,121/m, ,trainable/en, ,params/en,:/w, ,3/m,,/w,453/m,,/w,121/m, ,non/en,-/w,trainable/en, ,params/en,:/w, ,0/m,编译/vn,阶段/n,，/w,使用/v,rmsprop/en,优化/v,算法/n,，/w,binary/en, ,crossentropy/en,为/p,损失/n,函数/n,。/w,from/en, ,keras/en, ,import/en, ,optimizers/en, ,model/en,./w,compile/en,(/w,loss/en,=/w,'/w,binary/en,_,crossentropy/en,'/w,,/w,optimizer/en,=/w,optimizers/en,./w,rmsprop/en,(/w,lr/en,=/w,1/m,e/en,-/w,4/m,)/w,,/w,metrics/en,=/w,[/w,'/w,acc/en,'/w,]/w,)/w,数据/n,预/d,处理/v,数据/n,在/p,送/v,到/v,网络/n,模型/n,之前/f,应该/v,转换/v,成/v,浮点/nw,类型/n,的/u,张量/nr,。/w,目前/t,数据/n,集中/v,数据/n,格式/n,为/p,jpeg/en,，/w,所以/c,处理/v,步骤/n,大致/d,为/p,：/w,读/v,取/v,图片/n,文件/n,；/w,将/d,jpeg/en,格式/n,转换/v,为/p,rgb/en,像/v,素值/nr,；/w,转换/v,成/v,浮点/nw,类型/n,张量/nr,；/w,将/d,像/v,素值/nr,(/w,0/m,~/w,255/m,)/w,缩放/v,到/v,[/w,0/m,,/w,1/m,]/w,之间/f,。/w,针对/p,上述/b,步骤/n,，/w,keras/en,中/f,有/v,自动化/vn,处理/v,方法/n,。/w,keras/en,中/f,有/v,一个/m,图像/n,处理/v,模块/n,，/w,keras/en,./w,preprocessing/en,./w,image/en,./w, ,其中/r,包括/v,一个/m,imagedatagenerator/en,类/q,，/w,可以/v,将/d,磁盘/n,上/f,的/u,图片/n,文件/n,自动/d,转换/v,成/v,预/d,处理/v,的/u,张量/nr,batch/en,批量/d,。/w,使用/v,方法/n,：/w,from/en, ,keras/en,./w,preprocessing/en,./w,image/en, ,import/en, ,imagedatagenerator/en, ,train/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,)/w, ,test/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,)/w, ,#,将/d,图片/n,转换/v,成/v,150/m,x/en,150/m,，/w,类别/n,为/p,2/m,；/w,class/en,_,mode/en, ,确定/v,返回/v,标签/n,的/u,类型/n,binary/en,二/m,分类/vn, ,1/m,d/en,类型/n, ,train/en,_,generator/en,=/w,train/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,train/en,_,dir/en,,/w,\/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w,150/m,)/w,,/w,batch/en,_,size/en,=/w,20/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,validation/en,_,generator/en, ,=/w, ,test/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w, ,validation/en,_,dir/en,,/w,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w,batch/en,_,size/en,=/w,20/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w,生成器/n,generator/en,的/u,数据/n,结果/n,为/p,150/m,x/en,150/m, ,rgb/en,批量/d,图片/n,，/w,尺寸/n,为/p,(/w,20/m,,/w,150/m,,/w,150/m,,/w,3/m,)/w,，/w,二进制/n,标签/n,形状/n,(/w,20/m,,/w,)/w,。/w,每个/r,批量/d,大小/n,为/p,20个/m,样本/n,(/w,batch/en,_,size/en,为/p,20/m,)/w,./w, ,注意/v,-/w,生成器/n,无限期/n,地/u,生成/vn,这些/r,批次/n,：/w,它/r,在/p,目标/n,文件夹/n,的/u,图像/n,上/f,无/v,休止/v,地/u,循环/vn,。/w,使用/v,generator/en,数据/n,生成器/n,对/p,模型/n,进行/v,训练/vn,。/w,使用/v,fit/en,_,generator/en,方法/n,，/w,对于/p,数据/n,生成器/n,来说/u,，/w,相当/d,于/p,fit/en,方法/n,。/w,fit/en,_,generator/en,第一/m,个/q,参数/n,是/v,python/en,生成器/n,类型/n,，/w,能/v,不断/d,地/u,生成/vn,输入/v,和/c,标签/n,批量/d,。/w,因为/c,数据/n,不断/d,生成/vn,，/w,keras/en,模型/n,需要/v,知道/v,在/p,声明/n,一个/m,epoch/en,之前/f,从/p,发生器/n,中/f,抽取/vn,多少/r,批量/d,；/w,steps/en,_,per/en,_,epoch/en,参数/n,：/w,从/p,生成器/n,中/f,生成/vn, ,steps/en,_,per/en,_,epoch/en,个/q,批量/d,数据/n,；/w,在/p,经过/p,steps/en,_,per/en,_,epoch/en,次/q,梯度/n,下降/v,后/f,，/w,在/p,下/f,一个/m,epoch/en,上/f,进行/v,训练/vn,。/w,在/p,这里/r,，/w,批量/d,大小/n,为/p,20/m,，/w,一个/m,epoch/en,有/v,100个/m,批量/d,，/w,生成/vn,2000张/mq,图片/n,样本/n,。/w,使用/v,fit/en,_,generator/en,方法/n,，/w,可以/v,传递/v,validataion/en,_,data/en,参数/n,，/w,和/c,fit/en,方法/n,相似/a,。/w,值得/v,注意/v,的/u,是/v,，/w,这个/r,参数/n,可以/v,赋值/v,为/p,数据/n,生成器/n,，/w,也/d,可以/v,是/v,numpy/en,数/m,组/q,的/u,元组/nw,。/w,如果/c,validation/en,_,data/en,参数/n,是/v,数据/n,生成器/n,，/w,生成器/n,能/v,不断/d,地/u,生成/vn,数据/n,，/w,所以/c,需要/v,设置/v,validation/en,_,steps/en,参数/n,，/w,确定/v,从/p,生成器/n,中/f,生成/vn,多少/r,验证/vn,集/vg,批量/d,。/w,history/en, ,=/w, ,model/en,./w,fit/en,_,generator/en,(/w,train/en,_,generator/en,,/w,steps/en,_,per/en,_,epoch/en,=/w,100/m,,/w,epoch/en,=/w,30/m,，/w,validation/en,_,data/en,=/w,validation/en,_,generator/en,,/w,validation/en,_,steps/en,=/w,50/m,)/w,模型/n,保存/v,：/w,model/en,./w,save/en,(/w,'/w,cats/en,_,and/en,_,dogs/en,_,small/en,_,1/m,./w,h/en,5/m,'/w,)/w,训练集/nw,验证/vn,集/vg,准确率/n,、/w,损失值/nw,变化/vn,：/w,可以/v,发现/v,模型/n,发生/v,过/u,拟合/nz,现象/n,。/w,训练/vn,准确率/n,随着/p,时间线性/nw,增加/v,，/w,直到/v,100%/mq,，/w,而/c,验证/vn,集/vg,准确率/n,在/p,70/m,-/w,72%/mq,波动/vn,。/w,验证/vn,集/vg,损失/n,在/p,5个/m,epoch/en,之后/f,达到/v,最小值/nz,，/w,之后/f,开始/v,波动/vn,；/w,训练集/nw,损失线性/nw,减少/v,直到/v,为/p,0/m,因为/c,训练集/nw,只/d,有/v,2000张/mq,图片/n,，/w,遇到/v,的/u,第一/m,个/q,问题/n,就/d,是/v,模型/n,过/u,拟合/nz,。/w,dropout/en,、/w,权/n,重/a,衰减/vn,可以/v,减缓/v,过/u,拟合/nz,，/w,还有/v,一个/m,计算机/n,视觉/n,任务/n,中/f,，/w,经常/d,使用/v,的/u,处理/v,方法/n,：/w,数据/n,增强/v,data/en, ,augmentation/en,。/w,数据/n,增强/v,过度/d,拟合/nz,是/v,由于/c,样本/n,太/d,少/a,而/c,无法/v,学习/v,，/w,导致/v,无法/v,训练/vn,可以/v,推广/v,到/v,新/a,数据/n,的/u,模型/n,。/w,给/p,定/v,无限/vd,的/u,数据/n,，/w,模型/n,可以/v,学习/v,到/v,手头/n,数据/n,分布/v,的/u,每个/r,可能/v,方面/n,：/w,永远/d,不/d,会/v,过/u,拟合/nz,。/w,数据/n,增强/v,采用/v,从/p,现有/v,训练/vn,样本/n,生成/vn,更/d,多/a,训练/vn,数据/n,的/u,方法/n,，/w,通过/p,大量/m,随机/d,变换/v,来/v,增加/v,样本/n,，/w,从而/c,产生/v,新/a,的/u,可靠/a,的/u,图像/n,样本/n,。/w,目标/n,是/v,在/p,训练/vn,时/ng,，/w,模型/n,将/d,永远/d,不/d,会/v,看到/v,两张/mq,完全/ad,相同/a,的/u,图片/n,。/w,这/r,有助于/v,模型/n,观察/v,数据/n,的/u,更/d,多/a,方面/n,并/c,更/d,好/a,地/u,概括/v,数据/n,。/w,keras/en,中/f,，/w,可以/v,通过/p,实例化/nw,imagedatagenerator/en,实例/n,，/w,确定/v,图片/n,转换/v,方法/n,，/w,从而/c,实现/v,数据/n,增强/v,。/w,datagen/en, ,=/w, ,imagedatagenerator/en,(/w, ,rotation/en,_,range/en,=/w,40/m,,/w,#,最/d,大/a,旋转/v,角度/n, ,width/en,_,shift/en,_,range/en,=/w,0.2/m,,/w,#,水平/n,随机/d,平移/vn,图片/n,的/u,范围/n,，/w,比例/n, ,height/en,_,shift/en,_,range/en,=/w,0.2/m,,/w,#,垂直/v,随机/d,平移/vn,图片/n,的/u,范围/n, ,shear/en,_,range/en,=/w,0.2/m,,/w,#,随机/d,应用/vn,剪切/vn,变换/v, ,zoom/en,_,range/en,=/w,0.2/m,,/w,#,随机/d,缩放/v,图片/n, ,horizontal/en,_,flip/en,=/w,true/en,,/w,#,随机/d,翻转/v,图片/n, ,fill/en,_,mode/en,=/w,'/w,nearest/en,'/w,)/w,#,用于/v,填充/v,新/a,创建/v,的/u,像素/n,的/u,策略/n,，/w,在/p,旋转/v,或/c,宽度/n,//w,高度/d,偏/d,移/v,后/f,出现/v,如果/c,使用/v,这样/r,的/u,数据/n,增强/v,配置/vn,训练/vn,新/a,网络/n,，/w,网络/n,将/d,永远/d,不/d,会/v,看到/v,两张/mq,相同/a,的/u,输入/v,图片/n,。/w,但/c,它/r,看到/v,的/u,输入/v,仍然/d,是/v,严重/a,相互/d,关联/vn,的/u,，/w,因为/c,它们/r,来自/v,少量/m,原始/a,图像/n, ,-/w, ,无法/v,生成/vn,新/a,信息/n,，/w,只能/v,重新/d,混合/vn,现有/v,信息/n,。/w,因此/c,，/w,这/r,不/d,可能/v,完全/ad,摆脱/v,过/u,拟合/nz,。/w,为了/p,进一步/d,减缓/v,过/u,拟合/nz,，/w,需要/v,增加/v,dropout/en,层/q,，/w,在/p,全/a,连接/v,层/q,之前/f,。/w,新/a,网络/n,模型/n,：/w,model/en, ,=/w, ,models/en,./w,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,32/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,,/w, ,input/en,_,shape/en,=/w,(/w,150/m,,/w, ,150/m,,/w, ,3/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,64/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,128/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,conv/en,2/m,d/en,(/w,128/m,,/w, ,(/w,3/m,,/w, ,3/m,)/w,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,maxpooling/en,2/m,d/en,(/w,(/w,2/m,,/w, ,2/m,)/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,flatten/en,(/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dropout/en,(/w,0.5/m,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,512/m,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,1/m,,/w, ,activation/en,=/w,'/w,sigmoid/en,'/w,)/w,)/w, ,model/en,./w,compile/en,(/w,loss/en,=/w,'/w,binary/en,_,crossentropy/en,'/w,,/w,optimizer/en,=/w,optimizers/en,./w,rmsprop/en,(/w,lr/en,=/w,1/m,e/en,-/w,4/m,)/w,,/w,metrics/en,=/w,[/w,'/w,acc/en,'/w,]/w,)/w,使用/v,数据/n,增强/v,和/c,dropout/en,训练/vn,网络/n,。/w,train/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w, ,rescale/en,=/w,1/m,./w,//w,255/m,,/w, ,rotation/en,_,range/en,=/w,40/m,,/w, ,width/en,_,shift/en,_,range/en,=/w,0.2/m,,/w, ,height/en,_,shift/en,_,range/en,=/w,0.2/m,,/w, ,shear/en,_,range/en,=/w,0.2/m,,/w, ,zoom/en,_,range/en,=/w,0.2/m,,/w, ,horizontal/en,_,flip/en,=/w,true/en,,/w,)/w, ,test/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,)/w, ,train/en,_,generator/en, ,=/w, ,train/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,train/en,_,dir/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w,batch/en,_,size/en,=/w,32/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,validation/en,_,generator/en, ,=/w, ,test/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,validation/en,_,dir/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w,batch/en,_,size/en,=/w,32/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,history/en, ,=/w, ,model/en,./w,fit/en,_,generator/en,(/w,train/en,_,generator/en,,/w,steps/en,_,per/en,_,epoch/en,=/w,100/m,,/w, ,epochs/en,=/w,100/m,,/w,validation/en,_,data/en,=/w,validation/en,_,generator/en,,/w,validation/en,_,steps/en,=/w,50/m,)/w, ,model/en,./w,save/en,(/w,'/w,cats/en,_,and/en,_,dogs/en,_,small/en,_,2/m,./w,h/en,5/m,'/w,)/w,#,模型/n,保存/v,使用/v,数据/n,增强/v,和/c,dropout/en,后/f,，/w,训练集/nw,、/w,验证/vn,集/vg,准确率/n,和/c,损失/n,函数/n,变化/vn,。/w,模型/n,不再/d,过/u,拟合/nz,：/w,训练集/nw,曲线/n,和/c,验证/vn,集/vg,曲线/n,几乎/d,相互/d,吻合/v,。/w,准确率/n,82%/mq,，/w,提高/v,了/u,15%/mq,左右/m,。/w,使用/v,正则化/nw,技术/n,，/w,微调/v,网络/n,超/v,参数/n,，/w,模型/n,准确率/n,会/v,进一步/d,提高/v,，/w,到/v,86%/mq,~/w,87%/mq,./w,但是/c,很/d,难/a,继续/v,提高/v,，/w,因为/c,训练/vn,数据/n,有限/a,，/w,样本量/n,太/d,少/a,。/w,另/r,一种/mq,方法/n,，/w,可以/v,采用/v,预先/d,训练/vn,好/a,的/u,网络/n,模型/n,，/w,做/v,特征/n,提取/v,，/w,提高/v,准确率/n,。/w,使用/v,预训练/nw,卷积/nw,网络/n,在/p,小/a,图像/n,数据集/nw,上/f,使用/v,深度/n,学习/v,的/u,一种/mq,常见/a,且/c,高效/b,的/u,方法/n,是/v,使用/v,预训练/nw,网络/n,。/w,预训练/nw,网络/n,是/v,先前/t,在/p,大型/b,数据集/nw,上/f,训练/vn,的/u,已/d,保存/v,网络/n,，/w,通常/d,是/v,处理/v,大规模/b,图像/n,分类/vn,任务/n,。/w,如果/c,这个/r,原始/a,数据集/nw,足够/v,大/a,且/c,代表性/n,强/a,，/w,则/d,预训练/nw,网络/n,学习/v,的/u,特征/n,的/u,空间/n,层次/n,结构/n,可以/v,有效/a,地/u,充当/v,视觉/n,世界/n,的/u,通用/vn,模型/n,，/w,因此/c,其/r,特征/n,可以/v,证明/v,对/p,许多/m,不同/a,的/u,计算机/n,视觉/n,问题/n,都/d,有用/a,，/w,甚至/d,这些/r,新/a,问题/n,可能/v,涉及/v,与/p,原始/a,任务/n,完全/ad,不同/a,。/w,例如/v,，/w,可以/v,在/p,imagenet/en,上/f,训练/vn,网络/n,（/w,其中/r,类/q,主要/b,是/v,动物/n,和/c,日常/b,物品/n,）/w,，/w,然后/c,将/d,这个/r,训练/vn,好/a,的/u,网络/n,重新/d,用于/v,识别/v,图像/n,中/f,的/u,家具/n,物品/n,任务/n,中/f,。/w,与/p,许多/m,较/d,旧/a,的/u,浅/a,学习/v,方法/n,(/w,传统/n,机器/n,学习/v,方法/n,)/w,相比/v,，/w,学习/v,特征/n,在/p,不同/a,问题/n,中/f,的/u,这种/r,可/v,移植性/nw,是/v,深度/n,学习/v,的/u,关键/n,优势/n,，/w,并且/c,它/r,使得/v,深度/n,学习/v,对于/p,小/a,数据/n,问题/n,非常/d,有效/a,。/w,比如/v,在/p,imagenet/en,数据集/nw,上/f,训练/vn,的/u,网络/n,模型/n,（/w,140万个/m,标记/n,图像/n,和/c,1/m,,/w,000个/m,不/d,同类/n,）/w,。/w,imagenet/en,包含/v,许多/m,动物/n,类别/n,，/w,包括/v,不同/a,种类/n,的/u,猫/n,和/c,狗/n,，/w,因此/c,可以/v,期望/v,在/p,狗/n,与/p,猫/n,的/u,分类/vn,问题/n,上/f,表现/v,良好/a,。/w,使用/v,vgg/en,16/m,网络/n,架构/n,，/w,它/r,是/v,imagenet/en,的/u,简单/a,且/c,广泛/a,使用/v,的/u,convnet/en,架构/n,。/w,使用/v,预训练/nw,网络/n,有/v,两种/mq,方法/n,：/w,特征/n,提取/v,和/c,微调/v,。/w,特征/n,提取/v,特征/n,提取/v,包括/v,使用/v,先前/t,网络/n,学习/v,的/u,表示/v,从/p,新/a,样本/n,中/f,提取/v,有趣/a,特征/n,。/w,然后/c,，/w,这些/r,功能/n,将/d,通过/p,一个/m,新/a,的/u,分类器/nw,运行/vn,，/w,该/r,分类器/nw,从头/d,开始/v,训练/vn,。/w,如前所述/l,，/w,用于/v,图像/n,分类/vn,的/u,网络/n,包含/v,两/m,部分/n,：/w,它们/r,以/p,一系列/b,池化/nr,和/c,卷积层/nw,开始/v,，/w,并/c,以/p,密集/a,连接/v,的/u,分类器/nw,结束/v,。/w,第一/m,部分/n,称为/v,模型/n,的/u,卷积/nw,基础/n,。/w,在/p,卷积/nw,网络/n,中/f,，/w,特征/n,提取/v,包括/v,获取/v,先前/t,训练/vn,的/u,网络/n,的/u,卷积/nw,基础/n,，/w,通过/p,它/r,运行/vn,新/a,数据/n,，/w,以及/c,在/p,输出/v,之上/f,训练/vn,新/a,的/u,分类器/nw,。/w,为什么/r,只/d,重用/v,卷积/nw,网络/n,？/w,是否/v,可以/v,重复/v,使用/v,全/a,连接/v,分类器/nw,？/w,一般来说/l,，/w,应该/v,避免/v,这样/r,做/v,。/w,原因/n,是/v,卷积/nw,网络/n,学习/v,的/u,表示/v,可能/v,更/d,通用/vn,，/w,因此/c,更/d,可/v,重复/v,使用/v,：/w,特征/n,网络/n,的/u,特征/n,图/n,是/v,图片/n,上/f,一般/a,概念/n,的/u,存在/v,图/n,，/w,无论/c,处理/v,的/u,计算机/n,视觉/n,问题/n,是/v,什么/r,，/w,都/d,可能/v,是/v,有用/a,的/u,。/w,但是/c,，/w,分类器/nw,学习/v,的/u,表示/v,必然/d,特定/b,于/p,训练/vn,模型/n,的/u,类/q,集/vg, ,-/w, ,它们/r,将/d,仅/d,包含/v,关于/p,整个/b,图像/n,中/f,该类/r,或/c,该/r,类/q,的/u,存在/v,概率/n,的/u,信息/n,。/w,此外/c,，/w,在/p,全/a,连接/v,网络层/nz,的/u,输出/v,表示/v,不再/d,包含/v,有关/vn,对象/n,在/p,输入/v,图像/n,中/f,的/u,位置/n,信息/n,：/w,这些/r,表示/v,消除/v,了/u,空间/n,的/u,概念/n,，/w,而/c,卷积/nw,特征/n,图/n,还/d,可以/v,描述/v,对象/n,的/u,位置/n,信息/n,。/w,对于/p,对象/n,位置/n,很/d,重要/a,的/u,问题/n,，/w,全/a,连接/v,的/u,特征/n,表示/v,在/p,很/d,大/a,程度/n,上/f,是/v,无用/v,的/u,。/w,注意/v,，/w,由/p,特定/b,卷积层/nw,提取/v,的/u,表示/v,的/u,一般性/n,（/w,以及/c,因此/c,可/v,重用性/nw,）/w,的/u,级别/n,取决于/v,模型/n,中网络层/nw,的/u,深度/n,。/w,模型/n,中/f,较/d,早/a,出现/v,的/u,图层/nw,会/v,提取/v,局部/n,的/u,，/w,高度/d,通用/vn,的/u,特征/n,贴/v,图/n,（/w,例如/v,可视/v,边缘/n,，/w,颜色/n,和/c,纹理/n,）/w,，/w,而/c,较/d,高层/n,的/u,图层/nw,会/v,提取/v,更/d,抽象/a,的/u,概念/n,（/w,例如/v,“/w,猫/n,耳朵/n,”/w,或/c,“/w,狗眼/nw,”/w,）/w, ,。/w,因此/c,，/w,如果/c,训练/vn,数据集/nw,与/p,训练/vn,原始/a,模型/n,的/u,数据集/nw,有/v,很/d,大/a,差异/n,，/w,那么/r,最/d,好/a,只/d,使用/v,模型/n,的/u,前/f,几/m,层/q,来/v,进行/v,特征/n,提取/v,，/w,而/c,不/d,是/v,使用/v,整个/b,卷积/nw,网络/n,的/u,输出/v,。/w,在/p,这种/r,情况/n,下/f,，/w,因为/c,imagenet/en,类/q,集/vg,包含/v,多/a,个/q,dog/en,和/c,cat/en,类/q,，/w,所以/c,重用/v,原始/a,模型/n,的/u,全/a,连接/v,层/q,中/f,包含/v,的/u,信息/n,可能/v,是/v,有益/a,的/u,。/w,但是/c,我们/r,会/v,选择/v,不/d,这样/r,做/v,，/w,以便/d,涵盖/v,新/a,问题/n,的/u,类/q,集/vg,不/d,与/p,原始/a,模型/n,的/u,类/q,集/vg,重叠/v,的/u,更/d,一般/a,情况/n,。/w,通过/p,使用/v,在/p,imagenet/en,上/f,训练/vn,的/u,vgg/en,16/m,网络/n,的/u,卷积/nw,网络/n,来/v,实现/v,这/r,一点/m,，/w,从/p,猫/n,和/c,狗/n,图像/n,中/f,提取/v,有趣/a,的/u,特征/n,，/w,然后/c,在/p,这些/r,特征/n,之上/f,训练/vn,狗/n,与/p,猫/n,的/u,分类器/nw,。/w,keras/en,中/f,可以/v,直接/ad,获取/v,vgg/en,16/m,模型/n,，/w,包含/v,在/p,keras/en,./w,applications/en,模块/n,中/f,。/w,其中/r,还/d,包括/v,其他/r,模型/n,：/w,xceptioninception/en, ,v/en,3/m,resnet/en,50/m,vgg/en,16/m,vgg/en,19/m,mobilenet/en,实例化/nw,vgg/en,16/m,模型/n,：/w,from/en, ,keras/en,./w,application/en, ,import/en, ,vgg/en,16/m, ,conv/en,_,base/en, ,=/w, ,vgg/en,16/m,(/w,weights/en,=/w,'/w,imagenet/en,'/w,,/w,include/en,_,top/en,=/w,false/en,,/w,input/en,_,shape/en,=/w,(/w,150/m,,/w, ,150/m,,/w, ,3/m,)/w,)/w,构造器/nz,的/u,3个/m,参数/n,：/w,weights/en,：/w,读/v,取/v,权/n,重/a,保存/v,点/q,文件/n,，/w,初始化/v,模型/n,；/w,include/en,_,top/en,：/w,是否/v,包含/v,网络/n,的/u,全/a,连接/v,层/q,。/w,模型/n,，/w,全连/nw,接层/nw,分类/vn,类别/n,在/p,imagenet/en,上/f,的/u,1000类/mq,。/w,因为/c,要/v,使用/v,自己/r,创建/v,的/u,全/a,连接/v,分类器/nw,，/w,可以/v,不/d,使用/v,原来/d,的/u,全连/nw,接层/nw,；/w,input/en,_,shape/en,：/w,送/v,到/v,模型/n,中/f,图片/n,张量/nr,的/u,形状/n,；/w,参数/n,是/v,可/v,选/v,的/u,：/w,如果/c,不/d,传递/v,参数/n,，/w,网络/n,可以/v,处理/v,任意/d,形状/n,的/u,输入/v,。/w,vgg/en,16/m,网络/n,模型/n,架构/n,：/w,>,>,>, ,conv/en,_,base/en,./w,summary/en,(/w,)/w, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,input/en,_,1/m, ,(/w,inputlayer/en,)/w, ,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,3/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,64/m,)/w, ,1792/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,64/m,)/w, ,36928/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,64/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,128/m,)/w, ,73856/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,128/m,)/w, ,147584/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,128/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,295168/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,590080/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,590080/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,256/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,1180160/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,4/m,,/w, ,4/m,,/w, ,512/m,)/w, ,0/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,14/m,,/w,714/m,,/w,688/m, ,trainable/en, ,params/en,:/w, ,14/m,,/w,714/m,,/w,688/m, ,non/en,-/w,trainable/en, ,params/en,:/w, ,0/m,最后/f,一层/mq,的/u,特征/n,图/n,形状/n,为/p,(/w,4/m,,/w,4/m,,/w,512/m,)/w,./w,之后/f,连接/v,到/v,全/a,连接/v,分类器/nw,上/f,。/w,有/v,两种/mq,处理/v,方法/n,：/w,训练/vn,卷积/nw,网络/n,模型/n,部分/n,，/w,将/d,输出/v,结果/n,保存/v,在/p,磁盘/n,上/f,，/w,之后/f,读/v,取/v,磁盘/n,上/f,的/u,数据/n,送/v,到/v,全/a,连接/v,分类器/nw,中/f,。/w,优点/n,在于/v,运行/vn,高效/b,、/w,快速/d,，/w,因为/c,卷积/nw,网络/n,部分/n,针对/p,每张/r,输入/v,图片/n,只/d,运行/vn,一次/mq,，/w,而/c,卷积/nw,部分/n,是/v,最/d,耗时/v,、/w,耗费/v,运算/vn,能力/n,资源/n,的/u,；/w,但/c,同时/c,不/d,能/v,使用/v,数据/n,增强/v,；/w,将/d,全/a,连接/v,分类器/nw,和/c,卷积/nw,部分/n,整合/vn,到/v,一起/s,，/w,在/p,输入/v,数据/n,上端/s,到/v,端/v,的/u,运行/vn,；/w,可以/v,使用/v,数据/n,增强/v,，/w,因为/c,每次/r,输入/v,模型/n,的/u,图像/n,都/d,会/v,通过/p,模型/n,经过/p,卷积/nw,部分/n,。/w,不/d,使用/v,数据/n,增强/v,的/u,特征/n,提取/v,使用/v,imagedatagenerator/en,将/d,磁盘/n,文件/n,和/c,标签/n,读/v,取/v,成/v,张量/nr,形式/n,，/w,运行/vn,卷积/nw,部分/n,的/u,predict/en,提取/v,图片/n,特征/n,。/w,import/en, ,os/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,from/en, ,keras/en,./w,preprocessing/en,./w,image/en, ,import/en, ,imagedatagenerator/en, ,base/en,_,dir/en, ,=/w, ,'/w,//w,users/en,//w,fchollet/en,//w,downloads/en,//w,cats/en,_,and/en,_,dogs/en,_,small/en,'/w, ,train/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,train/en,'/w,)/w,#,训练/vn,数据/n, ,validation/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,validation/en,'/w,)/w,#,验证/vn,数据/n, ,test/en,_,dir/en, ,=/w, ,os/en,./w,path/en,./w,join/en,(/w,base/en,_,dir/en,,/w, ,'/w,test/en,'/w,)/w,#,测试/vn,数据/n, ,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,)/w,#, ,batch/en,_,size/en, ,=/w, ,20/m, ,def/en, ,extract/en,_,features/en,(/w,directory/en,,/w, ,sample/en,_,count/en,)/w,:/w,#,读/v,取/v,文件/n,，/w,转换/v,成/v,张量/nr,形式/n,；/w, ,features/en, ,=/w, ,np/en,./w,zeros/en,(/w,shape/en,=/w,(/w,sample/en,_,count/en,,/w, ,4/m,,/w, ,4/m,,/w, ,512/m,)/w,)/w, ,labels/en, ,=/w, ,np/en,./w,zeros/en,(/w,shape/en,=/w,(/w,sample/en,_,count/en,)/w,)/w, ,generator/en, ,=/w, ,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,directory/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w, ,batch/en,_,size/en,=/w,batch/en,_,size/en,,/w, ,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,i/en, ,=/w, ,0/m, ,for/en, ,inputs/en,_,batch/en,,/w, ,labels/en,_,batch/en, ,in/en, ,generator/en,:/w,#,生成/vn,对应/v,批量/d,数据/n, ,features/en,_,batch/en, ,=/w, ,conv/en,_,base/en,./w,predict/en,(/w,inputs/en,_,batch/en,)/w,#,卷积/nw,特征/n,提取/v,结果/n, ,features/en,[/w,i/en, ,*/w, ,batch/en,_,size/en, ,:/w, ,(/w,i/en, ,+/w, ,1/m,)/w, ,*/w, ,batch/en,_,size/en,]/w, ,=/w, ,features/en,_,batch/en, ,labels/en,[/w,i/en, ,*/w, ,batch/en,_,size/en, ,:/w, ,(/w,i/en, ,+/w, ,1/m,)/w, ,*/w, ,batch/en,_,size/en,]/w, ,=/w, ,labels/en,_,batch/en, ,i/en, ,+/w,=/w, ,1/m, ,if/en, ,i/en, ,*/w, ,batch/en,_,size/en, ,>,=/w, ,sample/en,_,count/en,:/w, ,break/en, ,return/en, ,features/en,,/w, ,labels/en, ,train/en,_,features/en,,/w, ,train/en,_,labels/en, ,=/w, ,extract/en,_,features/en,(/w,train/en,_,dir/en,,/w, ,2000/m,)/w, ,validation/en,_,features/en,,/w,validation/en,_,labels/en,=/w,extract/en,_,features/en,(/w,validation/en,_,dir/en,,/w, ,1000/m,)/w, ,test/en,_,features/en,,/w, ,test/en,_,labels/en, ,=/w, ,extract/en,_,features/en,(/w,test/en,_,dir/en,,/w, ,1000/m,)/w,当前/t,提取/v,特征/n,形状/n,为/p,(/w,samples/en,,/w,4/m,,/w,4/m,,/w,512/m,)/w,,/w,在/p,送/v,到/v,全/a,连接/v,层/q,之前/f,，/w,需要/v,先/d,平铺/nw,成/v,(/w,samples/en,,/w,8192/m,)/w,,/w,。/w,train/en,_,features/en, ,=/w, ,np/en,./w,reshape/en,(/w,train/en,_,features/en,,/w, ,(/w,2000/m,,/w, ,4/m, ,*/w, ,4/m, ,*/w, ,512/m,)/w,)/w, ,validation/en,_,features/en,=/w,np/en,./w,reshape/en,(/w,validation/en,_,features/en,,/w, ,(/w,1000/m,,/w, ,4/m, ,*/w, ,4/m, ,*/w, ,512/m,)/w,)/w, ,test/en,_,features/en, ,=/w, ,np/en,./w,reshape/en,(/w,test/en,_,features/en,,/w, ,(/w,1000/m,,/w, ,4/m, ,*/w, ,4/m, ,*/w, ,512/m,)/w,)/w,定义/n,全/a,连接/v,分类器/nw,，/w,将/d,特征/n,数据/n,送/v,到/v,分类器/nw,中/f,训练/vn,。/w,from/en, ,keras/en, ,import/en, ,models/en, ,from/en, ,keras/en, ,import/en, ,layers/en, ,from/en, ,keras/en, ,import/en, ,optimizers/en, ,model/en, ,=/w, ,models/en,./w,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,256/m,,/w, ,activation/en,=/w,'/w,relu/en,'/w,,/w, ,input/en,_,dim/en,=/w,4/m, ,*/w, ,4/m, ,*/w, ,512/m,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dropout/en,(/w,0.5/m,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,1/m,,/w, ,activation/en,=/w,'/w,sigmoid/en,'/w,)/w,)/w, ,model/en,./w,compile/en,(/w,optimizer/en,=/w,optimizers/en,./w,rmsprop/en,(/w,lr/en,=/w,2/m,e/en,-/w,5/m,)/w,,/w, ,loss/en,=/w,'/w,binary/en,_,crossentropy/en,'/w,,/w,metrics/en,=/w,[/w,'/w,acc/en,'/w,]/w,)/w, ,history/en, ,=/w, ,model/en,./w,fit/en,(/w,train/en,_,features/en,,/w, ,train/en,_,labels/en,,/w,epochs/en,=/w,30/m,,/w, ,batch/en,_,size/en,=/w,20/m,,/w, ,validation/en,_,data/en,=/w,(/w,validation/en,_,features/en,,/w, ,validation/en,_,labels/en,)/w,)/w,验证/vn,集/vg,、/w,训练集/nw,上/f,损失值/nw,和/c,准确率/n,变化/vn,情况/n,：/w,验证/vn,集/vg,准确率/n,达到/v,90%/mq,./w,但/c,图示/v,显示/v,模型/n,从/p,开始/v,就/d,过/u,拟合/nz,了/u,。/w,使用/v,数据/n,正/d,增强/v,可以/v,缓解/v,一下/m,。/w,使用/v,数据/n,增强/v,的/u,特征/n,提取/v,和/c,第一/m,种/q,方法/n,相比/v,，/w,运算/vn,速度/n,更/d,慢/a,、/w,耗费/v,运算/vn,资源/n,更/d,多/a,，/w,通常/d,需要/v,gpu/en,。/w,如果/c,gpu/en,上/f,速度/n,还/d,慢/a,，/w,最好/d,使用/v,第一/m,种/q,方法/n,。/w,from/en, ,keras/en, ,import/en, ,models/en, ,from/en, ,keras/en, ,import/en, ,layers/en, ,model/en, ,=/w, ,models/en,./w,sequential/en,(/w,)/w, ,model/en,./w,add/en,(/w,conv/en,_,base/en,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,flatten/en,(/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,256/m,,/w, ,activation/en,=/w,'/w,relu/en,'/w,)/w,)/w, ,model/en,./w,add/en,(/w,layers/en,./w,dense/en,(/w,1/m,,/w, ,activation/en,=/w,'/w,sigmoid/en,'/w,)/w,)/w,模型/n,架构/n,为/p,：/w,>,>,>, ,model/en,./w,summary/en,(/w,)/w, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,vgg/en,16/m, ,(/w,model/en,)/w, ,(/w,none/en,,/w, ,4/m,,/w, ,4/m,,/w, ,512/m,)/w, ,14714688/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,flatten/en,_,1/m, ,(/w,flatten/en,)/w, ,(/w,none/en,,/w, ,8192/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,1/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,256/m,)/w, ,2097408/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,dense/en,_,2/m, ,(/w,dense/en,)/w, ,(/w,none/en,,/w, ,1/m,)/w, ,257/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,16/m,,/w,812/m,,/w,353/m, ,trainable/en, ,params/en,:/w, ,16/m,,/w,812/m,,/w,353/m, ,non/en,-/w,trainable/en, ,params/en,:/w, ,0/m,在/p,模型/n,训练/vn,之前/f,，/w,需要/v,对/p,卷积/nw,部分/n,进行/v,freeze/en,‘/w,冻/v,住/v,’/w,。/w,freezing/en,网络/n,层/q,意味着/v,避免/v,在/p,训练/vn,过程/n,网络层/nz,的/u,参数/n,被/p,更新/v,。/w,如果/c,不/d,做/v,‘/w,freeze/en,’/w,处理/v,，/w,训练/vn,过程/n,中/f,卷积/nw,部分/n,提取/v,的/u,特征/n,会/v,逐渐/d,改变/v,。/w,在/p,keras/en,中/f,，/w,可以/v,通过/p,设置/v,trainable/en,参数/n,为/p,false/en,进行/v,freeze/en,处理/v,。/w,conv/en,_,base/en,./w,trainable/en, ,=/w, ,false/en,注意/v,，/w,为了/p,使/v,这些/r,更改/v,生效/v,，/w,必须/d,首先/d,编译/vn,模型/n,。/w,如果/c,在/p,编译/vn,后/f,修改/v,了/u,权/n,重/a,可/v,训练性/nw,，/w,则/d,应/v,重新/d,编译/vn,模型/n,，/w,否则/c,将/d,忽略/v,这些/r,更改/v,。/w,from/en, ,keras/en,./w,preprocessing/en,./w,image/en, ,import/en, ,imagedatagenerator/en, ,from/en, ,keras/en, ,import/en, ,optimizers/en, ,train/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,,/w, ,rotation/en,_,range/en,=/w,40/m,,/w, ,width/en,_,shift/en,_,range/en,=/w,0.2/m,,/w, ,height/en,_,shift/en,_,range/en,=/w,0.2/m,,/w, ,shear/en,_,range/en,=/w,0.2/m,,/w, ,zoom/en,_,range/en,=/w,0.2/m,,/w, ,horizontal/en,_,flip/en,=/w,true/en,,/w, ,fill/en,_,mode/en,=/w,'/w,nearest/en,'/w,)/w, ,test/en,_,datagen/en, ,=/w, ,imagedatagenerator/en,(/w,rescale/en,=/w,1/m,./w,//w,255/m,)/w, ,train/en,_,generator/en,=/w,train/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,train/en,_,dir/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w, ,batch/en,_,size/en,=/w,20/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,validation/en,_,generator/en, ,=/w, ,test/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,validation/en,_,dir/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w,batch/en,_,size/en,=/w,20/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,model/en,./w,compile/en,(/w,loss/en,=/w,'/w,binary/en,_,crossentropy/en,'/w,,/w,optimizer/en,=/w,optimizers/en,./w,rmsprop/en,(/w,lr/en,=/w,2/m,e/en,-/w,5/m,)/w,,/w,metrics/en,=/w,[/w,'/w,acc/en,'/w,]/w,)/w, ,history/en, ,=/w, ,model/en,./w,fit/en,_,generator/en,(/w,train/en,_,generator/en,,/w,steps/en,_,per/en,_,epoch/en,=/w,100/m,,/w, ,epochs/en,=/w,30/m,,/w,validation/en,_,data/en,=/w,validation/en,_,generator/en,,/w,validation/en,_,steps/en,=/w,50/m,)/w,损失值/nw,和/c,准确率/n,变化/vn,：/w,验证/vn,集/vg,上/f,准确率/n,达到/v,96%/mq,./w,模型/n,微调/v,fine/en,-/w,tuning/en,另/r,一种/mq,广泛/a,使用/v,的/u,模型/n,重用/v,技术/n,，/w,对/p,特征/n,提取/v,的/u,补充/v,，/w,就/d,是/v,模型/n,参数/n,微调/v,。/w,微调/v,包括/v,解冻/v,用于/v,特征/n,提取/v,的/u,冻结/v,模型/n,基础/n,的/u,一些/m,顶层/f,，/w,并/c,联合/v,训练/vn,模型/n,的/u,新/a,添加/vn,部分/n,（/w,在/p,这种/r,情况/n,下/f,，/w,全/a,连接/v,的/u,分类器/nw,）/w,和/c,这些/r,顶层/f,。/w,这/r,称为/v,微调/v,，/w,因为/c,它/r,稍微/d,调整/vn,了/u,重复/v,使用/v,的/u,模型/n,的/u,抽象/a,表示/v,，/w,以/p,使/v,它们/r,与/p,手头/n,的/u,问题/n,更/d,相关/v,。/w,微调/v,网络/n,模型/n,步骤/n,：/w,在/p,已经/d,训练/vn,好/a,的/u,网络/n,模型/n,上/f,添加/vn,自/p,定义/n,网络/n,模型/n,；/w,freeze/en,”/w,冻/v,住/v,“/w,训练/vn,好/a,的/u,模型/n,；/w,训练/vn,添加/vn,部分/n,网络/n,；/w,unfreeze/en,”/w,解冻/v,“/w,部分/n,base/en, ,网络/n,；/w,重新/d,训练/vn,解冻/v,部分/n,和/c,添加/vn,部分/n,。/w,base/en,部分/n,网络/n,模型/n,：/w,>,>,>, ,conv/en,_,base/en,./w,summary/en,(/w,)/w, ,layer/en, ,(/w,type/en,)/w, ,output/en, ,shape/en, ,param/en, ,#, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,input/en,_,1/m, ,(/w,inputlayer/en,)/w, ,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,3/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,64/m,)/w, ,1792/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,150/m,,/w, ,150/m,,/w, ,64/m,)/w, ,36928/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,1/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,64/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,128/m,)/w, ,73856/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,75/m,,/w, ,75/m,,/w, ,128/m,)/w, ,147584/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,2/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,128/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,295168/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,590080/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,37/m,,/w, ,37/m,,/w, ,256/m,)/w, ,590080/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,3/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,256/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,1180160/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,18/m,,/w, ,18/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,4/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,0/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,1/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,2/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,conv/en,3/m, ,(/w,convolution/en,2/m,d/en,)/w,(/w,none/en,,/w, ,9/m,,/w, ,9/m,,/w, ,512/m,)/w, ,2359808/m, ,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_,_, ,block/en,5/m,_,pool/en, ,(/w,maxpooling/en,2/m,d/en,)/w, ,(/w,none/en,,/w, ,4/m,,/w, ,4/m,,/w, ,512/m,)/w, ,0/m, ,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w,=/w, ,total/en, ,params/en,:/w, ,14714688/m,微调/v,模型/n,的/u,最后/f,3个卷/mq,积层/nw,，/w,意味/n,着/u,到/v,block/en,4/m,_,pool/en,之前/f,都/d,被/p,”/w,冻/v,住/v,“/w,，/w,网络层/nz,block/en,5/m,_,conv/en,1/m,,/w,block/en,5/m,_,conv/en,2/m,和/c,block/en,5/m,_,conv/en,3/m,都/d,是/v,可/v,训练/vn,的/u,。/w,为什么/r,不/d,微调/v,更/d,多/a,层/q,？/w,为什么/r,不/d,微调/v,整个/b,卷积/nw,网络/n,？/w,可以/v,这么/r,做/v,。/w,但是/c,你/r,需要/v,考虑/v,以下/f,几/m,点/q,：/w,卷积/nw,网络/n,中/f,的/u,前/f,几/m,层/q,编码/n,更/d,通用/vn,，/w,可/v,重用/v,的/u,特征/n,，/w,而/c,更/d,高层/n,的/u,编码/n,更/d,专业/n,的/u,特征/n,。/w,微调/v,更/d,专业/n,的/u,功能/n,更/d,有用/a,，/w,因为/c,这些/r,功能/n,需要/v,重新/d,用于/v,新/a,问题/n,。/w,微调/v,下层/f,会/v,有/v,快速/d,下降/v,的/u,回报/vn,。/w,训练/vn,的/u,参数/n,越/d,多/a,，/w,越/d,有/v,可能/v,过度/d,拟合/nz,。/w,卷积/nw,网络/n,模型/n,有/v,1500万个/m,参数/n,，/w,因此/c,尝试/vn,在/p,小/a,数据集/nw,上/f,训练/vn,它/r,会/v,有/v,风险/n,。/w,一个/m,很/d,好/a,的/u,策略/n,是/v,只/d,微调/v,卷积/nw,基础/n,中/f,的/u,前/f,两个/m,或/c,三个层/mq,。/w,conv/en,_,base/en,./w,trainable/en, ,=/w, ,true/en, ,set/en,_,trainable/en, ,=/w, ,false/en, ,for/en, ,layer/en, ,in/en, ,conv/en,_,base/en,./w,layers/en,:/w, ,if/en, ,layer/en,./w,name/en, ,=/w,=/w, ,'/w,block/en,5/m,_,conv/en,1/m,'/w,:/w,#,block/en,5/m,_,conv/en,1/m,可/v,训练/vn, ,set/en,_,trainable/en, ,=/w, ,true/en,#,flag/en,可/v,训练/vn, ,if/en, ,set/en,_,trainable/en,:/w, ,layer/en,./w,trainable/en, ,=/w, ,true/en,#,block/en,5/m,_,conv/en,1/m,网络/n,层/q,设置/v,为/p,可/v,训练/vn,；/w, ,else/en,:/w, ,layer/en,./w,trainable/en, ,=/w, ,false/en,#,其它/r,层/q,不可/v,训练/vn,现在/t,可以/v,开始/v,微调/v,网络/n,了/u,。/w,使用/v,rmsprop/en,优化器/nw,以/p,非常/d,低/a,的/u,学习/v,速率/n,执行/v,此/r,操作/v,。/w,使用/v,低/a,学习率/nw,的/u,原因/n,是/v,希望/v,限制/v,对/p,正在/d,微调/v,的/u,三个/m,网络层/nz,的/u,表示/v,所/u,做/v,的/u,修改/v,的/u,幅度/n,。/w,太/d,大/a,的/u,更新/v,可能/v,会/v,损害/v,这些/r,表示/v,。/w,model/en,./w,compile/en,(/w,loss/en,=/w,'/w,binary/en,_,crossentropy/en,'/w,,/w,optimizer/en,=/w,optimizers/en,./w,rmsprop/en,(/w,lr/en,=/w,1/m,e/en,-/w,5/m,)/w,,/w,metrics/en,=/w,[/w,'/w,acc/en,'/w,]/w,)/w, ,history/en, ,=/w, ,model/en,./w,fit/en,_,generator/en,(/w,train/en,_,generator/en,,/w,steps/en,_,per/en,_,epoch/en,=/w,100/m,,/w, ,epochs/en,=/w,100/m,,/w,validation/en,_,data/en,=/w,validation/en,_,generator/en,,/w,validation/en,_,steps/en,=/w,50/m,)/w,验证/vn,集/vg,、/w,测试/vn,集/vg,上/f,损失/n,函数/n,和/c,准确率/n,变化/vn,：/w,请/v,注意/v,，/w,损失/n,曲线/n,没有/v,显示/v,任何/r,真正/d,的/u,改善/v,（/w,事实上/l,，/w,它/r,正在/d,恶化/v,）/w,。/w,如果/c,损失/n,没有/v,减少/v,，/w,准确度/n,如何/r,保持/v,稳定/a,或/c,改善/v,？/w,答案/n,很/d,简单/a,：/w,展示/v,的/u,是/v,指数/n,损失值/nw,的/u,平均值/n,;/w,但是/c,对于/p,准确性/n,而言/u,重要/a,的/u,是/v,损失值/nw,的/u,分布/v,，/w,而/c,不/d,是/v,它们/r,的/u,平均值/n,，/w,因为/c,精度/n,是/v,模型/n,预测/v,的/u,类/q,概率/n,的/u,二元/b,阈值/n,的/u,结果/n,。/w,即使/c,没有/v,反映/v,在/p,平均/a,损失/n,中/f,，/w,该/r,模型/n,仍/d,可能/v,会/v,有所/v,改善/v,。/w,在/p,测试/vn,集/vg,上/f,评估/vn,：/w,test/en,_,generator/en, ,=/w, ,test/en,_,datagen/en,./w,flow/en,_,from/en,_,directory/en,(/w,test/en,_,dir/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,,/w,batch/en,_,size/en,=/w,20/m,,/w,class/en,_,mode/en,=/w,'/w,binary/en,'/w,)/w, ,test/en,_,loss/en,,/w, ,test/en,_,acc/en, ,=/w, ,model/en,./w,evaluate/en,_,generator/en,(/w,test/en,_,generator/en,,/w,steps/en,=/w,50/m,)/w, ,print/en,(/w,'/w,test/en, ,acc/en,:/w,'/w,,/w, ,test/en,_,acc/en,)/w, ,#,97%/mq,小结/n,convnets/en,是/v,用于/v,计算机/n,视觉/n,任务/n,的/u,最佳/z,机器/n,学习/v,模型/n,。/w,即使/c,在/p,非常/d,小/a,的/u,数据集/nw,上/f,也/d,可以/v,从头/d,开始/v,训练/vn,，/w,并/c,获得/v,不错/a,的/u,结果/n,。/w,在/p,小型/b,数据集/nw,上/f,，/w,过度/d,拟合/nz,将/d,是/v,主要/b,问题/n,。/w,在/p,处理/v,图像/n,数据/n,时/ng,，/w,数据/n,增强/v,是/v,对抗/v,过度/d,拟合/nz,的/u,有效/a,方法/n,；/w,通过/p,重用/v,现有/v,的/u,卷积/nw,网络/n,模型/n,可以/v,在/p,新/a,数据集/nw,上/f,做/v,特征/n,提取/v,；/w,这/r,是/v,处理/v,小/a,图像/n,数据集/nw,的/u,有用/a,技术/n,。/w,作为/v,特征/n,提取/v,的/u,补充/v,，/w,可以/v,使用/v,模型/n,微调/v,，/w,让/v,模型/n,适应/v,新/a,问题/n,---/nrf,以前/f,现有/v,模型/n,可以/v,学习/v,新/a,问题/n,的/u,特征/n,表示/v,，/w,能/v,进一步/d,推动/v,性能/n,。/w,卷积/nw,学习/v,结果/n,可视化/nz,人们/n,常/d,说/v,，/w,深度/n,学习/v,模型/n,是/v,“/w,黑匣子/n,”/w,：/w,学习/v,表示/v,难以/d,提取/v,以及/c,很/d,难以/d,人类/n,可/v,读/v,的/u,形式/n,呈现/v,。/w,虽然/c,对于/p,某些/r,类型/n,的/u,深度/n,学习/v,模型/n,来说/u,这/r,是/v,部分/n,正确/a,的/u,，/w,但/c,对于/p,convnets/en,来说/u,绝对/d,不/d,是/v,这样/r,。/w,由/p,convnet/en,学习/v,的/u,表示/v,非常/d,适合/v,可视化/nz,，/w,这/r,在/p,很/d,大/a,程度/n,上/f,是/v,因为/c,它们/r,是/v,视觉/n,概念/n,的/u,表示/v,。/w,三种/mq,常见/a,的/u,可视化/nz,方法/n,：/w,可视化/nz,中间/f,信号/n,输出/v,（/w,中间/f,激活/vn,）/w,--/nrf,有助于/v,了解/v,连续/a,的/u,convnet/en,层/q,如何/r,转换/v,输入/v,数据/n,，/w,以及/c,了解/v,各个/r,convnet/en,过滤器/n,的/u,含义/n,；/w,可视化/nz,convnets/en,过滤器/n,---/nrf,有助于/v,准确/a,理解/v,convnet/en,中/f,每个/r,过滤器/n,可/v,接受/v,的/u,视觉/n,模式/n,或/c,概念/n,；/w,可视化/nz,图像/n,中类/nw,激活/vn,的/u,热图---/nrf,有助于/v,了解/v,图像/n,的/u,哪些/r,部分/n,被/p,识别/v,为/p,属于/v,给/p,定/v,的/u,类/q,，/w,从而/c,可以/v,在/p,图像/n,中/f,本地化/v,对象/n,。/w,可视化/nz,中间/f,激活/vn,值/n,可视化/nz,中间/f,激活/vn,包括/v,在/p,给/p,定/v,特定/b,输入/v,的/u,情况/n,下/f,显示/v,由/p,网络/n,中/f,的/u,各种/r,卷积/nw,和/c,池化/nr,层/q,输出/v,的/u,特征/n,映射/v,（/w,层/q,的/u,输出/v,通常/d,称为/v,其/r,激活/vn,，/w,激活/vn,函数/n,的/u,输出/v,）/w,。/w,这/r,给/p,出/v,了/u,如何/r,将/d,输入/v,分解/v,为/p,网络/n,学习/v,的/u,不同/a,过滤器/n,的/u,视图/n,。/w,希望/v,从/p,三个/m,维度/n,：/w,宽度/n,，/w,高度/d,和/c,深度/n,（/w,通道/n,）/w,可视化/nz,特征/n,图/n,。/w,每个/r,通道/n,编码/n,相对/d,独立/v,的/u,特征/n,，/w,因此/c,可视化/nz,这些/r,特征/n,图/n,的/u,正确/a,方法/n,是/v,通过/p,将/d,每个/r,通道/n,的/u,内容/n,独立/v,地/u,绘制/v,为/p,2/m,d/en,图像/n,。/w,加/v,载/v,保存/v,的/u,模型/n,from/en, ,keras/en,./w,models/en, ,import/en, ,load/en,_,model/en, ,model/en, ,=/w, ,load/en,_,model/en,(/w,'/w,cats/en,_,and/en,_,dogs/en,_,small/en,_,2/m,./w,h/en,5/m,'/w,)/w, ,img/en,_,path/en, ,=/w, ,'/w,./w,//w,cats/en,_,and/en,_,dogs/en,_,small/en,//w,test/en,//w,cats/en,//w,cat/en,./w,1700/m,./w,jpg/en,'/w,#,给/p,定/v,一张/mq,图片/n, ,from/en, ,keras/en,./w,preprocessing/en, ,import/en, ,image/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,img/en, ,=/w, ,image/en,./w,load/en,_,img/en,(/w,img/en,_,path/en,,/w, ,target/en,_,size/en,=/w,(/w,150/m,,/w, ,150/m,)/w,)/w, ,img/en,_,tensor/en, ,=/w, ,image/en,./w,img/en,_,to/en,_,array/en,(/w,img/en,)/w, ,img/en,_,tensor/en, ,=/w, ,np/en,./w,expand/en,_,dims/en,(/w,img/en,_,tensor/en,,/w, ,axis/en,=/w,0/m,)/w, ,img/en,_,tensor/en, ,//w,=/w, ,255/m,./w,查看/v,所有/b,网络层/nz,的/u,输出/v,结果/n,：/w,from/en, ,keras/en, ,import/en, ,models/en, ,layer/en,_,outputs/en, ,=/w, ,[/w,layer/en,./w,output/en, ,for/en, ,layer/en, ,in/en, ,model/en,./w,layers/en,[/w,:/w,8/m,]/w,]/w, ,activation/en,_,model/en,=/w,models/en,./w,model/en,(/w,inputs/en,=/w,model/en,./w,input/en,,/w,outputs/en,=/w,layer/en,_,outputs/en,)/w,输入/v,图像/n,输入/v,时/ng,，/w,此/r,模型/n,返回/v,原始/a,模型/n,中网络层/nw,激活/vn,的/u,值/n,。/w,一个/m,多/a,输出/v,模型/n,：/w,到/v,目前/t,为止/u,，/w,看到/v,的/u,模型/n,只/d,有/v,一个/m,输入/v,和/c,一个/m,输出/v,。/w,在/p,一般/a,情况/n,下/f,，/w,模型/n,可以/v,具有/v,任意/d,数量/n,的/u,输入/v,和/c,输出/v,。/w,这个/r,有/v,一个/m,输入/v,和/c,八个/m,输出/v,：/w,每/r,层/q,激活/vn,一个/m,输出/v,。/w,模型/n,运行/vn,：/w,activations/en, ,=/w, ,activation/en,_,model/en,./w,predict/en,(/w,img/en,_,tensor/en,)/w,#,输出/v,：/w,每/r,层/q,激活/vn,值/n,一个/m,数组/n,第一/m,个/q,卷积层/nw,结果/n,：/w,first/en,_,layer/en,_,activation/en, ,=/w, ,activations/en,[/w,0/m,]/w, ,print/en,(/w,first/en,_,layer/en,_,activation/en,./w,shape/en,)/w, ,#,(/w,1/m,,/w, ,148/m,,/w, ,148/m,,/w, ,32/m,)/w, ,import/en, ,matplotlib/en,./w,pyplot/en, ,as/en, ,plt/en, ,plt/en,./w,matshow/en,(/w,first/en,_,layer/en,_,activation/en,[/w,0/m,,/w, ,:/w,,/w, ,:/w,,/w, ,4/m,]/w,,/w, ,cmap/en,=/w,'/w,viridis/en,'/w,)/w,#,第/m,4/m,通道/n,可视化/nz,网络/n,中/f,所有/b,激活/vn,函/n,数值/n,可视化/nz,，/w,将/d,8个/m,网络/n,层/q,激活/vn,函数/n,值/n,的/u,所有/b,通道/n,结果/n,显示/v,出来/v,。/w,layer/en,_,names/en, ,=/w, ,[/w,]/w, ,for/en, ,layer/en, ,in/en, ,model/en,./w,layers/en,[/w,:/w,8/m,]/w,:/w, ,layer/en,_,names/en,./w,append/en,(/w,layer/en,./w,name/en,)/w, ,images/en,_,per/en,_,row/en, ,=/w, ,16/m, ,for/en, ,layer/en,_,name/en,,/w, ,layer/en,_,activation/en, ,in/en, ,zip/en,(/w,layer/en,_,names/en,,/w, ,activations/en,)/w,:/w, ,n/en,_,features/en, ,=/w, ,layer/en,_,activation/en,./w,shape/en,[/w,-/w,1/m,]/w, ,size/en, ,=/w, ,layer/en,_,activation/en,./w,shape/en,[/w,1/m,]/w, ,n/en,_,cols/en, ,=/w, ,n/en,_,features/en, ,//w,//w, ,images/en,_,per/en,_,row/en, ,display/en,_,grid/en, ,=/w, ,np/en,./w,zeros/en,(/w,(/w,size/en, ,*/w, ,n/en,_,cols/en,,/w, ,images/en,_,per/en,_,row/en, ,*/w, ,size/en,)/w,)/w, ,for/en, ,col/en, ,in/en, ,range/en,(/w,n/en,_,cols/en,)/w,:/w, ,for/en, ,row/en, ,in/en, ,range/en,(/w,images/en,_,per/en,_,row/en,)/w,:/w, ,channel/en,_,image/en,=/w,layer/en,_,activation/en,[/w,0/m,,/w,:/w,,/w,:/w,,/w,col/en,*/w,images/en,_,per/en,_,row/en,+/w,row/en,]/w, ,channel/en,_,image/en, ,-/w,=/w, ,channel/en,_,image/en,./w,mean/en,(/w,)/w, ,channel/en,_,image/en, ,//w,=/w, ,channel/en,_,image/en,./w,std/en,(/w,)/w, ,channel/en,_,image/en, ,*/w,=/w, ,64/m, ,channel/en,_,image/en, ,+/w,=/w, ,128/m, ,channel/en,_,image/en,=/w,np/en,./w,clip/en,(/w,channel/en,_,image/en,,/w,0/m,,/w, ,255/m,)/w,./w,astype/en,(/w,'/w,uint/en,8/m,'/w,)/w, ,display/en,_,grid/en,[/w,col/en,*/w,size/en,:/w,(/w,col/en,+/w,1/m,)/w,*/w,size/en,,/w,row/en,*/w,size/en,:/w,(/w,row/en,+/w,1/m,)/w,*/w,size/en,]/w,=/w,channel/en,_,image/en, ,scale/en, ,=/w, ,1/m,./w, ,//w, ,size/en, ,plt/en,./w,figure/en,(/w,figsize/en,=/w,(/w,scale/en, ,*/w, ,display/en,_,grid/en,./w,shape/en,[/w,1/m,]/w,,/w, ,scale/en, ,*/w, ,display/en,_,grid/en,./w,shape/en,[/w,0/m,]/w,)/w,)/w, ,plt/en,./w,title/en,(/w,layer/en,_,name/en,)/w, ,plt/en,./w,grid/en,(/w,false/en,)/w, ,plt/en,./w,imshow/en,(/w,display/en,_,grid/en,,/w, ,aspect/en,=/w,'/w,auto/en,'/w,,/w, ,cmap/en,=/w,'/w,viridis/en,'/w,)/w,值得/v,注意/v,的/u,是/v,：/w,第一/m,层/q,充当/v,各种/r,边缘/n,检测器/n,的/u,集合/v,。/w,在/p,那个/r,阶段/n,，/w,激活/vn,值/n,几乎/d,保留/v,了/u,初始/b,图片/n,中/f,的/u,所有/b,信息/n,；/w,随着/p,网络层/nz,的/u,增加/v,，/w,激活/vn,变/v,得/u,越来越/d,抽象/a,，/w,在/p,视觉/n,上/f,也/d,不/d,那么/r,容易/a,理解/v,；/w,开始/v,编码/n,更/d,高/a,级别/n,的/u,概念/n,，/w,如/v,“/w,猫耳/nr,”/w,和/c,“/w,猫眼/n,。/w,”/w,更/d,高/a,级别/n,的/u,表示/v,关于/p,图像/n,的/u,视觉/n,内容/n,越来越/d,少/a,，/w,关于/p,图像/n,类型/n,的/u,信息/n,越来越/d,多/a,；/w,激活/vn,的/u,稀疏性/nw,随着/p,层/q,的/u,深度/n,而/c,增加/v,：/w,在/p,第一/m,层/q,中/f,，/w,所有/b,滤波器/n,都/d,由/p,输入/v,图像/n,激活/vn,;/w,但/c,在/p,以下/f,图层/nw,中/f,，/w,越来越/d,多/a,的/u,过滤器/n,为/p,空白/n,。/w,这/r,意味着/v,在/p,输入/v,图像/n,中/f,找/v,不/d,到/v,滤镜/n,编码/n,的/u,图案/n,。/w,刚刚/d,证明/v,了/u,深度/n,神经/n,网络/n,所/u,学习/v,的/u,表征/v,的/u,一个/m,重要/a,的/u,普遍/ad,特征/n,：/w,由/p,层/q,提取/v,的/u,特征/n,随着/p,层/q,的/u,深度/n,而/c,变/v,得/u,越来越/d,抽象/a,。/w,更/d,高层/n,的/u,激活/vn,越来越/d,少/a,地/u,显示/v,关于/p,所/u,看到/v,的/u,特定/b,输入/v,的/u,信息/n,，/w,越来越/d,多/a,关于/p,目标/n,的/u,信息/n,./w, ,深度/n,神经/n,网络/n,有效/a,地/u,充当/v,信息/n,蒸馏/v,管道/n,，/w,原始/a,数据/n,进入/v,（/w,在/p,这种/r,情况/n,下/f,为/p,rgb/en,图像/n,）/w,并/c,被/p,重复/v,变换/v,以便/d,过滤/v,掉/v,无关信息/nt,（/w,例如/v,，/w,图像/n,的/u,特定/b,视觉/n,外观/n,）/w,，/w,以及/c,有用/a,的/u,信息/n,被/p,放大/v,和/c,细化/v,（/w,例如/v,，/w,图像/n,的/u,类/q,）/w,。/w,可视化/nz,卷积/nw,核/n,另/r,一种/mq,检查/vn,由/p,convnet/en,学习/v,的/u,过滤器/n,的/u,简单/a,方法/n,是/v,显示/v,每个/r,过滤器/n,要/v,响应/v,的/u,视觉/n,模式/n,。/w,这/r,可以/v,通过/p,输入/v,空间/n,中/f,的/u,渐变/v,上升/v,来/v,完成/v,：/w,将/d,渐变/v,下降/v,应用/vn,于/p,convnet/en,的/u,输入/v,图像/n,的/u,值/n,空间/n,上/f,；/w,从/p,空白/n,输入/v,图像/n,开始/v,，/w,最大化/v,特定/b,过滤器/n,的/u,响应/v,。/w,得到/v,的/u,输入/v,图像/n,将/d,是/v,所选/v,滤波器/n,最/d,大/a,响应/v,的/u,图像/n,。/w,过程/n,很/d,简单/a,：/w,您/r,将/d,构建/v,一个/m,损失/n,函数/n,，/w,使/v,给/p,定卷/nw,积层/nw,中/f,给/p,定滤波器/nw,的/u,值/n,最大化/v,，/w,然后/c,您/r,将/d,使用/v,随机/d,梯度/n,下降/v,来/v,调整/vn,输入/v,图像/n,的/u,值/n,，/w,以便/d,最大化/v,此/r,激活/vn,值/n,。/w,例如/v,，/w,这/r,是/v,在/p,vgg/en,16/m,的/u,block/en,3/m,_,conv/en,1/m,中/f,激活/vn,过滤器/n,0/m,的/u,损失/n,./w,from/en, ,keras/en,./w,applications/en, ,import/en, ,vgg/en,16/m, ,from/en, ,keras/en, ,import/en, ,backend/en, ,as/en, ,k/en, ,model/en, ,=/w, ,vgg/en,16/m,(/w,weights/en,=/w,'/w,imagenet/en,'/w,,/w,include/en,_,top/en,=/w,false/en,)/w, ,layer/en,_,name/en, ,=/w, ,'/w,block/en,3/m,_,conv/en,1/m,'/w, ,filter/en,_,index/en, ,=/w, ,0/m, ,layer/en,_,output/en,=/w,model/en,./w,get/en,_,layer/en,(/w,layer/en,_,name/en,)/w,./w,output/en,#,得到/v,block/en,3/m,_,conv/en,1/m,的/u,激活/vn,值/n, ,loss/en, ,=/w, ,k/en,./w,mean/en,(/w,layer/en,_,output/en,[/w,:/w,,/w, ,:/w,,/w, ,:/w,,/w, ,filter/en,_,index/en,]/w,)/w,要/v,实现/v,梯度/n,下降/v,，/w,需要/v,相对于/nw,模型/n,输入/v,求/v,损失/n,的/u,梯度/n,。/w,grads/en, ,=/w, ,k/en,./w,gradients/en,(/w,loss/en,,/w, ,model/en,./w,input/en,)/w,[/w,0/m,]/w,使用/v,梯度/n,正/d,则/d,化平/nw,滑梯度值/nw,grads/en, ,//w,=/w, ,(/w,k/en,./w,sqrt/en,(/w,k/en,./w,mean/en,(/w,k/en,./w,square/en,(/w,grads/en,)/w,)/w,)/w, ,+/w, ,1/m,e/en,-/w,5/m,)/w,计算/v,损失/n,张量/nr,和/c,梯度/n,张量/nr,。/w,使用/v,keras/en,的/u,iterate/en,函数/n,，/w,接收/v,numpy/en,张量/nr,，/w,返回/v,关于/p,损失/n,和/c,梯度/n,的/u,张量列表/nr,。/w,iterate/en, ,=/w, ,k/en,./w,function/en,(/w,[/w,model/en,./w,input/en,]/w,,/w, ,[/w,loss/en,,/w, ,grads/en,]/w,)/w, ,import/en, ,numpy/en, ,as/en, ,np/en, ,loss/en,_,value/en,,/w, ,grads/en,_,value/en, ,=/w, ,iterate/en,(/w,[/w,np/en,./w,zeros/en,(/w,(/w,1/m,,/w, ,150/m,,/w, ,150/m,,/w, ,3/m,)/w,)/w,]/w,)/w,将/d,张量/nr,转换/v,为/p,图片/n,格式/n,：/w,def/en, ,deprocess/en,_,image/en,(/w,x/en,)/w,:/w, ,x/en, ,-/w,=/w, ,x/en,./w,mean/en,(/w,)/w, ,x/en, ,//w,=/w, ,(/w,x/en,./w,std/en,(/w,)/w, ,+/w, ,1/m,e/en,-/w,5/m,)/w, ,x/en, ,*/w,=/w, ,0.1/m, ,x/en, ,+/w,=/w, ,0.5/m, ,x/en, ,=/w, ,np/en,./w,clip/en,(/w,x/en,,/w, ,0/m,,/w, ,1/m,)/w, ,x/en, ,*/w,=/w, ,255/m, ,x/en, ,=/w, ,np/en,./w,clip/en,(/w,x/en,,/w, ,0/m,,/w, ,255/m,)/w,./w,astype/en,(/w,'/w,uint/en,8/m,'/w,)/w, ,return/en, ,x/en,整合/vn,卷积核可视化/nw,函数/n,：/w,def/en, ,generate/en,_,pattern/en,(/w,layer/en,_,name/en,,/w, ,filter/en,_,index/en,,/w, ,size/en,=/w,150/m,)/w,:/w, ,layer/en,_,output/en, ,=/w, ,model/en,./w,get/en,_,layer/en,(/w,layer/en,_,name/en,)/w,./w,output/en, ,loss/en, ,=/w, ,k/en,./w,mean/en,(/w,layer/en,_,output/en,[/w,:/w,,/w, ,:/w,,/w, ,:/w,,/w, ,filter/en,_,index/en,]/w,)/w, ,grads/en, ,=/w, ,k/en,./w,gradients/en,(/w,loss/en,,/w, ,model/en,./w,input/en,)/w,[/w,0/m,]/w, ,grads/en, ,//w,=/w, ,(/w,k/en,./w,sqrt/en,(/w,k/en,./w,mean/en,(/w,k/en,./w,square/en,(/w,grads/en,)/w,)/w,)/w, ,+/w, ,1/m,e/en,-/w,5/m,)/w, ,iterate/en, ,=/w, ,k/en,./w,function/en,(/w,[/w,model/en,./w,input/en,]/w,,/w, ,[/w,loss/en,,/w, ,grads/en,]/w,)/w, ,input/en,_,img/en,_,data/en, ,=/w, ,np/en,./w,random/en,./w,random/en,(/w,(/w,1/m,,/w, ,size/en,,/w, ,size/en,,/w, ,3/m,)/w,)/w, ,*/w, ,20/m, ,+/w, ,128/m,./w, ,step/en, ,=/w, ,1/m,./w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,40/m,)/w,:/w, ,loss/en,_,value/en,,/w, ,grads/en,_,value/en, ,=/w, ,iterate/en,(/w,[/w,input/en,_,img/en,_,data/en,]/w,)/w, ,input/en,_,img/en,_,data/en, ,+/w,=/w, ,grads/en,_,value/en, ,*/w, ,step/en, ,img/en, ,=/w, ,input/en,_,img/en,_,data/en,[/w,0/m,]/w, ,return/en, ,deprocess/en,_,image/en,(/w,img/en,)/w,这些/r,过滤器/n,可视化/nz,展示/v,了/u,很多/m,关于/p,如何/r,使用/v,数字/n,网络/n,层/q,来/v,查看/v,世界/n,：/w,网络/n,中/f,的/u,每个/r,层/q,都/d,学习/v,了/u,一组/mq,过滤器/n,，/w,以便/d,它们/r,的/u,输入/v,可以/v,表示/v,为/p,过滤器/n,的/u,组合/v,。/w,类别/n,激活/vn,值/n,heatmap/en,可视化/nz,一种/mq,可视化/nz,技术/n,：/w,有助于/v,理解/v,给/p,定/v,图像/n,的/u,哪些/r,部分/n,引导/v,其/r,进行/v,最终/d,分类/vn,决策/n,的/u,可视化/nz,技术/n,。/w,这种/r,通用/vn,类别/n,的/u,技术/n,称为/v,类/q,激活/vn,图/n,（/w,cam/en,）/w,可视化/nz,，/w,它/r,包括/v,在/p,输入/v,图像/n,上/f,生成/vn,类/q,激活/vn,的/u,热图/nrf,。/w,类/q,激活/vn,热图/nrf,是/v,与/p,特定/b,输出/v,类/q,相/d,关联/vn,的/u,分数/n,的/u,2/m,d/en,网格/n,，/w,针对/p,任何/r,输入/v,图像/n,中/f,的/u,每个/r,位置/n,计算/v,，/w,指示/n,每个/r,位置/n,相对于/nw,所/u,考虑/v,的/u,类/q,的/u,重要/a,程度/n,。/w,小结/n,convnets/en,是/v,处理/v,视觉/n,分类/vn,问题/n,的/u,最佳/z,工具/n,；/w,convnets/en,通过/p,学习/v,模块化/nz,模式/n,和/c,概念/n,的/u,层次/n,结构/n,来/v,表示/v,视觉/