深度/n,学习/v,与/p,计算机/n,视觉/n,系列/q,(/w,2/m,)/w,_,图像/n,分类/vn,与/p,knn/en,作者/n,：/w, ,寒/ag,小阳/nr,时间/n,：/w,2015年/t,11月/t,。/w,出处/n,：/w,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,han/en,_,xiaoyang/en,//w,article/en,//w,details/en,//w,49949535/m,声明/n,：/w,版权/n,所有/b,，/w,转载/v,请/v,注明/v,出处/n,，/w,谢谢/v,1/m,./w, ,图像/n,分类/vn,问题/n,这/r,是/v,人/n,每天/r,自然而然/i,会/v,做/v,的/u,事情/n,，/w,普通/a,到/v,大部分/m,时候/n,，/w,我们/r,都/d,感知/v,不/d,到/v,我们/r,在/p,完成/v,一个个/nw,这样/r,的/u,任务/n,。/w,早晨/t,起床/v,洗漱/v,，/w,你/r,要/v,看看/v,洗漱台/nw,一堆/mq,东西/n,中/f,哪个/r,是/v,杯子/n,，/w,哪个/r,是/v,你/r,的/u,牙刷/n,；/w,吃/v,早餐/n,的/u,时候/n,你/r,要/v,分辨/v,食物/n,和/c,碗/q,碟/ng,…/w,抽象/a,一下/m,，/w,对于/p,一张/mq,输入/v,的/u,图片/n,，/w,要/v,判定/v,它/r,属于/v,给/p,定/v,的/u,一些/m,标签/n,//w,类别/n,中/f,的/u,哪/r,一个/m,。/w,看似/v,很/d,简单/a,的/u,一个/m,问题/n,，/w,这么/r,多/a,年/q,却/d,一直/d,是/v,计算机/n,视觉/n,的/u,一个/m,核心/n,问题/n,，/w,应用/vn,场景/n,也/d,很多/m,。/w,它/r,的/u,重要性/n,还/d,体现/v,在/p,，/w,其实/d,其他/r,的/u,一些/m,计算机/n,视觉/n,的/u,问题/n,(/w,比如说/l,物体/n,定位/vn,和/c,识别/v,、/w,图像/n,内容/n,分割/v,等/u,)/w,都/d,可以/v,基于/p,它/r,去/v,完成/v,。/w,咱们/r,举/v,个/q,例子/n,从/p,机器/n,学习/v,的/u,角度/n,描述/v,一下/m,这个/r,问题/n,^,_,^,计算机/n,拿/v,到/v,一张/mq,图片/n,(/w,如/v,下/f,图/n,所示/nz,)/w,，/w,然后/c,需要/v,给/p,出/v,它/r,对应/v,{/w,猫/n,，/w,狗/n,，/w,帽子/n,，/w,杯子/n,}/w,4类/mq,的/u,概率/n,。/w,人类/n,是/v,灰常/d,牛逼/nw,的/u,生物/n,，/w,我们/r,一瞥/nw,就/d,知道/v,这/r,货/n,是/v,猫/n,。/w,然而/c,对/p,计算机/n,而言/u,，/w,他们/r,是/v,没/d,办法/n,像/v,人/n,一样/u,『/w,看/v,』/w,到/v,整/m,张/q,图片/n,的/u,。/w,对/p,它/r,而言/u,，/w,这/r,是/v,一个/m,3维/mq,的/u,大/a,矩阵/n,，/w,包含/v,248/m,*/w,400个/m,像素/n,点/q,，/w,每个/r,像/v,素点/nr,又/d,有/v,红/a,绿/a,蓝/a,(/w,rgb/en,)/w,3个/m,颜色/n,通道/n,的/u,值/n,，/w,每个/r,值/n,在/p,0/m,(/w,黑/a,)/w,-/w,255/m,(/w,白/a,)/w,之间/f,，/w,计算机/n,就/d,需要/v,根据/p,这/r,248/m,*/w,400/m,*/w,3/m,=/w,297600个/m,数值/n,去/v,判定/v,这/r,货/n,是/v,『/w,猫/n,』/w,1.1/m, ,图像/n,识别/v,的/u,难点/n,图像/n,识别/v,看似/v,很/d,直接/ad,。/w,但/c,实际上/d,包含/v,很多/m,挑战/vn,，/w,人类/n,可是/c,经过/p,数亿/nw,年/q,的/u,进化/vn,才/d,获得/v,如此/r,强大/a,的/u,大脑/n,，/w,对于/p,各种/r,物体/n,有/v,着/u,精/a,准/a,的/u,视觉/n,理解/v,力/n,。/w,总体/n,而言/u,，/w,我们/r,想/v,『/w,教/v,』/w,会计算机/nw,去/v,认识/v,一类/b,图/n,，/w,会/v,有/v,下面/f,这样/r,一些/m,困难/an,：/w,视角/n,不同/a,，/w,每个/r,事物/n,旋转/v,或者/c,侧视/nw,最后/f,的/u,构图/v,都/d,完全/ad,不同/a,尺寸/n,大小/n,不/d,统一/vn,，/w,相同/a,内容/n,的/u,图片/n,也/d,可/v,大/a,可/v,小/a,变形/v,，/w,很多/m,东西/n,处于/v,特殊/a,的/u,情形/n,下/f,，/w,会/v,有/v,特殊/a,的/u,摆放/v,和/c,形状/n,光影/n,等/u,干扰/v,//w,幻象/n,背景/n,干扰/v,同类/n,内/f,的/u,差异/n,(/w,比如/v,椅子/n,有/v,靠椅/n,//w,吧椅/nw,//w,餐椅/n,//w,躺椅/n,…/w,)/w,1.2/m, ,识别/v,的/u,途径/n,首先/d,，/w,大家/r,想想/v,就/d,知道/v,，/w,这个/r,算法/n,并/c,不/d,像/v,『/w,对/p,一个/m,数组/n,排序/vn,』/w,或者/c,『/w,求/v,有/v,向/p,图/n,的/u,最/d,短/a,路径/n,』/w,，/w,我们/r,没/d,办法/n,提前/v,制定/v,一个/m,流程/n,和/c,规则/n,去/v,解决/v,。/w,定义/n,『/w,猫/n,』/w,这种/r,动物/n,本身/r,就/d,是/v,一件/mq,很/d,难/a,的/u,事情/n,了/u,，/w,更/d,不要/d,说/v,去/v,定义/n,一只/mq,猫/n,在/p,图像/n,上/f,的/u,固定/a,表现/v,形式/n,。/w,所以/c,我们/r,寄/v,希望/v,于/p,机器/n,学习/v,，/w,使用/v,『/w,data/en,-/w,driven/en, ,approach/en,//w,数据/n,驱动/vn,法/j,』/w,来/v,做做/v,尝试/vn,。/w,简单/a,说来/v,，/w,就/d,是/v,对于/p,每个/r,类别/n,，/w,我们/r,都/d,找/v,一定量/n,的/u,图片/n,数据/n,，/w,『/w,喂/v,』/w,给/p,计算机/n,，/w,让/v,它/r,自己/r,去/v,『/w,学习/v,和/c,总结/v,』/w,每/r,一类/mq,的/u,图片/n,的/u,特点/n,。/w,对了/l,，/w,这个/r,过程/n,和/c,小盆友/nr,学习/v,新鲜/a,事物/n,是/v,一样/u,一样/u,的/u,。/w,『/w,喂/v,』/w,给/p,计算机/n,学习/v,的/u,图片/n,数据/n,就/d,和/c,下/f,图/n,的/u,猫/n,//w,狗/n,//w,杯子/n,//w,帽子/n,一样/u,：/w,1.3/m, ,机器/n,学习/v,解决/v,图像/n,分类/vn,的/u,流程/n,//w,pipeline/en,整体/n,的/u,流程/n,和/c,普通/a,机器/n,学习/v,完全/ad,一致/a,，/w,简单/a,说来/v,，/w,也/d,就/d,下面/f,三步/mq,：/w,输入/v,：/w,我们/r,的/u,给定/vn,k/en,个/q,类别/n,的/u,n/en,张/q,图片/n,，/w,作为/v,计算机/n,学习/v,的/u,训练集/nw,学习/v,：/w,让/v,计算机/n,逐/vg,张/q,图片/n,地/u,『/w,观察/v,』/w,和/c,『/w,学习/v,』/w,评估/vn,：/w,就/d,像/v,我们/r,上学/v,学/v,了/u,东西/n,要/v,考试/vn,检测/vn,一样/u,，/w,我们/r,也/d,得考考/nrf,计算机/n,学/v,得/u,如何/r,，/w,于是/c,我们/r,给/p,定/v,一些/m,计算机/n,不/d,知道/v,类别/n,的/u,图片/n,让/v,它/r,判别/vn,，/w,然后/c,再/d,比/p,对/p,我们/r,已知/nz,的/u,正确/a,答案/n,。/w,2/m,./w, ,最近/t,邻分类器/nw,(/w,nearest/en, ,neighbor/en, ,classifier/en,)/w,先/d,从/p,简单/a,的/u,方法/n,开始/v,说/v,，/w,先/d,提/v,一提/mq,最近/t,邻分类器/nw,//w,nearest/en, ,neighbor/en, ,classifier/en,，/w,不过/c,事先/d,申明/v,，/w,它/r,和/c,深度/n,学习/v,中/f,的/u,卷积神经网/nt,//w,convolutional/en, ,neural/en, ,networks/en,其实/d,一点/m,关系/n,都/d,没有/v,，/w,我们/r,只是/d,从/p,基础/n,到/v,前沿/s,一点一点/nt,推进/v,，/w,最近/t,邻/vg,是/v,图像/n,识别/v,一个/m,相对/d,简单/a,和/c,基础/n,的/u,实现/v,方式/n,。/w,2.1/m, ,cifar/en,-/w,10/m,cifar/en,-/w,10/m,是/v,一个/m,非常/d,常用/a,的/u,图像/n,分类/vn,数据集/nw,。/w,数据集/nw,包含/v,60000张/mq,32/m,*/w,32/m,像素/n,的/u,小/a,图片/n,，/w,每张/r,图片/n,都/d,有/v,一个/m,类别/n,标注/v,(/w,总共/d,有/v,10类/mq,)/w,，/w,分成/v,了/u,50000张/mq,的/u,训练集/nw,和/c,10000张/mq,的/u,测试/vn,集/vg,。/w,如下/v,是/v,一些/m,图片/n,示例/n,：/w,上图/n,中/f,左边/f,是/v,十个/m,类别/n,和/c,对应/v,的/u,一些/m,示例/n,图片/n,，/w,右边/f,是/v,给/p,定/v,一张/mq,图片/n,后/f,，/w,根据/p,像素/n,距离/n,计算/v,出来/v,的/u,，/w,最近/t,的/u,10张/mq,图片/n,。/w,2.2/m, ,基于/p,最/d,近邻/n,的/u,简单/a,图像/n,类别/n,判定/v,假如/c,现在/t,用/p,cifar/en,-/w,10/m,数据集/nw,做/v,训练集/nw,，/w,判断/v,一张/mq,未知/vn,的/u,图片/n,属于/v,cifar/en,-/w,10/m,中/f,的/u,哪/r,一类/mq,，/w,应该/v,怎么/r,做/v,呢/y,。/w,一个/m,很/d,直观/a,的/u,想法/n,就/d,是/v,，/w,既然/c,我们/r,现在/t,有/v,每个/r,像/v,素点/nr,的/u,值/n,，/w,那/r,我们/r,就/d,根据/p,输入/v,图片/n,的/u,这些/r,值/n,，/w,计算/v,和/c,训练/vn,集中/v,的/u,图片/n,距离/n,，/w,找/v,最近/t,的/u,图片/n,的/u,类别/n,，/w,作为/v,它/r,的/u,类别/n,，/w,不/d,就/d,行/v,了/u,吗/y,。/w,恩/ng,，/w,想法/n,很/d,直接/ad,，/w,这/r,就/d,是/v,『/w,最近/t,邻/vg,』/w,的/u,思想/n,。/w,偷偷/d,说/v,一句/mq,，/w,这种/r,直接/ad,的/u,做法/n,在/p,图像/n,识别/v,中/f,，/w,其实/d,效果/n,并/c,不/d,是/v,特别/d,好/a,。/w,比如/v,上图/n,是/v,按照/p,这个/r,思想/n,找/v,的/u,最/d,近邻/n,，/w,其实/d,只/d,有/v,3个/m,图片/n,的/u,最/d,近邻/n,是/v,正确/a,的/u,类目/nz,。/w,即使/c,这样/r,，/w,作为/v,最/d,基础/n,的/u,方法/n,，/w,还是/c,得/u,掌握/v,，/w,我们/r,来/v,简单/a,实现/v,一下/m,吧/y,。/w,我们/r,需要/v,一个/m,图像/n,距离/n,评定/vn,准则/n,，/w,比如/v,最/d,简单/a,的/u,方式/n,就是/d,，/w,比/p,对/p,两个/m,图像/n,像素/n,向量/n,之间/f,的/u,l/en,1/m,距离/n,(/w,也/d,叫/v,曼哈顿/ns,距离/n,//w,cityblock/en,距离/n,)/w,，/w,公式/n,如下/v,：/w,d/en,1/m,(/w,i/en,1/m,,/w,i/en,2/m,)/w,=/w,∑/w,p/en,∣∣/nw,ip/en,1/m,−,ip/en,2/m,∣∣/nw,其实/d,就/d,是/v,计算/v,了/u,所有/b,像/v,素点/nr,之间/f,的/u,差值/n,，/w,然后/c,做/v,了/u,加法/n,，/w,直观/a,的/u,理解/v,如下/v,图/n,：/w,我们/r,先/d,把/p,数据/n,集读/nw,进/v,内存/n,：/w,#,!/w, ,//w,usr/en,//w,bin/en,//w,env/en, ,python/en, ,#,coding/en,=/w,utf/en,-/w,8/m, ,import/en, ,os/en, ,import/en, ,sys/en, ,import/en, ,numpy/en, ,as/en, ,np/en, ,def/en, ,load/en,_,cifar/en,_,batch/en,(/w,filename/en,)/w,:/w, ,"/w,"/w,"/w, ,cifar/en,-/w,10/m,数据集/nw,是/v,分/q,batch/en,存储/vn,的/u,，/w,这/r,是/v,载入/v,单个/b,batch/en, ,@/w,参数/n, ,filename/en,:/w, ,cifar/en,文件/n,名/q, ,@/w,r/en,返回/v,值/n,:/w, ,x/en,,/w, ,y/en,:/w, ,cifar/en, ,batch/en,中/f,的/u, ,data/en, ,和/c, ,labels/en, ,"/w,"/w,"/w, ,with/en, ,open/en,(/w,filename/en,,/w, ,'/w,r/en,'/w,)/w, ,as/en, ,f/en,:/w, ,datadict/en,=/w,pickle/en,./w,load/en,(/w,f/en,)/w, ,x/en,=/w,datadict/en,[/w,'/w,data/en,'/w,]/w, ,y/en,=/w,datadict/en,[/w,'/w,labels/en,'/w,]/w, ,x/en,=/w,x/en,./w,reshape/en,(/w,10000/m,,/w, ,3/m,,/w, ,32/m,,/w, ,32/m,)/w,./w,transpose/en,(/w,0/m,,/w,2/m,,/w,3/m,,/w,1/m,)/w,./w,astype/en,(/w,"/w,float/en,"/w,)/w, ,y/en,=/w,np/en,./w,array/en,(/w,y/en,)/w, ,return/en, ,x/en,,/w, ,y/en, ,def/en, ,load/en,_,cifar/en,10/m,(/w,root/en,)/w,:/w, ,"/w,"/w,"/w, ,读/v,取/v,载入/v,整个/b, ,cifar/en,-/w,10/m, ,数据集/nw, ,@/w,参数/n, ,root/en,:/w, ,根目录/n,名/q, ,@/w,return/en,:/w, ,x/en,_,train/en,,/w, ,y/en,_,train/en,:/w, ,训练集/nw, ,data/en, ,和/c, ,labels/en, ,x/en,_,test/en,,/w, ,y/en,_,test/en,:/w, ,测试/vn,集/vg, ,data/en, ,和/c, ,labels/en, ,"/w,"/w,"/w, ,xs/en,=/w,[/w,]/w, ,ys/en,=/w,[/w,]/w, ,for/en, ,b/en, ,in/en, ,range/en,(/w,1/m,,/w,6/m,)/w,:/w, ,f/en,=/w,os/en,./w,path/en,./w,join/en,(/w,root/en,,/w, ,"/w,data/en,_,batch/en,_,%/w,d/en,"/w, ,%/w, ,(/w,b/en,,/w, ,)/w,)/w, ,x/en,,/w, ,y/en,=/w,load/en,_,cifar/en,_,batch/en,(/w,f/en,)/w, ,xs/en,./w,append/en,(/w,x/en,)/w, ,ys/en,./w,append/en,(/w,y/en,)/w, ,x/en,_,train/en,=/w,np/en,./w,concatenate/en,(/w,xs/en,)/w, ,y/en,_,train/en,=/w,np/en,./w,concatenate/en,(/w,ys/en,)/w, ,del/en, ,x/en,,/w, ,y/en, ,x/en,_,test/en,,/w, ,y/en,_,test/en,=/w,load/en,_,cifar/en,_,batch/en,(/w,os/en,./w,path/en,./w,join/en,(/w,root/en,,/w, ,"/w,test/en,_,batch/en,"/w,)/w,)/w, ,return/en, ,x/en,_,train/en,,/w, ,y/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,test/en, ,#, ,载入/v,训练/vn,和/c,测试/vn,数据集/nw, ,x/en,_,train/en,,/w, ,y/en,_,train/en,,/w, ,x/en,_,test/en,,/w, ,y/en,_,test/en, ,=/w, ,load/en,_,cifar/en,10/m,(/w,'/w,data/en,//w,cifar/en,10/m,//w,'/w,)/w, ,#, ,把/p,32/m,*/w,32/m,*/w,3/m,的/u,多/a,维数/nr,组展/nw,平/v, ,xtr/en,_,rows/en, ,=/w, ,x/en,_,train/en,./w,reshape/en,(/w,x/en,_,train/en,./w,shape/en,[/w,0/m,]/w,,/w, ,32/m, ,*/w, ,32/m, ,*/w, ,3/m,)/w, ,#, ,xtr/en,_,rows/en, ,:/w, ,50000/m, ,x/en, ,3072/m, ,xte/en,_,rows/en, ,=/w, ,x/en,_,test/en,./w,reshape/en,(/w,x/en,_,test/en,./w,shape/en,[/w,0/m,]/w,,/w, ,32/m, ,*/w, ,32/m, ,*/w, ,3/m,)/w, ,#, ,xte/en,_,rows/en, ,:/w, ,10000/m, ,x/en, ,30721234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575812345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758/m,下面/f,我们/r,实现/v,最/d,近邻/n,的/u,思路/n,：/w,class/en, ,nearestneighbor/en,:/w, ,def/en, ,_,_,init/en,_,_,(/w,self/en,)/w,:/w, ,pass/en, ,def/en, ,train/en,(/w,self/en,,/w, ,x/en,,/w, ,y/en,)/w,:/w, ,"/w,"/w,"/w, ,这个/r,地方/n,的/u,训练/vn,其实/d,就/d,是/v,把/p,所有/b,的/u,已有/v,图片/n,读取/v,进来/v, ,-/w,_,-/w,|/w,|/w, ,"/w,"/w,"/w, ,#, ,the/en, ,nearest/en, ,neighbor/en, ,classifier/en, ,simply/en, ,remembers/en, ,all/en, ,the/en, ,training/en, ,data/en, ,self/en,./w,xtr/en, ,=/w, ,x/en, ,self/en,./w,ytr/en, ,=/w, ,y/en, ,def/en, ,predict/en,(/w,self/en,,/w, ,x/en,)/w,:/w, ,"/w,"/w,"/w, ,所谓/v,的/u,预测/v,过程/n,其实/d,就/d,是/v,扫描/v,所有/b,训练/vn,集中/v,的/u,图片/n,，/w,计算/v,距离/n,，/w,取/v,最/d,小/a,的/u,距离/n,对应/v,图片/n,的/u,类目/nz, ,"/w,"/w,"/w, ,num/en,_,test/en, ,=/w, ,x/en,./w,shape/en,[/w,0/m,]/w, ,#, ,要/v,保证/v,维度/n,一致/a,哦/e, ,ypred/en, ,=/w, ,np/en,./w,zeros/en,(/w,num/en,_,test/en,,/w, ,dtype/en, ,=/w, ,self/en,./w,ytr/en,./w,dtype/en,)/w, ,#, ,把/p,训练集/nw,扫/v,一遍/mq, ,-/w,_,-/w,|/w,|/w, ,for/en, ,i/en, ,in/en, ,xrange/en,(/w,num/en,_,test/en,)/w,:/w, ,#, ,计算/v,l/en,1/m,距离/n,，/w,并/c,找到/v,最近/t,的/u,图片/n, ,distances/en, ,=/w, ,np/en,./w,sum/en,(/w,np/en,./w,abs/en,(/w,self/en,./w,xtr/en, ,-/w, ,x/en,[/w,i/en,,/w,:/w,]/w,)/w,,/w, ,axis/en, ,=/w, ,1/m,)/w, ,min/en,_,index/en, ,=/w, ,np/en,./w,argmin/en,(/w,distances/en,)/w, ,#, ,取/v,最近/t,图片/n,的/u,下标/n, ,ypred/en,[/w,i/en,]/w, ,=/w, ,self/en,./w,ytr/en,[/w,min/en,_,index/en,]/w, ,#, ,记录/v,下/f,label/en, ,return/en, ,ypred/en, ,nn/en, ,=/w, ,nearestneighbor/en,(/w,)/w, ,#, ,初始化/v,一个/m,最近/t,邻/vg,对象/n, ,nn/en,./w,train/en,(/w,xtr/en,_,rows/en,,/w, ,y/en,_,train/en,)/w, ,#, ,训练/vn,./w,./w,./w,其实/d,就/d,是/v,读/v,取/v,训练集/nw, ,yte/en,_,predict/en, ,=/w, ,nn/en,./w,predict/en,(/w,xte/en,_,rows/en,)/w, ,#, ,预测/v, ,#, ,比/p,对/p,标准/n,答案/n,，/w,计算/v,准确率/n, ,print/en, ,'/w,accuracy/en,:/w, ,%/w,f/en,'/w, ,%/w, ,(/w, ,np/en,./w,mean/en,(/w,yte/en,_,predict/en, ,=/w,=/w, ,y/en,_,test/en,)/w, ,)/w,1234567891011121314151617181920212223242526272829303132333412345678910111213141516171819202122232425262728293031323334/m,最/d,近邻/n,的/u,思想/n,在/p,cifar/en,上/f,得到/v,的/u,准确度/n,为/p,38.6%/mq,，/w,我们/r,知道/v,10/m,各类/r,别/d,，/w,我们/r,随机/d,猜测/vn,的/u,话/n,准确率/n,差不多/l,是/v,1/m,//w,10/m,=/w,10%/mq,，/w,所以/c,说/v,还是/c,有/v,识别/v,效果/n,的/u,，/w,但是/c,显然/ad,这/r,距离/n,人/n,的/u,识别/v,准确率/n,(/w,94%/mq,)/w,实在/d,是/v,低/a,太/d,多/a,了/u,，/w,不/d,那么/r,实用/vn,。/w,2.3/m, ,关于/p,最/d,近邻/n,的/u,距离/n,准则/n,我们/r,这里/r,用/p,的/u,距离/n,准则/n,是/v,l/en,1/m,距离/n,，/w,实际上/d,除掉/v,l/en,1/m,距离/n,，/w,我们/r,还有/v,很多/m,其他/r,的/u,距离/n,准则/n,。/w,比如说/l,l/en,2/m,距离/n,(/w,也/d,就/d,是/v,大家/r,熟知/v,的/u,欧氏/nr,距离/n,)/w,的/u,计算/v,准则/n,如下/v,：/w,d/en,2/m,(/w,i/en,1/m,,/w,i/en,2/m,)/w,=/w,∑/w,p/en,(/w,ip/en,1/m,−,ip/en,2/m,)/w,2/m,−,−−/nw,−−/nw,−−/nw,−−/nw,−−/nw,−√/nw,比如/v,余弦/n,距离/n,计算/v,准则/n,如下/v,：/w,1/m,−,i/en,1/m,⋅,i/en,2/m,|/w,|/w,i/en,1/m,|/w,|/w,⋅,|/w,|/w,i/en,2/m,|/w,|/w,更/d,多/a,的/u,距离/n,准则/n,可以/v,参见/v,scipy/en,相关/v,计算/v,页面/n,./w,3/m,./w, ,k/en,最近/t,邻分类器/nw,(/w,k/en, ,nearest/en, ,neighbor/en, ,classifier/en,)/w,这/r,是/v,对/p,最/d,近邻/n,的/u,思想/n,的/u,一个/m,调整/vn,。/w,其实/d,我们/r,在/p,使用/v,最近/t,邻分类器/nw,分类/vn,，/w,扫描/v,cifar/en,训练集/nw,的/u,时候/n,，/w,会/v,发现/v,，/w,有时候/d,不/d,一定/d,距离/n,最近/t,的/u,和/c,当前/t,图片/n,是/v,同类/n,，/w,但是/c,最近/t,的/u,一些/m,里/f,有/v,很多/m,和/c,当前/t,图片/n,是/v,同类/n,。/w,所以/c,我们/r,自然而然/i,想到/v,，/w,把/p,最近/t,邻/vg,扩展/v,为/p,最近/t,的/u,n/en,个/q,临近/v,点/q,，/w,然后/c,统计/v,一下/m,这些/r,点/q,的/u,类目/nz,分布/v,，/w,取/v,最/d,多/a,的/u,那个/r,类目/nz,作为/v,自己/r,的/u,类别/n,。/w,恩/ng,，/w,这/r,就/d,是/v,knn/en,的/u,思想/n,。/w,knn/en,其实/d,是/v,一种/mq,特别/d,常用/a,的/u,分类/vn,算法/n,。/w,但是/c,有/v,个/q,问题/n,，/w,我们/r,的/u,k/en,值/n,应该/v,取/v,多少/r,呢/y,。/w,换句话说/c,，/w,我们/r,找/v,多少/r,邻居/n,来/v,投票/v,，/w,比较/d,靠/v,谱/ng,呢/y,？/w,3.1/m, ,交叉/vn,验证/vn,与/p,参数/n,选择/v,在/p,现在/t,的/u,场景/n,下/f,，/w,假如/c,我们/r,确定/v,使用/v,knn/en,来/v,完成/v,图片/n,类别/n,识别/v,问题/n,。/w,我们/r,发现/v,有/v,一些/m,参数/n,是/v,肯定/v,会/v,影响/vn,最后/f,的/u,识别/v,结果/n,的/u,，/w,比如/v,：/w,距离/n,的/u,选择/v,(/w,l/en,1/m,,/w,l/en,2/m,,/w,cos/en,等等/u,)/w,近邻/n,个数/n,k/en,的/u,取值/v,。/w,每/r,组/q,参数/n,下/f,其实/d,都/d,能/v,产生/v,一个/m,新/a,的/u,model/en,，/w,所以/c,这/r,可以/v,视为/v,一个/m,模型/n,选择/v,//w,model/en, ,selection/en,问题/n,。/w,而/c,对于/p,模型/n,选择/v,问题/n,，/w,最/d,常用/a,的/u,办法/n,就/d,是/v,在/p,交叉/vn,验证/vn,集/vg,上/f,实验/vn,。/w,数据/n,总量/n,就/d,那么/r,多/a,，/w,如果/c,我们/r,在/p,test/en, ,data/en,上/f,做/v,模型/n,参数/n,选择/v,，/w,又/d,用/p,它/r,做/v,效果/n,评估/vn,，/w,显然/ad,不/d,是/v,那么/r,合理/a,（/w,因为/c,我们/r,的/u,模型/n,参数/n,很/d,有/v,可能/v,是/v,在/p,test/en, ,data/en,上/f,过/u,拟合/nz,的/u,，/w,不能/v,很/d,公正/a,地/u,评估/vn,结果/n,）/w,。/w,所以/c,我们/r,通常/d,会/v,把/p,训练/vn,数据/n,分为/v,两个/m,部分/n,，/w,一/m,大部分/m,作为/v,训练/vn,用/p,，/w,另外/c,一部分/m,就/d,是/v,所谓/v,的/u,cross/en, ,validation/en,数据集/nw,，/w,用/p,来/v,进行/v,模型/n,参数/n,选择/v,的/u,。/w,比如说/l,我们/r,有/v,50000/m,训练/vn,图片/n,，/w,我们/r,可以/v,把/p,它/r,分为/v,49000/m,的/u,训练集/nw,和/c,1000/m,的/u,交叉/vn,验证/vn,集/vg,。/w,#, ,假定/v,已经/d,有/v,xtr/en,_,rows/en,,/w, ,ytr/en,,/w, ,xte/en,_,rows/en,,/w, ,yte/en,了/u,，/w,其中/r,xtr/en,_,rows/en,为/p,50000/m,*/w,3072/m, ,矩阵/n, ,xval/en,_,rows/en, ,=/w, ,xtr/en,_,rows/en,[/w,:/w,1000/m,,/w, ,:/w,]/w, ,#, ,构建/v,1000/m,的/u,交叉/vn,验证/vn,集/vg, ,yval/en, ,=/w, ,ytr/en,[/w,:/w,1000/m,]/w, ,xtr/en,_,rows/en, ,=/w, ,xtr/en,_,rows/en,[/w,1000/m,:/w,,/w, ,:/w,]/w, ,#, ,保留/v,49000/m,的/u,训练集/nw, ,ytr/en, ,=/w, ,ytr/en,[/w,1000/m,:/w,]/w, ,#, ,设置/v,一些/m,k/en,值/n,，/w,用于/v,试验/vn, ,validation/en,_,accuracies/en, ,=/w, ,[/w,]/w, ,for/en, ,k/en, ,in/en, ,[/w,1/m,,/w, ,3/m,,/w, ,5/m,,/w, ,7/m,,/w, ,10/m,,/w, ,20/m,,/w, ,50/m,,/w, ,100/m,]/w,:/w, ,#, ,初始化/v,对象/n, ,nn/en, ,=/w, ,nearestneighbor/en,(/w,)/w, ,nn/en,./w,train/en,(/w,xtr/en,_,rows/en,,/w, ,ytr/en,)/w, ,#, ,修改/v,一下/m,predict/en,函数/n,，/w,接受/v, ,k/en, ,作为/v,参数/n, ,yval/en,_,predict/en, ,=/w, ,nn/en,./w,predict/en,(/w,xval/en,_,rows/en,,/w, ,k/en, ,=/w, ,k/en,)/w, ,acc/en, ,=/w, ,np/en,./w,mean/en,(/w,yval/en,_,predict/en, ,=/w,=/w, ,yval/en,)/w, ,print/en, ,'/w,accuracy/en,:/w, ,%/w,f/en,'/w, ,%/w, ,(/w,acc/en,,/w,)/w, ,#, ,输出/v,结果/n, ,validation/en,_,accuracies/en,./w,append/en,(/w,(/w,k/en,,/w, ,acc/en,)/w,)/w,12345678910111213141516171819201234567891011121314151617181920/m,这里/r,提/v,一个/m,在/p,很多/m,地方/n,会/v,看到/v,的/u,概念/n,，/w,叫做/v,k/en,-/w,fold/en, ,cross/en,-/w,validation/en,，/w,意思/n,其实/d,就/d,是/v,把/p,原始/a,数据/n,分成/v,k/en,份/q,，/w,轮流/v,使用/v,其中/r,k/en,-/w,1份/mq,作为/v,训练/vn,数据/n,，/w,而/c,剩余/vn,的/u,1份/mq,作为/v,交叉/vn,验证/vn,数据/n,(/w,因此/c,其实/d,对于/p,k/en,-/w,fold/en, ,cross/en,-/w,validation/en,我们/r,会/v,得到/v,k/en,个/q,accuracy/en,)/w,。/w,以下/f,是/v,5/m,-/w,fold/en, ,cross/en,-/w,validation/en,的/u,一个/m,示例/n,：/w,以下/f,是/v,我们/r,使用/v,5/m,-/w,fold/en, ,cross/en,-/w,validation/en,，/w,取/v,不同/a,的/u,k/en,值/n,时/ng,，/w,得到/v,的/u,accuracy/en,曲线/n,(/w,补充/v,一下/m,，/w,因为/c,是/v,5/m,-/w,fold/en, ,cross/en,-/w,validation/en,，/w,所以/c,在/p,每个/r,k/en,值/n,上有/v,5个/m,取值/v,，/w,我们/r,取/v,其/r,均值/n,作为/v,此时/r,的/u,准确度/n,)/w,可以/v,看出/v,大概/d,在/p,k/en,=/w,7/m,左右/m,有/v,最佳/z,的/u,准确度/n,。/w,3.2/m, ,最近/t,邻/vg,方法/n,的/u,优缺点/n,k/en,最/d,近邻/n,的/u,优点/n,大家/r,都/d,看/v,出来/v,了/u,，/w,思路/n,非常/d,简单/a,清晰/a,，/w,而且/c,完全/ad,不/d,需要/v,训练/vn,…/w,不过/c,也/d,正/d,因为/c,如此/r,，/w,最后/f,的/u,predict/en,过程/n,非常/d,耗时/v,，/w,因为/c,要/v,和/c,全部/m,训练/vn,集中/v,的/u,图片/n,比/p,对/p,一遍/mq,。/w,实际/n,应用/vn,中/f,，/w,我们/r,其实/d,更加/d,关心/v,实施/v,predict/en,所/u,消耗/v,的/u,时间/n,，/w,如果/c,有/v,一个/m,图像/n,识别/v,app/en,返回/v,结果/n,要/v,半/m,小时/n,一小时/t,，/w,你/r,一定/d,第一/m,时间/n,把/p,它/r,卸/v,了/u,。/w,我们/r,反倒/d,不/d,那么/r,在/p,乎/y,训练/vn,时/ng,长/a,，/w,训练/vn,时间/n,稍微/d,长/a,一点/m,没关系/l,，/w,只要/c,最后/f,应用/vn,的/u,时候/n,识别/v,速度/n,快/a,效果/n,好/a,，/w,就/d,很/d,赞/vg,。/w,后面/f,会/v,提到/v,的/u,深度/n,神经/n,网络/n,就/d,是/v,这样/r,，/w,深度/n,神经/n,网络/n,解决/v,图像/n,问题/n,时/ng,训练/vn,是/v,一个/m,相对/d,耗/v,时间/n,的/u,过程/n,，/w,但是/c,识别/v,的/u,过程/n,非常/d,快/a,。/w,另外/c,，/w,不得不/d,多/a,说/v,一句/mq,的/u,是/v,，/w,优化/v,计算/v,k/en,最近/t,邻/vg,时间/n,问题/n,，/w,实际上/d,依旧/z,到/v,现在/t,都/d,是/v,一个/m,非常/d,热门/a,的/u,问题/n,。/w,approximate/en, ,nearest/en, ,neighbor/en, ,(/w,ann/en,)/w,算法/n,是/v,牺牲/v,掉/v,一/m,小/a,部分/n,的/u,准确度/n,，/w,而/c,提高/v,很/d,大/a,程度/n,