原文/n,：/w,http/en,:/w,//w,//w,blog/en,./w,csdn/en,./w,net/en,//w,chenyusiyuan/en,//w,article/en,//w,details/en,//w,5961769/m,双目/n,测距/v,的/u,基本/a,原理/n,如/v,上图/n,所示/nz,，/w,双目/n,测距/v,主要/b,是/v,利用/v,了/u,目标/n,点/q,在/p,左右/m,两幅/mq,视图/n,上/f,成像/vn,的/u,横向/n,坐标/n,直接/ad,存在/v,的/u,差异/n,（/w,即/v,视差/n,）/w,与/p,目标/n,点/q,到/v,成像/vn,平面/n,的/u,距离/n,z/en,存在/v,着/u,反/v,比例/n,的/u,关系/n,：/w,z/en,=/w,ft/en,//w,d/en,。/w,假设/v,目标/n,点/q,在/p,左视图/nw,中/f,的/u,坐标/n,为/p,（/w,x/en,,/w,y/en,）/w,，/w,在/p,左右/m,视图/n,上/f,形成/v,的/u,视差/n,为/p,d/en,，/w,目标/n,点/q,在/p,以/p,左/f,摄像头/n,光心/nr,为/p,原点/n,的/u,世界/n,坐标/n,系/v,中/f,的/u,坐标/n,为/p,（/w,x/en,,/w,y/en,,/w,z/en,）/w,，/w,则/d,存在/v,上图/n,所示/nz,的/u,变换/v,矩阵/n,q/en,，/w,使得/v, ,q/en,*/w,[/w,x/en, ,y/en, ,d/en, ,1/m,]/w,’/w, ,=/w, ,[/w,x/en, ,y/en, ,z/en, ,w/en,]/w,’/w,。/w,“/w,@/w,scyscyao/en, ,：/w,为了/p,精确/a,地/u,求得/v,某个/r,点/q,在/p,三维/nz,空间/n,里/f,的/u,距离/n,z/en,，/w,我们/r,需要/v,获得/v,的/u,参数/n,有/v,焦距/n,f/en,、/w,视差/n,d/en,、/w,摄像头中心/nt,距/p,tx/en,。/w,如果/c,还/d,需要/v,获得/v,x/en,坐标/n,和/c,y/en,坐标/n,的话/u,，/w,那么/r,还/d,需要/v,额外/b,知道/v,左右/m,像/v,平面/n,的/u,坐标系/n,与/p,立体/b,坐标系/n,中原点/nw,的/u,偏移/vn,cx/en,和/c,cy/en,。/w,其中/r,f/en,,/w, ,tx/en,,/w, ,cx/en,和/c,cy/en,可以/v,通过/p,立体/b,标定/v,获得/v,初始值/n,，/w,并/c,通过/p,立体/b,校准/v,优化/v,，/w,使得/v,两个/m,摄像头/n,在/p,数学/n,上/f,完全/ad,平行/vn,放置/v,，/w,并且/c,左右/m,摄像头/n,的/u,cx/en,,/w, ,cy/en,和/c,f/en,相同/a,(/w,也/d,就/d,是/v,实现/v,中/f,左右/m,视图/n,完全/ad,平行/vn,对准/v,的/u,理想/n,形式/n,)/w,。/w,而/c,立体/b,匹配/vn,所/u,做/v,的/u,工作/vn,，/w,就是/d,在/p,之前/f,的/u,基础/n,上/f,，/w,求取/nw,最后/f,一个/m,变量/n,：/w,视差/n,d/en,(/w,这个/r,d/en,一般/a,需要/v,达到/v,亚像素/nw,精度/n,)/w,。/w,从而/c,最终/d,完成/v,求/v,一个/m,点/q,三维/nz,坐标/n,所/u,需要/v,的/u,准备/v,工作/vn,。/w,在/p,清楚/a,了/u,上述/b,原理/n,之后/f,，/w,我们/r,也/d,就/d,知道/v,了/u,，/w,所有/b,的/u,这/r,几/m,步/q,：/w,标定/v,、/w,校准/v,和/c,匹配/vn,，/w,都/d,是/v,围绕/v,着/u,如何/r,更/d,精确/a,地/u,获得/v,f/en,,/w, ,d/en,,/w, ,tx/en,,/w, ,cx/en, ,和/c,cy/en, ,而/c,设计/vn,的/u, ,。/w, ,”/w,一/m,、/w,图像/n,的/u,获取/v,1/m,．/w, ,如何/r,打开/v,两个/m,或/c,多/a,个/q,摄像头/n,？/w,可以/v,通过/p,opencv/en,的/u,capture/en,类/q,函数/n,或者/c,结合/v,directshow/en,来/v,实现/v,双/m,摄像头/n,的/u,捕获/v,，/w,具体/a,可见/v,我/r,的/u,读书/v,笔记/n,《/w,opencv/en,学习/v,笔记/n,（/w,6/m,）/w,基于/p, ,vc/en,+/w,opencv/en,+/w,directshow/en, ,的/u,多/a,个/q,摄像头/n,同步/vd,工作/vn, ,》/w,。/w,文中/nrf,曾/d,提及/v,不/d,能/v,用/p,cvcreatecameracapture/en, ,同时/c,读/v,取/v,两个/m,摄像头/n,，/w,不过/c,后来/t,一位/mq,研友/nw,来信/n,讨论/v,说/v,只要/c,把/p,摄像头/n,指针/n,的/u,创建/v,代码/n,按照/p,摄像头/n,序号/n,降序/nw,执行/v,，/w,就/d,可以/v,顺利/ad,打开/v,多/a,个/q,摄像头/n,，/w,例如/v,：/w,[/w,c/en,-/w,sharp/en,]/w, ,view/en, ,plain/en, ,copy/en, ,print/en,?/w,cvcapture/en,*/w, ,capture/en,2/m, ,=/w, ,cvcreatecameracapture/en,(/w, ,1/m, ,)/w,;/w,cvcapture/en,*/w, ,capture/en,1/m, ,=/w, ,cvcreatecameracapture/en,(/w, ,0/m, ,)/w,;/w,采用/v,directshow/en,的/u,方式/n,读/v,入时/a,：/w,[/w,c/en,-/w,sharp/en,]/w, ,view/en, ,plain/en, ,copy/en, ,print/en,?/w,camera/en,2/m,./w,opencamera/en,(/w,1/m,,/w, ,false/en,,/w, ,640/m,,/w,480/m,)/w,;/w,camera/en,1/m,./w,opencamera/en,(/w,0/m,,/w, ,false/en,,/w, ,640/m,,/w,480/m,)/w,;/w,这样/r,就/d,可以/v,同时/c,采集/v,两个/m,摄像头/n,。/w,我/r,也/d,验证/vn,过/u,这种/r,方法/n,确实/ad,有效/a,，/w,而且/c,还/d,解决/v,了/u,我/r,遇到/v,的/u,cvsetcaptureproperty/en,调整/vn,帧/q,画面/n,大小/n,速度/n,过/u,慢/a,的/u,问题/n,。/w,当/p,摄像头/n,的/u,打开/v,或/c,创建/v,代码/n,按照/p,摄像头/n,序号/n,从/p,0/m,开始/v,以/p,升序/n,编写/v,执行/v,时/ng,，/w,使用/v,cvsetcaptureproperty/en,就/d,会/v,出现/v,第一/m,个/q,摄像头/n,（/w,序号/n,为/p,0/m,）/w,的/u,显示/v,窗口/s,为/p,灰色/n,（/w,即/v,无/v,图像/n,）/w,、/w,且/c,程序/n,运行/vn,速度/n,缓慢/a,的/u,现象/n,。/w,而/c,改为/v,降序/nw,编写/v,执行/v,后/f,，/w,则/d,能/v,正常/a,、/w,实时/n,地/u,显示/v,各/r,摄像头/n,的/u,画面/n,。/w,具体/a,原因/n,有待/v,分析/vn,讨论/v,。/w,2/m,．/w, ,如何/r,实现/v,多/a,个/q,摄像头/n,帧/q,画面/n,的/u,同步/vd,抓取/v,？/w,在/p,单/d,摄像头/n,情况/n,下/f,用/p, ,cvqueryframe/en, ,即/v,可/v,抓/v,取/v,一帧/mq,画面/n,，/w,实际上/d,这个/r,函数/n,是/v,由/p,两个/m,routine/en,组成/v,的/u,：/w,cvgrabframe/en,和/c,cvretrieveframe/en,（/w,详见/nz,learning/en, ,opencv/en,第/m,103页/mq,）/w,。/w,cvgrabframe/en,将/d,摄像头/n,帧/q,画面/n,即时/d,复制/v,到/v,内部/f,缓存/n,中/f,，/w,然后/c,通过/p,cvretrieveframe/en,把/p,我们/r,预定义/nw,的/u,一个/m,iplimage/en,型/k,空/a,指针/n,指向/vn,缓存/n,内/f,的/u,帧/q,数据/n,。/w,注意/v,这时/r,我们/r,并/c,没有/v,真正/d,把/p,帧/q,数据/n,取出/v,来/v,，/w,它/r,还/d,保存/v,在/p,opencv/en,的/u,内部/f,缓存/n,中/f,，/w,下/f,一次/mq,读/v,取/v,操作/v,就/d,会/v,被/p,覆盖/v,掉/v,。/w,所以/c,一般/a,我们/r,要/v,另外/c,定义/n,一个/m,iplimage/en,来/v,复制/v,所/u,抓取/v,的/u,帧/q,数据/n,，/w,然后/c,对/p,这个/r,新/a,iplimage/en,进行/v,操作/v,。/w,由/p,上面/f,的/u,解释/v,也/d,可以/v,看出/v,，/w,cvgrabframe/en,的/u,作用/n,就/d,是/v,尽可能/d,快/a,的/u,将/d,摄像头/n,画面/n,数据/n,复制/v,到/v,计算机/n,缓存/n,，/w,这个/r,功能/n,就/d,方便/a,我们/r,实现/v,对/p,多/a,个/q,摄像头/n,的/u,同步/vd,抓取/v,，/w,即/v,首先/d,用/p,cvgrabframe/en,依次/d,抓取/v,各个/r,cvcapture/en,*/w,，/w,然后/c,再/d,用/p,cvretrieveframe/en,把/p,帧/q,数据/n,取出/v,来/v,。/w,例如/v,：/w,[/w,c/en,-/w,sharp/en,]/w, ,view/en, ,plain/en, ,copy/en, ,print/en,?/w,cvgrabframe/en,(/w, ,lfcam/en, ,)/w,;/w,cvgrabframe/en,(/w, ,ricam/en, ,)/w,;/w,frame/en,1/m, ,=/w, ,cvretrieveframe/en,(/w, ,lfcam/en, ,)/w,;/w,frame/en,2/m, ,=/w, ,cvretrieveframe/en,(/w, ,ricam/en, ,)/w,;/w,if/en,(/w, ,!/w,frame/en,1/m,|/w,|/w, ,!/w,frame/en,2/m,)/w, ,break/en,;/w,cvcopyimage/en,(/w,frame/en,1/m,,/w, ,image/en,1/m,)/w,;/w,cvcopyimage/en,(/w,frame/en,2/m,,/w, ,image/en,2/m,)/w,;/w,二/m,、/w,摄像头/n,定标/nz,摄像头/n,定标/nz,一般/a,都/d,需要/v,一个/m,放在/v,摄像头/n,前/f,的/u,特制/b,的/u,标定/v,参照物/n,（/w,棋盘纸/nw,）/w,，/w,摄像头/n,获取/v,该/r,物体/n,的/u,图像/n,，/w,并/c,由此/d,计算/v,摄像头/n,的/u,内外/f,参数/n,。/w,标定/v,参照物/n,上/f,的/u,每/r,一个/m,特征/n,点/q,相对于/nw,世界/n,坐标系/n,的/u,位置/n,在/p,制作/v,时/ng,应/v,精确/a,测定/vn,，/w,世界/n,坐标/n,系/v,可/v,选/v,为/p,参照物/n,的/u,物体/n,坐标系/n,。/w,在/p,得到/v,这些/r,已知/nz,点/q,在/p,图像/n,上/f,的/u,投影/vn,位置/n,后/f,，/w,可/v,计算/v,出/v,摄像头/n,的/u,内外/f,参数/n,。/w,如/v,上图/n,所示/nz,，/w,摄像头/n,由于/c,光学/n,透镜/n,的/u,特性/n,使得/v,成像/vn,存在/v,着/u,径/ng,向/p,畸变/n,，/w,可/v,由/p,三个/m,参数/n,k/en,1/m,,/w,k/en,2/m,,/w,k/en,3/m,确定/v,；/w,由于/c,装配/vn,方面/n,的/u,误差/n,，/w,传感器/n,与/p,光学/n,镜头/n,之间/f,并非/v,完全/ad,平行/vn,，/w,因此/c,成像/vn,存在/v,切向/nw,畸变/n,，/w,可/v,由/p,两个/m,参数/n,p/en,1/m,,/w,p/en,2/m,确定/v,。/w,单个/b,摄像头/n,的/u,定标/nz,主要/b,是/v,计算/v,出/v,摄像头/n,的/u,内参/n,（/w,焦距/n,f/en,和/c,成像/vn,原点/n,cx/en,,/w,cy/en,、/w,五个/m,畸/ng,变/v,参数/n,（/w,一般/a,只/d,需要/v,计算/v,出/v,k/en,1/m,,/w,k/en,2/m,,/w,p/en,1/m,,/w,p/en,2/m,，/w,对于/p,鱼眼/nw,镜头/n,等/u,径/ng,向/p,畸变/n,特别/d,大/a,的/u,才/d,需要/v,计算/v,k/en,3/m,）/w,）/w,以及/c,外参/nw,（/w,标定物/nw,的/u,世界/n,坐标/n,）/w,。/w, ,opencv/en, ,中/f,使用/v,的/u,求解/v,焦距/n,和/c,成像/vn,原点/n,的/u,算法/n,是/v,基于/p,张正友/nr,的/u,方法/n,（/w,pdf/en, ,）/w,，/w,而/c,求/v,解畸/nr,变/v,参数/n,是/v,基于/p, ,brown/en, ,的/u,方法/n,（/w,pdf/en, ,）/w,。/w,1/m,．/w, ,图像/n,坐标系/n,、/w,摄像头/n,坐标系/n,和/c,世界/n,坐标系/n,的/u,关系/n,摄像头/n,成像/vn,几何/n,关系/n,，/w,其中/r,oc/en, ,点/q,称为/v,摄像头/n,（/w,透镜/n,）/w,的/u,光心/nr,，/w,xc/en, ,轴/q,和/c,yc/en, ,轴/q,与/p,图像/n,的/u,x/en,轴/q,和/c,y/en,轴/q,平行/vn,，/w,zc/en, ,轴为/nw,摄像头/n,的/u,光轴/nw,，/w,它/r,与/p,图像/n,平面/n,垂直/v,。/w,光轴/nw,与/p,图像/n,平面/n,的/u,交点/n,o/en,1/m, ,，/w,即/v,为/p,图像/n,坐标系/n,的/u,原点/n,。/w,由/p,点/q,oc/en, ,与/p,xc/en, ,、/w,yc/en, ,、/w,zc/en, ,轴/q,组成/v,的/u,坐标系/n,称为/v,摄像头/n,坐标系/n,，/w,oc/en, ,o/en,1/m,的/u,距离/n,为/p,摄像头/n,焦距/n,，/w,用/p,f/en,表示/v,。/w,图像/n,坐标系/n,是/v,一个/m,二维/nr,平面/n,，/w,又/d,称为/v,像/v,平面/n,，/w,“/w,@/w,scyscyao/en, ,：/w,实际上/d,就是/d,摄像头/n,的/u,ccd/en,传感器/n,的/u,表面/n,。/w,每个/r,ccd/en,传感器/n,都/d,有/v,一定/d,的/u,尺寸/n,，/w,也/d,有/v,一定/d,的/u,分辨率/n,，/w,这个/r,就/d,确定/v,了/u,毫米/q,与/p,像/v,素点/nr,之间/f,的/u,转换/v,关系/n,。/w,举/v,个/q,例子/n,，/w,ccd/en,的/u,尺寸/n,是/v,8/m,mm/en, ,x/en, ,6/m,mm/en,，/w,帧/q,画面/n,的/u,分辨率/n,设置/v,为/p,640/m,x/en,480/m,，/w,那么/r,毫米/q,与/p,像/v,素点/nr,之间/f,的/u,转换/v,关系/n,就/d,是/v,80/m,pixel/en,//w,mm/en,。/w,”/w,设/v,ccd/en,传感器/n,每个/r,像/v,素点/nr,的/u,物理/n,大小/n,为/p,dx/en,*/w,dy/en,，/w,相应/v,地/u,，/w,就/d,有/v, ,dx/en,=/w,dy/en,=/w,1/m,//w,80/m,。/w,2/m,．/w, ,进行/v,摄像头/n,定标/nz,时/ng,，/w,棋盘/n,方格/n,的/u,实际/n,大小/n, ,square/en,_,size/en, ,（/w,默认/v,为/p, ,1.0/m,f/en, ,）/w,的/u,设置/v,对/p,定标/nz,参数/n,是否/v,有/v,影响/vn,？/w,“/w,@/w,scyscyao/en, ,：/w,当然/d,有/v,。/w,在/p,标定/v,时/ng,，/w,需要/v,指定/v,一个/m,棋盘/n,方格/n,的/u,长度/n,，/w,这个/r,长度/n,(/w,一般/a,以/p,毫米/q,为/p,单位/n,，/w,如果/c,需要/v,更/d,精确/a,可以/v,设/v,为/p,0.1/m,毫米量级/nw,)/w,与/p,实际/n,长度/n,相同/a,，/w,标/v, ,定/v,得出/v,的/u,结果/n,才/d,能/v,用于/v,实际/n,距离/n,测量/vn,。/w,一般/a,如果/c,尺寸/n,设定/v,准确/a,的话/u,，/w,通过/p,立体/b,标定/v,得出/v,的/u,translation/en,向量/n,的/u,第一/m,个/q,分量/n,tx/en,的/u,绝对值/n,就/d,是/v,左右/m,摄像头/n,的/u,中心/n,距/p,。/w,一般/a,可以/v,用/p,这个/r,来/v,验证/vn,立体/b,标定/v,的/u,准确度/n,。/w,比如/v,我/r,设定/v,的/u,棋盘/n,格/j,大小/n,为/p,270/m, ,(/w,27/m,mm/en,)/w,，/w,最终/d,得出/v,的/u,tx/en,大小/n,就/d,是/v,602.8/m, ,(/w,60.28/m,mm/en,)/w,，/w,相当/d,精确/a,。/w,”/w,3/m,．/w, ,定标/nz,所得/n,的/u,摄像头/n,内/f,参数/n,，/w,即/v,焦距/n,和/c,原/b,点/q,坐标/n,，/w,其/r,数值/n,单位/n,都/d,是/v