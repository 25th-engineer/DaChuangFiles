尽管/c,在/p,上/f,篇/q,文章/n,中/f,有/v,了/u,原文/n,的/u,链接/n,，/w,但是/c,吸取/v,以往/t,的/u,经验/n,教训/n,，/w,还是/c,全部/m,拿来主义/n,比较/d,好/a,，/w,担心/v,哪/r,天/q,原文/n,链接/n,就/d,不能/v,查看/v,了/u,，/w,那/r,岂不/nw,是/v,让/v,人/n,心痛/v,的/u,碎/a,了/u,一/m,地/u,梨花/n,一/m,、/w,仿射/nw,变换/v,仿射/nw,变换/v,的/u,性质/n,:/w,平面/n,上/f,任意/d,两条/mq,直线/n,，/w,经/p,仿射/nw,变换/v,后/f,，/w,仍然/d,保持/v,平行/vn,。/w,仿射/nw,变换/v,的/u,功能/n,，/w,是/v,一种/mq,二维/nr,坐标/n,到/v,二维/nr,坐标/n,之间/f,的/u,线性/n,变换/v,，/w,保持/v,二维/nr,图形/n,的/u,“/w,平直性/nw,”/w,（/w,straightness/en,，/w,即/v,变换/v,后/f,直线/n,还是/c,直线/n,不/d,会/v,打弯/nw,，/w,圆弧/n,还是/c,圆弧/n,）/w,和/c,“/w,平行性/nw,”/w,（/w,parallelness/en,，/w,其实/d,是/v,指/v,保/v,二维/nr,图形/n,间/f,的/u,相对/d,位置/n,关系/n,不变/nz,，/w,平行线/n,还是/c,平行线/n,，/w,相交/v,直线/n,的/u,交角/n,不/d,变/v,）/w,。/w,仿射/nw,变换/v,可以/v,通过/p,一系列/mq,的/u,原子/n,变换/v,的/u,复合/v,来/v,实现/v,，/w,包括/v,：/w,平移/vn,（/w,translation/en,）/w,、/w,缩放/v,（/w,scale/en,）/w,、/w,翻转/v,（/w,flip/en,）/w,、/w,旋转/v,（/w,rotation/en,）/w,和/c,剪切/vn,（/w,shear/en,）/w,。/w,此类/r,变换/v,可以/v,用/p,一个/m,3/m,×/w,3/m,的/u,矩阵/n,来/v,表示/v,，/w,其/r,最后/f,一行/n,为/p,(/w,0/m,,/w, ,0/m,,/w, ,1/m,)/w,。/w,该/r,变换/v,矩阵/n,将/d,原/b,坐标/n,(/w,x/en,,/w, ,y/en,)/w,变换/v,为/p,新/a,坐标/n,(/w,x/en,'/w,,/w, ,y/en,'/w,)/w,，/w,这里/r,原/b,坐标/n,和/c,新/a,坐标/n,皆/d,视为/v,最末/t,一行/n,为/p,(/w,1/m,)/w,的/u,三维/nz,列向量/nw,，/w,原/b,列向量/nw,左/f,乘/v,变换/v,矩阵/n,得到/v,新/a,的/u,列向量/nw,：/w,[/w,x/en,'/w,]/w, , , , , ,[/w,a/en,00/m, ,a/en,01/m, , , , , , , ,a/en,02/m,]/w, ,[/w,x/en,]/w, , , , , , ,[/w,a/en,00/m,*/w,x/en,+/w,a/en,01/m,*/w,y/en,+/w,a/en,02/m,]/w,[/w,y/en,'/w,]/w, ,=/w, ,[/w,a/en,10/m, ,a/en,11/m, ,a/en,12/m,]/w, ,[/w,y/en,]/w, ,=/w, ,[/w,a/en,10/m,*/w,x/en,+/w,a/en,11/m,*/w,y/en,+/w,a/en,12/m,]/w,[/w,1/m, ,]/w, , , , , , , , , ,[/w,0/m, , , , ,0/m, ,1/m,]/w, ,[/w,1/m,]/w, , , , , , ,[/w, ,1/m, , , , , , , , , , , ,]/w,仿射/nw,变换/v,的/u,矩阵/n,由/p,图像/n,上/f,不/d,共/d,线/n,的/u,三个点/mq,的/u,坐标/n,确定/v,，/w,看做/v,2/m,*/w,3/m,的/u,矩阵/n,。/w,几/m,种/q,典型/n,的/u,仿射/nw,变换/v,：/w,平移/vn,变换/v,，/w,将/d,每/r,一点/m,移动/vn,到/v,(/w,x/en,+/w,tx/en,,/w, ,y/en,+/w,ty/en,)/w,，/w,变换/v,矩阵/n,为/p,：/w,[/w, ,1/m, ,0/m, ,tx/en, , , ,]/w,[/w, ,0/m, ,1/m, ,ty/en, , , ,]/w,[/w, ,0/m, ,0/m, ,1/m, ,]/w,平移/vn,变换/v,是/v,一种/mq,“/w,刚体/n,变换/v,”/w,，/w,就是/d,不/d,会/v,产生/v,形变/n,的/u,理想/n,物体/n,，/w,平移/vn,当然/d,不/d,会/v,改变/v,二维/nr,图形/n,的/u,形状/n,。/w,同理/v,，/w,下面/f,的/u,“/w,旋转/v,变换/v,”/w,也/d,是/v,刚体/n,变换/v,，/w,而/c,“/w,缩放/v,”/w,、/w,“/w,错切/nw,”/w,都/d,是/v,会/v,改变/v,图形/n,形状/n,的/u,。/w,缩放/v,变换/v,，/w,将/d,每/r,一点/m,的/u,横/v,坐标/n,放大/v,（/w,缩小/v,）/w,至/p,sx/en,倍/q,，/w,纵/c,坐标/n,放大/v,（/w,缩小/v,）/w,至/p,sy/en,倍/q,，/w,变换/v,矩阵/n,为/p,：/w,[/w, ,sx/en, ,0/m, ,0/m, ,]/w,[/w, ,0/m, ,sy/en, ,0/m, ,]/w,[/w, ,0/m, ,0/m, ,1/m, ,]/w,剪切/vn,变换/v,，/w,变换/v,矩阵/n,为/p,：/w,[/w, ,1/m, ,shx/en, ,0/m, ,]/w,[/w, , , ,shy/en, ,1/m, ,0/m, ,]/w,[/w, ,0/m, , , , , ,0/m, ,1/m, ,]/w,相当/d,于/p,一个/m,横向/n,剪切/vn,与/p,一个/m,纵向/n,剪切/vn,的/u,复合/v,，/w,即/v,[/w, ,1/m, , , , ,0/m, ,0/m, ,]/w,[/w, ,1/m, ,shx/en, ,0/m, ,]/w,[/w, , , ,shy/en, ,1/m, ,0/m, ,]/w,[/w, ,0/m, , , , , ,1/m, , , , , ,0/m, ,]/w,[/w, ,0/m, , , , ,0/m, ,1/m, ,]/w,[/w, ,0/m, ,0/m, , , , , ,1/m, ,]/w,“/w,剪切/vn,变换/v,”/w,又称/v,“/w,错切/nw,变换/v,”/w,，/w,指/v,的/u,是/v,类似/v,于/p,四/m,边/d,形不稳定性/nw,那种/r,性质/n,，/w,街边/d,小/a,商店/n,那种/r,铁拉门/nr,都/d,见/v,过/u,吧/y,？/w,想象/v,一下/m,上面/f,铁条/nr,构成/v,的/u,菱形/n,拉动/v,的/u,过程/n,，/w,那/r,就/d,是/v,“/w,错切/nw,”/w,的/u,过程/n,。/w,旋转/v,变换/v,原点/n,，/w,目标/n,图形/n,围绕/v,原/b,点顺/nw,时针/n,旋转/v,theta/en,弧度/n,，/w,变换/v,矩阵/n,为/p,：/w,[/w, ,cos/en,(/w,theta/en,)/w, ,-/w,sin/en,(/w,theta/en,)/w, ,0/m, ,]/w,[/w, ,sin/en,(/w,theta/en,)/w, , , , , ,cos/en,(/w,theta/en,)/w, ,0/m, ,]/w,[/w, , , , ,0/m, , , , , , , , , , ,0/m, , , , , , , , , , ,1/m, ,]/w,旋转/v,变换/v,，/w,目标/n,图形/n,以/p,(/w,x/en,,/w, ,y/en,)/w,为/p,轴心/n,顺时针/nw,旋转/v,theta/en,弧度/n,，/w,变换/v,矩阵/n,为/p,：/w,[/w, ,cos/en,(/w,theta/en,)/w, ,-/w,sin/en,(/w,theta/en,)/w, ,x/en,-/w,x/en,*/w,cos/en,+/w,y/en,*/w,sin/en,]/w,[/w, ,sin/en,(/w,theta/en,)/w, , , , , ,cos/en,(/w,theta/en,)/w, ,y/en,-/w,x/en,*/w,sin/en,-/w,y/en,*/w,cos/en, ,]/w,[/w, , , , ,0/m, , , , , , , , , , , , , , , ,0/m, , , , , , , , , , , ,1/m, , , , , , , ,]/w,相当/d,于/p,两次/mq,平移/vn,变换/v,与/p,一次/mq,原/b,点/q,旋转/v,变换/v,的/u,复合/v,：/w,[/w,1/m, , , ,0/m, , , ,-/w,x/en,]/w, ,[/w,cos/en,(/w,theta/en,)/w, , , ,-/w,sin/en,(/w,theta/en,)/w, , , ,0/m,]/w, ,[/w,1/m, , , ,0/m, , , ,x/en,]/w,[/w,0/m, , , ,1/m, , , ,-/w,y/en,]/w, ,[/w,sin/en,(/w,theta/en,)/w, ,cos/en,(/w,theta/en,)/w, , , ,0/m,]/w, ,[/w,0/m, , , ,1/m, , , ,y/en,]/w,[/w,0/m, , , ,0/m, , , ,1/m, ,]/w, ,[/w, , , , , ,0/m, , , , , , , , , ,0/m, , , , , , , , ,1/m, ,]/w, ,[/w,0/m, , , ,0/m, , , ,1/m,]/w,opencv/en,中/f,的/u,实现/v,函数/n,：/w,void/en, ,cvwarpaffine/en,(/w, ,const/en, ,cvarr/en,*/w, ,src/en,,/w, ,cvarr/en,*/w, ,dst/en,,/w, ,const/en, ,cvmat/en,*/w, ,map/en,_,matrix/en,,/w,int/en, ,flags/en,=/w,cv/en,_,inter/en,_,linear/en,+/w,cv/en,_,warp/en,_,fill/en,_,outliers/en,,/w,cvscalar/en, ,fillval/en,=/w,cvscalarall/en,(/w,0/m,)/w, ,)/w,;/w,实现/v,图像/n,的/u,仿射/nw,变换/v,，/w,map/en,_,matrix/en,是/v,2/m,*/w,3/m,的/u,仿射/nw,矩阵/n,，/w,要求/v,输入/v,和/c,输出/v,图像/n,有/v,相同/a,的/u,数据/n,类型/n,。/w,通过/p,下面/f,两个/m,函数/n,得到/v,仿射/nw,矩阵/n,：/w,cvmat/en,*/w, ,cvgetaffinetransform/en,(/w, ,const/en, ,cvpoint/en,2/m,d/en,32/m,f/en,*/w, ,src/en,,/w, ,const/en, ,cvpoint/en,2/m,d/en,32/m,f/en,*/w, ,dst/en,,/w,cvmat/en,*/w, ,map/en,_,matrix/en, ,)/w,;/w, ,//w,//w,由/p,三个/m,不/d,共/d,线/n,的/u,点/q,得到/v,，/w,这样/r,才/d,具有/v,唯一性/n,cvmat/en,*/w, ,cv/en,2/m,drotationmatrix/en,(/w, ,cvpoint/en,2/m,d/en,32/m,f/en, ,center/en,,/w, ,double/en, ,angle/en,,/w, ,double/en, ,scale/en,,/w,cvmat/en,*/w, ,map/en,_,matrix/en, ,)/w,;/w, ,//w,//w,由/p,旋转/v,中心/n,，/w,旋转/v,角度/n,和/c,各/r,向/p,通行/v,因子/n,，/w,矩阵/n,如下/v,：/w,[/w, ,a/en, ,b/en, ,(/w,1/m,-/w,a/en,)/w,*/w,center/en,./w,x/en,-/w,b/en,*/w,center/en,./w,y/en, ,]/w,[/w,-/w,b/en, ,a/en, ,b/en,*/w,center/en,./w,x/en,-/w,(/w,1/m,-/w,a/en,)/w,*/w,center/en,./w,y/en, ,]/w, ,其中/r,：/w,a/en,=/w,scale/en,*/w,cos/en,(/w,angle/en,)/w,,/w, ,b/en,=/w,scale/en,*/w,sin/en,(/w,angle/en,)/w,void/en, ,cvgetquadranglesubpix/en,(/w, ,const/en, ,cvarr/en,*/w, ,src/en,,/w, ,cvarr/en,*/w, ,dst/en,,/w, ,const/en, ,cvmat/en,*/w, ,map/en,_,matrix/en, ,)/w,;/w,实现/v,图像/n,的/u,仿射/nw,变换/v,，/w,使用/v,于/p,亚像素/nw,。/w,实现/v,图像/n,旋转/v,的/u,例子/n,：/w,#,include/en, ,"/w,stdafx/en,./w,h/en,"/w,#,include/en, ,"/w,cv/en,./w,h/en,"/w,#,include/en, ,"/w,highgui/en,./w,h/en,"/w,#,include/en, ,"/w,math/en,./w,h/en,"/w,int/en, ,main/en,(/w,int/en, ,argc/en,,/w, ,char/en,*/w, ,argv/en,[/w,]/w,)/w,{/w,iplimage/en, ,*/w,src/en, ,=/w, ,0/m,;/w,iplimage/en, ,*/w,dst/en, ,=/w, ,0/m,;/w,iplimage/en, ,*/w,dst/en,1/m, ,=/w, ,0/m,;/w,//w,*/w, ,the/en, ,first/en, ,command/en, ,line/en, ,parameter/en, ,must/en, ,be/en, ,image/en, ,file/en, ,name/en, ,*/w,//w,if/en, ,(/w,(/w,argc/en, ,=/w,=/w, ,2/m,)/w, ,&/w,&/w, ,(/w,src/en, ,=/w, ,cvloadimage/en, ,(/w,argv/en,[/w,1/m,]/w,,/w, ,-/w,1/m,)/w,)/w, ,!/w,=/w, ,0/m,)/w,{/w,int/en, ,delta/en, ,=/w, ,1/m,;/w,int/en, ,angle/en, ,=/w, ,0/m,;/w,int/en, ,opt/en, ,=/w, ,0/m,;/w, , , , , , , , , , , , ,//w,//w, ,1/m,：/w, ,旋转/v,加/v,缩放/v,//w,//w, ,0/m,:/w, ,仅仅/d,旋转/v,double/en, ,factor/en,;/w,dst/en, ,=/w, ,cvcloneimage/en, ,(/w,src/en,)/w,;/w,dst/en,1/m, ,=/w, ,cvcloneimage/en, ,(/w,src/en,)/w,;/w,cvnamedwindow/en, ,(/w,"/w,src/en,"/w,,/w, ,1/m,)/w,;/w,cvshowimage/en, ,(/w,"/w,src/en,"/w,,/w, ,src/en,)/w,;/w,for/en, ,(/w,;/w,;/w,)/w,{/w,float/en, ,m/en,[/w,6/m,]/w,;/w,//w,//w, ,matrix/en, ,m/en, ,looks/en, ,like/en,:/w,//w,//w,//w,//w, ,[/w, ,m/en,0/m, ,m/en,1/m, ,m/en,2/m, ,]/w, ,=/w,=/w,=/w,>, ,[/w, ,a/en,11/m, ,a/en,12/m, , , ,b/en,1/m, ,]/w,//w,//w, ,[/w, ,m/en,3/m, ,m/en,4/m, ,m/en,5/m, ,]/w, , , , , , , ,[/w, ,a/en,21/m, ,a/en,22/m, , , ,b/en,2/m, ,]/w,//w,//w,cvmat/en, ,m/en, ,=/w, ,cvmat/en, ,(/w,2/m,,/w, ,3/m,,/w, ,cv/en,_,32/m,f/en,,/w, ,m/en,)/w,;/w,int/en, ,w/en, ,=/w, ,src/en,-/w,>,width/en,;/w,int/en, ,h/en, ,=/w, ,src/en,-/w,>,height/en,;/w,if/en, ,(/w,opt/en,)/w, , , , , , , , , , , ,//w,//w, ,旋转/v,加/v,缩放/v,factor/en, ,=/w, ,(/w,cos/en, ,(/w,angle/en, ,*/w, ,cv/en,_,pi/en, ,//w, ,180/m,./w,)/w, ,+/w, ,1.0/m,)/w, ,*/w, ,2/m,;/w,else/en, , , , , , , , , , , , , , , , ,//w,//w, ,仅仅/d,旋转/v,factor/en, ,=/w, ,1/m,;/w,m/en,[/w,0/m,]/w, ,=/w, ,(/w,float/en,)/w, ,(/w,factor/en, ,*/w, ,cos/en, ,(/w,-/w,angle/en, ,*/w, ,2/m, ,*/w, ,cv/en,_,pi/en, ,//w, ,180/m,./w,)/w,)/w,;/w,m/en,[/w,1/m,]/w, ,=/w, ,(/w,float/en,)/w, ,(/w,factor/en, ,*/w, ,sin/e