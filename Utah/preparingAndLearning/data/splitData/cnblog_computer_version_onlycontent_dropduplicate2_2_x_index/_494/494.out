或许/d,很多/m,朋友/n,会/v,好奇/a,其中/r,的/u,神秘/a,，/w,比如说/l,为什么/r,不同/a,角度/n,拍摄/v,的/u,图片/n,拼接/vn,的/u,时候/n,可以/v,自动/d,对/p,齐/d,（/w,略/d,准确/a,来讲/u,也/d,就/d,是/v,如何/r,处理/v,图片/n,之间/f,的/u,仿射/nw,畸变/n,和/c,透视/v,失/v, ,真/d,）/w,；/w,如何/r,能/v,自动/d,找到/v,图片/n,之间/f,可以/v,粘连/v,的/u,部分/n,并且/c,准确无误/l,地/u,拼接/vn,在/p,一起/s,；/w,如何/r,平衡/a,图片/n,之间/f,光线/n,色调/n,的/u,差异/n,等等/u,。/w,其实/d,每/r,一步/mq,的/u,背后/f,或多或少/d,都/d,有/v,比较/d,复杂/a,却/d,又/d, ,相当/d,精妙/a,的/u,技术/n,和/c,算法/n,，/w,所以/c,这次/r,尝试/vn,用/p,比较/d,直观/a,的/u,方式/n,给/p,大家/r,介绍/v,一下/m,每/r,一步/mq,的/u,工作/vn,原理/n,，/w,逆转/v,对/p,前沿/s,科技/n,“/w,虽/c,不明/v,但/c,觉厉/nr,”/w,的/u,看法/n,。/w,那么/r,先/d,描述/v,一下/m,整个/b,流程/n,：/w,---/nrf,图片/n,之间/f,---/nrf,1/m,./w, ,特征点/nw,匹配/vn,：/w,找到/v,素材/n,图片/n,中/f,共有/v,的/u,图像/n,部分/n,。/w,2/m,./w, ,图片/n,匹配/vn,：/w,连接/v,匹配/vn,的/u,特征点/nw,，/w,估算/v,图像/n,间/f,几何/n,方面/n,的/u,变换/v,。/w,---/nrf,全局/n,优化/v,和/c,无缝/b,衔接/v,---/nrf,3/m,./w, ,全景/n,图/n,矫直/nr,：/w,矫正/v,拍摄/v,图片/n,时/ng,相机/n,的/u,相对/d,3/m,d/en,旋转/v,，/w,主要/b,原因/n,是/v,拍摄/v,图片/n,时/ng,相机/n,很/d,可能/v,并/c,不/d,在/p,同一/b,水平线/n,上/f,，/w,并且/c,存在/v,不同/a,程度/n,的/u,倾斜/v,，/w,略/d,过/u,这/r,一步/mq,可能/v,导致/v,全景/n,图/n,变成/v,波浪/n,形状/n,。/w,4/m,./w, ,图像/n,均衡/a,补偿/vn,：/w,全局/n,平衡/a,所有/b,图片/n,的/u,光照/n,和/c,色调/n,。/w,5/m,./w, ,图像/n,频段/n,融合/v,：/w,步骤/n,4/m,之后/f,仍然/d,会/v,存在/v,图像/n,之间/f,衔接/v,边缘/n,、/w,晕影/nw,效果/n,（/w,图像/n,的/u,外围/f,部分/n,的/u,亮度/n,或/c,饱和度/n,比/p,中心/n,区域/n,低/a,）/w,、/w,视差/n,效果/n,（/w,因为/c,相机/n,透镜/n,移动/vn,导致/v,）/w,。/w,----------------/nrf,（/w,一/m,）/w,特征点/nw,匹配/vn,----------------/nrf,合成/v,全景/n,图/n,的/u,第一/m,步/q,是/v,提取/v,并且/c,匹配/vn,所有/b,素材/n,图片/n,的/u,局部/n,特征点/nw,。/w,1/m,./w, ,什么/r,是/v,特征点/nw,？/w,普遍/ad,来讲/u,，/w,一张/mq,图片/n,所/u,包含/v,的/u,特征点/nw,通常/d,就/d,是/v,周围/f,含有/v,较/d,大/a,信息量/n,的/u,点/q,，/w,而/c,仅/d,通过/p,这些/r,富有/v,特征/n,的/u,局部/n,，/w,基本/a,就/d,可以/v,推测/v,出/v,整/m,张/q,图片/n,。/w,比如说/l,物体/n,的/u,棱角/n,、/w,夜景/n,闪耀/v,的/u,星星/n,，/w,或是/c,图片/n,里/f,的/u,图案/n,和/c,花纹/n,。/w,图/n,中/f,框/q,内/f,即/v,为/p,判断/v,富有/v,特征/n,的/u,部分/n,。/w,实/a, ,际/ng,上/f,人/n,在/p,识别/v,某个/r,东西/n,或是/c,图案/n,的/u,时候/n,也/d,是/v,通过/p,观察/v,这个/r,物体/n,具有/v,哪/r,种/q,特征/n,，/w,然后/c,与/p,自己/r,的/u,经历/n,和/c,记忆/n,所/u,匹配/vn,。/w,举例来说/l,，/w,去/v,超市/n,看到/v,一个/m,水果/n,，/w,假设/v,我们/r,观察/v,到/v,这/r, ,个/q,水果/n,是/v,绿色/n,（/w,颜色/n,特征/n,）/w,，/w,球形/n,（/w,形状/n,特征/n,）/w,，/w,有/v,黑色/n,纹路/n,（/w,图案/n,特征/n,）/w,。/w,于是/c,我们/r,可以/v,通过/p,经验/n,判断/v,出/v,这/r,是/v,个/q,西瓜/n,。/w,当然人/nw,还/d,会/v,通过/p,各种/r,其他/r,特征/n,来/v,增强/v,对/p,物体/n, ,的/u,判断力/n,，/w,只是/d,整个/b,从/p,收到/v,信息/n,到/v,做出/v,判断/v,的/u,过程/n,行云流水/i,，/w,甚至/d,自己/r,都/d,察觉/v,不/d,到/v,。/w,这/r,就/d,是/v,生物/n,视觉/n,的/u,精妙/a,之/u,处/n,，/w,只/d,可惜/v,距离/n,破解/v,生物/n,视觉/n,系统/n,目前/t,看来/v,似乎/d,仍/d,是/v,遥/ag, ,不可/v,及/c,，/w,所以/c,在/p,神经/n,网络/n,破解/v,并/c,模拟/b,生物/n,大脑/n,的/u,运作/vn,之前/f,就/d,先/d,由/p,计算机/n,视觉/n,来/v,承担/v,这个/r,重担/n,了/u,。/w,稍稍/d,有些/r,跑题/v,，/w,那么/r,继续/v,之前/f,的/u,问题/n,：/w,提取/v,何种/r,特征/n,？/w,并且/c,如何/r,提取/v,特征/n,？/w,如/v, ,前面/f,所/u,说/v,，/w,一幅/mq,图片/n,具有/v,形形色色/i,各种/r,特征/n,，/w,简单/a,的/u,可以/v,是/v,颜色/n,、/w,形状/n,或/c,图案/n,，/w,复杂/a,的/u,比如说/l,可以/v,是/v,图案/n,的/u,自相似性/nw,（/w,是否/v,存在/v,类似/v,重复性/n,图案/n,）/w,或是/c,整个/b,场景/n,里/f,其/r, ,他/r,的/u,物体/n,（/w,好比/v,说/v,在/p,超市/n,的/u,水果架/nw,上/f,我们/r,可以/v,更/d,能/v,确信/v,西瓜/n,就/d,是/v,西瓜/n,，/w,而/c,水果架/nw,这个/r,背景/n,即/v,为/p,特征/n,）/w,。/w,实际上/d,提取/v,这些/r,特征/n,在/p,计算机/n,视觉/n,领域/n,里/f,也/d,占有/v,相当/d,重要/a,的/u,位/q, ,置/v,，/w,毕竟/d,好/a,的/u,特征/n,选择/v,是/v,整个/b,识别/v,系统/n,可以/v,成功/a,运转/v,的/u,大前提/n,。/w,[/w,理论/n,部分/n,]/w,在/p,合成/v,全景/n,图/n,的/u,流程/n,里/f,运用/v,的/u,是/v,“/w,点/q,匹配/vn,”/w,，/w,也/d,就/d,是/v,匹配/vn,局部/n,图片/n,信息/n,。/w,因为/c,局部/n,图片/n,能/v,提取/v,的/u,特征/n,有限/a,，/w,比如说/l,形状/n,特征/n,在/p,这种/r,情况/n,就/d,不/d,适宜/v,，/w,所以/c,一般/a,采用/v,通过/p,整个/b,局部/n,的/u,图案/n,来/v,判断/v,是否/v,符合/v,作为/v,特征/n,的/u,条件/n,。/w,其中/r,运用/v,最/d,普遍/ad,的/u,为/p,sift/en,特征/n,（/w,scale/en,-/w,invariant/en, ,feature/en, ,transform/en,)/w,，/w,即/v,尺度/n,不/d,变/v,特征/n,转换/v,。/w, ,其/r,应用/vn,范围/n,包含/v,物体/n,辨识/v,、/w,机器人/n,地图/n,感知/v,与/p,导航/vn,、/w,影像/n,缝合/v,、/w,3/m,d/en,模型/n,建立/v,、/w,手势/n,辨识/v,、/w,影像/n,追踪/v,和/c,动作/n,比对/d,。/w,此/r,算法/n,由/p, ,david/en, ,lowe/en, ,在/p,1999年/t,所/u,发表/v,，/w,在/p,急速/z,发展/vn,的/u,计算机/n,视觉/n,领域/n,内/f,至今/d,仍然/d,被/p,普遍/ad,认为/v,是/v,最/d,好/a,的/u,（/w,即/v,state/en, ,of/en, ,the/en, ,art/en,）/w,特征/n,侦测/v,与/p,描述/v,算法/n,。/w,提取/v,sift/en,特征/n,分为/v,两步/mq,：/w,侦测/v,与/p,描述/v,（/w,形成/v,特征/n,向量/n,）/w,。/w,简/nr, ,单/d,来讲/u,，/w,侦测/v,就/d,是/v,扫描/v,图片/n,所有/b,的/u,尺度/n,下/f,的/u,所有/b,位置/n,（/w,尺度/n,可以/v,理解/v,为/p,局部/n,缩放/v,）/w,。/w,而/c,判断/v,一个/m,点/q,作为/v,特征/n,点合/nw,不/d,合格/v,，/w,需要/v,计算/v,在/p,这个/r,尺度/n,下/f,的/u,高斯/nr,差/a, ,（/w,dog/en,，/w,difference/en, ,of/en, ,gaussians/en,）/w,的/u,局部/n,极值/nz,（/w,local/en, ,extrema/en,）/w,。/w,如/v,第一/m,张/q,图/n,所/u,示/vg,，/w,每/r,一个/m,尺度/n,（/w,scale/en,）/w,下/f,对/p,局部/n,影像/n,进行/v,不同/a,尺度/n,的/u,高斯/nr,模糊/a,（/w,局部/n,影像/n,与/p,高斯滤波器/nw,的/u,卷积/nw,）/w,取/v,差值/n,。/w,局部/n,极值/nz,计算/v,方/q, ,式/k,如/v,第二/m,张/q,图/n,所/u,示/vg,，/w,将/d,测试/vn,像素/n,的/u,dog/en,的/u,数值/n,与/p,其/r,26个/m,邻接/v,像素/n,比较/d,取/v,其/r,最/d,大/a,最/d,小/a,极值/nz,，/w,也/d,就/d,是/v,测试/vn,像素/n,的/u,“/w,特征/n,度/q,”/w, ,。/w,即便/c,找到/v,了/u,特征点/nw,，/w,单纯/a,匹配/vn,特征点/nw,周围/f,的/u,局部/n,影像/n,是/v,行不通/v,的/u,。/w,首先/d,sift/en,特征/n,本身/r,最/d,大/a,的/u,优点/n,就/d,是/v,“/w,位置/n,、/w,尺度/n,、/w,旋转/v,不/d,变量/n,"/w,，/w,也就是说/l,在/p,一定/d,范围/n,内/f,旋转/v,或是/c,拉远拉近/nr,相机/n,，/w,可以/v,检测/vn,出/v,相同/a,的/u,特征点/nw,位置/n,（/w,repeatability/en,）/w,以及/c,提取/v,出/v,相同/a,的/u,特征/n,向量/n,（/w,scale/en, ,&/w, ,rotation/en, ,invariant/en,）/w,，/w, ,所以/c,不同/a,角度/n,条件/n,拍摄/v,的/u,图片/n,才/d,可以/v,通过/p,sift/en,特征/n,匹配/vn,。/w,而/c,像素/n,数值/n,是/v,不/d,具备/v,这些/r,特点/n,的/u,。/w,再者/c,局部/n,影像/n,的/u,像素/n,信息量/n,大/a,导致/v,匹配/vn,效率/n,低下/a,。/w,假设/v,这个/r,局部/n,大小/n, ,设为/v,16/m,*/w,16/m,像素/n,大小/n,，/w,每/r,一个/m,像/v,素值/nr,对应/v,rgb/en, ,3/m,个数/n,值/n,，/w,那么/r,每个/r,特征点/nw,就/d,对应/v,一个/m,786维/mq,的/u,向量/n,（/w,也/d,就/d,是/v,每个/r,点/q,要/v,用/p,786个/m,数/m,表示/v,）/w,，/w,考虑/v,到/v,尺度/n,与/p,旋转/v,不/d,变量/n,这个/r,向量/n,又/d,需要/v,乘/v,上/f,十几/m,倍/q,甚至/d,几十/nw,倍/q,以/p,覆/vg, ,盖/v,所有/b,的/u,变化/vn,，/w,假设/v,一个/m,图片/n,如果/c,包含/v,上千/nw,个/q,特征点/nw,，/w,而/c,数据库/n,包含/v,上千/nw,张/q,图片/n,，/w,那么/r,在/p,匹配/vn,时/ng,庞大/a,的/u,计算量/nw,无疑/d,是/v,对/p,cpu/en,的/u,一场/mq,灾难/n,。/w,为了/p,保证/v,提取/v,出来/v,的/u,特征/n,向/p,量/n,具有/v,“/w,旋转/v,不/d,变量/n,”/w, ,的/u,特性/n,，/w,首先/d,要/v,做/v,的/u,是/v,在/p,每个/r,特征点/nw,找到/v,一个/m,“/w,方向/n,”/w,，/w,而/c,这个/r,方向/n,和/c,局部/n,图像/n,的/u,特性/n,应当/v,是/v,一致/a,的/u,，/w,也就是说/l,理想/n,状态/n,下/f,如果/c,旋转/v,这个/r,局部/n,图片/n,，/w,那么/r,重新/d,提取/v,这/r, ,个/q,"/w,方向/n,"/w,也/d,和/c,之前/f,相比/v,旋转/v,相同/a,角度/n,。/w,sift/en,里/f,选择/v,这个/r,角度/n,的/u,方式/n,是/v,在/p,高斯/nr,模糊/a,之后/f,的/u,局部/n,图片/n,里/f,计算/v,每/r,一个/m,像素/n,点/q,的/u,"/w,角度/n,"/w,与/p,"/w,大小/n,"/w,，/w,之后/f,进行/v,投票/v,选/v, ,出/v,所有/b,像素/n,最/d,多/a,的/u,那个/r,角度/n,作为/v,主/n,方向/n,。/w,下/f,图/n,为/p,计算/v,这个/r,角度/n,和/c,大小/n,的/u,公式/n,，/w,看似/v,很/d,长/a,实际上/d,只/d,是/v,计算/v,横竖/d,相邻/v,像素/n,之间/f,的/u,差值/n,和/c,(/w,m/en,)/w,和/c,角度/n,(/w,θ,)/w,。/w,于是/c,局部/n,图像/n,产生/v,的/u,差值/n,和/c,角度/n,可以/v,通过/p,这种/r,方式/n,形成/v,特征/n,向量/n,（/w,或/c,称为/v,关键点/n,描述/v,子/ng, ,-/w, ,keypoint/en, ,descriptor/en,）/w,。/w,形/ng, ,成/v,这个/r,向量/n,的/u,方式/n,是/v,"/w,量化/v,"/w,这些/r,角度/n,(/w,比如说/l,把/p,360度/mq,平均/a,分/q,成/v,8/m,等分/n,)/w,,/w, ,然后/c,根据/p,位置/n,累计/v,起来/v,。/w,上图/n,表示/v,的/u,是/v,一个/m,8/m,x/en,8/m,的/u,局部/n,采样/v,计算/v,出/v,的/u,2/m,x/en,2/m,的/u,特征/n,矩阵/n,，/w,实际上/d,一般/a,使用/v,的/u,是/v,16/m,x/en,16/m,局部/n,采样/v,形成/v,4/m,x/en,4/m,特征/n,矩阵/n,。/w,所以/c,如果/c, ,把/p,这个/r,矩阵/n,拉成/nr,向量/n,，/w,也/d,就/d,是/v,包含/v,8/m,*/w,4/m,*/w,4/m, ,=/w, ,128个/m,元素/n,。/w,形成/v,特征/n,向量/n,之后/f,下/f,一个/m,问题/n,就/d,是/v,如何/r,匹配/vn,了/u,。/w, ,最/d,基本/a,的/u,方式/n,可以/v,称作/v,“/w,最/d,邻近/v,搜索/vn,”/w,（/w,nearest/en, ,neighbour/en,）/w,，/w,实际上/d,也/d,就/d,是/v,找/v,在/p,128维/mq,空间/n,上/f,直线/n,距离/n,最近/t,的/u,的/u,特征/n,向量/n,，/w,这个/r,求/v,直线/n,距离/n,的/u,方式/n,和/c,2维/mq,无异/v,，/w,最近/t,的/u,特征/n,向/p,量/n,也/d,就/d,被/p,认为/v,是/v,互相/d,匹/q, ,配/v,。/w,原作者/nw,使用/v,的/u,方式/n,是/v,增加/v,了/u,k/en,-/w,d/en, ,tree/en,算法/n,来/v,高/a,效率/n,地/u,完成/v,高/a,维度/n,上/f,的/u,最/d,邻近/v,搜索/vn,。/w,[/w,理论/n,部分/n,结束/v,]/w,----------------/nrf,（/w,二/m,）/w,图片/n,匹配/vn,----------------/nrf,接/v, ,下来/v,的/u,目标/n,就是/d,找到/v,所有/b,匹配/vn,(/w,也/d,就/d,是/v,重叠/v,)/w,的/u,图片/n,部分/n,，/w,接连/d,所有/b,图片/n,之后/f,就/d,可以/v,形成/v,一个/m,基本/a,的/u,全景/n,图/n,了/u,。/w,因为/c,每张/r,图片/n,有/v,可能/v,和/c,其他/r,每张/r,图片/n,有/v,重叠/v,部分/n,，/w,所/u, ,以/p,匹配/vn,全部/m,图片/n,需要/v,差不多/l,匹配/vn,图片/n,个数/n,的/u,平方次/nw,。/w,不过/c,实际上/d,每/r,两张/mq,图片/n,之间/f,只/d,需要/v,那么/r,几/m,个/q,相对/d,精/a,准/a,匹配/vn,的/u,点/q,就/d,可以/v,估算/v,出/v,这/r,两张/mq,图像/n,里/f,的/u,几何/n,关系/n,。/w,最/d,普遍/ad,的/u,方式/n,是/v,用/p,ransac/en,（/w,random/en, ,sample/en, ,consensus/en,,/w, ,随机/d,抽样/vn,一致/a,）/w,，/w,在/p,这里/r,的/u,用途/n,就/d,是/v,排除/v,掉/v,不/d,符合/v,大部分/m,几何/n,变换/v,的/u,匹配/vn,。/w,之后/f,利用/v,这些/r,匹配/vn,的/u,点/q,来