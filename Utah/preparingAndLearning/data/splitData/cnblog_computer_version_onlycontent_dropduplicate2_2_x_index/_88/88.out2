github/en,地址/n,：/w,mask/en,_,rcnn/en,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,论文/n,学习/v,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,项目/n,文档/n,翻译/v,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其一/r,：/w,总览/nw,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,二/m,：/w,基于/p,renet/en,101/m,的/u,fpn/en,共享/v,网络/n,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,三/m,：/w,rpn/en,锚框/nw,处理/v,和/c,proposal/en,生成/vn,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,四/m,：/w,fpn/en,和/c,roialign/en,的/u,耦合/vn,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,五/m,：/w,目标/n,检测/vn,结果/n,精炼/a,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,其/r,六/m,：/w,mask/en,生成/vn,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,推断/vn,网络/n,终篇/nw,：/w,使用/v,detect/en,方法/n,进行/v,推断/vn,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,锚框/nw,生成/vn,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,训练/vn,网络/n,其一/r,：/w,数据集/nw,与/p,dataset/en,类/q,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,训练/vn,网络/n,其/r,二/m,：/w,train/en,网络结构/l,&/w,损失/n,函数/n,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,训练/vn,网络/n,其/r,三/m,：/w,训练/vn,model/en,本节/t,介绍/v,的/u,数据集/nw,class/en,构建/v,为/p,官方/n,demo/en,，/w,对/p,从/p,零/m,开始/v,构建/v,自己/r,的/u,数据集/nw,训练/vn,感/vg,兴趣/n,的/u,建议/n,了解/v,了/u,本文/r,及/c,本文/r,对应/v,的/u,代码/n,文件/n,后/f,，/w,看/v,一下/m,『/w,计算机/n,视觉/n,』/w,mask/en,-/w,rcnn/en,_,关键点/n,检测/vn,分支/n,介绍/v,了/u,由/p,自己/r,的/u,数据/n,构建/v,mask/en, ,rcnn/en,可/v,用/p,形式/n,的/u,实践/v,。/w,代码/n,位置/n,在/p,脚本/n,train/en,_,shapes/en,./w,ipynb/en,中/f,，/w,作者/n,演示/vn,了/u,使用/v,合成/v,图片/n,进行/v,训练/vn,mask/en,_,rcnn/en,的/u,小/a,demo/en,，/w,我们/r,将/d,以此/d,为/p,例/n,，/w,从/p,训练/vn,数据/n,的/u,角度/n,重新/d,审视/vn,mask/en,_,rcnn/en,。/w,在/p,训练/vn,过程/n,中/f,，/w,我们/r,最先/d,要/v,做/v,的/u,根据/p,我们/r,自己/r,的/u,数据集/nw,，/w,集成/vn,改写/v,基础/n,的/u,数据/n,读/v,取/v,class/en,：/w,util/en,./w,py/en,中/f,的/u,dataset/en, ,class/en,，/w,然后/c,根据/p,数据集/nw,调整/vn,网络/n,配置/vn,文件/n,配置/vn,config/en,./w,py/en,中/f,的/u,config/en, ,类/q,，/w,使得/v,网络/n,形状/n,配/v,适数/nw,，/w,然后/c,再/d,去/v,考虑/v,训练/vn,的/u,问题/n,。/w,按照/p,逻辑/n,流程/n,，/w,本节/t,我们/r,以/p,train/en,_,shapes/en,./w,ipynb/en,中/f,的/u,数据/n,生成/vn,为/p,例/n,，/w,学习/v,dataset/en, ,class/en,的/u,运作/vn,机理/n,。/w,在/p,示例/n,程序/n,中/f,，/w,首先/d,创建/v,新/a,的/u,dataset/en,的/u,子类/nw,（/w,这里/r,贴/v,出/v,整个/b,class/en,代码/n,，/w,后面/f,会/v,分节/nw,讲解/v,）/w,：/w,class/en, ,shapesdataset/en,(/w,utils/en,./w,dataset/en,)/w,:/w, ,"/w,"/w,"/w,generates/en, ,the/en, ,shapes/en, ,synthetic/en, ,dataset/en,./w, ,the/en, ,dataset/en, ,consists/en, ,of/en, ,simple/en, ,shapes/en, ,(/w,triangles/en,,/w, ,squares/en,,/w, ,circles/en,)/w, ,placed/en, ,randomly/en, ,on/en, ,a/en, ,blank/en, ,surface/en,./w, ,the/en, ,images/en, ,are/en, ,generated/en, ,on/en, ,the/en, ,fly/en,./w, ,no/en, ,file/en, ,access/en, ,required/en,./w, ,"/w,"/w,"/w, ,def/en, ,load/en,_,shapes/en,(/w,self/en,,/w, ,count/en,,/w, ,height/en,,/w, ,width/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,the/en, ,requested/en, ,number/en, ,of/en, ,synthetic/en, ,images/en,./w, ,count/en,:/w, ,number/en, ,of/en, ,images/en, ,to/en, ,generate/en,./w, ,height/en,,/w, ,width/en,:/w, ,the/en, ,size/en, ,of/en, ,the/en, ,generated/en, ,images/en,./w, ,"/w,"/w,"/w, ,#, ,add/en, ,classes/en, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,1/m,,/w, ,"/w,square/en,"/w,)/w, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,2/m,,/w, ,"/w,circle/en,"/w,)/w, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,3/m,,/w, ,"/w,triangle/en,"/w,)/w, ,#, ,add/en, ,images/en, ,#, ,generate/en, ,random/en, ,specifications/en, ,of/en, ,images/en, ,(/w,i/en,./w,e/en,./w, ,color/en, ,and/en, ,#, ,list/en, ,of/en, ,shapes/en, ,sizes/en, ,and/en, ,locations/en,)/w,./w, ,this/en, ,is/en, ,more/en, ,compact/en, ,than/en, ,#, ,actual/en, ,images/en,./w, ,images/en, ,are/en, ,generated/en, ,on/en, ,the/en, ,fly/en, ,in/en, ,load/en,_,image/en,(/w,)/w,./w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,count/en,)/w,:/w, ,bg/en,_,color/en,,/w, ,shapes/en, ,=/w, ,self/en,./w,random/en,_,image/en,(/w,height/en,,/w, ,width/en,)/w, ,self/en,./w,add/en,_,image/en,(/w,"/w,shapes/en,"/w,,/w, ,image/en,_,id/en,=/w,i/en,,/w, ,path/en,=/w,none/en,,/w, ,width/en,=/w,width/en,,/w, ,height/en,=/w,height/en,,/w, ,bg/en,_,color/en,=/w,bg/en,_,color/en,,/w, ,shapes/en,=/w,shapes/en,)/w, ,def/en, ,load/en,_,image/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,an/en, ,image/en, ,from/en, ,the/en, ,specs/en, ,of/en, ,the/en, ,given/en, ,image/en, ,id/en,./w, ,typically/en, ,this/en, ,function/en, ,loads/en, ,the/en, ,image/en, ,from/en, ,a/en, ,file/en,,/w, ,but/en, ,in/en, ,this/en, ,case/en, ,it/en, ,generates/en, ,the/en, ,image/en, ,on/en, ,the/en, ,fly/en, ,from/en, ,the/en, ,specs/en, ,in/en, ,image/en,_,info/en,./w, ,"/w,"/w,"/w, ,info/en, ,=/w, ,self/en,./w,image/en,_,info/en,[/w,image/en,_,id/en,]/w, ,bg/en,_,color/en, ,=/w, ,np/en,./w,array/en,(/w,info/en,[/w,'/w,bg/en,_,color/en,'/w,]/w,)/w,./w,reshape/en,(/w,[/w,1/m,,/w, ,1/m,,/w, ,3/m,]/w,)/w, ,image/en, ,=/w, ,np/en,./w,ones/en,(/w,[/w,info/en,[/w,'/w,height/en,'/w,]/w,,/w, ,info/en,[/w,'/w,width/en,'/w,]/w,,/w, ,3/m,]/w,,/w, ,dtype/en,=/w,np/en,./w,uint/en,8/m,)/w, ,image/en, ,=/w, ,image/en, ,*/w, ,bg/en,_,color/en,./w,astype/en,(/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,shape/en,,/w, ,color/en,,/w, ,dims/en, ,in/en, ,info/en,[/w,'/w,shapes/en,'/w,]/w,:/w, ,image/en, ,=/w, ,self/en,./w,draw/en,_,shape/en,(/w,image/en,,/w, ,shape/en,,/w, ,dims/en,,/w, ,color/en,)/w, ,return/en, ,image/en, ,def/en, ,image/en,_,reference/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,"/w,"/w,"/w,return/en, ,the/en, ,shapes/en, ,data/en, ,of/en, ,the/en, ,image/en,./w,"/w,"/w,"/w, ,info/en, ,=/w, ,self/en,./w,image/en,_,info/en,[/w,image/en,_,id/en,]/w, ,if/en, ,info/en,[/w,"/w,source/en,"/w,]/w, ,=/w,=/w, ,"/w,shapes/en,"/w,:/w, ,return/en, ,info/en,[/w,"/w,shapes/en,"/w,]/w, ,else/en,:/w, ,super/en,(/w,self/en,./w,_,_,class/en,_,_,)/w,./w,image/en,_,reference/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w, ,def/en, ,load/en,_,mask/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,instance/en, ,masks/en, ,for/en, ,shapes/en, ,of/en, ,the/en, ,given/en, ,image/en, ,id/en,./w, ,"/w,"/w,"/w, ,info/en, ,=/w, ,self/en,./w,image/en,_,info/en,[/w,image/en,_,id/en,]/w, ,shapes/en, ,=/w, ,info/en,[/w,'/w,shapes/en,'/w,]/w, ,count/en, ,=/w, ,len/en,(/w,shapes/en,)/w, ,mask/en, ,=/w, ,np/en,./w,zeros/en,(/w,[/w,info/en,[/w,'/w,height/en,'/w,]/w,,/w, ,info/en,[/w,'/w,width/en,'/w,]/w,,/w, ,count/en,]/w,,/w, ,dtype/en,=/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,i/en,,/w, ,(/w,shape/en,,/w, ,_,,/w, ,dims/en,)/w, ,in/en, ,enumerate/en,(/w,info/en,[/w,'/w,shapes/en,'/w,]/w,)/w,:/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,:/w,i/en,+/w,1/m,]/w, ,=/w, ,self/en,./w,draw/en,_,shape/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,:/w,i/en,+/w,1/m,]/w,./w,copy/en,(/w,)/w,,/w, ,shape/en,,/w, ,dims/en,,/w, ,1/m,)/w, ,#, ,handle/en, ,occlusions/en, ,occlusion/en, ,=/w, ,np/en,./w,logical/en,_,not/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,-/w,1/m,]/w,)/w,./w,astype/en,(/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,count/en,-/w,2/m,,/w, ,-/w,1/m,,/w, ,-/w,1/m,)/w,:/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w, ,=/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w, ,*/w, ,occlusion/en, ,occlusion/en, ,=/w, ,np/en,./w,logical/en,_,and/en,(/w,occlusion/en,,/w, ,np/en,./w,logical/en,_,not/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w,)/w,)/w, ,#, ,map/en, ,class/en, ,names/en, ,to/en, ,class/en, ,ids/en,./w, ,class/en,_,ids/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,self/en,./w,class/en,_,names/en,./w,index/en,(/w,s/en,[/w,0/m,]/w,)/w, ,for/en, ,s/en, ,in/en, ,shapes/en,]/w,)/w, ,return/en, ,mask/en,./w,astype/en,(/w,np/en,./w,bool/en,)/w,,/w, ,class/en,_,ids/en,./w,astype/en,(/w,np/en,./w,int/en,32/m,)/w, ,def/en, ,draw/en,_,shape/en,(/w,self/en,,/w, ,image/en,,/w, ,shape/en,,/w, ,dims/en,,/w, ,color/en,)/w,:/w, ,"/w,"/w,"/w,draws/en, ,a/en, ,shape/en, ,from/en, ,the/en, ,given/en, ,specs/en,./w,"/w,"/w,"/w, ,#, ,get/en, ,the/en, ,center/en, ,x/en,,/w, ,y/en, ,and/en, ,the/en, ,size/en, ,s/en, ,x/en,,/w, ,y/en,,/w, ,s/en, ,=/w, ,dims/en, ,if/en, ,shape/en, ,=/w,=/w, ,'/w,square/en,'/w,:/w, ,cv/en,2/m,./w,rectangle/en,(/w,image/en,,/w, ,(/w,x/en,-/w,s/en,,/w, ,y/en,-/w,s/en,)/w,,/w, ,(/w,x/en,+/w,s/en,,/w, ,y/en,+/w,s/en,)/w,,/w, ,color/en,,/w, ,-/w,1/m,)/w, ,elif/en, ,shape/en, ,=/w,=/w, ,"/w,circle/en,"/w,:/w, ,cv/en,2/m,./w,circle/en,(/w,image/en,,/w, ,(/w,x/en,,/w, ,y/en,)/w,,/w, ,s/en,,/w, ,color/en,,/w, ,-/w,1/m,)/w, ,elif/en, ,shape/en, ,=/w,=/w, ,"/w,triangle/en,"/w,:/w, ,points/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,[/w,(/w,x/en,,/w, ,y/en,-/w,s/en,)/w,,/w, ,(/w,x/en,-/w,s/en,//w,math/en,./w,sin/en,(/w,math/en,./w,radians/en,(/w,60/m,)/w,)/w,,/w, ,y/en,+/w,s/en,)/w,,/w, ,(/w,x/en,+/w,s/en,//w,math/en,./w,sin/en,(/w,math/en,./w,radians/en,(/w,60/m,)/w,)/w,,/w, ,y/en,+/w,s/en,)/w,,/w, ,]/w,]/w,,/w, ,dtype/en,=/w,np/en,./w,int/en,32/m,)/w, ,cv/en,2/m,./w,fillpoly/en,(/w,image/en,,/w, ,points/en,,/w, ,color/en,)/w, ,return/en, ,image/en, ,def/en, ,random/en,_,shape/en,(/w,self/en,,/w, ,height/en,,/w, ,width/en,)/w,:/w, ,"/w,"/w,"/w,generates/en, ,specifications/en, ,of/en, ,a/en, ,random/en, ,shape/en, ,that/en, ,lies/en, ,within/en, ,the/en, ,given/en, ,height/en, ,and/en, ,width/en, ,boundaries/en,./w, ,returns/en, ,a/en, ,tuple/en, ,of/en, ,three/en, ,valus/en,:/w, ,*/w, ,the/en, ,shape/en, ,name/en, ,(/w,square/en,,/w, ,circle/en,,/w, ,./w,./w,./w,)/w, ,*/w, ,shape/en, ,color/en,:/w, ,a/en, ,tuple/en, ,of/en, ,3/m, ,values/en,,/w, ,rgb/en,./w, ,*/w, ,shape/en, ,dimensions/en,:/w, ,a/en, ,tuple/en, ,of/en, ,values/en, ,that/en, ,define/en, ,the/en, ,shape/en, ,size/en, ,and/en, ,location/en,./w, ,differs/en, ,per/en, ,shape/en, ,type/en,./w, ,"/w,"/w,"/w, ,#, ,shape/en, ,shape/en, ,=/w, ,random/en,./w,choice/en,(/w,[/w,"/w,square/en,"/w,,/w, ,"/w,circle/en,"/w,,/w, ,"/w,triangle/en,"/w,]/w,)/w, ,#, ,color/en, ,color/en, ,=/w, ,tuple/en,(/w,[/w,random/en,./w,randint/en,(/w,0/m,,/w, ,255/m,)/w, ,for/en, ,_, ,in/en, ,range/en,(/w,3/m,)/w,]/w,)/w, ,#, ,center/en, ,x/en,,/w, ,y/en, ,buffer/en, ,=/w, ,20/m, ,y/en, ,=/w, ,random/en,./w,randint/en,(/w,buffer/en,,/w, ,height/en, ,-/w, ,buffer/en, ,-/w, ,1/m,)/w, ,x/en, ,=/w, ,random/en,./w,randint/en,(/w,buffer/en,,/w, ,width/en, ,-/w, ,buffer/en, ,-/w, ,1/m,)/w, ,#, ,size/en, ,s/en, ,=/w, ,random/en,./w,randint/en,(/w,buffer/en,,/w, ,height/en,//w,//w,4/m,)/w, ,return/en, ,shape/en,,/w, ,color/en,,/w, ,(/w,x/en,,/w, ,y/en,,/w, ,s/en,)/w, ,def/en, ,random/en,_,image/en,(/w,self/en,,/w, ,height/en,,/w, ,width/en,)/w,:/w, ,"/w,"/w,"/w,creates/en, ,random/en, ,specifications/en, ,of/en, ,an/en, ,image/en, ,with/en, ,multiple/en, ,shapes/en,./w, ,returns/en, ,the/en, ,background/en, ,color/en, ,of/en, ,the/en, ,image/en, ,and/en, ,a/en, ,list/en, ,of/en, ,shape/en, ,specifications/en, ,that/en, ,can/en, ,be/en, ,used/en, ,to/en, ,draw/en, ,the/en, ,image/en,./w, ,"/w,"/w,"/w, ,#, ,pick/en, ,random/en, ,background/en, ,color/en, ,bg/en,_,color/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,random/en,./w,randint/en,(/w,0/m,,/w, ,255/m,)/w, ,for/en, ,_, ,in/en, ,range/en,(/w,3/m,)/w,]/w,)/w, ,#, ,generate/en, ,a/en, ,few/en, ,random/en, ,shapes/en, ,and/en, ,record/en, ,their/en, ,#, ,bounding/en, ,boxes/en, ,shapes/en, ,=/w, ,[/w,]/w, ,boxes/en, ,=/w, ,[/w,]/w, ,n/en, ,=/w, ,random/en,./w,randint/en,(/w,1/m,,/w, ,4/m,)/w, ,for/en, ,_, ,in/en, ,range/en,(/w,n/en,)/w,:/w, ,shape/en,,/w, ,color/en,,/w, ,dims/en, ,=/w, ,self/en,./w,random/en,_,shape/en,(/w,height/en,,/w, ,width/en,)/w, ,shapes/en,./w,append/en,(/w,(/w,shape/en,,/w, ,color/en,,/w, ,dims/en,)/w,)/w, ,x/en,,/w, ,y/en,,/w, ,s/en, ,=/w, ,dims/en, ,boxes/en,./w,append/en,(/w,[/w,y/en,-/w,s/en,,/w, ,x/en,-/w,s/en,,/w, ,y/en,+/w,s/en,,/w, ,x/en,+/w,s/en,]/w,)/w, ,#, ,apply/en, ,non/en,-/w,max/en, ,suppression/en, ,wit/en, ,0.3/m, ,threshold/en, ,to/en, ,avoid/en, ,#, ,shapes/en, ,covering/en, ,each/en, ,other/en, ,keep/en,_,ixs/en, ,=/w, ,utils/en,./w,non/en,_,max/en,_,suppression/en,(/w,np/en,./w,array/en,(/w,boxes/en,)/w,,/w, ,np/en,./w,arange/en,(/w,n/en,)/w,,/w, ,0.3/m,)/w, ,shapes/en, ,=/w, ,[/w,s/en, ,for/en, ,i/en,,/w, ,s/en, ,in/en, ,enumerate/en,(/w,shapes/en,)/w, ,if/en, ,i/en, ,in/en, ,keep/en,_,ixs/en,]/w, ,return/en, ,bg/en,_,color/en,,/w, ,shapes/en,一/m,、/w,原始/a,数据/n,信息/n,录入/v,然后/c,调用/v,如下/v,方法/n,（/w,image/en,_,shape/en,=/w,[/w,128/m, ,128/m, ,3/m,]/w,，/w,介绍/v,config/en,时/ng,会/v,提到/v,）/w,，/w,准备/v,训练/vn,用/p,数据/n,和/c,验证/vn,集/vg,数据/n,，/w,注意/v,，/w,此时/r,仅仅/d,是/v,在/p,做/v,准备/v,并未/d,真实/a,的/u,生成/vn,或/c,读/v,入/v,图片/n,数据/n,，/w,#, ,training/en, ,dataset/en, ,dataset/en,_,train/en, ,=/w, ,shapesdataset/en,(/w,)/w, ,dataset/en,_,train/en,./w,load/en,_,shapes/en,(/w,500/m,,/w, ,config/en,./w,image/en,_,shape/en,[/w,0/m,]/w,,/w, ,config/en,./w,image/en,_,shape/en,[/w,1/m,]/w,)/w, ,dataset/en,_,train/en,./w,prepare/en,(/w,)/w, ,#, ,validation/en, ,dataset/en, ,dataset/en,_,val/en, ,=/w, ,shapesdataset/en,(/w,)/w, ,dataset/en,_,val/en,./w,load/en,_,shapes/en,(/w,50/m,,/w, ,config/en,./w,image/en,_,shape/en,[/w,0/m,]/w,,/w, ,config/en,./w,image/en,_,shape/en,[/w,1/m,]/w,)/w, ,dataset/en,_,val/en,./w,prepare/en,(/w,)/w,其/r,调用/v,的/u,load/en,_,shapes/en,方法/n,如下/v,：/w,def/en, ,load/en,_,shapes/en,(/w,self/en,,/w, ,count/en,,/w, ,height/en,,/w, ,width/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,the/en, ,requested/en, ,number/en, ,of/en, ,synthetic/en, ,images/en,./w, ,count/en,:/w, ,number/en, ,of/en, ,images/en, ,to/en, ,generate/en,./w, ,height/en,,/w, ,width/en,:/w, ,the/en, ,size/en, ,of/en, ,the/en, ,generated/en, ,images/en,./w, ,"/w,"/w,"/w, ,#, ,add/en, ,classes/en, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,1/m,,/w, ,"/w,square/en,"/w,)/w, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,2/m,,/w, ,"/w,circle/en,"/w,)/w, ,self/en,./w,add/en,_,class/en,(/w,"/w,shapes/en,"/w,,/w, ,3/m,,/w, ,"/w,triangle/en,"/w,)/w, ,#, ,add/en, ,images/en, ,#, ,generate/en, ,random/en, ,specifications/en, ,of/en, ,images/en, ,(/w,i/en,./w,e/en,./w, ,color/en, ,and/en, ,#, ,list/en, ,of/en, ,shapes/en, ,sizes/en, ,and/en, ,locations/en,)/w,./w, ,this/en, ,is/en, ,more/en, ,compact/en, ,than/en, ,#, ,actual/en, ,images/en,./w, ,images/en, ,are/en, ,generated/en, ,on/en, ,the/en, ,fly/en, ,in/en, ,load/en,_,image/en,(/w,)/w,./w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,count/en,)/w,:/w, ,bg/en,_,color/en,,/w, ,shapes/en, ,=/w, ,self/en,./w,random/en,_,image/en,(/w,height/en,,/w, ,width/en,)/w, ,self/en,./w,add/en,_,image/en,(/w,"/w,shapes/en,"/w,,/w, ,image/en,_,id/en,=/w,i/en,,/w, ,path/en,=/w,none/en,,/w, ,width/en,=/w,width/en,,/w, ,height/en,=/w,height/en,,/w, ,bg/en,_,color/en,=/w,bg/en,_,color/en,,/w, ,shapes/en,=/w,shapes/en,)/w,这里/r,涉及/v,了/u,两个/m,父类/nw,继承/v,来/v,的/u,方法/n,self/en,./w,add/en,_,class/en,和/c,self/en,./w,add/en,_,image/en,，/w,我们/r,去/v,util/en,./w,py/en,中/f,的/u,dataset/en, ,class/en,看/v,一/m,看/v,，/w,class/en, ,dataset/en,(/w,object/en,)/w,:/w, ,"/w,"/w,"/w,the/en, ,base/en, ,class/en, ,for/en, ,dataset/en, ,classes/en,./w, ,to/en, ,use/en, ,it/en,,/w, ,create/en, ,a/en, ,new/en, ,class/en, ,that/en, ,adds/en, ,functions/en, ,specific/en, ,to/en, ,the/en, ,dataset/en, ,you/en, ,want/en, ,to/en, ,use/en,./w, ,for/en, ,example/en,:/w, ,class/en, ,catsanddogsdataset/en,(/w,dataset/en,)/w,:/w, ,def/en, ,load/en,_,cats/en,_,and/en,_,dogs/en,(/w,self/en,)/w,:/w, ,./w,./w,./w, ,def/en, ,load/en,_,mask/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,./w,./w,./w, ,def/en, ,image/en,_,reference/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,./w,./w,./w, ,see/en, ,cocodataset/en, ,and/en, ,shapesdataset/en, ,as/en, ,examples/en,./w, ,"/w,"/w,"/w, ,def/en, ,_,_,init/en,_,_,(/w,self/en,,/w, ,class/en,_,map/en,=/w,none/en,)/w,:/w, ,self/en,./w,_,image/en,_,ids/en, ,=/w, ,[/w,]/w, ,self/en,./w,image/en,_,info/en, ,=/w, ,[/w,]/w, ,#, ,background/en, ,is/en, ,always/en, ,the/en, ,first/en, ,class/en, ,self/en,./w,class/en,_,info/en, ,=/w, ,[/w,{/w,"/w,source/en,"/w,:/w, ,"/w,"/w,,/w, ,"/w,id/en,"/w,:/w, ,0/m,,/w, ,"/w,name/en,"/w,:/w, ,"/w,bg/en,"/w,}/w,]/w, ,self/en,./w,source/en,_,class/en,_,ids/en, ,=/w, ,{/w,}/w, ,def/en, ,add/en,_,class/en,(/w,self/en,,/w, ,source/en,,/w, ,class/en,_,id/en,,/w, ,class/en,_,name/en,)/w,:/w, ,assert/en, ,"/w,./w,"/w, ,not/en, ,in/en, ,source/en,,/w, ,"/w,source/en, ,name/en, ,cannot/en, ,contain/en, ,a/en, ,dot/en,"/w, ,#, ,does/en, ,the/en, ,class/en, ,exist/en, ,already/en,?/w, ,for/en, ,info/en, ,in/en, ,self/en,./w,class/en,_,info/en,:/w, ,if/en, ,info/en,[/w,'/w,source/en,'/w,]/w, ,=/w,=/w, ,source/en, ,and/en, ,info/en,[/w,"/w,id/en,"/w,]/w, ,=/w,=/w, ,class/en,_,id/en,:/w, ,#, ,source/en,./w,class/en,_,id/en, ,combination/en, ,already/en, ,available/en,,/w, ,skip/en, ,return/en, ,#, ,add/en, ,the/en, ,class/en, ,self/en,./w,class/en,_,info/en,./w,append/en,(/w,{/w, ,"/w,source/en,"/w,:/w, ,source/en,,/w, ,"/w,id/en,"/w,:/w, ,class/en,_,id/en,,/w, ,"/w,name/en,"/w,:/w, ,class/en,_,name/en,,/w, ,}/w,)/w, ,def/en, ,add/en,_,image/en,(/w,self/en,,/w, ,source/en,,/w, ,image/en,_,id/en,,/w, ,path/en,,/w, ,*/w,*/w,kwargs/en,)/w,:/w, ,image/en,_,info/en, ,=/w, ,{/w, ,"/w,id/en,"/w,:/w, ,image/en,_,id/en,,/w, ,"/w,source/en,"/w,:/w, ,source/en,,/w, ,"/w,path/en,"/w,:/w, ,path/en,,/w, ,}/w, ,image/en,_,info/en,./w,update/en,(/w,kwargs/en,)/w, ,self/en,./w,image/en,_,info/en,./w,append/en,(/w,image/en,_,info/en,)/w,也就是说/l,，/w,在/p,dataset/en,中/f,有/v,self/en,./w,image/en,_,info/en, ,和/c, ,self/en,./w,class/en,_,info/en, ,两个/m,list/en,，/w,它们/r,的/u,元素/n,都/d,是/v,固定/a,key/en,的/u,字典/n,，/w,"/w,source/en,"/w,对应/v,数据集/nw,名称/n,，/w,"/w,id/en,"/w,对应/v,本/r,数据集/nw,内/f,当前/t,图片/n,//w,类别/n,标号/n,"/w,path/en,"/w,仅/d,image/en,_,info/en,含有/v,，/w,对应/v,图像/n,路径/n,，/w,可/v,为/p,none/en,"/w,name/en,"/w,仅/d,class/en,_,info/en,含有/v,，/w,对应/v,类别/n,描述/v,在/p,后面/f,的/u,prepare/en,方法/n,中/f,我们/r,可以/v,进一步/d,了解/v,，/w,使用/v,source/en,./w,id/en,作/v,key/en,，/w,可以/v,索引/n,到/v,一个/m,内/f,建/v,的/u,新/a,的/u,internal/en, ,id/en,，/w,这/r,也/d,像/v,我们/r,解释/v,了/u,为什么/r,文档/n,中/f,说/v,mask/en,_,rcnn/en,支持/v,多/a,个/q,数据集/nw,同时/c,训练/vn,的/u,由来/n,。/w,回到/v,load/en,_,shapes/en,方法/n,，/w,self/en,./w,random/en,_,image/en,方法/n,为/p,新建/v,方法/n,，/w,这里/r,作者/n,使用/v,算法/n,生成/vn,图像/n,做/v,训练/vn,，/w,该/r,方法/n,返回/v,生成/vn,图像/n,函数/n,所/u,需/v,的/u,随机/d,参数/n,，/w,之后/f,调用/v,add/en,_,image/en,时/ng,传入/v,path/en,为/p,none/en,，/w,也/d,是/v,因为/c,数据/n,并非/v,从/p,磁盘/n,读取/v,，/w,而是/c,自己/r,生成/vn,，/w,并/c,传入/v,了/u,额外/b,的/u,self/en,./w,random/en,_,image/en,方法/n,返回/v,的/u,生成/vn,参数/n,（/w,我们/r,不必/d,关系/n,具体/a,参数/n,是/v,什么/r,）/w,，/w,作为/v,字典/n,参数/n,解读/v,，/w,添加/vn,进/v,self/en,./w,image/en,_,info/en,中/f,，/w,for/en, ,i/en, ,in/en, ,range/en,(/w,count/en,)/w,:/w, ,bg/en,_,color/en,,/w, ,shapes/en, ,=/w, ,self/en,./w,random/en,_,image/en,(/w,height/en,,/w, ,width/en,)/w, ,self/en,./w,add/en,_,image/en,(/w,"/w,shapes/en,"/w,,/w, ,image/en,_,id/en,=/w,i/en,,/w, ,path/en,=/w,none/en,,/w, ,width/en,=/w,width/en,,/w, ,height/en,=/w,height/en,,/w, ,bg/en,_,color/en,=/w,bg/en,_,color/en,,/w, ,shapes/en,=/w,shapes/en,)/w,从/p,这里/r,，/w,我们/r,进一步/d,了解/v,了/u,self/en,./w,image/en,_,info/en,的/u,含义/n,，/w,记录/v,每/r,一张/mq,图片/n,的/u,id/en,信息/n,（/w,"/w,source/en,"/w,和/c,"/w,id/en,"/w,）/w,，/w,记录/v,每/r,一张/mq,图片/n,的/u,数据/n,信息/n,（/w,如何/r,获取/v,图像/n,矩阵/n,的/u,线索/n,，/w,包含/v,"/w,path/en,"/w,或者/c,其他/r,的/u,字典/n,索引/n,，/w,只要/c,保证/v,后面/f,能/v,实现/v,函数/n,，/w,根据/p,这个/r,信息/n,获取/v,图片/n,数据/n,即可/v,）/w,。/w,二/m,、/w,数据/n,信息/n,整理/v,在/p,初始化/v,了/u, ,self/en,./w,image/en,_,info/en, ,和/c, ,self/en,./w,class/en,_,info/en, ,两个/m,list/en,之后/f,，/w,dataset/en,已经/d,记录/v,了/u,原始/a,的/u,类别/n,信息/n,和/c,图像/n,信息/n,，/w,调用/v,prepare/en,方法/n,进行/v,规范化/vn,，/w,def/en, ,prepare/en,(/w,self/en,,/w, ,class/en,_,map/en,=/w,none/en,)/w,:/w, ,"/w,"/w,"/w,prepares/en, ,the/en, ,dataset/en, ,class/en, ,for/en, ,use/en,./w, ,todo/en,:/w, ,class/en, ,map/en, ,is/en, ,not/en, ,supported/en, ,yet/en,./w, ,when/en, ,done/en,,/w, ,it/en, ,should/en, ,handle/en, ,mapping/en, ,classes/en, ,from/en, ,different/en, ,datasets/en, ,to/en, ,the/en, ,same/en, ,class/en, ,id/en,./w, ,"/w,"/w,"/w, ,def/en, ,clean/en,_,name/en,(/w,name/en,)/w,:/w, ,"/w,"/w,"/w,returns/en, ,a/en, ,shorter/en, ,version/en, ,of/en, ,object/en, ,names/en, ,for/en, ,cleaner/en, ,display/en,./w,"/w,"/w,"/w, ,return/en, ,"/w,,/w,"/w,./w,join/en,(/w,name/en,./w,split/en,(/w,"/w,,/w,"/w,)/w,[/w,:/w,1/m,]/w,)/w, ,#, ,build/en, ,(/w,or/en, ,rebuild/en,)/w, ,everything/en, ,else/en, ,from/en, ,the/en, ,info/en, ,dicts/en,./w, ,self/en,./w,num/en,_,classes/en, ,=/w, ,len/en,(/w,self/en,./w,class/en,_,info/en,)/w, ,#, ,类别/n,数目/n, ,self/en,./w,class/en,_,ids/en, ,=/w, ,np/en,./w,arange/en,(/w,self/en,./w,num/en,_,classes/en,)/w, ,#, ,internal/en, ,类别/n,ids/en, ,self/en,./w,class/en,_,names/en, ,=/w, ,[/w,clean/en,_,name/en,(/w,c/en,[/w,"/w,name/en,"/w,]/w,)/w, ,for/en, ,c/en, ,in/en, ,self/en,./w,class/en,_,info/en,]/w, ,#, ,类别/n,名/q,简洁/a,版/n, ,self/en,./w,num/en,_,images/en, ,=/w, ,len/en,(/w,self/en,./w,image/en,_,info/en,)/w, ,#, ,图片/n,数目/n, ,self/en,./w,_,image/en,_,ids/en, ,=/w, ,np/en,./w,arange/en,(/w,self/en,./w,num/en,_,images/en,)/w, ,#, ,internal/en, ,类别/n,ids/en, ,#, ,mapping/en, ,from/en, ,source/en, ,class/en, ,and/en, ,image/en, ,ids/en, ,to/en, ,internal/en, ,ids/en, ,self/en,./w,class/en,_,from/en,_,source/en,_,map/en, ,=/w, ,{/w,"/w,{/w,}/w,./w,{/w,}/w,"/w,./w,format/en,(/w,info/en,[/w,'/w,source/en,'/w,]/w,,/w, ,info/en,[/w,'/w,id/en,'/w,]/w,)/w,:/w, ,id/en, ,for/en, ,info/en,,/w, ,id/en, ,in/en, ,zip/en,(/w,self/en,./w,class/en,_,info/en,,/w, ,self/en,./w,class/en,_,ids/en,)/w,}/w, ,self/en,./w,image/en,_,from/en,_,source/en,_,map/en, ,=/w, ,{/w,"/w,{/w,}/w,./w,{/w,}/w,"/w,./w,format/en,(/w,info/en,[/w,'/w,source/en,'/w,]/w,,/w, ,info/en,[/w,'/w,id/en,'/w,]/w,)/w,:/w, ,id/en, ,for/en, ,info/en,,/w, ,id/en, ,in/en, ,zip/en,(/w,self/en,./w,image/en,_,info/en,,/w, ,self/en,./w,image/en,_,ids/en,)/w,}/w, ,#, ,map/en, ,sources/en, ,to/en, ,class/en,_,ids/en, ,they/en, ,support/en, ,self/en,./w,sources/en, ,=/w, ,list/en,(/w,set/en,(/w,[/w,i/en,[/w,'/w,source/en,'/w,]/w, ,for/en, ,i/en, ,in/en, ,self/en,./w,class/en,_,info/en,]/w,)/w,)/w, ,self/en,./w,source/en,_,class/en,_,ids/en, ,=/w, ,{/w,}/w, ,#, ,source/en,对应/v,的/u,internal/en, ,类别/n,ids/en, ,#, ,loop/en, ,over/en, ,datasets/en, ,for/en, ,source/en, ,in/en, ,self/en,./w,sources/en,:/w, ,self/en,./w,source/en,_,class/en,_,ids/en,[/w,source/en,]/w, ,=/w, ,[/w,]/w, ,#, ,find/en, ,classes/en, ,that/en, ,belong/en, ,to/en, ,this/en, ,dataset/en, ,for/en, ,i/en,,/w, ,info/en, ,in/en, ,enumerate/en,(/w,self/en,./w,class/en,_,info/en,)/w,:/w, ,#, ,include/en, ,bg/en, ,class/en, ,in/en, ,all/en, ,datasets/en, ,if/en, ,i/en, ,=/w,=/w, ,0/m, ,or/en, ,source/en, ,=/w,=/w, ,info/en,[/w,'/w,source/en,'/w,]/w,:/w, ,self/en,./w,source/en,_,class/en,_,ids/en,[/w,source/en,]/w,./w,append/en,(/w,i/en,)/w,类别/n,信息/n,记录/v,将/d,"/w,source/en,./w,id/en,"/w,映射/v,为/p,唯一/b,的/u,internal/en, ,ids/en,，/w,并/c,将/d,全部/m,的/u,internal/en, ,ids/en,存储/vn,在/p,self/en,./w,class/en,_,idssource/en,_,class/en,_,ids/en,，/w,记录/v,下/f,每/r,一个/m,"/w,source/en,"/w,对应/v,的/u,internal/en, ,idsclass/en,_,from/en,_,source/en,_,map/en,，/w,记录/v,下/f,"/w,source/en,./w,id/en,"/w,：/w,internal/en, ,ids/en,的/u,映射/v,关系/n,print/en,(/w,dataset/en,_,train/en,./w,class/en,_,info/en,)/w, ,#, ,每个/r,类别/n,原始/a,信息/n, ,print/en,(/w,dataset/en,_,train/en,./w,class/en,_,ids/en,)/w, ,#, ,记录/v,类别/n,internal/en, ,ids/en, ,print/en,(/w,dataset/en,_,train/en,./w,source/en,_,class/en,_,ids/en,)/w, ,#, ,每个/r,数据集/nw,对应/v,的/u,internal/en, ,ids/en, ,print/en,(/w,dataset/en,_,train/en,./w,class/en,_,from/en,_,source/en,_,map/en,)/w, ,#, ,原始/a,信息/n,和/c,internal/en, ,id/en,映射/v,关系/n,输出/v,如下/v,：/w,[/w,{/w,'/w,source/en,'/w,:/w, ,'/w,'/w,,/w, ,'/w,id/en,'/w,:/w, ,0/m,,/w, ,'/w,name/en,'/w,:/w, ,'/w,bg/en,'/w,}/w,,/w,{/w,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,id/en,'/w,:/w, ,1/m,,/w, ,'/w,name/en,'/w,:/w, ,'/w,square/en,'/w,}/w,,/w,{/w,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,id/en,'/w,:/w, ,2/m,,/w, ,'/w,name/en,'/w,:/w, ,'/w,circle/en,'/w,}/w,,/w,{/w,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,id/en,'/w,:/w, ,3/m,,/w, ,'/w,name/en,'/w,:/w, ,'/w,triangle/en,'/w,}/w,]/w, ,[/w,0/m, ,1/m, ,2/m, ,3/m,]/w, ,{/w,'/w,'/w,:/w, ,[/w,0/m,]/w,,/w, ,'/w,shapes/en,'/w,:/w, ,[/w,0/m,,/w, ,1/m,,/w, ,2/m,,/w, ,3/m,]/w,}/w, ,{/w,'/w,./w,0/m,'/w,:/w, ,0/m,,/w, ,'/w,shapes/en,./w,1/m,'/w,:/w, ,1/m,,/w, ,'/w,shapes/en,./w,2/m,'/w,:/w, ,2/m,,/w, ,'/w,shapes/en,./w,3/m,'/w,:/w, ,3/m,}/w,有/v,固定/a,的/u,source/en,为/p,空/a,的/u,类别/n,0/m,（/w,id/en,和/c,internal/en, ,id/en,都/d,是/v,）/w,，/w,标记/n,为/p,背景/n,，/w,会/v,添加/vn,进/v,source/en,_,class/en,_,ids/en,中/f,全部/m,的/u,数据集/nw,对应/v,的/u,类别/n,中/f,（/w,上面/f,"/w,shape/en,"/w,数据集/nw,我们/r,仅/d,定义/n,了/u,3个类/mq,，/w,在/p,映射/v,中/f,多/a,了/u,一个/m,0/m,变成/v,4个类/mq,）/w,。/w,图片/n,信息/n,记录/v,图片/n,信息/n,不/d,像/v,类别/n,一样/u,麻烦/an,，/w,我们/r,简单/a,输出/v,三张/mq,，/w,#, ,training/en, ,dataset/en, ,dataset/en,_,train/en, ,=/w, ,shapesdataset/en,(/w,)/w, ,dataset/en,_,train/en,./w,load/en,_,shapes/en,(/w,3/m,,/w, ,config/en,./w,image/en,_,shape/en,[/w,0/m,]/w,,/w, ,config/en,./w,image/en,_,shape/en,[/w,1/m,]/w,)/w, ,dataset/en,_,train/en,./w,prepare/en,(/w,)/w, ,print/en,(/w,dataset/en,_,train/en,./w,image/en,_,info/en,)/w, ,#, ,记录/v,图像/n,原始/a,信息/n, ,print/en,(/w,dataset/en,_,train/en,./w,image/en,_,ids/en,)/w, ,#, ,记录/v,图像/n,internal/en, ,ids/en, ,print/en,(/w,dataset/en,_,train/en,./w,image/en,_,from/en,_,source/en,_,map/en,)/w, ,#, ,原始/a,信息/n,和/c,internal/en, ,id/en,对应/v,关系/n,结果/n,如下/v,，/w,[/w,{/w,'/w,id/en,'/w,:/w, ,0/m,,/w, ,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,path/en,'/w,:/w, ,none/en,,/w, ,'/w,width/en,'/w,:/w, ,128/m,,/w, ,'/w,height/en,'/w,:/w, ,128/m,,/w, ,'/w,bg/en,_,color/en,'/w,:/w, ,array/en,(/w,[/w,163/m,,/w, ,143/m,,/w, ,173/m,]/w,)/w,,/w,'/w,shapes/en,'/w,:/w, ,[/w,(/w,'/w,circle/en,'/w,,/w, ,(/w,178/m,,/w, ,140/m,,/w, ,65/m,)/w,,/w, ,(/w,83/m,,/w, ,104/m,,/w, ,20/m,)/w,)/w,,/w, ,(/w,'/w,circle/en,'/w,,/w, ,(/w,192/m,,/w, ,52/m,,/w, ,82/m,)/w,,/w, ,(/w,48/m,,/w, ,58/m,,/w, ,20/m,)/w,)/w,]/w,}/w,,/w,{/w,'/w,id/en,'/w,:/w, ,1/m,,/w, ,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,path/en,'/w,:/w, ,none/en,,/w, ,'/w,width/en,'/w,:/w, ,128/m,,/w, ,'/w,height/en,'/w,:/w, ,128/m,,/w, ,'/w,bg/en,_,color/en,'/w,:/w, ,array/en,(/w,[/w, ,5/m,,/w, ,99/m,,/w, ,71/m,]/w,)/w,,/w,'/w,shapes/en,'/w,:/w, ,[/w,(/w,'/w,triangle/en,'/w,,/w, ,(/w,90/m,,/w, ,32/m,,/w, ,55/m,)/w,,/w, ,(/w,39/m,,/w, ,21/m,,/w, ,22/m,)/w,)/w,,/w, ,(/w,'/w,circle/en,'/w,,/w, ,(/w,214/m,,/w, ,49/m,,/w, ,173/m,)/w,,/w, ,(/w,39/m,,/w, ,78/m,,/w, ,21/m,)/w,)/w,]/w,}/w,,/w,{/w,'/w,id/en,'/w,:/w, ,2/m,,/w, ,'/w,source/en,'/w,:/w, ,'/w,shapes/en,'/w,,/w, ,'/w,path/en,'/w,:/w, ,none/en,,/w, ,'/w,width/en,'/w,:/w, ,128/m,,/w, ,'/w,height/en,'/w,:/w, ,128/m,,/w, ,'/w,bg/en,_,color/en,'/w,:/w, ,array/en,(/w,[/w,138/m,,/w, ,52/m,,/w, ,83/m,]/w,)/w,,/w,'/w,shapes/en,'/w,:/w, ,[/w,(/w,'/w,circle/en,'/w,,/w, ,(/w,180/m,,/w, ,74/m,,/w, ,150/m,)/w,,/w, ,(/w,105/m,,/w, ,45/m,,/w, ,27/m,)/w,)/w,]/w,}/w,]/w, ,[/w,0/m, ,1/m, ,2/m,]/w, ,{/w,'/w,shapes/en,./w,0/m,'/w,:/w, ,0/m,,/w, ,'/w,shapes/en,./w,1/m,'/w,:/w, ,1/m,,/w, ,'/w,shapes/en,./w,2/m,'/w,:/w, ,2/m,}/w,【注/nw,1/m,】/w,由于/c,这/r,是/v,图像/n,检测/vn,任务/n,而/c,非/h,图像/n,分类/vn,任务/n,，/w,故/c,每张/r,图片/n,仅仅/d,和/c,归属/vn,数据集/nw,存在/v,映射/v,，/w,和/c,类别/n,信息/n,没有/v,直接/ad,映射/v,。/w,图像/n,上/f,的/u,目标/n,和/c,类别/n,才/d,存在/v,映射/v,关系/n,，/w,不过/c,那/r,不/d,在/p,本/r,部分/n,函数/n,涉及/v,范围/n,内/f,。/w,【注/nw,2/m,】/w,internal/en, ,ids/en,实际上/d,就是/d,info/en,的/u,索引/n,数/m,组/q,，/w,使用/v,internal/en, ,ids/en,的/u,值/n,可以/v,直接/ad,索引/n,对应/v,图片/n,顺序/n,的/u,info/en,信息/n,。/w,总结/v,，/w,在/p,调用/v,self/en,./w,prepare/en,之前/f,，/w,通过/p,自己/r,的/u,新建/v,方法/n,调用/v,self/en,./w,add/en,_,class/en,(/w,)/w,和/c,self/en,./w,add/en,_,image/en,(/w,)/w,，/w,将/d,图片/n,和/c,分类/vn,的/u,原始/a,信息/n,以/p,dict/en,的/u,形式/n,添加/vn,到/v,class/en,_,info/en,与/p,image/en,_,info/en,两个/m,list/en,中/f,，/w,即可/v,。/w,三/m,、/w,获取/v,图片/n,然后/c,我们/r,获取/v,一些/m,样例/nw,图片/n,进行/v,展示/v,，/w,#, ,load/en, ,and/en, ,display/en, ,random/en, ,samples/en, ,image/en,_,ids/en, ,=/w, ,np/en,./w,random/en,./w,choice/en,(/w,dataset/en,_,train/en,./w,image/en,_,ids/en,,/w, ,4/m,)/w, ,for/en, ,image/en,_,id/en, ,in/en, ,image/en,_,ids/en,:/w, ,image/en, ,=/w, ,dataset/en,_,train/en,./w,load/en,_,image/en,(/w,image/en,_,id/en,)/w, ,mask/en,,/w, ,class/en,_,ids/en, ,=/w, ,dataset/en,_,train/en,./w,load/en,_,mask/en,(/w,image/en,_,id/en,)/w, ,visualize/en,./w,display/en,_,top/en,_,masks/en,(/w,image/en,,/w, ,mask/en,,/w, ,class/en,_,ids/en,,/w, ,dataset/en,_,train/en,./w,class/en,_,names/en,)/w, ,print/en,(/w,image/en,./w,shape/en,,/w, ,mask/en,./w,shape/en,,/w, ,class/en,_,ids/en,,/w, ,dataset/en,_,train/en,./w,class/en,_,names/en,)/w,由/p,上面/f,代码/n,我们/r,可以/v,获悉/v,如下/v,信息/n,：/w,使用/v,self/en,./w,image/en,./w,ids/en,即/v,internal/en, ,ids/en,进行/v,图片/n,选取/v,自行/d,实现/v,load/en,_,image/en,方法/n,，/w,获取/v,图片/n,internal/en, ,ids/en,，/w,索引/n,图片/n,原始/a,信息/n,（/w,info/en,）/w,，/w,利用/v,原始/a,信息/n,输出/v,图片/n,自行/d,实现/v,load/en,_,mask/en,方法/n,，/w,获取/v,图片/n,internal/en, ,ids/en,，/w,索引/n,图片/n,原始/a,信息/n,（/w,info/en,）/w,，/w,利用/v,原始/a,信息/n,输出/v,图片/n,的/u,masks/en,和/c,对应/v,internal/en,类别/n,，/w,注意/v,一张/mq,图片/n,可以/v,有/v,多/a,个/q,mask/en,并/c,分别/d,对应/v,自己/r,的/u,类别/n,上述/b,代码/n,输出/v,如下/v,（/w,仅/d,展示/v,前/f,两张/mq,）/w,，/w,下面/f,贴/v,出/v,load/en,_,image/en,和/c,load/en,_,mask/en,方法/n,（/w,详见/nz,train/en,_,shapes/en,./w,ipynb/en,）/w,，/w,具体/a,实现/v,不/d,是/v,重点/n,，/w,毕竟/d,我们/r,也/d,不/d,是/v,在/p,研究/vn,怎么/r,画/v,2/m,d/en,图/n,，/w,重点/n,在于/v,上面/f,提到/v,的/u,它们/r,的/u,功能/n,，/w,这/r,涉及/v,到/v,我们/r,迁移/vn,到/v,自己/r,的/u,数据/n,时/ng,如何/r,实现/v,接口/n,。/w,load/en,_,image/en,方法/n,返回/v,一张/mq,图片/n,，/w,load/en,_,mask/en,方法/n,返回/v,（/w,h/en,，/w,w/en,，/w,c/en,）/w,的/u,01/m,掩码/nw,以及/c,（/w,c/en,，/w,）/w,的/u,class/en, ,id/en,，/w,注意/v,，/w,c/en,指/v,的/u,是/v,盖章/vn,图片/n,中/f,instance/en,的/u,数目/n,def/en, ,load/en,_,image/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,an/en, ,image/en, ,from/en, ,the/en, ,specs/en, ,of/en, ,the/en, ,given/en, ,image/en, ,id/en,./w, ,typically/en, ,this/en, ,function/en, ,loads/en, ,the/en, ,image/en, ,from/en, ,a/en, ,file/en,,/w, ,but/en, ,in/en, ,this/en, ,case/en, ,it/en, ,generates/en, ,the/en, ,image/en, ,on/en, ,the/en, ,fly/en, ,from/en, ,the/en, ,specs/en, ,in/en, ,image/en,_,info/en,./w, ,"/w,"/w,"/w, ,info/en, ,=/w, ,self/en,./w,image/en,_,info/en,[/w,image/en,_,id/en,]/w, ,bg/en,_,color/en, ,=/w, ,np/en,./w,array/en,(/w,info/en,[/w,'/w,bg/en,_,color/en,'/w,]/w,)/w,./w,reshape/en,(/w,[/w,1/m,,/w, ,1/m,,/w, ,3/m,]/w,)/w, ,image/en, ,=/w, ,np/en,./w,ones/en,(/w,[/w,info/en,[/w,'/w,height/en,'/w,]/w,,/w, ,info/en,[/w,'/w,width/en,'/w,]/w,,/w, ,3/m,]/w,,/w, ,dtype/en,=/w,np/en,./w,uint/en,8/m,)/w, ,image/en, ,=/w, ,image/en, ,*/w, ,bg/en,_,color/en,./w,astype/en,(/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,shape/en,,/w, ,color/en,,/w, ,dims/en, ,in/en, ,info/en,[/w,'/w,shapes/en,'/w,]/w,:/w, ,image/en, ,=/w, ,self/en,./w,draw/en,_,shape/en,(/w,image/en,,/w, ,shape/en,,/w, ,dims/en,,/w, ,color/en,)/w, ,return/en, ,image/en, ,def/en, ,load/en,_,mask/en,(/w,self/en,,/w, ,image/en,_,id/en,)/w,:/w, ,"/w,"/w,"/w,generate/en, ,instance/en, ,masks/en, ,for/en, ,shapes/en, ,of/en, ,the/en, ,given/en, ,image/en, ,id/en,./w, ,"/w,"/w,"/w, ,info/en, ,=/w, ,self/en,./w,image/en,_,info/en,[/w,image/en,_,id/en,]/w, ,shapes/en, ,=/w, ,info/en,[/w,'/w,shapes/en,'/w,]/w, ,count/en, ,=/w, ,len/en,(/w,shapes/en,)/w, ,mask/en, ,=/w, ,np/en,./w,zeros/en,(/w,[/w,info/en,[/w,'/w,height/en,'/w,]/w,,/w, ,info/en,[/w,'/w,width/en,'/w,]/w,,/w, ,count/en,]/w,,/w, ,dtype/en,=/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,i/en,,/w, ,(/w,shape/en,,/w, ,_,,/w, ,dims/en,)/w, ,in/en, ,enumerate/en,(/w,info/en,[/w,'/w,shapes/en,'/w,]/w,)/w,:/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,:/w,i/en,+/w,1/m,]/w, ,=/w, ,self/en,./w,draw/en,_,shape/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,:/w,i/en,+/w,1/m,]/w,./w,copy/en,(/w,)/w,,/w, ,shape/en,,/w, ,dims/en,,/w, ,1/m,)/w, ,#, ,handle/en, ,occlusions/en, ,occlusion/en, ,=/w, ,np/en,./w,logical/en,_,not/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,-/w,1/m,]/w,)/w,./w,astype/en,(/w,np/en,./w,uint/en,8/m,)/w, ,for/en, ,i/en, ,in/en, ,range/en,(/w,count/en,-/w,2/m,,/w, ,-/w,1/m,,/w, ,-/w,1/m,)/w,:/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w, ,=/w, ,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w, ,*/w, ,occlusion/en, ,occlusion/en, ,=/w, ,np/en,./w,logical/en,_,and/en,(/w,occlusion/en,,/w, ,np/en,./w,logical/en,_,not/en,(/w,mask/en,[/w,:/w,,/w, ,:/w,,/w, ,i/en,]/w,)/w,)/w, ,#, ,map/en, ,class/en, ,names/en, ,to/en, ,class/en, ,ids/en,./w, ,class/en,_,ids/en, ,=/w, ,np/en,./w,array/en,(/w,[/w,self/en,./w,class/en,_,names/en,./w,index/en,(/w,s/en,[/w,0/m,]/w,)/w, ,for/en, ,s/en, ,in/en, ,shapes/en,]/w,)/w, ,return/en, ,mask/en,./w,astype/en,(/w,np/en,./w,bool/en,)/w,,/w, ,class/en,_,ids/en,./w,astype/en,(/w,np/en,./w,int/en,32/m,)/w,小结/n,正如/v,data