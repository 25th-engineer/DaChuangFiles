一 图像 的 传统 特征 介绍 1 . HOG 方向 
梯度 直方图 Histogram of Oriented Gradient HOG 特征 是 一种 
在 计算机 视觉 和 图像 处理 中 用来 进行 物体 
检测 的 特征描述 子 它 通过 计算 和 统计 图像 
局部 区域 的 梯度方向 直方图 来 构成 特征 例如 区别 
圆形 的 大小 或者 不 一样 的 形状 此时 有用 
的 是 边缘 信息 的 特征 而 图像 的 梯度 
x 和y/nr 导数 的 大小 在 边缘 和 拐角处 突然 
强度 变化 的 区域 很大 因此 可以 作为 区分 的 
特征 具体 提取 参考 2 . LBP 局部 二 值 
模式 Local Binary Pattern LBP 是 一种 用来 描述 图像 
局部 纹理 特征 的 算子 它 具有 旋转 不变性 和 
灰度 不变性 等 显著 的 优点 3 . HaarHaar 特征 
分为 三类 边缘 特征 线性 特征 中心 特征 和 对角线 
特征 组合成 特征 模板 特征 模板 内有 白色 和 黑色 
两种 矩形 并 定义 该 模板 的 特征值 为 白色 
矩形 像素 和 减去 黑色 矩形 像素 和 Haar 特征值 
反映 了 图像 的 灰度 变化 情况 注 参考 链接 
https / / blog . csdn . net / q123456789098 
/ article / details / 52748918 二 传统 的 图像 
特征提取 与 深度 学习 对比 难点 传统 的 图像 特征提取 
需要 自主 选择 提取 哪些 特征 并 需要 相关 领域 
知识 像 角 点 边缘 纹理 只有 使用 不同 的 
特征 才能 更好 地 描述 不同 的 类别 而在 训练 
的 时候 面对 很多 特征 需要 对 大量 参数 进行 
微调 优点 相比 深度 学习 需要 大量 数据 及 长 
时间 的 训练 且 应用 场景 有限 像 铝 表面 
布匹 的 缺陷 瑕疵 检测 使用 传统 的 特征 可以 
短时间 高效 的 完成 深度 学习 采用 端 到 端的 
自动 学习 提取 出 需要 的 特征 提供 了 最具 
描述性 显著性 的 特征 理解 传统 的 计算机 视觉 实际上 
真的 有助于 你 更好 的 使用 深度 学习 例如 计算机 
视觉 中最 常见 的 神经 网络 是 卷积 神经网络 但是 
什么 是 卷积 它 实际上 是 一种 广泛 使用 的 
图像 处理 技术 例如 Sobel 边缘 检测 了解 卷积 有助于 
了解 神经 网络 的 内在 机制 在 解决 问题 时 
它 可以 帮助 你 设计 和 调整 模型 参考 https 
/ / blog . csdn . net / weixin _ 
41036461 / article / details / 80587405 三 深度 学习 
常用 的 数据 增强 方法 随机 裁剪 颜色 抖动 具体 
有 随机 调整 饱和度 亮度 对比度 也 可以 叫做 扭转 
颜色 随机 角度 旋转 加入 高斯 噪声 图像 翻转 镜像 
import os import math import random import numpy as np 
from PIL import Image ImageEnhance from multiprocessing import Pool def 
random _ crop img size scale = 0.08 1.0 ratio 
= 3 . / 4 . 4 . / 3 
. aspect _ ratio = math . sqrt random . 
uniform * ratio w = 1 . * aspect _ 
ratio h = 1 . / aspect _ ratio bound 
= min float img . size 0 / img . 
size 1 / w * * 2 float img . 
size 1 / img . size 0 / h * 
* 2 scale _ max = min scale 1 bound 
scale _ min = min scale 0 bound target _ 
area = img . size 0 * img . size 
1 * random . uniform scale _ min scale _ 
max target _ size = math . sqrt target _ 
area w = int target _ size * w h 
= int target _ size * h i = random 
. randint 0 img . size 0 w j = 
random . randint 0 img . size 1 h img 
= img . crop i j i + w j 
+ h img = img . resize size size Image 
. LANCZOS return img def randomColor image 对 图像 进行 
颜色 抖动 param image PIL 的 图像 image return 有颜色 
色差 的 图像 image random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 color _ image = ImageEnhance . Color image . 
enhance random _ factor # 调整 图像 的 饱和度 random 
_ factor = np . random . randint 10 21 
/ 10 . # 随机 因子 brightness _ image = 
ImageEnhance . Brightness color _ image . enhance random _ 
factor # 调整 图像 的 亮度 random _ factor = 
np . random . randint 10 21 / 10 . 
# 随机 因 1 子 contrast _ image = ImageEnhance 
. Contrast brightness _ image . enhance random _ factor 
# 调整 图像 对比度 random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 return ImageEnhance . Sharpness contrast _ image . enhance 
random _ factor def randomRotation image mode = Image . 
BICUBIC 对 图像 进行 随机 任意 角度 0 ~ 360度 
旋转 param mode 邻近 插值 双 线性插值 双 三次 B 
样条 插值 default param image PIL 的 图像 image return 
旋 转转 之后 的 图像 random _ angle = np 
. random . randint 1 360 return image . rotate 
random _ angle mode def distort _ color img def 
random _ brightness img lower = 0.5 upper = 1.5 
e = random . uniform lower upper return ImageEnhance . 
Brightness img . enhance e def random _ contrast img 
lower = 0.5 upper = 1.5 e = random . 
uniform lower upper return ImageEnhance . Contrast img . enhance 
e def random _ color img lower = 0.5 upper 
= 1.5 e = random . uniform lower upper return 
ImageEnhance . Color img . enhance e ops = random 
_ brightness random _ contrast random _ color random . 
shuffle ops img = ops 0 img img = ops 
1 img img = ops 2 img return img def 
randomGaussian image mean = 0.2 sigma = 0.3 对 图像 
进行 高斯 噪声 处理 param image return def gaussianNoisy im 
mean = 0.2 sigma = 0.3 对 图像 做 高斯 
噪音 处理 param im 单通道 图像 param mean 偏移量 param 
sigma 标准差 return for _ i in range len im 
im _ i + = random . gauss mean sigma 
return im # 将 图像 转化成 数组 img = np 
. asarray image img . flags . writeable = True 
# 将 数组 改为 读写 模式 width height = img 
. shape 2 img _ r = gaussianNoisy img 0 
. flatten mean sigma img _ g = gaussianNoisy img 
1 . flatten mean sigma img _ b = gaussianNoisy 
img 2 . flatten mean sigma img 0 = img 
_ r . reshape width height img 1 = img 
_ g . reshape width height img 2 = img 
_ b . reshape width height return Image . fromarray 
np . uint8 img def randomFlip image # 图像 翻转 
类似于 镜像 镜子 中的 自己 # FLIP _ LEFT _ 
RIGHT 左右 翻转 # FLIP _ TOP _ BOTTOM 上下 
翻转 # ROTATE _ 90 ROTATE _ 180 or ROTATE 
_ 270 . 按照 角度 进行 旋转 与 randomRotate 功能 
类似 return image . transpose Image . FLIP _ LEFT 
_ RIGHT 一 图像 的 传统 特征 介绍 1 . HOG 方向 
梯度 直方图 Histogram of Oriented Gradient HOG 特征 是 一种 
在 计算机 视觉 和 图像 处理 中 用来 进行 物体 
检测 的 特征描述 子 它 通过 计算 和 统计 图像 
局部 区域 的 梯度方向 直方图 来 构成 特征 例如 区别 
圆形 的 大小 或者 不 一样 的 形状 此时 有用 
的 是 边缘 信息 的 特征 而 图像 的 梯度 
x 和y/nr 导数 的 大小 在 边缘 和 拐角处 突然 
强度 变化 的 区域 很大 因此 可以 作为 区分 的 
特征 具体 提取 参考 2 . LBP 局部 二 值 
模式 Local Binary Pattern LBP 是 一种 用来 描述 图像 
局部 纹理 特征 的 算子 它 具有 旋转 不变性 和 
灰度 不变性 等 显著 的 优点 3 . HaarHaar 特征 
分为 三类 边缘 特征 线性 特征 中心 特征 和 对角线 
特征 组合成 特征 模板 特征 模板 内有 白色 和 黑色 
两种 矩形 并 定义 该 模板 的 特征值 为 白色 
矩形 像素 和 减去 黑色 矩形 像素 和 Haar 特征值 
反映 了 图像 的 灰度 变化 情况 注 参考 链接 
https / / blog . csdn . net / q123456789098 
/ article / details / 52748918 二 传统 的 图像 
特征提取 与 深度 学习 对比 难点 传统 的 图像 特征提取 
需要 自主 选择 提取 哪些 特征 并 需要 相关 领域 
知识 像 角 点 边缘 纹理 只有 使用 不同 的 
特征 才能 更好 地 描述 不同 的 类别 而在 训练 
的 时候 面对 很多 特征 需要 对 大量 参数 进行 
微调 优点 相比 深度 学习 需要 大量 数据 及 长 
时间 的 训练 且 应用 场景 有限 像 铝 表面 
布匹 的 缺陷 瑕疵 检测 使用 传统 的 特征 可以 
短时间 高效 的 完成 深度 学习 采用 端 到 端的 
自动 学习 提取 出 需要 的 特征 提供 了 最具 
描述性 显著性 的 特征 理解 传统 的 计算机 视觉 实际上 
真的 有助于 你 更好 的 使用 深度 学习 例如 计算机 
视觉 中最 常见 的 神经 网络 是 卷积 神经网络 但是 
什么 是 卷积 它 实际上 是 一种 广泛 使用 的 
图像 处理 技术 例如 Sobel 边缘 检测 了解 卷积 有助于 
了解 神经 网络 的 内在 机制 在 解决 问题 时 
它 可以 帮助 你 设计 和 调整 模型 参考 https 
/ / blog . csdn . net / weixin _ 
41036461 / article / details / 80587405 三 深度 学习 
常用 的 数据 增强 方法 随机 裁剪 颜色 抖动 具体 
有 随机 调整 饱和度 亮度 对比度 也 可以 叫做 扭转 
颜色 随机 角度 旋转 加入 高斯 噪声 图像 翻转 镜像 
import os import math import random import numpy as np 
from PIL import Image ImageEnhance from multiprocessing import Pool def 
random _ crop img size scale = 0.08 1.0 ratio 
= 3 . / 4 . 4 . / 3 
. aspect _ ratio = math . sqrt random . 
uniform * ratio w = 1 . * aspect _ 
ratio h = 1 . / aspect _ ratio bound 
= min float img . size 0 / img . 
size 1 / w * * 2 float img . 
size 1 / img . size 0 / h * 
* 2 scale _ max = min scale 1 bound 
scale _ min = min scale 0 bound target _ 
area = img . size 0 * img . size 
1 * random . uniform scale _ min scale _ 
max target _ size = math . sqrt target _ 
area w = int target _ size * w h 
= int target _ size * h i = random 
. randint 0 img . size 0 w j = 
random . randint 0 img . size 1 h img 
= img . crop i j i + w j 
+ h img = img . resize size size Image 
. LANCZOS return img def randomColor image 对 图像 进行 
颜色 抖动 param image PIL 的 图像 image return 有颜色 
色差 的 图像 image random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 color _ image = ImageEnhance . Color image . 
enhance random _ factor # 调整 图像 的 饱和度 random 
_ factor = np . random . randint 10 21 
/ 10 . # 随机 因子 brightness _ image = 
ImageEnhance . Brightness color _ image . enhance random _ 
factor # 调整 图像 的 亮度 random _ factor = 
np . random . randint 10 21 / 10 . 
# 随机 因 1 子 contrast _ image = ImageEnhance 
. Contrast brightness _ image . enhance random _ factor 
# 调整 图像 对比度 random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 return ImageEnhance . Sharpness contrast _ image . enhance 
random _ factor def randomRotation image mode = Image . 
BICUBIC 对 图像 进行 随机 任意 角度 0 ~ 360度 
旋转 param mode 邻近 插值 双 线性插值 双 三次 B 
样条 插值 default param image PIL 的 图像 image return 
旋 转转 之后 的 图像 random _ angle = np 
. random . randint 1 360 return image . rotate 
random _ angle mode def distort _ color img def 
random _ brightness img lower = 0.5 upper = 1.5 
e = random . uniform lower upper return ImageEnhance . 
Brightness img . enhance e def random _ contrast img 
lower = 0.5 upper = 1.5 e = random . 
uniform lower upper return ImageEnhance . Contrast img . enhance 
e def random _ color img lower = 0.5 upper 
= 1.5 e = random . uniform lower upper return 
ImageEnhance . Color img . enhance e ops = random 
_ brightness random _ contrast random _ color random . 
shuffle ops img = ops 0 img img = ops 
1 img img = ops 2 img return img def 
randomGaussian image mean = 0.2 sigma = 0.3 对 图像 
进行 高斯 噪声 处理 param image return def gaussianNoisy im 
mean = 0.2 sigma = 0.3 对 图像 做 高斯 
噪音 处理 param im 单通道 图像 param mean 偏移量 param 
sigma 标准差 return for _ i in range len im 
im _ i + = random . gauss mean sigma 
return im # 将 图像 转化成 数组 img = np 
. asarray image img . flags . writeable = True 
# 将 数组 改为 读写 模式 width height = img 
. shape 2 img _ r = gaussianNoisy img 0 
. flatten mean sigma img _ g = gaussianNoisy img 
1 . flatten mean sigma img _ b = gaussianNoisy 
img 2 . flatten mean sigma img 0 = img 
_ r . reshape width height img 1 = img 
_ g . reshape width height img 2 = img 
_ b . reshape width height return Image . fromarray 
np . uint8 img def randomFlip image # 图像 翻转 
类似于 镜像 镜子 中的 自己 # FLIP _ LEFT _ 
RIGHT 左右 翻转 # FLIP _ TOP _ BOTTOM 上下 
翻转 # ROTATE _ 90 ROTATE _ 180 or ROTATE 
_ 270 . 按照 角度 进行 旋转 与 randomRotate 功能 
类似 return image . transpose Image . FLIP _ LEFT 
_ RIGHT 一 图像 的 传统 特征 介绍 1 . HOG 方向 
梯度 直方图 Histogram of Oriented Gradient HOG 特征 是 一种 
在 计算机 视觉 和 图像 处理 中 用来 进行 物体 
检测 的 特征描述 子 它 通过 计算 和 统计 图像 
局部 区域 的 梯度方向 直方图 来 构成 特征 例如 区别 
圆形 的 大小 或者 不 一样 的 形状 此时 有用 
的 是 边缘 信息 的 特征 而 图像 的 梯度 
x 和y/nr 导数 的 大小 在 边缘 和 拐角处 突然 
强度 变化 的 区域 很大 因此 可以 作为 区分 的 
特征 具体 提取 参考 2 . LBP 局部 二 值 
模式 Local Binary Pattern LBP 是 一种 用来 描述 图像 
局部 纹理 特征 的 算子 它 具有 旋转 不变性 和 
灰度 不变性 等 显著 的 优点 3 . HaarHaar 特征 
分为 三类 边缘 特征 线性 特征 中心 特征 和 对角线 
特征 组合成 特征 模板 特征 模板 内有 白色 和 黑色 
两种 矩形 并 定义 该 模板 的 特征值 为 白色 
矩形 像素 和 减去 黑色 矩形 像素 和 Haar 特征值 
反映 了 图像 的 灰度 变化 情况 注 参考 链接 
https / / blog . csdn . net / q123456789098 
/ article / details / 52748918 二 传统 的 图像 
特征提取 与 深度 学习 对比 难点 传统 的 图像 特征提取 
需要 自主 选择 提取 哪些 特征 并 需要 相关 领域 
知识 像 角 点 边缘 纹理 只有 使用 不同 的 
特征 才能 更好 地 描述 不同 的 类别 而在 训练 
的 时候 面对 很多 特征 需要 对 大量 参数 进行 
微调 优点 相比 深度 学习 需要 大量 数据 及 长 
时间 的 训练 且 应用 场景 有限 像 铝 表面 
布匹 的 缺陷 瑕疵 检测 使用 传统 的 特征 可以 
短时间 高效 的 完成 深度 学习 采用 端 到 端的 
自动 学习 提取 出 需要 的 特征 提供 了 最具 
描述性 显著性 的 特征 理解 传统 的 计算机 视觉 实际上 
真的 有助于 你 更好 的 使用 深度 学习 例如 计算机 
视觉 中最 常见 的 神经 网络 是 卷积 神经网络 但是 
什么 是 卷积 它 实际上 是 一种 广泛 使用 的 
图像 处理 技术 例如 Sobel 边缘 检测 了解 卷积 有助于 
了解 神经 网络 的 内在 机制 在 解决 问题 时 
它 可以 帮助 你 设计 和 调整 模型 参考 https 
/ / blog . csdn . net / weixin _ 
41036461 / article / details / 80587405 三 深度 学习 
常用 的 数据 增强 方法 随机 裁剪 颜色 抖动 具体 
有 随机 调整 饱和度 亮度 对比度 也 可以 叫做 扭转 
颜色 随机 角度 旋转 加入 高斯 噪声 图像 翻转 镜像 
import os import math import random import numpy as np 
from PIL import Image ImageEnhance from multiprocessing import Pool def 
random _ crop img size scale = 0.08 1.0 ratio 
= 3 . / 4 . 4 . / 3 
. aspect _ ratio = math . sqrt random . 
uniform * ratio w = 1 . * aspect _ 
ratio h = 1 . / aspect _ ratio bound 
= min float img . size 0 / img . 
size 1 / w * * 2 float img . 
size 1 / img . size 0 / h * 
* 2 scale _ max = min scale 1 bound 
scale _ min = min scale 0 bound target _ 
area = img . size 0 * img . size 
1 * random . uniform scale _ min scale _ 
max target _ size = math . sqrt target _ 
area w = int target _ size * w h 
= int target _ size * h i = random 
. randint 0 img . size 0 w j = 
random . randint 0 img . size 1 h img 
= img . crop i j i + w j 
+ h img = img . resize size size Image 
. LANCZOS return img def randomColor image 对 图像 进行 
颜色 抖动 param image PIL 的 图像 image return 有颜色 
色差 的 图像 image random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 color _ image = ImageEnhance . Color image . 
enhance random _ factor # 调整 图像 的 饱和度 random 
_ factor = np . random . randint 10 21 
/ 10 . # 随机 因子 brightness _ image = 
ImageEnhance . Brightness color _ image . enhance random _ 
factor # 调整 图像 的 亮度 random _ factor = 
np . random . randint 10 21 / 10 . 
# 随机 因 1 子 contrast _ image = ImageEnhance 
. Contrast brightness _ image . enhance random _ factor 
# 调整 图像 对比度 random _ factor = np . 
random . randint 0 31 / 10 . # 随机 
因子 return ImageEnhance . Sharpness contrast _ image . enhance 
random _ factor def randomRotation image mode = Image . 
BICUBIC 对 图像 进行 随机 任意 角度 0 ~ 360度 
旋转 param mode 邻近 插值 双 线性插值 双 三次 B 
样条 插值 default param image PIL 的 图像 image return 
旋 转转 之后 的 图像 random _ angle = np 
. random . randint 1 360 return image . rotate 
random _ angle mode def distort _ color img def 
random _ brightness img lower = 0.5 upper = 1.5 
e = random . uniform lower upper return ImageEnhance . 
Brightness img . enhance e def random _ contrast img 
lower = 0.5 upper = 1.5 e = random . 
uniform lower upper return ImageEnhance . Contrast img . enhance 
e def random _ color img lower = 0.5 upper 
= 1.5 e = random . uniform lower upper return 
ImageEnhance . Color img . enhance e ops = random 
_ brightness random _ contrast random _ color random . 
shuffle ops img = ops 0 img img = ops 
1 img img = ops 2 img return img def 
randomGaussian image mean = 0.2 sigma = 0.3 对 图像 
进行 高斯 噪声 处理 param image return def gaussianNoisy im 
mean = 0.2 sigma = 0.3 对 图像 做 高斯 
噪音 处理 param im 单通道 图像 param mean 偏移量 param 
sigma 标准差 return for _ i in range len im 
im _ i + = random . gauss mean sigma 
return im # 将 图像 转化成 数组 img = np 
. asarray image img . flags . writeable = True 
# 将 数组 改为 读写 模式 width height = img 
. shape 2 img _ r = gaussianNoisy img 0 
. flatten mean sigma img _ g = gaussianNoisy img 
1 . flatten mean sigma img _ b = gaussianNoisy 
img 2 . flatten mean sigma img 0 = img 
_ r . reshape width height img 1 = img 
_ g . reshape width height img 2 = img 
_ b . reshape width height return Image . fromarray 
np . uint8 img def randomFlip image # 图像 翻转 
类似于 镜像 镜子 中的 自己 # FLIP _ LEFT _ 
RIGHT 左右 翻转 # FLIP _ TOP _ BOTTOM 上下 
翻转 # ROTATE _ 90 ROTATE _ 180 or ROTATE 
_ 270 . 按照 角度 进行 旋转 与 randomRotate 功能 
类似 return image . transpose Image . FLIP _ LEFT 
_ RIGHT 